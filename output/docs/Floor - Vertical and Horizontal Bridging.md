# Floor - Vertical and Horizontal Bridging

## Overview
This script automates the generation of bridging (nogging/dwang) or herringbone strutting between floor joists. It supports two workflows: manually drawing a bridging line between beams, or automatically generating bridging based on selected floor and wall elements.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | Primary usage environment. |
| Paper Space | No | Not supported for this script. |
| Shop Drawing | No | This script generates model geometry only. |

## Prerequisites
- **Required Entities:** Floor elements (`ElementRoof`), Wall elements (`ElementWall`), or structural `Beam` entities.
- **Minimum Beam Count:** 2 beams (if using "Draw Line" mode without floor elements selected).
- **Required Settings:** None (uses internal script properties).

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Select `Floor - Vertical and Horizontal Bridging.mcr`

### Step 2: Configuration Dialog
Upon launching, a dialog will appear allowing you to set the initial parameters.
- **Action:** Set the **Insertion Mode** (Draw Line or Select Walls).
- **Action:** Define dimensions (**Width**, **Height**) and **Bridging Centers** (spacing).
- **Action:** Choose the **Type** (Noggin/Dwang or Extrusion Profile).
- **Action:** Click OK to proceed.

### Step 3: Define Geometry (Based on Insertion Mode)

**Option A: Draw Line Mode**
1. **Command Line:** `Please Select Floor Elements or Enter to Select Individual Beams`
   - **Action:** Select floor elements if available, OR press Enter to select beams manually.
2. **(If Enter pressed)** **Command Line:** `Select two beams`
   - **Action:** Select the two joists/beams between which you want to insert bridging.
3. **Command Line:** `Select first point of Bridging Line`
   - **Action:** Click the start point for the bridging run.
4. **Command Line:** `Select next point`
   - **Action:** Click the end point. Ensure this point is not identical to the start point.

**Option B: Select Walls Mode**
1. **Command Line:** `Please Select Floor Elements`
   - **Action:** Select the floor elements (ElementRoof) containing the joists.
2. **Command Line:** `Please Select Wall Elements`
   - **Action:** Select the wall elements (ElementWall) that define the boundaries for the bridging.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Type | dropdown | Noggin/Dwang | Choose between standard timber nogging or a specific extrusion profile. |
| Insertion Mode | dropdown | Select Walls | Choose "Draw Line" to define path manually, or "Select Walls" for automatic generation. (Read-only after insertion). |
| Width of Bridging | number | 44 | The width (thickness) of the bridging timber. |
| Height of Bridging | number | 222 | The depth (height) of the bridging timber. |
| Bridging Centers | number | 400 | The spacing (center-to-center) between each bridging piece. |
| Extrusion profile name | dropdown | (empty) | Select the profile to use if Type is set to "Extrusion Profile". |
| Name | text | (empty) | Assign a specific name to the generated beams. |
| Material | text | (empty) | Specify the material code. |
| Grade | text | (empty) | Specify the timber grade. |
| Label | text | (empty) | Add a label text. |
| Beam Code | text | (empty) | Assign a specific beam code. |
| Vertical Justification | dropdown | Top | Align bridging to the Top, Center, or Bottom of the joist. |
| Horizontal Justification | dropdown | Left | Align bridging to the Left, Center, or Right of the insertion line. |
| Double Bridging | dropdown | No | Set to "Yes" to install double nogging. |
| Dimstyle | dropdown | (empty) | Select the dimension style for annotations. |
| Color | number | 7 | Set the color index for the generated beams. |
| Insert Metal Part | dropdown | Yes | Enable or disable insertion of metal connecting clips. |
| Connector | dropdown | UZ38 | Select the type of metal connector/clip (e.g., UZ38). |
| Hanger Model | text | (empty) | Specify the model name for hangers if applicable. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| Regenerate Beams | Deletes all bridging beams currently generated by this instance and recreates them based on the current geometry and property settings. Useful if you modified the surrounding structure. |

## Settings Files
- No external settings files are required for this script.

## Tips
- **Distinct Points:** When using "Draw Line" mode, ensure your start and end points are not at the exact same location, or the script will exit and delete the instance.
- **Manual Selection:** If you do not have floor elements available in the model, you must select exactly two beams manually to define the boundaries for "Draw Line" mode.
- **Adjusting Spacing:** You can change the "Bridging Centers" property in the Properties Palette after insertion to instantly update the spacing of the bridging.
- **Justification:** Use "Vertical Justification" set to "Center" if you want the bridging to float in the middle of the joist depth, rather than sitting at the top or bottom.

## FAQ
- **Q: Why did the script disappear immediately after I picked points?**
  - **A:** You likely picked two points that are in the exact same spot, or you failed to select the required beams/elements. Restart the command and ensure your selection is valid.
- **Q: Can I change the insertion mode after placing the bridging?**
  - **A:** No, the "Insertion Mode" property becomes read-only once the script is inserted into the drawing. You must delete the instance and re-insert it to switch between "Draw Line" and "Select Walls" modes.
- **Q: How do I add metal clips to the bridging?**
  - **A:** Set "Insert Metal Part" to "Yes" and select the desired "Connector" type (e.g., UZ38) in the Properties Palette before or after insertion.