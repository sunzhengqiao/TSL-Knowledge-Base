```json
{
  "documentation": "# HSB_T-OptimizeBeams.mcr\n\n## Overview\nThis script automatically splits selected long timber beams into optimized production lengths. It supports staggered joints for structural integrity, expansion gaps, and angled cuts, while automatically updating linked dimensioning and wall plate scripts.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Primary usage environment. Requires existing beams. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required entities:** `GenBeam` (General Beam) entities must exist in the model.\n- **Minimum beam count:** 1\n- **Required settings files:** None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` \nAction: In the dialog that appears, select `HSB_T-OptimizeBeams.mcr` and click Open or Insert.\n\n### Step 2: Configure Parameters\n```\nDialog: HSB_T-OptimizeBeams\nAction: Adjust the split lengths, gaps, and angles as needed. Click OK to confirm.\n```\n*Note: Settings are saved to the catalog for future use.*\n\n### Step 3: Select Beams\n```\nCommand Line: Select beams in spit sequence\nAction: Click on the beams you wish to split. The order of selection defines the split sequence (staggering). Press Enter or Space to finish selection.\n```\n*Note: The script instance will automatically delete itself after processing.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **First split at** | Number | 2700 mm | Sets the length of the very first segment from the start of the beam. Used to stagger joints between adjacent rows. |\n| **Default split length** | Number | 5400 mm | The target length for all subsequent segments. Typically set to your standard raw timber length (e.g., 5400mm or 6000mm). |\n| **Minimum split length** | Number | 600 mm | The shortest allowed length for a segment. Prevents the creation of tiny, unusable offcuts. |\n| **Gap** | Number | 0 mm | The physical distance left between split beam segments (e.g., for expansion joints or saw kerf). |\n| **Angle** | Number | 0Â° | The angle of the cut relative to the perpendicular face. Use 0 for square cuts, or enter a value for angled/scarph joints. |\n| **Apply single mark** | Dropdown | Yes | If 'Yes', automatically inserts the 'HSB_T-SingleMark' script on the new beam segments for labeling. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script self-destructs immediately after running. It cannot be edited or re-run via the context menu once inserted. |\n\n## Settings Files\n- **Filename:** None\n- **Location:** N/A\n- **Purpose:** N/A\n\n## Tips\n- **Staggering:** To ensure joints in a wall do not line up vertically, vary the **First split at** value for different rows, or rely on the script's behavior if selecting beams in a specific sequence.\n- **Standard Lengths:** Set the **Default split length** to match your supplier's standard timber lengths to minimize waste.\n- **Linked Scripts:** The script automatically finds and updates linked `HSB_D-Aligned` and `BK_G-Wallplates` instances to include the new split beams.\n- **Undo:** If the result is not as expected, use the standard AutoCAD `UNDO` command to revert the changes.\n\n## FAQ\n\n**Q: Why did the script disappear after I ran it?**\nA: This script is designed as a \"command\" script. It performs the split operation and then erases its own instance (`eraseInstance`) from the model to keep the drawing clean.\n\n**Q: Why didn't my beam split?**\nA: Check if the beam length is shorter than the **Minimum split length** or the **First split at** distance. The script prevents splitting if it would result in segments that are too short.\n\n**Q: What happens to the original beam?**\nA: The original beam entity is deleted and replaced by the new split segments. Any properties or material assignments from the original beam are typically inherited by the new segments."
}
```