# HSB_R-CoverStrips

## Overview
This script automatically generates timber cover strips (sheeting) over gaps between roof elements, around dormer openings, and over specific beams or knee walls. It also provides options to remove or recolor existing strips created by this tool.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | Operates on 3D roof elements, walls, and beams. |
| Paper Space | No | Not applicable for layout views. |
| Shop Drawing | No | Not applicable for generating 2D drawings directly. |

## Prerequisites
- **Required Entities**: Roof elements (`ElemRoof`), Wall elements (`ElementWallSF`), or Beams (`GenBeam`) must be present in the model.
- **Sheeting**: The selected elements must have sheeting (e.g., OSB, Plywood) already assigned to calculate gaps and boundaries.
- **Settings Files**: `HSB_G-FilterGenBeams` (Optional, used only if applying advanced beam filters).

## Usage Steps

### Step 1: Launch Script
**Command:** `TSLINSERT` â†’ Select `HSB_R-CoverStrips.mcr` from the catalog list.

### Step 2: Configure Settings (Dialog)
Upon launch, a properties dialog appears.
1.  **Action**: Choose what you want to do:
    *   **Create/replace**: Generates new strips or updates existing ones in the selection.
    *   **Remove**: Deletes strips previously generated by this script.
    *   **Change color**: Updates the visual color of existing strips.
2.  **Dimensions**: Set the Strip Width and Thickness (if creating).
3.  **Filters**: Specify Beam Codes or Wall Codes to limit where strips are generated.
4.  Click **OK** to confirm.

### Step 3: Select Entities
The command line prompt changes based on your selected Action:

*   **If Create/replace:**
    ```
    Command Line: Select entities
    Action: Click on Roof elements, Walls, or Beams. Press Enter to finish selection.
    ```
*   **If Remove or Change color:**
    ```
    Command Line: Select cover strips to remove/color (as sheeting)
    Action: Click on the existing cover strips (sheeting entities). Press Enter to finish.
    ```

### Step 4: Processing
The script calculates gaps, generates geometry, and assigns properties. Once complete, the script instance usually removes itself from the model, leaving only the new cover strips.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| **Action** | dropdown | Create/replace | Determines the operation: Create new strips, Remove existing ones, or Change color. |
| **Max gap** | number | 18 mm | The maximum distance between roof elements that will trigger a cover strip. Larger gaps are ignored. |
| **Width** | number | 45 mm | The width of the cover strip perpendicular to its length. |
| **Thickness** | number | 11 mm | The material thickness of the cover strip. |
| **Color** | number | -1 | Display color of the strip. Set to -1 to inherit the color from the adjacent sheeting. |
| **Beam code** | text | (Empty) | Assigns a specific production/material code to the generated strips. If empty, inherits from the reference sheet. |
| **Filter definition for beams** | dropdown | (Empty) | Selects a predefined filter set (from HSB_G-FilterGenBeams) to choose which beams to cover. |
| **Beam codes to filter** | text | OSP-01;OSP-02 | A list of specific beam codes to cover (e.g., "PURLIN;RAFTER"). **Note:** This overrides the Filter definition above. |
| **Wall codes** | text | KN | Filters wall elements (e.g., knee walls) by their code to generate vertical strips. |
| **Group** | dropdown | Don't assign | Assigns the generated strips to a specific construction group for organization. |
| **Zone** | dropdown | 6 | Assigns a manufacturing zone (0-10) if a Group is selected. |
| **Zone character** | dropdown | 'Z' for general items | Categorizes the strips within the group (e.g., Element, General, Beam). |
| **Add exclusive** | dropdown | Yes | If Yes, strips are added exclusively to the specified group/zone. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| **Delete And Remove Strips** | Removes the script instance from the model. (Note: This does not automatically delete the generated strips unless the script logic specifically includes it during the deletion process; usually used to clean up the script marker if it persists). |

## Settings Files
- **Filename**: `HSB_G-FilterGenBeams`
- **Location**: Tsl Catalogs
- **Purpose**: Defines complex logic for selecting beams based on properties other than just the Beam Code (e.g., height, position, name).

## Tips
- **Rerunning for Updates**: If you change design parameters (like strip width), simply run the "Create/replace" action on the same area again. The script will automatically delete the old strips it created and generate new ones.
- **Filtering**: Use `Beam codes to filter` if you only want to cover specific elements (like purlins). Leave it empty to rely on the broader filter definitions.
- **Visual Check**: Set `Color` to a distinct value (e.g., Red) temporarily when troubleshooting to ensure strips are placed exactly where expected.

## FAQ
- **Q: Why did no strips generate on my roof?**
  A: Check the `Max gap` setting. If the gap between your roof panels is smaller than this value, no strip will be created. Also, ensure the roof elements actually have sheeting assigned.
- **Q: What is the difference between "Filter definition" and "Beam codes to filter"?**
  A: "Beam codes to filter" is a direct text match and takes priority. If you enter anything there, the "Filter definition" is ignored.
- **Q: Can I edit the strips after they are created?**
  A: Yes, you can select the generated sheets and edit them like normal hsbCAD sheets (move, stretch, change material). However, if you run the script again in "Create/replace" mode, it may overwrite your manual changes.