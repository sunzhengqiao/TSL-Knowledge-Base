# mepItem.mcr

## Overview
This script visualizes MEP (Mechanical, Electrical, Plumbing) items imported from Revit or IFC sources. It is primarily used for clash detection and spatial coordination within the hsbCAD timber model by displaying HVAC ducts, pipes, and equipment.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | This is where the script generates 3D geometry for the imported items. |
| Paper Space | No | |
| Shop Drawing | No | |

## Prerequisites
- **Required Process**: This script is designed to be instantiated automatically by the **Revit MEP Converter** extension during the model import process.
- **Required Data**: The script expects specific internal map data (`mepdata`, `CoordSys`) provided by the import process to generate the correct geometry and position.

## Usage Steps

### Step 1: Automatic Launch
- **Process**: Run the "Revit MEP Converter" to import model data.
- **Action**: The script will automatically insert instances for every detected MEP item found in the source file.

### Step 2: Adjust Appearance (Properties)
- **Process**: Select an imported MEP item in the model.
- **Action**: Open the **Properties Palette** (Ctrl+1) to adjust how the object is displayed.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Detail level | Dropdown | High detail | Controls the complexity of the 3D geometry. **High detail** attempts to render the exact imported solid. **Medium detail** simplifies shapes to tubes or boxes along centerlines. **Low detail** renders only centerlines. |
| Visual style invalid body | Dropdown | Solid | Defines how the object looks if the exact solid cannot be generated (Fallback mode). Options are **Solid**, **Shell** (hollow surfaces), or **Wireframe** (lines only). |

## Right-Click Menu Options
| Menu Item | Description |
|-----------|-------------|
| None | No custom context menu options are defined for this script. |

## Settings Files
- **Filename**: None
- **Location**: N/A
- **Purpose**: This script operates on map data generated by the import process and does not require external XML settings files.

## Tips
- **Performance Optimization**: If your model becomes sluggish after importing a large number of MEP items, select them all and change the **Detail level** property to "Medium detail" or "Low detail". This replaces complex solids with simpler geometry.
- **Missing Geometry**: If an imported item only displays as the text "MEP", it means the import data did not contain sufficient geometric information (centerlines or bodies) for the script to visualize.

## FAQ
- **Q: Can I insert this script manually?**
  **A:** While technically possible via `TSLINSERT`, manual insertion will not produce useful geometry because the script relies on map data generated during the import process to define the shape and size of the MEP object.

- **Q: Why do some ducts look like simple boxes instead of complex shapes?**
  **A:** The **Detail level** is likely set to "Medium detail." Change the property to "High detail" to attempt to display the exact original geometry. If it remains a box, the original complex data may not have been available in the import.

- **Q: What happens if the imported solid is invalid?**
  **A:** The script attempts to repair or redraw it. Depending on your **Visual style invalid body** setting, it will draw the faces as a solid, a hollow shell, or a wireframe.