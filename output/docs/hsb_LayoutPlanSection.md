# hsb_LayoutPlanSection.mcr

## Overview
This script generates a 2D schematic section or layout representation of a timber element directly within Paper Space or on a Shop Drawing page. It projects the geometry of beams onto a 2D plane and allows users to customize the display symbol (e.g., cross, circle, line) for specific beam types such as studs, plates, and headers.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | No | This script is designed for documentation output. |
| Paper Space | Yes | Requires selection of a Viewport containing an hsbCAD element. |
| Shop Drawing | Yes | Supports "Multipage" Shopdraws by selecting a View entity. |

## Prerequisites
- **Required Entities**: A viewport in a Layout tab displaying an hsbCAD element, OR a Shopdraw View entity in a multipage drawing.
- **Minimum Beams**: None (works on empty elements, though nothing will be drawn).
- **Required Settings**: None.

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Select `hsb_LayoutPlanSection.mcr` from the list.

### Step 2: Select Drawing Space
A dialog or command line prompt will appear to define the working environment:
```
Command Line: |Drawing space|
Options: |paper space| or |shopdraw multipage|
Action: Select the appropriate context where you want to generate the section.
```

### Step 3: Select Source View
Depending on your selection in Step 2, follow the corresponding prompt:

**If Paper Space:**
```
Command Line: Select the viewport from which the element is taken
Action: Click on the viewport frame in the Layout tab that displays the 3D element you wish to detail.
```

**If Shopdraw Multipage:**
```
Command Line: |Select the view entity from which the module is taken|
Action: Select the Shopdraw View entity associated with the desired module.
```

### Step 4: Configure Display (Post-Insertion)
After insertion, select the generated script object and open the **Properties Palette**. Configure the display symbols for various beam types (e.g., Studs, Top Plates) to control how they appear in the 2D projection. 

To refresh the drawing after changing properties, run a recalculation (e.g., `TSLUPDATE` or use the hsbCAD update function).

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| **Drawing space** | dropdown | `|paper space|` | Sets the context: Paper Space (Viewport) or Shopdraw Multipage. |
| **Jack Over Opening** | text | N | Display symbol: `X` (Cross), `-` (Line), `/` (Slash), `\` (Backslash), `O` (Circle), `S` (Shadow/Outline), `N` (Hidden). |
| **Jack Under Opening** | text | N | Display symbol for this beam type (see codes above). |
| **Cripple Stud** | text | X | Display symbol for this beam type. |
| **Transom** | text | - | Display symbol for this beam type. |
| **King Stud** | text | X | Display symbol for this beam type. |
| **Sill** | text | N | Display symbol for this beam type. |
| **Angled TopPlate Left/Right** | text | S | Display symbol for angled top plates. |
| **TopPlate** | text | S | Display symbol for top plates. |
| **Bottom Plate** | text | S | Display symbol for bottom plates. |
| **Blocking** | text | N | Display symbol for blocking. |
| **Stud** | text | X | Display symbol for standard studs. |
| **Stud Left/Right** | text | X | Display symbol for left/right specific studs. |
| **Header** | text | N | Display symbol for headers. |
| **Brace** | text | N | Display symbol for bracing. |
| **Beam** | text | N | Display symbol for general beams. |

*Note: There are additional properties for specific sub-components (Locating Plate, Packer, SolePlate, etc.) which follow the same symbol logic.*

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| *None* | This script does not add specific custom items to the right-click context menu. |

## Settings Files
- None used.

## Tips
- **Symbol Codes**: Use `S` for "Shadow Only" to create clean structural outlines without internal hatching or crosses.
- **Hiding Details**: Use `N` (None) to hide complex or irrelevant elements like blocking or braces to keep the drawing clean.
- **Placement**: Ensure your script insertion point is roughly where you want the schematic to appear, though it links to the selected viewport's coordinates.
- **Updates**: If you modify the 3D model, ensure the script updates to reflect changes in geometry.

## FAQ
- **Q: Why does my script disappear immediately after insertion?**
  A: The script has a built-in check to prevent duplicate instances. If you insert it twice on the same viewport/view, the second instance will erase itself.
  
- **Q: Can I use this on a standard AutoCAD viewport without hsbCAD data?**
  A: No. The selected viewport must contain a valid hsbCAD Element (generated by hsbCAD) for the script to extract geometry.

- **Q: What is the difference between 'S' and 'N'?**
  A: `S` draws the outline (shadow profile) of the beam. `N` draws nothing, effectively hiding that beam type completely.