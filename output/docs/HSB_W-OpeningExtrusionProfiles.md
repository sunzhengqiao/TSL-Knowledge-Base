# HSB_W-OpeningExtrusionProfiles.mcr

## Overview
This script automatically applies the correct wall finish profile (e.g., weatherboarding, feather edge, or shiplap) to the structural beams surrounding a selected window or door opening. It ensures that trimmers and cripples match the wall's surface profile instead of remaining as standard rectangular timber sections.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | Script operates directly on 3D wall elements and openings. |
| Paper Space | No | This script does not generate 2D drawings or annotations. |
| Shop Drawing | No | This is a modeling script, not a detailing tool. |

## Prerequisites
- **Required Entities**: An existing `OpeningSF` (window or door) inserted into a timber wall (`Element`).
- **Minimum Beam Count**: The parent wall element must contain at least 2 beams.
- **Required Settings**: None.

## Usage Steps

### Step 1: Launch Script
1. Type `TSLINSERT` in the command line.
2. Navigate to the location of `HSB_W-OpeningExtrusionProfiles.mcr`.
3. Select the file and click **Open**.

### Step 2: Select Opening
```
Command Line: Select an opening
Action: Click on a window, door, or generic opening object in your 3D model.
```
*Note: The script will automatically detect the parent wall and process the surrounding beams.*

### Step 3: Automatic Processing
Once selected, the script will:
1. Identify the target profile (inherited from the wall element or an existing finished beam).
2. Apply this profile to all relevant trimmers/cripples around the opening.
3. Automatically delete itself from the model.

## Properties Panel Parameters

This script does not expose any editable parameters in the Properties Palette. All configuration is derived from the existing wall element and beams.

## Right-Click Menu Options

No custom context menu options are assigned to this script.

## Settings Files

No external settings files are required for this script.

## Tips
- **Automatic Cleanup**: It is normal for the script instance to disappear immediately after running. It is designed as a "fire and forget" tool that modifies existing beams rather than creating a new persistent object.
- **Profile Detection**: If the wall element does not have a default extrusion profile defined, the script will scan the wall to find the first non-rectangular beam (e.g., a standard stud with a profile) and use that profile for the opening trimmers.
- **Selective Updates**: The script intentionally skips standard rectangular structural beams. It only updates beams that are generated by a specific construction module (macro), ensuring only the finishing components are modified.

## FAQ
- **Q: Why did the script disappear after I selected the opening?**
  - A: This is intended behavior. The script performs a one-time update on the beams and erases itself to prevent duplicate data in your project.
- **Q: The script didn't change the main wall studs.**
  - A: The script is designed to only update "Module" generated beams (like trimmers and headers created by opening macros). It ignores standard wall studs to preserve the structural integrity of the main wall.
- **Q: What happens if my wall doesn't have a finish profile yet?**
  - A: The script will look for any finished beam in the current wall to determine what shape to use. If all beams are rectangular, no changes will be made.