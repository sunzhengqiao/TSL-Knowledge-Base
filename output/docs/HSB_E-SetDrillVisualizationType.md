# HSB_E-SetDrillVisualizationType.mcr

## Overview
This script allows you to batch update the visualization style (e.g., realistic, schematic, or 2D lines) of drill holes generated by the `CNC_DrillElement` script. It filters beams based on attributes like Beam Code, Material, or Label and applies specific catalog settings to the drill holes within selected Elements.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | Select Elements in the 3D model to update their drill visualization. |
| Paper Space | No | Not intended for use in Layouts. |
| Shop Drawing | No | Does not process 2D drawing details. |

## Prerequisites
- **Required Entities**: Elements containing beams with drill holes (`CNC_DrillElement` instances already attached).
- **Minimum Beam Count**: N/A (Operates on Elements).
- **Required Settings**: Catalog entries for `CNC_DrillElement` must exist to define the visualization styles.

## Usage Steps

### Step 1: Launch Script
Run the command `TSLINSERT` (or select the script from the hsbCAD toolbar/menu) and select `HSB_E-SetDrillVisualizationType.mcr`.

### Step 2: Configure Settings
If the script is not run via a predefined catalog execute key, a dialog appears (or check the AutoCAD Properties Palette).
1.  **Define Filters**: Specify which beams to target using Beam Code, Label, Material, or hsbId. Supports wildcards (e.g., `WALL*`).
2.  **Set Mode**: Choose whether to `Include` matching beams (apply changes only to them) or `Exclude` matching beams (apply changes to everything else).
3.  **Select Visualization**: Choose the target script name (default: `CNC_DrillElement`) and the **Visualization Type** (Catalog entry) you wish to apply.
4.  **Deletion Option**: Choose `Yes` or `No` for "Delete TSLs that don't match filters" to remove drills from excluded beams.

### Step 3: Select Elements
```
Command Line: |Select one or more elements|
Action: Click on the Element(s) in the model or draw a selection window. Press Enter to confirm.
```

### Step 4: Execution
The script processes all beams within the selected Elements.
- Matching beams have their drill hole visualization updated to the chosen catalog style.
- Depending on your deletion setting, non-matching drill TSLs may be removed.
- **Note**: The script instance will automatically erase itself from the model after processing is complete.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| **Selection Category** | | | |
| Include/exclude | Dropdown | \|Include\| | Determines if the filters select beams to process ("Include") or to ignore ("Exclude"). |
| Filter beams with beamcode | Text | | Enter a Beam Code (supports wildcards like `STUD*`). |
| Filter objects with label | Text | | Enter a Label (supports wildcards). |
| Filter objects with material | Text | | Enter a Material name (e.g., `C24`). |
| Filter objects with hsb id | Text | | Enter an hsbId. |
| **Drill Category** | | | |
| Scriptname drill tsl | Text | CNC_DrillElement | The name of the TSL script to target. |
| Visualization Type | Dropdown | | Select the Catalog entry defining the visual style (color, 3D body, etc.). |
| **Other** | | | |
| Delete TSLs that don't match filters | Dropdown | \|No\| | If set to `Yes`, drills on excluded beams are permanently deleted. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | This script does not have persistent right-click menu options as it erases itself after running. |

## Settings Files
- **Catalog Entries**: `CNC_DrillElement`
- **Location**: hsbCAD Catalog (TslTabs or Catalog database)
- **Purpose**: Provides the preset visualization styles applied by this script.

## Tips
- **Wildcards**: Use `*` in filter fields (e.g., `FLOOR*` in Beam Code) to select multiple beam types at once.
- **Safety**: The "Delete TSLs" option is irreversible for the specific session. Use `No` initially to preview changes, then re-run with `Yes` if needed to clean up unwanted drills.
- **Persistence**: Once the script runs, it disappears from the model. To change settings again, simply re-insert the script and select the elements.
- **Apply to All**: If all filter fields are left empty, the script automatically applies the visualization changes to **all** beams in the selected Element.

## FAQ
- **Q: Why did the script disappear after I selected the elements?**
  - A: This is a utility script designed to perform a "batch update" and then self-destruct to keep your model clean. The changes applied to the drill holes remain.
- **Q: Can I undo the changes?**
  - A: Yes, you can use the standard AutoCAD `UNDO` command immediately after running the script.
- **Q: Nothing happened when I ran the script.**
  - A: Ensure the selected Elements actually contain beams with the `CNC_DrillElement` script attached. Also, check that your filters are not excluding all beams.