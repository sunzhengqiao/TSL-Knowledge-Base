# hsb_JamesJonesImport.mcr

## Overview
This script imports structural floor framing data (I-Joists and beams) generated by James Jones design software into the hsbCAD model. It processes external IFC files to generate native timber elements within the specified project groups.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | The script must be inserted into the Model Space to generate geometry. |
| Paper Space | No | Not supported for layout views. |
| Shop Drawing | No | Not applicable for shop drawing generation. |

## Prerequisites
- **External Dependency**: The file `hsbSteicoIO.dll` must be present in the `hsbCAD\Utilities\hsbCloudStorage\` directory.
- **Source Data**: A valid IFC file exported from James Jones software is required (usually selected via a dialog during the import process).
- **Entities**: No existing beams or entities are required to run the script.

## Usage Steps

### Step 1: Launch Script
```
Command: TSLINSERT
Action: Select 'hsb_JamesJonesImport.mcr' from the file dialog and click Open.
```

### Step 2: Configure Import Groups
Upon insertion, a configuration dialog or the Properties Palette will appear allowing you to set the destination for the imported elements.

```
Action: Verify or modify the Group Names.
- Set "IJoist Group Name" to where you want joists stored (e.g., "Floor1\I-Joists").
- Set "Beam Group Name" to where you want beams stored (e.g., "Floor1\Beams").
```

### Step 3: Execute Import
```
Action: The script will automatically launch the external James Jones IFC importer.
Dialog: Select the source IFC file provided by the engineer/designer when prompted.
```

### Step 4: Generate Model
```
Action: The script processes the file and generates the GenBeams.
Result: The structural elements appear in the 3D model and in the Project Browser under the groups specified in Step 2.
Note: The script instance will automatically delete itself from the drawing once the import is complete.
```

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| IJoist Group Name | text | I-Joists\Ground_Floor | The folder path in the Project Browser where the imported I-Joists will be placed. Use backslashes (\) to create subfolders. |
| Beam Group Name | text | Beams\Ground_Floor | The folder path in the Project Browser where the imported structural beams (rim joists, trimmers) will be placed. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | This script does not add specific options to the right-click context menu. |

## Settings Files
- **None**: No specific XML settings files are used by this script. Configuration is handled via Properties and the external DLL.

## Tips
- **Script Deletion**: This script acts as a one-time utility. It automatically deletes itself (`eraseInstance`) after generating the geometry. You cannot right-click the script to update later; to re-import, you must run the `TSLINSERT` command again.
- **Organization**: Use the `Group Name` properties to keep your model organized. For example, use `Level 01\Joists` and `Level 01\Beams` to separate floors.
- **Manual Modification**: Once imported, the beams and joists are standard hsbCAD elements. You can manually grip-edit them or change their properties via the Properties Palette.

## FAQ
- **Q: The script disappeared after I ran it. Is that normal?**
  **A:** Yes. This is a "run-once" import script. It creates the geometry and removes itself to prevent clutter in the drawing.
- **Q: How do I change the material or size of the imported beams?**
  **A:** Select the imported beams in the model and change their properties in the AutoCAD Properties Palette (Press Ctrl+1).
- **Q: What happens if I run the script twice?**
  **A:** It will attempt to import the data again. You may end up with duplicate elements if you do not delete the first import or if the external DLL settings create new instances rather than updating existing ones.