# HSB_G-ExportTSLCatalogToXML.mcr

## Overview
This utility script converts TSL catalog XML files from the company catalog folder into a standardized XML format and saves them to the settings folder. It is designed for administrators to update or migrate script definitions and automatically removes itself from the drawing after execution.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | This is a utility script that operates in the background and does not create geometry. |
| Paper Space | No | Not supported. |
| Shop Drawing | No | Not supported. |

## Prerequisites
- **Required Entities**: None.
- **Minimum Beam Count**: 0.
- **Required Settings**:
  - Valid XML catalog files must exist in the `_kPathHsbCompany\Tsl\Catalog` folder.
  - User must have write permissions for the `_kPathHsbCompany\Tsl\Settings` folder.

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Select `HSB_G-ExportTSLCatalogToXML.mcr`

### Step 2: Select Catalog to Export
```
Properties Palette / Dynamic Dialog: Catalog to export
Action: Click the dropdown menu and select the desired XML file name from the list found in your Catalog folder.
```
*Note: Once a file is selected, the script will immediately process the file.*

### Step 3: Verification
The script instance will vanish from the drawing. Check the `Tsl\Settings` folder to confirm the new XML file has been created.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Catalog to export | dropdown | (First file found) | Select the specific XML catalog file from the `Tsl\Catalog` folder that you wish to convert and export. |

## Right-Click Menu Options
*(None - The script erases itself immediately after running, so no context menu is available.)*

## Settings Files
- **Input Filename**: `*.xml`
- **Input Location**: `_kPathHsbCompany\Tsl\Catalog`
- **Purpose**: Provides the source data for property definitions (e.g., PropString, PropDouble, HSB_NAME) to be converted.

- **Output Filename**: `[SelectedName]Catalog.xml`
- **Output Location**: `_kPathHsbCompany\Tsl\Settings`
- **Purpose**: The standardized XML file generated by the script, containing the parsed catalog data.

## Tips
- **Automatic Cleanup**: Do not be alarmed if the script block disappears immediately after insertion; this is the intended behavior for a utility script.
- **File Naming**: The output file will be named after the file you selected in the dropdown, with "Catalog.xml" appended (e.g., selecting "Wall.xml" results in "WallCatalog.xml").
- **Permissions**: If the script seems to fail silently, ensure you have write access to your company's `Tsl\Settings` folder.

## FAQ
- **Q: Where did the script go after I inserted it?**
  A: This is a "self-destructing" utility script. It performs the file conversion and deletes its own instance from the drawing immediately afterwards.

- **Q: How do I know if the export was successful?**
  A: Navigate to your `Tsl\Settings` folder (defined in your hsbCAD Company Path) and look for the newly created `.xml` file with the timestamp or check the file size to ensure it contains data.

- **Q: Can I use this to modify existing catalogs?**
  A: This script is primarily for exporting/converting existing catalog definitions into the settings folder format. To modify properties, you would typically edit the source XML or use other configuration tools.