# hsb_CavityCloser

## Overview
This script automatically calculates the total linear meterage of timber required for cavity closers based on wall openings. It exports this data as a non-physical BOM entry (material list) attached to the wall, including a standard 15% waste allowance.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | The script must be attached to ElementWallSF entities in the 3D model. |
| Paper Space | No | Not applicable for layout views. |
| Shop Drawing | No | Does not generate 2D drawings or shop views. |

## Prerequisites
- **Required Entities**: The script requires `ElementWallSF` entities that contain `OpeningSF` entities (windows or doors).
- **Minimum Beam Count**: 0.
- **Required Settings**: None.

## Usage Steps

### Step 1: Launch Script
1.  Type `TSLINSERT` in the command line.
2.  Select `hsb_CavityCloser.mcr` from the file list.
3.  Click **Open**.

### Step 2: Select Walls
```
Command Line: Select a set of elements
Action: Click on the walls (ElementWallSF) you wish to process. You can select multiple walls.
```

### Step 3: Configure Properties (Optional)
1.  After selection, the script attaches to the selected walls.
2.  If this is the first time running the script, a properties dialog may appear automatically.
3.  Alternatively, select a wall and press `Ctrl+1` to open the **Properties Palette** to adjust Timber Width, Height, and other settings.

### Step 4: Review Results
1.  The script calculates the timber length automatically.
2.  To see the calculated material, look at the wall's BOM/Element Items. An entry named `CAVITYCLOSER` will be added with the total length required.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Timber Width | Text | "38" | The cross-sectional width (in mm) of the timber stock to be used. |
| Timber Height | Text | "50 Sawn" | The cross-sectional height/depth of the timber stock. |
| Timber Length | Text | "4800" | The standard stock length (in mm) of the timber available for cutting. |
| DimStyle | Dropdown | <None> | Select a specific dimension style for text display (if applicable). |
| Show In Display Rep | Dropdown | <None> | Controls in which display representations the script is visible. |
| Set the Text Color | Number | 171 | Determines the color of any text generated by the script. |
| Offset Between Lines | Number | 100 | Sets the vertical offset (in internal units) between lines of text display. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | This script does not add specific items to the right-click context menu. |

## Settings Files
- **Filename**: None
- **Location**: N/A
- **Purpose**: N/A

## Tips
- **Waste Calculation**: The script automatically adds 15% to the calculated length to account for cutting waste.
- **Door vs Window Logic**: The calculation logic differs based on the opening type:
    - **Doors**: Calculates `Width * 1.15`.
    - **Windows/Others**: Calculates `(Height * 2) * 1.15`.
- **Automatic Cleanup**: If you delete all openings from a wall, the script will detect this and remove itself automatically to keep the project clean.
- **Updating Data**: If you resize a window or door, the script will recalculate the material length the next time the model regenerates.

## FAQ
- **Q: Where can I see the calculated total length?**
- **A:** The script creates an "ElemItem" attached to the wall. You can view this in your BOM/Material List exports or by querying the element items of the specific wall.

- **Q: The script disappeared from my wall.**
- **A:** This happens if the wall has no openings or is deleted. Ensure your wall has valid Door or Window entities attached.

- **Q: How do I change the timber size used for the calculation?**
- **A:** Select the wall, open the Properties Palette (Ctrl+1), and modify the "Timber Width" or "Timber Height" fields. The BOM entry will update accordingly.