# HSB_OpeningWeight.mcr

## Overview
This script assigns a specific weight (in Kg) to openings (such as windows or doors) and generates a text label in the model. This data is used by the `hsbCenterOfGravity` script to accurately calculate the structural load and center of gravity for timber elements.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | The script interacts directly with 3D Opening and Element entities. |
| Paper Space | No | Not applicable for drawing views. |
| Shop Drawing | No | Not applicable for manufacturing layouts. |

## Prerequisites
- **Required Entities**: An existing **Opening** entity hosted within a valid **Element** (Wall/Roof).
- **Minimum beam count**: None.
- **Required settings files**: None.

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Browse and select `HSB_OpeningWeight.mcr`.

### Step 2: Configure Properties
Upon launching, the Properties Palette (OPM) will open, or a dialog will appear asking you to configure the settings for the batch of openings you are about to select.
- **Action**: Enter the **Weight** (Kg) for the window/door unit.
- **Action**: Adjust the **Text Format** or **Layer** if necessary.
- **Action**: Close the dialog/Properties Palette to confirm settings.

### Step 3: Select Openings
```
Command Line: Select openings
Action: Click on the desired openings (windows/doors) in the 3D model. You can select multiple openings at once.
```

### Step 4: Apply and Continue
```
Command Line: ...
Action: Press Enter or Right-Click to confirm the selection.
```
- The script will attach to the selected openings and draw the text label at their center points.
- The Properties dialog will re-open, allowing you to enter a different weight for the next batch of openings.

### Step 5: Finish
```
Action: Press ESC or make an empty selection (press Enter without selecting) to exit the command.
```

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| |Weight| | Number | 0 | Defines the physical mass of the opening object (e.g., glazing unit) in Kilograms. **Note:** Entering 0 will disable the data mapping, causing the structural gravity calculation to ignore this opening. |
| |Text Format| | Text | @(OpeningStickDescription) - \n @(CenterOfGravity.Weight) | Determines the content of the label. You can use dynamic tokens (e.g., @(Width), @(Height)) to display specific opening data. |
| |Dimension Style| | Dropdown | _DimStyles | Sets the visual style (font, size) for the text label. Select from available styles in your drawing. |
| |Text Layer| | Dropdown | Tooling | Specifies the CAD layer on which the text label is created. Options include Tooling, Information, Zone, or Element. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | There are no custom context menu options for this script. All modifications are made via the Properties Palette. |

## Settings Files
No external settings files are required for this script.

## Tips
- **Batch Processing**: Use the loop functionality to assign different weights to different types of openings (e.g., 50kg for standard windows, 200kg for sliding doors) in a single command execution without restarting the script.
- **Structural Calculation**: Ensure you input a value greater than 0 for openings that contain heavy inserts (glass, machinery), otherwise they will be treated as empty holes by the `hsbCenterOfGravity` script.
- **Visibility**: If the labels clutter your view, you can use the `sTextLayer` property to place them on a layer that is currently frozen or turned off.

## FAQ

**Q: What happens if I set the Weight to 0?**
A: The script will still draw the label (unless you format the text to hide the weight), but it will **not** write the weight data to the element. Consequently, the structural center of gravity calculation will treat the opening as empty space.

**Q: How do I change the weight after the script is already applied?**
A: Select the Opening (or the text label generated by the script), open the **Properties Palette (Ctrl+1)**, locate the `HSB_OpeningWeight` section, and modify the `Weight` value. The text label and calculation data will update automatically.

**Q: Can I edit the text label manually?**
A: No, the text is dynamically generated by the script. To change what it says, modify the `Text Format` property in the palette. You can erase the text entity if you no longer wish to see it, but the weight data will remain attached to the opening until the TSL instance is removed.