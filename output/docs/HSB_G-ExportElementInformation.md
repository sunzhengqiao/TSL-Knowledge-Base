# HSB_G-ExportElementInformation

## Overview
Exports graphical data (text and polylines) stored within specific Element Information TSL instances to a standalone DXF file.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | This script runs in the 3D model environment. |
| Paper Space | No | Not intended for layout views. |
| Shop Drawing | No | Not intended for 2D shop drawings. |

## Prerequisites
- **Required entities**: Element Information TSL instances (`TslInst`) that contain internal map data named 'Dxf'.
- **Minimum beam count**: 0
- **Required settings**: The target TSL instances must have been generated by a script that stores 'Text' and 'PLine' data in a map structure.

## Usage Steps

### Step 1: Launch Script
Execute the command `TSLINSERT` in the command line and select `HSB_G-ExportElementInformation.mcr` from the file browser.

### Step 2: Configure Export Settings
A dialog titled "Dxf output" will appear immediately upon insertion.
- **Filename**: Enter a valid name for the output file (e.g., `Labels`). **Do not leave this blank.**
- **Dxf version**: Select the desired compatibility version (e.g., 2000, 2004, 2010, or leave as 0 for the current version).

### Step 3: Select Elements
```
Command Line: Select the element information tsls
Action: Click on the TSL instances (Element Information markers) in the model that you wish to export data from. Press Enter to confirm selection.
```

### Step 4: Generate File
The script will process the selection, extract the graphical data, and save it as a DXF file in the same folder as your current drawing.
- A message will appear in the command line confirming success (e.g., "File created: [path]") or failure.
- The script instance will automatically erase itself from the drawing upon completion.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Dxf version | dropdown | 0 (Current) | Sets the format version of the exported DXF file. Use 0 for the current CAD version, or select a specific year (e.g., 2000, 2004) for compatibility with older systems. |
| Filename | text | [Empty] | The name of the DXF file to be created. This field is mandatory; if left empty, the export will fail. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | This script runs immediately upon insertion and does not provide context menu options. |

## Settings Files
- **Filename**: None required.
- **Location**: N/A
- **Purpose**: N/A

## Tips
- **File Location**: The exported DXF file is always saved in the folder where your current DWG is located (`_kPathDwg`).
- **Cleaning Up**: You do not need to delete the script instance manually; it is designed to erase itself after running.
- **Data Source**: If the export creates an empty file, ensure you selected TSLs that actually contain "Dxf" data (check with your administrator if the Element Information script supports this export).

## FAQ
- **Q: Why did the script disappear after I ran it?**
  - A: This is normal behavior. The script acts as a temporary command tool and erases itself once the export process is finished to keep your drawing clean.
  
- **Q: I received a "File could not be created" error. What went wrong?**
  - A: This usually happens if the "Filename" property was left empty or contained invalid characters. Check the command line for the specific path mentioned in the error.

- **Q: Where can I find the exported file?**
  - A: It is saved in the exact same directory as your current project drawing.