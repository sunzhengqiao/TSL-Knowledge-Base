# HSB_T-SquareBeamCut.mcr

## Overview
This script is a utility tool used to correct and standardize static beam cuts (BeamCut tools) on selected beams. It automatically recalculates the geometry of existing cuts to ensure they are orthogonal (squared) and properly aligned with the beam's local coordinate system based on the longest intersecting side.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | Yes | This script operates in the 3D model on standard beams. |
| Paper Space | No | This script does not function in Paper Space or on 2D views. |
| Shop Drawing | No | This script does not generate or modify shop drawing layouts. |

## Prerequisites
- **Required Entities**: At least one `GenBeam` (Beam) containing static `BeamCut` tools.
- **Minimum Beam Count**: 1.
- **Required Settings**: None.

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Select `HSB_T-SquareBeamCut.mcr` from the file dialog.

### Step 2: Select Beam(s)
```
Command Line: Select beam(s)
Action: Click on one or multiple beams in the model that contain the beam cuts you wish to square/correct. Press Enter or Right-click to confirm selection.
```

### Step 3: Automatic Processing
The script will automatically iterate through the selected beams. It will find all static beam cuts, check their orientation, and replace any misaligned cuts with newly calculated orthogonal ones. The script instance will then delete itself from the drawing.

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| None | N/A | N/A | This script does not expose editable parameters in the Properties Palette. It runs as a one-time command. |

## Right-Click Menu Options

| Menu Item | Description |
|-----------|-------------|
| None | N/A | This script instance erases itself immediately after execution, so there are no context menu options available. |

## Settings Files
- **Filename**: None
- **Location**: N/A
- **Purpose**: This script does not rely on external XML settings files.

## Tips
- **Use for Cleanup**: This is ideal for fixing beam cuts that were imported from other files, manually created with errors, or generated by older scripts.
- **Alignment**: The script forces the cut to align with the "longest side" relative to the beam's local system, ensuring consistent manufacturing data.
- **Selection**: You can select multiple beams at once to process an entire frame or assembly quickly.
- **Safety**: The script performs internal validation checks (Ray Intersection and Vertex Count). If a cut geometry is invalid or cannot be recalculated, the script will skip that specific cut to prevent data loss, leaving the original untouched.

## FAQ
- **Q: What exactly does "Squaring" a beam cut mean?**
  **A**: It means recalculating the cutting volume so that its sides are perfectly perpendicular (90 degrees) to the beam's local axes, rather than being skewed or rotated arbitrarily.
- **Q: Will this script delete my cuts if it fails?**
  **A**: No. If the script encounters invalid geometry that it cannot process, it will preserve the original beam cut and move to the next one.
- **Q: Why did the script disappear after I ran it?**
  **A**: This is a "command-style" script. It performs its task once and then erases its own instance from the drawing to keep the project clean. To use it again, simply run `TSLINSERT` again.