# sd_LabelColEntInView.mcr

## Overview
This script generates a Bill of Materials (BOM) schedule or simple position labels for metal parts (connectors) within a specific Shop Drawing view. It automatically annotates connectors visible in the selected viewport with their position numbers, dimensions, and material properties.

## Usage Environment
| Space | Supported | Notes |
|-------|-----------|-------|
| Model Space | No | This script is designed for annotation in layouts. |
| Paper Space | Yes | Requires a valid Shop Drawing viewport to function. |
| Shop Drawing | Yes | It detects entities specific to Shop Drawings (ShopDrawView). |

## Prerequisites
- **Required Entities**: A valid Shop Drawing viewport (`ShopDrawView`) and Metal Parts (Connectors) inside that view.
- **Minimum Beam Count**: 0 (This script focuses on metal parts, not structural beams).
- **Required Settings**: None.

## Usage Steps

### Step 1: Launch Script
Command: `TSLINSERT` â†’ Select `sd_LabelColEntInView.mcr` from the file dialog.

### Step 2: Select Shop Drawing View
```
Command Line: (No specific prompt text detected)
Action: Click on the border of the Shop Drawing viewport you wish to annotate.
```

### Step 3: Specify Insertion Point
```
Command Line: (No specific prompt text detected)
Action: Click in Paper Space to define the origin point for the table or label reference.
```

## Properties Panel Parameters

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| Show List | dropdown | \|No\| | Determines the output mode. Select `|No|` to draw simple position tags on parts only. Select `|Yes|` to generate a full BOM table in addition to the tags. |
| Dimstyle | dropdown | Standard | Selects the text style and size for the annotations. It uses the system's available dimension styles to control text height and font. |
| Color | number | 1 | Sets the CAD color index (1-255) for all text and lines generated by the script. |

## Right-Click Menu Options
This script does not add custom items to the right-click context menu. Editing is done via the Properties Panel and grips.

## Settings Files
No external settings files (XML) are required or used by this script.

## Tips
- **Resizing the Table**: If `Show List` is set to `|Yes|`, you can select the script instance and drag the **Grip Point** (usually the second point) to adjust the width of the BOM table. The text and columns will scale automatically.
- **Switching Modes**: If your drawing becomes too cluttered, change `Show List` to `|No|`. This removes the table but keeps the position markers (e.g., "M1", "M2") on the metal parts.
- **Text Consistency**: Ensure your selected `Dimstyle` is set to the correct height for your drawing scale; otherwise, the text may appear too large or too small in the viewport.
- **Placement**: Place the insertion point where there is enough empty space for the table to expand if you plan to use the BOM mode.

## FAQ
- **Q: I inserted the script, but no text or table appeared. Why?**
  A: Ensure you selected a valid Shop Drawing viewport that contains Metal Parts (Connectors). If the viewport has no connectors or the view data is not fully generated, the script will produce no output.
- **Q: Can I label beams with this script?**
  A: No, this script is specifically designed to label `MetalPartCollectionEnt` (connectors/hardware). It does not label structural timber beams.
- **Q: How do I change the text font?**
  A: You cannot change the font directly in the script properties. Instead, create or modify an AutoCAD Dimension Style with your desired font and assign that style to the `Dimstyle` property of this script.