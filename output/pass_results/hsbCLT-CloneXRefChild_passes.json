{
  "filename": "hsbCLT-CloneXRefChild.mcr",
  "status": "completed",
  "total_tokens": 37514,
  "processing_time": 1762.970426082611,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \"minorVersion\": 10,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.10\",\n      \"date\": \"03.11.2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"HSB-24830: Support the previous styles TT,TL\"\n    },\n    {\n      \"version\": \"1.9\",\n      \"date\": \"17.10.2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"HSB-24722: Change TT->DQ and TL->DL\"\n    },\n    {\n      \"version\": \"1.8\",\n      \"date\": \"23.09"
      },
      "tokens_used": 9323,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit usage of _kModelSpace in Group().collectEntities(true, MasterPanel(), _kModelSpace) and tslNew.dbCreate(..., _kModelSpace, ...). Operates on structural 3D entities (ChildPanel, MasterPanel, Sip). No Paper Space (_kPaperSpace), viewport handling, or ShopDrawing specific patterns (sd_*, #Type E) detected. The script executes on insertion (_bOnInsert) and self-deletes (eraseInstance), behaving as a model generation tool."
        },
        "prerequisites": {
          "requiredEntities": [
            "ChildPanel",
            "MasterPanel"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Catalog entry for script 'klhMasterPanelManager' (required when using Option 1)",
            "Valid MasterPanelStyle and SipStyle definitions in the catalog"
          ]
        }
      },
      "tokens_used": 7338,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert && _kExecuteKey.length()==0",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "|Select entitys|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrPoint",
              "promptOriginal": "|Select point|",
              "condition": "_bOnInsert && iOption==0",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "Insertion (unless executed via command key)",
            "title": null,
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sOption",
            "type": "PropString",
            "displayName": "|Option|",
            "defaultValue": "Only Childs",
            "inputType": "dropdown",
            "options": [
              "Only Childs",
              "Childs + Master panel + klhMasterPanelManager"
            ],
            "category": "|General|",
            "description": "|Defines the Option|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6956,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Clones CLT child panels from external reference (XRef) drawings into the current model, with options to either insert loose panels or generate a fully configured manufacturing assembly.",
          "category": "Data Import / Model Generation",
          "typicalUseCase": "Transferring architectural CLT layouts from referenced architectural drawings into the production model for detailing, nesting, and manufacturing."
        },
        "parameters": [
          {
            "name": "sOption",
            "technicalDefault": "Only Childs",
            "businessMeaning": "Defines the scope of the cloning operation: whether to import loose panels for manual placement or to wrap them in a new MasterPanel structure with automation scripts for production.",
            "validRange": "Only Childs; Childs + Master panel + klhMasterPanelManager",
            "unit": "Selection",
            "affectsOutput": "Determines if a new MasterPanel container and the 'klhMasterPanelManager' script are generated. Option 1 creates manufacturing groups and nests panels; Option 0 places them as loose geometry based on a user-selected insertion point."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sOption set to 'Only Childs'",
            "effect": "Enables the command-line prompt to select a target insertion point for the geometry transformation.",
            "cascade": [
              "Insertion Point Prompt"
            ]
          },
          {
            "trigger": "sOption set to 'Childs + Master panel...'",
            "effect": "Suppresses the insertion point prompt (places new MasterPanel at origin), creates Nesting Groups, and instantiates the 'klhMasterPanelManager' script.",
            "cascade": [
              "MasterPanel Creation",
              "TSL Instance Creation",
              "Group Structure"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "ChildPanel",
            "description": "Cloned timber panels derived from the XRef geometry, transformed to the new location or nested within the new MasterPanel.",
            "appliedTo": "ModelSpace (loose) or nested inside MasterPanel"
          },
          {
            "type": "MasterPanel",
            "description": "A new container element created to encapsulate the cloned child panels (only in Option 2), sized to fit the imported layout.",
            "appliedTo": "ModelSpace"
          },
          {
            "type": "TslInst",
            "description": "An instance of the 'klhMasterPanelManager' script attached to the new MasterPanel to handle automation and production logic (only in Option 2).",
            "appliedTo": "MasterPanel"
          },
          {
            "type": "Group",
            "description": "Logical groups in the project tree (e.g., 'Nesting\\[Name]' and optionally 'Nesting\\DQ-SelectionRule\\[Name]') used for organizing production output.",
            "appliedTo": "MasterPanel, ChildPanels, and TslInst"
          }
        ]
      },
      "tokens_used": 8753,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "API error 429: {\"error\":{\"code\":\"1302\",\"message\":\"您的账户已达到速率限制，请您控制请求频率\"}}"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-CloneXRefChild.mcr\n\n## Overview\nClones CLT child panels from external reference (XRef) drawings into the current model, with options to either insert loose panels for manual placement or generate a fully configured manufacturing assembly wrapped in a MasterPanel.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates entirely in 3D Model Space to generate structural elements. |\n| Paper Space | No | Not supported for layout generation. |\n| Shop Drawing | No | This is a model generation tool, not a detailing script. |\n\n## Prerequisites\n- **Required Entities**: An XRef drawing containing `ChildPanel` or `MasterPanel` entities must be loaded in the current drawing.\n- **Catalog Entries**: A valid catalog entry for the script `klhMasterPanelManager` is required if using the \"Childs + Master panel\" option.\n- **Styles**: Valid `MasterPanelStyle` and `SipStyle` definitions must exist in the catalog to assign attributes to the cloned panels.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `hsbCLT-CloneXRefChild.mcr`\n\n### Step 2: Configure Options\n```\nAction: A dialog appears automatically upon insertion.\nSelect Option:\n1. \"Only Childs\": Imports loose panels based on a selected point.\n2. \"Childs + Master panel + klhMasterPanelManager\": Creates a new MasterPanel group and assigns a management script automatically.\n```\n\n### Step 3: Select Entities\n```\nCommand Line: |Select entitys|\nAction: Click on the CLT panels (ChildPanels) in the XRef that you want to clone into the current model.\n```\n\n### Step 4: Select Insertion Point (Conditional)\n```\nCommand Line: |Select point|\nCondition: Only appears if \"Only Childs\" was selected in Step 2.\nAction: Click in the Model Space to define the origin point where the loose panels will be placed.\nNote: If \"Childs + Master panel...\" was selected, this step is skipped; the new assembly is placed automatically.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Option | dropdown | Only Childs | Defines the scope of the cloning operation. <br>**Only Childs**: Places loose geometry at a user-defined point.<br>**Childs + Master panel...**: Generates a manufacturing-ready group with nesting structures and automation scripts. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | The script instance removes itself from the drawing immediately after execution. No context menu options are available on the script instance. |\n\n## Settings Files\n- **Catalog Entry**: `klhMasterPanelManager`\n- **Location**: hsbCAD Catalog (TSL Scripts)\n- **Purpose**: Provides the production logic and automation for the generated MasterPanel when Option 2 is used.\n\n## Tips\n- **Production Workflow**: Use the \"Childs + Master panel + klhMasterPanelManager\" option when preparing data for manufacturing. This creates nesting groups and applies the necessary management script automatically.\n- **Manual Layout**: Use the \"Only Childs\" option if you need to manually position panels or integrate them into an existing structure not handled by the master panel logic.\n- **XRef Management**: Ensure the XRef is loaded and unloaded correctly before running the script to ensure the entity selection detects the geometry properly.\n\n## FAQ\n- **Q: Why didn't the script ask me for an insertion point?**\n- **A:** You likely selected the \"Childs + Master panel + klhMasterPanelManager\" option. This mode calculates the placement automatically to fit the new MasterPanel container, bypassing the manual point selection.\n- **Q: What happens to the original panels in the XRef?**\n- **A:** The original panels remain untouched in the XRef. The script creates new copies (clones) in the current model.\n- **Q: Can I use this on standard beams?**\n- **A:** No, this script is designed specifically for CLT panels (`ChildPanel` and `MasterPanel` entities)."
      },
      "tokens_used": 5144,
      "error": null
    }
  }
}