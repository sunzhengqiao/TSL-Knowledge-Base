{
  "filename": "hsbMatchProperties.mcr",
  "status": "completed",
  "total_tokens": 50180,
  "processing_time": 554.4760255813599,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.1",
            "date": "28may2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-7756 transparency, render material, zone, notes, line weight and  property sets added"
          },
          {
            "version": "1.0",
            "date": "27may2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6328,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getGenBeam(), PrEntity(), and iterates through _Beam, _Sheet, and _Sip arrays to modify physical properties (Width, Height, Material, Grade, etc.). It calls eraseInstance() at the end, indicating it is a utility command that modifies 3D model entities rather than creating or managing 2D shop drawing elements."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Beam",
            "Sheet",
            "Sip"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6024,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": \"|Select source entity|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select beams|\",\n        \"condition\": \"source.bIsKindOf(Beam())\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select sheets|\",\n        \"condition\": \"source.bIsKindOf(Sheet())\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select sip|\",\n        \"condition\": \"source.bIsKindOf(Sip())\",\n        \"required\": false\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"Insertion (unless _kExecuteKey is set)\",\n      \"title\": null,\n      \"dataSource\": \"OPM Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sColor\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Color|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Label|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSubLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|SubLabel|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sSubLabel2\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|SubLabel2|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sGrade\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Grade|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sInformation\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Information|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sMaterial\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Material|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Name|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"sBeamtype\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Beamtype|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"sIsotropic\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Isotropic|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"|No|\", \"|Yes|\"],\n      \"category\": \"|General|\",\n      \"description\": \"|Toggles if this property shall be mapped.|\"\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"shsbId\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|"
      },
      "tokens_used": 9002,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"A utility tool to copy specific properties (material, dimensions, layer settings, notes, etc.) from a source timber element to multiple selected target elements of the same type (Beam, Sheet, or Sip).\",\n    \"category\": \"Utility / Model Management\",\n    \"typicalUseCase\": \"Standardizing or updating attributes (like 'Grade', 'Material', or 'Width') for a selection of beams/sheets to match a reference element without recreating geometry.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sColor\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the display color (CAD layer color override) of the source entity.\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Visual appearance in the CAD model; no impact on physical properties.\"\n    },\n    {\n      \"name\": \"sLabel\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the main 'Label' (primary piece mark or position number).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Identification and numbering of the element in lists and drawings.\"\n    },\n    {\n      \"name\": \"sSubLabel\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the 'SubLabel' (secondary piece mark).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Secondary identification in lists and drawings.\"\n    },\n    {\n      \"name\": \"sSubLabel2\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the 'SubLabel2' (tertiary identifier).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Tertiary identification in lists and drawings.\"\n    },\n    {\n      \"name\": \"sGrade\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the timber strength grade (e.g., C24, GL24h).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Structural calculations and material reporting.\"\n    },\n    {\n      \"name\": \"sInformation\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the general 'Information' field (free text for comments/status).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Textual data attached to the entity, used for filtering or reporting.\"\n    },\n    {\n      \"name\": \"sMaterial\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the material definition (e.g., Spruce, LVL).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Physical properties (density, cost) and rendering texture.\"\n    },\n    {\n      \"name\": \"sName\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the 'Name' property (specific naming convention).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Entity naming in the project database.\"\n    },\n    {\n      \"name\": \"sBeamtype\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the 'Beamtype' (classification of element function).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Classification and filtering within hsbCAD.\"\n    },\n    {\n      \"name\": \"sIsotropic\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the material isotropy behavior (direction dependent properties).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"How the software handles material strength calculations or orientations.\"\n    },\n    {\n      \"name\": \"shsbId\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the internal hsbCAD unique ID (hsbId). Warning: Copying IDs causes conflicts.\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Internal database identity; typically should be 'No'.\"\n    },\n    {\n      \"name\": \"sGroup\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying group assignments (logical element groupings).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Logical grouping for manufacturing or export.\"\n    },\n    {\n      \"name\": \"sModule\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the Element Module assignment.\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Association with a specific building module or assembly.\"\n    },\n    {\n      \"name\": \"sZone\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the Zone assignment (fire zone, floor zone).\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Zoning classification for reporting and filtering.\"\n    },\n    {\n      \"name\": \"sTransparency\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Toggles copying the display transparency.\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"Percentage/Integer\",\n      \"affectsOutput\": \"Visual appearance in the CAD model.\"\n"
      },
      "tokens_used": 10062,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script executed by user (command or insert).",
          "System checks insert cycle count (prevents recursive loops).",
          "System checks for execution key (_kExecuteKey).",
          "If execution key exists, load properties from catalog; otherwise, show configuration dialog (Property Palette or TSL Dialog).",
          "User selects a Source Entity (GenBeam) via command line.",
          "Script stores Source Entity in _Map and determines its class (Beam, Sheet, or Sip).",
          "Script prompts user to select Target Entities matching the Source class (PrEntity for Beams, Sheets, or Sips).",
          "Script enters calculation/execution phase (second pass).",
          "Script retrieves Source Entity from _Map.",
          "Script retrieves Target Entities from arrays (_Beam, _Sheet, _Sip).",
          "Script loops through Target Entities to apply type-specific properties (e.g., Width/Height for Beams, Thickness for Sheets) based on 'Yes' settings.",
          "Script loops through Target Entities to apply general properties (e.g., Material, Label, Color) based on 'Yes' settings.",
          "Script reports summary of changes to command line.",
          "Script deletes its own instance from the drawing (eraseInstance)."
        ],
        "conditionalBranches": [
          {
            "condition": "Configuration Source (Execution Key vs Standard)",
            "path1": {
              "name": "Key-based Execution",
              "steps": [
                "Detects _kExecuteKey.",
                "Searches catalog for matching entry.",
                "Loads property settings from catalog entry (or LastInserted if not found).",
                "Proceeds to selection."
              ]
            },
            "path2": {
              "name": "Standard Dialog",
              "steps": [
                "Calls showDialog().",
                "User selects which properties to map via UI.",
                "Proceeds to selection."
              ]
            }
          },
          {
            "condition": "Source Entity Type",
            "path1": {
              "name": "Source is Beam",
              "steps": [
                "Prompt: 'Select beams'.",
                "Store selection in _Beam array.",
                "Map Beam-specific properties (Width, Height, Extrusion Profile, etc.)."
              ]
            },
            "path2": {
              "name": "Source is Sheet",
              "steps": [
                "Prompt: 'Select sheets'.",
                "Store selection in _Sheet array.",
                "Map Sheet-specific properties (Thickness)."
              ]
            },
            "path3": {
              "name": "Source is Sip",
              "steps": [
                "Prompt: 'Select sip'.",
                "Store selection in _Sip array.",
                "Map Sip-specific properties (Style, Surface Quality)."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent exit)",
            "recovery": "Script erases itself to prevent infinite loops if insertCycleCount > 1."
          },
          {
            "check": "Source Entity Validity",
            "errorMessage": "None (Silent exit)",
            "recovery": "If the retrieved source entity is invalid (deleted or lost), the script erases itself without processing."
          },
          {
            "check": "Element Validity for Zone Mapping",
            "errorMessage": "None (Silent skip)",
            "recovery": "If Zone mapping is enabled, the script checks if both source and target have valid Element objects. If not, the Zone property is skipped for that specific target."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script Self-Destructs)",
            "how": "N/A",
            "effect": "The script instance is automatically removed (eraseInstance) after processing, so no further user interaction with the script instance is possible. The target entities retain the modified properties."
          }
        ]
      },
      "tokens_used": 11310,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbMatchProperties.mcr\n\n## Overview\nThis utility script allows you to copy specific properties from a \"source\" timber element (Beam, Sheet, or Sip) to multiple \"target\" elements. It is useful for standardizing attributes like material, grade, labels, and layer settings across a selection of elements without recreating geometry.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates only on 3D physical elements. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: At least one source element (Beam, Sheet, or Sip) and one or more target elements of the same type.\n- **Minimum Beam Count**: 1 (Source).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbMatchProperties.mcr`\n\n### Step 2: Configure Properties (AutoCAD Properties Palette)\nAfter inserting the script, the AutoCAD Properties Palette will display a list of available properties. Set the ones you wish to copy to **Yes**.\n```\nAction: Toggle properties (e.g., Material, Grade, Color) to \"Yes\" as needed.\n```\n\n### Step 3: Select Source Entity\n```\nCommand Line: Select source entity\nAction: Click on the single timber element that has the properties you want to copy.\n```\n\n### Step 4: Select Target Entities\n```\nCommand Line: Select beams (or Select sheets / Select sip)\nAction: Select all the elements you want to update. Press Enter to confirm selection.\nNote: The prompt changes based on the type of source element selected.\n```\n\n### Step 5: Completion\nThe script applies the properties and automatically removes itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Color | Dropdown | No | If Yes, copies the display color (layer color override) of the source entity. |\n| Label | Dropdown | No | If Yes, copies the main Label (piece mark/position number). |\n| SubLabel | Dropdown | No | If Yes, copies the SubLabel (secondary piece mark). |\n| SubLabel2 | Dropdown | No | If Yes, copies the SubLabel2 (tertiary identifier). |\n| Grade | Dropdown | No | If Yes, copies the timber strength grade (e.g., C24). |\n| Information | Dropdown | No | If Yes, copies the Information field (free text comments). |\n| Material | Dropdown | No | If Yes, copies the material definition (e.g., Spruce). |\n| Name | Dropdown | No | If Yes, copies the entity Name property. |\n| Beamtype | Dropdown | No | If Yes, copies the Beamtype classification. |\n| Isotropic | Dropdown | No | If Yes, copies the material isotropy setting. |\n| hsbId | Dropdown | No | If Yes, copies the internal hsbCAD ID. **Warning: This can cause database conflicts.** |\n| Group | Dropdown | No | If Yes, copies group assignments. |\n| Module | Dropdown | No | If Yes, copies the Element Module assignment. |\n| Zone | Dropdown | No | If Yes, copies the Zone assignment (e.g., fire zone). |\n| Transparency | Dropdown | No | If Yes, copies the display transparency percentage. |\n| RenderMaterial | Dropdown | No | If Yes, copies the render material assignment. |\n| LineWeight | Dropdown | No | If Yes, copies the line weight setting. |\n| Notes | Dropdown | No | If Yes, copies notes attached to the element. |\n| PropertySets | Dropdown | No | If Yes, copies user-defined Property Sets. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script runs immediately upon insertion and deletes itself afterwards; no persistent context menu options are available. |\n\n## Settings Files\n- None.\n\n## Tips\n- **Type Matching**: You can only copy properties from a Beam to Beams, or a Sheet to Sheets. You cannot copy from a Beam to a Sheet.\n- **Avoid ID Conflicts**: Keep the **hsbId** parameter set to **No** unless you specifically intend to clone the ID, which is rarely recommended and can lead to data corruption.\n- **Visual Updates**: Use the **Color** and **Transparency** options to quickly match visual styles for presentation models.\n\n## FAQ\n- **Q: Why did the script disappear after I used it?**\n  - A: This is a \"command\" script that performs an action and then erases itself (`eraseInstance`). This keeps your drawing clean.\n- **Q: Can I use this to change dimensions?**\n  - A: No, this script copies data properties (attributes). It does not modify physical geometry (width/height/thickness) of the target elements."
      },
      "tokens_used": 7454,
      "error": null
    }
  }
}