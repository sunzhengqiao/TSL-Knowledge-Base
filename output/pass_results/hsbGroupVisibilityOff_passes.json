{
  "filename": "hsbGroupVisibilityOff.mcr",
  "status": "completed",
  "total_tokens": 17303,
  "processing_time": 520.3120586872101,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "24feb2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3552,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No _Viewport, sd_*, or ShopDrawing specific patterns found. Script operates on selected Entities using PrEntity and Element links, typical for Model Space manipulation."
        },
        "prerequisites": {
          "requiredEntities": [
            "Entity",
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space where elements exist",
          "requiredSettings": []
        }
      },
      "tokens_used": 1351,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select entity(s)|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1871,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Hides the hsbCAD structural groups associated with selected entities to clean up the model view.",
          "category": "Utility / Model Management",
          "typicalUseCase": "When a user wants to quickly hide specific construction phases or structural groups by selecting a representative element rather than searching through the layer or group list."
        },
        "parameters": [
          {
            "name": "_Entity",
            "technicalDefault": "Empty List",
            "businessMeaning": "The model entities (beams, walls, etc.) selected by the user to identify which structural groups should be hidden.",
            "validRange": "1 or more existing model entities",
            "unit": "Count",
            "affectsOutput": "Identifies the target Group names; the script extracts the group names from these entities to generate the visibility-off commands."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Entity has Element Link",
            "effect": "The script prioritizes the group name from the parent Element if a link exists; otherwise, it uses the group assigned directly to the Entity.",
            "cascade": [
              "Group Identification"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "None (Visibility State)",
            "description": "Modifies the visibility of existing hsbCAD Groups to 'Off' (Hidden). No physical geometry is created.",
            "appliedTo": "hsbCAD Groups associated with the selected input entities"
          }
        ]
      },
      "tokens_used": 3599,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches script (hsbGroupVisibilityOff.mcr)",
          "Script checks if running in insertion mode (_bOnInsert)",
          "Script checks if insertCycleCount > 1",
          "Script prompts user to select entity(s) via PrEntity",
          "User selects one or more entities and confirms",
          "Script iterates through the list of selected entities",
          "For each entity, script checks if it has a valid Element link",
          "Script extracts the Group name (from Element if valid, otherwise from Entity)",
          "Script checks if the Group name has a valid 'namePart(2)' and is not a duplicate",
          "Script compiles a unique list of Group names",
          "Script pushes a visibility 'off' command (-HSB_GROUPSETVISIBLITY) to the command stack for each unique Group",
          "Script reports the list of affected groups to the command line history",
          "Script calls eraseInstance() to remove itself from the drawing",
          "Process completes"
        ],
        "conditionalBranches": [
          {
            "condition": "Check if insertCycleCount > 1",
            "path1": {
              "name": "Re-insertion detected",
              "steps": [
                "eraseInstance() is called",
                "Script terminates immediately without further processing"
              ]
            },
            "path2": {
              "name": "First run (Fresh Insert)",
              "steps": [
                "Proceed to prompt user for entity selection"
              ]
            }
          },
          {
            "condition": "Entity Link Validation",
            "path1": {
              "name": "Valid Element Link found",
              "steps": [
                "Retrieve group from el.elementGroup()",
                "Use this group name for visibility processing"
              ]
            },
            "path2": {
              "name": "No Element Link",
              "steps": [
                "Retrieve group from ent.groups()",
                "Use these groups for visibility processing"
              ]
            }
          },
          {
            "condition": "Group Validity Check (Length of namePart(2))",
            "path1": {
              "name": "Valid Full Group Name",
              "steps": [
                "Add group name to sGroupNames array if not duplicate"
              ]
            },
            "path2": {
              "name": "Partial/Invalid Group Name",
              "steps": [
                "Ignore this specific group entry"
              ]
            }
          },
          {
            "condition": "sGroupNames array population",
            "path1": {
              "name": "Groups Found",
              "steps": [
                "Report header message",
                "Loop through groups and push visibility commands",
                "Report footer message"
              ]
            },
            "path2": {
              "name": "No Groups Found",
              "steps": [
                "Skip reporting and command pushing",
                "Proceed to eraseInstance()"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection",
            "errorMessage": "None inherent to code (User cancels PrEntity dialog)",
            "recovery": "User restarts the script and makes a selection."
          },
          {
            "check": "Group Name Structure",
            "errorMessage": "None shown to user (Silently ignored)",
            "recovery": "N/A (Script ignores groups without sufficient name depth)"
          }
        ],
        "postInsertionActions": [
          {
            "action": "None",
            "how": "N/A",
            "effect": "The script self-destructs (eraseInstance) immediately after execution. It cannot be edited post-insertion as it does not persist in the drawing."
          }
        ]
      },
      "tokens_used": 3206,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbGroupVisibilityOff.mcr\n\n## Overview\nThis script allows you to quickly hide specific hsbCAD structural groups by selecting entities belonging to them. It is designed to clean up the model view by turning off the visibility for the construction phases associated with the selected objects.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script is intended for use in the 3D model. |\n| Paper Space | No | Not supported in layout views. |\n| Shop Drawing | No | Not intended for manufacturing drawings. |\n\n## Prerequisites\n- **Required entities:** Existing hsbCAD entities (e.g., beams, walls) or Elements must be present in the model.\n- **Minimum beam count:** 0 (You must select at least one entity to trigger the hide action).\n- **Required settings files:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `hsbGroupVisibilityOff.mcr`\n\n### Step 2: Select Entities\n```\nCommand Line: Select entity(s)\nAction: Click on the beams, walls, or other entities that belong to the group(s) you want to hide. You can select multiple objects. Press Enter or Right-click to confirm.\n```\n\n*Note: The script will automatically identify the structural groups associated with your selection and hide them. The script instance will then remove itself from the drawing.*\n\n## Properties Panel Parameters\nThis script does not expose any parameters to the Properties Panel.\n\n## Right-Click Menu Options\nThis script does not add any specific options to the Right-Click context menu.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Batch Hiding:** You can select multiple entities from different groups at once. The script will hide all unique groups associated with your selection in a single operation.\n- **Restoring Visibility:** Since this script only turns groups off, you will need to use the standard hsbCAD Group Manager or the `-HSB_GROUPSETVISIBLITY` command to make the groups visible again.\n- **Auto-Cleanup:** The script automatically deletes itself from the drawing after running. You do not need to manually delete the script instance.\n\n## FAQ\n- **Q: Can I use this to hide elements in a 2D Shop Drawing?**\n  - A: No, this script only functions in Model Space.\n- **Q: Why did the script disappear after I used it?**\n  - A: This is normal behavior. The script performs the visibility change and then self-destructs (`eraseInstance`) to keep your drawing clean.\n- **Q: What happens if I select an entity that isn't part of a group?**\n  - A: The script will ignore entities that do not have a valid group assignment and will only process those that do."
      },
      "tokens_used": 3724,
      "error": null
    }
  }
}