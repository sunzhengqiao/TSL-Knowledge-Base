{
  "filename": "HSB_G-GroupInformation.mcr",
  "status": "completed",
  "total_tokens": 24158,
  "processing_time": 369.3145339488983,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.00",
            "date": "14.11.2013",
            "author": "AS",
            "changes": "Pilot version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4638,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getPoint(T(\"|Select a position|\")) to define the insertion point in the 3D model. Explicitly collects entities from _kModelSpace using Group().collectEntities(true, ElementWallSF(), _kModelSpace). It does not use ShopDrawing API calls like setEntFromId nor checks for Viewports."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model space containing Stick Frame wall elements.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1523,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "separator01",
            "type": "PropString",
            "displayName": "|Style|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dimStyle",
            "type": "PropString",
            "displayName": "     |Dimension style|",
            "defaultValue": "     ",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "headerColor",
            "type": "PropInt",
            "displayName": "     |Textcolor header|",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "contentColor",
            "type": "PropInt",
            "displayName": "     |Textcolor content|",
            "defaultValue": 5,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "columnWidth",
            "type": "PropDouble",
            "displayName": "     |Column width|",
            "defaultValue": "U(500)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "rowHeight",
            "type": "PropDouble",
            "displayName": "     |Row height|",
            "defaultValue": "U(75)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2881,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a 2D schedule table listing all Stick Frame wall types found in the model and their total quantities.",
          "category": "Documentation/Scheduling",
          "typicalUseCase": "Used to place a Bill of Quantities (BOQ) or Wall Type summary directly in the model view to verify the count of different wall assemblies."
        },
        "parameters": [
          {
            "name": "separator01",
            "technicalDefault": "\"\"",
            "businessMeaning": "UI grouping label to categorize following properties.",
            "validRange": "N/A",
            "unit": "N/A",
            "affectsOutput": "None (Visual only in Properties Palette)."
          },
          {
            "name": "dimStyle",
            "technicalDefault": "\"     \"",
            "businessMeaning": "Selects the CAD Dimension Style (which defines text font, height, and units) for the schedule table.",
            "validRange": "Any valid Dimension Style name defined in the drawing.",
            "unit": "String",
            "affectsOutput": "Controls the font, size, and appearance of the text drawn in the schedule."
          },
          {
            "name": "headerColor",
            "technicalDefault": "1",
            "businessMeaning": "Sets the color of the column header text ('WallType' and 'Amount').",
            "validRange": "0-255 (Standard AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the visual color of the top row of the table."
          },
          {
            "name": "contentColor",
            "technicalDefault": "5",
            "businessMeaning": "Sets the color of the list content (Wall Names and Counts).",
            "validRange": "0-255 (Standard AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the visual color of the data rows in the table."
          },
          {
            "name": "columnWidth",
            "technicalDefault": "U(500)",
            "businessMeaning": "The horizontal spacing between columns in the schedule table.",
            "validRange": "200 to 2000 mm (Dependent on text length)",
            "unit": "mm",
            "affectsOutput": "Adjusts the horizontal layout; if too narrow, long wall names may overlap the next column."
          },
          {
            "name": "rowHeight",
            "technicalDefault": "U(75)",
            "businessMeaning": "The vertical spacing between rows in the schedule table.",
            "validRange": "50 to 200 mm (Must be larger than dimStyle text height)",
            "unit": "mm",
            "affectsOutput": "Adjusts the vertical layout of the table; controls how tightly packed the wall list is."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User changes dimStyle to a style with larger text height",
            "effect": "rowHeight may need to be increased to prevent text overlap.",
            "cascade": [
              "rowHeight"
            ]
          },
          {
            "trigger": "User changes dimStyle to a style with wider characters",
            "effect": "columnWidth may need to be increased to accommodate wall names.",
            "cascade": [
              "columnWidth"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "2D Annotation",
            "description": "A schedule table containing text elements listing Wall Types and their quantities.",
            "appliedTo": "Model Space (at user selected point _Pt0)."
          }
        ]
      },
      "tokens_used": 4237,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization: Load properties (separator01, dimStyle, headerColor, contentColor, columnWidth, rowHeight).",
          "2. Insertion Check: Verify if script is running in Insert Mode (_bOnInsert).",
          "3. Cycle Check: Evaluate insertCycleCount().",
          "4. User Input: Prompt user to select an insertion point (_Pt0) for the schedule.",
          "5. Entity Collection: Scan Model Space (_kModelSpace) for all ElementWallSF entities.",
          "6. Data Aggregation: Iterate through collected entities to categorize walls by 'Code' (wall type) and calculate quantities.",
          "7. Display Configuration: Initialize Display objects for header and content styling.",
          "8. Drawing - Headers: Draw 'WallType' and 'Amount' labels at the insertion point offset by row height.",
          "9. Drawing - Content: Loop through the aggregated list and draw wall names and counts for each entry below the headers."
        ],
        "conditionalBranches": [
          {
            "condition": "Check insertCycleCount() during insertion",
            "path1": {
              "name": "Recursive/Cycle Detected",
              "steps": [
                "Erase the current script instance.",
                "Exit execution immediately."
              ]
            },
            "path2": {
              "name": "First Run",
              "steps": [
                "Execute getPoint to get location.",
                "Store _Pt0.",
                "Proceed to calculation/drawing."
              ]
            }
          },
          {
            "condition": "Check if Wall Type exists in temporary list (inside aggregation loop)",
            "path1": {
              "name": "New Wall Type",
              "steps": [
                "Append Wall Code to wallTypes array.",
                "Initialize amount to 1."
              ]
            },
            "path2": {
              "name": "Existing Wall Type",
              "steps": [
                "Locate index of existing Wall Code.",
                "Increment the amount counter by 1."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insertion Cycle Count",
            "errorMessage": "(No user message, script exits silently)",
            "recovery": "Script automatically cleans up duplicate instances caused by recursion."
          },
          {
            "check": "Existence of ElementWallSF entities",
            "errorMessage": "None shown (Table renders with headers but 0 rows).",
            "recovery": "User must create Stick Frame walls in Model Space and recalculate the script."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Visual Style",
            "how": "OPM (Object Properties Palette)",
            "effect": "Changing headerColor, contentColor, columnWidth, or rowHeight triggers an immediate redraw of the table with new dimensions/colors."
          },
          {
            "action": "Update Data",
            "how": "Modify Model (Add/Remove Walls) then Recalculate",
            "effect": "The entity collection logic runs again, updating the wall types and amounts in the table."
          }
        ]
      },
      "tokens_used": 5884,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-GroupInformation.mcr\n\n## Overview\nGenerates a 2D schedule table listing all Stick Frame wall types found in the model and their total quantities. This tool is used to place a Bill of Quantities (BOQ) or Wall Type summary directly in the model view.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script scans _kModelSpace for wall elements. |\n| Paper Space | No | Not supported for this script. |\n| Shop Drawing | No | This script operates on the 3D model, not 2D layouts. |\n\n## Prerequisites\n- **Required entities**: `ElementWallSF` (Stick Frame walls) must exist in the model.\n- **Minimum beam count**: 0 (Script will generate a table with headers even if no walls are found).\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-GroupInformation.mcr`\n\n### Step 2: Select Position\n```\nCommand Line: Select a position\nAction: Click in the Model Space where you want the top-left corner of the schedule table to be placed.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Style | String | \"\" | Visual separator label for the Properties palette. |\n| Dimension style | dropdown | \"     \" | Selects the CAD Dimension Style to define text font and height for the table. |\n| Textcolor header | number | 1 | Sets the color of the header row ('WallType' and 'Amount'). Uses standard AutoCAD Color Index (1 = Red, etc.). |\n| Textcolor content | number | 5 | Sets the color of the data rows (Wall Names and Counts). Uses standard AutoCAD Color Index (5 = Blue, etc.). |\n| Column width | number | U(500) | Defines the horizontal spacing between columns in millimeters. Increase if wall names are cut off. |\n| Row height | number | U(75) | Defines the vertical spacing between rows in millimeters. Increase if text overlaps vertically. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (None) | No custom context menu options are provided by this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Updating Data**: If you add or remove walls in the model, use the **hsbCAD Update** command (or recalculate the drawing) to refresh the counts in the table.\n- **Text Overlap**: If the text in the table looks squashed, increase the **Row height** property. If wall names are too long for the column, increase the **Column width** property.\n- **Styling**: To change the font type or size of the text, change the **Dimension style** property to a different style defined in your CAD template.\n\n## FAQ\n- Q: Why is my table empty (showing only headers)?\n  A: The script could not find any `ElementWallSF` (Stick Frame) entities in the Model Space. Ensure you have drawn walls using the Stick Frame tool.\n- Q: How do I change the text font?\n  A: You cannot change the font directly in this script's properties. You must select a different **Dimension style** from the dropdown that utilizes your desired font settings."
      },
      "tokens_used": 4995,
      "error": null
    }
  }
}