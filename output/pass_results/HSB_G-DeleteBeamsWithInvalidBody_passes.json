{
  "filename": "HSB_G-DeleteBeamsWithInvalidBody.mcr",
  "status": "completed",
  "total_tokens": 14565,
  "processing_time": 246.4882836341858,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2501,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Group().collectEntities(true, GenBeam(), _kModelSpace);"
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "_kModelSpace",
          "requiredSettings": []
        }
      },
      "tokens_used": 1724,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1365,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically scans the model and deletes any GenBeams that possess zero volume or invalid geometry data.",
          "category": "Maintenance",
          "typicalUseCase": "Used to clean up the drawing database after imports or errors to remove 'ghost' beams that appear in the project manager but have no physical shape, which could cause downstream processing errors."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "DeletedEntity",
            "description": "GenBeams with invalid bodies or zero volume (solidLength * solidWidth * solidHeight == 0) are removed from the model.",
            "appliedTo": "All GenBeams in ModelSpace"
          }
        ]
      },
      "tokens_used": 2360,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script instance inserted by user.",
          "Collect all GenBeam entities from ModelSpace into an array.",
          "Start loop iterating through each collected entity.",
          "Cast entity to GenBeam.",
          "Verify if the GenBeam is valid using bIsValid().",
          "Calculate volume by multiplying solidLength, solidWidth, and solidHeight.",
          "[Conditional] If volume equals zero:",
          "  Report message 'Invalid bod for genBeam. GenBeam is deleted'.",
          "  Execute dbErase() to delete the GenBeam.",
          "[Conditional] If volume is non-zero:",
          "  Take no action.",
          "Proceed to next beam in the loop.",
          "After loop completes, execute eraseInstance() to remove the script instance.",
          "Terminate execution."
        ],
        "conditionalBranches": [
          {
            "condition": "Is the GenBeam entity valid (bIsValid returns true)?",
            "path1": {
              "name": "Invalid Entity",
              "steps": [
                "Skip current iteration (continue).",
                "Proceed to next entity in array."
              ]
            },
            "path2": {
              "name": "Valid Entity",
              "steps": [
                "Proceed to volume calculation check."
              ]
            }
          },
          {
            "condition": "Is the calculated volume zero (solidLength * solidWidth * solidHeight == 0)?",
            "path1": {
              "name": "Invalid Geometry",
              "steps": [
                "Report deletion message.",
                "Delete GenBeam from database."
              ]
            },
            "path2": {
              "name": "Valid Geometry",
              "steps": [
                "Leave GenBeam untouched.",
                "Continue loop."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "GenBeam Entity Validity (bIsValid)",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script automatically ignores the entity and continues."
          },
          {
            "check": "Geometric Volume (Length * Width * Height)",
            "errorMessage": "Invalid bod for genBeam. GenBeam is deleted",
            "recovery": "Script automatically removes the offending GenBeam; user must recreate it if needed."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 3408,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-DeleteBeamsWithInvalidBody.mcr\n\n## Overview\nThis script is a maintenance tool that automatically scans your model and removes any Timber Beams (GenBeams) with zero volume or invalid geometry. It is designed to clean up \"ghost\" beams that appear in the project manager but have no physical shape, which can occur after data imports or modeling errors.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script scans all entities in the current Model Space. |\n| Paper Space | No | Not intended for use in Paper Space. |\n| Shop Drawing | No | Not intended for use in Shop Drawing layouts. |\n\n## Prerequisites\n- **Required Entities**: GenBeam entities (the script scans the entire drawing for these).\n- **Minimum Beam Count**: 0 (The script can run on an empty drawing).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  Type `TSLINSERT` in the AutoCAD command line.\n2.  Browse to and select `HSB_G-DeleteBeamsWithInvalidBody.mcr`.\n3.  Click **Open**.\n\n### Step 2: Automatic Execution\n```\nScript Action: Automatically scans Model Space for all GenBeams.\nProcess: Calculates volume (Length x Width x Height) for each beam.\nResult: \n- Beams with zero volume or invalid bodies are deleted immediately.\n- A message \"Invalid bod for genBeam. GenBeam is deleted\" is reported for each deleted beam in the command line.\n- The script instance deletes itself upon completion.\n```\n*No further user input is required.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose any user-editable properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add specific options to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A (This script does not rely on external settings files).\n\n## Tips\n- **Post-Import Cleanup**: Run this script immediately after importing DWG/DXF files to remove corrupt beams that might interfere with subsequent machining or listing processes.\n- **Check Logs**: Look at your AutoCAD command line text window after running the script to see how many beams were identified and deleted.\n- **Undo**: As the script performs deletions, ensure you have adequate backups or test the script on a copy if you are unsure about the results.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I inserted it?**\n  - A: This is intended behavior. The script performs its task (scanning and deleting) and then removes its own instance from the drawing automatically to keep the project clean.\n- **Q: How do I know if a beam was deleted?**\n  - A: The script reports \"Invalid bod for genBeam. GenBeam is deleted\" to the AutoCAD command line for every beam it removes.\n- **Q: Can I undo the deletions?**\n  - A: This depends on your current hsbCAD/AutoCAD Undo settings. In many cases, standard `U` or `UNDO` commands can reverse the actions, but it is best practice to save your project before running bulk maintenance scripts."
      },
      "tokens_used": 3207,
      "error": null
    }
  }
}