{
  "filename": "GL_PLOT_CUT_LIST.mcr",
  "status": "completed",
  "total_tokens": 40269,
  "processing_time": 752.5768799781799,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7649,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No usage of Viewport, sd_, or Multipage prefixes. Script uses U() for unit conversion and interacts with GenBeam/Element data directly (e.g., el.opening()), but generates drawing primitives (dp.draw) without specific Paper Space context or #Type E definitions. It appears to be a model-space annotation or list generation script."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing an Element (likely a Wall or Panel) with Openings and associated Maps (e.g., HangerDimPointsMap).",
          "requiredSettings": []
        }
      },
      "tokens_used": 6246,
      "error": null
    },
    "3": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a visual cut list (timber list) in Model Space that itemizes all beams within a selected Element, grouping them by type and quantity while displaying dimensions and labels.",
          "category": "ShopDrawing",
          "typicalUseCase": "Creating a summary table for a wall panel on the shop floor drawing to show how many studs, plates, and headers are required, including their lengths and sizes."
        },
        "parameters": [
          {
            "name": "strDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Selects the AutoCAD dimension style to define text font, height, and appearance for the list.",
            "validRange": "Any existing DimStyle in the drawing",
            "unit": "N/A",
            "affectsOutput": "Text appearance in the generated table and labels."
          },
          {
            "name": "propHeader",
            "technicalDefault": "Timber List",
            "businessMeaning": "The title text displayed at the top of the cut list table.",
            "validRange": "String",
            "unit": "N/A",
            "affectsOutput": "Header text of the table."
          },
          {
            "name": "nColorIndex",
            "technicalDefault": 7,
            "businessMeaning": "AutoCAD color index used for the header text.",
            "validRange": "1-255",
            "unit": "Index",
            "affectsOutput": "Color of the table header."
          },
          {
            "name": "dTH",
            "technicalDefault": 0,
            "businessMeaning": "Sets the text height. If 0, it inherits the size from the selected DimStyle.",
            "validRange": "0 - 10 mm (0 = Auto)",
            "unit": "mm",
            "affectsOutput": "Size of the list text."
          },
          {
            "name": "intText",
            "technicalDefault": 2,
            "businessMeaning": "Controls the algorithm for placing labels near beams to avoid overlaps.",
            "validRange": "1-4",
            "unit": "Integer",
            "affectsOutput": "Position and offset of individual part labels in the drawing."
          },
          {
            "name": "strDirection",
            "technicalDefault": "Horizontal",
            "businessMeaning": "Layout orientation of the table (rows flow horizontally or vertically).",
            "validRange": "Horizontal, Vertical",
            "unit": "N/A",
            "affectsOutput": "Orientation of the generated table on screen."
          },
          {
            "name": "strJustify",
            "technicalDefault": "Top",
            "businessMeaning": "Vertical alignment point of the table relative to the insertion point.",
            "validRange": "Top, Bottom",
            "unit": "N/A",
            "affectsOutput": "Vertical placement of the table."
          },
          {
            "name": "strTranslateId",
            "technicalDefault": "Yes",
            "businessMeaning": "If Yes, converts internal hsbCAD codes (e.g., '30') to readable names (e.g., 'Stud').",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "Readability of the 'Timber Name' column."
          },
          {
            "name": "vtpIgnor",
            "technicalDefault": "No",
            "businessMeaning": "If Yes, excludes Very Top Plates (DTP) from the list.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "Filtering of top plate members from the list."
          },
          {
            "name": "dmm",
            "technicalDefault": 1,
            "businessMeaning": "Multiplier for numerical outputs (e.g., scaling metric to imperial display).",
            "validRange": "0.01 - 100",
            "unit": "Factor",
            "affectsOutput": "Values displayed in the Length, Width, and Height columns."
          },
          {
            "name": "d1...d14",
            "technicalDefault": "Various (e.g., 203.2 mm)",
            "businessMeaning": "Column widths for specific data fields (Name, Size, Label, Qty, etc.).",
            "validRange": "50 mm - 300 mm",
            "unit": "mm",
            "affectsOutput": "Width and layout of the generated table columns."
          },
          {
            "name": "BP, TP, DTP, HDR, Jack, King, Stud, etc.",
            "technicalDefault": "Mapped in code",
            "businessMeaning": "User-defined aliases for specific beam functions (Bottom Plate, Top Plate, Header, etc.).",
            "validRange": "String",
            "unit": "N/A",
            "affectsOutput": "The specific text used to identify beam types in the list."
          },
          {
            "name": "nMaxRow",
            "technicalDefault": 16,
            "businessMeaning": "Maximum number of rows to display in one table instance.",
            "validRange": "1 - 100",
            "unit": "Count",
            "affectsOutput": "Vertical size of the table."
          },
          {
            "name": "stAddGradeToSize",
            "technicalDefault": "Yes",
            "businessMeaning": "Appends the material grade (e.g., 'C24') to the size string.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "Content of the 'Size' column."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "strDirection changes to Vertical",
            "effect": "Rotates the table generation logic 90 degrees.",
            "cascade": [
              "vXTbl",
              "vYTbl"
            ]
          },
          {
            "trigger": "dTH is 0",
            "effect": "Text size relies on settings from strDimStyle.",
            "cascade": [
              "strDimStyle"
            ]
          },
          {
            "trigger": "strTranslateId is No",
            "effect": "Ignores the user-friendly names (Stud, Plate) and uses raw IDs.",
            "cascade": [
              "BP",
              "TP",
              "HDR",
              "Stud",
              "All"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text/Line Geometry",
            "description": "A formatted table listing timber components, and individual labels placed in the model space pointing to specific beams.",
            "appliedTo": "Model Space (referencing an Element/Wall)."
          }
        ]
      },
      "tokens_used": 9181,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11606,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GL_PLOT_CUT_LIST.mcr\n\n## Overview\nGenerates a visual cut list (timber list) in Model Space that itemizes all beams within a selected Element, grouping them by type and quantity while displaying dimensions and labels.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script generates geometry (lines and text) directly in the model. |\n| Paper Space | No | Not designed for Paper Space viewports. |\n| Shop Drawing | No | This is a Model Space generation script, though used for shop floor documentation. |\n\n## Prerequisites\n- **Required Entities**: An existing Element (Wall or Panel) containing beams.\n- **Minimum Beam Count**: 0.\n- **Required Settings**: None strictly required, though an existing AutoCAD DimStyle is recommended for text formatting.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse the file dialog and select `GL_PLOT_CUT_LIST.mcr`.\n\n### Step 2: Select Element\nCommand Line: `Select Element:`\nAction: Click on the Wall or Panel element you wish to generate the cut list for.\n\n### Step 3: Insert Table\nCommand Line: `Insert point:`\nAction: Click in the Model Space where you want the top-left (or alignment point) of the table to appear.\n\n### Step 4: Configure (Optional)\nAction: Select the newly inserted table script. Open the **Properties Palette** (Ctrl+1) to adjust headers, column widths, or beam label settings as needed.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **General** | | | |\n| strDimStyle | String | _DimStyles | The Dimension Style used to control text font and height appearance. |\n| propHeader | String | Timber List | The title text displayed at the top of the list. |\n| nColorIndex | Integer | 7 | The AutoCAD color index for the header text. |\n| dTH | Double | 0 | Text height in mm. If set to 0, the height is taken from the DimStyle. |\n| **Layout** | | | |\n| strDirection | String | Horizontal | Orientation of the table: \"Horizontal\" or \"Vertical\". |\n| strJustify | String | Top | Vertical alignment: \"Top\" or \"Bottom\" relative to the insertion point. |\n| nMaxRow | Integer | 16 | Maximum number of rows displayed before a new page/table is created. |\n| **Content** | | | |\n| strTranslateId | String | Yes | If \"Yes\", converts beam codes (e.g., '30') to readable names (e.g., 'Stud'). |\n| vtpIgnor | String | No | If \"Yes\", excludes Very Top Plates (DTP) from the list. |\n| dmm | Double | 1 | Multiplier for dimension values (e.g., set to 25.4 to convert mm to inches). |\n| stAddGradeToSize | String | Yes | If \"Yes\", appends the material grade (e.g., C24) to the size description. |\n| intText | Integer | 2 | Algorithm for placing labels near beams (1-4) to avoid overlaps. |\n| **Column Widths (d1-d14)** | Double | Various | Sets the width (in mm) for each column in the table. |\n| **Beam Names (Aliases)** | String | Mapped | User-defined names for beam types (BP=Bottom Plate, TP=Top Plate, etc.). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the table and labels based on current wall geometry or property changes. |\n| Erase | Removes the script and all generated geometry from the drawing. |\n\n## Settings Files\n- **Filename**: None specific.\n- **Location**: N/A\n- **Purpose**: This script relies on internal mapping and standard AutoCAD DimStyles rather than external XML settings files.\n\n## Tips\n- **Adjusting Layout**: If the table is too wide, change `strDirection` to \"Vertical\" to stack columns downwards.\n- **Unit Conversion**: If you need imperial lengths but draw in metric, change the `dmm` parameter to `25.4` (or vice versa) to convert the displayed values without changing the model.\n- **Label Overlap**: If labels on the drawing overlap with other elements, try changing the `intText` value (1 through 4) to shift their position logic.\n- **Custom Names**: You can rename standard parts by editing the alias properties (e.g., change `Stud` to `Vertical Stud`) directly in the Properties palette.\n\n## FAQ\n- **Q: Why do I see numbers like \"30\" instead of \"Stud\" in the Timber Name column?**\n  **A:** The `strTranslateId` property is likely set to \"No\". Change it to \"Yes\" to use readable names.\n- **Q: The text size is incorrect, how do I fix it?**\n  **A:** Check `dTH`. If it is 0, the script uses the text height defined in your `strDimStyle`. Change `dTH` to a specific value (e.g., 2.5) to override the style.\n- **Q: Can I exclude specific plates from the count?**\n  **A:** Yes. Set `vtpIgnor` to \"Yes\" to exclude Very Top Plates. You can also filter other types by manipulating the Beam Name aliases or column widths, though excluding DTP is the built-in toggle."
      },
      "tokens_used": 5587,
      "error": null
    }
  }
}