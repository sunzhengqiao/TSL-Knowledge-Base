{
  "filename": "SimpsonStrongTieSPF.mcr",
  "status": "completed",
  "total_tokens": 48049,
  "processing_time": 258.36835289001465,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "2.0",
            "date": "08jan2020",
            "author": "marsel.nakuci@hsbcad.com",
            "changes": "HSB-6315: change name, adapt values from simpson strong tie"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5600,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses getBeam() for interactive beam selection in _bOnInsert block, constructs 3D Body geometry, and utilizes model() and material() functions. No PaperSpace specific patterns found (e.g., _Viewport, sd_ prefix, #Type E)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space containing at least two beams to connect",
          "requiredSettings": []
        }
      },
      "tokens_used": 4854,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select First Beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getBeam",
              "promptOriginal": "Select Second Beam",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "Purlin anchor",
            "defaultValue": "SPF170",
            "inputType": "dropdown",
            "options": [
              "SPF170",
              "SPF210",
              "SPF250",
              "SPF290",
              "SPF330",
              "SPF370",
              "SPF170e",
              "SPF210e",
              "SPFUNI 170",
              "SPFUNI 210"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sArt1",
            "type": "PropString",
            "displayName": "Article",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sMat1",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "Stahl, feuerverzinkt",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sNotes1",
            "type": "PropString",
            "displayName": "Metalpart Notes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sMod2",
            "type": "PropString",
            "displayName": "Nail Model",
            "defaultValue": "Kammnagel",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sArt2",
            "type": "PropString",
            "displayName": "Article",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sMat2",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "Stahl, verzinkt",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dDia",
            "type": "PropDouble",
            "displayName": "Nail Diameter",
            "defaultValue": "4.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dLen2",
            "type": "PropDouble",
            "displayName": "Nail Length",
            "defaultValue": "40.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nNail",
            "type": "PropInt",
            "displayName": "Number of nails",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sNotes2",
            "type": "PropString",
            "displayName": "Metalpart Notes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dOffsetF",
            "type": "PropDouble",
            "displayName": "Offset purlin anchor front",
            "defaultValue": "0.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dOffsetB",
            "type": "PropDouble",
            "displayName": "Offset purlin anchor back",
            "defaultValue": "0.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "sSide",
            "type": "PropString",
            "displayName": "Side",
            "defaultValue": "Front",
            "inputType": "dropdown",
            "options": [
              "Front",
              "Back"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 9,
            "variable": "sOneSide",
            "type": "PropString",
            "displayName": "On One Side",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 10,
            "variable": "sSwitch",
            "type": "PropString",
            "displayName": "Switch Purlin anchor",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 11,
            "variable": "sFour",
            "type": "PropString",
            "displayName": "Four purlin anchor",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 12,
            "variable": "sDescription",
            "type": "PropString",
            "displayName": "Show description",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "dxFlag",
            "type": "PropDouble",
            "displayName": "X-flag",
            "defaultValue": "200.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "dyFlag",
            "type": "PropDouble",
            "displayName": "Y-flag",
            "defaultValue": "300.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 13,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimstyle",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "171",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7621,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates 3D geometry and production data for Simpson Strong-Tie SPF series purlin anchors (Sparrenpfettenanker) connecting two intersecting timber beams.\",\n    \"category\": \"Hardware/Connector\",\n    \"typicalUseCase\": \"An engineer or detailer applying a specific standardized metal tie (SPF170, SPF210, etc.) to secure rafters or purlins to a supporting beam.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sType\",\n      \"technicalDefault\": \"SPF170\",\n      \"businessMeaning\": \"Selects the specific Simpson Strong-Tie product profile, defining the anchor's length, width, and thickness.\",\n      \"validRange\": \"SPF170, SPF210, SPF250, SPF290, SPF330, SPF370, SPF170e, SPF210e, SPFUNI 170, SPFUNI 210\",\n      \"unit\": \"Model Code\",\n      \"affectsOutput\": \"Drives the dimensional arrays (length, width, thickness) used to generate the 3D metal plate body and the label text.\"\n    },\n    {\n      \"name\": \"sArt1\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The commercial article number or part code for the metal plate for purchasing/stock management.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Included in the Model and CompareKey strings; used for BOM/ERP integration.\"\n    },\n    {\n      \"name\": \"sMat1\",\n      \"technicalDefault\": \"Stahl, feuerverzinkt\",\n      \"businessMeaning\": \"The material specification of the anchor plate (e.g., hot-dipped galvanized steel).\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Assigns the material property to the script entity for reporting.\"\n    },\n    {\n      \"name\": \"sNotes1\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Free text field for additional manufacturing instructions regarding the metal part.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Added to the CompareKey and potentially exported notes.\"\n    },\n    {\n      \"name\": \"sMod2\",\n      \"technicalDefault\": \"Kammnagel\",\n      \"businessMeaning\": \"The model or type of fastener (nail) used to attach the plate.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"sArt2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The commercial article number for the nails/fasteners.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"sMat2\",\n      \"technicalDefault\": \"Stahl, verzinkt\",\n      \"businessMeaning\": \"The material of the fasteners.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"dDia\",\n      \"technicalDefault\": \"4.0\",\n      \"businessMeaning\": \"Diameter of the nails used.\",\n      \"validRange\": \"2.5 - 6.0\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"dLen2\",\n      \"technicalDefault\": \"40.0\",\n      \"businessMeaning\": \"Length of the nails used.\",\n      \"validRange\": \"30.0 - 150.0\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"nNail\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Total quantity of nails required for this connection instance.\",\n      \"validRange\": \"0 - 50\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Triggers the creation of Hardware entities if > 0.\"\n    },\n    {\n      \"name\": \"sNotes2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Free text for notes regarding the fasteners.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Passed to the Hardware generation function.\"\n    },\n    {\n      \"name\": \"dOffsetF\",\n      \"technicalDefault\": \"0.0\",\n      \"businessMeaning\": \"Vertical adjustment (up/down) of the 'Front' anchor plate relative to the beam intersection.\",\n      \"validRange\": \"-100.0 - 100.0\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Modifies the Z-coordinate of ptInsert1, shifting the front plate.\"\n    },\n    {\n      \"name\": \"dOffsetB\",\n      \"technicalDefault\": \"0.0\",\n      \"businessMeaning\": \"Vertical adjustment (up/down) of the 'Back' anchor plate relative to the beam intersection.\",\n      \"validRange\": \"-100.0 - 100.0\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Modifies the Z-coordinate of ptInsert2, shifting the back plate.\"\n    },\n    {\n      \"name\": \"sSide\",\n      \"technicalDefault\": \"Front\",\n      \"businessMeaning\": \"Selects which side of the beam intersection the anchor is applied to when 'On One Side' is active.\",\n      \"validRange\": \"Front, Back\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Controls which plate is kept or mirrored when 'On One Side' is enabled.\"\n    },\n    {\n      \"name\": \"sOneSide\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Determines if the connector is applied to a single side of the beam instead of both sides.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"If Yes, mirrors one plate onto the other so they cancel out, effectively resulting in one visible plate.\"\n    },\n    {\n      \"name\": \"sSwitch\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Flips the orientation of the anchor plates across the beam's X-axis.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Mirrors the plate bodies (bd1, bd2) across the X-plane of the intersection.\"\n    },\n    {\n      \"name\": \"sFour\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Enables a four-sided connection (double anchors on both sides) instead of the standard two-sided.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Combines mirrored geometries to generate 4 distinct bodies around the beam intersection.\"\n    },\n    {\n      \"name\": \"sDescription\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the visibility of the product label/flag in the 3D model.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Enables or disables the drawing of text labels (Product Name and Code).\"\n    },\n    {\n      \"name\": \"dxFlag\",\n      \"technicalDefault\": \"200.0\",\n      \"businessMeaning\": \"Horizontal distance of the label leader line from the insertion point.\",\n      \"validRange\": \"0 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positions the text label along the World X direction.\"\n    },\n    {\n      \"name\": \"dyFlag\",\n      \"technicalDefault\": \"300.0\",\n      \"businessMeaning\": \"Vertical distance of the label leader line from the insertion point.\",\n      \"validRange\": \"0 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positions the text label along the World Y direction.\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"_DimStyles\",\n      \"businessMeaning\": \"Specifies the CAD dimension style used to render the text.\",\n      \"validRange\": \"Valid DimStyle names in the drawing\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Controls the appearance (font, size) of the generated text.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": \"171\",\n      \"business"
      },
      "tokens_used": 9541,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched; unit set to mm.",
          "2. User prompted to select First Beam (via getBeam).",
          "3. User prompted to select Second Beam (via getBeam).",
          "4. Validation: Ensure at least 2 beams selected.",
          "5. Properties Dialog/OPM displayed (showDialog).",
          "6. Script identifies product index 'f' based on 'sType' property.",
          "7. Coordinate system calculated based on beam intersection vectors.",
          "8. Insertion points calculated (Front/Back) including user offsets.",
          "9. Base Body geometry generated for Front (bd1) and Back (bd2) plates.",
          "10. Conditional logic applied based on 'sSwitch', 'sOneSide', or 'sFour' properties.",
          "11. Description label generated if 'sDescription' is 'Yes'.",
          "12. Hardware/Nails generated if 'nNail' > 0.",
          "13. Model and Material properties assigned.",
          "14. CompareKey set for regeneration tracking."
        ],
        "conditionalBranches": [
          {
            "condition": "User cancels beam selection or selects less than 2 beams",
            "path1": {
              "name": "Failure Path",
              "steps": [
                "Script detects _Beam.length() < 2",
                "Script executes return command",
                "Insertion aborted, no geometry created"
              ]
            },
            "path2": {
              "name": "Success Path",
              "steps": [
                "2 beams stored in _Beam array",
                "Execution proceeds to showDialog() and calculation"
              ]
            }
          },
          {
            "condition": "Configuration: 'Switch Purlin anchor' (sSwitch)",
            "path1": {
              "name": "Switch: Yes",
              "steps": [
                "bd1 and bd2 bodies mirrored across the X-plane",
                "SideType strings updated to 'Left'"
              ]
            },
            "path2": {
              "name": "Switch: No (Default)",
              "steps": [
                "Proceed to check 'On One Side' condition"
              ]
            }
          },
          {
            "condition": "Configuration: 'On One Side' (sOneSide) - only evaluated if sSwitch is No",
            "path1": {
              "name": "One Side: Yes (Front)",
              "steps": [
                "If sSide == 'Front': bd2 (Back plate) mirrored to match bd1",
                "Visual result is a single thicker plate on Front"
              ]
            },
            "path2": {
              "name": "One Side: Yes (Back)",
              "steps": [
                "If sSide == 'Back': bd1 (Front plate) mirrored to match bd2",
                "Visual result is a single thicker plate on Back"
              ]
            },
            "path3": {
              "name": "One Side: No",
              "steps": [
                "Proceed to check 'Four purlin anchor' condition"
              ]
            }
          },
          {
            "condition": "Configuration: 'Four purlin anchor' (sFour) - only evaluated if sSwitch and sOneSide are No",
            "path1": {
              "name": "Four Sides: Yes",
              "steps": [
                "Copy bd1 to bd3 and bd2 to bd4",
                "Mirror original bd1 and bd2 across X-plane",
                "Union originals and copies (bd1+bd3, bd2+bd4)",
                "Generates 4 distinct plates around the connection",
                "Variable nBd set to 4"
              ]
            },
            "path2": {
              "name": "Standard (Default)",
              "steps": [
                "Geometry remains as standard Front/Back pair",
                "nBd remains 2"
              ]
            }
          },
          {
            "condition": "Visibility: 'Show description' (sDescription)",
            "path1": {
              "name": "Show: Yes",
              "steps": [
                "Draw Product Name text at Grip Point",
                "Draw Product Code text below Name",
                "Draw Leader Line from insertion point to text"
              ]
            },
            "path2": {
              "name": "Show: No",
              "steps": [
                "Text and leader line are skipped"
              ]
            }
          },
          {
            "condition": "Hardware Generation",
            "path1": {
              "name": "Nails Present",
              "steps": [
                "Check if nNail > 0",
                "Execute Hardware() function",
                "Generate nail entities in model"
              ]
            },
            "path2": {
              "name": "No Nails",
              "steps": [
                "Hardware generation skipped"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Selection Count",
            "errorMessage": "None (Silent return)",
            "recovery": "User must restart script and ensure they select two beams."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Anchor Dimensions/Type",
            "how": "OPM (Properties Palette) - Change 'sType'",
            "effect": "Script recalculates 'f' index, updates Body dimensions (Length/Width/Thickness), and regenerates geometry."
          },
          {
            "action": "Adjust Plate Position",
            "how": "OPM - Change 'Offset purlin anchor front' (dOffsetF) or 'Offset purlin anchor back' (dOffsetB)",
            "effect": "Insertion points ptInsert1 and ptInsert2 are recalculated, shifting the plates vertically."
          },
          {
            "action": "Change Configuration",
            "how": "OPM - Toggle 'sSwitch', 'sOneSide', or 'sFour'",
            "effect": "Triggers specific transformation branches (mirroring/union), changing the layout from 2-sided to 1-sided or 4-sided."
          },
          {
            "action": "Move Description Label",
            "how": "Grip Edit - Drag the Grip Point (_PtG[0])",
            "effect": "The text and leader line move to the new grip location. Note: dxFlag and dyFlag become Read-Only after insertion, so subsequent position edits must use the grip."
          },
          {
            "action": "Toggle Label Visibility",
            "how": "OPM - Change 'sDescription' to 'No' or 'Yes'",
            "effect": "Immediately adds or removes the text flag and leader line."
          },
          {
            "action": "Update Fastener Info",
            "how": "OPM - Modify 'nNail' count or 'sArt2' details",
            "effect": "Updates or creates the Hardware entity associated with the script."
          }
        ]
      },
      "tokens_used": 11429,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# SimpsonStrongTieSPF.mcr\n\n## Overview\nThis script generates 3D geometry and production data for Simpson Strong-Tie SPF series purlin anchors. It connects two intersecting timber beams (such as a rafter to a purlin) with standardized metal plates and optional nail hardware.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for beam selection and 3D geometry generation. |\n| Paper Space | No | This script does not generate 2D details or layout views. |\n| Shop Drawing | No | This is a modeling script, not a drawing generation tool. |\n\n## Prerequisites\n- **Required Entities**: At least two timber beams (GenBeams).\n- **Minimum Beam Count**: 2 (A supporting beam and the beam to be connected).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  Type `TSLINSERT` in the command line.\n2.  Select `SimpsonStrongTieSPF.mcr` from the file dialog.\n\n### Step 2: Select Supporting Beam\n```\nCommand Line: Select First Beam\nAction: Click on the primary beam (e.g., the purlin) that supports the connection.\n```\n\n### Step 3: Select Secondary Beam\n```\nCommand Line: Select Second Beam\nAction: Click on the secondary beam (e.g., the rafter) that intersects the first beam.\n```\n\n### Step 4: Configure Properties\n1.  After selection, the script generates the default geometry.\n2.  Select the newly created element and open the **Properties Palette** (Ctrl+1).\n3.  Adjust parameters (e.g., Type, Offsets, Nail count) as required.\n\n## Properties Panel Parameters\n\n### General & Geometry\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Purlin anchor | dropdown | SPF170 | Selects the Simpson Strong-Tie model profile (e.g., SPF170, SPF210). |\n| Article | text | | Commercial article number for the metal plate. |\n| Material | text | Stahl, feuerverzinkt | Material specification for the plate. |\n| Metalpart Notes | text | | Additional manufacturing notes for the plate. |\n| Show description | dropdown | Yes | Toggles the visibility of the product label/flag in the model. |\n\n### Position & Configuration\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Offset purlin anchor front | number | 0.0 | Vertical adjustment (mm) for the front plate relative to the beam intersection. |\n| Offset purlin anchor back | number | 0.0 | Vertical adjustment (mm) for the back plate relative to the beam intersection. |\n| Side | dropdown | Front | Determines which side is used when \"On One Side\" is active. |\n| On One Side | dropdown | No | If Yes, creates a single plate instead of two mirrored plates. |\n| Switch Purlin anchor | dropdown | No | If Yes, flips the orientation of the plates across the beam axis. |\n| Four purlin anchor | dropdown | No | If Yes, creates a 4-sided connection (double anchors). |\n\n### Label Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| X-flag | number | 200.0 | Horizontal distance (mm) of the label leader line from the insertion point. |\n| Y-flag | number | 300.0 | Vertical distance (mm) of the label leader line from the insertion point. |\n| Dimstyle | dropdown | _DimStyles | The dimension style used for the label text. |\n| Color | number | 171 | Color index for the generated geometry. |\n\n### Fasteners (Nails)\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Nail Model | text | Kammnagel | Model type of the nail. |\n| Article | text | | Commercial article number for the nails. |\n| Material | text | Stahl, verzinkt | Material specification for the nails. |\n| Nail Diameter | number | 4.0 | Diameter of the nails (mm). |\n| Nail Length | number | 40.0 | Length of the nails (mm). |\n| Number of nails | number | 0 | Total quantity of nails to generate. Set > 0 to create hardware. |\n| Metalpart Notes | text | | Additional notes for the fasteners. |\n\n## Right-Click Menu Options\nNo specific custom context menu options are defined for this script. Use the standard AutoCAD/hsbCAD Properties Palette to modify settings.\n\n## Settings Files\nNo external settings files (XML/TXT) are required for this script.\n\n## Tips\n- **Change Size Quickly**: You can change the anchor type (e.g., from SPF170 to SPF250) directly in the Properties Palette after insertion without re-running the script.\n- **Move the Label**: After insertion, select the anchor and use the **Grip Point** (square handle) to drag the product label to a desired location. This updates the visual position immediately.\n- **Single vs. Double Sided**: Use the **On One Side** property if you only want the plate on one face of the beam. Use **Four purlin anchor** for heavy-duty connections requiring double plating.\n- **Nail Visualization**: Nails will only appear in the 3D model if the **Number of nails** property is set to a value greater than 0.\n\n## FAQ\n- **Q: How do I rotate the plate to the other side of the beam?**\n  A: Change the **Side** property to \"Front\" or \"Back\". If you need to flip the orientation entirely, set **Switch Purlin anchor** to \"Yes\".\n- **Q: Why don't I see any nails?**\n  A: Check the **Number of nails** property in the Properties Palette. It defaults to 0. Increase this value to generate the nail hardware.\n- **Q: The plate is sitting too high/low on the beam.**\n  A: Use the **Offset purlin anchor front** or **Offset purlin anchor back** properties to shift the plate vertically."
      },
      "tokens_used": 9004,
      "error": null
    }
  }
}