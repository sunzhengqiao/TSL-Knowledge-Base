{
  "filename": "hsb_SetInformationOnPropSet.mcr",
  "status": "completed",
  "total_tokens": 25333,
  "processing_time": 236.03971481323242,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 5445,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses PrEntity to select Element(). Casts selection to ElementWall. Modifies Property Sets on Openings within the Element. No 'sd_' prefix, Viewport handling, or '#Type E' syntax found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "ElementWall",
            "Opening"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires selection of a Wall Element containing Openings.",
          "requiredSettings": [
            "Property Set definition 'hsbDoorInformation'",
            "Property Set definition 'Door Schedule'"
          ]
        }
      },
      "tokens_used": 3171,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select an Elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3550,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically calculates the wall thickness for openings (doors/windows) within selected wall elements and updates their Property Sets with this data.",
          "category": "Data Management / Scheduling",
          "typicalUseCase": "Used after wall design is finalized to populate the 'hsbDoorInformation' Property Set on openings with the correct 'WallThickness' and a default 'Weight', ensuring accurate schedules and BIM data."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Empty Selection",
            "businessMeaning": "The Wall Element(s) to be scanned for openings. The script processes all openings found within these walls.",
            "validRange": "Existing ElementWall entities in the drawing",
            "unit": "Selection",
            "affectsOutput": "Determines the scope of openings that receive the updated Property Set information. If no valid wall is selected, the script erases itself."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "PropertySet Data",
            "description": "Updates the Property Set 'hsbDoorInformation' on opening entities. Sets 'WallThickness' to the calculated thickness of the parent wall and 'Weight' to 0.",
            "appliedTo": "Opening entities contained within the selected Wall Elements."
          }
        ]
      },
      "tokens_used": 3824,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched: System checks execution cycle.",
          "2. [Cycle Check] If insertCycleCount > 1, script erases self and exits (Safety).",
          "3. [User Input] Command line prompts user to 'Select an Elements'.",
          "4. User selects one or more Wall Elements and confirms.",
          "5. Script stores selected Elements and terminates insertion phase (returns).",
          "6. [Execution] Script runs again; loads properties from catalog if applicable.",
          "7. [Validation] Checks if any elements were selected. If no, script erases self.",
          "8. [Validation] Checks if the first element is a valid ElementWall. If invalid, script erases self.",
          "9. [Processing] Loops through all selected Wall Elements.",
          "10. [Processing] Loops through all Openings found within each Wall.",
          "11. [Calculation] Calculates Wall Thickness using vector dot product of wall zones.",
          "12. [Data Update] Attaches 'hsbDoorInformation' Property Set to Opening.",
          "13. [Data Update] Sets 'WallThickness' and 'Weight' values in the Property Set.",
          "14. [Cleanup] Script erases itself from the model (Fire and Forget)."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert Cycle Count (Safety Check)",
            "path1": {
              "name": "Repeat Run",
              "steps": [
                "Detect insertCycleCount > 1",
                "Execute eraseInstance()",
                "Exit script"
              ]
            },
            "path2": {
              "name": "First Run",
              "steps": [
                "Proceed to PrEntity prompt",
                "Wait for user selection"
              ]
            }
          },
          {
            "condition": "User Selection (ssE.go)",
            "path1": {
              "name": "Selection Confirmed",
              "steps": [
                "Append selection to _Element array",
                "Return to trigger execution phase"
              ]
            },
            "path2": {
              "name": "Selection Cancelled",
              "steps": [
                "Return (Implicit exit or erasure depending on CAD environment)"
              ]
            }
          },
          {
            "condition": "Entity Validation",
            "path1": {
              "name": "Valid Data",
              "steps": [
                "Element count > 0",
                "Element is a valid ElementWall",
                "Process Openings"
              ]
            },
            "path2": {
              "name": "Invalid/Missing Data",
              "steps": [
                "Detect empty selection or invalid wall",
                "Execute eraseInstance()",
                "Exit"
              ]
            }
          },
          {
            "condition": "Internal Logic Switch (nOptions variable)",
            "path1": {
              "name": "Standard Mode (nOptions=0)",
              "steps": [
                "Attach 'hsbDoorInformation'",
                "Set WallThickness and Weight"
              ]
            },
            "path2": {
              "name": "Header Mode (nOptions=1)",
              "steps": [
                "Read ElementTexts (WINDOW/HEADER)",
                "Find closest header to opening",
                "Update 'Header_Description' in 'Door Schedule'"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent)",
            "recovery": "Script automatically erases instance to prevent errors."
          },
          {
            "check": "Selection Count (_Element.length)",
            "errorMessage": "None (Silent)",
            "recovery": "If no elements are stored, script erases itself."
          },
          {
            "check": "Element Type and Validity",
            "errorMessage": "None (Silent)",
            "recovery": "Checks if object is a valid 'ElementWall'. If not, script erases itself."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None",
            "how": "N/A",
            "effect": "The script executes once and calls 'eraseInstance()' at the end, removing itself from the drawing. It cannot be modified via grips or OPM after insertion."
          }
        ]
      },
      "tokens_used": 5527,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetInformationOnPropSet.mcr\n\n## Overview\nThis script automatically calculates the wall thickness for door and window openings within selected wall elements and updates their Property Sets with this data. It ensures that the `hsbDoorInformation` attached to openings accurately reflects the wall geometry for BIM scheduling.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment for the script. |\n| Paper Space | No | Not supported in Paper Space. |\n| Shop Drawing | No | Not designed for Shop Drawing contexts. |\n\n## Prerequisites\n- **Required Entities**: Wall Elements (`ElementWall`) that contain Openings.\n- **Minimum Beam Count**: 0 (The script operates on Wall Elements).\n- **Required Settings**: The drawing must contain the Property Set definitions `hsbDoorInformation` and `Door Schedule`.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` (or your company's custom insert command) â†’ Select `hsb_SetInformationOnPropSet.mcr`\n\n### Step 2: Select Walls\n```\nCommand Line: Select an Elements\nAction: Click on one or more Wall Elements in the model that contain the openings you wish to update. Press Enter or Right-Click to confirm selection.\n```\n\n### Step 3: Automatic Processing\nOnce confirmed, the script will automatically:\n1.  Scan all selected walls for openings.\n2.  Calculate the wall thickness for each opening.\n3.  Update the `WallThickness` and `Weight` properties in the `hsbDoorInformation` Property Set for each opening.\n4.  Remove itself from the drawing (it will disappear from the model after completion).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose any editable properties in the Properties Palette. It runs entirely via command-line input. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add custom options to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external XML settings files. It relies on the Property Set definitions currently loaded in your AutoCAD/hsbCAD project.\n\n## Tips\n- **Batch Processing**: You can select multiple walls at once during the selection prompt to update information for many openings simultaneously.\n- **Verification**: After the script runs (and disappears), select a door or window and check the Properties Palette under the `hsbDoorInformation` tab to verify that the `WallThickness` has been updated.\n- **Clean Up**: Since the script erases itself after running, you do not need to manually delete it from the drawing.\n\n## FAQ\n- **Q: The script disappeared immediately after I selected the walls. Did it fail?**\n  - A: No. This script is designed as a \"Fire and Forget\" tool. It automatically erases itself from the model once it finishes updating the property data to keep your drawing clean.\n  \n- **Q: Why didn't the properties update on my doors?**\n  - A: Ensure that the elements you selected are valid Wall Elements (`ElementWall`) and that they actually contain openings. Also, verify that the Property Set definition `hsbDoorInformation` exists in your drawing."
      },
      "tokens_used": 3816,
      "error": null
    }
  }
}