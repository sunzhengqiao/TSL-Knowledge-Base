{
  "filename": "HSB_E-NailClusters.mcr",
  "status": "completed",
  "total_tokens": 54561,
  "processing_time": 357.8981144428253,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8741,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses Element and GenBeam objects to calculate 3D geometric intersections between zones. Adds ElemNailCluster tools directly to elements using el.addTool(). Uses PrEntity for selecting elements in the model. No usage of _Viewport, sd_*, or Sheet drawing generation classes."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "hsbCAD Model Space",
          "requiredSettings": [
            "Elements must have defined zones to intersect",
            "Optional: HSB_G-FilterGenBeams catalog entries for filtering logic"
          ]
        }
      },
      "tokens_used": 6237,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": \"TslInst().showDialog()\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select elements|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"showDialog\",\n      \"trigger\": \"On Insert (if no execute key provided)\",\n      \"title\": null,\n      \"dataSource\": \"Internal Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"labelFilter\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter sheets with label|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Objects to nail|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"zoneToNailOnProp\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Zone to nail on|\",\n      \"defaultValue\": \"1\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"0\",\n        \"1\",\n        \"2\",\n        \"3\",\n        \"4\",\n        \"5\",\n        \"6\",\n        \"7\",\n        \"8\",\n        \"9\",\n        \"10\"\n      ],\n      \"category\": \"|Objects to nail|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"genBeamFilterDefinitionToNail\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter definition for genbeams to nail|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Dynamic from 'HSB_G-FilterGenBeams' catalog\",\n      \"category\": \"|Objects to nail|\",\n      \"description\": \"|Filter definition for beams to nail.| |Use| HSB_G-FilterGenBeams |to define the filters|.\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"genBeamFilterDefinitionToNailOn\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter definition for genbeams to nail on|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Dynamic from 'HSB_G-FilterGenBeams' catalog\",\n      \"category\": \"|Objects to nail|\",\n      \"description\": \"|Filter definition for beams to nail on.| |Use| HSB_G-FilterGenBeams |to define the filters|.\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"tslIdentifier\",\n      \"type\": \"PropString\",\n      \"displayName\": \" |Tsl identifier|\",\n      \"defaultValue\": \"Pos 1\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"|Only one tsl instance, per identifier, can be attached to an element.|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"verticalExcentricNailOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Vertical excentric offset|\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Nail settings|\",\n      \"description\": \"|Set the vertical excentric offset from the center of the nail area.|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"horizontalExcentricNailOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Horizontal excentric offset|\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Nail settings|\",\n      \"description\": \"|Set the horizontal excentric offset from the center of the nail area.|\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"verticalNailOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Vertical offset|\",\n      \"defaultValue\": \"U(12)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Nail settings|\",\n      \"description\": \"|Set the vertical offset from the center of the nail area.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"horizontalNailOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Horizontal offset|\",\n      \"defaultValue\": \"U(9)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Nail settings|\",\n      \"description\": \"|Set the horizontal offset from the center of the nail area.|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"minimumDistanceSheetEdge\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Minimum distance to sheet edge|\",\n      \"defaultValue\": \"U(5)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Nail settings|\",\n      \"description\": \"|Set the minimum required distance to the"
      },
      "tokens_used": 9455,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically calculates and generates nail clusters to attach sheathing or panels to structural timber based on intersecting material zones.",
          "category": "Hardware",
          "typicalUseCase": "Applying nailing patterns for wall panels (OSB/Plywood) onto timber studs or rafters in the 3D model."
        },
        "parameters": [
          {
            "name": "labelFilter",
            "technicalDefault": "\"\"",
            "businessMeaning": "Filters which elements (sheets/panels) are processed based on a specific text label.",
            "validRange": "Any alphanumeric string (e.g., 'ExtWall', 'Roof')",
            "unit": "text",
            "affectsOutput": "Restricts script execution to only elements matching the label; if empty, all selected elements are processed."
          },
          {
            "name": "zoneToNailProp",
            "technicalDefault": "1",
            "businessMeaning": "Specifies the material zone of the element that acts as the 'sheet' to be nailed (the object receiving the nails).",
            "validRange": "0-10 (typically 1 for sheathing)",
            "unit": "index",
            "affectsOutput": "Defines which geometric volume of the element is used to find intersection areas."
          },
          {
            "name": "genBeamFilterDefinitionToNail",
            "technicalDefault": "\"\"",
            "businessMeaning": "Filters the underlying structural beams to determine which valid areas are considered for nailing.",
            "validRange": "Entries from 'HSB_G-FilterGenBeams' catalog",
            "unit": "catalog entry",
            "affectsOutput": "Excludes beams from calculation (e.g., blocking) to only nail onto primary structure like studs/joists."
          },
          {
            "name": "genBeamFilterDefinitionToNailOn",
            "technicalDefault": "\"\"",
            "businessMeaning": "Filters the beams that define the surface being nailed onto (the reference structure).",
            "validRange": "Entries from 'HSB_G-FilterGenBeams' catalog",
            "unit": "catalog entry",
            "affectsOutput": "Refines the intersection calculation to specific beam types."
          },
          {
            "name": "tslIdentifier",
            "technicalDefault": "\"Pos 1\"",
            "businessMeaning": "Allows multiple instances of this script to exist on the same element for different nailing configurations.",
            "validRange": "Unique string (e.g., 'Pos 1', 'Pos 2')",
            "unit": "text",
            "affectsOutput": "Prevents instance overwriting; allows distinct nailing rules on one element."
          },
          {
            "name": "verticalExcentricNailOffset",
            "technicalDefault": "U(0)",
            "businessMeaning": "Moves the calculated nail center point up or down relative to the default position.",
            "validRange": "-100mm to +100mm",
            "unit": "mm",
            "affectsOutput": "Shifts the entire nail cluster vertically."
          },
          {
            "name": "horizontalExcentricNailOffset",
            "technicalDefault": "U(0)",
            "businessMeaning": "Moves the calculated nail center point left or right relative to the default position.",
            "validRange": "-100mm to +100mm",
            "unit": "mm",
            "affectsOutput": "Shifts the entire nail cluster horizontally."
          },
          {
            "name": "verticalNailOffset",
            "technicalDefault": "U(12)",
            "businessMeaning": "Distance from the center to place the nail(s) vertically (used to create spacing if 2 nails are defined).",
            "validRange": "0mm to 100mm",
            "unit": "mm",
            "affectsOutput": "Determines the vertical spread of the nail pair."
          },
          {
            "name": "horizontalNailOffset",
            "technicalDefault": "U(9)",
            "businessMeaning": "Distance from the center to place the nail(s) horizontally (used to create spacing if 2 nails are defined).",
            "validRange": "0mm to 100mm",
            "unit": "mm",
            "affectsOutput": "Determines the horizontal spread of the nail pair."
          },
          {
            "name": "minimumDistanceSheetEdge",
            "technicalDefault": "U(5)",
            "businessMeaning": "Safety margin from the edge of the sheet material where nails are forbidden.",
            "validRange": "0mm to 20mm",
            "unit": "mm",
            "affectsOutput": "Suppresses nail placement if the position is too close to the sheet boundary."
          },
          {
            "name": "numberOfNails",
            "technicalDefault": "1",
            "businessMeaning": "Quantity of nails to place at each calculated cluster location.",
            "validRange": "1 or 2",
            "unit": "count",
            "affectsOutput": "If 2, applies horizontal/vertical offsets to create a pair."
          },
          {
            "name": "toolIndex",
            "technicalDefault": "1",
            "businessMeaning": "Identifier for the nail gun/tool to be used in production/CNC files.",
            "validRange": "Integer (Machine specific)",
            "unit": "index",
            "affectsOutput": "Assigns the specific tool data to the nail cluster."
          },
          {
            "name": "sAddNailingToExtremes",
            "technicalDefault": "No",
            "businessMeaning": "If enabled, forces nails to the extreme corners of the valid area if standard placement fails.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "Ensures nailing occurs even if ideal center placement is invalid due to edge constraints."
          },
          {
            "name": "sTakeCenterOfBoundingBox",
            "technicalDefault": "No",
            "businessMeaning": "Uses the bounding box center instead of the profile centroid for the calculation origin.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "Alters the reference point used to apply offsets."
          },
          {
            "name": "minimumDistanceForNailDistribution",
            "technicalDefault": "U(0)",
            "businessMeaning": "Minimum length of intersection required to switch from a single point cluster to a distributed line of nails.",
            "validRange": "0mm to 600mm",
            "unit": "mm",
            "affectsOutput": "If intersection exceeds this, nails are spaced along the length; otherwise, a single cluster is used."
          },
          {
            "name": "distributedNailSpacing",
            "technicalDefault": "U(50)",
            "businessMeaning": "On-center spacing between nails when distributed mode is active.",
            "validRange": "150mm to 600mm (standard spacing)",
            "unit": "mm",
            "affectsOutput": "Determines the frequency of nails along the intersection line."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "numberOfNails = 2",
            "effect": "Activates the horizontal and vertical offsets to separate the two nails.",
            "cascade": [
              "horizontalNailOffset",
              "verticalNailOffset"
            ]
          },
          {
            "trigger": "minimumDistanceForNailDistribution > 0",
            "effect": "Checks the length of the intersection area to decide between single cluster vs distributed nailing.",
            "cascade": [
              "distributedNailSpacing"
            ]
          },
          {
            "trigger": "sAddNailingToExtremes = Yes",
            "effect": "Overrides standard offsets if they cause the nail to fall outside the 'minimumDistanceSheetEdge'.",
            "cascade": [
              "horizontalNailOffset",
              "verticalNailOffset",
              "minimumDistanceSheetEdge"
            ]
          },
          {
            "trigger": "genBeamFilterDefinitionToNail / genBeamFilterDefinitionToNailOn",
            "effect": "Dynamically limits the list of beams considered for intersection calculation.",
            "cascade": [
              "labelFilter",
              "zoneToNailProp"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "ElemNailCluster",
            "description": "Production-ready nail points assigned to the element for machining or labeling.",
            "appliedTo": "The selected Element (e.g., Wall Panel) in the zone specified by 'zoneToNailProp'."
          }
        ]
      },
      "tokens_used": 10026,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization: Load properties and check for Delete execute key.",
          "2. Insertion Sequence (_bOnInsert):",
          "   a. Show Dialog (if no execute key provided).",
          "   b. Prompt user to select Elements (PrEntity).",
          "   c. Loop through selected elements.",
          "3. Uniqueness Check: Verify if script instance with same 'tslIdentifier' already exists on the element.",
          "4. Instance Attachment: Append script instance to the element and set 'ManualInserted' map flag.",
          "5. Geometry Calculation:",
          "   a. Retrieve saved 'No Nail' positions from Map.",
          "   b. Filter GenBeams based on 'genBeamFilterDefinitionToNail' and exclude 'NONAIL' attributes.",
          "   c. Calculate intersection profile between 'Zone to nail' (Shell) and filtered beams (Solids).",
          "   d. Subtract 'No Nail' areas (generated as circular profiles around stored points) from the intersection.",
          "6. Nail Area Processing (Iterate through resulting profiles):",
          "   a. Determine Reference Point (Centroid or Bounding Box Center).",
          "   b. Apply Excentric Offsets.",
          "   c. Check Distribution Threshold (Profile Length vs 'minimumDistanceForNailDistribution').",
          "   d. Calculate Nail Positions (Single cluster, Pair, or Distributed line).",
          "   e. Validate positions against 'minimumDistanceSheetEdge' (Shrunken Profile).",
          "   f. Fallback to 'Extreme Points' if validation fails and option is enabled.",
          "7. Output Generation: Create and add ElemNailCluster to the element.",
          "8. Visuals: Draw 'No Nail' areas with hatching.",
          "9. Context Menu Execution: Handle 'Add no nail areas' or 'Remove no nail areas' user interactions."
        ],
        "conditionalBranches": [
          {
            "condition": "Execute Key is 'Delete'",
            "path1": {
              "name": "Delete Branch",
              "steps": [
                "Execute eraseInstance()",
                "Return immediately"
              ]
            },
            "path2": {
              "name": "Standard Execution",
              "steps": [
                "Continue to property loading"
              ]
            }
          },
          {
            "condition": "Existing TSL with same 'tslIdentifier' found on element",
            "path1": {
              "name": "Duplicate Detected",
              "steps": [
                "Erase the newly created instance",
                "Skip to next selected element"
              ]
            },
            "path2": {
              "name": "Unique Identifier",
              "steps": [
                "Append instance to element",
                "Proceed to calculations"
              ]
            }
          },
          {
            "condition": "Intersection length > 'minimumDistanceForNailDistribution'",
            "path1": {
              "name": "Distributed Nailing",
              "steps": [
                "Calculate start and end points of segment",
                "Divide length by 'distributedNailSpacing'",
                "Generate array of points along the line"
              ]
            },
            "path2": {
              "name": "Single Cluster",
              "steps": [
                "Calculate center point",
                "Apply 'horizontalNailOffset' and 'verticalNailOffset'",
                "If 'numberOfNails' == 2, create second point with mirrored offsets"
              ]
            }
          },
          {
            "condition": "Calculated Nail Position is outside 'minimumDistanceSheetEdge' (Shrunken Profile)",
            "path1": {
              "name": "Invalid Position (with Extremes Fallback)",
              "steps": [
                "If 'sAddNailingToExtremes' is Yes: Calculate vertices of the valid profile",
                "Find the two furthest vertices",
                "Place nails at these extreme points"
              ]
            },
            "path2": {
              "name": "Valid Position / Failed Fallback",
              "steps": [
                "If Valid: Create ElemNailCluster",
                "If Invalid and Fallback fails: Discard this nail area"
              ]
            }
          },
          {
            "condition": "Execute Key is 'Add no nail areas'",
            "path1": {
              "name": "Add No Nail Flow",
              "steps": [
                "Prompt user to select points inside nail area (getPoint)",
                "Validate points are inside current nail profile",
                "Append points to 'noNailPositions' list",
                "Update Map and Recalc script"
              ]
            },
            "path2": {
              "name": "Remove No Nail Flow",
              "steps": [
                "Prompt user to select points inside current no-nail areas",
                "Identify which rings contain these points",
                "Remove corresponding points from 'noNailPositions' list",
                "Update Map and Recalc script"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Duplicate TSL Identifier",
            "errorMessage": "None (Silent)",
            "recovery": "Script erases the new instance automatically to prevent conflicts. User must use a different 'tslIdentifier' if they want a second instance."
          },
          {
            "check": "Nail Position vs Sheet Edge",
            "errorMessage": "None (Internal Logic)",
            "recovery": "If standard offset placement is too close to the edge (< 'minimumDistanceSheetEdge'), the script attempts to place nails at the extreme points of the valid area. If that fails, no nail is created for that specific area."
          },
          {
            "check": "Point inside Profile (Context Menu)",
            "errorMessage": "None (Input Filter)",
            "recovery": "When adding/removing no-nail areas, the script checks `pointInProfile`. If the user clicks outside the relevant area, the point is ignored for the current operation."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Nail Parameters",
            "how": "OPM (AutoCAD Properties Palette)",
            "effect": "Changing offsets, spacing, or filters triggers an automatic recalc, updating nail positions and counts immediately."
          },
          {
            "action": "Add No Nail Areas",
            "how": "Right-click Context Menu -> 'Add no nail areas'",
            "effect": "Prompts for point selection. Creates exclusion zones (hatched visually) where nails will not be generated. Useful for avoiding openings or hardware."
          },
          {
            "action": "Remove No Nail Areas",
            "how": "Right-click Context Menu -> 'Remove no nail areas'",
            "effect": "Prompts for selection within existing no-nail zones to restore them as valid nailing areas."
          },
          {
            "action": "Delete Instance",
            "how": "Right-click Context Menu -> 'Delete'",
            "effect": "Removes the script and all associated nail clusters from the element."
          }
        ]
      },
      "tokens_used": 11831,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-NailClusters.mcr\n\n## Overview\nThis script automatically calculates and generates nail clusters to attach sheathing or panels (like OSB or Plywood) to structural timber elements based on intersecting material zones. It handles complex distribution rules, edge constraints, and \"no nail\" exclusion zones.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D Elements and GenBeams. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | Not applicable for drawing generation. |\n\n## Prerequisites\n- **Required Entities**: `Element` (e.g., a wall or roof panel containing the sheathing material) and `GenBeams` (the underlying structural studs or rafters).\n- **Minimum Beam Count**: N/A (Depends on the construction).\n- **Required Settings**:\n  - Elements must have defined material zones (Material Maps) to identify the sheathing layer.\n  - Optional: Catalog entries in `HSB_G-FilterGenBeams` to filter specific beam types.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse the file list and select `HSB_E-NailClusters.mcr`.\n\n### Step 2: Configuration & Selection\n```\nDialog: Properties Palette (OPM)\nAction: Set initial filters, nail spacing, and offsets if desired before insertion.\n```\n```\nCommand Line: Select elements\nAction: Click on the Element(s) (e.g., Wall Panels) that you want to apply the nailing pattern to.\n```\n\n## Properties Panel Parameters\n\n### Objects to nail\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Filter sheets with label** | Text | \"\" | Filters which elements are processed based on their label property. Leave empty to process all selected elements. |\n| **Zone to nail on** | Dropdown | 1 | Specifies the material zone of the element acting as the \"sheet\" (e.g., Zone 1 is often the outer sheathing layer). |\n| **Filter definition for genbeams to nail** | Dropdown | \"\" | Filters the structural beams that are considered \"nailable\". Select a catalog entry from `HSB_G-FilterGenBeams`. |\n| **Filter definition for genbeams to nail on** | Dropdown | \"\" | Filters the reference beams defining the surface. Select a catalog entry from `HSB_G-FilterGenBeams`. |\n| **Tsl identifier** | Text | Pos 1 | Unique ID for this script instance. Change this (e.g., to \"Pos 2\") to allow multiple different nailing patterns on the same element. |\n\n### Nail settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Vertical excentric offset** | Number | 0 mm | Moves the entire nail cluster up or down from the calculated center. |\n| **Horizontal excentric offset** | Number | 0 mm | Moves the entire nail cluster left or right from the calculated center. |\n| **Vertical offset** | Number | 12 mm | Distance from the center to place the nail (used if *Number of nails* is 2). |\n| **Horizontal offset** | Number | 9 mm | Distance from the center to place the nail (used if *Number of nails* is 2). |\n| **Minimum distance to sheet edge** | Number | 5 mm | Safety margin from the edge of the sheet. Nails closer than this distance will not be placed (unless fallbacks are triggered). |\n| **Number of nails** | Number | 1 | Quantity of nails per cluster location (1 or 2). |\n| **Minimum distance for nail distribution** | Number | 0 mm | Minimum length of intersection required to switch to distributed nailing (nails spaced along a line). |\n| **Distributed nail spacing** | Number | 50 mm | Spacing between nails when distributed nailing is active. |\n| **Tool index** | Number | 1 | Identifier for the nail gun/tool to be used in production/CNC files. |\n\n### Calculation Logic\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Add nailing to extremes** | Yes/No | No | If enabled, forces nails to the extreme corners of the valid area if standard placement fails edge checks. |\n| **Take center of bounding box** | Yes/No | No | Uses the bounding box center instead of the profile centroid for the calculation origin. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Add no nail areas** | Prompts you to select points inside the current nail area. These points become exclusion zones (shown with hatching) where no nails will be generated. Useful for avoiding obstructions or openings. |\n| **Remove no nail areas** | Prompts you to select points inside existing no-nail zones to remove the exclusion and allow nailing there again. |\n| **Delete** | Removes the script instance and all associated nail clusters from the element. |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: hsbCAD Company or Installation directory (Catalogs).\n- **Purpose**: Defines filter logic to categorize beams (e.g., distinguishing structural studs from blocking or trimmers) to control where nails are applied.\n\n## Tips\n- **Multiple Patterns**: Use the **Tsl identifier** to apply different nailing patterns to the same wall. For example, use \"Pos 1\" for standard field nailing and \"Pos 2\" for edge nailing with tighter spacing.\n- **Filtering**: If nails appear on blocking or trimmers unintentionally, use the **Filter definition for genbeams to nail** to restrict nailing to only specific structural members (like \"Studs\").\n- **Visualizing Exclusions**: After using \"Add no nail areas,\" the script draws hatched circles to visualize where nails are excluded.\n- **Edge Failures**: If nails are missing near the edges of a sheet, try reducing the **Minimum distance to sheet edge** or enabling **Add nailing to extremes**.\n\n## FAQ\n- **Q: Why are no nails showing up?**\n  - **A**: Check that the **Zone to nail on** matches the actual material zone of your sheathing. Ensure the element intersects with GenBeams physically. Verify that your filters aren't excluding all beams.\n- **Q: How do I nail two different sheets on one wall differently?**\n  - **A**: Run the script twice. Set the **Filter sheets with label** to match the sheet labels (e.g., \"ExtWall\" vs \"IntWall\") and give them different **Tsl identifier** values.\n- **Q: Nails are too close to the edge of the board.**\n  - **A**: Increase the **Minimum distance to sheet edge** value. If nails disappear, the script determined there was no valid space; try enabling **Add nailing to extremes**."
      },
      "tokens_used": 8271,
      "error": null
    }
  }
}