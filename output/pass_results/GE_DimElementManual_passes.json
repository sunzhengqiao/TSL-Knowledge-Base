{
  "filename": "GE_DimElementManual.mcr",
  "status": "completed",
  "total_tokens": 50962,
  "processing_time": 570.5899591445923,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8846,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `getElement()`, `_Element`, and `assignToElementGroup()` to interact directly with 3D construction entities. It accesses 3D properties like `el.vecX()`, `el.vecY()`, `el.plEnvelope()`. No Shop Drawing API (`sd_`), `_Viewport`, or Paper Space specific functions are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6431,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getString\",\n        \"promptOriginal\": \"Dimension Orientation: [/1: Horizontal/2: Vertical/3: Custom]\",\n        \"condition\": \"_bOnInsert && _kExecuteKey == \\\"\\\"\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select points to dimension\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select Dimline Base Reference\",\n        \"condition\": \"_bOnInsert && stOrientation == \\\"3\\\"\",\n        \"required\": false\n      },\n      {\n        \"step\": 4,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select Dimline Direction\",\n        \"condition\": \"_bOnInsert && stOrientation == \\\"3\\\"\",\n        \"required\": false\n      },\n      {\n        \"step\": 5,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select Dimline Location\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": [\n      {\n        \"prompt\": \"Dimension Orientation: [/1: Horizontal/2: Vertical/3: Custom]\",\n        \"options\": [\n          \"1\",\n          \"2\",\n          \"3\"\n        ]\n      }\n    ]\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"psDimType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension Type\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n"
      },
      "tokens_used": 9538,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Manually creates construction dimensioning annotations on specific points of a timber element in 3D model space.",
          "category": "Annotation",
          "typicalUseCase": "Used when automated dimensioning is insufficient, allowing the user to manually select points on a wall or panel to label with Delta, Ordinate, or Overall dimensions in Metric or Imperial formats."
        },
        "parameters": [
          {
            "name": "psDimType",
            "technicalDefault": "Ordinate",
            "businessMeaning": "Determines the logic of how distances are calculated and displayed: 'Ordinate' stacks dimensions from a baseline, 'Delta' measures distances between consecutive points, and 'Delta + Overall' adds the total span.",
            "validRange": "Ordinate, Delta, Delta + Overall",
            "unit": "Selection",
            "affectsOutput": "Changes the calculation of dimension values and the graphical arrangement of the dimension leaders."
          },
          {
            "name": "psDimstyle",
            "technicalDefault": "Entekra Design",
            "businessMeaning": "Selects the CAD dimension style (text style, arrowheads, etc.) defined in the hsbCAD project to be used as a base for the script's graphics.",
            "validRange": "List of available DimStyles in project",
            "unit": "String",
            "affectsOutput": "Modifies the visual appearance of text and lines based on the selected CAD style definition."
          },
          {
            "name": "psDimFormat",
            "technicalDefault": "Inches Fractional",
            "businessMeaning": "Sets the unit system and format for the dimension text (e.g., Decimal mm, Fractional inches).",
            "validRange": "Decimal, Fractional, Inches Fractional",
            "unit": "Selection",
            "affectsOutput": "Controls the conversion of raw internal units to the displayed text string (e.g., converting 25.4mm to 1\")."
          },
          {
            "name": "piPrecision",
            "technicalDefault": "3",
            "businessMeaning": "Defines the accuracy of the dimension text by setting the number of decimal places or denominator size.",
            "validRange": "0 to 5",
            "unit": "Integer (Decimal Places)",
            "affectsOutput": "Rounds the calculated dimension value for display (e.g., 12.3456 becomes 12.346)."
          },
          {
            "name": "pdTextHeight",
            "technicalDefault": "0",
            "businessMeaning": "Manually overrides the height of the dimension text.",
            "validRange": "0.0 to 100.0 (0 uses Dimstyle default)",
            "unit": "Model Units (mm/inch)",
            "affectsOutput": "Scales the size of the generated text entities."
          },
          {
            "name": "pdTextPadding",
            "technicalDefault": "0.0625 inch",
            "businessMeaning": "Controls the spacing or 'padding' around the text to prevent overlap with dimension lines.",
            "validRange": "> 0",
            "unit": "Model Units (mm/inch)",
            "affectsOutput": "Adjusts the calculated spacing between dimension text and geometry."
          },
          {
            "name": "pdTextOffset",
            "technicalDefault": "0.3125",
            "businessMeaning": "The distance between the dimension line and the text label.",
            "validRange": "Any positive real number",
            "unit": "Model Units (mm/inch)",
            "affectsOutput": "Moves the text vertically/perpendicularly away from the dimension line."
          },
          {
            "name": "piLineColor",
            "technicalDefault": "1",
            "businessMeaning": "Sets the CAD color index for the dimension lines and extension lines.",
            "validRange": "0-255 (CAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the color of the generated lines."
          },
          {
            "name": "piTextColor",
            "technicalDefault": "5",
            "businessMeaning": "Sets the CAD color index for the dimension text.",
            "validRange": "0-255 (CAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the color of the generated text."
          },
          {
            "name": "psLimitExtensionLines",
            "technicalDefault": "No",
            "businessMeaning": "If 'Yes', trims the extension lines so they do not cross over the dimension text area.",
            "validRange": "Yes, No",
            "unit": "Selection",
            "affectsOutput": "Modifies the length and endpoint of extension line graphics."
          },
          {
            "name": "pdExtensionLineOffset",
            "technicalDefault": "0.0625",
            "businessMeaning": "The gap between the point being dimensioned and the start of the extension line.",
            "validRange": "Any positive real number",
            "unit": "Model Units (mm/inch)",
            "affectsOutput": "Creates a visual break between the model geometry and the dimension line."
          },
          {
            "name": "psViewDirection",
            "technicalDefault": "Outside",
            "businessMeaning": "Specifies which side of the element the dimensions are applied to (e.g., Interior face vs Exterior face of a wall).",
            "validRange": "Outside, Inside",
            "unit": "Selection",
            "affectsOutput": "Flips the projection plane for the dimensions to the opposite side of the element's local Z-axis."
          },
          {
            "name": "psTags",
            "technicalDefault": "",
            "businessMeaning": "Allows adding custom metadata tags to the script instance for filtering or scheduling in reports/BOM.",
            "validRange": "Space or comma separated string",
            "unit": "String",
            "affectsOutput": "Embeds data into the element's Hsb_Tag map; no graphical change."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "psDimFormat is set to 'Fractional' or 'Inches Fractional'",
            "effect": "Activates the conversion factor to translate Metric model units to Imperial for display.",
            "cascade": [
              "dConversionFactor"
            ]
          },
          {
            "trigger": "piPrecision changes",
            "effect": "Recalculates the rounding factor for dimension values.",
            "cascade": [
              "iPrecisionFactor"
            ]
          },
          {
            "trigger": "psDimType is set to 'Delta + Overall'",
            "effect": "Enables the calculation and drawing of a secondary total dimension span.",
            "cascade": [
              "bDoOverallDimension"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Annotation",
            "description": "Generates PLine entities for dimension lines, extension lines, and leaders, and Text entities for numerical values based on user-selected points.",
            "appliedTo": "Attached to the selected Element (Wall/Panel) in Model Space."
          }
        ]
      },
      "tokens_used": 8976,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script execution triggered.\",\n    \"Validate insertion cycle; erase instance if insertCycleCount > 1.\",\n    \"Retrieve attached Element via getElement().\",\n    \"Prompt user for Dimension Orientation (1: Horizontal, 2: Vertical, 3: Custom).\",\n    \"Enter loop: Prompt user to select points to dimension (PrPoint).\",\n    \"Exit loop when user finishes selection (presses Enter or Esc).\",\n    \"[Conditional] If Orientation is 'Custom': Prompt for Base Reference point and Direction point.\",\n    \"[Conditional] If Orientation is 'Standard': Calculate direction vector from Element local X/Y axes.\",\n    \"Prompt user for Dimline Location.\",\n    \"Validate collected points; erase instance if insufficient data (_PtG length < 3).\",\n    \"Store orientation state in Instance Map.\",\n    \"Project selected dimension points onto Element face plane.\",\n    \"Sort points along the calculated dimension line direction.\",\n    \"Cluster overlapping points to resolve text collisions.\",\n    \"Loop through clusters to draw graphics.\",\n    \"[Conditional] Draw Extension Lines based on 'Limit Extension Lines' property.\",\n    \"[Conditional] Draw Leaders if Dimension Type is 'Ordinate'.\",\n    \"Draw Text entities at calculated offsets.\",\n    \"[Conditional] Draw Overall Dimension if type is 'Delta + Overall'.\",\n    \"Apply Tags to instance.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"User selection for Dimension Orientation\",\n      \"path1\": {\n        \"name\": \"Custom Orientation (3)\",\n        \"steps\": [\n          \"Prompt for 'Select Dimline Base Reference' point (_PtG[0]).\",\n          \""
      },
      "tokens_used": 11098,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_DimElementManual\n\n## Overview\nThis script allows you to manually create construction dimensioning annotations on specific points of a timber element (such as a wall or panel) directly in the 3D model. It supports various dimension types including Delta, Ordinate, and Overall dimensions, with flexible formatting for Metric or Imperial units.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates directly on 3D Elements. |\n| Paper Space | No | Not designed for 2D layout views. |\n| Shop Drawing | No | Not intended for production drawings. |\n\n## Prerequisites\n- **Required Entities**: An existing Element (Wall or Panel) must be selected during script insertion.\n- **Minimum Beam Count**: 0 (This script annotates Elements, not individual beams).\n- **Required Settings**: None specific (uses standard CAD DimStyles available in the project).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_DimElementManual.mcr` from the list.\n\n### Step 2: Select Element\nClick on the Element (Wall/Panel) you wish to dimension.\n\n### Step 3: Choose Orientation\n```\nCommand Line: Dimension Orientation: [/1: Horizontal/2: Vertical/3: Custom]\nAction: Type 1, 2, or 3 and press Enter.\n```\n*   **1**: Aligns dimensions to the Element's local X-axis.\n*   **2**: Aligns dimensions to the Element's local Y-axis.\n*   **3**: Allows you to define a custom angle on screen.\n\n### Step 4: Select Dimension Points\n```\nCommand Line: Select points to dimension\nAction: Click on the model geometry to define points you want to measure.\n```\n*   Click as many points as needed.\n*   Press **Enter** or **Esc** to finish selecting points.\n\n### Step 5: Define Custom Direction (If Step 3 was Option 3)\n```\nCommand Line: Select Dimline Base Reference\nAction: Click a point to define the start of the dimension line axis.\n```\n```\nCommand Line: Select Dimline Direction\nAction: Click a second point to define the angle/direction of the dimension line.\n```\n\n### Step 6: Place Dimension Line\n```\nCommand Line: Select Dimline Location\nAction: Click in the 3D view where you want the dimension line and text to appear.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension Type | dropdown | Ordinate | Selects the logic: **Ordinate** (stacks from baseline), **Delta** (distance between points), or **Delta + Overall**. |\n| Dimstyle | dropdown | Entekra Design | Selects the CAD Dimension Style (text font, arrows) to use. |\n| Dim Format | dropdown | Inches Fractional | Sets the unit format (e.g., Decimal mm, Fractional inches). |\n| Precision | number | 3 | Sets the number of decimal places or denominator for fractions (0-5). |\n| Text Height | number | 0 | Overrides the text height. **0** uses the Dimstyle default. |\n| Text Padding | number | 0.0625 inch | Adds space around the text to prevent overlapping lines. |\n| Text Offset | number | 0.3125 | Distance between the dimension line and the text label. |\n| Line Color | number | 1 | CAD Color Index for dimension and extension lines. |\n| Text Color | number | 5 | CAD Color Index for the dimension text. |\n| Limit Extension Lines | dropdown | No | If **Yes**, extension lines are trimmed so they do not cross behind the text. |\n| Extension Line Offset | number | 0.0625 | The gap between the model point and the start of the extension line. |\n| View Direction | dropdown | Outside | Sets whether dimensions project to the **Outside** or **Inside** face of the element. |\n| Tags | text | | Custom tags for filtering or reports (does not affect graphics). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Refreshes the script geometry after changing Properties or moving the Element. |\n\n## Settings Files\n- **Filename**: N/A\n- **Location**: N/A\n- **Purpose**: This script relies on standard CAD DimStyles defined in your current project rather than a specific external XML file.\n\n## Tips\n- **Minimum Points**: You must select at least 3 points; otherwise, the script instance will delete itself automatically.\n- **Diagonal Dimensions**: Use orientation option **3 (Custom)** to dimension points that are not perfectly horizontal or vertical relative to the element.\n- **Text Clarity**: If dimension text overlaps, increase the **Text Padding** or switch **Limit Extension Lines** to \"Yes\".\n- **Incorrect Side**: If dimensions appear on the wrong side of the wall, change the **View Direction** property in the palette.\n\n## FAQ\n- **Q: Why did the dimension disappear after I placed it?**\n  **A:** The script requires at least 3 points to function. If you selected fewer than 3 points before pressing Enter, the script erases itself.\n\n- **Q: How do I change from Imperial to Metric units?**\n  **A:** Select the dimension instance, open the Properties palette, and change the **Dim Format** option (e.g., select \"Decimal\" for mm).\n\n- **Q: Can I use this on individual beams?**\n  **A:** No, this script is designed specifically to attach to Elements (Walls/Panels). Use beam-specific scripts for individual timber parts."
      },
      "tokens_used": 6073,
      "error": null
    }
  }
}