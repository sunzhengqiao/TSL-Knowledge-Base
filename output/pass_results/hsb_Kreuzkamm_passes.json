{
  "filename": "hsb_Kreuzkamm.mcr",
  "status": "completed",
  "total_tokens": 24544,
  "processing_time": 1292.1501924991608,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 6403,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getBeam() for input and addTool() with ParHouse to modify beam geometry. No sd_ prefix, _Viewport, or _Entity usage detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 3744,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "|Select first Beam|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getBeam",
              "promptOriginal": "|Select second Beam|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dGapDepth",
            "type": "PropDouble",
            "displayName": "|Gap in depth|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Tools|",
            "description": "|Defines the gap in depth of the connection|"
          },
          {
            "index": 1,
            "variable": "dGapWidth",
            "type": "PropDouble",
            "displayName": "|Gap in width|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Tools|",
            "description": "|Defines the gap at the side of the connection|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5201,
      "error": null
    },
    "4": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution begins (via catalog or execute key)",
          "Configuration dialog appears (allowing user to set 'Gap in depth' and 'Gap in width' before selection)",
          "User is prompted to select the first beam",
          "User is prompted to select the second beam",
          "Script validates that exactly 2 beams were selected",
          "Script calculates the intersection geometry of the two beam envelopes",
          "Script validates that the intersection profile results in exactly 4 vertices (a quadrilateral)",
          "Visual representation of the 'Kreuzkamm' connection is generated",
          "Cutting tools (ParHouse) are applied to both beams based on calculated vectors and gap properties"
        ],
        "conditionalBranches": [
          {
            "condition": "Beam Selection Validation",
            "path1": {
              "name": "Valid Input",
              "steps": [
                "_Beam.length() equals 2",
                "Proceed to geometry calculation"
              ]
            },
            "path2": {
              "name": "Invalid/Canceled Input",
              "steps": [
                "_Beam.length() does not equal 2",
                "eraseInstance() is called",
                "Script exits"
              ]
            }
          },
          {
            "condition": "Intersection Geometry Validation",
            "path1": {
              "name": "Quadrilateral Intersection",
              "steps": [
                "ptCons.length() equals 4",
                "Loop through beams to apply cuts"
              ]
            },
            "path2": {
              "name": "Invalid Geometry",
              "steps": [
                "ptCons.length() does not equal 4",
                "reportMessage shows '|invalid connection|'",
                "Script exits"
              ]
            }
          },
          {
            "condition": "Cutting Plane Orientation",
            "path1": {
              "name": "Normal Orientation Match",
              "steps": [
                "vecZCon.dotProduct() > 0",
                "X and Y vectors are swapped to ensure correct cut direction"
              ]
            },
            "path2": {
              "name": "Default Orientation",
              "steps": [
                "vecZCon.dotProduct() <= 0",
                "Standard vector calculation is used"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Entity Count",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script deletes itself; user must re-run and select exactly 2 beams."
          },
          {
            "check": "Intersection Profile Vertex Count",
            "errorMessage": "\\n|invalid connection|",
            "recovery": "User must check if beams actually intersect in a valid way (not just touching at corners or parallel) and re-insert."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Gap Dimensions",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Changing 'Gap in depth' or 'Gap in width' recalculates the position and size of the ParHouse cutting bodies, adjusting the connection clearance dynamically."
          }
        ]
      },
      "tokens_used": 5345,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_Kreuzkamm.mcr\n\n## Overview\nThis script creates a specialized connection (Cross Ridge) between two intersecting structural beams. It calculates the intersection volume and applies cuts to both beams, allowing for configurable gaps to ensure proper fitment or clearance.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in the 3D model. |\n| Paper Space | No | Not supported in 2D layouts. |\n| Shop Drawing | No | Not for shop drawing generation. |\n\n## Prerequisites\n- **Required Entities:** 2 Structural Beams (GenBeam).\n- **Minimum Beam Count:** 2\n- **Required Settings:** None specific to company standards.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_Kreuzkamm.mcr` from the catalog list.\n\n### Step 2: Select First Beam\n```\nCommand Line: Select first Beam\nAction: Click on the first beam you want to connect.\n```\n\n### Step 3: Select Second Beam\n```\nCommand Line: Select second Beam\nAction: Click on the second intersecting beam.\n```\n\n### Step 4: Automatic Processing\nOnce both beams are selected, the script automatically validates the geometry. If valid, it applies the cuts to create the connection.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Gap in depth | Number | 0 | Defines the gap distance along the depth (thickness) of the beam connection. |\n| Gap in width | Number | 0 | Defines the gap distance at the side of the connection. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific items to the context menu. |\n\n## Settings Files\n- **Filename**: N/A\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Valid Intersection:** The beams must intersect in a way that creates a quadrilateral (4-sided) profile. If the beams only touch at a corner or are skewed such that the intersection is triangular, the script will fail.\n- **Adjusting Gaps:** You can modify the gaps instantly after insertion. Select the script instance in the model, open the Properties Palette (Ctrl+1), and change the \"Gap in depth\" or \"Gap in width\" values. The cuts will update automatically.\n\n## FAQ\n- **Q: I received the error \"invalid connection\". What does this mean?**\n  **A:** This means the script could not calculate a valid 4-point intersection profile between the two beams. Ensure the beams are crossing clearly and are not parallel or just touching at an edge.\n- **Q: Can I use this on beams that do not touch?**\n  **A:** No, the beams must physically intersect in 3D space for the script to calculate the cut geometry."
      },
      "tokens_used": 3851,
      "error": null
    }
  }
}