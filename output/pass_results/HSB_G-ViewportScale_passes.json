{
  "filename": "HSB_G-ViewportScale.mcr",
  "status": "completed",
  "total_tokens": 27283,
  "processing_time": 470.76676416397095,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 1,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl shows the viewportscale",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "23.02.2006",
            "author": null,
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "06.09.2012",
            "author": null,
            "changes": "Add rotation and prefix"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4647,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses the _Viewport internal list, calls getViewport(), and instantiates a Viewport object to access properties like coordSys() and scale(). It is designed to annotate the scale of viewports found in layouts."
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout) where a viewport exists",
          "requiredSettings": []
        }
      },
      "tokens_used": 2266,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getViewport",
              "promptOriginal": "Select a viewport",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select position for scale",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeperator01",
            "type": "PropString",
            "displayName": "Style",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nPrecision",
            "type": "PropInt",
            "displayName": "Precision",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimension style",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sAlignment",
            "type": "PropString",
            "displayName": "Alignment",
            "defaultValue": "90",
            "inputType": "dropdown",
            "options": [
              "90",
              "0",
              "-90"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sPrefix",
            "type": "PropString",
            "displayName": "Prefix",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4107,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically annotates a drawing layout by labeling the specific scale of a selected viewport.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used during drawing detailing to explicitly mark the scale of views (e.g., details or elevations) on a drawing sheet for shop floor or construction reference."
        },
        "parameters": [
          {
            "name": "sSeperator01",
            "technicalDefault": "",
            "businessMeaning": "A visual group label or separator in the Properties palette to organize settings.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "None; purely for user interface organization."
          },
          {
            "name": "nPrecision",
            "technicalDefault": 1,
            "businessMeaning": "The number of decimal places displayed in the calculated scale ratio.",
            "validRange": "0 - 4",
            "unit": "Count (Integer)",
            "affectsOutput": "Adjusts the text output from '1:50' to '1:50.00', etc., based on the accuracy required for the annotation."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "The text style (defining font, height, and line properties) used for the scale annotation.",
            "validRange": "Any valid Dimension Style name defined in the current drawing",
            "unit": "String",
            "affectsOutput": "Controls the graphical appearance (font, size, aspect ratio) of the label."
          },
          {
            "name": "nColor",
            "technicalDefault": 1,
            "businessMeaning": "The display color of the scale label text.",
            "validRange": "0 - 255 (AutoCAD Color Index)",
            "unit": "ACI Number",
            "affectsOutput": "Changes the on-screen color and plot style of the text."
          },
          {
            "name": "sAlignment",
            "technicalDefault": "90",
            "businessMeaning": "The rotational orientation of the text label relative to the drawing sheet.",
            "validRange": "90, 0, -90",
            "unit": "Degrees",
            "affectsOutput": "Rotates the text to be vertical (90), horizontal (0), or inverted vertical (-90)."
          },
          {
            "name": "sPrefix",
            "technicalDefault": "",
            "businessMeaning": "Custom text added before the scale value (e.g., 'Scale ', 'View: ').",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Modifies the label string (e.g., changing '1:10' to 'Scale 1:10')."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing the selected Viewport entity",
            "effect": "Recalculates the numerical scale value based on the zoom level of the newly selected viewport.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Text",
            "description": "A single-line text entity placed at the selected coordinate in PaperSpace displaying the formatted scale.",
            "appliedTo": "PaperSpace (Layouts)"
          }
        ]
      },
      "tokens_used": 5054,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script execution starts.\",\n    \"2. System initializes Properties Palette with default values (Style, Precision, Dimension Style, Color, Alignment, Prefix).\",\n    \"3. [Insertion Phase] User selects a Viewport entity from the Paper Space layout.\",\n    \"4. [Insertion Phase] User selects a point in Paper Space to define the text insertion location.\",\n    \"5. [Calculation Phase] Script verifies if a Viewport is linked to the instance.\",\n    \"6. [Calculation Phase] Script retrieves the coordinate system and scale factor of the selected Viewport.\",\n    \"7. [Calculation Phase] Script formats the scale string based on the Precision and"
      },
      "tokens_used": 6648,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-ViewportScale.mcr\n\n## Overview\nThis script automatically annotates drawing layouts by placing a text label that displays the precise scale of a selected viewport (e.g., \"1:50\"). It is designed for use in Paper Space to clearly mark view scales on shop drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is intended for Layout tabs only. |\n| Paper Space | Yes | Used to annotate viewports on drawing sheets. |\n| Shop Drawing | Yes | Ideal for detailing views where scale indication is required. |\n\n## Prerequisites\n- **Required Entities:** A viewport must exist in the current Layout tab.\n- **Minimum beam count:** 0\n- **Required settings:** None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-ViewportScale.mcr`\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the border of the viewport you wish to label.\n```\n\n### Step 3: Place Label\n```\nCommand Line: Select position for scale\nAction: Click anywhere in the Paper Space layout where you want the scale text to appear.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Style | Text | | A visual separator label in the properties list (does not affect drawing output). |\n| Precision | Number | 1 | The number of decimal places to display for the scale (e.g., 1 displays \"1:50\", 2 displays \"1:50.00\"). |\n| Dimension style | Dropdown | _DimStyles | The text style (font, height) used for the scale annotation. Select from available dimension styles in the drawing. |\n| Color | Number | 1 | The color of the text (AutoCAD Color Index 1-255). |\n| Alignment | Dropdown | 90 | The rotation angle of the text. Options: `90` (Vertical), `0` (Horizontal), `-90` (Inverted Vertical). |\n| Prefix | Text | | Custom text added before the scale value (e.g., type \"SCALE \" to output \"SCALE 1:10\"). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external settings files.\n\n## Tips\n- **Text Orientation:** Use the **Alignment** property to rotate text so it reads correctly relative to your drawing borders or view.\n- **Text Appearance:** To change the font or height of the label, modify the selected **Dimension style** within AutoCAD's standard style manager, or select a different style in the properties panel.\n- **Custom Prefix:** Use the **Prefix** field to add context, such as \"DETAIL 1:10\" or \"SECTION 1:20\", by typing \"DETAIL \" before inserting the script.\n\n## FAQ\n- **Q: Can I use this script in Model Space?**\n  A: No, this script specifically requires a Viewport entity, which only exists in Paper Space (Layouts).\n- **Q: Why does my text appear too small or large?**\n  A: The text size is controlled by the **Dimension style** selected. Change the `sDimStyle` property to a style with the appropriate text height, or modify the text height in the Dimension Style Manager.\n- **Q: How do I display the scale as '1 : 5.0'?**\n  A: Set the **Precision** property to `1` (or higher) to show decimal places."
      },
      "tokens_used": 4561,
      "error": null
    }
  }
}