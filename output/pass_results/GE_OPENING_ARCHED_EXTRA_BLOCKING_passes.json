{
  "filename": "GE_OPENING_ARCHED_EXTRA_BLOCKING.mcr",
  "status": "completed",
  "total_tokens": 58922,
  "processing_time": 1199.7406027317047,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "03.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Stickframe path added to mapIn when calling dll"
          },
          {
            "version": "1.3",
            "date": "15.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail updated"
          },
          {
            "version": "1.2",
            "date": "14.aug.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added; Thumbnail added"
          },
          {
            "version": "1.1",
            "date": "13.aug.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Set type kSupportingCrossBeam to created beams; Module property of blocks set from opening module; Collecting beams of module does not depend anymore on header, any horizontal beam but plates will be taken in consideration; Information property of blocks will be filled only if user specifically defines it (manually)"
          },
          {
            "version": "1.0",
            "date": "12.mar.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 9506,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No 'sd_' or Multipage prefixes detected. No usage of '_Viewport'. The script interacts with 'Element', 'Wall', 'OpeningSF', 'GenBeam', and 'Sheet' entities directly in the 3D model. It uses methods like 'dbCreate', 'dbErase', and 'realBody' which are standard for ModelSpace manipulation."
        },
        "prerequisites": {
          "requiredEntities": [
            "OpeningSF",
            "Element (Wall)"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires a valid hsbCAD Wall containing a valid StickFrame Opening (OpeningSF). The script calculates blocking based on the geometry of the opening and the surrounding wall beams (header, jambs, sill).",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll"
          ]
        }
      },
      "tokens_used": 6435,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getOpening",
              "promptOriginal": "Select opening",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialogOnce",
            "trigger": "On insertion, if _kExecuteKey is empty",
            "title": null,
            "dataSource": "Default Property Palette",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sEmpty0",
            "type": "PropString",
            "displayName": "Blocking info",
            "defaultValue": " ",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sEmpty1",
            "type": "PropString",
            "displayName": "     Auto",
            "defaultValue": "     |Auto|",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sBmLumberItem",
            "type": "PropString",
            "displayName": "     Lumber item",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "Loaded dynamically from hsbFramingDefaults.Inventory.dll",
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sEmpty2",
            "type": "PropString",
            "displayName": "     Manual",
            "defaultValue": "|If no value is set, values are taken from inventory|",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sBlockSizeOPM",
            "type": "PropString",
            "displayName": "     Beam size",
            "defaultValue": "|From inventory|",
            "inputType": "dropdown",
            "options": [
              "2x1",
              "2x2",
              "2x3",
              "2x4",
              "2x6",
              "2x8",
              "2x10",
              "2x12",
              "2x14",
              "2x16",
              "|From inventory|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nBlockColorOPM",
            "type": "PropInt",
            "displayName": "     Beam color",
            "defaultValue": 2,
            "inputType": "number",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sBlockNameOPM",
            "type": "PropString",
            "displayName": "     Name",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sBlockMaterialOPM",
            "type": "PropString",
            "displayName": "     Material",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sBlockGradeOPM",
            "type": "PropString",
            "displayName": "     Grade",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "sBlockInformationOPM",
            "type": "PropString",
            "displayName": "     Information",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 9,
            "variable": "sBlockLabelOPM",
            "type": "PropString",
            "displayName": "     Label",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 10,
            "variable": "sBlockSubLabelOPM",
            "type": "PropString",
            "displayName": "     Sublabel",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 11,
            "variable": "sBlockSubLabel2OPM",
            "type": "PropString",
            "displayName": "     Sublabel2",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 12,
            "variable": "sBlockBeamCodeOPM",
            "type": "PropString",
            "displayName": "     Beam code",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 14,
            "variable": "sRout",
            "type": "PropString",
            "displayName": "Rout opening",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 15,
            "variable": "sSquareCut",
            "type": "PropString",
            "displayName": "Square cut sheathing only",
            "defaultValue": "|No|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "hsbFramingDefaults.Inventory.dll",
            "searchPaths": [
              "_kPathHsbInstall\\Utilities\\hsbFramingDefaultsEditor\\"
            ],
            "purpose": "Provides a list of Lumber Items (Material/Grade/Size defaults) to populate the Lumber Item dropdown.",
            "required": true
          }
        ]
      },
      "tokens_used": 9622,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates extra blocking beams at the corners of an arched or angled stick frame opening to provide nailing surface and structural support between the jambs/header/sill and the arched curve.",
          "category": "Framing",
          "typicalUseCase": "Used when an arched window or door opening requires additional framing members (blocking) in the curved areas above or below the arch to ensure proper attachment of sheathing or cladding and structural integrity."
        },
        "parameters": [
          {
            "name": "sBmLumberItem",
            "technicalDefault": "",
            "businessMeaning": "Selects a predefined lumber profile from the project inventory to define the material, grade, and size of the blocking beams automatically.",
            "validRange": "Any valid Lumber Item key available in the hsbFramingDefaults Inventory",
            "unit": "String (Inventory Key)",
            "affectsOutput": "Sets the Width (dBlockW), Height (dBlockH), Material, and Grade of the blocking beams if 'From inventory' is selected for Beam Size."
          },
          {
            "name": "sBlockSizeOPM",
            "technicalDefault": "|From inventory|",
            "businessMeaning": "Defines the nominal height (depth) of the blocking beam. The width is fixed at 2 inches (38.1mm) for the manual presets.",
            "validRange": "2x1, 2x2, 2x3, 2x4, 2x6, 2x8, 2x10, 2x12, 2x14, 2x16, |From inventory|",
            "unit": "Nominal Lumber Size (inches)",
            "affectsOutput": "Determines the height (dBlockH) of the generated blocking beams. If set to '|From inventory|', it relies on the dimensions provided by 'sBmLumberItem'."
          },
          {
            "name": "nBlockColorOPM",
            "technicalDefault": "2",
            "businessMeaning": "Sets the display color of the generated blocking beams in the CAD model for visual distinction.",
            "validRange": "0 to 255 (Standard AutoCAD Color Index)",
            "unit": "Color Index",
            "affectsOutput": "Visual representation of the beams in ModelSpace."
          },
          {
            "name": "sBlockNameOPM",
            "technicalDefault": "",
            "businessMeaning": "Assigns a specific name to the blocking beams, used for identification in lists and schedules.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'Name' property of the GenBeam entities."
          },
          {
            "name": "sBlockMaterialOPM",
            "technicalDefault": "",
            "businessMeaning": "Overrides the wood material type for the blocking beams.",
            "validRange": "Any text string (e.g., 'SPF', 'Doug Fir')",
            "unit": "String",
            "affectsOutput": "Sets the 'Material' property of the GenBeam entities. Overrides the inventory value if provided."
          },
          {
            "name": "sBlockGradeOPM",
            "technicalDefault": "",
            "businessMeaning": "Overrides the structural grade of the lumber used for the blocking.",
            "validRange": "Any text string (e.g., 'SS', 'No. 2')",
            "unit": "String",
            "affectsOutput": "Sets the 'Grade' property of the GenBeam entities. Overrides the inventory value if provided."
          },
          {
            "name": "sBlockInformationOPM",
            "technicalDefault": "",
            "businessMeaning": "Stores additional metadata or instructions associated with the blocking beams.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'Information' property of the GenBeam entities."
          },
          {
            "name": "sBlockLabelOPM",
            "technicalDefault": "",
            "businessMeaning": "Assigns a primary label for tagging or scheduling the blocking pieces.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'Label' property of the GenBeam entities."
          },
          {
            "name": "sBlockSubLabelOPM",
            "technicalDefault": "",
            "businessMeaning": "Assigns a secondary label for further categorization.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'SubLabel' property of the GenBeam entities."
          },
          {
            "name": "sBlockSubLabel2OPM",
            "technicalDefault": "",
            "businessMeaning": "Assigns a tertiary label for detailed categorization.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'SubLabel2' property of the GenBeam entities."
          },
          {
            "name": "sBlockBeamCodeOPM",
            "technicalDefault": "",
            "businessMeaning": "Specifies a production or shop code for the blocking beams.",
            "validRange": "Any text string",
            "unit": "String",
            "affectsOutput": "Sets the 'BeamCode' property of the GenBeam entities."
          },
          {
            "name": "sRout",
            "technicalDefault": "|Yes|",
            "businessMeaning": "Determines whether the wall sheathing (sheeting) should be cut or routed around the generated blocking and the arched opening shape.",
            "validRange": "|No|, |Yes|",
            "unit": "Boolean",
            "affectsOutput": "If Yes, splits and deletes wall sheets that intersect the opening/blocking volume. If No, the sheathing is left untouched or treated with square cuts only depending on other wall settings."
          },
          {
            "name": "sSquareCut",
            "technicalDefault": "|No|",
            "businessMeaning": "Controls if the sheathing cutout for the opening should be a simple square cutout rather than following the arched profile exactly (specifically regarding how the script handles the opening boundary). Note: In this specific script context, it appears to influence the `setOpeningOverwrite` logic, often used to simplify sheet cuts.",
            "validRange": "|No|, |Yes|",
            "unit": "Boolean",
            "affectsOutput": "Modifies the opening overwrite settings on the wall element, potentially forcing square sheathing cuts instead of complex arched contours in the wall generation process."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sBmLumberItem is set",
            "effect": "Populates Material, Grade, Width, and Height defaults for the blocking.",
            "cascade": [
              "sBlockMaterialOPM",
              "sBlockGradeOPM",
              "sBlockSizeOPM"
            ]
          },
          {
            "trigger": "sBlockSizeOPM is set to '|From inventory|'",
            "effect": "Dimensions are taken from the selected sBmLumberItem. Manual size fields (width/height) are ignored.",
            "cascade": [
              "sBmLumberItem"
            ]
          },
          {
            "trigger": "sBlockSizeOPM is set to a specific nominal size (e.g., '2x4')",
            "effect": "Uses the predefined manual dimensions for that size. Inventory dimensions are ignored. Width is fixed at 38.1mm (1.5\").",
            "cascade": [
              "dBlockH"
            ]
          },
          {
            "trigger": "sBlockMaterialOPM or sBlockGradeOPM are manually set",
            "effect": "Overrides the values derived from sBmLumberItem.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Supporting cross beams (blocking) placed in the corners of the arched opening (Top-Left, Top-Right, Bottom-Left, Bottom-Right) if there is sufficient geometric gap between the straight frame members (header/sill/jambs) and the arched curve.",
            "appliedTo": "The Wall Element containing the selected Opening."
          },
          {
            "type": "Sheet (Machining)",
            "description": "Routing/cutting of wall sheathing to accommodate the arched opening and the new blocking.",
            "appliedTo": "Sheets associated with the parent Wall Element."
          }
        ]
      },
      "tokens_used": 11417,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Launch Script",
          "[Initialization] Call .NET Inventory DLL to retrieve Lumber Items",
          "[Initialization] Populate property arrays (Materials, Grades, Sizes)",
          "User executes command (e.g., Insert)",
          "Check 'insertCycleCount()'. If > 1, erase instance and exit (prevent duplicate execution)",
          "Prompt user to 'Select opening' (getOpening)",
          "Validate selection: Is an OpeningSF object selected?",
          "[NO valid opening] Report error, erase instance, exit",
          "[Valid opening] Check '_kExecuteKey'. If empty, show Properties Palette (ShowDialogOnce)",
          "Set internal Map flags (ExecutionMode=0, Reframe=1)",
          "Save properties to catalog (_LastInserted)",
          "Wait for System Recalculation or Wall Update event",
          "[Execution] Retrieve OpeningSF and Parent Element (Wall)",
          "Validate Wall exists. If invalid, erase instance",
          "Determine Block Dimensions (Width/Height/Material/Grade)",
          "[Conditional] Source selection: 'Lumber Item' (Inventory) OR Manual 'Beam Size'",
          "[Inventory Lookup] Retrieve dimensions from Inventory DLL based on Key",
          "[Manual Selection] Map '2xN' string to hardcoded dimensions",
          "Validation: Are Width/Height valid (>0)?",
          "[Invalid Dimensions] Report error, erase instance, exit",
          "Report message advising user to re-frame wall",
          "Set Dependencies on Wall Element",
          "Configure Opening Overwrite for Sheeting (Rout/SquareCut settings)",
          "Analyze Wall Framing: Identify Horizontal Beams (Top/Bottom) and Vertical Beams (Left/Right) in the Module",
          "Calculate Opening Geometry (TopLeft, TopRight, BottomLeft, BottomRight corners)",
          "Calculate Tangents on the Opening curve at corner points",
          "Calculate Gap between Straight Frame and Arch Curve at corners",
          "[Condition] Is Gap > Block Height + Tolerance?",
          "[YES Gap] Mark corner for Blocking (FrameTopLeft, etc.)",
          "[NO Gap] Skip corner (no blocking needed)",
          "[Condition] Is Wall Framed? (bmAll.length() > 0)",
          "[Unframed Wall] Draw opening preview only, exit",
          "[Framed Wall] Clean up: Erase existing angled blocking beams in module",
          "Generate Blocking Beams for marked corners",
          "Position Beam: Start at Tangent point, align perpendicular to Arch, extend to Jambs/Header/Sill",
          "Apply Properties (Color, Name, Material, Grade, Label, etc.) to new Beams",
          "Assign Beams to Wall Element",
          "[Condition] Is 'Rout opening' = Yes?",
          "[YES Rout] Perform Sheeting operations",
          "Split Sheets intersecting the Opening/Cutout plane",
          "Identify and Delete Sheet segments inside the Opening volume",
          "Update ExecutionMode to 1",
          "Draw Preview (Opening Cutout)"
        ],
        "conditionalBranches": [
          {
            "condition": "Source of Blocking Dimensions",
            "path1": {
              "name": "Inventory Mode",
              "steps": [
                "Check if sBmLumberItem is set (Index != -1)",
                "Look up dimensions (Width/Height) in Inventory map using selected Key",
                "Apply Inventory Material and Grade",
                "Override with Manual Material/Grade properties if present"
              ]
            },
            "path2": {
              "name": "Manual Mode",
              "steps": [
                "Check if sBlockSizeOPM is NOT '|From inventory|'",
                "Use hardcoded Width (38.1mm / 1.5\")",
                "Map selected Index (1,2,3...) to Height array (19.05, 38.1, 63.5...)",
                "Use Manual Material/Grade properties (empty if not set)"
              ]
            }
          },
          {
            "condition": "Gap Detection at Corners (Need for Blocking)",
            "path1": {
              "name": "Gap Sufficient",
              "steps": [
                "Calculate distance between Corner Point and Arch Tangent Point",
                "Compare distance to Block Height + Tolerance",
                "If Distance > Height: Create Beam at this corner"
              ]
            },
            "path2": {
              "name": "Gap Insufficient",
              "steps": [
                "If Distance <= Height: Skip beam creation at this corner",
                "Arch fits tight to framing or insufficient space for block"
              ]
            }
          },
          {
            "condition": "Sheathing Routing Logic",
            "path1": {
              "name": "Route Opening (Yes)",
              "steps": [
                "Retrieve all sheets from wall",
                "Split sheets using the Opening Cutout plane",
                "Check intersection between sheet bodies and Opening Erase Volume",
                "Delete sheet segments inside the opening"
              ]
            },
            "path2": {
              "name": "Do Not Route (No)",
              "steps": [
                "Skip sheet modification logic",
                "Only set Opening Overwrite property on element (Square cut logic depends on this)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Opening Selection",
            "errorMessage": "Not valid opening provided / Not valid SF opening provided",
            "recovery": "User must select a valid StickFrame Opening (OpeningSF) and rerun."
          },
          {
            "check": "Inventory vs Manual Size Conflict",
            "errorMessage": "Data incomplete: There is no size set for blocking. Tsl will be erased",
            "recovery": "User must select a Lumber Item from the Auto section OR select a specific Beam Size from the Manual section."
          },
          {
            "check": "Dimension Validity",
            "errorMessage": "Data incomplete, check values on inventory for selected lumber item (Width/Height = 0)",
            "recovery": "Verify the selected Lumber Item has valid dimensions defined in the inventory, or select a valid manual size."
          },
          {
            "check": "Wall Validity",
            "errorMessage": "Implicit check via script exit",
            "recovery": "Ensure the selected opening belongs to a valid Wall Element."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Blocking Dimensions/Material",
            "how": "Properties Palette (OPM) - Change 'Lumber item' or 'Beam size' / 'Material' / 'Grade'",
            "effect": "Script recalculates (on _bOnRecalc or wall reframe). Existing blocking beams are updated or recreated with new dimensions and properties."
          },
          {
            "action": "Toggle Sheathing Routing",
            "how": "Properties Palette - Change 'Rout opening' to |Yes| or |No|",
            "effect": "If set to Yes, script splits and cuts wall sheets around the arch on next calculation. If No, sheets are left intact (except for standard wall opening logic)."
          },
          {
            "action": "Toggle Square Cut Sheathing",
            "how": "Properties Palette - Change 'Square cut sheathing only'",
            "effect": "Updates the Opening Overwrite setting on the parent Wall Element (Indices -5 to 5 excluding 0), potentially changing how the wall generation tool handles the cutout for this opening (simplified square vs complex arch)."
          },
          {
            "action": "Modify Opening Geometry",
            "how": "Grip edit the Arch Opening or move it in the wall",
            "effect": "Script dependency triggers. It recalculates corner tangents and gaps. If the arch moves such that a gap opens/closes, blocking beams are automatically added or removed to match."
          },
          {
            "action": "Re-frame Wall",
            "how": "hsbCAD Wall commands (e.g., Update/Reframe)",
            "effect": "Clears 'ExecutionMode' flag temporarily, forces full re-evaluation of beam connections and positions."
          }
        ]
      },
      "tokens_used": 12936,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_OPENING_ARCHED_EXTRA_BLOCKING.mcr\n\n## Overview\nThis script generates extra blocking beams (cripples) at the corners of arched or angled stick frame openings. It automatically calculates the gap between the straight frame members (header/sill/jambs) and the arch curve to create structural supports and nailing surfaces for sheathing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script interacts directly with Wall Elements and Stick Frame Openings in the 3D model. |\n| Paper Space | No | Not designed for use in layouts. |\n| Shop Drawing | No | This is a modeling script, not a detailing tool. |\n\n## Prerequisites\n- **Required Entities**: A valid hsbCAD Wall (Element) containing a valid Stick Frame Opening (OpeningSF).\n- **Minimum Beam Count**: 0 (The script analyzes existing framing but does not require pre-selected beams).\n- **Required Settings Files**: `hsbFramingDefaults.Inventory.dll` (Used to populate the \"Lumber item\" dropdown with project-specific sizes and materials).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_OPENING_ARCHED_EXTRA_BLOCKING.mcr` from the list.\n\n### Step 2: Select Opening\n```\nCommand Line: Select opening\nAction: Click on the arched or angled stick frame opening within a wall.\n```\n\n### Step 3: Configure Properties\n```\nAction: The Properties Palette (OPM) will appear automatically upon the first insertion.\nSelect a \"Lumber item\" from the Auto section or define a manual \"Beam size\".\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Auto** | | | |\n| Lumber item | dropdown | (Empty) | Select a predefined profile from the project inventory. This automatically sets the size, material, and grade. |\n| **Manual** | | | |\n| Beam size | dropdown | \\|From inventory\\| | Select a specific nominal size (e.g., 2x4, 2x6). Width is fixed at 38.1mm (1.5\"). Select \"\\|From inventory\\|\" to use the Lumber item size. |\n| Material | text | (Empty) | Overrides the wood material type (e.g., SPF, Douglas Fir). |\n| Grade | text | (Empty) | Overrides the structural grade (e.g., SS, No. 2). |\n| Beam color | number | 2 | Sets the AutoCAD color index for the generated blocking beams. |\n| Name | text | (Empty) | Assigns a name to the beams for identification in schedules. |\n| Information | text | (Empty) | Adds specific metadata or instructions to the beam properties. |\n| Label | text | (Empty) | Sets the primary label for tagging. |\n| Sublabel | text | (Empty) | Sets a secondary label for categorization. |\n| Sublabel2 | text | (Empty) | Sets a tertiary label for detailed categorization. |\n| Beam code | text | (Empty) | Assigns a production or shop code. |\n| **Opening Settings** | | | |\n| Rout opening | dropdown | \\|Yes\\| | If \"Yes\", the script splits and cuts wall sheathing around the arch and blocking. If \"No\", sheathing is not modified by this script. |\n| Square cut sheathing only | dropdown | \\|No\\| | If \"Yes\", simplifies the sheathing cutout to a square shape rather than following the complex arched profile. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalc | Updates the blocking geometry if the opening size or wall frame changes. |\n| Erase | Removes the script instance and the generated blocking beams. |\n\n## Settings Files\n- **Filename**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: `_kPathHsbInstall\\Utilities\\hsbFramingDefaultsEditor\\`\n- **Purpose**: Provides the list of available Lumber Items, Material types, and Grades for the \"Auto\" property section.\n\n## Tips\n- **Gap Detection**: The script only generates blocking if the gap between the straight frame (jamb/header) and the arch curve is larger than the height of the blocking beam. If you don't see blocking at a corner, the arch is likely too tight to the frame.\n- **Sheathing Updates**: If you modify the opening geometry (e.g., make the arch taller), ensure the script is set to \"Rout opening: Yes\" so the wall sheets are updated to match the new shape.\n- **Inventory Priority**: If \"Lumber item\" is selected, it overrides the manual \"Beam size\". To use manual sizes, ensure \"Beam size\" is set to a specific dimension (e.g., 2x6) and not \"\\|From inventory\\|\".\n\n## FAQ\n- **Q: Why did my blocking disappear after I changed the opening shape?**\n  A: The script recalculates the geometry automatically. If the arch was moved closer to the jambs or header, the gap may now be too small to fit the selected blocking beam size. Try reducing the beam height or moving the arch.\n- **Q: How do I change the material of just the blocking without changing the rest of the wall?**\n  A: Select the script instance, open the Properties Palette, and manually enter the desired Material and Grade in the \"Manual\" section. This overrides the inventory settings for these specific beams.\n- **Q: The wall sheathing is not being cut around the arch.**\n  A: Check the \"Rout opening\" property in the script and ensure it is set to \\|Yes\\|. If it is already Yes, try running a \"Reframe\" on the wall to force a full update."
      },
      "tokens_used": 9006,
      "error": null
    }
  }
}