{
  "filename": "GE_WALL_POINTLOAD.mcr",
  "status": "completed",
  "total_tokens": 54597,
  "processing_time": 405.2997455596924,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.13",
            "date": "03.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Stickframe path added to mapIn when calling dll"
          },
          {
            "version": "v1.12",
            "date": "26.mar.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Beam width, height, grade and material set from defaults editor\n- Added color restriction for new beams"
          },
          {
            "version": "v1.11",
            "date": "05.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added"
          },
          {
            "version": "v1.10",
            "date": "23.jan.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Problem of splitted top plates solved"
          },
          {
            "version": "v1.9",
            "date": "19.jan.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Set created studs properties from any adjacent stud that is not part of an assembly"
          },
          {
            "version": "v1.8",
            "date": "March 22 2011",
            "author": "_RL",
            "changes": "Will stay within wall"
          },
          {
            "version": "v1.7",
            "date": "",
            "author": "",
            "changes": "Bug Fix on element construction"
          },
          {
            "version": "v1.6",
            "date": "",
            "author": "",
            "changes": "Adapted for plate with Id 31"
          },
          {
            "version": "v1.5",
            "date": "",
            "author": "No author, asume Randy",
            "changes": "Redesigned with faster easier functionality"
          },
          {
            "version": "v1.4",
            "date": "",
            "author": "No author, asume Randy",
            "changes": "Will display Red if on opening"
          },
          {
            "version": "v1.3",
            "date": "",
            "author": "No author, asume Randy",
            "changes": "Insert has changed"
          },
          {
            "version": "v1.2",
            "date": "",
            "author": "No author, asume Randy",
            "changes": "Should not recalc on DWG in."
          },
          {
            "version": "v1.1",
            "date": "",
            "author": "No author, asume Randy",
            "changes": "Added a check for top and bottom plates"
          },
          {
            "version": "v1.0",
            "date": "",
            "author": "No author, asume Randy",
            "changes": ""
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 9399,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates on ElementWall entities and uses Beam.dbCreate() to generate physical construction elements (studs) in the 3D model. It performs 3D geometric calculations using Vector3d and Body intersections. There are no calls to Viewport, sd_ prefixes, or 2D drawing generation functions typical of ShopDrawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing a Wall element.",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll",
            "Lumber items defined in hsbFramingDefaults configuration"
          ]
        }
      },
      "tokens_used": 8206,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of Walls",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "\nSelect an insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "showDialogOnce() called during _bOnInsert",
            "title": null,
            "dataSource": "Properties (pBm, nColor, pDis, sBmLumberItem, pDisplay, pTextOff)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "ShowNotice",
            "trigger": "Incomplete lumber item data",
            "title": null,
            "dataSource": "Lumber item details",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "ShowNotice",
            "trigger": "No plates found in wall",
            "title": null,
            "dataSource": null,
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "pBm",
            "type": "PropInt",
            "displayName": "Number of Beams in Point Load",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color for new Beams",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "pDis",
            "type": "PropString",
            "displayName": "What display to use",
            "defaultValue": "Mark Location with an X",
            "inputType": "dropdown",
            "options": [
              "Identify with Text",
              "Mark Location with an X"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "pDisplay",
            "type": "PropString",
            "displayName": "DimStyle",
            "defaultValue": "-1",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "pTextOff",
            "type": "PropDouble",
            "displayName": "Offset text from wall",
            "defaultValue": "U(7)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sBmLumberItem",
            "type": "PropString",
            "displayName": "Lumber item",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "sLumberItemNames"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Re-Create Point Load",
            "handler": "strRedo",
            "action": "Recalculates and regenerates the studs for the point load",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "hsbFramingDefaults.Inventory.dll",
            "searchPaths": [
              "_kPathHsbInstall\\Utilities\\hsbFramingDefaultsEditor"
            ],
            "purpose": "Provides list of lumber items (names, dimensions, material, grade)",
            "required": true
          }
        ]
      },
      "tokens_used": 8882,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates a reinforcing stud pack (point load) at a specific location on a wall to support vertical loads, such as from a beam or header landing.",
          "category": "Framing",
          "typicalUseCase": "Used when a structural point load occurs over a wall, requiring additional studs (cripple studs/packers) to transfer the load down to the plates or foundation."
        },
        "parameters": [
          {
            "name": "pBm",
            "technicalDefault": "0",
            "businessMeaning": "Specifies the number of reinforcing studs (beams) to generate in the point load pack.",
            "validRange": "1 to 6",
            "unit": "Count",
            "affectsOutput": "Determines the quantity of Beam entities created (Studs) and the total width of the reinforcing zone."
          },
          {
            "name": "nColor",
            "technicalDefault": "1",
            "businessMeaning": "Sets the AutoCAD color index for the newly generated studs to distinguish them from standard framing.",
            "validRange": "0 to 255 (or -1 for ByLayer)",
            "unit": "Color Index",
            "affectsOutput": "Visual appearance of the generated studs in the CAD model and drawings."
          },
          {
            "name": "pDis",
            "technicalDefault": "\"Mark Location with an X\"",
            "businessMeaning": "Controls the visual representation of the point load location on the wall if studs are not yet created or for annotation.",
            "validRange": "\"Identify with Text\", \"Mark Location with an X\"",
            "unit": "Enum",
            "affectsOutput": "If 'Identify with Text', draws the quantity (e.g., '3x') at the location. If 'Mark Location with an X', draws an X shape over the area."
          },
          {
            "name": "pDisplay",
            "technicalDefault": "\"-1\"",
            "businessMeaning": "Selects the dimension style to be used for text annotations.",
            "validRange": "List of available DimStyles in the drawing",
            "unit": "String (Style Name)",
            "affectsOutput": "Text height, style, and font properties of the annotation text (if pDis is set to 'Identify with Text')."
          },
          {
            "name": "pTextOff",
            "technicalDefault": "U(7)",
            "businessMeaning": "Sets the distance from the wall face to the annotation text label.",
            "validRange": "0.0 to 1000.0 (depending on units)",
            "unit": "Length (model units)",
            "affectsOutput": "Position of the text label relative to the wall geometry."
          },
          {
            "name": "sBmLumberItem",
            "technicalDefault": "null",
            "businessMeaning": "Selects the specific lumber grade and size (e.g., 2x4 SPF) for the reinforcing studs from the hsbFramingDefaults inventory.",
            "validRange": "List of Lumber Items defined in hsbFramingDefaults",
            "unit": "String",
            "affectsOutput": "Width, Height, Material, and Grade properties of the generated studs."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sBmLumberItem selection",
            "effect": "Defines the physical dimensions (Width/Height) and material properties of the generated studs.",
            "cascade": [
              "Beam Width",
              "Beam Height",
              "Material",
              "Grade"
            ]
          },
          {
            "trigger": "pBm (Count)",
            "effect": "Calculates the total width of the point load zone to check for conflicts with openings.",
            "cascade": [
              "Collision Detection with Openings"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam (Stud)",
            "description": "Reinforcing vertical studs placed at the specified point load location.",
            "appliedTo": "The selected ElementWall. These studs stretch dynamically to touch the top and bottom plates."
          },
          {
            "type": "Graphic Annotation",
            "description": "Text ('Nx') or an 'X' marker indicating the location and quantity of the point load.",
            "appliedTo": "The screen/ModelSpace display relative to the wall insertion point."
          }
        ]
      },
      "tokens_used": 9415,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Initialization: Load hsbFramingDefaults.Inventory.dll to populate Lumber Item lists.",
          "Insert Mode - Step 1: Prompt user to select Wall elements (PrEntity).",
          "Insert Mode - Step 2: Prompt user for insertion point location (getPoint).",
          "Insert Mode - Step 3: Show properties dialog (showDialogOnce).",
          "Insert Mode - Step 4: Clone the script instance onto the selected wall elements using the insertion point and properties.",
          "Insert Mode - Step 5: Erase the original temporary script instance.",
          "Calculation Mode - Setup: Retrieve the attached ElementWall and define coordinate vectors.",
          "Calculation Mode - Validation: Check if wall contains sufficient structural beams (studs/plates). If not, set display-only flag.",
          "Calculation Mode - Constraints: Clamp insertion point to wall boundaries (project to wall axis) and check proximity to wall ends.",
          "Calculation Mode - Visual Feedback: Display 'X' or Text (Nx) annotation based on pDis property.",
          "Calculation Mode - Safety Check: Verify Point Load location does not intersect with Headers/Openings.",
          "Calculation Mode - Intersection: Find existing beams that intersect the proposed Point Load volume.",
          "Calculation Mode - Conflict Resolution: Cut or shift intersecting standard studs to make space for the Point Load studs.",
          "Calculation Mode - Generation: Retrieve lumber dimensions/material from Inventory and create new Stud beams.",
          "Calculation Mode - Integration: Stretch new studs dynamically to connect to Top and Bottom plates.",
          "Calculation Mode - Storage: Store new stud handles in _Map for tracking in subsequent recalculations."
        ],
        "conditionalBranches": [
          {
            "condition": "Structural Beam Count Check (arBmAll.length())",
            "path1": {
              "name": "Display Only (No Studs Created)",
              "steps": [
                "Check if wall has structural beams (excluding panhands).",
                "If count is insufficient, set bDoDisplayOnly = TRUE.",
                "Draw a visual representation (rectangles/X) of where studs would be.",
                "Return immediately without creating geometry."
              ]
            },
            "path2": {
              "name": "Full Generation",
              "steps": [
                "Identify plates and headers within the wall.",
                "Perform geometric checks and intersection logic.",
                "Generate physical stud beams.",
                "Stretch studs to plates."
              ]
            }
          },
          {
            "condition": "Intersection with Openings/Headers",
            "path1": {
              "name": "Invalid Location (Overlap)",
              "steps": [
                "Detect if Point Load zone overlaps with a Header.",
                "Report warning: 'Too close to opening'.",
                "Draw the representation in Red (color index 1).",
                "Abort creation."
              ]
            },
            "path2": {
              "name": "Valid Location",
              "steps": [
                "Proceed to check intersections with standard studs.",
                "Handle stud cutting/shifting."
              ]
            }
          },
          {
            "condition": "Existing Stud Intersection",
            "path1": {
              "name": "Shift Existing Stud",
              "steps": [
                "If intersected stud is near the edge of the Point Load zone (< 3.75 inch).",
                "Move the existing stud outward to make space.",
                "Do not create a new stud in that specific slot."
              ]
            },
            "path2": {
              "name": "Cut Existing Stud",
              "steps": [
                "If intersected stud is deep within the Point Load zone.",
                "Cut the stud into two pieces (Left and Right of the zone).",
                "Remove the middle section effectively.",
                "Proceed to create new Point Load stud."
              ]
            }
          },
          {
            "condition": "Display Mode (pDis property)",
            "path1": {
              "name": "Text Annotation",
              "steps": [
                "Draw text string (e.g., '3x') at the calculated offset location.",
                "Update _Pt0 to text location."
              ]
            },
            "path2": {
              "name": "X Marker",
              "steps": [
                "Draw crossing lines (pl1, pl2) over the point load zone.",
                "Update _Pt0 to insertion base point."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Plate Availability",
            "errorMessage": "\nNo Plates found",
            "recovery": "Script aborts. User must ensure wall has Top/Bottom plates assigned.",
            "effect": "No geometry generated."
          },
          {
            "check": "Proximity to Header/Openings",
            "errorMessage": "Warning: 'Too close to opening. Cannot position PointLoad on Opening on wall [Number]'",
            "recovery": "User must move the script grip (insertion point) away from the opening/header.",
            "effect": "Visuals turn Red, studs not created."
          },
          {
            "check": "Lumber Item Data Integrity",
            "errorMessage": "Notice: 'Data incomplete, check values for selected lumber item' + Width/Height/Material/Grade details.",
            "recovery": "User must select a valid Lumber Item in the OPM properties that has complete dimension data in the hsbFramingDefaults configuration.",
            "effect": "Script instance erased."
          },
          {
            "check": "Wall Boundary Constraint",
            "errorMessage": "None (Silent)",
            "recovery": "Script automatically projects the insertion point to lie within the valid wall segment (excluding end margins).",
            "effect": "Insertion point snaps to wall axis."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Re-Create Point Load",
            "how": "Context Menu (Right-click)",
            "effect": "Forces a full recalculation. Deletes existing studs associated with this instance, re-evaluates intersections, and regenerates beams based on current properties."
          },
          {
            "action": "Change Lumber Item",
            "how": "OPM Property (sBmLumberItem)",
            "effect": "Updates dimensions (Width/Height), Material, and Grade of the generated studs upon next recalculation."
          },
          {
            "action": "Change Stud Count (pBm)",
            "how": "OPM Property",
            "effect": "Changes the number of studs (1-6) and the total width of the reinforcement zone. Trigger re-calculation to adjust intersections."
          },
          {
            "action": "Move Insertion Point",
            "how": "Grip Edit (_Pt0)",
            "effect": "Moves the entire Point Load assembly along the wall. The script re-runs to check for new intersections with openings or existing studs at the new location."
          },
          {
            "action": "Modify Annotation Settings",
            "how": "OPM Properties (pDis, pDisplay, pTextOff, nColor)",
            "effect": "Updates the visual marker (Text vs X), Dimension style, Offset distance, or Beam color immediately."
          }
        ]
      },
      "tokens_used": 11502,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_POINTLOAD.mcr\n\n## Overview\nAutomatically generates a reinforcing stud pack (point load) at a specific location on a wall to support vertical loads, such as from a beam or header landing. It handles collision detection by cutting or shifting existing studs to accommodate the new reinforcement.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script operates on ElementWall entities and creates physical 3D studs. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | This script is for model generation, not drawing creation. |\n\n## Prerequisites\n- **Required Entities**: An existing `ElementWall` in the model.\n- **Minimum Beam Count**: None.\n- **Required Settings**:\n    - `hsbFramingDefaults.Inventory.dll`: Must be accessible (usually found in the hsbCAD install utilities) to provide lumber sizes and grades.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WALL_POINTLOAD.mcr`\n\n### Step 2: Select Wall\n```\nCommand Line: Select a set of Walls\nAction: Click on the wall in ModelSpace where you want to add the point load support.\n```\n\n### Step 3: Define Location\n```\nCommand Line: Select an insertion point\nAction: Click on the wall face at the specific position where the load will be applied.\n```\n\n### Step 4: Configure Properties\n```\nAction: The Dynamic Dialog appears automatically. \n- Select the desired Lumber Item (e.g., 2x4).\n- Set the Number of Beams (e.g., 3 studs).\n- Adjust display settings (Text or X marker).\n- Click OK to generate.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Number of Beams in Point Load | Number | 0 | The quantity of reinforcing studs to generate (usually 1 to 6). |\n| Lumber item | Dropdown | *From Defaults* | Select the timber grade and size (e.g., 2x6 S-P-F) from the inventory list. |\n| Color for new Beams | Number | 1 | The AutoCAD color index for the generated studs (1 = Red, -1 = ByLayer, etc.). |\n| What display to use | Dropdown | Mark Location with an X | Choose between \"Identify with Text\" (shows count like \"3x\") or \"Mark Location with an X\". |\n| DimStyle | Dropdown | -1 | Selects the dimension style used for text annotation. |\n| Offset text from wall | Number | U(7) | Distance from the wall face to the annotation text. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Re-Create Point Load | Forces a full recalculation. Deletes existing studs created by this instance and regenerates them based on the current properties and location. Useful after moving the insertion grip or changing lumber sizes. |\n\n## Settings Files\n- **Filename**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: `_kPathHsbInstall\\Utilities\\hsbFramingDefaultsEditor`\n- **Purpose**: Provides the list of available lumber items, including their width, height, material, and grade properties.\n\n## Tips\n- **Visual Warnings**: If the script displays the location marker in **Red**, it means the point load is too close to an opening or header, and no studs were created. Move the script grip away from the opening.\n- **Existing Studs**: The script automatically detects standard studs in the way. It will either cut them (if deep inside the point load zone) or shift them (if near the edge) to make room.\n- **Grip Editing**: After insertion, you can click and drag the script's insertion grip (usually the 'X' or text location) to slide the point load along the wall. It will recalculate automatically.\n- **Empty Walls**: If the wall does not have Top or Bottom plates assigned, the script will fail with a \"No Plates found\" warning.\n\n## FAQ\n- **Q: Why didn't the script generate any studs?**\n  **A:** The location might be overlapping with a wall opening (header) or the wall might be missing structural plates. Check for a Red warning marker or move the insertion point.\n- **Q: What happens if I change the lumber item?**\n  **A:** Use the \"Re-Create Point Load\" right-click option (or modify the property in the palette) to update the dimensions and material of the existing studs.\n- **Q: Can I use this for a single stud?**\n  **A:** Yes, set the \"Number of Beams in Point Load\" property to 1."
      },
      "tokens_used": 7193,
      "error": null
    }
  }
}