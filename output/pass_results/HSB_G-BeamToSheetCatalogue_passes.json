{
  "filename": "HSB_G-BeamToSheetCatalogue.mcr",
  "status": "completed",
  "total_tokens": 32621,
  "processing_time": 455.0905840396881,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 2,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "18.06.2013",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "28.03.2014",
            "author": "AS",
            "changes": "Add name"
          },
          {
            "version": "1.02",
            "date": "10.09.2015",
            "author": "AS",
            "changes": "Add material as property to set the converted sheets."
          }
        ],
        "settingsFiles": [
          "HSB-BeamToSheetCatalogue.xml"
        ],
        "dependencies": [
          "HSB_G-BeamToSheetCatalogueProps.mcr"
        ]
      },
      "tokens_used": 4562,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getPoint() for insertion location (_Pt0), draws Display elements (text/table) in 3D space relative to the world coordinate system (_XW, _YW, _ZW), and explicitly creates instances of helper scripts using _kModelSpace."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (User must pick a point for insertion)",
          "requiredSettings": [
            "HSB-BeamToSheetCatalogue.xml (must exist in \\Abbund folder)",
            "HSB_G-BeamToSheetCatalogueProps.mcr (Dependency for dialogs)"
          ]
        }
      },
      "tokens_used": 3866,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a  position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "CustomTslDialog",
            "trigger": "On Insert (when _kExecuteKey is empty)",
            "title": "HSB_G-BeamToSheetCatalogueProps",
            "dataSource": "Instance of HSB_G-BeamToSheetCatalogueProps",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "CustomTslDialog",
            "trigger": "Context Menu 'Add an entry'",
            "title": "HSB_G-BeamToSheetCatalogueProps",
            "dataSource": "Instance of HSB_G-BeamToSheetCatalogueProps with Mode=1",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "CustomTslDialog",
            "trigger": "Context Menu 'Edit an entry' or 'Remove an entry' (Selection phase)",
            "title": "HSB_G-BeamToSheetCatalogueProps",
            "dataSource": "Instance of HSB_G-BeamToSheetCatalogueProps with Mode=2",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "CustomTslDialog",
            "trigger": "Context Menu 'Edit an entry' (Editing phase)",
            "title": "HSB_G-BeamToSheetCatalogueProps",
            "dataSource": "Instance of HSB_G-BeamToSheetCatalogueProps with Mode=3",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dTxtHeight",
            "type": "PropDouble",
            "displayName": "|Text size|",
            "defaultValue": "U(50)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "|Dimension style|",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Add an entry|",
            "handler": "|Add an entry|",
            "action": "Opens a dialog to input a new entry name, zone, color, and material, then adds it to the XML catalogue.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Edit an entry|",
            "handler": "|Edit an entry|",
            "action": "Opens a dialog to select an existing entry, then opens another dialog to modify its zone, color, or material.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove an entry|",
            "handler": "|Remove an entry|",
            "action": "Opens a dialog to select an existing entry, then removes it from the XML catalogue.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "HSB-BeamToSheetCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Stores the catalogue of beam to sheet mappings (BeamCode, Zone, Color, Material).",
            "required": true
          }
        ]
      },
      "tokens_used": 4957,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script functions as a visual manager and editor for a catalogue that maps Beam Codes to specific manufacturing properties (Zone, Color, Material). It reads from and writes to an XML file, displaying the current mappings as a formatted table in the model.",
          "category": "Management/Data",
          "typicalUseCase": "A user inserts this script to verify current beam-to-sheet mappings or to add/edit/remove mappings (e.g., assigning specific materials or colors to specific beam types) which are likely used by other scripts or export routines."
        },
        "parameters": [
          {
            "name": "dTxtHeight",
            "technicalDefault": "U(50)",
            "businessMeaning": "Controls the height of the text used to display the catalogue table. This parameter scales the visual representation of the data list to make it readable on screen or in plotted drawings.",
            "validRange": "20mm to 200mm",
            "unit": "mm",
            "affectsOutput": "Directly scales the text size, row height (calculated as 2x text height), and column width (calculated as 10x text height) of the displayed table."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Specifies the CAD dimension style to be applied to the text in the catalogue table. This ensures the text font, arrow style (if any), and other aesthetic properties match the company's drafting standards.",
            "validRange": "Any valid Dimension Style name defined in the CAD drawing",
            "unit": "String",
            "affectsOutput": "Changes the font, line type, and visual styling of the text drawn in the model."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in dTxtHeight",
            "effect": "Recalculates the layout grid for the table.",
            "cascade": [
              "dRowHeight",
              "dColumnWidth"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Display Elements",
            "description": "A formatted table listing Beam Codes and their assigned Zone, Color, and Material, drawn at the insertion point.",
            "appliedTo": "Model Space (at user selected point _Pt0)"
          },
          {
            "type": "XML Data File",
            "description": "Updates the external HSB-BeamToSheetCatalogue.xml file with new or modified mappings.",
            "appliedTo": "File System (_kPathHsbCompany\\Abbund)"
          }
        ]
      },
      "tokens_used": 5717,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches the script (Insert or Execute).",
          "2. Script checks insertCycleCount; if > 1, the instance is erased to prevent duplication.",
          "3. User is prompted to select a position in the Model Space (getPoint).",
          "4. Script reads the XML catalogue file (HSB-BeamToSheetCatalogue.xml) into the _Map variable.",
          "5. [Conditional] If the execution key is empty (standard insertion), the helper script dialog (HSB_G-BeamToSheetCatalogueProps) is shown.",
          "6. The script returns, triggering a calculation pass.",
          "7. Script calculates grid layout based on text height and draws the catalogue table (Header and Content rows) at the selected point.",
          "8. User interacts with the instance via Context Menu to modify the underlying XML data."
        ],
        "conditionalBranches": [
          {
            "condition": "Check for Duplicate Entry Name (during 'Add an entry')",
            "path1": {
              "name": "Entry Exists",
              "steps": [
                "Script detects the key already exists in _Map.",
                "ReportWarning is issued: 'The calalogue already contains an entry with this key...'",
                "XML is NOT updated.",
                "User must retry with a different name or use Edit option."
              ]
            },
            "path2": {
              "name": "Entry New",
              "steps": [
                "New Map entry is created with Zone, Color, and Material.",
                "Entry is added to _Map.",
                "XML file is updated/overwritten."
              ]
            }
          },
          {
            "condition": "Context Menu Selection (Add vs Edit vs Remove)",
            "path1": {
              "name": "Add an entry",
              "steps": [
                "Load XML.",
                "Create Helper Script instance with Mode=1.",
                "Show Dialog to get input.",
                "Update XML."
              ]
            },
            "path2": {
              "name": "Edit an entry",
              "steps": [
                "Load XML.",
                "Create Helper Script instance with Mode=2 (Select Entry).",
                "Create Helper Script instance with Mode=3 (Edit Data).",
                "Update XML."
              ]
            },
            "path3": {
              "name": "Remove an entry",
              "steps": [
                "Load XML.",
                "Create Helper Script instance with Mode=2 (Select Entry).",
                "Remove entry from _Map.",
                "Update XML."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Uniqueness of Entry Name (Beam Code)",
            "errorMessage": "The calalogue already contains an entry with this key. Use the edit option to adjust this entry.",
            "recovery": "User must click OK on the warning, then right-click and choose 'Edit an entry' to modify the existing one, or 'Add an entry' again with a unique name."
          },
          {
            "check": "Zone Index Calculation",
            "errorMessage": "None (Handled internally)",
            "recovery": "Script automatically calculates Zone if input > 5 using formula `nZn = 5 - nZn`."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Update Catalogue Data",
            "how": "Right-click Context Menu > 'Add an entry', 'Edit an entry', or 'Remove an entry'",
            "effect": "Opens helper dialogs to modify the XML file. The script automatically redraws the table to reflect changes to the XML catalogue."
          },
          {
            "action": "Adjust Table Appearance",
            "how": "Properties Palette (OPM)",
            "effect": "Changing 'Text size' (dTxtHeight) scales the table grid (row height and column width). Changing 'Dimension style' (sDimStyle) updates the font and text style."
          },
          {
            "action": "Relocate Table",
            "how": "Grip Edit / Move",
            "effect": "Moves the entire table to a new location in Model Space."
          }
        ]
      },
      "tokens_used": 7815,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-BeamToSheetCatalogue.mcr\n\n## Overview\nThis script acts as a visual manager for a catalogue that maps Beam Codes to manufacturing properties (Zone, Color, and Material). It reads data from an XML file and displays it as a formatted table in the model, allowing you to add, edit, or remove entries directly from the drawing.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | User must select a point to insert the table. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Settings File**: `HSB-BeamToSheetCatalogue.xml` must exist in your company `Abbund` folder (e.g., `\\\\hsbCompany\\Abbund`).\n- **Dependency Script**: `HSB_G-BeamToSheetCatalogueProps.mcr` must be available to handle input dialogs.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `HSB_G-BeamToSheetCatalogue.mcr`.\n\n### Step 2: Select Insertion Point\n```\nCommand Line: Select a position\nAction: Click in the Model Space where you want the catalogue table to appear.\n```\n\n### Step 3: Initial Configuration\nAction: An initial dialog may appear depending on your setup. You can proceed to configure the catalogue properties or view the existing table immediately.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Text size | Number | 50 mm | Controls the height of the text in the table. Row height and column width are calculated automatically based on this value. |\n| Dimension style | Dropdown | _DimStyles | Determines the font and visual style used for the text in the table. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Add an entry | Opens a dialog to input a new Beam Code name, Zone, Color, and Material. This adds a new mapping to the XML file. |\n| Edit an entry | Opens a dialog to select an existing entry from the list, then allows you to modify its properties (Zone, Color, Material). |\n| Remove an entry | Opens a dialog to select an existing entry, then permanently deletes it from the XML catalogue. |\n\n## Settings Files\n- **Filename**: `HSB-BeamToSheetCatalogue.xml`\n- **Location**: `_kPathHsbCompany\\Abbund` (Usually your company's installation folder)\n- **Purpose**: Stores the actual catalogue data linking Beam Codes to specific manufacturing properties.\n\n## Tips\n- **Scaling**: If the table is hard to read, select the script instance and change the **Text size** property in the Properties Palette. The table layout will adjust automatically.\n- **Relocating**: You can move the table by using standard AutoCAD move commands or grip editing the insertion point.\n- **Duplicate Names**: The system prevents duplicate Beam Code keys. If you try to add a name that already exists, you will receive a warning and must use the \"Edit an entry\" option instead.\n\n## FAQ\n- **Q: What happens if I try to add an entry with a name that already exists?**\n- **A:** The script will report a warning: \"The catalogue already contains an entry with this key.\" The update will be cancelled. You must use the \"Edit an entry\" context menu option to modify the existing record.\n\n- **Q: How is the Zone calculated if I enter a specific number?**\n- **A:** The script automatically handles Zone logic. If a specific calculation is required (e.g., input greater than 5), the script adjusts the value internally.\n\n- **Q: Does this script change my beams?**\n- **A:** No. This script only manages the data catalogue (the list of settings). Other scripts or export processes would use this catalogue to apply properties to beams."
      },
      "tokens_used": 5704,
      "error": null
    }
  }
}