{
  "filename": "sdMS_Pitch.mcr",
  "status": "completed",
  "total_tokens": 36724,
  "processing_time": 272.04667806625366,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.3",
            "date": "05dec2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "grips transform with multipage transformation"
          },
          {
            "version": "1.2",
            "date": "05dec2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "orientation and default location changed"
          },
          {
            "version": "1.1",
            "date": "14nov2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6563,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": true,
          "isMultipageScript": true,
          "detectionEvidence": "Summary explicitly states 'creates a pitch symbol in modelspace'. Script explicitly selects and validates an 'HSBCAD_MULTIPAGE' entity during insertion. Retrieves 'ViewData' from multipage submaps ('mpShopdrawData', '_kOnGenerateShopDrawing') to calculate geometry. Filename prefix 'sdMS' (ShopDrawing ModelSpace)."
        },
        "prerequisites": {
          "requiredEntities": [
            "HSBCAD_MULTIPAGE"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space. Requires a Multipage entity that has been processed for Shop Drawings (containing mpShopdrawData).",
          "requiredSettings": []
        }
      },
      "tokens_used": 5882,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getEntity",
              "promptOriginal": "|Select multipage|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "During insertion if no execute key is provided",
            "title": null,
            "dataSource": "Catalog entries (defaults to |_LastInserted| or |_Default|)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "|Color|",
            "defaultValue": "7",
            "inputType": "number",
            "options": [],
            "category": "|Display|",
            "description": "|Defines the Color|"
          },
          {
            "index": 0,
            "variable": "dTextHeight",
            "type": "PropDouble",
            "displayName": "|Text Height|",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "|Display|",
            "description": "|Overrides the textheight of the dimstyle|"
          },
          {
            "index": 0,
            "variable": "sDimstyle",
            "type": "PropString",
            "displayName": "|Dimstyle|",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [],
            "category": "|Display|",
            "description": "|Defines the Dimstyle|"
          },
          {
            "index": 1,
            "variable": "dBaseLength",
            "type": "PropDouble",
            "displayName": "|Base Length|",
            "defaultValue": "2",
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Base Length|"
          },
          {
            "index": 1,
            "variable": "dScale",
            "type": "PropDouble",
            "displayName": "|Scale Factor|",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Base Length|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5443,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a roof pitch symbol (triangle with arc and dimensions) in Model Space, linked to a specific Multipage (Shop Drawing) configuration.",
          "category": "Annotation / Shop Drawing",
          "typicalUseCase": "Used to visualize the slope angle and nominal base length of roof elements directly in the 3D model, ensuring that the pitch details are correct relative to the shop drawing views."
        },
        "parameters": [
          {
            "name": "nColor",
            "technicalDefault": "7",
            "businessMeaning": "Controls the visual color of the pitch symbol lines and text.",
            "validRange": "1-255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the display color of the graphical entity in Model Space."
          },
          {
            "name": "dTextHeight",
            "technicalDefault": "U(0)",
            "businessMeaning": "Manually sets the height of the text labels for the pitch angle and dimensions.",
            "validRange": "U(2.5) - U(10) (typical drawing text heights)",
            "unit": "Current Length Unit (e.g., mm)",
            "affectsOutput": "Increases or decreases the size of the text annotation; if 0, uses the DimStyle default."
          },
          {
            "name": "sDimstyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Selects the drafting standard for formatting numbers (decimals, units) and arrow styles.",
            "validRange": "Any loaded Dimension Style in the drawing",
            "unit": "String",
            "affectsOutput": "Determines the formatting of the angle (degrees) and length values displayed on the symbol."
          },
          {
            "name": "dBaseLength",
            "technicalDefault": "2",
            "businessMeaning": "Defines the nominal 'run' or base length value displayed on the symbol and represents the desired size of the symbol on paper.",
            "validRange": "0.5 - 5.0 (depending on unit scale)",
            "unit": "Current Length Unit (e.g., meters)",
            "affectsOutput": "Scales the physical geometry of the triangle when multiplied by the Scale Factor."
          },
          {
            "name": "dScale",
            "technicalDefault": "100",
            "businessMeaning": "Represents the viewport plot scale (e.g., 1:100) used to calculate the Model Space size of the symbol so it appears consistent on paper.",
            "validRange": "10 - 200 (standard architectural scales)",
            "unit": "Factor",
            "affectsOutput": "Adjusts the overall size of the pitch symbol geometry. Higher scales result in larger geometry in Model Space to maintain visual size when plotted."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dScale or dBaseLength changes",
            "effect": "The geometry of the pitch triangle is recalculated as (Base Length * Scale Factor).",
            "cascade": [
              "Triangle Geometry Size"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Graphical Annotation (PLine/Text)",
            "description": "Draws a right-angled triangle representing the pitch, a curved arc indicating the angle, and text labels for the base length and slope angle.",
            "appliedTo": "Model Space (anchored relative to a Multipage entity coordinate system)."
          }
        ]
      },
      "tokens_used": 7704,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 6950,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# sdMS_Pitch.mcr\n\n## Overview\nThis script creates a roof pitch symbol (a right-angled triangle with dimensions and an angle arc) directly in Model Space. It links to a specific Shop Drawing (Multipage) element to visualize the slope relative to the drawing configuration.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary space for the script. |\n| Paper Space | No | |\n| Shop Drawing | Yes | Requires a Multipage entity with generated shop drawing data. |\n\n## Prerequisites\n- **Required Entities**: An existing `HSBCAD_MULTIPAGE` entity in the drawing.\n- **Minimum Beams**: 0\n- **Required Settings**: The selected Multipage entity must have been processed for shop drawings (it must contain `mpShopdrawData`).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `sdMS_Pitch.mcr` from the list.\n\n### Step 2: Select Multipage\n```\nCommand Line: |Select multipage|\nAction: Click on the Multipage entity (Shop Drawing container) in the Model Space that you wish to associate the pitch symbol with.\n```\n\n### Step 3: Configure Properties\nAfter insertion, select the newly created pitch symbol and adjust its parameters in the Properties Palette (OPM) to fit your plotting scale and standards.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Display** | | | |\n| Color | Integer | 7 | Defines the color of the pitch symbol lines and text (AutoCAD Color Index). |\n| Text Height | Double | 0 | Overrides the text height. If set to 0, the height defined in the Dimstyle is used. |\n| Dimstyle | String | _DimStyles | Selects the Dimension Style to use for formatting text and arrows. |\n| **General** | | | |\n| Base Length | Double | 2 | Defines the nominal base length (run) of the triangle. |\n| Scale Factor | Double | 100 | The scale factor (e.g., 1:100). Used to calculate the actual physical size of the symbol in Model Space. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | No custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Sizing the Symbol**: The physical size of the symbol in Model Space is calculated as `Base Length * Scale Factor`. If the symbol appears too small on your layout, ensure the `Scale Factor` matches your viewport plot scale (e.g., set to 50 for a 1:50 plot).\n- **Text Readability**: If the angle text is too small or large, use the `Text Height` property to override it manually, or ensure the selected `Dimstyle` is configured correctly for your scale.\n- **Data Dependency**: Ensure the Multipage entity you select has up-to-date shop drawing data. If the pitch symbol shows incorrect angles, try regenerating the shop drawing for that Multipage.\n\n## FAQ\n- **Q: Why does the prompt fail when I select a beam?**\n  - A: This script specifically requires a `HSBCAD_MULTIPAGE` entity (the container for shop drawings), not an individual beam.\n- **Q: The symbol is tiny. How do I fix it?**\n  - A: Check the `Scale Factor` property in the Properties palette. It likely defaults to 100. If you are working at a 1:50 scale, change this value to 50."
      },
      "tokens_used": 4182,
      "error": null
    }
  }
}