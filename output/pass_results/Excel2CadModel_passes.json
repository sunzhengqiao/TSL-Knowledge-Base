{
  "filename": "Excel2CadModel.mcr",
  "status": "completed",
  "total_tokens": 43413,
  "processing_time": 240.7270839214325,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "11.11.2025",
            "author": "Marsel Nakuci",
            "changes": "HSB-24891: Fix when running hsbExcelToMap"
          },
          {
            "version": "1.3",
            "date": "12.12.2023",
            "author": "Thorsten Huck",
            "changes": "HSB-20437 bugfix beam color"
          },
          {
            "version": "1.2",
            "date": "22.07.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-11827 debug message removed"
          },
          {
            "version": "1.1",
            "date": "28.05.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-11827 bugfix assigning sublabel"
          },
          {
            "version": "1.0",
            "date": "25.05.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-11872 initial version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8227,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates Beam, Sheet, Sip, and BlockRef entities using dbCreate(). No ShopDrawing constructs (sd_*, #Type E), viewport logic, or Paper Space API calls detected."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "hsbExcelToMap.exe or hsbExcelToMap.dll (in hsbCAD Utilities folder)",
            "Excel file with worksheets named 'Beam', 'Sheet', 'Panel', or 'BlockRef'"
          ]
        }
      },
      "tokens_used": 6444,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sLastPath",
            "type": "PropString",
            "displayName": "Path",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the last used path"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "DoubleClick",
            "handler": "TslDoubleClick",
            "action": "Unknown action (handler variable defined but no handler code found in script)",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 5906,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Imports structural and architectural components (Beams, Sheets, Panels, and Blocks) defined in an Excel spreadsheet into the hsbCAD 3D model.",
          "category": "Data Import / Model Generation",
          "typicalUseCase": "Used to convert a schedule or cut list (e.g., from an external estimator or structural engineer) directly into hsbCAD geometry without manual modeling."
        },
        "parameters": [
          {
            "name": "sLastPath",
            "technicalDefault": "",
            "businessMeaning": "Stores the file path of the Excel file used in the previous import operation. This serves as a shortcut for the user, ensuring the file dialog opens in the correct location for subsequent imports.",
            "validRange": "Any valid file system path string (e.g., \"C:\\Projects\\Jobs\\ImportList.xlsx\")",
            "unit": "Text (String)",
            "affectsOutput": "Does not directly change geometry. It determines the default folder presented to the user when selecting the source Excel file, thereby affecting which data set is imported."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Script Insertion (_bOnInsert)",
            "effect": "Launches the external utility 'hsbExcelToMap' (DLL or EXE) which likely presents a file selection dialog. The 'sLastPath' property is passed to this utility to set the initial directory.",
            "cascade": [
              "Excel File Content"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "Generates standard timber beams (GenBeam) with dimensions (Length/Width/Height) and orientation derived from Excel data. Can apply end cuts (miters/bevels) based on 'Cut1N/P' and 'Cut2N/P' columns found in the import data.",
            "appliedTo": "Rows within the 'Beam' worksheet in the Excel file."
          },
          {
            "type": "Sheet",
            "description": "Creates planar sheet elements (e.g., plywood or OSB boards) based on defined dimensions and coordinate systems.",
            "appliedTo": "Rows within the 'Sheet' worksheet in the Excel file."
          },
          {
            "type": "Sip (Panel)",
            "description": "Creates Structural Insulated Panels. It attempts to match a predefined SipStyle based on the name in Excel, or creates a default style if none exists, ensuring the thickness matches the Excel data.",
            "appliedTo": "Rows within the 'Panel' or 'Sip' worksheet in the Excel file."
          },
          {
            "type": "BlockRef",
            "description": "Inserts references to external DWG blocks at specified coordinates and scales. If the block is not found in the drawing, it attempts to import it from the file path provided in the Excel data.",
            "appliedTo": "Rows within the 'BlockRef' worksheet in the Excel file."
          }
        ]
      },
      "tokens_used": 8277,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 10018,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Excel2CadModel.mcr\n\n## Overview\nThis script imports structural and architectural components (Beams, Sheets, Panels, and Blocks) defined in an Excel spreadsheet directly into the hsbCAD 3D model. It is used to convert schedules or cut lists from external estimators into CAD geometry without manual modeling.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script creates Beam, Sheet, Panel, and BlockRef entities in the model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **External Tool**: `hsbExcelToMap.exe` or `hsbExcelToMap.dll` must be present in the hsbCAD Utilities folder.\n- **Source Data**: A valid Excel file (`.xlsx` or `.xls`) containing the data to be imported.\n- **Worksheet Names**: The Excel file must contain worksheets named specifically `Beam`, `Sheet`, `Panel`, or `BlockRef` corresponding to the entities you wish to create.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Excel2CadModel.mcr`\n\n### Step 2: Select Excel File\n```\nCommand Line: Script triggers external utility...\nAction: A file selection dialog (provided by the hsbExcelToMap utility) will open.\n```\n1. Navigate to the location of your Excel file.\n2. Select the file and click **Open**.\n\n### Step 3: Generate Model\n```\nCommand Line: Processing data...\nAction: The script reads the rows in the Excel file and automatically generates the corresponding 3D entities (Beams, Sheets, etc.) in the drawing.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Path | text | (Empty) | Stores the file path of the Excel file used in the last import. This acts as a memory aid, so the file dialog opens in the correct folder the next time you run the script. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (None) | No specific custom context menu actions are active for this script. |\n\n## Settings Files\n- **Filename**: N/A (This script does not use internal XML settings files).\n- **Location**: N/A\n- **Purpose**: The script relies entirely on the external Excel file for configuration and data inputs.\n\n## Tips\n- **Excel Formatting**: Ensure your worksheet names match exactly what the utility expects (e.g., `Beam`, `Sheet`, `Panel`, `BlockRef`). Incorrect naming usually results in no data being imported.\n- **Block References**: If importing `BlockRef` entities, ensure the DWG files referenced in your Excel exist in the AutoCAD support path or the specified full path; otherwise, the blocks will fail to insert.\n- **Path Memory**: If you frequently import from the same folder, check the \"Path\" property in the Properties Palette after the first run to verify the script remembered the location.\n\n## FAQ\n- **Q: I clicked to insert the script, but no dialog appeared.**\n  A: This script relies on the external `hsbExcelToMap.exe`. Ensure this file exists in your `hsbCAD` Utilities folder. Also, check if the dialog window is hidden behind other AutoCAD windows.\n- **Q: The script ran, but no geometry appeared.**\n  A: Check your Excel file. It must contain one of the specific worksheet names (`Beam`, `Sheet`, etc.) to generate geometry. Empty worksheets or wrong names will result in no output."
      },
      "tokens_used": 4541,
      "error": null
    }
  }
}