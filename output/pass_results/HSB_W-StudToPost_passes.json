{
  "filename": "HSB_W-StudToPost.mcr",
  "status": "completed",
  "total_tokens": 36201,
  "processing_time": 629.8848490715027,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "19.02.2018",
            "author": "AS",
            "changes": "First revision"
          },
          {
            "version": "1.01",
            "date": "20.02.2018",
            "author": "AS",
            "changes": "Add option to change post height, position and properties."
          },
          {
            "version": "1.02",
            "date": "21.02.2018",
            "author": "AS",
            "changes": "Add option to set catalog through map."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5536,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Beams (GenBeam) and directly modifies 3D geometry using setD(), transformBy(), and addToolStatic(). It interacts with Element contexts to identify top plates within a wall structure. There are no references to sd_ functions, _Viewport, or drawing entities, and it does not define #Type E."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 4116,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select studs to convert|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDialog\",\n      \"trigger\": \"_bOnInsert\",\n      \"title\": \"Properties\",\n      \"dataSource\": \"Standard Properties Palette\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"widthPost\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Width post|\",\n      \"defaultValue\": \"105\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Size and position|\",\n      \"description\": \"|Sets the width of the posts.|Setting it to zero will not change the height.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"heightPost\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Height post|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Size and position|\",\n      \"description\": \"|Sets the height of the posts.|Setting it to zero will not change the height.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"postPositionProp\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Post position|\",\n      \"defaultValue\": \"|Front|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Front|\",\n        \"|Center|\",\n        \"|Back|\"\n      ],\n      \"category\": \"|Size and position|\",\n      \"description\": \"|Sets the height of the posts.|Setting it to zero will not change the height.|\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"stretchAboveTopPlateProp\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Stretch above top plate|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Size and position|\",\n      \"description\": \"|Specifies whether the post should be strecth through the top plate.|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"beamTypeProp\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Beam type|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"_BeamTypes\",\n      \"category\": \"|Beam properties|\",\n      \"description\": \"|Sets the beam type of the post.|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\":"
      },
      "tokens_used": 7288,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 7634,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Start",
          "Check Insertion Context (_bOnInsert)",
          "[Conditional] Insert Cycle Check (insertCycleCount > 1)",
          "[Conditional] Execute Key / Catalog Check (_kExecuteKey, _Map)",
          "[Conditional] Show Dialog (if no execute key or catalog found)",
          "Save current properties as '_LastInserted' catalog",
          "Prompt User to Select Studs (PrEntity)",
          "[Conditional] Beam Selection Check (Any beams selected?)",
          "Script End / Erase Instance",
          "[Recalculation Start] Check Input Validity",
          "[Conditional] Width Validation (widthPost > 0)",
          "Loop through each selected Stud",
          "Update Stud Properties (Type, Name, Material, etc.)",
          "Check if Stud belongs to a valid Element",
          "[Branch 1] No Valid Element (Standalone Stud)",
          "   -> Set Stud Width (Y-axis)",
          "   -> [Conditional] Set Stud Height (if heightPost > 0)",
          "   -> [Conditional] Adjust Stud Position (if heightPost > 0 && postPosition != 0)",
          "[Branch 2] Valid Element (Wall Structure)",
          "   -> Calculate Element Coordinate System",
          "   -> Set Stud Width relative to Element X-axis",
          "   -> [Conditional] Set Stud Height & Transform relative to Element Z-axis",
          "   -> [Conditional] Stretch Above Top Plate Logic (if enabled)",
          "       -> Find Top Plates in Element",
          "       -> Check Intersection with Stud",
          "       -> Add Cut Tool to Stud (_kStretchOnInsert)",
          "       -> Split Top Plate Beam",
          "Next Stud in Loop",
          "Erase Instance",
          "Script End"
        ],
        "conditionalBranches": [
          {
            "condition": "Insert cycle check (insertCycleCount > 1)",
            "path1": {
              "name": "Erase Instance",
              "steps": [
                "Erase Instance",
                "Return"
              ]
            },
            "path2": {
              "name": "Continue Insertion",
              "steps": [
                "Execute Key Check",
                "Map Check",
                "Dialog Prompt",
                "Select Entities"
              ]
            }
          },
          {
            "condition": "Execute Key or Map Catalog present",
            "path1": {
              "name": "Use Catalog",
              "steps": [
                "setPropValuesFromCatalog",
                "Skip Dialog"
              ]
            },
            "path2": {
              "name": "Manual Input",
              "steps": [
                "showDialog",
                "User enters properties"
              ]
            }
          },
          {
            "condition": "Beams selected after PrEntity",
            "path1": {
              "name": "Valid Selection",
              "steps": [
                "Proceed to Recalculation/Execution"
              ]
            },
            "path2": {
              "name": "Invalid/No Selection",
              "steps": [
                "Script Ends",
                "Instance Erased"
              ]
            }
          },
          {
            "condition": "Post Width (widthPost) value",
            "path1": {
              "name": "Valid Width (> 0)",
              "steps": [
                "Continue to Beam Loop"
              ]
            },
            "path2": {
              "name": "Invalid Width (<= 0)",
              "steps": [
                "Report Warning",
                "Erase Instance",
                "Return"
              ]
            }
          },
          {
            "condition": "Stud is part of a valid Element",
            "path1": {
              "name": "In Element",
              "steps": [
                "Align to Element CS",
                "Apply dimensions based on Element axes",
                "Handle Top Plate Stretching if required"
              ]
            },
            "path2": {
              "name": "Not In Element",
              "steps": [
                "Apply dimensions based on Stud local axes",
                "Ignore Top Plate logic"
              ]
            }
          },
          {
            "condition": "Post Height property (heightPost) > 0",
            "path1": {
              "name": "Change Height",
              "steps": [
                "Set Z-dimension",
                "Adjust position based on 'Post position' (Front/Center/Back)"
              ]
            },
            "path2": {
              "name": "Keep Height",
              "steps": [
                "Skip Z-dimension change"
              ]
            }
          },
          {
            "condition": "Stretch above top plate (stretchAboveTopPlateProp)",
            "path1": {
              "name": "Yes",
              "steps": [
                "Find Top Plates",
                "Check overlap",
                "Add Cut Tool",
                "Split Top Plate"
              ]
            },
            "path2": {
              "name": "No",
              "steps": [
                "Skip Top Plate logic"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Input Beams availability",
            "errorMessage": "|invalid or no beams selected.|",
            "recovery": "Re-run the script and ensure at least one beam is selected."
          },
          {
            "check": "Width of the post (widthPost)",
            "errorMessage": "|The width of the post must have a positive value.|",
            "recovery": "Modify the 'Width post' property in the properties palette to a value greater than 0."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Post Properties",
            "how": "Properties Palette (OPM)",
            "effect": "Changing properties like Width, Height, Position, Beam Type, or Material will trigger a recalculation, updating the geometry of the generated post."
          },
          {
            "action": "Context Menu (Right-click)",
            "how": "addRecalcTrigger (Standard behavior for TSL scripts)",
            "effect": "Access recalculations or potential context-specific options defined by the script environment."
          }
        ]
      },
      "tokens_used": 5932,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_W-StudToPost.mcr\n\n## Overview\nThis script converts selected wall studs into structural posts with customizable dimensions and properties. It handles adjustments for width, height, positioning, and can automatically cut through top plates if required.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D model geometry. |\n| Paper Space | No | Not designed for 2D layout or drawing views. |\n| Shop Drawing | No | Does not generate shop drawing views or labels. |\n\n## Prerequisites\n- **Required Entities**: Existing Beams (studs) in the model.\n- **Minimum Beam Count**: At least 1 beam must be selected.\n- **Required Settings**: No external settings files required.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_W-StudToPost.mcr` from the list.\n\n### Step 2: Configure Properties\nThe Properties Palette will open automatically upon launch.\nAction: Adjust the parameters (Width, Height, Position, etc.) to your requirements before selecting beams.\n\n### Step 3: Select Studs\n```\nCommand Line: Select studs to convert\nAction: Click on the studs you wish to convert into posts. Press Enter to confirm selection.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width post | Number | 105 | Sets the width of the posts. A positive value is required. |\n| Height post | Number | 0 | Sets the height of the posts. If set to 0, the current height of the stud is maintained. |\n| Post position | Dropdown | Front | Sets the alignment of the post relative to the structure (Front, Center, or Back). |\n| Stretch above top plate | Dropdown | No | Specifies whether the post should stretch through and cut the top plate (Yes/No). |\n| Beam type | Dropdown | *[Empty]* | Sets the beam type of the post from the available catalog types. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (Standard hsbCAD Context) | This script typically runs as a \"fire and forget\" tool. Once executed, the script instance is erased. Right-click options apply primarily if the script is intercepted or if editing the resulting beams directly. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies on standard hsbCAD catalogs for Beam Types and Materials; no specific external XML settings file is required.\n\n## Tips\n- **Maintaining Height**: To convert a stud to a post without changing its length, leave the `Height post` value set to 0.\n- **Wall Integration**: If you select \"Yes\" for **Stretch above top plate**, ensure the studs are part of a valid wall element. The script will automatically identify and split the top plate to accommodate the post height.\n- **Positioning**: Use the **Post position** property to quickly align the post flush with the outside (Front/Back) or center of the construction.\n\n## FAQ\n- **Q: Why did the script fail with an error?**\n  **A:** Ensure you have entered a positive value greater than 0 for the `Width post` property. A width of 0 is not valid.\n- **Q: Can I use this on a beam that is not part of a wall?**\n  **A:** Yes. If the beam is standalone (not part of a wall element), the script will apply the width and height changes based on the beam's local coordinate system. The \"Stretch above top plate\" logic will only apply if the beam is within a recognized wall structure."
      },
      "tokens_used": 5695,
      "error": null
    }
  }
}