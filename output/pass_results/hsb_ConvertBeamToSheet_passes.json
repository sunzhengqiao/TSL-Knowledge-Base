{
  "filename": "hsb_ConvertBeamToSheet.mcr",
  "status": "completed",
  "total_tokens": 32884,
  "processing_time": 233.97931814193726,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "09.03.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.1",
            "date": "14.04.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Added Property for Zones"
          },
          {
            "version": "1.2",
            "date": "22.11.2012",
            "author": "",
            "changes": "Add the option to select a zone and will convert all the beams of that zone into sheets"
          },
          {
            "version": "1.3",
            "date": "23.01.2014",
            "author": "",
            "changes": "Control the color of the new sheet"
          },
          {
            "version": "1.4",
            "date": "30.10.2015",
            "author": "",
            "changes": "Added other beam properties into sheet e.g. label, sublabel etc."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3958,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Element, iterates el.beam() to manipulate construction entities. It creates Sheet entities using dbCreate() and deletes Beam entities using dbErase(). No sd_* functions or Viewport handling are present. The script modifies the 3D physical model geometry."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Beam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D environment containing Elements with Beams)",
          "requiredSettings": []
        }
      },
      "tokens_used": 3538,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"\\nSelect a set of elements\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sFilterBeams\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Convert Beams with Code|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"|Separate multiple entries by|) ;\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sOption\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Convert Type|\",\n      \"defaultValue\": \"|By Beam Code|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|By Beam Code|\",\n        \"|By Zone|\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color for the new sheet\",\n      \"defaultValue\": 6,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"Set the color of the battens, (-1) will keep the existing color\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nZones\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Zone to Select or Assign the Sheets\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        0,\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n       "
      },
      "tokens_used": 7057,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Converts existing structural beams into sheet materials (like plywood or OSB) based on specific beam codes or zones, preserving metadata.",
          "category": "Model Manipulation / Conversion",
          "typicalUseCase": "Converting rough framing members (e.g., 'BATTEN' or 'RIB' codes) into planar sheet goods for CNC manufacturing or detailing, or mass-assigning sheathing to specific wall zones."
        },
        "parameters": [
          {
            "name": "sFilterBeams",
            "technicalDefault": "\"\"",
            "businessMeaning": "A filter list of beam codes (e.g., 'STUD', 'RIB') that determines which beams within the selected elements are candidates for conversion.",
            "validRange": "Text string of beam codes separated by semicolons (;)",
            "unit": "Text",
            "affectsOutput": "Only beams whose code matches one of the entries in this list (if 'By Beam Code' is selected) will be converted into sheets."
          },
          {
            "name": "sOption",
            "technicalDefault": "\"|By Beam Code|\"",
            "businessMeaning": "The selection logic used to identify which beams to convert.",
            "validRange": "Dropdown: '|By Beam Code|' or '|By Zone|'",
            "unit": "Enumeration",
            "affectsOutput": "If 'By Beam Code', it uses the sFilterBeams list. If 'By Zone', it uses the nZones index to filter beams."
          },
          {
            "name": "nColor",
            "technicalDefault": "6",
            "businessMeaning": "The visual color assigned to the newly created sheet entities in the CAD model.",
            "validRange": "0-255 (AutoCAD Color Index) or -1",
            "unit": "Index",
            "affectsOutput": "Determines the display color of the resulting sheets. -1 preserves the original beam's color. Other values override it."
          },
          {
            "name": "nZones",
            "technicalDefault": "0",
            "businessMeaning": "The specific construction zone (Index) used to filter beams (if 'By Zone' is selected) or to assign the new sheets to.",
            "validRange": "0-10",
            "unit": "Index",
            "affectsOutput": "Filters beams based on their current zone assignment or assigns the resulting sheets to this specific zone."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sOption set to '|By Beam Code|'",
            "effect": "The script reads the sFilterBeams string to identify targets. The nZones parameter is only used for final assignment, not filtering.",
            "cascade": [
              "sFilterBeams"
            ]
          },
          {
            "trigger": "sOption set to '|By Zone|'",
            "effect": "The script ignores sFilterBeams and filters beams based on the value in nZones.",
            "cascade": [
              "nZones"
            ]
          },
          {
            "trigger": "nColor set to -1",
            "effect": "The script attempts to inherit the display color from the source beam being converted.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet",
            "description": "A planar geometry entity representing a sheet good (e.g., OSB, Plywood), generated from the bounding profile and thickness of the selected beams.",
            "appliedTo": "Created at the location of the filtered beams, then assigned to the original Element."
          }
        ]
      },
      "tokens_used": 4626,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script Initialization: Define properties for Filter Type (sOption), Filter Codes (sFilterBeams), Color (nColor), and Zones (nZones).\",\n    \"2. Catalog Check: If executed via catalog key (_kExecuteKey), load properties from catalog entry.\",\n    \"3. Interactive Insertion: If inserting manually, show Properties Dialog (showDialogOnce) to configure parameters.\",\n    \"4. User Selection: Prompt user to select a set of Elements (PrEntity).\",\n    \"5. Instance Protection: Check insertCycleCount; erase if this is a re-entry to prevent loops.\",\n    \"6. Element Validation: Verify if any elements were selected; if not, erase script instance.\",\n    \"7. Filter Parsing: Split the 'sFilterBeams' string into an array of codes using semicolons as delimiters.\",\n    \"8. Zone Mapping: Map the selected visual zone index to the real internal zone index.\",\n    \"9. Iterate Selected Elements: Loop through each element in the _Element array.\",\n    \"10. Beam Collection: Retrieve all beams within the current element.\",\n    \"11. Beam Filtering: Filter beams based on the selected 'sOption' mode (By Code vs By Zone).\",\n    \"12. Geometry Loop: Iterate through the list of beams marked for conversion.\",\n    \"13. Orientation Detection: Compare dimensions to determine if Y or Z axis is the 'thickness' (normal).\",\n    \"14. Slice Generation: Create a PlaneProfile slice of the beam geometry based on calculated thickness.\",\n    \"15. Entity Creation: Create a new Sheet entity (dbCreate) using the slice profile and thickness.\",\n    \"16. Property Mapping: Copy Name, Material, Grade, Labels, Info, and BeamCode from original beam to new sheet.\",\n    \"17. Color Assignment: Apply color based on 'nColor' property (Fixed vs Inherited).\",\n    \"18. Group Assignment: Assign the new sheet to the original element group and zone.\",\n    \"19. Original Removal: Add original beam to removal list and execute dbErase().\",\n    \"20. Script Cleanup: Erase the script instance from the drawing.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Conversion Type (sOption)\",\n      \"path1\": {\n        \"name\": \"By Beam Code\",\n        \"steps\": [\n          \"Script uses sBeamFilter array.\",\n          \"Checks if bm.beamCode() exists in the filter list.\",\n          \"Ignores nZones for filtering purposes.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"By Zone\",\n        \"steps\": [\n          \"Script ignores sBeamFilter array.\",\n          \"Checks if bm.myZoneIndex() matches nZones property.\",\n          \"Converts all beams in the specified zone.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Color Assignment (nColor)\",\n      \"path1\": {\n        \"name\": \"Fixed Color\",\n        \"steps\": [\n          \"User sets nColor to a value >= 0.\",\n          \"New sheet color is set to nColor value.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Inherit Color\",\n        \"steps\": [\n          \"User sets nColor to -1.\",\n          \"New sheet color is set to the source beam's current color (nCurrentColor).\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Geometry Orientation\",\n      \"path1\": {\n        \"name\": \"Y-Axis Normal\",\n        \"steps\": [\n          \"Checks if Dimension Y < Dimension Z.\",\n          \"Assumes Y is the thickness.\",\n          \"Sets Sheet Normal to Beam Y-axis.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Z-Axis Normal\",\n        \"steps\": [\n          \"Checks"
      },
      "tokens_used": 7918,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ConvertBeamToSheet.mcr\n\n## Overview\nConverts existing structural beams into sheet materials (such as plywood or OSB) based on specific beam codes or construction zones. It creates new sheet entities, copies properties from the original beams, and deletes the old beams.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D Elements and Beams. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required entities**: Elements containing Beams.\n- **Minimum beam count**: 0 (Script functions, but requires beams to perform conversion).\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_ConvertBeamToSheet.mcr` from the file list.\n\n### Step 2: Configure Properties\nAfter insertion, the **Properties Palette** (usually accessible by pressing `Ctrl+1`) will display the script parameters. Adjust the **Convert Type**, **Filter Codes**, **Zone**, or **Color** as needed before proceeding to selection.\n\n### Step 3: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the Elements (e.g., walls, floors) containing the beams you wish to convert and press Enter.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Convert Type | dropdown | \\|By Beam Code\\| | Determines how the script selects beams for conversion. Choose between \"By Beam Code\" or \"By Zone\". |\n| Convert Beams with Code | text | | A list of beam codes to filter. Separate multiple codes with a semicolon (;). Only used if \"By Beam Code\" is selected. |\n| Zone to Select or Assign | dropdown | 0 | The construction zone index to use for filtering (if \"By Zone\" is selected) or to assign the new sheets to. |\n| Color for the new sheet | number | 6 | The display color for the generated sheets. Enter `-1` to keep the original beam's color. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | The script runs immediately upon element selection and erases itself from the drawing afterwards. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Multiple Codes**: When using \"By Beam Code\", you can target multiple types of beams at once (e.g., `STUD;RIB;BATTEN`).\n- **Color Inheritance**: Setting the color to `-1` is useful if you want the new sheets to visually match the specific materials or layer colors of the beams they are replacing.\n- **Undo**: The conversion modifies the database (creating sheets and erasing beams). Use the standard AutoCAD `UNDO` command if you make a mistake.\n\n## FAQ\n- **Q: What happens to the original beams?**\n- **A: The original beams are deleted from the model and replaced by the new sheet entities. Ensure you have a backup or use Undo if needed.\n- **Q: Can I use this to convert sheathing applied to a wall?**\n- **A: Yes. If your sheathing is modeled as individual beams (like \"Ribs\"), this script can convert them into single sheet elements if they match the specified filter.\n- **Q: Why did nothing happen?**\n- **A: Check that your filter codes (if using Code mode) exactly match the beam codes in the model, or that the selected elements actually contain beams in the specified Zone (if using Zone mode)."
      },
      "tokens_used": 5787,
      "error": null
    }
  }
}