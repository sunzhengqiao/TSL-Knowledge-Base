{
  "filename": "GE_HDWR_ANCHOR_ADHESIVE.mcr",
  "status": "completed",
  "total_tokens": 29682,
  "processing_time": 514.0404121875763,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.2",
            "date": "15.jun.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "TSL can now be inserted by other hardware systems"
          },
          {
            "version": "1.1",
            "date": "27.nov.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Version control (several enhancements, coordinated with Manish Patel and Marcelo Quevedo)"
          },
          {
            "version": "1.0",
            "date": "14.nov.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release. Created as dummy only, insertion yet to be coded. Will be useful inserted from outside"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4860,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script constructs 3D geometry (Body, PLine) and draws it using a Display object. It does not use 'sd_' prefixes, '_Viewport', or references to Paper Space entities. The script checks for _Element.length() for dependency but primarily creates 3D rod, nut, and washer bodies using Vector3d calculations relative to _Pt0."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 2732,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "Anchor type",
            "defaultValue": "1/2 Adhesive Anchor",
            "inputType": "dropdown",
            "options": [
              "1/2 Adhesive Anchor",
              "5/8 Adhesive Anchor",
              "7/8 Adhesive Anchor"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4421,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates 3D geometry for an adhesive anchor assembly (threaded rod, hex nut, and square washer) for use in timber-to-concrete connections.\",\n    \"category\": \"Hardware\",\n    \"typicalUseCase\": \"Automatically inserted by a parent connection script (e.g., Column Base or Hold-down) to represent concrete anchoring details without manual user input.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sType\",\n      \"technicalDefault\": \"1/2 Adhesive Anchor\",\n      \"businessMeaning\": \"Specifies the nominal diameter of the threaded rod anchor.\",\n      \"validRange\": \"1/2\\\", 5/8\\\", 7/8\\\" (Select from dropdown list)\",\n      \"unit\": \"Inches\",\n      \"affectsOutput\": \"Updates the internal size reference (e.g., '1/2', '5/8') used to match with parent script configurations. Note: The geometry radius in the provided snippet appears statically set to a default, but the parameter is designed to drive size selection.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"Map contains 'HideWasherAndNuts' (value 1)\",\n      \"effect\": \"Suppresses the drawing of the Nut and Washer geometry. Only the rod is generated.\",\n      \"cascade\": []\n    },\n    {\n      \"trigger\": \"Map contains 'ANCHORTYPE'\",\n      \"effect\": \"Overwrites the 'sType' property to match the string value provided by the calling script (e.g., matching '1/2' to '1/2 Adhesive Anchor').\",\n      \"cascade\": [\n        \"sType\"\n      ]\n    },\n    {\n      \"trigger\": \"Map contains 'InsertedByDirective' (value 1)\",\n      \"effect\": \"Locks the 'sType' property, making it read-only in the properties palette to prevent user modification of the anchor size.\",\n      \"cascade\": [\n        \"sType\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Body\",\n      \"description\": \"A cylindrical rod representing the adhesive anchor (threaded rod), extending from the insertion point.\",\n      \"appliedTo\": \"Model Space (Placed at _Pt0)\"\n    },\n    {\n      \"type\": \"Body\",\n"
      },
      "tokens_used": 6823,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Execution Starts",
          "Check Insertion Flag (_bOnInsert)",
          "[Conditional Branch] Manual Insertion vs Programmatic Insertion",
          "Read Data from Map (_Map): ANCHORTYPE, Vectors (vx, vy, vz), Directives",
          "Set Property Read-Only Status based on 'InsertedByDirective' map entry",
          "Check for Element Dependency (length of _Element array)",
          "Construct Rod Geometry (Body) at insertion point",
          "Evaluate 'HideWasherAndNuts' Map Entry",
          "[Conditional Branch] Draw Nut and Washer Geometry OR Skip and Finish",
          "Draw All Geometry to Display"
        ],
        "conditionalBranches": [
          {
            "condition": "Is script triggered by manual user insertion? (_bOnInsert == true)",
            "path1": {
              "name": "Manual Insertion",
              "steps": [
                "Display error message stating manual insertion is not allowed",
                "Execute eraseInstance() command",
                "Terminate script execution"
              ]
            },
            "path2": {
              "name": "Programmatic / Recalculation",
              "steps": [
                "Proceed to coordinate system initialization",
                "Process data from Map",
                "Generate geometry"
              ]
            }
          },
          {
            "condition": "Does the Map contain the 'HideWasherAndNuts' key (value 1)?",
            "path1": {
              "name": "Hide Hardware",
              "steps": [
                "Generate Rod geometry",
                "Skip Nut generation",
                "Skip Washer generation",
                "Return (End script)"
              ]
            },
            "path2": {
              "name": "Show Hardware",
              "steps": [
                "Generate Rod geometry",
                "Calculate Nut coordinates",
                "Calculate Washer coordinates",
                "Generate and Draw Nuts",
                "Generate and Draw Washers"
              ]
            }
          },
          {
            "condition": "Does the Map contain 'InsertedByDirective' (value 1)?",
            "path1": {
              "name": "Locked",
              "steps": [
                "Set sType property to Read-Only",
                "Prevent user modification via OPM"
              ]
            },
            "path2": {
              "name": "Unlocked",
              "steps": [
                "Allow sType modification via OPM"
              ]
            }
          },
          {
            "condition": "Check element dependency count",
            "path1": {
              "name": "1 Element Found",
              "steps": [
                "Set Dependency on Element",
                "If element deleted, trigger eraseInstance()"
              ]
            },
            "path2": {
              "name": "0 or >1 Elements",
              "steps": [
                "No specific dependency logic applied"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Attempt to insert the script manually via command line or menu",
            "errorMessage": "This TSL has not yet a manual insertion defined. It can be inserted only by other script. Instance will be erased",
            "recovery": "Use the parent hardware script (e.g., Column Base) to insert this anchor. The instance will be deleted automatically if inserted directly."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Anchor Type",
            "how": "OPM (Properties Palette)",
            "effect": "Updates the 'sType' property string. Note: In the provided code snippet, this does not dynamically resize the geometry (radius remains constant), but updates the property value for reporting or parent script matching."
          },
          {
            "action": "Delete Host Element",
            "how": "CAD Delete Command",
            "effect": "If the TSL is linked to a single element and that element is deleted, the script detects '_bOnElementDeleted' and automatically erases the anchor instance."
          }
        ]
      },
      "tokens_used": 6152,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_HDWR_ANCHOR_ADHESIVE.mcr\n\n## Overview\nThis script generates 3D geometry for adhesive anchor assemblies, including a threaded rod, hex nut, and square washer. It is designed to function as a sub-component automatically inserted by parent connection scripts (such as column bases or hold-downs) rather than being inserted manually by the user.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Generates 3D Bodies and PLines for the anchor hardware. |\n| Paper Space | No | Not applicable for 2D detailing views. |\n| Shop Drawing | No | Used for 3D model representation only. |\n\n## Prerequisites\n- **Required entities**: None (typically receives insertion coordinates from a parent script).\n- **Minimum beam count**: 0.\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Understand Script Context\nThis script does not support standard manual insertion. It is intended to be called automatically by other hardware scripts to create anchor details.\n\n### Step 2: Manual Insertion Behavior (If Attempted)\nIf you attempt to run this script directly via the command line:\n```\nCommand: TSLINSERT\nSelect file: GE_HDWR_ANCHOR_ADHESIVE.mcr\nResult: Error message displays: \"This TSL has not yet a manual insertion defined. It can be inserted only by other script. Instance will be erased.\"\nAction: The instance is automatically deleted.\n```\n\n### Step 3: Usage via Parent Script\n1.  Run a parent hardware script (e.g., a Column Base connection) that utilizes adhesive anchors.\n2.  The parent script passes the anchor type, position, and orientation vectors to this script.\n3.  The anchor assembly (Rod, Nut, Washer) is generated automatically at the calculated coordinates.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Anchor type | dropdown | 1/2 Adhesive Anchor | Selects the nominal diameter of the adhesive anchor. Options include 1/2\", 5/8\", and 7/8\". Note: This property may be read-only if inserted by a parent script directive. |\n\n## Right-Click Menu Options\nNo custom context menu options are defined for this script.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Read-Only Properties**: If the `Anchor type` property appears greyed out or uneditable, it is because the script was inserted by a parent system directive to prevent configuration errors.\n- **Element Dependency**: If the script detects it is associated with a specific timber element, deleting that timber element will automatically delete this anchor instance as well.\n- **Geometry Visibility**: Depending on the configuration passed from the parent script, the Washer and Nut geometry may be hidden, showing only the threaded rod.\n\n## FAQ\n- **Q: Can I insert this anchor separately for a specific detail?**\n  A: No, this script currently blocks manual insertion. You must use the parent connection tool that manages the overall assembly to generate this anchor.\n- **Q: Why did the anchor disappear when I deleted the beam?**\n  A: The script establishes a dependency link to the host element. Removing the host element triggers the automatic deletion of the attached hardware.\n- **Q: How do I change the anchor size?**\n  A: If the property is not locked, select the anchor instance and change the \"Anchor type\" in the Properties Palette. If it is locked, you must modify the settings in the parent connection script that inserted it."
      },
      "tokens_used": 4694,
      "error": null
    }
  }
}