{
  "filename": "NA_WallSheathing.mcr",
  "status": "completed",
  "total_tokens": 57810,
  "processing_time": 524.3608388900757,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": [
          "NA_SheetBreakBacking"
        ]
      },
      "tokens_used": 7895,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script manipulates hsbCAD Element and Wall objects, assigns ElemZones, and creates Sheet entities via dbCreate. It interacts with 3D geometry (PlaneProfile, CoordSys, Vector3d) to generate and split sheathing panels. The logic includes a `_bOnInsert` block that selects Wall entities from the model and clones TSL instances onto them. There are no references to Paper Space entities (_Viewport), ShopDrawing prefixes (sd_), or drawing views."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Wall",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space with hsbCAD Wall Elements.",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll (for material catalog)",
            "hsbCadNA.Wall.Sheathing.dll (for sheathing rules)",
            "NA_SheetBreakBacking.mcr (dependency script)"
          ]
        }
      },
      "tokens_used": 5943,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": \"Properties Palette\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"\\nSelect a set of elements\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getString\",\n        \"promptOriginal\": \"\\nSome walls do not have sheathing defined. Would you like to add sheathing to them? [Yes/No]\",\n        \"condition\": \"arElNoZone.length() > 0\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 1,\n      \"variable\": \"prTitle1\",\n      \"type\": \"PropString\",\n      \"displayName\": \"MATERIAL PROPERTIES\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": true\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"iUserZone\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Sheathing Zone\",\n      \"defaultValue\": \"1\",\n      \"inputType\": \"dropdown\",\n      \"options\": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": true\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"stNewSheathing\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Sheathing Material\",\n      \"defaultValue\": \"**Unchanged\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"**Unchanged\", \"Dynamic from Inventory\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dMinWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Minimum Width\",\n      \"defaultValue\": \"8 inch\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"prTitle2\",\n      \"type\": \"PropString\",\n      \"displayName\": \"DISTRIBUTION PROPERTIES\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": true\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"stSplitRule\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Sheathing Split Rule\",\n      \"defaultValue\": \"Full Sheets(Add Studs Where Needed)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Full Sheets(Add Studs Where Needed)\", \"Use Existing Studs Only\", \"Vertical Sheathing\", \"None Found\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"stDistribOrigin\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Distribution Origin\",\n      \"defaultValue\": \"Top Left\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Top Left\", \"Top Right\", \"Bottom Left\", \"Bottom Right\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"stFirstFull\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Keep First Sheet Full\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Yes\", \"No\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"stLastFull\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Keep Last Sheet Full\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Yes\", \"No\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"prTitle3\",\n      \"type\": \"PropString\",\n      \"displayName\": \"EDGE OFFSET PROPERTIES\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": true\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"stApplyOffsets\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Apply Custom Offsets\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Yes\", \"No\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dOffTop\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Top Offset\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dOffBot\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Bottom Offset\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dOffLeft\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Left Offset\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dOffRight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Right Offset\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"prTitle4\",\n      \"type\": \"PropString\",\n      \"displayName\": \"FRAMING PROPERTIES\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": true\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"stSetStudDistrib\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Stud Distribution Control\",\n      \"defaultValue\": \"Auto\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Auto\", \"None\", \"Warn\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"stBreakAction\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Break Framing Actions\",\n      \"defaultValue\": \"2 Ply\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"None\", \"2 Ply\", \"3 Ply\", \"3x\", \"4x\"],\n      \"category\": null,\n      \"description\": null,\n      \"readOnly\": false\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"stAddBlocking\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Apply to Blocking\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\"Yes\", \"No"
      },
      "tokens_used": 10232,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates and applies structural sheathing panels (OSB/Plywood) to wood-framed walls, optimizing layout based on stud placement and defining edge blocking requirements.",
          "category": "Framing",
          "typicalUseCase": "Applying exterior sheathing to wall panels after framing is complete but before manufacturing or shop drawings are finalized."
        },
        "parameters": [
          {
            "name": "iUserZone",
            "technicalDefault": "1",
            "businessMeaning": "Identifies which layer of the wall assembly to apply sheathing to (e.g., interior skin vs. exterior skin).",
            "validRange": "1-10 (Integer)",
            "unit": "Index",
            "affectsOutput": "Determines which ElementZone geometry and offset calculations are used for sheet placement."
          },
          {
            "name": "stNewSheathing",
            "technicalDefault": "**Unchanged",
            "businessMeaning": "Selects the specific sheathing material grade and size (e.g., 7/16 OSB, 1/2 Plywood) from the inventory catalog.",
            "validRange": "Inventory items (String)",
            "unit": "N/A",
            "affectsOutput": "Sets the thickness, material code, and default sheet dimensions (Width x Height) used for layout calculations."
          },
          {
            "name": "dMinWidth",
            "technicalDefault": "8 inch",
            "businessMeaning": "The smallest allowable width of a sheathing panel piece (rip cut) before the algorithm shifts the layout to avoid waste.",
            "validRange": "4 - 24 inches",
            "unit": "inch",
            "affectsOutput": "Controls the horizontal shifting of sheets to ensure no piece falls below this width."
          },
          {
            "name": "stSplitRule",
            "technicalDefault": "Full Sheets(Add Studs Where Needed)",
            "businessMeaning": "Defines the layout strategy: whether to prioritize full sheets (adding framing studs to support seams) or fit sheets between existing studs.",
            "validRange": "Predefined Options",
            "unit": "N/A",
            "affectsOutput": "Determines if new studs are added and how the sheets are positioned relative to the wall grid."
          },
          {
            "name": "stDistribOrigin",
            "technicalDefault": "Top Left",
            "businessMeaning": "The corner of the wall where the sheathing layout grid begins.",
            "validRange": "Top Left, Top Right, Bottom Left, Bottom Right",
            "unit": "N/A",
            "affectsOutput": "Determines the starting point for the first sheet, affecting where seams occur along the wall."
          },
          {
            "name": "stFirstFull",
            "technicalDefault": "Yes",
            "businessMeaning": "Forces the first sheet in a row to be a full-sized panel (4x8 or similar) rather than a cut piece.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "If Yes, offsets the layout so the start of the wall aligns with a full sheet edge."
          },
          {
            "name": "stLastFull",
            "technicalDefault": "Yes",
            "businessMeaning": "Forces the last sheet in a row to be a full-sized panel rather than a cut piece.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "If Yes, shifts the layout so the end of the wall aligns with a full sheet edge."
          },
          {
            "name": "stApplyOffsets",
            "technicalDefault": "No",
            "businessMeaning": "Global toggle to apply custom edge setbacks to the sheathing area.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "Enables or disables the Top, Bottom, Left, and Right offset parameters during layout."
          },
          {
            "name": "dOffTop",
            "technicalDefault": "0",
            "businessMeaning": "Vertical distance from the top of the wall to the top edge of the sheathing.",
            "validRange": "0 - Wall Height inches",
            "unit": "inch",
            "affectsOutput": "Reduces the vertical coverage area of the sheathing."
          },
          {
            "name": "dOffBot",
            "technicalDefault": "0",
            "businessMeaning": "Vertical distance from the bottom of the wall (sole plate) to the bottom edge of the sheathing.",
            "validRange": "0 - Wall Height inches",
            "unit": "inch",
            "affectsOutput": "Reduces the vertical coverage area (e.g., for brick ledges)."
          },
          {
            "name": "dOffLeft",
            "technicalDefault": "0",
            "businessMeaning": "Horizontal distance from the left edge of the wall to the left edge of the sheathing.",
            "validRange": "0 - Wall Width inches",
            "unit": "inch",
            "affectsOutput": "Reduces the horizontal coverage area."
          },
          {
            "name": "dOffRight",
            "technicalDefault": "0",
            "businessMeaning": "Horizontal distance from the right edge of the wall to the right edge of the sheathing.",
            "validRange": "0 - Wall Width inches",
            "unit": "inch",
            "affectsOutput": "Reduces the horizontal coverage area."
          },
          {
            "name": "stSetStudDistrib",
            "technicalDefault": "Auto",
            "businessMeaning": "Controls whether the script automatically adds or moves studs to optimize the sheathing layout.",
            "validRange": "Auto, None, Warn",
            "unit": "N/A",
            "affectsOutput": "Determines if 'Full Sheets' mode actually generates new framing members."
          },
          {
            "name": "stBreakAction",
            "technicalDefault": "2 Ply",
            "businessMeaning": "Specifies the configuration of backing/blocking members at horizontal sheathing seams (e.g., '2 Ply' means two studs back-to-back to provide nailing surface).",
            "validRange": "None, 2 Ply, 3 Ply, 3x, 4x",
            "unit": "N/A",
            "affectsOutput": "Sends data to the slave script to create blocking/studs at sheet joints."
          },
          {
            "name": "stAddBlocking",
            "technicalDefault": "Yes",
            "businessMeaning": "Determines if the specified Break Action (blocking) should be applied to wall blocking entities in addition to studs.",
            "validRange": "Yes, No",
            "unit": "N/A",
            "affectsOutput": "Extends the backing generation logic to wall blocking members."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "stApplyOffsets == 'No'",
            "effect": "Top, Bottom, Left, and Right offset values are ignored.",
            "cascade": [
              "dOffTop",
              "dOffBot",
              "dOffLeft",
              "dOffRight"
            ]
          },
          {
            "trigger": "stSplitRule == 'Use Existing Studs Only'",
            "effect": "Sheathing layout is constrained to land seams on current stud centers, potentially increasing waste. 'stSetStudDistrib' is effectively ignored.",
            "cascade": [
              "stSetStudDistrib"
            ]
          },
          {
            "trigger": "stNewSheathing selection",
            "effect": "Updates the internal width and height variables used to calculate the grid layout.",
            "cascade": [
              "dMinWidth",
              "stDistribOrigin"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet",
            "description": "Rectangular panels representing the cut sheathing pieces (e.g., OSB/Plywood) assigned to the wall.",
            "appliedTo": "Selected Wall Elements (within the specified Zone)."
          },
          {
            "type": "TslInst (NA_SheetBreakBacking)",
            "description": "A slave script instance responsible for adding framing members (studs/blocking) at sheathing seams.",
            "appliedTo": "Selected Wall Elements."
          }
        ]
      },
      "tokens_used": 11366,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution begins; initialize variables and check Map dependency for sheathing inventory (moSheathingInv).",
          "Load sheathing inventory from hsbFramingDefaults.Inventory.dll if invalid or 'Update sheathing selection from defaults editor' is triggered.",
          "Define Properties Palette parameters (Material, Distribution, Offsets, Framing) using PropDouble/PropInt/PropString.",
          "Check execution context: Is script being inserted or is the element list modified (_bOnInsert || _bOnElementListModified)?",
          "[If Inserting] Display Properties Dialog (showDialog) to allow user to adjust parameters before selection.",
          "[If Inserting] Prompt user to select a set of Wall Elements (PrEntity).",
          "[If Inserting] Iterate through selected entities: Filter for Walls; check if the specified User Zone exists (thickness > 0).",
          "[If Inserting] If valid Walls have no Zone definition, ask user via command line (getString) to add sheathing zone to them.",
          "[If Inserting] For Walls needing Zone: Apply default material/thickness from inventory or 'Unchanged' settings.",
          "[If Inserting] Clone the current script instance onto each valid Wall Element using dbCreate.",
          "[If Inserting] Erase the original master script instance and return (execution transfers to cloned instances).",
          "[Cloned Instance Execution] Restore properties from the Map passed during cloning.",
          "[Cloned Instance Execution] Validate associated Element: If invalid or not a Stickframe Wall, report error and erase instance.",
          "[Cloned Instance Execution] Check for duplicate TSL instances on the same element; erase other instances of this script or 'KT_CreateMultipleStuds'.",
          "[Cloned Instance Execution] Retrieve Element geometry (CoordSys, openings, zone data).",
          "[Cloned Instance Execution] Determine layout strategy based on Split Rule (Vertical vs Horizontal) and Offsets.",
          "[Cloned Instance Execution] Generate the initial PlaneProfile for the sheathing area, applying Top/Bottom/Left/Right offsets if enabled.",
          "[Cloned Instance Execution] Calculate grid lines for sheathing sheets based on Sheet dimensions, Minimum Width, and Full Sheet constraints.",
          "[Cloned Instance Execution] Calculate Start/End points. Adjust for 'Keep First/Last Sheet Full' rules to avoid small rips.",
          "[Cloned Instance Execution] Split the initial sheathing profile using calculated vertical and horizontal grid planes.",
          "[Cloned Instance Execution] Create Sheet entities from the split profiles. Assign Material, Grade, Color, and Element Group.",
          "[Cloned Instance Execution] Insert Slave script (NA_SheetBreakBacking) if Break Actions are required, passing seam locations.",
          "Script finishes."
        ],
        "conditionalBranches": [
          {
            "condition": "User selected Walls that lack the specific Sheathing Zone (Zone thickness == 0) during insertion.",
            "path1": {
              "name": "Add Sheathing Zone",
              "steps": [
                "Prompt user: 'Some walls do not have sheathing defined... [Yes/No]'",
                "If Yes: Create ElemZone with selected material/thickness.",
                "Assign new Zone to the Wall.",
                "Include Wall in the list for TSL cloning."
              ]
            },
            "path2": {
              "name": "Skip Walls",
              "steps": [
                "Ignore Walls missing the Zone.",
                "Proceed to clone TSL only on valid Walls."
              ]
            }
          },
          {
            "condition": "Sheathing Split Rule selection.",
            "path1": {
              "name": "Vertical Sheathing",
              "steps": [
                "Layout logic runs vertical strips (sheets rotated 90 deg).",
                "Optimization logic focuses on vertical cuts."
              ]
            },
            "path2": {
              "name": "Full Sheets / Existing Studs",
              "steps": [
                "Layout logic runs horizontal courses.",
                "Calculates vertical grid lines based on stud spacing or full sheet width.",
                "Calculates horizontal grid lines based on sheet height."
              ]
            }
          },
          {
            "condition": "Apply Custom Offsets setting.",
            "path1": {
              "name": "Yes",
              "steps": [
                "Read dOffTop, dOffBot, dOffLeft, dOffRight.",
                "Shrink the effective sheathing PlaneProfile by these amounts."
              ]
            },
            "path2": {
              "name": "No",
              "steps": [
                "Use the full Element Zone boundary for sheathing.",
                "Ignore offset property values."
              ]
            }
          },
          {
            "condition": "Keep First/Last Sheet Full settings combined with available wall length.",
            "path1": {
              "name": "Force Full Sheet",
              "steps": [
                "Calculate if wall length allows full sheet + min width.",
                "Shift grid start/end points to ensure full sheet coverage at edge.",
                "Create cut pieces (rips) in the interior or opposite end if necessary."
              ]
            },
            "path2": {
              "name": "Standard Layout",
              "steps": [
                "Start layout at wall edge (Distribution Origin).",
                "Allow sheet to be cut at start or end if it falls below Min Width thresholds."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Sheathing Inventory loading from hsbFramingDefaults.Inventory.dll.",
            "errorMessage": "\nCould not load sheathing inventory from defaults editor",
            "recovery": "Check installation path and company defaults configuration."
          },
          {
            "check": "Element validity after cloning.",
            "errorMessage": "\nNot a proper Stickframe Element",
            "recovery": "Script erases itself. User must select a valid Wall element."
          },
          {
            "check": "Minimum Width calculation during layout.",
            "errorMessage": "N/A (Logic prevents creation of sheets smaller than dMinWidth).",
            "recovery": "Script automatically shifts grid or shrinks sheet size to meet minimum width constraints; no user intervention required during execution."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Update Sheathing Parameters",
            "how": "Properties Palette (OPM) / Context Menu 'Update sheathing selection from defaults editor'",
            "effect": "Changing Material, Offsets, Split Rules, or Distribution Origin triggers a recalculation of sheet sizes and positions."
          },
          {
            "action": "Adjust Stud Distribution",
            "how": "Properties Palette 'Stud Distribution Control' (Auto/None/Warn)",
            "effect": "Affects how the slave script (NA_SheetBreakBacking) interacts with the wall framing, potentially adding or moving studs to support sheathing seams."
          },
          {
            "action": "Modify Blocking Configuration",
            "how": "Properties Palette 'Break Framing Actions' and 'Apply to Blocking'",
            "effect": "Updates the slave script to change the configuration (e.g., 2 Ply vs 3x) of backing members at sheathing joints."
          }
        ]
      },
      "tokens_used": 12545,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# NA_WallSheathing.mcr\n\n## Overview\nGenerates and applies structural sheathing panels (such as OSB or Plywood) to wood-framed walls. It optimizes the layout to minimize waste, calculates cut sizes, and automatically defines edge blocking or stud requirements at seams.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D Wall Elements. |\n| Paper Space | No | Does not function in 2D drawing layouts. |\n| Shop Drawing | No | Not intended for creating view labels or dimensions. |\n\n## Prerequisites\n- **Required Entities**: hsbCAD Wall Elements (Stickframe type).\n- **Minimum Beams**: None (Script selects Wall Elements).\n- **Required Settings**:\n    - `hsbFramingDefaults.Inventory.dll` (For material catalog and dimensions).\n    - `hsbCadNA.Wall.Sheathing.dll` (For calculation rules).\n    - `NA_SheetBreakBacking.mcr` (Slave script for generating backing/framing).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse to and select `NA_WallSheathing.mcr`.\n\n### Step 2: Configure Parameters\nAction: The Properties Palette will appear automatically upon insertion. Adjust settings such as **Sheathing Material**, **Split Rule**, and **Offsets** if necessary before selecting walls.\n\n### Step 3: Select Walls\n```\nCommand Line: Select a set of elements\nAction: Click on the Wall Elements in the model you wish to apply sheathing to. Press Enter when finished.\n```\n\n### Step 4: Resolve Missing Zones\nIf selected walls do not have a sheathing layer defined in their construction:\n```\nCommand Line: Some walls do not have sheathing defined. Would you like to add sheathing to them? [Yes/No]\nAction: Type 'Yes' to automatically create the sheathing zone with default settings, or 'No' to skip those walls.\n```\n\n## Properties Panel Parameters\n\n### MATERIAL PROPERTIES\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Sheathing Zone | Integer | 1 | Selects which layer of the wall assembly to apply sheathing to (Index 1-10). |\n| Sheathing Material | String | **Unchanged** | Select the specific material grade (e.g., 7/16 OSB) from the inventory. Set to \"**Unchanged**\" to use existing settings. |\n\n### DISTRIBUTION PROPERTIES\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Minimum Width | Double | 8 inch | The smallest allowable width for a cut piece (rip). The layout will shift to avoid creating pieces smaller than this. |\n| Sheathing Split Rule | String | Full Sheets... | Strategy for layout: \"Full Sheets (Add Studs Where Needed)\", \"Use Existing Studs Only\", or \"Vertical Sheathing\". |\n| Distribution Origin | String | Top Left | The corner of the wall where the sheathing layout starts (Top Left, Top Right, Bottom Left, Bottom Right). |\n| Keep First Sheet Full | String | Yes | Forces the first sheet in the row to be a full-size panel (4x8) rather than a cut piece. |\n| Keep Last Sheet Full | String | Yes | Forces the last sheet in the row to be a full-size panel rather than a cut piece. |\n\n### EDGE OFFSET PROPERTIES\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Apply Custom Offsets | String | No | Global toggle to enable custom edge setbacks. |\n| Top Offset | Double | 0 | Distance from the top of the wall to the top edge of the sheathing. |\n| Bottom Offset | Double | 0 | Distance from the bottom of the wall to the bottom edge of the sheathing. |\n| Left Offset | Double | 0 | Distance from the left edge of the wall to the sheathing. |\n| Right Offset | Double | 0 | Distance from the right edge of the wall to the sheathing. |\n\n### FRAMING PROPERTIES\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Stud Distribution Control | String | Auto | Controls if the script adds/moves studs to support sheathing seams (\"Auto\", \"None\", or \"Warn\"). |\n| Break Framing Actions | String | 2 Ply | Configures blocking/studs at horizontal seams (e.g., \"2 Ply\" adds two studs back-to-back). |\n| Apply to Blocking | String | Yes | Applies the Break Action configuration to wall blocking entities as well as studs. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Update sheathing selection from defaults editor | Reloads the available sheathing materials and properties from the company defaults configuration file. |\n\n## Settings Files\n- **Filename**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: Company or Install path (defined in hsbCAD configuration).\n- **Purpose**: Provides the catalog of available sheathing materials, their dimensions (Width/Height), and thickness.\n\n- **Filename**: `NA_SheetBreakBacking.mcr`\n- **Location**: TSL Scripts folder.\n- **Purpose**: A dependency script that inserts the actual framing members (studs/blocking) required at sheathing seams based on the \"Break Framing Actions\" setting.\n\n## Tips\n- **Avoiding Waste**: Enable \"Keep First Sheet Full\" and \"Keep Last Sheet Full\" to prevent small, unusable rip cuts at the ends of walls. This is useful for shipping full panels to the job site.\n- **Handling Ledges**: If you have a brick ledge at the bottom of the wall, use \"Apply Custom Offsets\" -> \"Yes\" and set the \"Bottom Offset\" to the height of the ledge (e.g., 10.5 inches).\n- **Vertical vs. Horizontal**: If sheathing needs to run vertically (e.g., for specific nailing patterns or aesthetic lines), change the \"Sheathing Split Rule\" to \"Vertical Sheathing\".\n\n## FAQ\n- **Q: Why did the script instance disappear immediately after I selected the walls?**\n  A: The script likely detected that the selected element was not a valid Stickframe Wall or the Element Zone thickness was invalid. Check that you are selecting standard wood frame walls.\n\n- **Q: How do I change the standard sheet size (e.g., from 4x8 to 4x9)?**\n  A: This is controlled by the material definition in the Inventory (`hsbFramingDefaults.Inventory.dll`). Select \"Dynamic from Inventory\" in the Sheathing Material property and choose a material code that corresponds to the 4x9 size.\n\n- **Q: The script is adding extra studs I don't want.**\n  A: Change the \"Stud Distribution Control\" property to \"None\" or \"Warn\". Ensure \"Sheathing Split Rule\" is set to \"Use Existing Studs Only\" if you do not want the layout to drive framing changes."
      },
      "tokens_used": 9829,
      "error": null
    }
  }
}