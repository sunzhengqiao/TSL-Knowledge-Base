{
  "filename": "hsb_SetLogSidingProfile.mcr",
  "status": "completed",
  "total_tokens": 22619,
  "processing_time": 181.5467290878296,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2609,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates on ElementWallSF entities found in the model via PrEntity selection, and modifies GenBeam properties (ExtrProfile, Grade, Material). It does not use _Viewport or _kPaperSpace, nor does it have the sd_ prefix characteristic of shop drawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing ElementWallSF with a specific zone code 'HSB-PL14'.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1900,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strProfile",
            "type": "PropString",
            "displayName": "Extrusion profile name",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "stGrade",
            "type": "PropString",
            "displayName": "Grade",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "stMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2776,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically assigns specific extrusion profiles, timber grades, and materials to the 'HSB-PL14' zone (Log Siding) of selected wall elements.",
          "category": "Finishing/Prefab Configuration",
          "typicalUseCase": "Used during wall generation to ensure that the log siding layer of a wall is instantly populated with the correct timber profile and material specifications without manual selection."
        },
        "parameters": [
          {
            "name": "strProfile",
            "technicalDefault": "ExtrProfile().getAllEntryNames().sorted()",
            "businessMeaning": "The specific cross-sectional shape or 'log' profile to be applied to the siding beams (e.g., a specific rounded or profiled board shape).",
            "validRange": "Must match an existing entry name in the hsbCAD Extrusion Profile catalog.",
            "unit": "N/A (Profile Name)",
            "affectsOutput": "Changes the geometry, width, height, and 3D representation of the beams in the specific wall zone."
          },
          {
            "name": "stGrade",
            "technicalDefault": "\"\"",
            "businessMeaning": "The structural quality grade of the timber used for the siding (e.g., C24, GL24h).",
            "validRange": "Standard timber grading codes relevant to the project region (e.g., C14, C24, Sawn, Stud).",
            "unit": "N/A (Text String)",
            "affectsOutput": "Updates the engineering properties and potentially the labeling/coding of the beams for structural calculations."
          },
          {
            "name": "stMaterial",
            "technicalDefault": "\"\"",
            "businessMeaning": "The wood species or material type (e.g., Spruce, Pine, Larch).",
            "validRange": "Valid material codes defined in the timber construction database.",
            "unit": "N/A (Text String)",
            "affectsOutput": "Updates the material properties, weight calculations, and surface textures of the siding beams."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Element Generation",
            "effect": "The script scans the selected wall for a specific Zone Code ('HSB-PL14'). If found, it applies these parameters to the beams within that zone.",
            "cascade": [
              "GenBeam.ExtrProfile",
              "GenBeam.Grade",
              "GenBeam.Material"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam (Modified)",
            "description": "Existing beams within the 'HSB-PL14' zone are updated; no new geometry is created, but properties of existing beams are overwritten.",
            "appliedTo": "ElementWallSF (specifically beams located in Zone index matching code 'HSB-PL14')"
          }
        ]
      },
      "tokens_used": 5090,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script starts; checks if run during insertion (_bOnInsert).",
          "If inserting: Validates insertion cycle (if count > 1, erases instance and exits).",
          "Prompts user to select a set of ElementWallSF entities via PrEntity.",
          "Iterates through selected elements.",
          "For each element, creates a new script instance attached to that element, passing current OPM properties (Profile, Grade, Material) and a flag (bDoExecute=TRUE).",
          "The original insertion instance is erased.",
          "[New Instance Start] Validates that exactly one ElementWallSF is attached. If not, reports error and erases instance.",
          "Checks if element is valid; if not, reports error and erases instance.",
          "Scans the element for existing instances of this script and deletes any duplicates/old instances.",
          "Draws script name and coordinate system at element origin for debugging/visualization.",
          "Determines execution trigger: Sets 'bDoExecute' to TRUE if triggered by element construction OR passed via Map from insertion logic.",
          "If 'bDoExecute' is FALSE, script exits without processing.",
          "Checks Map for an execution 'Key' (used for programmatic updates).",
          "Determines target Profile string: Uses 'Key' if present, otherwise uses OPM property 'strProfile'.",
          "Scans element zones (indices -5 to 5) to find the zone with code 'HSB-PL14'.",
          "If 'HSB-PL14' zone is found, retrieves all GenBeams in that zone.",
          "Iterates through beams and sets their ExtrProfile, Grade, and Material to the specified values.",
          "If 'HSB-PL14' zone is not found, erases the script instance and exits."
        ],
        "conditionalBranches": [
          {
            "condition": "Check Insertion Cycle",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase instance",
                "Exit script"
              ]
            },
            "path2": {
              "name": "Cycle = 1",
              "steps": [
                "Proceed to Entity Selection"
              ]
            }
          },
          {
            "condition": "User Selects Elements (Insertion)",
            "path1": {
              "name": "Selection Successful",
              "steps": [
                "Loop through selected elements",
                "Spawn new instances",
                "Erase original instance"
              ]
            },
            "path2": {
              "name": "Selection Cancelled/Empty",
              "steps": [
                "Erase original instance",
                "Exit script"
              ]
            }
          },
          {
            "condition": "Validation of Attached Element (Runtime)",
            "path1": {
              "name": "Valid Count (1) and Element",
              "steps": [
                "Continue to cleanup and execution logic"
              ]
            },
            "path2": {
              "name": "Invalid Count or Entity",
              "steps": [
                "Report Error Message",
                "Erase instance",
                "Exit script"
              ]
            }
          },
          {
            "condition": "Execution Trigger Check",
            "path1": {
              "name": "Execute (Element Constructed OR Map Flag)",
              "steps": [
                "Proceed to Profile Logic"
              ]
            },
            "path2": {
              "name": "No Trigger",
              "steps": [
                "Exit script (Wait for trigger)"
              ]
            }
          },
          {
            "condition": "Zone Detection ('HSB-PL14')",
            "path1": {
              "name": "Zone Found",
              "steps": [
                "Get GenBeams in zone",
                "Update Properties (Profile, Grade, Material)"
              ]
            },
            "path2": {
              "name": "Zone Not Found",
              "steps": [
                "Erase instance",
                "Exit script"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insertion cycle count",
            "errorMessage": "None (Silent fail)",
            "recovery": "Script handles this automatically to prevent duplicate execution logic."
          },
          {
            "check": "Number of attached elements at runtime",
            "errorMessage": "Wrong number of elements",
            "recovery": "User must ensure script is attached to exactly one wall element; script self-destructs otherwise."
          },
          {
            "check": "Element validity (bIsValid)",
            "errorMessage": "Element not valid",
            "recovery": "User must ensure the wall element is not corrupted or deleted; script self-destructs."
          },
          {
            "check": "Presence of 'HSB-PL14' Zone Code",
            "errorMessage": "None (Silent fail)",
            "recovery": "The wall definition must include a zone with code 'HSB-PL14', or the script will remove itself."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Extrusion Profile, Grade, or Material",
            "how": "Properties Palette (OPM) - edit strProfile, stGrade, or stMaterial",
            "effect": "Script re-runs (likely via Recalc trigger or manual update), immediately updating the beams in the 'HSB-PL14' zone with the new values."
          },
          {
            "action": "Modify Wall Geometry",
            "how": "Grip edit or Wall Properties",
            "effect": "_bOnElementConstructed flag triggers; script scans for 'HSB-PL14' zone again and re-applies the current OPM settings to the new/modified beams."
          },
          {
            "action": "Change Zone Code",
            "how": "Wall Design / Zone Settings",
            "effect": "If 'HSB-PL14' is removed or renamed, the script erases itself. If added/re-added to another index, script finds it."
          }
        ]
      },
      "tokens_used": 5182,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetLogSidingProfile.mcr\n\n## Overview\nThis script automatically applies specific extrusion profiles, timber grades, and materials to the 'HSB-PL14' zone (Log Siding) within selected wall elements, ensuring consistent detailing for log siding layers.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Operates on selected `ElementWallSF` entities. |\n| Paper Space | No | Not applicable for 2D drawings. |\n| Shop Drawing | No | Intended for 3D model configuration. |\n\n## Prerequisites\n- **Required Entities**: Walls (`ElementWallSF`) must exist in the model.\n- **Zone Requirement**: The selected walls must contain a zone with the code **'HSB-PL14'**. If this zone is missing, the script will delete itself from the wall.\n- **Minimum Beams**: None (script targets specific zones within the wall).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `hsb_SetLogSidingProfile.mcr`\n\n### Step 2: Select Walls\n```\nCommand Line: Select a set of elements\nAction: Click on the wall(s) you wish to configure and press Enter.\n```\n*Note: The script will attach itself to the selected walls and immediately update the 'HSB-PL14' zone if found.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Extrusion profile name | Dropdown | (Empty) | Select the desired log profile shape from the catalog. This determines the geometry of the siding. |\n| Grade | Text | (Empty) | Enter the structural grade of the timber (e.g., C24, GL24h). |\n| Material | Text | (Empty) | Enter the wood species or material code (e.g., Spruce, Pine). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu items are defined for this script. Use the Properties Palette to make changes. |\n\n## Settings Files\n- **None required**: This script relies on the standard hsbCAD Extrusion Profile catalog and does not require external XML settings files.\n\n## Tips\n- **Zone Code is Critical**: Ensure your wall style or design includes a layer/zone explicitly named `HSB-PL14`. If you rename this zone in the wall properties, the script will stop working and remove itself.\n- **Batch Updates**: You can select multiple walls during the insertion step to apply the same log siding settings to all of them simultaneously.\n- **Post-Insertion Editing**: After insertion, you can select the wall, open the **Properties (Ctrl+1)** palette, and change the Profile or Material. The script will automatically update the beams in the 'HSB-PL14' zone to match the new values.\n\n## FAQ\n- **Q: I ran the script, but I cannot see it attached to the wall anymore.**\n  - **A:** The script automatically removes itself if the selected wall does not contain the required zone code `HSB-PL14`. Check your wall layering/zone configuration.\n- **Q: How do I change the shape of the logs after the script is already applied?**\n  - **A:** Select the wall in the model, open the Properties Palette, find the \"Extrusion profile name\" property, and select a different profile from the dropdown list.\n- **Q: Can I use this for other wall zones?**\n  - **A:** No, this script is hard-coded to look specifically for the zone code `HSB-PL14`. For other zones, a different script or manual assignment is required."
      },
      "tokens_used": 5062,
      "error": null
    }
  }
}