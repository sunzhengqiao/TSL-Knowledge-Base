{
  "filename": "GE_BEAM_STRONG_BACK.mcr",
  "status": "completed",
  "total_tokens": 36906,
  "processing_time": 291.6332347393036,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.3",
            "date": "03.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Stickframe path added to mapIn when calling dll"
          },
          {
            "version": "1.2",
            "date": "15-may-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added"
          },
          {
            "version": "1.1",
            "date": "16-Apr-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Beams to create will now be chosen from inventory lumber items list\nUser has now the option to NOT frame vertical or horizontal beam\nThumbnail added"
          },
          {
            "version": "1.0",
            "date": "11-Apr-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5331,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates by selecting `Beam` entities via `PrEntity` and creating new `Beam` entities using `Beam.dbCreate()`. It performs geometric vector calculations and point inputs using `getPoint`, which are standard for 3D modeling. There is no usage of `sd_` prefixes, `_Viewport`, `#Type E` entities, or `Sheet` objects, confirming it is a Model Space generation script."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll (must be present in hsbCAD installation path)",
            "Valid Lumber Inventory items (accessed via dotNet interop)"
          ]
        }
      },
      "tokens_used": 5186,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\n|Select beam|(s)",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "\n|Insertion reference point|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "On Insert (via showDialogOnce)",
            "title": null,
            "dataSource": "TslUtilities.dll",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sHSize",
            "type": "PropString",
            "displayName": "|Horizontal beam|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "Inventory Items",
              "|None|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sVSize",
            "type": "PropString",
            "displayName": "|Vertical beam|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "Inventory Items",
              "|None|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sFlip",
            "type": "PropString",
            "displayName": "Flip side",
            "defaultValue": "|No|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "hsbFramingDefaults.Inventory.dll",
            "searchPaths": [
              "_kPathHsbInstall\\Utilities\\hsbFramingDefaultsEditor"
            ],
            "purpose": "Provides list of lumber inventory items for Horizontal and Vertical beam sizing.",
            "required": true
          }
        ]
      },
      "tokens_used": 5111,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates a structural strongback assembly (T-section or L-section) running parallel to selected joists to provide lateral stiffness and reduce deflection.\",\n    \"category\": \"Framing\",\n    \"typicalUseCase\": \"Reinforcing floor joists or roof rafters at mid-span by adding a continuous stiffening member.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sHSize\",\n      \"technicalDefault\": \"First inventory item\",\n      \"businessMeaning\": \"Defines the lumber dimensions for the horizontal member (the flange) of the strongback. This member lies flat, perpendicular to the joists.\",\n      \"validRange\": \"Any lumber item defined in the hsbFramingDefaults Inventory, or '|None|' to exclude this member.\",\n      \""
      },
      "tokens_used": 8257,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Initialize: Call DotNet function (hsbFramingDefaults.Inventory.dll) to retrieve available lumber items.",
          "2. Setup Properties: Populate 'Horizontal beam' and 'Vertical beam' dropdowns with inventory items plus a '|None|' option. Set 'Flip side' default.",
          "3. [Insertion] Open Dialog: Show properties dialog once if run from command palette.",
          "4. [Insertion] Select Beams: Prompt user to select Beam entities (supports multiple selection).",
          "5. [Insertion] Pick Point: Prompt user for an 'Insertion reference point' to define the strongback's lateral position.",
          "6. Process Selection: Filter invalid entities and sort the selected beams along their perpendicular axis.",
          "7. Validate Selection: Ensure at least one valid beam remains after filtering.",
          "8. [Conditional] Resolve Horizontal Beam: If property is not '|None|', retrieve width/height/material/grade from inventory. Validate data completeness.",
          "9. [Conditional] Resolve Vertical Beam: If property is not '|None|', retrieve width/height/material/grade from inventory. Validate data completeness.",
          "10. Calculate Geometry: Determine start/end points based on outermost beams. Project reference point to align the strongback.",
          "11. [Conditional] Apply Flip: If 'Flip side' is '|Yes|', invert the lateral offset vector.",
          "12. Validate Placement: Ensure the insertion point provides sufficient clearance for the beam cross-sections within the joist depth.",
          "13. [Conditional] Generate Horizontal Beam: Create GenBeam if 'bFrameH' is true. Apply dimensions, material, and type (87).",
          "14. [Conditional] Generate Vertical Beam: Create GenBeam if 'bFrameV' is true. Apply dimensions, material, and type (87).",
          "15. Cleanup: Erase the script instance (generator pattern)."
        ],
        "conditionalBranches": [
          {
            "condition": "Horizontal Beam Selection ('sHSize')",
            "path1": {
              "name": "Frame Horizontal",
              "steps": [
                "Lookup inventory index for selected item.",
                "Extract Width, Height, Material, Grade from mapOut.",
                "If Width/Height are 0, report error and exit.",
                "Calculate geometry for horizontal member.",
                "Create Beam entity."
              ]
            },
            "path2": {
              "name": "Do Not Frame ('|None|')",
              "steps": [
                "Set 'bFrameH' flag to false.",
                "Skip geometry calculation and creation for horizontal member."
              ]
            }
          },
          {
            "condition": "Vertical Beam Selection ('sVSize')",
            "path1": {
              "name": "Frame Vertical",
              "steps": [
                "Lookup inventory index for selected item.",
                "Extract Width, Height, Material, Grade from mapOut.",
                "If Width/Height are 0, report error and exit.",
                "Calculate geometry for vertical member.",
                "Create Beam entity."
              ]
            },
            "path2": {
              "name": "Do Not Frame ('|None|')",
              "steps": [
                "Set 'bFrameV' flag to false.",
                "Skip geometry calculation and creation for vertical member."
              ]
            }
          },
          {
            "condition": "Flip Side Property ('sFlip')",
            "path1": {
              "name": "Standard Side ('|No|')",
              "steps": [
                "Define offset vector 'vSide' based on local X axis of reference beam.",
                "Place vertical beam on the positive side of the horizontal beam."
              ]
            },
            "path2": {
              "name": "Flipped Side ('|Yes|')",
              "steps": [
                "Invert offset vector 'vSide'.",
                "Place vertical beam on the negative side of the horizontal beam."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Valid Beams Selected",
            "errorMessage": "|Not enough beams selected|",
            "recovery": "Select at least one valid beam entity before running the script."
          },
          {
            "check": "Beam Perpendicularity",
            "errorMessage": "|Not enough beams are perpendicular|",
            "recovery": "Ensure the selected joists/rafters are parallel to each other and oriented correctly for the sorting algorithm."
          },
          {
            "check": "Inventory Data Integrity",
            "errorMessage": "Data incomplete, check values on inventory for selected lumber item (Width/Height is 0)",
            "recovery": "Check hsbFramingDefaults Inventory configuration. Ensure selected lumber items have valid Width and Height."
          },
          {
            "check": "Spatial Clearances (Insertion Point)",
            "errorMessage": "|There is no room for these beams at this point|",
            "recovery": "The insertion point is too close to the edge of the joists or the combined width of the strongback exceeds the joist depth. Pick a different reference point or select smaller lumber sizes."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script Erases Self)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after creating the beams. It acts as a generator; the resulting beams are independent GenBeams and do not retain a link to the script for OPM updates."
          }
        ]
      },
      "tokens_used": 7811,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_STRONG_BACK.mcr\n\n## Overview\nThis script generates a structural strongback assembly (T-section or L-section) running parallel to selected joists or rafters. It is used to provide lateral stiffness and reduce deflection in floor or roof systems.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script creates 3D beam entities in the model. |\n| Paper Space | No | Not designed for layout or detailing views. |\n| Shop Drawing | No | Does not generate shop drawings directly. |\n\n## Prerequisites\n- **Required entities**: Existing Beam entities (joists or rafters) to which the strongback will be applied.\n- **Minimum beam count**: 1 (though typically used on multiple parallel beams).\n- **Required settings files**: `hsbFramingDefaults.Inventory.dll` (Must be present in the hsbCAD installation path).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_BEAM_STRONG_BACK.mcr`\n\n### Step 2: Configure Properties (Dialog)\nA dialog will appear automatically upon insertion.\n**Action**: Select the desired lumber sizes for the Horizontal and Vertical beams from the inventory list. You may also select `|None|` if you only wish to create one part of the assembly (e.g., only horizontal).\n\n### Step 3: Select Beams\n```\nCommand Line: |Select beam|(s)\nAction: Click to select the joists or rafters you want to reinforce. Press Enter to confirm selection.\n```\n\n### Step 4: Define Position\n```\nCommand Line: |Insertion reference point|\nAction: Click a point in the model space to define where the strongback attaches relative to the selected beams (e.g., on the side or at a specific depth).\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Horizontal beam** | Dropdown | First inventory item | Select the lumber size for the horizontal member (flange) from the inventory. Select `|None|` to omit this member. |\n| **Vertical beam** | Dropdown | First inventory item | Select the lumber size for the vertical member (web) from the inventory. Select `|None|` to omit this member. |\n| **Flip side** | Dropdown | \\|No\\| | Toggle between `\\|No\\|` and `\\|Yes\\|` to flip the strongback to the opposite side of the insertion point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script acts as a generator and erases itself after creating the beams. There are no persistent right-click menu options for the script instance. |\n\n## Settings Files\n- **Filename**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: `[hsbCAD Install Path]\\Utilities\\hsbFramingDefaultsEditor`\n- **Purpose**: This DLL provides the list of available lumber inventory items (Width, Height, Material, Grade) used to populate the dropdown menus for the horizontal and vertical beams.\n\n## Tips\n- **Insertion Point**: If you receive an error stating \"There is no room for these beams at this point,\" try picking a reference point deeper within the joist depth, or select smaller lumber sizes.\n- **Beam Orientation**: Ensure the beams you select are parallel to each other. The script calculates the strongback length based on the outermost perpendicular beams.\n- **Post-Processing**: The script erases itself after running. The resulting beams are standard GenBeams and can be edited individually using standard hsbCAD tools.\n\n## FAQ\n- **Q: Why did the script disappear after I picked the point?**\n  **A:** This is a \"generator\" script. Its purpose is to create the beam geometry and then remove itself from the drawing. The resulting strongback beams remain as independent objects.\n- **Q: I get an error \"Data incomplete, check values on inventory\".**\n  **A:** The lumber item you selected in the properties might be missing Width or Height data in your `hsbFramingDefaults`. Check your inventory configuration.\n- **Q: Can I create only a horizontal beam without the vertical part?**\n  **A:** Yes. Set the \"Vertical beam\" property to `|None|` in the properties or dialog before inserting."
      },
      "tokens_used": 5210,
      "error": null
    }
  }
}