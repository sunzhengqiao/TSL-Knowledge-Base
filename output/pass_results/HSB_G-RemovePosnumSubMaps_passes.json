{
  "filename": "HSB_G-RemovePosnumSubMaps.mcr",
  "status": "completed",
  "total_tokens": 10949,
  "processing_time": 275.06334233283997,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2335,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Entity arEnt[] = Group().collectEntities(true, Entity(), _kModelSpace);"
        },
        "prerequisites": {
          "requiredEntities": [
            "Entity"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 844,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1288,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Removes the 'Posnum' sub-map data from a selected group of entities, effectively clearing their position numbering attributes.",
          "category": "Data Management",
          "typicalUseCase": "Used to batch clear position numbers from a selection of elements to force re-numbering or clean up data before generating new shop drawings."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": []
      },
      "tokens_used": 1046,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches the script (typically while a group of elements is selected or active).",
          "Script collects all entities contained within the current Group/Selection in Model Space.",
          "Script iterates through the array of collected entities.",
          "For each entity, the 'Posnum' sub-map data is removed using ent.removeSubMap.",
          "Script executes eraseInstance() to delete its own instance from the drawing.",
          "Script terminates."
        ],
        "conditionalBranches": [],
        "validationRules": [],
        "postInsertionActions": []
      },
      "tokens_used": 2500,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-RemovePosnumSubMaps.mcr\n\n## Overview\nThis script clears the position numbering ('Posnum') sub-map data from all entities contained within the current selection or group. It is typically used to batch-reset position numbers to force a re-calculation or to clean up data before generating new shop drawings.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for entity processing. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not intended for 2D layouts. |\n\n## Prerequisites\n- **Required Entities**: A selection of entities (beams, walls, etc.) must be grouped or selected before running the script.\n- **Minimum Beam Count**: 0 (Works on any group size).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Prepare Selection\n1.  In the AutoCAD Model Space, select the timber elements or entities you wish to process.\n2.  Ensure these elements are recognized as a group or active selection set.\n\n### Step 2: Launch Script\n1.  Type `TSLINSERT` in the command line and press Enter.\n2.  Browse to and select `HSB_G-RemovePosnumSubMaps.mcr`.\n3.  The script will automatically execute on the selected group.\n4.  The script instance will self-delete immediately upon completion.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| *None* | - | - | This script has no user-editable properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific context menu options. |\n\n## Settings Files\n- **None**: This script does not use external settings files.\n\n## Tips\n- **Grouping**: Ensure your elements are correctly grouped before execution. If no group is detected, the script may not find any entities to process.\n- **Re-numbering**: Use this script before running an automatic numbering macro to ensure a clean slate for position numbers.\n- **Self-Cleaning**: This script automatically removes itself from the drawing after running; do not be alarmed if the script entity disappears immediately.\n\n## FAQ\n\n- **Q: Does this script delete my geometry?**\n  **A**: No. It only removes the specific \"Posnum\" data attached to the entities. The physical beams and elements remain unchanged.\n\n- **Q: How do I know it worked?**\n  **A**: You can verify by checking the properties of an element. The position number fields associated with that entity should be empty or reset.\n\n- **Q: Can I undo this action?**\n  **A**: Yes, you can use the standard AutoCAD `UNDO` command to restore the sub-map data if the script was run recently."
      },
      "tokens_used": 2936,
      "error": null
    }
  }
}