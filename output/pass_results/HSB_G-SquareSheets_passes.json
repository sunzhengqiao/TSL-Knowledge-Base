{
  "filename": "HSB_G-SquareSheets.mcr",
  "status": "completed",
  "total_tokens": 28899,
  "processing_time": 416.3259439468384,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "08.12.2016",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "08.12.2016",
            "author": "AS",
            "changes": "Add filter support."
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "HSB_G-FilterGenBeams"
        ]
      },
      "tokens_used": 4343,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script collects entities using 'Group().collectEntities(true, Sheet(), _kModelSpace);', explicitly targeting Model Space. There are no references to 'sd_', 'Multipage*', or '_Viewport', and no #Type E entity declarations found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "The script operates within the Model Space and requires that the TSL script 'HSB_G-FilterGenBeams' be loaded in the drawing to filter sheet entities.",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 2643,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sheetFilterDefinition",
            "type": "PropString",
            "displayName": "|Sheet filter|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "|Filters|",
            "description": "|Filter definition for sheets.||Use| HSB_G-FilterGenBeams |to define the filters|."
          },
          {
            "index": 1,
            "variable": "textDimensionStyle",
            "type": "PropString",
            "displayName": "|Dimension style|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [],
            "category": "|Visualisation|",
            "description": "|Sets the dimension style for the text.|"
          },
          {
            "index": 0,
            "variable": "textColor",
            "type": "PropInt",
            "displayName": "|Text color|",
            "defaultValue": "-1",
            "inputType": "number",
            "options": [],
            "category": "|Visualisation|",
            "description": "|Sets the color for the text.||The font type, font color and font size defined in this dimension style are used by default.|"
          },
          {
            "index": 0,
            "variable": "fontSize",
            "type": "PropDouble",
            "displayName": "|Text size|",
            "defaultValue": "-1",
            "inputType": "number",
            "options": [],
            "category": "|Visualisation|",
            "description": "|Sets the font size for the text.||The font size defined in the dimension is style is used if the font size is set to zero or less.|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Analyse sheets|",
            "handler": "|Analyse sheets|",
            "action": "Collects and filters sheet entities, calculates dimensions, sorts them, and updates sub-map data.",
            "alsoTriggeredBy": "Double-click"
          },
          {
            "menuItem": "|Clear data|",
            "handler": "|Clear data|",
            "action": "Removes sub-label 2 and sub-map 'SquareSheets' from collected sheet entities.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 4060,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Groups and tags sheet entities based on rounded dimensions, color, and material to assign position numbers for downstream listing or optimization.",
          "category": "Data Management / Organizing",
          "typicalUseCase": "Used to prepare a list of panels or sheets for production by identifying identical sizes and assigning a shared position number to them."
        },
        "parameters": [
          {
            "name": "sheetFilterDefinition",
            "technicalDefault": "",
            "businessMeaning": "The selection criteria used to determine which specific sheets in the model are included in the analysis and grouping process.",
            "validRange": "Any filter name defined in the 'HSB_G-FilterGenBeams' catalog.",
            "unit": "String",
            "affectsOutput": "Determines the set of sheets that will be tagged with the grouping SubMap. Sheets not matching the filter are ignored."
          },
          {
            "name": "textDimensionStyle",
            "technicalDefault": null,
            "businessMeaning": "The visual style (font, arrow style, etc.) applied to the text annotation reporting the analysis status.",
            "validRange": "Any valid dimension style name loaded in the drawing.",
            "unit": "String",
            "affectsOutput": "Affects only the visual appearance of the report text in the Model Space; does not change data or geometry."
          },
          {
            "name": "textColor",
            "technicalDefault": "-1",
            "businessMeaning": "The color of the summary text annotation displayed in the model (e.g., number of entities analyzed).",
            "validRange": "1-255 (AutoCAD Color Index), -1 (ByBlock/Default).",
            "unit": "Color Index",
            "affectsOutput": "Affects only the visual color of the report text in the Model Space."
          },
          {
            "name": "fontSize",
            "technicalDefault": "-1",
            "businessMeaning": "The height of the text annotation displayed in the model. If set to default or negative, the size defined in the text dimension style is used.",
            "validRange": "> 0 (e.g., 2.5mm, 5.0mm). 0 or negative uses style default.",
            "unit": "mm",
            "affectsOutput": "Affects only the visual scale of the report text in the Model Space."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing 'sheetFilterDefinition'",
            "effect": "Updates which sheets are collected and tagged. Requires re-running 'Analyse sheets' to update the data tags on the entities.",
            "cascade": [
              "Sheet collection",
              "Posnum assignment"
            ]
          },
          {
            "trigger": "Changing visual properties ('textDimensionStyle', 'textColor', 'fontSize')",
            "effect": "Updates the display of the annotation text immediately on recalculation.",
            "cascade": [
              "Model Space Annotation"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Annotation",
            "description": "A text display in Model Space showing the count of analyzed entities and the timestamp of the last analysis.",
            "appliedTo": "Model Space at the user-selected insertion point."
          },
          {
            "type": "Map Data (SubMap)",
            "description": "Invisible data attached to each sheet entity containing the calculated Position Number (Posnum) and grouping logic within a map named 'SquareSheets'.",
            "appliedTo": "Sheet entities that match the filter definition."
          }
        ]
      },
      "tokens_used": 5611,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 7887,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-SquareSheets.mcr\n\n## Overview\nThis script analyzes sheet entities in your model, groups them by rounded dimensions, color, and material, and assigns a position number to each group. It is used to organize panel data for production listings or optimization processes.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be inserted in Model Space. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not intended for shop drawing generation. |\n\n## Prerequisites\n- **Required Entities**: Sheets (Elements).\n- **Minimum Beam Count**: 0 (This script processes Sheets, not beams).\n- **Required Settings**: The script **HSB_G-FilterGenBeams** must be loaded in the drawing, and a filter definition must be configured within it to select the relevant sheets.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\n- Browse to the script location and select `HSB_G-SquareSheets.mcr`.\n\n### Step 2: Select Position\n```\nCommand Line: |Select a position|\nAction: Click in the Model Space to place the text report indicating the analysis results.\n```\n\n### Step 3: Configure and Analyze\n1. Select the inserted script instance.\n2. In the **Properties Palette**, set the **Sheet filter** to select the desired group of sheets.\n3. Right-click the script instance and select **Analyse sheets** (or Double-click the script instance) to run the calculation and tag the sheets.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Sheet filter | dropdown | (Empty) | Determines which sheets are analyzed. Select a filter name defined in the HSB_G-FilterGenBeams catalog. |\n| Dimension style | dropdown | (Standard) | Sets the visual style (font, arrows, etc.) for the on-screen text report. |\n| Text color | number | -1 | Sets the color of the text report. -1 uses the default color (ByBlock). |\n| Text size | number | -1 | Sets the height of the text report. A value of 0 or negative uses the size defined in the Dimension Style. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Analyse sheets | Runs the logic to collect sheets based on the filter, calculates their grouping, and assigns position numbers to the entities. |\n| Clear data | Removes the position number data and labels from all collected sheet entities. |\n\n## Settings Files\n- **Dependency**: `HSB_G-FilterGenBeams`\n- **Purpose**: This external script provides the filtering logic required to define which specific sheets in the model should be processed by this script.\n\n## Tips\n- **Initial State**: When first inserted, the script only displays a text cursor. You must run the \"Analyse sheets\" command to generate data.\n- **Filtering**: If no sheets are tagged, check your **Sheet filter** property. Ensure the corresponding filter exists and is active in the HSB_G-FilterGenBeams tool.\n- **Visual Feedback**: The text displayed in Model Space is just a report showing how many entities were analyzed. The actual data is stored invisibly on the sheets for use in lists or reports.\n\n## FAQ\n- **Q: I inserted the script, but nothing happened.**\n- **A:** You must right-click the script instance and select **Analyse sheets** (or double-click it) to trigger the calculation and tagging.\n- **Q: How does the script determine which sheets are identical?**\n- **A:** It compares sheets based on their rounded dimensions, color, and material properties to assign the same position number to identical items.\n- **Q: Can I change the text size of the report?**\n- **A:** Yes, use the **Text size** property in the palette, or set it to -1 to inherit the size from your chosen **Dimension style**."
      },
      "tokens_used": 4355,
      "error": null
    }
  }
}