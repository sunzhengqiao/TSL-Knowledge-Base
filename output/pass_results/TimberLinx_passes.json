{
  "filename": "TimberLinx.mcr",
  "status": "completed",
  "total_tokens": 49298,
  "processing_time": 701.2617917060852,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7202,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getBeam(), _Beam array, Drill, and Body classes. Uses coordinate system variables _Pt0, _X0, _Y0, _Z0. No sd_ prefix, no _Viewport usage, and no drawing view logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 7125,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select male beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getBeam",
              "promptOriginal": "Select female beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrEntity.go",
              "promptOriginal": "Select Additional Beams",
              "condition": "(prStrType == \"A475\") || (prStrType == \"AA675\") || (prStrType == \"AB675\")",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dOffL",
            "type": "PropDouble",
            "displayName": "Lateral offset",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dOffV",
            "type": "PropDouble",
            "displayName": "Vertical offset",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "iQty",
            "type": "PropInt",
            "displayName": "Quantity",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dSpacing",
            "type": "PropDouble",
            "displayName": "Spacing",
            "defaultValue": "U(2)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "prdAddLength",
            "type": "PropDouble",
            "displayName": "Allthread length (A475, A[A/B]675)",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "prStrType",
            "type": "PropString",
            "displayName": "Type",
            "defaultValue": "A095",
            "inputType": "dropdown",
            "options": [
              "A095",
              "A135",
              "A155",
              "A175",
              "A475",
              "AA675",
              "AB675",
              "B095",
              "B135",
              "B155",
              "B175"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "prStrSide",
            "type": "PropString",
            "displayName": "Side",
            "defaultValue": "Not Flipped",
            "inputType": "dropdown",
            "options": [
              "Not Flipped",
              "Flipped"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "prStrEndT",
            "type": "PropString",
            "displayName": "As end tool",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "prStrPar2Male",
            "type": "PropString",
            "displayName": "Direction",
            "defaultValue": "Perp Female",
            "inputType": "dropdown",
            "options": [
              "Perp Female",
              "Parallel Male",
              "Perp Male"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "prDrThr",
            "type": "PropString",
            "displayName": "Link Drill through",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "prPDrThr",
            "type": "PropString",
            "displayName": "Pipe Drill through",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Male",
              "Female",
              "Both"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "pr475Rot",
            "type": "PropString",
            "displayName": "A475, AA675 As B type?",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 8475,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates Timberlinx self-tapping timber connectors (Type A and B series), including necessary drilling for the connector tube, locking pins, and optional allthread.\",\n    \"category\": \"Hardware\",\n    \"typicalUseCase\": \"Connecting timber beams using Timberlinx hardware, typically for T-connections, splices, or right-angle joints, supporting both single and multi-beam configurations.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"dOffL\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Lateral (Longitudinal) Offset - shifts the connector position along the length of the beam from the calculated intersection point.\",\n      \"validRange\": \"-500 to 500\",\n      \"unit\": \"mm (or current unit)\",\n      \"affectsOutput\": \"Translates the entire drilling pattern (tube and pegs) along the beam's longitudinal axis.\"\n    },\n    {\n      \"name\": \"dOffV\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Vertical/Depth Offset - adjusts the depth of the connector engagement into the female beam relative to the standard face.\",\n      \"validRange\": \"-100 to 100\",\n      \"unit\": \"mm (or current unit)\",\n      \"affectsOutput\": \"Alters the depth of the drilled holes in the female beam, effectively pushing the connector further in or pulling it out.\"\n    },\n    {\n      \"name\": \"iQty\",\n      \"technicalDefault\": 1,\n      \"businessMeaning\": \"Quantity of connectors to place at the connection point.\",\n      \"validRange\": \"1, 2\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Replicates the drilling and hardware visualization pattern based on the defined spacing.\"\n    },\n    {\n      \"name\": \"dSpacing\",\n      \"technicalDefault\": \"U(2)\",\n      \"businessMeaning\": \"Center-to-center distance between multiple connectors.\",\n      \"validRange\": \"50 to 1000\",\n      \"unit\": \"mm (or current unit)\",\n      \"affectsOutput\": \"Determines the gap between duplicated connectors when Quantity > 1.\"\n    },\n    {\n      \"name\": \"prdAddLength\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Additional Allthread Length - increases the calculated length of the connector to accommodate longer allthread rods (specific to A475/675 types).\",\n      \"validRange\": \"0 to 500\",\n      \"unit\": \"mm (or current unit)\",\n      \"affectsOutput\": \"Increases the pipe length calculation and drilling depth for compatible types.\"\n    },\n    {\n      \"name\": \"prStrType\",\n      \"technicalDefault\": \"A095\",\n      \"businessMeaning\": \"Connector Model Selection - chooses the specific Timberlinx profile (determines length, geometry, and drill pattern).\",\n      \"validRange\": \"List Values\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Sets the center-to-center length, pipe length, drill diameter, and hole configuration. Enables specific multi-beam selection for 675 series.\"\n    },\n    {\n      \"name\": \"prStrSide\",\n      \"technicalDefault\": \"Not Flipped\",\n      \"businessMeaning\": \"Side/Mirroring - determines which side of the beam intersection the connector penetrates.\",\n      \"validRange\": \"List Values\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Mirrors the drill location across the beam's local Y-axis (e.g., left side vs right side of the face).\"\n    },\n    {\n      \"name\": \"prStrEndT\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Trim Male Beam - if Yes, cuts the male beam to terminate at the female beam face.\",\n      \"validRange\": \"List Values\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Adds a 'Cut' machining operation to the male beam at the intersection point.\"\n    },\n    {\n      \"name\": \"prStrPar2Male\",\n      \"technicalDefault\": \"Perp Female\",\n      \"businessMeaning\": \"Orientation - defines the angular relationship of the connector tube relative to the male beam.\",\n      \"validRange\": \"List Values\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Calculates the connector vector. 'Perp Female' connects through the face; 'Parallel/Perp Male' aligns along or perpendicular to the male beam axis.\"\n    },\n    {\n      \"name\": \""
      },
      "tokens_used": 10940,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 9633,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# TimberLinx.mcr\n\n## Overview\nGenerates Timberlinx self-tapping timber connectors (Type A and B series), including the necessary drilling for connector tubes, locking pins, and optional allthread for timber beam connections.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D beams in the model. |\n| Paper Space | No | Not designed for 2D layout views. |\n| Shop Drawing | No | Not a drawing generation script. |\n\n## Prerequisites\n- **Required entities**: 2 or more Timber Beams (`GenBeam`).\n- **Minimum beam count**: 2 (One Male, One Female).\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `TimberLinx.mcr`\n\n### Step 2: Select Male Beam\n```\nCommand Line: Select male beam\nAction: Click on the beam that will be inserted into the other beam (typically the intersecting beam).\n```\n\n### Step 3: Select Female Beam\n```\nCommand Line: Select female beam\nAction: Click on the beam that will receive the connector and the male beam.\n```\n\n### Step 4: Select Additional Beams (Conditional)\n```\nCommand Line: Select Additional Beams\nAction: If the selected connector Type is A475, AA675, or AB675, select any additional beams involved in the connection. Press Enter to finish selection.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | dropdown | A095 | Select the Timberlinx model (e.g., A095, A475, B095). This defines geometry and drill patterns. |\n| Side | dropdown | Not Flipped | Mirrors the connector to the opposite side of the beam intersection. |\n| Direction | dropdown | Perp Female | Sets the orientation of the connector tube relative to the beams (Perpendicular to Female, Parallel to Male, etc.). |\n| As end tool | dropdown | No | If \"Yes\", trims the Male beam to end at the Female beam face. |\n| Lateral offset | number | 0 | Shifts the connector position along the length of the beam. |\n| Vertical offset | number | 0 | Adjusts the depth of the connector engagement into the female beam. |\n| Quantity | number | 1 | Number of connectors to place at this location. |\n| Spacing | number | U(2) | Center-to-center distance between multiple connectors. |\n| Allthread length (A475, A[A/B]675) | number | 0 | Adds extra length to the connector for longer allthread rods. |\n| Link Drill through | dropdown | No | If \"Yes\", drills the locking pin hole all the way through. |\n| Pipe Drill through | dropdown | No | Drills the main connector tube through the Male, Female, or Both beams. |\n| A475, AA675 As B type? | dropdown | No | Toggles specific geometry behavior for A475/AA675 types to match B-type configuration. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None detected | No custom context menu options were found for this script. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Automatic Trimming**: Enable the **As end tool** property to \"Yes\" if you want the script to automatically cut the male beam to meet the female beam, rather than just drilling holes.\n- **Multiple Connectors**: Use the **Quantity** and **Spacing** properties to quickly arrays multiple connectors along a joint line.\n- **Orientation**: If the connector is facing the wrong way, change the **Side** property to \"Flipped\" or adjust the **Direction** property to change the angle calculation.\n\n## FAQ\n- **Q: How do I make the connector go parallel to the beam?**\n  - A: Change the **Direction** property to \"Parallel Male\". This aligns the connector tube along the length of the male beam.\n- **Q: Why can't I see the \"Select Additional Beams\" prompt?**\n  - A: This prompt only appears if the **Type** is set to \"A475\", \"AA675\", or \"AB675\". For other types, only two beams are required.\n- **Q: What does the \"Vertical offset\" do?**\n  - A: It moves the drill location deeper into or out of the female beam. Use this to adjust how deep the connector sits relative to the face."
      },
      "tokens_used": 5923,
      "error": null
    }
  }
}