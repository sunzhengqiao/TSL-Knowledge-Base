{
  "filename": "GE_BEAM_INFO_GET_SPECIFIC_DETAIL.mcr",
  "status": "completed",
  "total_tokens": 23933,
  "processing_time": 388.5694408416748,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.8",
            "date": "18-jul-2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail updated"
          },
          {
            "version": "1.7",
            "date": "19-mar-2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Renamed from GE_INFO_GET_BEAM_SPECIFIC_DETAIL to GE_BEAM_INFO_GET_SPECIFIC_DETAIL"
          },
          {
            "version": "1.6",
            "date": "10-aug-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail added"
          },
          {
            "version": "1.5",
            "date": "01-aug-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "1.4",
            "date": "31-may-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "1.3",
            "date": "31-jan-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "1.2",
            "date": "05-sep-2007",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "1.1",
            "date": "03-apr-2007",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "1.0",
            "date": "13-feb-2007",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4238,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Beam() entities directly from the model and accesses properties like bm.type() and bm.name(). It contains no 'sd_' prefixes, '_Viewport' checks, or '#Type E' entity declarations typical of Paper Space or Shop Drawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "The script must be run in a context where beams can be selected (Model Space).",
          "requiredSettings": []
        }
      },
      "tokens_used": 2051,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "select a set of other beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowNotice",
            "trigger": "After processing beam data",
            "title": null,
            "dataSource": "Loop through selected beams and gather properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "Information type",
            "defaultValue": "type",
            "inputType": "dropdown",
            "options": [
              "type",
              "module",
              "grade",
              "profile",
              "material",
              "label",
              "sublabel",
              "sublabel2",
              "beamcode",
              "information",
              "name",
              "posnumandtext",
              "layer",
              "hsbId"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2953,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Extracts and lists specific attribute information (such as Material, Grade, or Layer) for a user-selected group of beams.",
          "category": "Utility / Information",
          "typicalUseCase": "Auditing multiple beams to verify they share a specific property (e.g., checking if selected walls are all C24 grade) or viewing custom labels for a selection without opening individual properties."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "type",
            "businessMeaning": "The filter that determines which specific property attribute is queried and displayed for the selected beams (e.g., Material species, Structural Grade, or Layer name).",
            "validRange": "Restricted to specific valid hsbCAD beam attributes: type, module, grade, profile, material, label, sublabel, sublabel2, beamcode, information, name, posnumandtext, layer, hsbId.",
            "unit": "N/A (Text Selection)",
            "affectsOutput": "Alters the content of the text report displayed to the user. It selects which data column (beyond Beam ID and Type) appears in the final list."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Text Report (Notice)",
            "description": "A temporary text window displaying the Handle, Type, and the requested specific detail for every beam in the selection.",
            "appliedTo": "N/A (No geometry is created or modified; script instance is erased after reporting)."
          }
        ]
      },
      "tokens_used": 4452,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script insertion is triggered.",
          "Check if insertCycleCount > 1.",
          "If count > 1, erase instance and exit.",
          "Prompt user to 'select a set of other beams'.",
          "User selects beams and confirms.",
          "Check if the internal beam list (_Beam) is empty.",
          "If empty, erase instance and exit.",
          "Show Property Dialog (showDialogOnce) to allow selection of 'Information type' (sType).",
          "Script waits for user confirmation of properties (Recalculation).",
          "Verify internal beam list is still populated.",
          "Loop through each beam in the list.",
          "Check if current beam is valid (bIsValid).",
          "Extract Handle, Type name, and the specific property defined by sType.",
          "Compile extracted data into a formatted string.",
          "Display the final string in a Notice (reportNotice).",
          "Erase the script instance from the drawing."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert cycle count check during startup",
            "path1": {
              "name": "Immediate Exit",
              "steps": [
                "Check insertCycleCount > 1",
                "Erase instance",
                "Return (Stop execution)"
              ]
            },
            "path2": {
              "name": "Standard Execution",
              "steps": [
                "Check insertCycleCount <= 1",
                "Proceed to beam selection prompt"
              ]
            }
          },
          {
            "condition": "User provides no beam selection during PrEntity prompt",
            "path1": {
              "name": "Selection Failed",
              "steps": [
                "ssE.go() fails or returns 0 beams",
                "Erase instance",
                "Return (Stop execution)"
              ]
            },
            "path2": {
              "name": "Selection Successful",
              "steps": [
                "Populate _Beam array with selection",
                "Call showDialogOnce()"
              ]
            }
          },
          {
            "condition": "Validity of specific property string (sType)",
            "path1": {
              "name": "Invalid sType",
              "steps": [
                "sType not found in sarTypes array",
                "Append generic 'type number' text to report string"
              ]
            },
            "path2": {
              "name": "Valid sType",
              "steps": [
                "sType found in sarTypes array",
                "Append Handle, Type Name, and specific Detail (sType) to report string"
              ]
            }
          },
          {
            "condition": "Validity of specific beam entity in loop",
            "path1": {
              "name": "Invalid Beam",
              "steps": [
                "bm.bIsValid() returns false",
                "Skip processing for this specific beam index"
              ]
            },
            "path2": {
              "name": "Valid Beam",
              "steps": [
                "bm.bIsValid() returns true",
                "Process properties and append to string"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam selection count",
            "errorMessage": "None (script silently exits)",
            "recovery": "Re-run the script and ensure at least one beam is selected."
          },
          {
            "check": "Beam entity validity",
            "errorMessage": "None (invalid beams are skipped in the loop)",
            "recovery": "Ensure selected beams are not deleted or corrupted before the report generates."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 5111,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_INFO_GET_SPECIFIC_DETAIL\n\n## Overview\nThis script extracts and displays specific attribute information (such as Material, Grade, or Layer) for a user-selected group of beams in a text report. It allows you to quickly audit or compare properties across multiple elements without editing them.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates directly on beam entities in the model. |\n| Paper Space | No | Not designed for layout views or shop drawings. |\n| Shop Drawing | No | Not designed for shop drawing contexts. |\n\n## Prerequisites\n- **Required entities**: Generic Beams (`GenBeam`).\n- **Minimum beam count**: 1.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_BEAM_INFO_GET_SPECIFIC_DETAIL.mcr`\n\n### Step 2: Select Beams\n```\nCommand Line: select a set of other beams\nAction: Click on the beams you wish to analyze. You can select multiple beams using a window or crossing selection. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Information Type\nAfter selecting the beams, the script instance is created. You must select the specific data you want to view.\n```\nAction: Select the script instance (if not already selected) and open the Properties Palette (Ctrl+1). Locate the \"Information type\" parameter and choose the desired attribute (e.g., Material, Grade, Layer) from the dropdown list.\n```\n\n### Step 4: Generate Report\n```\nAction: The script will automatically process the selection once the property is set. A \"Notice\" window will appear displaying the Handle, Type, and the requested detail for each selected beam.\n```\n*(Note: The script instance erases itself automatically after displaying the report.)*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Information type | Dropdown | type | Determines which specific attribute is displayed in the final report. Options include: type, module, grade, profile, material, label, sublabel, sublabel2, beamcode, information, name, posnumandtext, layer, hsbId. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add custom context menu options. It runs primarily via the Properties Palette. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Batch Auditing**: Use this script to quickly verify that a specific group of walls (e.g., exterior walls) all share the same Material Grade or Layer by setting the \"Information type\" accordingly.\n- **Selection Flexibility**: You can use standard AutoCAD selection methods (Window, Crossing, Fence) during the beam selection prompt to grab many elements at once.\n- **Data Reference**: The \"Handle\" provided in the report helps you identify specific beams if you need to investigate them further in the model.\n\n## FAQ\n- **Q: The script disappeared after I ran it. Is that normal?**\n  - A: Yes. This is a utility script designed to query data and report it. It automatically erases its own instance from the drawing after displaying the information to keep your drawing clean.\n- **Q: What happens if I select zero beams?**\n  - A: If you do not select any beams and press Enter, the script will detect the empty selection and exit without displaying a report.\n- **Q: Can I use this to modify the beam properties?**\n  - A: No. This script is read-only. It only extracts and displays existing property values."
      },
      "tokens_used": 5128,
      "error": null
    }
  }
}