{
  "filename": "HSB_E-DetailName.mcr",
  "status": "completed",
  "total_tokens": 51632,
  "processing_time": 1112.266969203949,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8079,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script filename starts with 'HSB_E-', indicating an Element script. It uses `getElement()` to fetch an Element and performs 3D coordinate calculations using `el.coordSys()`, `el.zone()`, and `Plane` projections. It utilizes `Display` objects with `addHideDirection()` (vxEl, vyEl) to manage visibility in 3D views. No `_Viewport`, `Sheet`, or `sd_` prefixes characteristic of Paper Space or Shop Drawing scripts are present. While it sets `showInDxa(true)`, this implies visibility in exports/drawings derived from the model, not that the script itself operates within a Paper Space context."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "DimensionStyle"
          ]
        }
      },
      "tokens_used": 6008,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getElement\",\n        \"promptOriginal\": \"Select an element\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a positionNOTE: |Points are projected to element, projection is done perpendicular to element XY plane|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a point for the direction\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sSeperator01\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Detail\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"readonly\",\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sDetailName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Name\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"category\": \"Detail\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sDetailDescription\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Description\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"category\": \"Detail\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dDetailSize\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Size\",\n      \"defaultValue\": 500,\n      \"inputType\": \"number\",\n      \"category\": \"Detail\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dDetailDepth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Depth\",\n      \"defaultValue\": 500,\n      \"inputType\": \"number\",\n      \"category\": \"Detail\",\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"detailPrefix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Detail filename prefix\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"category\": \"Detail\",\n      \"description\": \"Sets the prefix for the filename. E.g. If the prefix is set to 'Det' and the detail name is '05', the file linked to it should be named 'Det05'.\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sSeperator02\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Position\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"readonly\",\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dxOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Offset, perpendicular to detail\",\n      \"defaultValue\": 100,\n      \"inputType\": \"number\",\n      \"category\": \"Position\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dy"
      },
      "tokens_used": 8845,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Places detail markers (labels/bubbles) on timber elements in the 3D model to indicate specific construction details, sections, or notes.\",\n    \"category\": \"Annotation/Documentation\",\n    \"typicalUseCase\": \"A designer needs to tag a specific wall or floor panel with a detail reference (e.g., 'Detail 1') that will be visible in 3D views and exported to drawings or schedules. The script ensures the text is always readable from the correct side of the element.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sDetailName\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The primary identifier for the detail (e.g., '1', 'A', 'Stair connection'). This text is drawn in the model and stored in the element's data for export.\",\n      \"validRange\": \"Alphanumeric string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Updates the text displayed in the model and the value written to the Element MapX data.\"\n    },\n    {\n      \"name\": \"sDetailDescription\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A secondary text field intended to provide more info about the detail. Note: Currently unused in drawing logic, only stored as a property.\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"No visual effect in the current version; only modifies the Property Palette.\"\n    },\n    {\n      \"name\": \"dDetailSize\",\n      \"technicalDefault\": \"500\",\n      \"businessMeaning\": \"The physical size of the rectangular marker drawn in the model, representing the 'bubble' or tag size.\",\n      \"validRange\": \"100 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Scales the width and height of the rectangular marker polyline.\"\n    },\n    {\n      \"name\": \"dDetailDepth\",\n      \"technicalDefault\": \"500\",\n      \"businessMeaning\": \"Currently unused in the script logic. Likely reserved for future functionality or marker extrusion depth.\",\n      \"validRange\": \"N/A\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"None.\"\n    },\n    {\n      \"name\": \"detailPrefix\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A prefix added to the detail name for file linking (e.g., if prefix is 'Det' and name is '1', the linked file is expected to be 'Det1').\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Modifies the string stored in the Element MapX, but does not change the visual text on screen.\"\n    },\n    {\n      \"name\": \"sDetailPosition\",\n      \"technicalDefault\": \"On detail line\",\n      \"businessMeaning\": \"Determines how the marker is constrained. 'On detail line' snaps to the line defined by insertion; 'Element middle' snaps to the center of the wall; 'Free' allows floating.\",\n      \"validRange\": \"List: On detail line, Element middle, Free\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Constrains the anchor point (_Pt0) of the detail marker relative to the element geometry.\"\n    },\n    {\n      \"name\": \"dxOffset\",\n      \"technicalDefault\": \"100\",\n      \"businessMeaning\": \"Moves the marker horizontally (perpendicular to the detail line) away from the anchor point.\",\n      \"validRange\": \"0 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the marker geometry along the detail's local X-axis.\"\n    },\n    {\n      \"name\": \"dyOffset\",\n      \"technicalDefault\": \"500\",\n      \"businessMeaning\": \"Moves the marker vertically (parallel to the detail line) along the anchor line.\",\n      \"validRange\": \"-2000 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the marker geometry along the detail's local Y-axis.\"\n    },\n    {\n      \"name\": \"dxOffsetTxt\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Fine-tuning the horizontal position of the text label relative to the marker center.\",\n      \"validRange\": \"-500 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the text origin.\"\n    },\n    {\n      \"name\": \"dyOffsetTxt\",\n      \"technicalDefault\": \"350\",\n      \"businessMeaning\": \"Fine-tuning the vertical position of the text label relative to the marker center.\",\n      \"validRange\": \"-500 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the text origin.\"\n    },\n    {\n      \"name\": \"sTextOrientation\",\n      \"technicalDefault\": \"Aligned with detail\",\n      \"businessMeaning\": \"Sets the rotation of the text. 'Aligned' rotates text to match the detail line angle; 'Perpendicular' rotates it 90 degrees.\",\n      \"validRange\": \"List: Aligned, Perpendicular\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Rotates the text coordinate system (vxTxt/vyTxt).\"\n    },\n    {\n      \"name\": \"sReadDirection\",\n      \"technicalDefault\": \"Top-Left\",\n      \"businessMeaning\": \"Ensures text legibility. Specifies from which cardinal direction (e.g., Top-Left) the text should be readable. Includes options to keep text horizontal or aligned with the current view.\",\n      \"validRange\": \"List: Top-Left, Bottom-Left, Bottom-Right, Top-Right, Left, Right, Top, Bottom, Keep horizontal, Align with view\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Flips the text vectors so the bottom of the text faces the specified direction relative to the element.\"\n    },\n    {\n      \"name\": \"sTextAlignmentX\",\n      \"technicalDefault\": \"From textposition\",\n      \"businessMeaning\": \"Horizontal justification of the text relative to the text offset point (Left/Center/Right equivalent).\",\n      \"validRange\": \"List: From textposition, Centered, Towards textposition\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Adjusts text rendering anchor (dTextAlignmentX).\"\n    },\n    {\n      \"name\": \"sTextAlignmentY\",\n      \"technicalDefault\": \"Above textposition\",\n      \"businessMeaning\": \"Vertical justification of the text relative to the text offset point (Top/Middle/Bottom equivalent).\",\n      \"validRange\": \"List: Above textposition, Centered, Below textposition\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Adjusts text rendering anchor (dTextAlignmentY).\"\n    },\n    {\n      \"name\": \"nColorDetail\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"CAD color index for the graphical marker (the rectangle/line).\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Changes the color of the PLine marker.\"\n    },\n    {\n      \"name\": \"nTextColor\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"CAD color index for the text label.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Changes the color of the text.\"\n    },\n    {\n      \"name\": \"sDimstyleText\",\n      \"technicalDefault\": \"_DimStyles\",\n      \"businessMeaning\": \"Selects the dimension style (font, size settings) to use for the text.\",\n      \"validRange\": \"Any existing Dimension Style\",\n      \"unit\": \"Style Name\",\n      \"affectsOutput\": \"Affects font, arrowheads, and default size (if dTxtSize is -1).\"\n    },\n    {\n      \"name\": \"sShowLine\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the visibility of the rectangular marker line.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Hides or draws the PLine geometry.\"\n    },\n    {\n      \"name\": \"dTxtSize\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Explicit height of the text. A value of -1 uses the default from the selected Dimension Style.\",\n      \"validRange\": \"> -1\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Overrides the text height if > 0.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"dTxtSize value\",\n      \"effect\": \"If value is zero or less, the script uses the height defined in 'sDimstyleText'. If greater than zero, it overrides the style height.\",\n      \"cascade\": [\n        \"sDimstyleText\",\n        \"dTxtSize\"\n      ]\n    },\n    {\n      \"trigger\": \"sReadDirection (specifically Top-Left/Right/Bottom-Left etc)\",\n      \"effect\": \"Calculates the view vector based on Element X/Y axes and flips text vectors (vxTxt, vyTxt) to ensure the text is not mirrored or upside down relative to that view.\",\n      \"cascade\": [\n        \"vxTxt\",\n        \"vyTxt\",\n        \"dTextAlignmentX\"\n      ]\n    },\n    {\n      \"trigger\": \"sDetailPosition\",\n      \"effect\": \"Changes the"
      },
      "tokens_used": 9300,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch & Cycle Check",
          "2. Check Execute Key & Load Catalog Properties (if applicable) or Show Dialog",
          "3. Command Line: Select Element (getElement)",
          "4. Command Line: Select Base Position (getPoint)",
          "5. Command Line: Select Direction Point (getPoint)",
          "6. Validate Input (Projection to Element Plane, Direction Vector Length)",
          "7. Store Position/Normal to Map, Link Instance to Element",
          "8. Recalculation Phase: Fetch Element Properties and Profile",
          "9. Calculate Anchor Point (_Pt0) based on 'Detail position' property",
          "10. Construct Coordinate System (csDet) and Check Mirroring",
          "11. Generate Marker Geometry (PLine) if 'Show line' is Yes",
          "12. Generate Text Geometry based on 'Read Direction' and 'Orientation' properties",
          "13. Update Element MapX with aggregated Detail Names from all attached TSL instances"
        ],
        "conditionalBranches": [
          {
            "condition": "Script Execution Phase (Insert vs. Recalculation)",
            "path1": {
              "name": "Insert Phase",
              "steps": [
                "Check insertCycleCount",
                "Get User Input (Element, Points)",
                "Validate Direction",
                "Set _Pt0 and Map data",
                "Return (Exit)"
              ]
            },
            "path2": {
              "name": "Recalculation Phase",
              "steps": [
                "Validate Element Existence",
                "Get Map Data (Position, Normal)",
                "Calculate Geometry based on OPM Properties",
                "Draw Entity",
                "Update Element MapX"
              ]
            }
          },
          {
            "condition": "Property: 'Detail position' (sDetailPosition)",
            "path1": {
              "name": "On detail line",
              "steps": [
                "Anchor point (_Pt0) is snapped to the line defined by the insertion point and normal vector."
              ]
            },
            "path2": {
              "name": "Element middle",
              "steps": [
                "Anchor point (_Pt0) is snapped to the line passing through the element's center and parallel to the detail direction."
              ]
            },
            "path3": {
              "name": "Free",
              "steps": [
                "Anchor point (_Pt0) is snapped to the closest point on the detail's vertical plane (Z-normal)."
              ]
            }
          },
          {
            "condition": "Property: 'Readdirection' (sReadDirection) and Orientation",
            "path1": {
              "name": "Cardinal Directions (Top-Left, Bottom-Right, etc.)",
              "steps": [
                "Calculate specific view vector",
                "Flip text vectors (vxTxt, vyTxt) if necessary to face the view direction",
                "Handle mirroring logic",
                "Draw double-sided text (dpText and dpTextBack) with view-dependency"
              ]
            },
            "path2": {
              "name": "Keep text horizontal",
              "steps": [
                "Draw single-sided text aligned with Device X axis (_kDeviceX)"
              ]
            },
            "path3": {
              "name": "Align text with view",
              "steps": [
                "Draw single-sided text rotated to match Device rotation (_kDevice)"
              ]
            }
          },
          {
            "condition": "Property: 'Text size' (dTxtSize)",
            "path1": {
              "name": "Custom Size (> 0)",
              "steps": [
                "Use value from dTxtSize for text height."
              ]
            },
            "path2": {
              "name": "Style Based (<= 0)",
              "steps": [
                "Use text height defined in the selected Dimension Style (sDimstyleText)."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "(None, silent)",
            "recovery": "If insertCycleCount > 1, the instance is automatically erased to prevent duplicates during wall dragging/copying."
          },
          {
            "check": "Selected Element Validity",
            "errorMessage": "No, or invalid, element selected.",
            "recovery": "Script erases instance. User must ensure a valid hsbCAD element is selected during insertion or that the element hasn't been deleted."
          },
          {
            "check": "Element Profile Geometry",
            "errorMessage": "Invalid, element selected.",
            "recovery": "Script erases instance. The selected element likely has no valid profile net (points)."
          },
          {
            "check": "Direction Vector Length (Distance between Base and Direction point)",
            "errorMessage": "Invalid direction selected!",
            "recovery": "Script erases instance. User must pick a second point distinct from the base position during insertion."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Properties",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Changing 'Name', 'Size', 'Offsets', 'Colors', or 'Alignment' immediately regenerates the text and marker geometry."
          },
          {
            "action": "Move Detail",
            "how": "Grip Edit (Dragging _Pt0)",
            "effect": "Moving the insertion point updates the marker location. Behavior depends on 'Detail position': 'Free' moves arbitrarily, 'On detail line' slides along the axis, 'Element middle' slides along the center axis."
          },
          {
            "action": "Change Element Geometry",
            "how": "Modify the parent Element (e.g., resize wall)",
            "effect": "The marker updates its position relative to the element (specifically 'Element middle' mode) and the MapX data on the element is refreshed."
          }
        ]
      },
      "tokens_used": 10899,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-DetailName\n\n## Overview\nThis script places a detail marker (label or bubble) on timber elements in the 3D model. It allows you to tag specific locations with a detail name (e.g., \"Detail 1\"), control the graphical representation of the tag, and link it to external files for automated detailing workflows.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model environment. |\n| Paper Space | No | Not designed for use in layout views. |\n| Shop Drawing | No | Not a shop drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: A single hsbCAD Element (Wall, Floor, or Roof).\n- **Minimum Beams**: 1 (Element must exist).\n- **Required Settings**: A valid Dimension Style (`_DimStyles` or similar) must exist in the drawing to determine default text appearance.\n\n## Usage Steps\n\n### Step 1: Launch Script\nRun the command `TSLINSERT` and select `HSB_E-DetailName.mcr` from the list.\n\n### Step 2: Select Element\n```\nCommand Line: Select an element\nAction: Click on the timber element (wall/floor) you wish to tag.\n```\n\n### Step 3: Select Base Position\n```\nCommand Line: Select a position\nNote: Points are projected to element, projection is done perpendicular to element XY plane\nAction: Click near or on the element where you want the detail reference to be located. The point will snap to the element's surface plane.\n```\n\n### Step 4: Define Direction\n```\nCommand Line: Select a point for the direction\nAction: Click a second point to define the rotation/angle of the detail marker. This line acts as the local \"X-axis\" for the tag alignment.\n```\n\n## Properties Panel Parameters\n\n### Detail Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Name | String | Empty | The primary identifier displayed in the model and used for data export (e.g., \"1\", \"A\"). |\n| Description | String | Empty | Additional descriptive text stored in the element data (not currently drawn visually). |\n| Size | Double | 500 | The physical width/height of the rectangular marker bubble in millimeters. |\n| Depth | Double | 500 | Reserved parameter (currently does not affect geometry). |\n| Detail filename prefix | String | Empty | Sets a file prefix. If set to \"Det\" and Name is \"1\", the system links to \"Det1\". |\n\n### Position Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Detail position | Enum | On detail line | Constrains the anchor: **On detail line** (snaps to insertion line), **Element middle** (snaps to center of element), or **Free**. |\n| Offset, perpendicular to detail | Double | 100 | Moves the marker along the local X-axis (perpendicular to the detail direction line). |\n| Offset, along detail | Double | 500 | Moves the marker along the local Y-axis (parallel to the detail direction line). |\n| Text Orientation | Enum | Aligned with detail | **Aligned** rotates text with the direction line; **Perpendicular** rotates it 90 degrees. |\n| Readdirection | Enum | Top-Left | Ensures text is readable from a specific direction (e.g., Top-Left, Bottom-Right). Prevents upside-down text. |\n\n### Text Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Offset X/Y | Double | 0 / 350 | Fine-tunes the text position relative to the marker center. |\n| Text alignment X/Y | Enum | From text... / Above... | Sets the justification (Left/Center/Right or Top/Middle/Bottom) relative to the text position point. |\n| Dimstyle Text | String | _DimStyles | Selects the Dimension Style to control font and arrow types. |\n| Text Size | Double | -1 | Height of the text. Set to `-1` to use the DimStyle height; set >0 to override manually. |\n| Color | Integer | 1 | CAD Color Index for the text label. |\n\n### Visual Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Color | Integer | 3 | CAD Color Index for the marker frame/line. |\n| Show line | Enum | Yes | Toggles the visibility of the rectangular marker frame. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Erase | Removes the detail marker instance. |\n| Recalculate | Forces the script to redraw the geometry based on current element changes or property updates. |\n| *(Standard Grip Edits)* | Clicking the square grip point (_Pt0) allows you to drag the marker to a new location. Behavior depends on the 'Detail position' property. |\n\n## Settings Files\n- **Dimension Styles**: Standard AutoCAD/hsbCAD Dimension Styles.\n- **Location**: Current Drawing.\n- **Purpose**: Controls the font, arrow style, and default text size (when `dTxtSize` is -1).\n\n## Tips\n- **File Linking**: Use the \"Detail filename prefix\" property to automatically associate the marker with specific drawing files (e.g., details or schedules).\n- **Wall Length Changes**: If you expect the element (wall) to change length, set \"Detail position\" to **Element middle**. The marker will stay relatively centered as the wall resizes.\n- **Text Readability**: If the text appears mirrored or upside down, change the \"Readdirection\" property to the cardinal direction (e.g., Top-Left) from which you are viewing the model.\n- **Global Text Control**: Set `dTxtSize` to `-1` and manage all text heights via your selected `DimstyleText` to ensure consistency across the project.\n\n## FAQ\n- **Q: Why did my detail marker disappear?**\n  - A: Check if the parent Element was deleted or if the `Show line` property is set to \"No\" and the Text color matches the background. The script also erases itself if it detects an invalid cycle count or invalid element geometry.\n\n- **Q: Can I use this to tag beams?**\n  - A: No, this script is designed for Elements (Walls/Floofs/Roofs). For beams, you would typically use a script prefixed with `HSB_B-`.\n\n- **Q: How do I make the text always horizontal, regardless of the wall angle?**\n  - A: Set \"Text Orientation\" as desired, and set \"Readdirection\" to **Keep horizontal**."
      },
      "tokens_used": 8501,
      "error": null
    }
  }
}