{
  "filename": "GE_CLONE_MVBLOCKS.mcr",
  "status": "completed",
  "total_tokens": 50974,
  "processing_time": 346.339391708374,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \"minorVersion\": 3,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": null,\n  \"versionHistory\": [\n    {\n      \"version\": \"v1.3\",\n      \"date\": \"18.apr.2013\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Bugfix: Filtering out non valid SFWall or Wall entities\"\n    },\n    {\n      \"version\": \"v1.2\",\n      \"date\": \"02.apr.2013\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Bugfix: Searching body was cutting all blocking body (deleting), as result no point was available hence error message\"\n    },\n    {\n      \"version\": \"v1.1\",\n      \"date\": \"01.apr.2013\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Bugfix: when bdMvbMoved the assignation of points where being done when no points where available\"\n    },\n    {\n      \"version\": \"v1.0\",\n      \"date\": \"31.ene.2013\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Version control\"\n    },\n    {\n      \"version\": \"v0.9\",\n      \"date\": \"15.may.2012\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Thumbnail added - Description made visible to user\"\n    },\n    {\n      \"version\": \"V0.8\",\n      \"date\": \"May 2 2012\",\n      \"author\": \"RL\",\n      \"changes\": \"In placing the opening it will find the center point of the MvBlock body that intersects with the wall body and base the opening location on the center point of the resulting body.\"\n    },\n    {\n      \"version\": \"V0.7\",\n      \"date\": \"April 19 2012\",\n      \"author\": \"RL\",\n      \"changes\": \"Will now dbCreate an opening for Recessed MVBlocks. No data is attached to the opening\"\n    },\n    {\n      \"version\": \"v0.6\",\n      \"date\": \"01.nov.2011\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"Added flag to cloned GE_WALL_SECTION_BLOCKING TslInst to make it load values from certain catalog\"\n    },\n    {\n      \"version\": \"V0.5\",\n      \"date\": \"Sept 6 2011\",\n      \"author\": \"RL\",\n      \"changes\": \"Will move a block 2 inches upwards in case it cuts the wall__ Will take the realbody of the block with an isometric vector to make sure it gets the body of model display\"\n    },\n    {\n      \"version\": \"V0.4\",\n      \"date\": \"Sept 8 2010\",\n      \"author\": \"RL\",\n      \"changes\": \"Added special framing for tubs and toilets (\\\"PLUMBING - VOID 12\\\",\\\"PLUMBING - TUB SHOWER CENTERED\\\")\"\n   "
      },
      "tokens_used": 9475,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script operates in Model Space explicitly using `_kModel` to collect `ElementWallSF` entities. It manipulates 3D `Body` objects, `MvBlockRef` definitions, and `Wall` geometry. It creates `Opening` entities in the model. No shop drawing prefixes (`sd_`) or viewport logic (`_Viewport`) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "MvBlockRef",
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing AutoCAD Architecture MVBlocks and hsbCAD Wall elements.",
          "requiredSettings": [
            "TSL scripts: GE_WALL_SECTION_BLOCKING, GE_WALL_NO_STUD_AREA_BLOCKING",
            "Classification property 'ITWBFraming' applied to MVBlocks"
          ]
        }
      },
      "tokens_used": 8249,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of MVBlocks",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strEmpty0",
            "type": "PropString",
            "displayName": "Empty 1",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "strEmpty1",
            "type": "PropString",
            "displayName": "Empty 2",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7519,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Converts AutoCAD Architecture (ACA) MVBlocks into specific hsbCAD wall framing elements, such as openings for recessed lights or blocking/noggings for cabinets and plumbing fixtures.",
          "category": "Framing",
          "typicalUseCase": "Used when importing architectural models containing MVBlocks that represent furniture or fixtures, requiring automated generation of the corresponding timber wall blocking or rough openings."
        },
        "parameters": [
          {
            "name": "strEmpty0",
            "technicalDefault": "- - - - - - - - - - - - - - - -",
            "businessMeaning": "Visual separator or placeholder in the Properties Palette. It has no functional impact on the script logic.",
            "validRange": "N/A (Read-only static text)",
            "unit": "String",
            "affectsOutput": "None. This property is strictly for UI organization."
          },
          {
            "name": "strEmpty1",
            "technicalDefault": "- - - - - - - - - - - - - - - -",
            "businessMeaning": "Visual separator or placeholder in the Properties Palette. It has no functional impact on the script logic.",
            "validRange": "N/A (Read-only static text)",
            "unit": "String",
            "affectsOutput": "None. This property is strictly for UI organization."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "MVBlock Classification Property 'ITWBFraming'",
            "effect": "The script reads this property on the selected MVBlock to determine which sub-script to invoke (e.g., creating an Opening for 'RECESSED', blocking for 'CABINET').",
            "cascade": [
              "Opening Creation",
              "GE_WALL_SECTION_BLOCKING Insertion",
              "GE_WALL_NO_STUD_AREA_BLOCKING Insertion"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Opening",
            "description": "Creates a wall opening based on the dimensions defined in the MVBlock properties (specifically for 'RECESSED' types).",
            "appliedTo": "ElementWallSF (Wall) that intersects the selected MVBlock."
          },
          {
            "type": "TslInst",
            "description": "Inserts the 'GE_WALL_SECTION_BLOCKING' script to generate timber backing/noggings for cabinets (Base, Tall, Wall).",
            "appliedTo": "ElementWallSF (Wall) intersecting the MVBlock."
          },
          {
            "type": "TslInst",
            "description": "Inserts the 'GE_WALL_NO_STUD_AREA_BLOCKING' script to create void areas or special blocking for plumbing fixtures (Tubs, Toilets).",
            "appliedTo": "ElementWallSF (Wall) intersecting the MVBlock."
          }
        ]
      },
      "tokens_used": 10078,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via command or catalog.",
          "User prompted to select a set of MVBlocks (PrEntity).",
          "If user cancels, script ends. If selection is valid, script iterates through selected entities.",
          "Script filters selection to keep only valid MvBlockRef entities.",
          "Script clones itself (dbCreate) for each valid MVBlock found.",
          "Original instance erases itself (eraseInstance).",
          "Each cloned instance starts execution with a single Entity (the MVBlock).",
          "Script retrieves MVBlock definition and classification property 'ITWBFraming'.",
          "Script determines action based on 'ITWBFraming' value (Cabinet, Recessed, Plumbing, etc.).",
          "Script retrieves the real body (geometry) of the MVBlock.",
          "If special Plumbing type, body geometry is overridden with a cylinder.",
          "Script collects all ElementWallSF (Wall) entities in the model.",
          "Script iterates through walls to find intersection with the MVBlock.",
          "Script calculates intersection points between Wall and MVBlock body to determine location.",
          "Based on the type (Recessed, Cabinet, Plumbing), script executes specific sub-action (Create Opening, Insert Blocking, Insert No-Stud Area).",
          "Script erases its own instance after processing.",
          "Visual feedback (PLine circle) is briefly displayed if debug mode is active (though likely invisible due to immediate erase)."
        ],
        "conditionalBranches": [
          {
            "condition": "On Insert: Selection Validation",
            "path1": {
              "name": "Selection Made",
              "steps": [
                "Filter entities for MvBlockRef type.",
                "Clone script for each block.",
                "Erase parent instance."
              ]
            },
            "path2": {
              "name": "Selection Cancelled",
              "steps": [
                "Script terminates naturally."
              ]
            }
          },
          {
            "condition": "ITWBFraming Classification Value",
            "path1": {
              "name": "Cabinet Types (Base/Tall/Wall)",
              "steps": [
                "Set flags for Upper/Lower backing.",
                "Search for intersecting Walls.",
                "Insert 'GE_WALL_SECTION_BLOCKING' script at calculated elevation."
              ]
            },
            "path2": {
              "name": "Recessed Type",
              "steps": [
                "Extract width/height from properties.",
                "Search for intersecting Walls.",
                "Create Opening entity in Wall."
              ]
            },
            "path3": {
              "name": "Plumbing Types (Void/Tub)",
              "steps": [
                "Set special geometry flags (Cylinder/12 inch).",
                "Search for intersecting Walls.",
                "Insert 'GE_WALL_NO_STUD_AREA_BLOCKING' script."
              ]
            },
            "path4": {
              "name": "Unknown/None",
              "steps": [
                "Script identifies no valid action.",
                "Instance erases itself."
              ]
            }
          },
          {
            "condition": "Wall Intersection Check",
            "path1": {
              "name": "Intersection Found",
              "steps": [
                "Calculate precise insertion point on wall face.",
                "Execute the specific TSL/Opening creation logic.",
                "Break wall loop (stop checking other walls)."
              ]
            },
            "path2": {
              "name": "No Intersection",
              "steps": [
                "Continue to next wall in collection.",
                "If loop finishes without intersection, instance erases itself."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Type",
            "errorMessage": "Implicitly filters. Non-MvBlockRefs are ignored during the loop.",
            "recovery": "Select valid MVBlocks during the initial PrEntity prompt."
          },
          {
            "check": "MVBlock Classification 'ITWBFraming'",
            "errorMessage": "No explicit message, but script erases instance if property is missing.",
            "recovery": "Ensure selected MVBlocks have the 'ITWBFraming' property set to a recognized value (e.g., 'CABINET - BASE')."
          },
          {
            "check": "MVBlock Geometry Validity",
            "errorMessage": "Implicitly handled. If body vertices count is 0, script erases instance.",
            "recovery": "Ensure MVBlock definition has valid 3D geometry/solids."
          },
          {
            "check": "Wall Validity",
            "errorMessage": "Silent. Script skips invalid or walls with no volume (turned off).",
            "recovery": "Ensure walls are modeled (or have valid layer/visibility settings) and intersect the MVBlock geometry."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Generated Framing",
            "how": "Edit the properties of the generated TslInst (Blocking) or Opening entities.",
            "effect": "Changes the dimensions or material of the backing/blocking/opening."
          },
          {
            "action": "Move MVBlock",
            "how": "Grip edit or Move command on the original MVBlock.",
            "effect": "The generated framing (Opening/Blocking) does NOT update automatically (this is a one-time generation script). The user would likely need to delete the generated elements and run the script again on the moved MVBlock."
          },
          {
            "action": "Delete MVBlock",
            "how": "Erase command.",
            "effect": "The generated framing remains in the model as independent entities."
          }
        ]
      },
      "tokens_used": 9800,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_CLONE_MVBLOCKS.mcr\n\n## Overview\nThis script converts selected AutoCAD Architecture (ACA) MVBlocks into specific hsbCAD wall framing elements. It automatically generates wall openings for recessed fixtures or inserts blocking and no-stud area scripts for cabinets and plumbing based on the block's classification property.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in Model Space where MVBlocks and Walls exist. |\n| Paper Space | No | Not applicable. |\n| Shop Drawing | No | This script generates model elements, not drawing annotations. |\n\n## Prerequisites\n- **Required Entities:** AutoCAD Architecture MVBlocks (representing fixtures/furniture) and hsbCAD Walls (`ElementWallSF`).\n- **Classification:** Selected MVBlocks must have a Classification property named `ITWBFraming` with specific values (e.g., \"CABINET - BASE\", \"RECESSED\", \"PLUMBING - VOID\").\n- **Required Scripts:** The scripts `GE_WALL_SECTION_BLOCKING` and `GE_WALL_NO_STUD_AREA_BLOCKING` must be present in your TSL catalog to generate the framing for cabinets and plumbing.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_CLONE_MVBLOCKS.mcr` from the catalog.\n\n### Step 2: Select MVBlocks\n```\nCommand Line: \nSelect a set of MVBlocks\nAction: \nSelect the desired AutoCAD MVBlocks (e.g., cabinets, light fixtures, toilet blocks) in the drawing and press Enter.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Empty 1 | Text | - - - - - - - - - - - - - - - - | Visual separator for organization purposes only. |\n| Empty 2 | Text | - - - - - - - - - - - - - - - - | Visual separator for organization purposes only. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script instance erases itself immediately after processing the blocks. Standard context menu options do not apply post-execution. |\n\n## Settings Files\n- **Catalog Dependencies**: `GE_WALL_SECTION_BLOCKING.mcr`, `GE_WALL_NO_STUD_AREA_BLOCKING.mcr`\n- **Location**: TSL Catalog\n- **Purpose**: These scripts are automatically inserted to generate the specific timber blocking or void areas for the different MVBlock types.\n\n## Tips\n- **Classification is Key:** Ensure your MVBlocks have the `ITWBFraming` property set correctly before running the script. Without this, the script will not know what type of framing to create.\n- **Intersection:** The MVBlock must physically intersect with a wall body. If the block is floating in front of the wall without touching it, the script will fail to place the opening or blocking.\n- **One-Time Use:** This is a generator script, not a dynamic link. If you move the MVBlock later, the generated framing will **not** update. You must delete the old framing and run the script again on the moved block.\n\n## FAQ\n- **Q: Why did the script not create anything for my selected block?**\n  A: Check that the MVBlock has the `ITWBFraming` classification property assigned and that it physically intersects with an hsbCAD Wall. If the property is missing or the intersection is empty, the script will ignore the block.\n\n- **Q: Can I use this on standard AutoCAD blocks?**\n  A: No, this script is designed specifically for AutoCAD Architecture MVBlocks which have extended data properties required for classification.\n\n- **Q: I moved my cabinet; how do I update the framing?**\n  A: The generated blocking/opening is not linked to the original block. Delete the previously generated blocking/opening, select the moved cabinet, and run the script again."
      },
      "tokens_used": 5853,
      "error": null
    }
  }
}