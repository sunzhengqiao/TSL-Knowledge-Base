{
  "filename": "BMF Column shoe D.mcr",
  "status": "completed",
  "total_tokens": 27284,
  "processing_time": 256.0380508899689,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 1,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "2006/Jan/25",
            "author": "Roberto Hallo",
            "changes": "initial version"
          },
          {
            "version": "1.1",
            "date": "2006/Jan/30",
            "author": "Roberto Hallo",
            "changes": ""
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4861,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script utilizes 3D geometric entities (Body, PLine, Cut) and modifies beam geometry via _Beam0.addTool(). It uses Display(9) to visualize 3D bodies. No ShopDrawing specific patterns (sd_*, #Type E, _Viewport) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Must be inserted on a GenBeam in Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 3711,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dBaseHeigh",
            "type": "PropDouble",
            "displayName": "Base Height",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "strFixing",
            "type": "PropString",
            "displayName": "Type of Fixing",
            "defaultValue": "Nails",
            "inputType": "dropdown",
            "options": [
              "Nails",
              "Screws"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3070,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a BMF Type D Column Shoe steel connection, creating the hardware visualization (shank, base plate, and side plates) and cutting the corresponding slot in the timber column.",
          "category": "Hardware/Connection",
          "typicalUseCase": "Anchoring a timber column to a foundation or base plate using a specific BMF branded shoe, requiring precise dimensions based on the column width."
        },
        "parameters": [
          {
            "name": "dBaseHeigh",
            "technicalDefault": "0",
            "businessMeaning": "The vertical offset or spacing (e.g., for leveling shims or grout) between the bottom of the column and the base plate of the shoe.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Shifts the position of the steel shoe model and adjusts the starting point/depth of the machining slot in the beam to accommodate the offset."
          },
          {
            "name": "strFixing",
            "technicalDefault": "Nails",
            "businessMeaning": "Specifies the fastener method required to attach the side plates of the shoe to the timber column.",
            "validRange": "Nails, Screws",
            "unit": "Text",
            "affectsOutput": "Updates the Article number, Designation, and BOM identifiers (e.g., appending '-Nails' or '-Screws' to the product name). Does not alter geometric dimensions in this version."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Beam Width (GenBeam Width)",
            "effect": "The script automatically selects the corresponding shoe size, plate dimensions, and shank diameter from internal lookup tables based on the selected beam's width.",
            "cascade": [
              "Shoe Width (dHw)",
              "Shoe Height (dHh)",
              "Shoe Length (dHle)",
              "Shank Diameter (dHss)",
              "Product Name (strHn)"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Cut",
            "description": "A rectangular slot or hole cut into the bottom end of the column to receive the steel shank of the shoe.",
            "appliedTo": "The selected GenBeam (Column)"
          },
          {
            "type": "Body (Visual Representation)",
            "description": "A set of 3D bodies representing the Column Shoe assembly: a vertical cylindrical shank, a square bottom plate, and two vertical lateral side plates.",
            "appliedTo": "Model Space (Visualization/Export)"
          }
        ]
      },
      "tokens_used": 5482,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script initializes unit system (mm) and visualizes local coordinate system.",
          "2. User inserts script onto a GenBeam (Column).",
          "3. Script retrieves beam width (Y-dimension) from the selected GenBeam.",
          "4. Script compares beam width against internal array of supported sizes (arW).",
          "5. [Decision] Is beam width supported?",
          "6. [Branch No] Display error message 'Shoe cannot be used!', erase script instance, and exit.",
          "7. [Branch Yes] Retrieve shoe dimensions and Product Name (strHn) based on the matching index (iIndex).",
          "8. Construct Cut geometry for the beam slot based on calculated dimensions and user property 'dBaseHeigh'.",
          "9. Apply Cut to the GenBeam (_Beam0.addTool).",
          "10. Generate 3D Bodies: Shank (Cylinder), Base Plate (Extruded PLine), and Side Plates (Extruded PLine).",
          "11. Rotate and duplicate Side Plate for the opposite side.",
          "12. Update Article number and Designation strings using 'strFixing' property (append '-Nails' or '-Screws').",
          "13. Assign Material ('Galvanized Steel') and output BOM data (setCompareKey, model, dxaout).",
          "14. Display final 3D representation in model space."
        ],
        "conditionalBranches": [
          {
            "condition": "Beam Width Match Validation",
            "path1": {
              "name": "Supported Width",
              "steps": [
                "Loop finds exact match in arW array.",
                "Index iIndex is set.",
                "Calculates shoe dimensions (dHw, dHh, dHle, etc.).",
                "Proceeds to geometry generation."
              ]
            },
            "path2": {
              "name": "Unsupported Width",
              "steps": [
                "Loop completes without matching dMw.",
                "iIndex remains -1.",
                "Report message: strError.",
                "Execute eraseInstance().",
                "Exit script."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Selected GenBeam Width must exactly match a value in the supported sizes array (e.g., 100, 115, 120, 140, 148, 48, 50, 73, 75, 80, 90, 98).",
            "errorMessage": "\nShoe cannot be used!",
            "recovery": "Select a beam with a supported width, or modify the beam width to match one of the supported sizes."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Adjust Base Height",
            "how": "Edit 'dBaseHeigh' property in OPM (Object Properties Model)",
            "effect": "Recalculates the position of the Cut slot and the vertical position of the shoe assembly (Shank and Base Plate) relative to the beam end point."
          },
          {
            "action": "Change Fixing Type",
            "how": "Edit 'strFixing' property in OPM",
            "effect": "Updates the Article number, Designation, and Compare Key strings (switches between '-Nails' and '-Screws' suffixes). Does not change physical geometry."
          }
        ]
      },
      "tokens_used": 5468,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# BMF Column shoe D.mcr\n\n## Overview\nThis script automatically generates a BMF Type D Column Shoe steel connection. It sizes the hardware (shank, base plate, and side plates) based on the column's width, creates the 3D visualization, and cuts the necessary slot in the timber beam.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script is designed for 3D modeling. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: 1 GenBeam (Column)\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `BMF Column shoe D.mcr`\n\n### Step 2: Select Column\n```\nAction: Select the GenBeam representing the timber column.\nDetails: The script will automatically detect the beam's width to determine the correct shoe size.\n```\n\n### Step 3: Validation & Generation\n```\nAction: The script validates the beam width.\nOutcome: \n- If the width matches a supported size, the shoe is created and the beam is cut.\n- If the width is not supported, the script displays an error and removes itself.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Base Height | Number | 0 | The vertical offset (mm) between the bottom of the column and the base plate (e.g., for leveling shims). |\n| Type of Fixing | Dropdown | Nails | Specifies the fastener method for the side plates. Options: Nails, Screws. This updates the Article number/BOM data. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu items are defined for this script. Use the Properties palette to modify parameters. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: All dimensions are calculated internally based on beam width.\n\n## Tips\n- **Supported Widths**: Ensure your column width matches one of the following sizes (mm): 48, 50, 73, 75, 80, 90, 98, 100, 115, 120, 140, 148. If the width does not match, the script will fail to insert.\n- **Adjusting Offset**: Use the `Base Height` property if you need to account for grout or shims at the base of the column.\n- **Visualization**: The script creates distinct 3D bodies for the shank, base plate, and side plates, making it easy to visualize in the model.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I selected the beam?**\n  A: The beam width you selected is not supported by this BMF shoe type. Check the column dimensions and try again.\n- **Q: Does changing the 'Type of Fixing' change the geometry?**\n  A: No, it only updates the Article number and Designation in the BOM (Bill of Materials) for production purposes.\n- **Q: How do I move the shoe up or down?**\n  A: Change the `Base Height` value in the Properties palette. Positive values move the shoe assembly down relative to the column end."
      },
      "tokens_used": 4692,
      "error": null
    }
  }
}