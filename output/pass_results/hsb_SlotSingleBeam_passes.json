{
  "filename": "hsb_SlotSingleBeam.mcr",
  "status": "completed",
  "total_tokens": 16546,
  "processing_time": 148.95207834243774,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 1949,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_* or Multipage prefixes found. No usage of Viewport or _kPaperSpace. No #Type E definitions. Uses GenBeam operations (_Beam0.addTool) and 3D spatial vectors (_X0, _Y0, _Z0)."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 1016,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dDepth1",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": 100,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dThick1",
            "type": "PropDouble",
            "displayName": "Thickness",
            "defaultValue": 20,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dHeight1",
            "type": "PropDouble",
            "displayName": "Height",
            "defaultValue": 50,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1824,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a rectangular slot (housing or dado) cut into a single beam, defined by its length, width, and height.",
          "category": "Machining",
          "typicalUseCase": "Preparing a beam to receive a cross-member or tenon, creating a notch for a steel plate, or general material removal for connections."
        },
        "parameters": [
          {
            "name": "dDepth1",
            "technicalDefault": 100,
            "businessMeaning": "Controls the length of the slot along the beam's longitudinal axis. Note that the script logic doubles this value (dDepth1*2), implying the insertion point is the center of the slot.",
            "validRange": "0 to Beam Length",
            "unit": "mm",
            "affectsOutput": "Extends the slot geometry along the beam axis. A larger value creates a longer cut."
          },
          {
            "name": "dThick1",
            "technicalDefault": 20,
            "businessMeaning": "Controls the width (thickness) of the slot, which corresponds to the depth of cut perpendicular to the beam's face (penetration into the material).",
            "validRange": "0 to Beam Width/Depth",
            "unit": "mm",
            "affectsOutput": "Widens the slot opening and increases the volume of material removed from the sides."
          },
          {
            "name": "dHeight1",
            "technicalDefault": 50,
            "businessMeaning": "Controls the vertical height of the slot opening on the beam's face.",
            "validRange": "0 to Beam Height",
            "unit": "mm",
            "affectsOutput": "Increases the vertical dimension of the rectangular cut."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing dDepth1",
            "effect": "The total physical length of the slot changes by double the amount entered.",
            "cascade": [
              "Slot Length Geometry",
              "Visual Indicator Line Length"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Slot / Void",
            "description": "A rectangular 3D void cut into the beam body.",
            "appliedTo": "The selected GenBeam (_Beam0)"
          }
        ]
      },
      "tokens_used": 3742,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Execution Start",
          "2. User selects a GenBeam (populates _Beam0)",
          "3. User selects a point on the beam (populates _Pt0, _X0, _Y0, _Z0)",
          "4. Property Initialization (Depth, Thickness, Height)",
          "5. Slot Geometry Construction (Centered on point, extending dDepth1*2 along beam)",
          "6. Visualization (Axes, Cutting Body, Reference Line)",
          "7. Apply Tool to Beam (_Beam0.addTool)",
          "8. Script Completion"
        ],
        "conditionalBranches": [],
        "validationRules": [
          {
            "check": "Beam Selection",
            "errorMessage": "Implicit (Script terminates or fails if no beam is selected before execution)",
            "recovery": "Select a valid GenBeam and restart the script"
          },
          {
            "check": "Point Selection",
            "errorMessage": "Implicit (Script terminates if no insertion point is provided)",
            "recovery": "Select a valid point on the beam face during the insertion prompt"
          },
          {
            "check": "Geometry Dimensions",
            "errorMessage": "Potential geometric error or inverted Slot if dimensions are zero or negative",
            "recovery": "Ensure dDepth1, dThick1, and dHeight1 are positive values in the properties palette"
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Slot Depth",
            "how": "OPM Property 'dDepth1'",
            "effect": "Updates the total length of the slot (Depth * 2) and the length of the visual reference line."
          },
          {
            "action": "Modify Slot Thickness/Height",
            "how": "OPM Property 'dThick1' or 'dHeight1'",
            "effect": "Resizes the width and vertical height of the void cut into the beam."
          },
          {
            "action": "Move Slot Position",
            "how": "Grip Edit / Move Entity",
            "effect": "Relocates the slot origin (_Pt0) along the beam geometry."
          }
        ]
      },
      "tokens_used": 4158,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SlotSingleBeam.mcr\n\n## Overview\nCreates a rectangular slot (housing or dado) cut into a single beam. This script is used to define material removal for connections, such as receiving a cross-member or a steel plate, based on a specified depth, thickness, and height.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates in 3D model space. |\n| Paper Space | No | Not designed for 2D layouts or viewports. |\n| Shop Drawing | No | This is a model generation script, not a detailing script. |\n\n## Prerequisites\n- **Required Entities**: At least one Beam (GenBeam) must exist in the model.\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SlotSingleBeam.mcr` from the file list.\n\n### Step 2: Select Beam\n```\nCommand Line: Select Beam:\nAction: Click on the beam in the model where you want the slot to be applied.\n```\n\n### Step 3: Define Position\n```\nCommand Line: Give point:\nAction: Click on the face or surface of the selected beam to set the center location of the slot.\n```\n*Note: This point acts as the center of the slot's length.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Depth | number | 100 | The length of the slot along the beam axis. **Note:** The actual cut length will be double this value (200 mm) because the insertion point is the center of the slot. |\n| Thickness | number | 20 | The width of the slot (penetration depth into the material). |\n| Height | number | 50 | The vertical height of the slot opening on the beam's face. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom items to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Center Point Logic:** The script places the insertion point at the *center* of the slot's length. If you enter a Depth of 100, the slot extends 100 units forward and 100 units backward from the point you clicked.\n- **Visual Feedback:** Upon insertion, a visual reference line indicates the full length of the slot.\n- **Easy Adjustments:** You can select the generated slot entity and modify the dimensions directly in the AutoCAD Properties Palette (OPM) without re-running the script.\n- **Moving the Slot:** Use standard AutoCAD Move or Grip Edit commands to relocate the slot along or across the beam after insertion.\n\n## FAQ\n- **Q: Why is the slot longer than the value I entered for Depth?**\n- A: The script uses the \"Depth\" value as a radius from the center point. The physical length of the slot is calculated as `Depth * 2`.\n\n- **Q: The slot disappeared or looks inverted. What happened?**\n- A: Ensure that the Depth, Thickness, and Height values in the Properties Palette are positive numbers. Zero or negative values can cause geometric errors.\n\n- **Q: Can I use this on curved beams?**\n- A: This script is designed for standard beams. While it may function on simple curved beams, results may vary depending on the complexity of the curvature."
      },
      "tokens_used": 3857,
      "error": null
    }
  }
}