{
  "filename": "HSB_I-GenBeamDetails.mcr",
  "status": "completed",
  "total_tokens": 24702,
  "processing_time": 223.94504237174988,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.00",
            "date": "14oct2019",
            "author": "david.rueda@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4149,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly uses _kModelSpace in the dbCreate call during the insertion block. There are no references to _Viewport, sd_*, or Multipage* prefixes, nor does it use the #Type E construct with _Entity[] which are indicative of ShopDrawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Requires selection of valid GenBeam(s) in Model Space.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2575,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select GenBeam(s)",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowNotice",
            "trigger": "After execution (recalculation)",
            "title": null,
            "dataSource": "GenBeam instance properties (handle, type, volume, dimensions, names, attributes, attached TSLs)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5011,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a detailed text report listing geometric dimensions, material attributes, naming properties, and attached TSLs for selected General Beams (GenBeams).",
          "category": "Reporting/Analysis",
          "typicalUseCase": "Used by detailers or engineers to audit or verify the properties of structural elements (Beams, Sheets, SIPs) within the model without opening individual property palettes."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Text Report (ShowNotice)",
            "description": "A formatted text message displaying the Handle, Type, Volume, Length, Width, Height, Position Number, Grade, Profile, Material, various labels, and a list of attached TSL script names for the selected element(s).",
            "appliedTo": "hsbCAD Text Output Window (Command Line/Notice)"
          }
        ]
      },
      "tokens_used": 3011,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script is launched/inserted by user.",
          "2. System checks insertCycleCount; if greater than 1, the script exits immediately to prevent recursion.",
          "3. User is prompted via command line to select one or more GenBeam(s).",
          "4. Upon selection confirmation, the script iterates through the selected entities.",
          "5. For each valid GenBeam found, the script creates a new instance of itself (dbCreate) linked specifically to that GenBeam.",
          "6. The original 'control' instance erases itself.",
          "7. Each newly created instance executes the script logic.",
          "8. Script validates the linked GenBeam (checking if it exists, is valid, and identifying its type as Beam, Sheet, or SIP).",
          "9. Script extracts geometric data (Volume, Length, Width, Height) and attribute data (PosNum, Grade, Profile, Material, Labels).",
          "10. Script queries the GenBeam for a list of attached TSLs.",
          "11. Script constructs a detailed text string containing all extracted properties.",
          "12. The text report is displayed to the user via a ShowNotice dialog.",
          "13. The script instance erases itself (self-destructs) immediately after displaying the report."
        ],
        "conditionalBranches": [
          {
            "condition": "User Input Selection (PrEntity)",
            "path1": {
              "name": "Valid Selection",
              "steps": [
                "Entities are collected from selection set.",
                "Script loops through entities and creates child instances.",
                "Parent instance erased."
              ]
            },
            "path2": {
              "name": "Empty/Cancelled Selection",
              "steps": [
                "Selection set is empty or go() fails.",
                "Parent instance erased.",
                "Workflow terminates."
              ]
            }
          },
          {
            "condition": "Attached TSLs Presence",
            "path1": {
              "name": "No Attached TSLs",
              "steps": [
                "tsls.length() equals 0.",
                "Message appended: 'No valid TSLs attached'."
              ]
            },
            "path2": {
              "name": "Attached TSLs Found",
              "steps": [
                "tsls.length() greater than 0.",
                "Message appended with count: 'Found X attached:'.",
                "Loop iterates through attached TSLs listing their script names."
              ]
            }
          },
          {
            "condition": "GenBeam Type Identification",
            "path1": {
              "name": "Beam",
              "steps": [
                "Cast to Beam is valid.",
                "sType set to 'Beam'."
              ]
            },
            "path2": {
              "name": "Sheet",
              "steps": [
                "Cast to Sheet is valid.",
                "sType set to 'Sheet'."
              ]
            },
            "path3": {
              "name": "SIP",
              "steps": [
                "Cast to Sip is valid.",
                "sType set to 'SIP'."
              ]
            },
            "path4": {
              "name": "Unknown/Invalid",
              "steps": [
                "All casts fail.",
                "Error message reported.",
                "Instance erased."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "_GenBeam array length",
            "errorMessage": "[ScriptName] - Error: not valid genBeam on _GenBeam",
            "recovery": "None (Script erases itself). User must select valid entity during insertion."
          },
          {
            "check": "_GenBeam[0] object validity",
            "errorMessage": "[ScriptName] - Error: not valid genBeam at _GenBeam[0]",
            "recovery": "None (Script erases itself)."
          },
          {
            "check": "Entity Type (Beam, Sheet, or SIP)",
            "errorMessage": "[ScriptName] - Error: not valid type defined",
            "recovery": "None (Script erases itself)."
          },
          {
            "check": "GenBeam Validity (Post-Type Check)",
            "errorMessage": "[ScriptName] - Error: not Valid GenBeam",
            "recovery": "None (Script erases itself)."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 6152,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_I-GenBeamDetails.mcr\n\n## Overview\nThis script generates a detailed text report displaying geometric dimensions, material attributes, naming properties, and a list of attached TSLs for selected structural elements (Beams, Sheets, or SIPs). It acts as a quick auditing tool to review element properties without opening multiple property palettes.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in Model Space. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required entities**: General Beam (GenBeam), Sheet, or Structural Insulated Panel (SIP).\n- **Minimum beam count**: 1 (supports multiple selection).\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_I-GenBeamDetails.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Select GenBeam(s)\nAction: Click on the desired beam, sheet, or SIP in the model. You can select multiple elements.\n```\n**Note**: Press Enter to confirm your selection.\n\n### Step 3: View Report\n```\nAction: A notice window will appear displaying the detailed report for the selected elements.\n```\n**Note**: Review the information and close the notice window. The script will automatically remove itself from the drawing once finished.\n\n## Properties Panel Parameters\n\nThis script has no editable parameters in the Properties Palette.\n\n## Right-Click Menu Options\n\nThis script does not add custom options to the right-click menu.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Batch Auditing**: You can select multiple elements at once during the prompt. The script will generate a separate report for each element found in the selection set.\n- **Troubleshooting**: Use this script to quickly verify which TSLs (scripts) are attached to a specific element if it is not behaving as expected.\n- **Clean Workflow**: The script is designed to \"self-destruct\" after running. You do not need to delete the script instance manually; it cleans itself up automatically.\n\n## FAQ\n- **Q: Can I run this on Walls?**\n  - A: Yes, provided the walls are defined as GenBeams, Sheets, or SIPs within the hsbCAD environment.\n- **Q: What happens if I select an element that is not a Beam or Sheet?**\n  - A: The script will report an error and skip that specific entity. Ensure you select valid structural timber elements.\n- **Q: Where does the text report appear?**\n  - A: The report appears in a standard hsbCAD ShowNotice (pop-up dialog) on your screen."
      },
      "tokens_used": 3804,
      "error": null
    }
  }
}