{
  "filename": "hsbPlateWallSheetCut.mcr",
  "status": "completed",
  "total_tokens": 51899,
  "processing_time": 202.059424161911,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9499,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script explicitly uses `_kModelSpace` in `tslNew.dbCreate(..., _kModelSpace, ...)` to create script instances. It manipulates 3D geometry such as `Sheet` objects and `ElementWallSF` using `Body` and `PlaneProfile` operations. No Paper Space or Shop Drawing specific prefixes (sd_) or viewports are referenced."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF",
            "GenBeam",
            "Sheet"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "hsbPlateWallSheetCut.xml (Optional, fallback to properties)"
          ]
        }
      },
      "tokens_used": 6896,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": "N/A (Property Palette/Dialog)",
              "condition": "(_bOnInsert && sKey.length()==0)",
              "required": false
            },
            {
              "step": 2,
              "function": "PrEntity.go",
              "promptOriginal": "Select intersecting beams",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrEntity.go",
              "promptOriginal": "Select walls or entities belonging to a wall",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dX1",
            "type": "PropDouble",
            "displayName": "X1",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the X1"
          },
          {
            "index": 1,
            "variable": "dY1",
            "type": "PropDouble",
            "displayName": "Y1",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the Y1"
          },
          {
            "index": 2,
            "variable": "dX2",
            "type": "PropDouble",
            "displayName": "X2",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the X2"
          },
          {
            "index": 3,
            "variable": "dY2",
            "type": "PropDouble",
            "displayName": "Y2",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the Y2"
          },
          {
            "index": 4,
            "variable": "dY3",
            "type": "PropDouble",
            "displayName": "Y3",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the Y3"
          },
          {
            "index": 0,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "Zone",
            "defaultValue": 5,
            "inputType": "dropdown",
            "options": [
              "-5",
              "-4",
              "-3",
              "-2",
              "-1",
              "0",
              "1",
              "2",
              "3",
              "4",
              "5"
            ],
            "category": "General",
            "description": "Defines the Zone where the sheets are to be cutted"
          },
          {
            "index": 1,
            "variable": "sSubseqZone",
            "type": "PropString",
            "displayName": "Subsequent Zones",
            "defaultValue": "|No|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": "General",
            "description": "Should the sheets of subsequent zones from the selected zone be cutted?"
          },
          {
            "index": 5,
            "variable": "dOffset",
            "type": "PropDouble",
            "displayName": "Offset",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the Offset"
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "hsbPlateWallSheetCut.xml",
            "searchPaths": [
              "_kPathHsbCompany\\TSL\\Settings",
              "_kPathHsbInstall\\Content\\General\\TSL\\Settings"
            ],
            "purpose": "Provides default values for X1, X2, Y1, Y2, Y3 if properties are at default (0) and the file exists.",
            "required": false
          }
        ]
      },
      "tokens_used": 8137,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically creates cutouts (openings) in wall sheeting/plates where a horizontal beam (purlin) penetrates the wall, ensuring proper structural clearance.",
          "category": "Structural/Machining",
          "typicalUseCase": "Used when a roof purlin or floor joist passes through an external wall, requiring a hole to be cut in the sheathing or cladding layers to accommodate the beam."
        },
        "parameters": [
          {
            "name": "dX1",
            "technicalDefault": 0,
            "businessMeaning": "Horizontal clearance added to the cutout at the bottom/start of the intersection. Defines the width expansion left and right of the beam at the lower edge.",
            "validRange": "0 - 200+ mm",
            "unit": "mm",
            "affectsOutput": "Widens the opening at the bottom of the beam penetration zone."
          },
          {
            "name": "dY1",
            "technicalDefault": 0,
            "businessMeaning": "Vertical clearance added to the cutout at the bottom/start of the intersection. Defines the height expansion downwards from the beam.",
            "validRange": "0 - 200+ mm",
            "unit": "mm",
            "affectsOutput": "Lowers the bottom edge of the opening."
          },
          {
            "name": "dX2",
            "technicalDefault": 0,
            "businessMeaning": "Horizontal clearance added to the cutout at the top/end of the intersection. Defines the width expansion left and right of the beam at the upper edge.",
            "validRange": "0 - 200+ mm",
            "unit": "mm",
            "affectsOutput": "Widens the opening at the top of the beam penetration zone."
          },
          {
            "name": "dY2",
            "technicalDefault": 0,
            "businessMeaning": "Vertical clearance added to the cutout at the top/end of the intersection. Defines the height expansion upwards from the beam.",
            "validRange": "0 - 200+ mm",
            "unit": "mm",
            "affectsOutput": "Raises the top edge of the opening."
          },
          {
            "name": "dY3",
            "technicalDefault": 0,
            "businessMeaning": "Additional vertical offset applied to the bottom of the cutout geometry. Fine-tunes the bottom edge position relative to the beam intersection line.",
            "validRange": "0 - 200+ mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the vertical start position of the bottom cutout rectangle."
          },
          {
            "name": "nZone",
            "technicalDefault": 5,
            "businessMeaning": "Selects the specific wall layer (zone) to apply the cut to. Zones typically represent layers like exterior sheathing, framing, or interior lining.",
            "validRange": "-5 to 5 (where 0 is often the main layer, negatives exterior, positives interior)",
            "unit": "Index",
            "affectsOutput": "Determines which specific material layer of the wall is cut. If set to 0, it applies to all zones depending on specific wall configuration logic."
          },
          {
            "name": "sSubseqZone",
            "technicalDefault": "|No|",
            "businessMeaning": "Toggle to propagate the cut through multiple adjacent wall layers (zones) automatically.",
            "validRange": "|No|, |Yes|",
            "unit": "Boolean",
            "affectsOutput": "If Yes, the script recursively applies cuts to the next inner/outer zones."
          },
          {
            "name": "dOffset",
            "technicalDefault": 0,
            "businessMeaning": "The incremental adjustment added to the cut dimensions (X1, X2, Y1, Y2, Y3) for each subsequent zone.",
            "validRange": "0 - 50 mm",
            "unit": "mm",
            "affectsOutput": "If 'Subsequent Zones' is Yes, the cutout gets larger or smaller by this amount for each layer deeper into the wall (creating a stepped or chamfered effect)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sSubseqZone set to |Yes|",
            "effect": "Enables recursive logic to apply cuts to neighboring zones.",
            "cascade": [
              "nZone",
              "dOffset",
              "dX1",
              "dX2",
              "dY1",
              "dY2",
              "dY3"
            ]
          },
          {
            "trigger": "Property values (dX1, dY1, etc.) left at 0",
            "effect": "Script attempts to load default values from an external XML configuration file.",
            "cascade": [
              "dX1",
              "dY1",
              "dX2",
              "dY2",
              "dY3"
            ]
          },
          {
            "trigger": "dOffset",
            "effect": "Modifies the geometry of the cut in subsequent zones (Zone +/- 1) by adding the offset value to the base dimensions.",
            "cascade": [
              "dX1",
              "dX2",
              "dY1",
              "dY2",
              "dY3"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet Cutout (Opening)",
            "description": "A complex polygonal void cut into wall sheeting/plates.",
            "appliedTo": "Sheet elements (cladding/plywood) within the selected ElementWallSF zones."
          }
        ]
      },
      "tokens_used": 10145,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11964,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbPlateWallSheetCut.mcr\n\n## Overview\nAutomatically creates cutouts (openings) in wall sheeting or structural plates where horizontal beams (such as roof purlins or floor joists) penetrate the wall. This ensures proper structural clearance without manual drafting.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D model geometry. |\n| Paper Space | No | Not applicable for 2D drawings or viewports. |\n| Shop Drawing | No | This is a detailing script, not a drawing generator. |\n\n## Prerequisites\n- **Required Entities**: You must have existing Wall entities (`ElementWallSF`) and Beam entities (`GenBeam`) in the model.\n- **Minimum Beams**: At least 1 beam intersecting the wall.\n- **Required Settings**: None strictly required, but `hsbPlateWallSheetCut.xml` is recommended for default dimensions.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  Type `TSLINSERT` in the command line.\n2.  Browse and select `hsbPlateWallSheetCut.mcr`.\n\n### Step 2: Select Intersecting Beams\n```\nCommand Line: Select intersecting beams\nAction: Click on the beam(s) (e.g., purlins) that pass through the wall. Press Enter to confirm.\n```\n\n### Step 3: Select Wall Elements\n```\nCommand Line: Select walls or entities belonging to a wall\nAction: Click on the wall outline, the wall sheeting, or any entity belonging to the specific wall where the cutouts are needed. Press Enter to confirm.\n```\n\n### Step 4: Adjust Parameters (Optional)\nAfter insertion, select the script instance and modify the dimensions in the **Properties Palette** if the defaults are not suitable.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| X1 | Number | 0 | Horizontal clearance added to the cutout at the bottom edge (widens the hole left/right at the bottom). |\n| Y1 | Number | 0 | Vertical clearance added downwards from the beam at the bottom edge. |\n| X2 | Number | 0 | Horizontal clearance added to the cutout at the top edge (widens the hole left/right at the top). |\n| Y2 | Number | 0 | Vertical clearance added upwards from the beam at the top edge. |\n| Y3 | Number | 0 | Additional vertical offset applied to fine-tune the bottom start position of the cut. |\n| Zone | Dropdown | 5 | Selects the specific wall layer (zone) to cut. (e.g., -5 to 5). Check your wall setup to identify the correct layer index. |\n| Subsequent Zones | Dropdown | \\|No\\| | Set to \\|Yes\\| to automatically apply the cut to adjacent wall layers as well. |\n| Offset | Number | 0 | If \"Subsequent Zones\" is Yes, this value adjusts the size of the cut for each additional layer (creating a stepped effect). |\n\n## Right-Click Menu Options\nThis script does not add specific custom options to the right-click context menu. Use the standard AutoCAD properties to modify parameters.\n\n## Settings Files\n- **Filename**: `hsbPlateWallSheetCut.xml`\n- **Location**: \n  - `_kPathHsbCompany\\TSL\\Settings`\n  - `_kPathHsbInstall\\Content\\General\\TSL\\Settings`\n- **Purpose**: If the properties (X1, Y1, etc.) are left at 0, the script attempts to read default dimensions from this XML file. This allows you to set company-wide standard cutout sizes without manually typing them every time.\n\n## Tips\n- **Zero Dimensions**: If you run the script and see no cutout (or a tiny line), check if your Property values are 0. If they are, the script is looking for the XML file. Either configure the XML file or manually type dimensions in the Properties palette.\n- **Zones**: Walls are often built of multiple layers (e.g., framing, sheathing, cladding). Use the **Zone** property to target exactly which layer needs the hole.\n- **Visualizing**: It is often easier to insert the script with standard dimensions first, then use the Properties Palette to fine-tune the clearances until they look correct in the 3D model.\n\n## FAQ\n- **Q: Why is my cutout size 0?**\n  A: The script properties default to 0, expecting an XML settings file to provide the dimensions. Ensure `hsbPlateWallSheetCut.xml` exists in your settings folder, or manually enter values for X1, Y1, X2, and Y2 in the properties.\n- **Q: Can I cut through the entire wall thickness at once?**\n  A: Yes. Set **Subsequent Zones** to `|Yes|` and select the starting Zone. The script will propagate the cut through adjacent layers.\n- **Q: What does the Offset parameter do?**\n  A: It adds (or subtracts) from the cut dimensions for every layer away from the selected Zone. This is useful for creating clearance for tapered insulation or allowing for play in the structure."
      },
      "tokens_used": 5258,
      "error": null
    }
  }
}