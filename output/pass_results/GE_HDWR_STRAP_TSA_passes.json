{
  "filename": "GE_HDWR_STRAP_TSA.mcr",
  "status": "completed",
  "total_tokens": 23377,
  "processing_time": 231.84374523162842,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "v1.2",
            "date": "02.JUN.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Warning of manually insertion updated"
          },
          {
            "version": "v1.1",
            "date": "18.mar.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description updated"
          },
          {
            "version": "v1.0",
            "date": "14.nov.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release. Created as dummy only. Meant to be inserted bye other TSL's."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4139,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script generates 3D geometry using Body, Point3d, and Vector3d. It checks for insertion via _bOnInsert and uses _Map for data transfer. There are no references to sd_ functions, _Viewport, or shop drawing specific entities."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D). Inserted via other TSL scripts using _Map data.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2084,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "Anchor type",
            "defaultValue": "TSA18",
            "inputType": "dropdown",
            "options": [
              "TSA18",
              "TSA24"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2648,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates 3D geometry for Simpson Strong-Tie TSA (Truss Strap Anchor) hardware with specific nail hole patterns.",
          "category": "Hardware/Connectors",
          "typicalUseCase": "Automatically inserted by parent scripts (e.g., wall/framing generators) to represent truss-to-wall connections."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "\"TSA18\"",
            "businessMeaning": "Specifies the manufacturer part number and length of the truss strap (18 inches or 24 inches).",
            "validRange": "\"TSA18\", \"TSA24\"",
            "unit": "String",
            "affectsOutput": "Determines the overall length of the strap and the total number of nail holes generated along its length."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User selects a different sType (e.g., TSA18 -> TSA24) via properties",
            "effect": "Recalculates the strap length and extends the nailing pattern loop.",
            "cascade": [
              "dLength",
              "dHalfL",
              "hole count"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MetalPart (Body)",
            "description": "A flat steel strap (1.25\" wide x 0.125\" thick) with a specific pattern of cylindrical holes for nailing.",
            "appliedTo": "Inserted at the global point passed via _Map (usually on top of a wall plate)."
          }
        ]
      },
      "tokens_used": 4386,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script initializes: Loads arrays for TSA types (TSA18, TSA24) and defines the 'sType' property.",
          "2. Checks insertion flag (_bOnInsert).",
          "3. [Conditional] If manually inserted, displays warning message and erases the instance immediately.",
          "4. [Conditional] If inserted programmatically, reads configuration (vectors, type, directive flags) from the internal _Map.",
          "5. [Conditional] If 'InsertedByDirective' flag is present, locks the 'sType' property to Read-Only.",
          "6. Checks for associated Elements. If exactly one element is found, establishes a dependency to delete the script if the element is deleted.",
          "7. Calculates geometric parameters based on the selected 'sType' (Length, Half-Length).",
          "8. Generates the main strap Body (Rectangular PLine extruded by thickness).",
          "9. Enters loop to generate nail holes: Creates cylindrical cutouts and subtracts them from the strap body at 3-inch intervals.",
          "10. Renders the final geometry in the 3D view."
        ],
        "conditionalBranches": [
          {
            "condition": "Manual vs. Programmatic Insertion (Check _bOnInsert)",
            "path1": {
              "name": "Manual Insertion",
              "steps": [
                "Script detects _bOnInsert is true",
                "Reports 'No manual insertion defined' warning to command line",
                "Executes eraseInstance()",
                "Script terminates"
              ]
            },
            "path2": {
              "name": "Programmatic Insertion (via _Map)",
              "steps": [
                "Script bypasses manual insertion check",
                "Retrieves Type and Vectors from _Map",
                "Proceeds to geometry generation"
              ]
            }
          },
          {
            "condition": "Map Data Availability",
            "path1": {
              "name": "Map Data Present",
              "steps": [
                "Overrides default vectors (vx, vy, vz) with values from _Map",
                "Overrides default 'sType' with value from _Map"
              ]
            },
            "path2": {
              "name": "Map Data Missing (Fallback)",
              "steps": [
                "Uses default World Coordinate vectors (_ZW, _XW, _YW)",
                "Uses default property value for 'sType'"
              ]
            }
          },
          {
            "condition": "Editability Locking",
            "path1": {
              "name": "Directive Locked",
              "steps": [
                "Map contains 'InsertedByDirective' = 1",
                "Sets 'sType' property to Read-Only",
                "User cannot change hardware type via Properties Palette"
              ]
            },
            "path2": {
              "name": "User Editable",
              "steps": [
                "Map flag is missing or 0",
                "'sType' remains writable",
                "User can modify hardware type via Properties Palette"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insertion Method",
            "errorMessage": "\"GE_HDWR_STRAP_TSA: This TSL has not yet a manual insertion defined. It can be inserted only by other script. Instance will be erased\"",
            "recovery": "Do not run manually. Insert using the parent TSL intended to generate this strap (e.g., wall/framing generator)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Hardware Type",
            "how": "Properties Palette (OPM) -> 'Anchor type' dropdown",
            "effect": "Updates 'sType' variable. Script recalculates 'dLength'. Regenerates strap body and adjusts the number/spacing of nail holes."
          },
          {
            "action": "Move Script",
            "how": "Grip edit (Move)",
            "effect": "Translates the coordinate system origin (_Pt0). The strap geometry and holes move to the new location."
          },
          {
            "action": "Rotate Script",
            "how": "Grip edit (Rotate) or Properties Palette (if exposed/available via mapping)",
            "effect": "Updates the orientation vectors (vx, vy, vz). The strap aligns to the new rotation."
          },
          {
            "action": "Delete Host Element",
            "how": "Delete the architectural element associated with the script",
            "effect": "Triggers _bOnElementDeleted. Script executes eraseInstance() and removes itself from the model."
          }
        ]
      },
      "tokens_used": 5330,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_HDWR_STRAP_TSA.mcr\n\n## Overview\nThis script generates 3D geometry for Simpson Strong-Tie TSA (Truss Strap Anchor) hardware, creating a steel strap with a specific nail hole pattern. It is designed strictly for automatic insertion by other TSL scripts (such as wall or truss generators) and cannot be manually placed by the user.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the intended environment for generating 3D hardware bodies. |\n| Paper Space | No | Not supported for 2D layout. |\n| Shop Drawing | No | Does not generate 2D shop drawings directly. |\n\n## Prerequisites\n- **Required Entities:** None (Geometry is generated based on internal calculations and coordinate mapping).\n- **Minimum Beam Count:** 0.\n- **Required Settings:** None.\n- **Additional Info:** This script relies on internal data mapping (`_Map`) provided by a parent script to determine its location, rotation, and initial type. It generally requires an associated Element (e.g., a wall plate or beam) to attach to.\n\n## Usage Steps\n\n### Step 1: Attempt to Launch Script\n**Command:** `TSLINSERT` → Select `GE_HDWR_STRAP_TSA.mcr`\n\n### Step 2: Observe Behavior\n```\nCommand Line: GE_HDWR_STRAP_TSA: This TSL has not yet a manual insertion defined. It can be inserted only by other script. Instance will be erased\n```\n**Action:** The script detects it is being run manually. It will display the warning above, and the script instance will immediately delete itself from the drawing.\n\n**Note:** This script is intended to be executed automatically by a parent script (e.g., a \"Generate Wall\" or \"Place Hardware\" macro) that calculates the position and passes the necessary data to this script.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Anchor type | Dropdown | TSA18 | Selects the Simpson Strong-Tie model number. <br>• **TSA18**: 18\" long strap.<br>• **TSA24**: 24\" long strap. <br>Changing this updates the strap length and the number of nail holes. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Move | Standard grip action to translate the strap along the X/Y plane. |\n| Rotate | Standard grip action to rotate the strap around its insertion point. |\n| *Custom Options* | None. The script uses standard AutoCAD/hsbCAD manipulation tools. |\n\n## Settings Files\n- **None.** This script operates entirely based on internal logic and Properties Palette inputs; it does not require external XML or configuration files.\n\n## Tips\n- **Do Not Run Manually:** Because this script requires orientation vectors and origin points from a parent script, manual insertion will always fail. Use the specific wall or framing tool designed to place this strap.\n- **Modifying Hardware:** You can change the length of the strap after it is placed by a parent script. Select the strap in the model, open the **Properties Palette**, and change \"Anchor type\" from TSA18 to TSA24.\n- **Host Dependency:** The script attempts to link itself to a host element. If you delete the architectural element (e.g., the top plate) the strap is attached to, the script will automatically delete itself to prevent orphaned geometry.\n\n## FAQ\n- **Q: Why does the strap disappear immediately after I try to insert it?**\n  - A: This script is a \"sub-script\" or \"component\" script meant to be called by other software routines. It lacks the user prompts (like \"Select a point\") required for manual insertion, so it erases itself to prevent errors.\n- **Q: Can I switch from an 18-inch strap to a 24-inch strap?**\n  - A: Yes. Select the strap in the 3D model, press `Ctrl+1` to open the Properties Palette, and change the \"Anchor type\" property to TSA24.\n- **Q: How do I rotate the strap to align with my beam?**\n  - A: Use the standard **Rotate** grip or command. Since the script is usually inserted by a smarter parent tool, it should already be aligned correctly. If not, ensure your UCS or parent tool inputs are correct."
      },
      "tokens_used": 4790,
      "error": null
    }
  }
}