{
  "filename": "Simpson-Strong-Tie-GERW.mcr",
  "status": "completed",
  "total_tokens": 48056,
  "processing_time": 233.1523094177246,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": null,\n    \"minorVersion\": null,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"This tsl creates Gerberverbinder GERW see https://www.strongtie.de/products/detail/gerberverbinder/539 user selects all beams. A TSL instance will be created for every connection where possible. When no valid 2 beams are found for placing the connection, a prompt will show up for clicking a point that will split the beam plane from the point normal with first beam will split the beam all beams in selection that are parallel with the first beam are also splitted if possible the connection will be placed so that the connection better withstands the load from _ZW With the custom command Swap X-(-X), the vector X of connection is swaped with -X and the connection is mirrored to the YZ plane\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.2\",\n      \"date\": \"01.09.2023\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"HSB-19908: On \\\"Automatic\\\" selection the TSL will consider the recommended gap value of 20mm; Type can now be freely changed manually\"\n    },\n    {\n      \"version\": \"1.1\",\n      \"date\": \"17.10.2019\",\n      \"author\": \"marsel.nakuci@hsbcad.com\",\n      \"changes\": \"add picture\"\n    },\n    {\n      \"version\": \"1.0\",\n      \"date\": \"15may2019\",\n      \"author\": \"marsel.nakuci@hs"
      },
      "tokens_used": 9456,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Beam entities and performs 3D geometry operations including addToolStatic(Cut(...)) on beams to create joints. It constructs Body objects for visualization and manages HardWrComp for BOM, typical of 3D model connection scripts. No sd_* prefix, _Viewport references, or 2D drafting logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "hsbCAD environment with timber beams",
            "Unit system defined (handled via U() function)"
          ]
        }
      },
      "tokens_used": 7563,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select beam(s)|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "On insert if no execution key is provided",
            "title": null,
            "dataSource": "Internal Properties (Type, Gap, Nailing)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Type|",
            "defaultValue": "|Automatic|",
            "inputType": "dropdown",
            "options": [
              "|Automatic|",
              "GERW90",
              "GERW120",
              "GERW140",
              "GERW160",
              "GERW180",
              "GERW200",
              "GERW220",
              "GERW240",
              "GERW260",
              "GERW280",
              "GERW300",
              "GERW320",
              "GERW340",
              "GERW360",
              "GERW380",
              "GERW400",
              "GERW420"
            ],
            "category": "|General|",
            "description": "|Defines the model of the connector|"
          },
          {
            "index": 1,
            "variable": "dGap",
            "type": "PropDouble",
            "displayName": "|Gap|",
            "defaultValue": 10,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Gap|"
          },
          {
            "index": 2,
            "variable": "sNailPattern",
            "type": "PropString",
            "displayName": "|Nailing Pattern|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "|Full Nailing|",
              "|Part Nailing|"
            ],
            "category": "|Nailing|",
            "description": "|Defines the nail pattern|"
          },
          {
            "index": 3,
            "variable": "sNail",
            "type": "PropString",
            "displayName": "|Nail type|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "CNA4,0x40",
              "CNA4,0x50",
              "CNA4,0x60"
            ],
            "category": "|Nailing|",
            "description": "|Defines the Nail type|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "../|Swap Z-(-Z)|",
            "handler": "../|Swap Z-(-Z)|",
            "action": "Toggles the swapZ state, mirroring the connector geometry across the ZC plane.",
            "alsoTriggeredBy": "Double-click"
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 7891,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 7747,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script Start: Detects _bOnInsert flag.\",\n    \"Input Source Check: Determines if run via Command Line (Catalog) or Menu/Toolbar (Default).\",\n    \"Properties Initialization: Loads catalog values if key exists, or shows Properties Palette (OPM) for user input.\",\n    \"Entity Selection: Prompts user (PrEntity) to select beam(s).\",\n    \"Selection Validation: Checks if at least 1 beam is selected.\",\n    \"Generator Loop: Iterates through selected beams to find valid pairs.\",\n    \"Geometric Pre-check: Filters pairs for parallelism, axis alignment, and cross-section match.\",\n    \"Instance Generation: Creates a new TSL instance for every valid pair found.\",\n    \"Cleanup: Erases the original 'Generator' script instance.\",\n    \"Instance Execution (New Instance): Determines connection vector and gap between beam pair.\",\n    \"Model Selection: Selects connector model (GERW...) based on 'Automatic' logic or manual override.\",\n    \"Validation: Verifies a valid connector model fits the geometry.\",\n    \"Placement: Calculates insertion point (_Pt0) at mid-point or user-defined location.\",\n    \"Processing: Applies cuts to beams, generates 3D Body geometry, and updates Hardware (BOM).\",\n    \"Completion: Script finishes calculation.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Script Trigger Mode\",\n      \"path1\": {\n        \"name\": \"Catalog/Key Insertion\",\n        \"steps\": [\n          \"Read _kExecuteKey\",\n          \"Match key against Catalog names\",\n          \"Set Properties from Catalog entry\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Standard Insertion\",\n        \"steps\":"
      },
      "tokens_used": 10840,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Simpson-Strong-Tie-GERW.mcr\n\n## Overview\nThis script automates the placement of Simpson Strong-Tie Gerber connectors (GERW series) between selected timber beams. It detects valid connections, splits beams if necessary to accommodate the connection, and generates the appropriate 3D geometry and hardware data.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D beam entities. |\n| Paper Space | No | Not designed for 2D detailing views. |\n| Shop Drawing | No | Logic is strictly for model generation. |\n\n## Prerequisites\n- **Required entities**: Timber Beams (Element or GenBeam).\n- **Minimum beam count**: At least 1 beam (though connections require pairs, the script handles selection of multiple beams to find valid pairs).\n- **Required settings**: hsbCAD environment with timber beams loaded.\n\n## Usage Steps\n\n### Step 1: Launch Script\nExecute the script using the `TSLINSERT` command in AutoCAD and select `Simpson-Strong-Tie-GERW.mcr` from the list.\n\n### Step 2: Select Beams\n```\nCommand Line: Select beam(s)\nAction: Click to select the beams where you want to place Gerber connections. You can select multiple beams at once.\n```\n\n### Step 3: Configure Connection\nAfter selection, the script will analyze the geometry.\n- If the beams form valid intersections/end-points, connectors will be placed automatically.\n- If the beams do not naturally meet connection criteria, you may be prompted to click a point to split the beam plane to facilitate placement.\n- Adjust parameters in the **Properties Palette** if the automatic settings are not suitable.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | dropdown | Automatic | Selects the specific connector model (GERW90 to GERW420). \"Automatic\" picks the best fit based on geometry. |\n| Gap | number | 10 | Defines the gap distance for the connection. (Automatic mode uses a recommended 20mm gap). |\n| Nailing Pattern | dropdown | - | Choose between \"Full Nailing\" or \"Part Nailing\". |\n| Nail type | dropdown | - | Select the nail specification (e.g., CNA4,0x40). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Swap Z-(-Z) | Mirrors the connector geometry across the ZC plane (toggles the orientation). |\n\n## Settings Files\n- **Filename**: None specified.\n- **Location**: N/A\n- **Purpose**: This script relies on internal catalog data for connector dimensions rather than external XML settings files.\n\n## Tips\n- **Automatic Mode**: Use the \"Automatic\" type setting to let the script select the correct connector size based on the beam geometry. It calculates a recommended gap of 20mm.\n- **Quick Swap**: You can double-click the generated connector instance to trigger the \"Swap Z-(-Z)\" command to flip its orientation quickly.\n- **Batch Processing**: You can select a large group of beams; the script will iterate through them and create a connection instance for every valid pair found.\n\n## FAQ\n- **Q: Why did the script ask me to click a point?**\n  **A**: The beams you selected may not have a valid intersection for the connector. The script allows you to define a split point on the beam to create a valid surface for placing the Gerber connection.\n  \n- **Q: Can I change the connector size after insertion?**\n  **A**: Yes. Select the generated TSL instance and change the \"Type\" property in the Properties Palette to any specific GERW model (e.g., GERW200)."
      },
      "tokens_used": 4559,
      "error": null
    }
  }
}