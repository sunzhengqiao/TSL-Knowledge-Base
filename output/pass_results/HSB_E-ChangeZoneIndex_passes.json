{
  "filename": "HSB_E-ChangeZoneIndex.mcr",
  "status": "completed",
  "total_tokens": 29628,
  "processing_time": 828.5431659221649,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 2,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "27.12.2012",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "17.01.2013",
            "author": "AS",
            "changes": "Input mode added."
          },
          {
            "version": "1.02",
            "date": "22.02.2013",
            "author": "AS",
            "changes": "Add zone 0 to the list of indexes"
          },
          {
            "version": "1.03",
            "date": "01.03.2013",
            "author": "AS",
            "changes": "Correct zone 0 bug, accept genbeams io sheets."
          },
          {
            "version": "2.00",
            "date": "26.09.2017",
            "author": "RP",
            "changes": "Add include and exclude and also add categories"
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "HSB_G-FilterGenBeams"
        ]
      },
      "tokens_used": 6317,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script explicitly uses _kModelSpace during dbCreate; interacts with Element and GenBeam objects; no sd_ prefix, #Type E, or _Viewport references found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (hsbCAD 3D Model)",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 3919,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "|Select one or more entities|",
              "condition": "nInputMode == 0 (Beams/Sheets)",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity.go",
              "promptOriginal": "|Select one or more elements|",
              "condition": "nInputMode == 1 (Elements)",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "On Insert (_bOnInsert) if _kExecuteKey is empty or not in catalog",
            "title": null,
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 1,
            "variable": "sInputMode",
            "type": "PropString",
            "displayName": "|Input mode|",
            "defaultValue": "|Beams|/|sheets|",
            "inputType": "dropdown",
            "options": [
              "|Beams|/|sheets|",
              "|Elements|"
            ],
            "category": "|Selection|",
            "description": "|Specify wheter you want to select individual beams/sheets or elements|"
          },
          {
            "index": 2,
            "variable": "excludeString",
            "type": "PropString",
            "displayName": "|Filter mode|",
            "defaultValue": "|Exclude|",
            "inputType": "dropdown",
            "options": [
              "|Exclude|",
              "|Include|"
            ],
            "category": "|Filters|",
            "description": "|Specify wheter you want to include or exclude the beams matching the filtercriteria|"
          },
          {
            "index": 3,
            "variable": "sFilterBC",
            "type": "PropString",
            "displayName": "|Filter beams with beamcode|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Filters|",
            "description": "|Specify which beams and sheets you want to filter by specifying a beamcode or a list of beamcodes with semicolon as delimeter|"
          },
          {
            "index": 4,
            "variable": "sFilterLabel",
            "type": "PropString",
            "displayName": "|Filter beams and sheets with label|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Filters|",
            "description": "|Specify which beams and sheets you want to filter by specifying a label or a list of labels with semicolon as delimeter|"
          },
          {
            "index": 5,
            "variable": "sFilterMaterial",
            "type": "PropString",
            "displayName": "|Filter beams and sheets with material|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Filters|",
            "description": "|Specify which beams and sheets you want to filter by specifying a material or a list of materials with semicolon as delimeter|"
          },
          {
            "index": 0,
            "variable": "nZoneIndexFrom",
            "type": "PropInt",
            "displayName": "|From zone|",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              0,
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10
            ],
            "category": "|Zone|",
            "description": "|Specify the current zone from the beams and sheets you want to change|"
          },
          {
            "index": 1,
            "variable": "nZoneIndexTo",
            "type": "PropInt",
            "displayName": "|To zone|",
            "defaultValue": 1,
            "inputType": "dropdown",
            "options": [
              0,
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10
            ],
            "category": "|Zone|",
            "description": "|Specify the zone that the beams and sheets need to get|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6218,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A batch processing utility used to update the 'Zone Index' classification of timber beams and sheets within specific construction elements.",
          "category": "DataManagement",
          "typicalUseCase": "Re-classifying specific structural members (e.g., walls or roof panels) from one construction phase or fire zone to another, while allowing filtering by material, label, or beam code."
        },
        "parameters": [
          {
            "name": "sInputMode",
            "technicalDefault": "|Beams|/|sheets|",
            "businessMeaning": "Defines the selection scope, determining whether the user manually selects individual pieces or selects entire Elements (walls/floors) to process all contained beams.",
            "validRange": "Selection of one of two predefined options",
            "unit": "Selection Mode",
            "affectsOutput": "Determines the initial pool of entities that the script will attempt to modify."
          },
          {
            "name": "excludeString",
            "technicalDefault": "|Exclude|",
            "businessMeaning": "Controls the logic of subsequent filter parameters. 'Exclude' removes items matching the criteria from the selection, while 'Include' keeps only items matching the criteria.",
            "validRange": "|Exclude| or |Include|",
            "unit": "Logic",
            "affectsOutput": "Inverts the logic of the Material, Label, and BeamCode filters."
          },
          {
            "name": "sFilterBC",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their specific hsbCAD Beam Code (e.g., 'STUD', 'PLATE', 'RB'). Supports semicolon-separated lists.",
            "validRange": "Valid Beam Codes defined in the project",
            "unit": "String",
            "affectsOutput": "Narrows the selection of beams to be updated based on their structural type."
          },
          {
            "name": "sFilterLabel",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on a user-assigned label string.",
            "validRange": "Any alphanumeric string",
            "unit": "String",
            "affectsOutput": "Narrows the selection of beams to be updated based on metadata labels."
          },
          {
            "name": "sFilterMaterial",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their material code (e.g., 'C24', 'GL24h').",
            "validRange": "Valid Material codes defined in the catalog",
            "unit": "String",
            "affectsOutput": "Narrows the selection of beams to be updated based on material grade or type."
          },
          {
            "name": "nZoneIndexFrom",
            "technicalDefault": 0,
            "businessMeaning": "The source Zone Index. Only beams currently assigned to this zone will be considered for change. Note: Values > 5 are converted to negative indices by the script logic.",
            "validRange": "0 to 10 (mapped internally to 0-5 or -1 to -5)",
            "unit": "Count/Index",
            "affectsOutput": "Acts as the primary filter: the script ignores any beam not currently in this zone."
          },
          {
            "name": "nZoneIndexTo",
            "technicalDefault": 1,
            "businessMeaning": "The destination Zone Index. All filtered beams will be reassigned to this zone.",
            "validRange": "0 to 10 (mapped internally to 0-5 or -1 to -5)",
            "unit": "Count/Index",
            "affectsOutput": "Sets the new classification value (Zone Index) on the target beams."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "excludeString is set to |Exclude|",
            "effect": "The script chains filters to remove matching items (e.g., removes beams matching the Material code from the current selection).",
            "cascade": [
              "sFilterBC",
              "sFilterLabel",
              "sFilterMaterial"
            ]
          },
          {
            "trigger": "excludeString is set to |Include|",
            "effect": "The script treats filter criteria as additive requirements, filtering the original list down to only those beams matching the criteria.",
            "cascade": [
              "sFilterBC",
              "sFilterLabel",
              "sFilterMaterial"
            ]
          },
          {
            "trigger": "nZoneIndexFrom",
            "effect": "Must match the beam's current property for it to be affected by any other filters or the final change.",
            "cascade": [
              "sFilterBC",
              "sFilterLabel",
              "sFilterMaterial"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "AttributeUpdate",
            "description": "Updates the 'ZoneIndex' property on existing GenBeams/Sheets. No physical geometry or machining is created or modified.",
            "appliedTo": "GenBeams and Sheets contained within the selected Elements."
          }
        ]
      },
      "tokens_used": 7479,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-ChangeZoneIndex\n\n## Overview\nThis script allows you to batch update the Zone Index classification for timber beams and sheets. It provides options to target specific elements or individual pieces based on filters such as material, beam code, and labels.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the 3D Model. |\n| Paper Space | No | Not supported in layouts. |\n| Shop Drawing | No | Not supported in drawing generation mode. |\n\n## Prerequisites\n- **Required Entities**: Existing Elements (Walls/Floors) or GenBeams/Sheets in the model.\n- **Minimum Beam Count**: 0 (Script runs on selection).\n- **Required Settings**: `HSB_G-FilterGenBeams` (System dependency).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `HSB_E-ChangeZoneIndex.mcr`\n\n### Step 2: Configure Properties\nOnce inserted, the Properties Palette will appear. Adjust the parameters below to define which items to select and how to filter them before confirming the selection.\n\n### Step 3: Select Entities\nAfter configuring properties, look at the AutoCAD command line:\n```\nCommand Line: Select one or more entities [or Select one or more elements]\nAction: Click the beams, sheets, or elements in the model that you wish to process, then press Enter.\n```\n*Note: The prompt text changes based on your \"Input mode\" selection in the Properties panel.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Input mode | dropdown | Beams/sheets | Choose whether to select individual beams/sheets manually or select entire Elements (which processes all beams inside them). |\n| Filter mode | dropdown | Exclude | Determines how other filters work. \"Exclude\" removes matching items from selection; \"Include\" keeps only matching items. |\n| Filter beams with beamcode | text | [Empty] | Enter a Beam Code (e.g., `STUD`) or list (e.g., `STUD;PLATE`) to filter specific structural types. |\n| Filter beams and sheets with label | text | [Empty] | Enter a label or list of labels (separated by semicolons) to filter by user-assigned labels. |\n| Filter beams and sheets with material | text | [Empty] | Enter a material code or list (e.g., `C24;GL24h`) to filter by material grade. |\n| From zone | number | 0 | The current Zone Index of the beams you want to change. Only beams currently in this zone will be affected. |\n| To zone | number | 1 | The new Zone Index to assign to the filtered beams. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are available for this script. |\n\n## Settings Files\n- **Dependency**: `HSB_G-FilterGenBeams`\n- **Purpose**: Provides the underlying logic for filtering generic beams based on the script's criteria.\n\n## Tips\n- **Multiple Filters**: When entering values for Beam Code, Label, or Material filters, use a semicolon (`;`) to separate multiple values (e.g., `C24;C18`).\n- **Source Zone Logic**: The `From zone` parameter acts as a master switch. If a selected beam is not in the specific \"From zone\" you defined, it will be ignored, regardless of other filters.\n- **Zone Range**: The dropdown offers values 0–10. Values 6–10 are internally mapped to negative zones (-1 to -5) by the script, allowing for specialized negative zone indexing if your project uses it.\n\n## FAQ\n- **Q: I selected beams, but their zone didn't change. Why?**\n  A: Check the `From zone` setting. The script only changes beams that are currently assigned to that specific source zone. If your beam is in Zone 0 and the script is set to change beams from Zone 1, nothing will happen.\n  \n- **Q: How do I select everything in a wall except the studs?**\n  A: Set `Input mode` to Elements, set `Filter mode` to Exclude, and type `STUD` (or the relevant code) into the `Filter beams with beamcode` field. Select the wall element, and the script will update all non-stud beams.\n\n- **Q: Can I use wildcards in the filter fields?**\n  A: This script typically looks for exact matches or semicolon-separated lists. Wildcards (like * or ?) are generally not supported in the text filter fields for this specific script version."
      },
      "tokens_used": 5695,
      "error": null
    }
  }
}