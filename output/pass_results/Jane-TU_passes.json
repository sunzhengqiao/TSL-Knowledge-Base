{
  "filename": "Jane-TU.mcr",
  "status": "completed",
  "total_tokens": 55662,
  "processing_time": 266.89683079719543,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9527,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script generates 3D geometry (Body, Drill, MarkerLine) and modifies beam entities (addTool). It uses PrEntity to select beams on insertion and contains no Shop Drawing (#Type E) or Paper Space (_kPaperSpace, _Viewport) specific logic or prefixes."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 7182,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Select male beams\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Select female beam(s)\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowNotice\",\n      \"trigger\": \"Script Error / Calculation Failure\",\n      \"title\": null,\n      \"dataSource\": \"Hardcoded String\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Type\",\n      \"defaultValue\": \"JANE-TU 12\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"JANE-TU 12\",\n        \"JANE-TU 16\",\n        \"JANE-TU 20\",\n        \"JANE-TU 24\",\n        \"JANE-TU 28\"\n      ],\n      \"category\": \"Model\",\n      \"description\": \"Defines the Type\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sSlotClosed\",\n      \"type\": \"PropString\",\n      \"displayName\": \"bottom closed\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": \"Slot\",\n      \"description\": \"Determines if the connection is visible.\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSlotNormal\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Normal\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": \"Slot\",\n      \"description\": \"Defines if the Slot Normal with the face of the male beam\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sEndLap\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Beam End Lap\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\",\n        \"None\"\n      ],\n      \"category\": \"Tooling\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sDrillFace\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Drill Face\",\n      \"defaultValue\": \"Side 1\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Side 1\",\n        \"Side 2\"\n      ],\n      \"category\": \"Alignment\",\n     "
      },
      "tokens_used": 10208,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates 3D geometry, machining, and shop drawings for Simpson Strong-Tie Jane-TU top-flange timber hangers.\",\n    \"category\": \"Hardware Connector\",\n    \"typicalUseCase\": \"Connecting timber joists (male beams) to a supporting beam (female beam) using a high-capacity hanger that utilizes wooden pegs (dowels) for shear load transfer.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sType\",\n      \"technicalDefault\": \"\\\"JANE-TU 12\\\"\",\n      \"businessMeaning\": \"Selects the specific manufacturer SKU (Jane-TU 12, 16, 20, 24, or 28), defining the physical dimensions and load capacity of the metal connector.\",\n      \"validRange\": \"JANE-TU 12 to JANE-TU 28\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Changes the metal plate size (A, B, C dimensions), number of peg holes, and peg diameter.\"\n    },\n    {\n      \"name\": \"sSlotClosed\",\n      \"technicalDefault\": \"\\\"Yes\\\"\",\n      \"businessMeaning\": \"Determines if the bottom of the pocket/housing cut into the female beam is enclosed.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Modifies the pocket geometry in the female beam; 'No' typically creates an open-bottom or through-cut.\"\n    },\n    {\n      \"name\": \"sSlotNormal\",\n      \"technicalDefault\": \"\\\"No\\\"\",\n      \"businessMeaning\": \"Aligns the orientation of the pocket cut in the female beam with the face of the incoming male beam.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Rotates the pocket cut plane. 'Yes' aligns it to the male beam (critical for non-90-degree connections), 'No' keeps it orthogonal to the female beam.\"\n    },\n    {\n      \"name\": \"sEndLap\",\n      \"technicalDefault\": \"\\\"Yes\\\"\",\n      \"businessMeaning\": \"Specifies if the end of the male beam (joist) requires a specialized lap or birdsmouth cut to fit the connector geometry.\",\n      \"validRange\": \"Yes, No, None\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Controls the creation of a `BeamCut` (end trim) on the male beam.\"\n    },\n    {\n      \"name\": \"sDrillFace\",\n      \"technicalDefault\": \"\\\"Side 1\\\"\",\n      \"businessMeaning\": \"Selects which lateral side of the male beam is drilled for the wooden pegs/dowels.\",\n      \"validRange\": \"Side 1, Side 2\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Moves the drill locations to the specified side of the male beam.\"\n    },\n    {\n      \"name\": \"sMark\",\n      \"technicalDefault\": \"\\\"Marking\\\"\",\n      \"businessMeaning\": \"Controls the type of text or line marking applied to the female beam to indicate connector placement on the shop floor.\",\n      \"validRange\": \"Marking, Marking and Description, Marking and PosNum, None\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Adds or suppresses `MarkerLine` and text entities on the female beam.\"\n    },\n    {\n      \"name\": \"dDepthFemale\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Defines the depth of the housing/pocket cut into the female beam to recess the connector.\",\n      \"validRange\": \"0 mm (surface mount) to Female Beam Depth\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Depth of the Pocket operation in the female beam.\"\n    },\n    {\n      \"name\": \"dGap\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Defines the clearance allowance around the metal connector within the female beam pocket.\",\n      \"validRange\": \"0 - 50 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Expands the dimensions of the pocket cut in the female beam.\"\n    },\n    {\n      \"name\": \"dTxtH\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Sets the height of the marking text drawn on the beam.\",\n      \"validRange\": \"10 - 100 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Scales the text size of the marking.\"\n    },\n    {\n      \"name\": \"dYOffset\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Offsets the connector position along the width of the female beam (lateral shift).\",\n      \"validRange\": \"-200 to 200 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the entire connector and machining along the female beam's Y-axis.\"\n    },\n    {\n      \"name\": \"dZOffset\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Offsets the connector position vertically relative to its default placement.\",\n      \"validRange\": \"-200 to 200 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the entire connector and machining along the vertical axis.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": \"8\",\n      \"businessMeaning\": \"Sets the display color of the generated metal part in the CAD model.\",\n      \"validRange\": \"0 - 255 (AutoCAD Color Index)\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual representation only.\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"<Current DimStyle>\",\n      \"businessMeaning\": \"Selects the dimension style to use for generated dimensions (if any).\",\n      \"validRange\": \"Available DimStyles in Project\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Visual styling of dimensions.\"\n    },\n    {\n      \"name\": \"dDepth\",\n      \"technicalDefault\":"
      },
      "tokens_used": 10619,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches the Jane-TU.mcr script",
          "[OnInsert] Script initializes Properties and displays the configuration dialog (showDialog)",
          "[OnInsert] User is prompted to select 'male beams' (PrEntity)",
          "[OnInsert] User is prompted to select 'female beam(s)' (PrEntity)",
          "[OnInsert] Script verifies selected beams and places the TSL instance",
          "[Calculation] Script retrieves properties (sType, sSlotClosed, etc.) and beam references",
          "[Calculation] Script extracts geometric parameters for the selected Jane-TU connector type",
          "[Calculation] Script calculates intersection points and coordinate systems between male and female beams",
          "[Calculation] Script determines drill positions based on sDrillFace and connector dimensions",
          "[Calculation] Script generates Pocket/Slot geometry in female beam (Closed/Normal vs Open/Angled)",
          "[Execution] Script applies Drill tools to metal part and male beam (if sDrillMaleBeam=Yes)",
          "[Execution] Script applies BeamCut to male beam (if sEndLap != None)",
          "[Execution] Script adds Peg and Screw hardware data to the instance",
          "[Execution] Script applies Marking (MarkerLine) to female beams based on sMark setting",
          "[Completion] Visual representation (Body) is generated in the Model Space"
        ],
        "conditionalBranches": [
          {
            "condition": "_bOnInsert flag status",
            "path1": {
              "name": "Insertion Mode",
              "steps": [
                "Show Dialog",
                "Select Male Beams",
                "Select Female Beams",
                "Instance Created"
              ]
            },
            "path2": {
              "name": "Update/Recalc Mode",
              "steps": [
                "Read Properties",
                "Recalculate Geometry",
                "Update Machining",
                "Update Visuals"
              ]
            }
          },
          {
            "condition": "sSlotClosed property",
            "path1": {
              "name": "Slot Closed (Yes)",
              "steps": [
                "Calculates closed bottom pocket geometry",
                "Creates enveloping solid for female beam"
              ]
            },
            "path2": {
              "name": "Slot Open (No)",
              "steps": [
                "Calculates open slot geometry",
                "Modifies profile generation"
              ]
            }
          },
          {
            "condition": "sSlotNormal property",
            "path1": {
              "name": "Normal to Female Beam (No)",
              "steps": [
                "Aligns slot cut orthogonal to female beam axis"
              ]
            },
            "path2": {
              "name": "Normal to Male Beam (Yes)",
              "steps": [
                "Rotates slot cut plane to match male beam face"
              ]
            }
          },
          {
            "condition": "sEndLap property",
            "path1": {
              "name": "Beam End Lap (Yes/No)",
              "steps": [
                "Generates BeamCut operation at end of male beam"
              ]
            },
            "path2": {
              "name": "None",
              "steps": [
                "Skips BeamCut generation on male beam"
              ]
            }
          },
          {
            "condition": "sDrillMaleBeam property",
            "path1": {
              "name": "Drill Male Beam (Yes)",
              "steps": [
                "Adds Drill operations to the male beam entity"
              ]
            },
            "path2": {
              "name": "Do Not Drill (No)",
              "steps": [
                "Only adds Drill operations to the generated metal part Body"
              ]
            }
          },
          {
            "condition": "sMark property (Marking)",
            "path1": {
              "name": "None (Index 3)",
              "steps": [
                "Function returns early",
                "No marking added to female beams"
              ]
            },
            "path2": {
              "name": "Marking Types (0, 1, 2)",
              "steps": [
                "Constructs MarkerLine geometry",
                "Calculates intersection points on female beam",
                "Adds MarkerLine to all female beams"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Successful selection of Male Beams (PrEntity)",
            "errorMessage": "Implicitly handled by TSL (Empty set)",
            "recovery": "User must select at least one beam or Esc to cancel"
          },
          {
            "check": "Successful selection of Female Beams (PrEntity)",
            "errorMessage": "Implicitly handled by TSL (Empty set)",
            "recovery": "User must select at least one beam or Esc to cancel"
          },
          {
            "check": "Female Envelope Profile Generation",
            "errorMessage": "\"unexpected error\" (shadowProfile failure)",
            "recovery": "Script erases instance; User must check beam geometry and re-insert"
          },
          {
            "check": "Intersection Points for Marking",
            "errorMessage": "\"unexpected error\" (IntersectPoints < 2)",
            "recovery": "Script erases instance; User must check alignment and re-insert"
          },
          {
            "check": "Peg Drill Depth Validity",
            "errorMessage": "None (Silent adjustment)",
            "recovery": "Script defaults to standard diameters/lengths or marks as 'Custom'"
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Connector Type",
            "how": "OPM Property: Type (Dropdown)",
            "effect": "Updates dimensions (A, B, C), number of pegs, and nail count"
          },
          {
            "action": "Adjust Connector Position",
            "how": "OPM Property: Y-Offset Axis / Z-Offset Axis",
            "effect": "Moves connector and machining relative to female beam centerline"
          },
          {
            "action": "Modify Pocket Geometry",
            "how": "OPM Property: bottom closed, Normal, Depth, Gap",
            "effect": "Recalculates the Pocket/Slot in the female beam"
          },
          {
            "action": "Toggle Male Beam Drilling",
            "how": "OPM Property: Drill Male Beam (Dropdown)",
            "effect": "Adds or removes Drill tools from the male beam"
          },
          {
            "action": "Change Drill Side",
            "how": "OPM Property: Drill Face (Side 1 / Side 2)",
            "effect": "Mirrors drill holes to the opposite side of the male beam"
          },
          {
            "action": "Adjust Markings",
            "how": "OPM Property: Marking",
            "effect": "Changes type of MarkerLine on female beam (Text, Line, PosNum, or None)"
          },
          {
            "action": "Move or Stretch Beams",
            "how": "Grip Edit / Standard AutoCAD Modify",
            "effect": "Script recalculates geometry on next update to follow new beam positions"
          }
        ]
      },
      "tokens_used": 11033,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Jane-TU.mcr\n\n## Overview\nThis script automates the generation of Simpson Strong-Tie Jane-TU top-flange timber hangers. It calculates the required 3D geometry, creates pocket cutouts in the supporting beam, applies drilling to the joists, and adds shop floor markings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Geometry and machining are applied to 3D beams. |\n| Paper Space | No | This script does not generate 2D details or drawings. |\n| Shop Drawing | No | Machining is applied directly to the model entities. |\n\n## Prerequisites\n- **Required Entities**: At least two beams (one joist/male and one support/female).\n- **Minimum Beam Count**: 2 (1 Male, 1 Female).\n- **Required Settings**: None specific (uses internal manufacturer dimensions).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `Jane-TU.mcr` from the file list.\n\n### Step 2: Initial Configuration\nA configuration dialog or property prompt may appear (depending on version settings). You can accept defaults or set them later in the Properties Panel.\n\n### Step 3: Select Joist (Male) Beams\n```\nCommand Line: Select male beams\nAction: Click on the joist beam(s) that will carry the load into the hanger.\n```\n\n### Step 4: Select Support (Female) Beams\n```\nCommand Line: Select female beam(s)\nAction: Click on the supporting beam(s) where the hangers will be mounted.\n```\n\n### Step 5: Placement\nAfter selection, the script instance is created. The visual representation and machining will update automatically.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | Dropdown | JANE-TU 12 | Selects the manufacturer SKU (12, 16, 20, 24, or 28), defining dimensions and load capacity. |\n| bottom closed | Dropdown | Yes | Determines if the pocket in the female beam has a closed bottom (\"Yes\") or is open (\"No\"). |\n| Normal | Dropdown | No | If \"Yes\", the slot cut aligns with the face of the male beam (useful for non-90° connections). If \"No\", it is orthogonal to the female beam. |\n| Beam End Lap | Dropdown | Yes | Controls if the end of the male beam is cut (\"Yes\" or \"No\") or left uncut (\"None\"). |\n| Drill Face | Dropdown | Side 1 | Selects which side of the male beam is drilled for the dowels (Side 1 or Side 2). |\n| Marking | Dropdown | Marking | Determines the text/line marking style on the female beam (Text, Text & Desc, Text & PosNum, None). |\n| Depth Female | Number | 0 | Depth of the pocket/housing cut into the female beam (0 = surface mount). |\n| Gap | Number | 20 | Clearance allowance (in mm) around the connector within the female beam pocket. |\n| Txt Height | Number | 20 | Height of the marking text on the beam. |\n| Y-Offset Axis | Number | 0 | Lateral offset of the connector along the width of the female beam. |\n| Z-Offset Axis | Number | 0 | Vertical offset of the connector relative to the default placement. |\n| Color | Number | 8 | Sets the display color index (ACI) for the metal connector body. |\n| DimStyle | String | <Current> | Specifies the dimension style used for any generated dimensions. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the geometry and machining to reflect changes in beam positions or property values. |\n| Erase | Removes the script instance and cleans up generated elements. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script uses hardcoded manufacturer dimensions for Simpson Strong-Tie Jane-TU connectors; no external XML configuration file is required.\n\n## Tips\n- **Angled Connections**: If your joist meets the support beam at an angle other than 90°, set the **Normal** property to \"Yes\" to ensure the pocket cut aligns correctly with the joist face.\n- **Concealed Hangers**: To recess the hanger into the support beam for a flush look, increase the **Depth Female** value.\n- **Visualizing Drilling**: The **Drill Face** property allows you to switch drilling sides instantly. Use this to ensure dowels do not conflict with other hardware or joinery.\n\n## FAQ\n- **Q: How do I change the hanger size after inserting the script?**\n  - A: Select the script instance in the model, open the **Properties Palette (Ctrl+1)**, and change the **Type** dropdown to the desired SKU (e.g., JANE-TU 24). The machining will update automatically.\n- **Q: Why is there a gap around my hanger?**\n  - A: Check the **Gap** property. It defaults to 20mm to provide clearance. Set this to 0 for a tighter fit, or adjust based on your fabrication tolerances.\n- **Q: The drill holes are on the wrong side of the joist.**\n  - A: Change the **Drill Face** property from \"Side 1\" to \"Side 2\" in the Properties Panel."
      },
      "tokens_used": 7093,
      "error": null
    }
  }
}