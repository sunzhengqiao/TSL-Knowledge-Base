{
  "filename": "Nail-SheetOnSheet.mcr",
  "status": "completed",
  "total_tokens": 55990,
  "processing_time": 432.09183835983276,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8705,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PainterDefinitions to detect Sheets/Panels and generate naillines in 3D space. Explicit usage of _kModelSpace found in tslDialog.dbCreate. No patterns for Paper Space (_Viewport, sd_ prefix) or ShopDrawing (#Type E, _Entity[]) detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sheet",
            "Panel"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Nail-Configuration.xml",
            "Painter definitions (hsbCAD version 23+)"
          ]
        }
      },
      "tokens_used": 6131,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getString\",\n        \"promptOriginal\": \"|Overwrite existing rule?| [|No|]/|Yes|\",\n        \"condition\": \"_bOnRecalc && _kExecuteKey==|Save as rule| && mapRule.length()>0\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"Script insertion or Right-click menu execution\",\n      \"title\": \"scriptName()\",\n      \"dataSource\": \"TSL Instance Map (Properties)\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"nToolIndex\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Tool Index|\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the ToolIndex|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dSpacing\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Spacing|\",\n      \"defaultValue\": \"U(70)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the spacing of the nailing|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSpacingMode\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Spacing Mode|\",\n      \"defaultValue\": \"|Fixed Spacing|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Fixed Spacing|\",\n        \"|Even Spacing|\",\n        \"|Fixed Spacing, Last odd|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the SpacingMode|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sStrategy\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Strategy|\",\n      \"defaultValue\": \"|Perimeter|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Perimeter|\",\n        \"|Perimeter + Grid|\",\n        \"|Grid|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the nailing strategy|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sConfiguration\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Configuration|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"sConfigurations\",\n      \"category\": \"|General|\",\n      \"description\": \"|Select a configuration from the list or type a new name|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"bSaveAsRule\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Save as rule|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|General|\",\n      \"description\": \"|Save current settings as a rule inside the selected configuration|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sRuleName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Rule Name|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|General|\",\n      \"description\": \"|Defines the name of the rule|\"\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sPainterContact\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Painter Contact|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"sContactPainters\",\n      \"category\": \"|General|\",\n      \"description\": \"|Defines the painter to be used for contact detection|\"\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"bOverwrite\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Overwrite|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|General|\",\n      \"description\": \"|Overwrite existing naillines|\"\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"nMinLength\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Min Length|\",\n      \"defaultValue\": \"U(200)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the minimum length of a nailline|\"\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"bUseFixedLength\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Use Fixed Length|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|If yes, a fixed length will be used instead of calculating the intersection|\"\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"dFixedLength\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Fixed Length|\",\n      \"defaultValue\": \"U(100)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the fixed length|\"\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"nZone\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Zone|\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|General|\",\n      \"description\": \"|Defines the zone|\"\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"bDebug\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Debug|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"null\",\n      \"description\": \"|Show debug information|\"\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"sConfiguration\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Nailing Set|\",\n      \"defaultValue\": \"|Configuration|\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"null\",\n      \"description\": \"|Defines the name of a configuration| (Dialog Mode 1)\"\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"sConfiguration\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Configuration|\",\n      \"defaultValue\": \"sConfigurations\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"sConfigurations\",\n      \"category\": \"null\",\n      \"description\": \"|Defines the name of a configuration which will be removed.| (Dialog Mode 2)\"\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"sConfiguration\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Configuration|\",\n      \"defaultValue\": \"sConfigurations\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"sConfigurations\",\n      \"category\": \"null\",\n      \"description\": \"|Defines the name of a configuration| (Dialog Mode 3)\"\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"sRuleName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Rule Name|\",\n      \"defaultValue\": \"|Rule Name|\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|General|\",\n      \"description\": \"|Defines the nameof he rule| (Dialog Mode 3)\"\n    },\n    {\n      \"index\": 18,\n      \"variable\": \"sRuleName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Rule Name|\",\n      \"defaultValue\": \"sRules\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"sRules\",\n      \"category\": \"|General|\",\n      \"description\": \"|Defines the name of he rule which will be deleted on OK| (Dialog Mode 4)\"\n    }\n  ],\n  \"contextMenu\": [\n    {\n      \"menuItem\": \"|Edit in Place|\",\n      \"handler\": \"|Edit in Place|\",\n      \"action\": \"Opens the main properties dialog to edit the TSL instance.\",\n      \"alsoTriggeredBy\": \"Double-click\"\n    },\n    {\n      \"menuItem\": \"|Add new Configuration|\",\n      \"handler\": \"|Add new Configuration|\",\n      \"action\": \"Opens a dialog to add a new configuration name to the settings.\",\n      \"alsoTriggeredBy\": \"null\"\n    },\n"
      },
      "tokens_used": 9412,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates nailing patterns (nail lines) to connect overlapping sheets or panels based on configurable strategies, spacing, and detection rules.",
          "category": "Hardware/Assembly",
          "typicalUseCase": "When connecting sheathing, cladding, or structural panels in a timber frame model where specific nailing patterns are required for structural integrity or manufacturing data."
        },
        "parameters": [
          {
            "name": "nToolIndex",
            "technicalDefault": "1",
            "businessMeaning": "Specifies which tool definition (from the machine database) to use for these specific nails, often linking to a specific nail gun, nail diameter, or length.",
            "validRange": "1 to 999",
            "unit": "index",
            "affectsOutput": "Assigns the specific tool attribute to the generated nail lines, affecting CAM data and labeling."
          },
          {
            "name": "dSpacing",
            "technicalDefault": "U(70)",
            "businessMeaning": "The distance between the centers of two adjacent nails along the nailing line.",
            "validRange": "40mm to 600mm",
            "unit": "mm",
            "affectsOutput": "Changes the density of the nailing pattern along the sheet edges or grid."
          },
          {
            "name": "sSpacingMode",
            "technicalDefault": "|Fixed Spacing|",
            "businessMeaning": "Determines how the spacing value is applied relative to the length of the nailing line.",
            "validRange": "Fixed Spacing, Even Spacing, Fixed Spacing, Last odd",
            "unit": "enum",
            "affectsOutput": "If 'Fixed', nails are placed at exact intervals possibly leaving a remainder at the end. If 'Even', spacing is calculated to divide the length equally."
          },
          {
            "name": "sStrategy",
            "technicalDefault": "|Perimeter|",
            "businessMeaning": "Defines where the nails are generated on the overlapping sheets.",
            "validRange": "Perimeter, Perimeter + Grid, Grid",
            "unit": "enum",
            "affectsOutput": "Controls geometry generation: 'Perimeter' places nails on edges, 'Grid' adds a field of nails in the interior, 'Perimeter + Grid' does both."
          },
          {
            "name": "sConfiguration",
            "technicalDefault": "",
            "businessMeaning": "Selects a named set of predefined rules (saved in the project settings) to apply to the current element.",
            "validRange": "Any string defined in project configurations",
            "unit": "string",
            "affectsOutput": "Loads a specific set of property values (Tool, Spacing, etc.) without manually entering them."
          },
          {
            "name": "bSaveAsRule",
            "technicalDefault": "0",
            "businessMeaning": "Flag to trigger saving the current property settings as a reusable rule.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "bool",
            "affectsOutput": "Does not change geometry, but updates the configuration database."
          },
          {
            "name": "sRuleName",
            "technicalDefault": "",
            "businessMeaning": "The name assigned to a saved set of nailing parameters.",
            "validRange": "Any text string",
            "unit": "string",
            "affectsOutput": "Used to identify and recall specific nailing setups."
          },
          {
            "name": "sPainterContact",
            "technicalDefault": "",
            "businessMeaning": "Selects the detection logic (Painter Definition) used to find which other sheets/panels are in contact with the current sheet.",
            "validRange": "List of available PainterDefinitions or 'byZoneBelow'",
            "unit": "string",
            "affectsOutput": "Determines which overlapping elements trigger the generation of nail lines."
          },
          {
            "name": "bOverwrite",
            "technicalDefault": "0",
            "businessMeaning": "Controls whether the script should modify/delete existing nail lines created by this script on the same element.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "bool",
            "affectsOutput": "If 'No', existing nails might be preserved; if 'Yes', they are recalculated based on current inputs."
          },
          {
            "name": "nMinLength",
            "technicalDefault": "U(200)",
            "businessMeaning": "The minimum length of overlap required to generate a nailing line.",
            "validRange": "0mm to 1000mm",
            "unit": "mm",
            "affectsOutput": "Prevents nails from being generated on very small or incidental overlaps."
          },
          {
            "name": "bUseFixedLength",
            "technicalDefault": "0",
            "businessMeaning": "Determines if the nail length is calculated by the overlap geometry or set to a fixed value.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "bool",
            "affectsOutput": "If 'Yes', nails are a specific length regardless of actual sheet thickness or overlap."
          },
          {
            "name": "dFixedLength",
            "technicalDefault": "U(100)",
            "businessMeaning": "The explicit length to use for the nails if 'Use Fixed Length' is enabled.",
            "validRange": "Typical nail lengths (e.g., 50mm - 150mm)",
            "unit": "mm",
            "affectsOutput": "Sets the geometric length of the generated nail lines."
          },
          {
            "name": "nZone",
            "technicalDefault": "1",
            "businessMeaning": "Filter for the construction zone (e.g., wall, floor, roof) to limit where the script acts.",
            "validRange": "1 to 99",
            "unit": "count",
            "affectsOutput": "Restricts script execution to elements assigned to specific zones."
          },
          {
            "name": "bDebug",
            "technicalDefault": "0",
            "businessMeaning": "Developer mode to display visual debugging information (text) in the model.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "bool",
            "affectsOutput": "Displays 3D text with status info instead of actual nail lines."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "bUseFixedLength = 1",
            "effect": "Activates the use of dFixedLength and ignores geometric overlap length.",
            "cascade": [
              "dFixedLength"
            ]
          },
          {
            "trigger": "sStrategy = Grid",
            "effect": "May require different spacing calculations compared to Perimeter.",
            "cascade": [
              "dSpacing",
              "sSpacingMode"
            ]
          },
          {
            "trigger": "sConfiguration Selection",
            "effect": "Overwrites all other tooling and strategy parameters with values from the saved rule.",
            "cascade": [
              "nToolIndex",
              "dSpacing",
              "sSpacingMode",
              "sStrategy",
              "nMinLength",
              "bUseFixedLength"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "NailLine",
            "description": "Linear representations of nail patterns indicating fastener locations.",
            "appliedTo": "Sheets and Panels (cladding, sheathing, SIPs)"
          }
        ]
      },
      "tokens_used": 10481,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch: User executes script via command line or palette.",
          "2. Settings Initialization: Script checks for 'Nail-Configuration.xml' in Company/Install paths and loads MapObject settings.",
          "3. Mode Check: Script checks the 'DialogMode' property within its internal map.",
          "4. [Conditional] Management Branch: If DialogMode > 0, script executes a sub-routine (Add/Remove Config or Rule) and terminates.",
          "5. Main Execution: If DialogMode is 0, script defines OPM properties (Tooling, Strategy, Spacing).",
          "6. User Input: Dynamic Dialog appears on Insert or 'Edit in Place'. User sets parameters or selects a predefined Configuration.",
          "7. [Conditional] Save Rule: If 'Save as rule' is enabled, the script checks if the rule name exists.",
          "8. [Conditional] Overwrite Prompt: If the rule exists, command line prompts 'Overwrite existing rule? [No]/Yes'.",
          "9. Data Processing: Script iterates selected elements and uses Painter Definitions to detect contacts.",
          "10. Geometry Generation: Nail lines are calculated based on Strategy (Perimeter/Grid) and Spacing Mode.",
          "11. Completion: Nail lines are drawn. If no nails are generated, the instance is automatically erased."
        ],
        "conditionalBranches": [
          {
            "condition": "Value of internal 'DialogMode' variable",
            "path1": {
              "name": "Management Mode (1-4)",
              "steps": [
                "Script launches a specific simplified dialog based on mode (e.g., Select Config to Remove).",
                "Modifies the XML settings (MapObject) directly.",
                "Updates the configuration database.",
                "Exits script without generating geometry."
              ]
            },
            "path2": {
              "name": "Generation Mode (0)",
              "steps": [
                "Loads full property set.",
                "Calculates geometry.",
                "Generates NailLines."
              ]
            }
          },
          {
            "condition": "User action: Setting 'Save as rule' to Yes",
            "path1": {
              "name": "Overwrite Existing",
              "steps": [
                "Script detects rule name already exists in configuration.",
                "Command line prompt: 'Overwrite existing rule? [No]/Yes' requires input.",
                "If Yes -> Update existing rule.",
                "If No -> Cancel operation, keep existing rule."
              ]
            },
            "path2": {
              "name": "New Rule",
              "steps": [
                "Script detects rule name is unique.",
                "Creates new entry in configuration.",
                "Saves current property values to the new rule."
              ]
            }
          },
          {
            "condition": "Property: 'Use Fixed Length'",
            "path1": {
              "name": "Fixed Length",
              "steps": [
                "Nail lines are generated using the explicit 'Fixed Length' value.",
                "Ignores actual geometric intersection depth."
              ]
            },
            "path2": {
              "name": "Calculated Length",
              "steps": [
                "Nail lines are calculated to stop at the intersection of the target sheet.",
                "Length varies based on thickness and overlap."
              ]
            }
          },
          {
            "condition": "Property: 'Strategy'",
            "path1": {
              "name": "Perimeter",
              "steps": [
                "Generates nails only along the outer edges of the detected overlap."
              ]
            },
            "path2": {
              "name": "Grid",
              "steps": [
                "Generates a grid of nails across the entire area of the detected overlap."
              ]
            },
            "path3": {
              "name": "Perimeter + Grid",
              "steps": [
                "Combines both perimeter edge nailing and interior grid nailing."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Settings File Availability",
            "errorMessage": "Script checks 'Company\\TSL\\Settings' and 'Install\\Content\\General\\TSL\\Settings'.",
            "recovery": "If missing on Insert, script attempts to create the folder. If file is missing, it creates a default MapObject in the drawing."
          },
          {
            "check": "Painter Definition Availability",
            "errorMessage": "Nailing requires valid Painter Definitions (Sheet/Panel types) to detect overlaps.",
            "recovery": "Script filters available painters. User must select a valid 'Painter Contact' from the dropdown list."
          },
          {
            "check": "Minimum Overlap Length",
            "errorMessage": "If calculated overlap is less than 'Min Length' property.",
            "recovery": "Script skips generation for that specific edge/area automatically."
          },
          {
            "check": "Rule Name Existence",
            "errorMessage": "Prompt appears on command line: 'Overwrite existing rule? [No]/Yes'.",
            "recovery": "User must type 'Y' or 'Yes' to overwrite, or 'N' to abort saving."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Nailing Parameters",
            "how": "Double-click instance or Right-click -> 'Edit in Place'",
            "effect": "Opens Dynamic Dialog to change Tool Index, Spacing, Strategy, or Zone. Updates geometry on OK."
          },
          {
            "action": "Save Current Setup as Rule",
            "how": "Right-click -> 'Save as rule'",
            "effect": "Sets a flag to open a dialog to name and save the current instance settings to the global configuration database."
          },
          {
            "action": "Manage Configurations",
            "how": "Right-click -> 'Add new Configuration' or 'Remove Configuration'",
            "effect": "Opens sub-dialogs to create or delete configuration groups in the project settings."
          },
          {
            "action": "Manage Rules",
            "how": "Right-click -> 'Delete rule'",
            "effect": "Opens sub-dialog to select a specific rule within a configuration to permanently delete it."
          },
          {
            "action": "Audit Rules",
            "how": "Right-click -> 'Show Rule Definitions'",
            "effect": "Prints a formatted report of all configurations and their specific rules to the AutoCAD command line/text window."
          }
        ]
      },
      "tokens_used": 12241,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Nail-SheetOnSheet.mcr\n\n## Overview\nGenerates nailing patterns (nail lines) to connect overlapping sheets or panels based on configurable strategies, spacing, and detection rules. This is typically used for sheathing, cladding, or structural panel connections in timber frame models.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model. |\n| Paper Space | No | Not applicable for layout generation. |\n| Shop Drawing | No | Generates 3D nail data, not 2D drawing views. |\n\n## Prerequisites\n- **Required Entities**: Sheets or Panels (e.g., GenBeam entities with sheet properties).\n- **Minimum Beam Count**: 0 (Script operates on attached elements).\n- **Required Settings**:\n  - `Nail-Configuration.xml` (Auto-generated if missing).\n  - Painter Definitions (hsbCAD version 23+) to detect overlapping sheets.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Select `Nail-SheetOnSheet.mcr` from the file dialog.\n\n### Step 2: Select Element\n```\nCommand Line: Select Sheet/Panel:\nAction: Click on the sheet or panel in the model where you want to apply nailing.\n```\n*Note: The script will automatically detect overlapping neighbors based on the selected \"Painter Contact\" property.*\n\n### Step 3: Configure Properties\nAction: The properties dialog appears automatically. Set your desired Tool Index, Spacing, and Strategy. Click OK to generate the nails.\n\n### Step 4: (Optional) Save Configuration\nIf you plan to reuse these settings:\n1. Right-click the script instance and select **Save as rule**.\n2. Enter a Rule Name.\n3. If the rule exists, the command line will ask: `Overwrite existing rule? [No]/Yes`. Type `Y` to overwrite or `N` to cancel.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Tool Index | Number | 1 | Defines the tool (nail gun/fastener) index used for production data. |\n| Spacing | Number | 70 mm | Defines the distance between nail centers. |\n| Spacing Mode | Dropdown | Fixed Spacing | Options: Fixed Spacing, Even Spacing, Fixed Spacing (Last odd). Determines how spacing is calculated along the line. |\n| Strategy | Dropdown | Perimeter | Options: Perimeter, Perimeter + Grid, Grid. Defines the pattern layout (edges only, field, or both). |\n| Configuration | Dropdown | | Select a saved configuration preset from the list. |\n| Painter Contact | Dropdown | | Selects the Painter Definition used to detect which other sheets are touching/overlapping. |\n| Overwrite | Dropdown | No | If Yes, deletes existing nail lines from this script before regenerating. |\n| Min Length | Number | 200 mm | The minimum overlap length required to generate a nail line. Prevents nails on small overlaps. |\n| Use Fixed Length | Dropdown | No | If Yes, ignores actual sheet thickness and uses a specific nail length. |\n| Fixed Length | Number | 100 mm | The explicit length to use when \"Use Fixed Length\" is Yes. |\n| Zone | Number | 1 | Filters which construction elements to process (e.g., Wall=1, Floor=2). |\n| Debug | Dropdown | No | If Yes, displays debug text in the model instead of drawing nail lines. |\n| Save as rule | Dropdown | No | Set to Yes to save the current settings as a reusable rule. |\n| Rule Name | Text | | The name for the new or existing rule. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Edit in Place | Opens the main properties dialog to modify Tool Index, Spacing, Strategy, etc. Updates geometry on OK. |\n| Save as rule | Saves the current property settings as a named rule within the selected configuration. |\n| Add new Configuration | Creates a new configuration group in the project settings. |\n| Remove Configuration | Deletes a configuration group and all its rules from the project settings. |\n| Delete rule | Removes a specific named rule from a configuration. |\n| Show Rule Definitions | Prints a report of all configurations and their rules to the command line. |\n\n## Settings Files\n- **Filename**: `Nail-Configuration.xml`\n- **Location**: `Company\\TSL\\Settings` or `Install\\Content\\General\\TSL\\Settings`\n- **Purpose**: Stores saved configurations and rules (Tool Index, Spacing, Strategy, etc.) so they can be reused across different elements or projects.\n\n## Tips\n- **Configurations**: Use the \"Configuration\" dropdown to quickly switch between standard nailing patterns (e.g., \"Standard Wall Sheathing\" vs \"Heavy Duty Floor\") without manually adjusting parameters every time.\n- **Detection Logic**: If nails are not appearing where expected, check the \"Painter Contact\" property. It must match the Painter Definition assigned to the sheets you want to nail into.\n- **Small Edges**: Increase the \"Min Length\" value if you are seeing unwanted nails on very small corner overlaps or incidental geometry intersections.\n\n## FAQ\n- **Q: Why are no nails showing up?**\n  A: Check that \"Painter Contact\" is set correctly and that the sheets actually overlap according to that Painter definition. Also, check if the overlap length is shorter than the \"Min Length\" setting.\n- **Q: Can I nail sheets together that are in different Zones?**\n  A: No, the script only processes elements within the same Zone number defined in the properties. Ensure both sheets have the same Zone assignment or adjust the script's Zone property.\n- **Q: What does \"Fixed Spacing, Last odd\" do?**\n  A: It places nails at the exact fixed spacing interval, but ensures the last nail is placed at a standard odd offset if the remaining space is too small, often used to maintain consistent edge distances."
      },
      "tokens_used": 9020,
      "error": null
    }
  }
}