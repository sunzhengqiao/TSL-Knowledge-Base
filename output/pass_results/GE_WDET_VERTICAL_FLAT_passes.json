{
  "filename": "GE_WDET_VERTICAL_FLAT.mcr",
  "status": "completed",
  "total_tokens": 40813,
  "processing_time": 574.9112169742584,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 7158,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script instantiates ElementWallSF and Wall objects, generates geometry using dbCreate() for Beam objects, and manipulates 3D coordinates (Point3d, Vector3d). It lacks ShopDrawing prefixes (sd_) and Paper Space entities (_Viewport)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 4621,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select an element",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select an insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "showDialogOnce() called during _bOnInsert",
            "title": "Properties",
            "dataSource": "TSL Instance Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strEmpty0",
            "type": "PropString",
            "displayName": "- - - - - - - - - - - - - - - -",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 0,
            "variable": "dStartOffset",
            "type": "PropDouble",
            "displayName": "  Start Offset",
            "defaultValue": "600 (24)",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 1,
            "variable": "dEndOffset",
            "type": "PropDouble",
            "displayName": "  End Offset",
            "defaultValue": "0 (0)",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 2,
            "variable": "dSpacing",
            "type": "PropDouble",
            "displayName": "  Spacing",
            "defaultValue": "600 (24)",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 3,
            "variable": "dBlockingLength",
            "type": "PropDouble",
            "displayName": "  Blocking Length",
            "defaultValue": "200 (8)",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 1,
            "variable": "strEmpty1",
            "type": "PropString",
            "displayName": "- - - - - - - - - - - - - - - -",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": "MATERIAL PROPERTIES",
            "description": null
          },
          {
            "index": 0,
            "variable": "strMat",
            "type": "PropString",
            "displayName": "  Material",
            "defaultValue": "SPF",
            "inputType": "text",
            "options": [],
            "category": "MATERIAL PROPERTIES",
            "description": null
          },
          {
            "index": 1,
            "variable": "strGrade",
            "type": "PropString",
            "displayName": "  Grade",
            "defaultValue": "#2",
            "inputType": "text",
            "options": [],
            "category": "MATERIAL PROPERTIES",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5444,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a vertical column of flat blocking (solid bridging) between two adjacent studs in a wall element.",
          "category": "Framing / Detailing",
          "typicalUseCase": "Adding fireblocking, ladder blocking for drywall backing, or structural stiffening between wall studs at a specified location."
        },
        "parameters": [
          {
            "name": "dStartOffset",
            "technicalDefault": "600 (24)",
            "businessMeaning": "The vertical distance from the bottom plate to the centerline of the first row of blocking. If set to 0, the blocking sits flush on top of the bottom plate.",
            "validRange": "0 to Wall Height",
            "unit": "mm (or inches)",
            "affectsOutput": "Determines the vertical start position of the blocking pattern."
          },
          {
            "name": "dEndOffset",
            "technicalDefault": "0 (0)",
            "businessMeaning": "The distance from the top plate downwards. Controls where the blocking stops. A value of 0 places blocking flush with the top plate.",
            "validRange": "0 to Wall Height",
            "unit": "mm (or inches)",
            "affectsOutput": "Defines the upper limit of the blocking run, potentially leaving a gap at the top for rim joists or headers."
          },
          {
            "name": "dSpacing",
            "technicalDefault": "600 (24)",
            "businessMeaning": "The vertical empty space (gap) between consecutive pieces of blocking.",
            "validRange": "0 (solid) to Wall Height",
            "unit": "mm (or inches)",
            "affectsOutput": "Controls the pitch of the blocking layout."
          },
          {
            "name": "dBlockingLength",
            "technicalDefault": "200 (8)",
            "businessMeaning": "The vertical height (depth) of each individual blocking piece.",
            "validRange": "Standard lumber dimensions (e.g., 38mm to 300mm)",
            "unit": "mm (or inches)",
            "affectsOutput": "Determines the physical size of the generated beam in the vertical direction."
          },
          {
            "name": "strMat",
            "technicalDefault": "SPF",
            "businessMeaning": "The material species code assigned to the blocking (e.g., SPF, HemFir, SYP).",
            "validRange": "Any valid catalog material string",
            "unit": "String",
            "affectsOutput": "Updates the material property on the generated beams for reporting and costing."
          },
          {
            "name": "strGrade",
            "technicalDefault": "#2",
            "businessMeaning": "The structural grade of the lumber assigned to the blocking.",
            "validRange": "Any valid catalog grade string",
            "unit": "String",
            "affectsOutput": "Updates the grade property on the generated beams."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dStartOffset is 0",
            "effect": "Script automatically calculates offset to place the bottom of the first block flush with the top of the bottom plate.",
            "cascade": [
              "dStartOffset"
            ]
          },
          {
            "trigger": "Loop calculation",
            "effect": "The number of blocks generated is dependent on the combination of StartOffset, Spacing, and BlockingLength fitting within the available wall height.",
            "cascade": [
              "dStartOffset",
              "dSpacing",
              "dBlockingLength",
              "dEndOffset"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam (Blocking)",
            "description": "Creates new beam entities of type '_kBlocking' spanning horizontally between the two nearest studs found at the insertion point.",
            "appliedTo": "Selected Wall Element (space between two studs)"
          },
          {
            "type": "Beam Attributes (Studs)",
            "description": "Updates the color, module name, and information string of the left and right studs bounding the blocking to group them logically.",
            "appliedTo": "Neighboring Vertical Studs"
          }
        ]
      },
      "tokens_used": 8211,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. User launches script and is prompted to select a wall element (getElement).\",\n    \"2. User selects an insertion point on the wall surface (getPoint).\",\n    \"3. Script executes internal initialization (showDialogOnce) and returns to wait for calculation.\",\n    \"4. Script checks if the selected element is a valid ElementWallSF.\",\n    \"5. Script filters element beams to find vertical studs and horizontal members.\",\n    \"6. Script identifies the closest studs to the Left and Right of the insertion point.\",\n    \"7. [Validation] Script checks if a valid pair of studs exists and if the gap between them matches a standard lumber width.\",\n    \"8. [Conditional] Script calculates vertical start position based on dStartOffset (Flush Bottom vs Fixed Offset).\",\n    \"9. [Conditional] Script calculates vertical end limit based on dEndOffset (Flush Top vs Gap).\",\n    \"10. Script generates a loop of blocking beams between the studs using calculated coordinates.\",\n    \"11. Script assigns Material, Grade, and Module information to the new blocking beams.\",\n    \"12. Script updates the Module and Information of the bounding Left and Right studs.\",\n    \"13. Script deletes the temporary blocking body and erases the script instance.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Value of dStartOffset property\",\n      \"path1\": {\n        \"name\": \"Flush Bottom\",\n        \"steps\": [\n          \"If dStartOffset is 0\",\n          \"Script sets start height to: (Blocking Length / 2) + Bottom Plate Thickness\",\n          \"Result: First block sits directly on top of the bottom plate.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Fixed Offset\",\n        \"steps\": [\n          \"If dStartOffset > 0\",\n          \"Script uses the exact dStartOffset value from the origin\",\n          \"Result: First block center is placed at the specified distance from the bottom.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Value of dEndOffset property\",\n      \"path1\": {\n        \"name\": \"Flush Top\",\n        \"steps\": [\n          \"If dEndOffset is 0\",\n          \"Max height is adjusted to place top of block flush with top plate.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Small Gap / Forced\",\n        \"steps\": [\n          \"If dEndOffset is > 0 but <= 76mm (3\\\")\",\n          \"Max height adjusted to force a specific top block position.\"\n        ]\n      },\n      \"path3\": {\n        \"name\": \"Fixed Gap\",\n        \"steps\": [\n          \"If dEndOffset is > 76mm\",\n          \"Max height adjusted to leave a specific gap equal to dEndOffset from the top.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Distance between identified studs (dDistSpace)\",\n      \"path1\": {\n        \"name\": \"Standard Size\",\n        \"steps\": [\n          \"Distance matches list: 63mm, 89mm, 140mm, 184mm, 235mm, 286mm (approx 2.5\\\" to 11.25\\\")\",\n          \"Script sets blocking width (dBlkSizeInElVecX) to match this gap.\",\n          \"Blocking generation proceeds.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Non-Standard Size\",\n        \"steps\": [\n          \"Distance does not match the predefined list\",\n          \"Script displays error: 'Cannot position... because [dist] is not a standard size'\",\n          \"Script"
      },
      "tokens_used": 9130,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WDET_VERTICAL_FLAT.mcr\n\n## Overview\nThis script generates a vertical column of flat blocking (solid bridging) between two adjacent studs in a wall element. It is typically used for fireblocking, ladder backing for drywall, or structural stiffening.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script creates geometry in the 3D model. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Does not generate 2D annotations. |\n\n## Prerequisites\n- **Required Entities**: A Wall Element (ElementWallSF) containing at least two vertical studs.\n- **Minimum Beam Count**: 2 (The studs that will bound the blocking).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WDET_VERTICAL_FLAT.mcr`\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select an element\nAction: Click on the wall element where you want to add blocking.\n```\n\n### Step 3: Select Insertion Point\n```\nCommand Line: Select an insertion point\nAction: Click between the two studs where the blocking should be placed.\n```\n*Note: The script will automatically detect the two closest studs to the left and right of your click.*\n\n### Step 4: Configure Properties\nAfter insertion, the \"Properties\" dialog will appear automatically. You can adjust the offset, spacing, and material settings here. These can also be changed later via the AutoCAD Properties Palette before regenerating.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Start Offset** | Number | 600 (24\") | Distance from the bottom plate to the centerline of the first row. Set to 0 to sit flush on the bottom plate. |\n| **End Offset** | Number | 0 (0\") | Distance from the top plate downwards. Set to 0 to sit flush with the top plate. |\n| **Spacing** | Number | 600 (24\") | The vertical gap (empty space) between consecutive blocking pieces. |\n| **Blocking Length** | Number | 200 (8\") | The vertical height (depth) of each individual blocking piece. |\n| **Material** | Text | SPF | The material species code (e.g., SPF, HemFir). |\n| **Grade** | Text | #2 | The structural grade of the lumber. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific items to the entity context menu. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Flush Placement**: To create a solid stack of blocking from the bottom plate upwards, set **Start Offset** to `0` and **Spacing** to `0`.\n- **Gap Validation**: The script checks the gap between studs. If the gap does not match a standard lumber width (approx. 2.5\" to 11.25\"), the script will fail and display an error.\n- **Self-Deleting**: This script is a \"Generator\". Once the blocking beams are created in the model, the script instance deletes itself. The resulting blocking is standard geometry that can be edited manually.\n- **Unit Independence**: Input values are interpreted based on your current hsbCAD/AutoCAD unit settings (mm or inches).\n\n## FAQ\n- **Q: Why did I get an error \"Cannot position... because [dist] is not a standard size\"?**\n  - A: The distance between the two studs you selected does not correspond to a standard lumber width. Check your wall framing settings or ensure you clicked between two standard studs.\n- **Q: Can I edit the blocking after I insert it?**\n  - A: Yes. The script creates actual Beam objects. You can manually stretch, move, or delete them just like any other beam in the model. However, since the script instance deletes itself after running, you cannot use the script parameters to update them later.\n- **Q: What does \"Start Offset\" = 0 actually do?**\n  - A: It places the bottom of the first blocking piece exactly on top of the bottom plate. If Start Offset is greater than 0, it measures to the *centerline* of the blocking piece."
      },
      "tokens_used": 6249,
      "error": null
    }
  }
}