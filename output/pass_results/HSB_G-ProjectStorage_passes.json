{
  "filename": "HSB_G-ProjectStorage.mcr",
  "status": "completed",
  "total_tokens": 26055,
  "processing_time": 280.25310826301575,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq"
      },
      "tokens_used": 5655,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script interacts with 'Element' entities and structural 'Groups' (Floors) for export purposes. It utilizes 'ModelMap().callExporter' which operates on the 3D model data. There are no references to _kPaperSpace, _Viewport, sd_* prefixes, or drawing generation logic typical of ShopDrawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "hsbCAD Model (3D)",
          "requiredSettings": [
            "ModelMap Exporter Group configuration"
          ]
        }
      },
      "tokens_used": 3266,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select one or more elements to export|",
              "condition": "nInsertType == 3",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "On Insert (if _kExecuteKey is empty or not found in catalog)",
            "title": null,
            "dataSource": "Internal TSL Properties (sInsertType, strExportGroup, sNameFloorGroup)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeperator01",
            "type": "PropString",
            "displayName": "|Selection|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sInsertType",
            "type": "PropString",
            "displayName": "     |Entities to export|",
            "defaultValue": 3,
            "inputType": "dropdown",
            "options": [
              "|Select entire project|",
              "|Select floor level in floor level list|",
              "|Select current floor level|",
              "|Select elements in drawing|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sSeperator02",
            "type": "PropString",
            "displayName": "|Exporter|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "strExportGroup",
            "type": "PropString",
            "displayName": "     |Run exporter group|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "ModelMap().exporterGroups()",
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sNameFloorGroup",
            "type": "PropString",
            "displayName": "     |Floorgroup|",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": "Dynamic list of floor groups found in model",
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3483,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script facilitates the export of hsbCAD model data (geometry, production info) to external files or machinery using configurable Exporter Groups, with flexible scope selection (Project, Floor, or Elements).",
          "category": "Export/Data Exchange",
          "typicalUseCase": "Generating production data for CNC machines, sending BIM models to analysis software, or archiving specific parts of a timber project."
        },
        "parameters": [
          {
            "name": "sInsertType",
            "technicalDefault": "3",
            "businessMeaning": "Determines the selection scope for the exportâ€”whether the data covers the entire building model, a specific floor, the currently active floor, or a user-defined set of elements.",
            "validRange": "0 (All Project), 1 (Specific Floor), 2 (Current Floor), 3 (Selected Elements)",
            "unit": "SelectionMode",
            "affectsOutput": "Controls the quantity and specific identity of the timber elements included in the export package."
          },
          {
            "name": "strExportGroup",
            "technicalDefault": "First available in ModelMap",
            "businessMeaning": "Specifies the export configuration or 'Recipe' to be used (e.g., specific machine format like Hundegger, BIM format like IFC, or Palletizer logic).",
            "validRange": "Any defined Exporter Group within the hsbCAD ModelMap configuration.",
            "unit": "String",
            "affectsOutput": "Dictates the file format, structure, and specific data fields contained in the export (e.g., XML tags, CSV columns, binary machine code)."
          },
          {
            "name": "sNameFloorGroup",
            "technicalDefault": "0",
            "businessMeaning": "Identifies the specific building story or floor to export when the scope is set to 'Select floor level'.",
            "validRange": "Any valid Floor Group name present in the current model structure.",
            "unit": "String",
            "affectsOutput": "Restricts the export to only those entities assigned to the chosen floor group."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sInsertType changes to 'Select floor level in floor level list' (Value 1)",
            "effect": "The sNameFloorGroup parameter becomes enabled and editable; for all other values, it remains read-only.",
            "cascade": [
              "sNameFloorGroup"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Data Files",
            "description": "External files generated by the ModelMap exporter (e.g., Bvf, Ppi, Xml, Csv) containing geometry and manufacturing data.",
            "appliedTo": "Selected Elements or Floor Groups based on sInsertType."
          }
        ]
      },
      "tokens_used": 3719,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch & Catalog Check",
          "2. Initial Configuration (Dialog if no catalog preset)",
          "3. Determine Selection Scope (Project/Floor/Elements)",
          "4. Data Collection Phase (Select elements or identify groups)",
          "5. Instance Erasure (Data stored in memory/Entity references)",
          "6. Export Phase Trigger (Implicit on next cycle)",
          "7. ModelMap Execution",
          "8. Output Generation (File creation in Temp folder)",
          "9. Final Script Erasure"
        ],
        "conditionalBranches": [
          {
            "condition": "Is a valid Catalog Entry (_kExecuteKey) found?",
            "path1": {
              "name": "Preset Execution",
              "steps": [
                "Load properties from Catalog",
                "Skip initial ShowDialog()"
              ]
            },
            "path2": {
              "name": "Interactive Execution",
              "steps": [
                "ShowDialog() to configure Export Group and Selection Type"
              ]
            }
          },
          {
            "condition": "Insertion Cycle Count",
            "path1": {
              "name": "Retry/Regen (Count > 1)",
              "steps": [
                "eraseInstance() called immediately",
                "Stop execution"
              ]
            },
            "path2": {
              "name": "First Run (Count <= 1)",
              "steps": [
                "Proceed to selection logic"
              ]
            }
          },
          {
            "condition": "Selection Type (sInsertType)",
            "path1": {
              "name": "Entire Project (0)",
              "steps": [
                "Set groupNames to empty (triggers full project export)",
                "Skip entity selection"
              ]
            },
            "path2": {
              "name": "Specific Floor (1)",
              "steps": [
                "Retrieve Group object from sNameFloorGroup",
                "Add Group Name to groupNames array"
              ]
            },
            "path3": {
              "name": "Current Floor (2)",
              "steps": [
                "Get _kCurrentGroup",
                "Validate Group is a Floor (NamePart checks)",
                "Add Group Name to groupNames array"
              ]
            },
            "path4": {
              "name": "Selected Elements (3)",
              "steps": [
                "Prompt for Element selection (PrEntity)",
                "Extract Group from each Element",
                "Collect all Entities from those Groups into _Entity",
                "Return/Erase immediately"
              ]
            }
          },
          {
            "condition": "Export Input Data Source",
            "path1": {
              "name": "Entity Array Export",
              "steps": [
                "Triggered if _Entity.length > 0",
                "Call Exporter with specific Entity list"
              ]
            },
            "path2": {
              "name": "Group Name Export",
              "steps": [
                "Triggered if groupNames has data OR Selection Type was 0",
                "Call Exporter with Group Name list (Full Project or Floor)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "ModelMap Exporter Group Configuration",
            "errorMessage": "Implicit: 'Tsl::callExporter failed' report message.",
            "recovery": "Verify strExportGroup matches a valid configuration in hsbCAD ModelMap settings."
          },
          {
            "check": "Selection of Entities (Mode 3)",
            "errorMessage": "None explicit in script, but PrEntity is required.",
            "recovery": "User must select valid Element entities when prompted."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script is self-destructing)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after data collection and again after export. There is no persistent object to modify via OPM or Context Menu after the initial run."
          }
        ]
      },
      "tokens_used": 4759,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-ProjectStorage\n\n## Overview\nThis script exports hsbCAD model data (geometry and production information) to external files or machinery using the ModelMap exporter. It provides flexible options to export the entire project, specific floor levels, or a user-defined selection of elements.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on the 3D model and structural groups. |\n| Paper Space | No | Not applicable for 2D drawing generation. |\n| Shop Drawing | No | Not used for generating shop drawings or layouts. |\n\n## Prerequisites\n- **Required Entities**: Elements (Beams/Walls/Plates) must exist in the model if not exporting the whole project.\n- **Minimum Beam Count**: 0 (Can export empty projects or specific floors).\n- **Required Settings**: A valid **ModelMap Exporter Group** must be configured in your hsbCAD environment (e.g., for PPI, BVF, or XML formats).\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse and select `HSB_G-ProjectStorage.mcr`.\n\n### Step 2: Configure Export Settings\nA properties dialog will appear (unless run from a pre-configured catalog entry).\n\n| Action | Details |\n|--------|---------|\n| **Entities to export** | Choose the scope from the dropdown: <br> - *Select entire project*: Exports everything.<br> - *Select floor level...*: Requires selecting a floor group below.<br> - *Select current floor level*: Uses the active floor.<br> - *Select elements in drawing*: Prompts you to click objects. |\n| **Run exporter group** | Select the target export format (e.g., CNC machine format or BIM exchange format) from the list. |\n| **Floorgroup** | (Only active if \"Select floor level\" is chosen) Select the specific floor to export. |\n\nClick **OK** to proceed.\n\n### Step 3: Select Elements (If applicable)\nIf you chose **\"Select elements in drawing\"** in Step 2:\n```\nCommand Line: Select one or more elements to export\nAction: Click the desired elements in the model view and press Enter.\n```\n*Note: For all other modes (Project/Floor), the script proceeds automatically.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Entities to export** | Dropdown | 3 (Select elements in drawing) | Determines the scope of data included in the export: Entire Project, Specific Floor, Current Floor, or User Selection. |\n| **Run exporter group** | Dropdown | *First available group* | Selects the specific Exporter configuration (recipe) defined in ModelMap to define file format and data structure. |\n| **Floorgroup** | Dropdown | 0 | Specifies the exact building story to export when \"Entities to export\" is set to \"Select floor level\". |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script is a \"fire-and-forget\" utility. It performs the export and erases itself immediately; therefore, it does not persist in the drawing to offer right-click options. |\n\n## Settings Files\n- **Filename**: Various (Depends on Exporter Group selection, typically XML, CSV, or machine-specific files).\n- **Location**: hsbCAD ModelMap Configuration (Company or Installation path).\n- **Purpose**: These configurations contain the logic for translating hsbCAD geometry into the specific external file format required by production machinery or analysis software.\n\n## Tips\n- **Use Catalog Entries**: If you frequently export to the same machine format using the same scope, create a Catalog Entry. This skips the configuration dialog and runs the export immediately upon insertion.\n- **Current Floor Shortcut**: If you are working on a specific floor, use the \"Select current floor level\" option to quickly export just the visible work without manually selecting objects.\n- **Check Output Folder**: Exported files are typically saved in your temporary folder or a directory specified in the Exporter Group settings. Check your specific exporter configuration if you cannot find the output file.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I clicked OK?**\n  - A: This is normal behavior. The script collects the data, triggers the export process, and then self-destructs (erases the instance). It does not leave a visible object in the CAD model.\n- **Q: What happens if I select \"Select elements in drawing\" but press Enter without selecting anything?**\n  - A: The script may terminate without exporting data or export an empty dataset, depending on the specific exporter configuration. Always ensure you select elements if prompted.\n- **Q: Can I use this to export IFC files?**\n  - A: Yes, provided you have an IFC Exporter Group configured in your ModelMap settings and select it in the \"Run exporter group\" dropdown."
      },
      "tokens_used": 5173,
      "error": null
    }
  }
}