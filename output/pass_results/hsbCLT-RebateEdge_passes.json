{
  "filename": "hsbCLT-RebateEdge.mcr",
  "status": "completed",
  "total_tokens": 50272,
  "processing_time": 308.4333143234253,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 3,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.3",
            "date": "09mar2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-6920 new context commands to toggle the overshoot"
          },
          {
            "version": "1.2",
            "date": "25nov2019",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-6033 new option 'Shape' supports selection of angular shaped or round. If angular shaped is used with a radius > width the tool width will be adjusted."
          },
          {
            "version": "1.1",
            "date": "24jul2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix side, radial dimension added"
          },
          {
            "version": "1.0",
            "date": "23jul2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8636,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script modifies the 3D geometry of the element by adding tools (Mortise/BeamCut) using 'sip.addTool()'. It relies on 3D geometric properties such as 'sip.plEnvelope()' and 'sip.sipEdges()'. There is no usage of '_Viewport', '_kPaperSpace', or 'sd_' prefixes indicative of Shop Drawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sip"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 7552,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"T(\\\"|Select panels|\\\")\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"TN(\\\""
      },
      "tokens_used": 10371,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a single rebate (notch) along the edge of a CLT or SIP panel, allowing for rounded or angular geometries.",
          "category": "Machining",
          "typicalUseCase": "Creating a seating recess on a panel edge to receive a cross-member, floor joist, or rafter."
        },
        "parameters": [
          {
            "name": "sFace",
            "technicalDefault": "\"|Reference Side|\"",
            "businessMeaning": "Selects which side of the panel (Reference or Opposite) the rebate depth is calculated from or applied to.",
            "validRange": "Reference Side, Opposite Side",
            "unit": "Selection",
            "affectsOutput": "Flips the plane of the rebate across the panel thickness relative to the panel's coordinate system."
          },
          {
            "name": "dDepth",
            "technicalDefault": "U(20)",
            "businessMeaning": "The depth of the rebate cut into the panel edge (perpendicular to the edge surface).",
            "validRange": "10mm - 300mm (Typically 20mm - 100mm)",
            "unit": "mm",
            "affectsOutput": "Determines how far the tool penetrates into the panel thickness."
          },
          {
            "name": "dWidth",
            "technicalDefault": "U(40)",
            "businessMeaning": "The length of the rebate opening measured along the panel edge.",
            "validRange": "10mm - Panel Length",
            "unit": "mm",
            "affectsOutput": "Defines the size of the notch along the edge; constrains the maximum radius (Radius cannot be > Width)."
          },
          {
            "name": "dRadius",
            "technicalDefault": "U(0)",
            "businessMeaning": "The radius of the rebate corners. Used to create rounded bottom corners instead of sharp 90-degree angles.",
            "validRange": "0mm - Width/2",
            "unit": "mm",
            "affectsOutput": "If > 0, creates a rounded geometry; if 0, enforces an 'Angular shaped' profile."
          },
          {
            "name": "sShape",
            "technicalDefault": "\"|Round|\"",
            "businessMeaning": "Determines the profile of the rebate corners: fully rounded or angular/sharp.",
            "validRange": "Round, Angular shaped",
            "unit": "Selection",
            "affectsOutput": "Switches the logic between creating a fully rounded tool or a rectangular/angular notch."
          },
          {
            "name": "OverShootStart",
            "technicalDefault": "0 (Map)",
            "businessMeaning": "Extends the rebate cut past the user-defined start point.",
            "validRange": "Yes/No",
            "unit": "Boolean",
            "affectsOutput": "Extends the machining tool body beyond the start grip point along the edge vector."
          },
          {
            "name": "OverShootEnd",
            "technicalDefault": "0 (Map)",
            "businessMeaning": "Extends the rebate cut past the user-defined end point.",
            "validRange": "Yes/No",
            "unit": "Boolean",
            "affectsOutput": "Extends the machining tool body beyond the end grip point along the edge vector."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dRadius <= 0",
            "effect": "Forces 'sShape' to 'Angular shaped' and locks the property (Read Only), as a radius of 0 implies no rounding.",
            "cascade": [
              "sShape"
            ]
          },
          {
            "trigger": "sShape = 'Angular shaped' AND dRadius > dWidth",
            "effect": "Logic adjusts the tool width or limits effective radius to prevent invalid geometry (radius wider than the notch).",
            "cascade": [
              "dWidth",
              "dRadius"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Mortise",
            "description": "Volumetric tool used when 'Round' shape is selected or specific radius conditions are met to create the rebate.",
            "appliedTo": "Selected Sip (Panel) element."
          },
          {
            "type": "BeamCut",
            "description": "Standard cutting tool used when 'Angular shaped' is selected or radius is 0.",
            "appliedTo": "Selected Sip (Panel) element."
          },
          {
            "type": "Text/Dimension",
            "description": "Visual label displaying the Radius (e.g., \"R50\") and radial dimension requests for drawings.",
            "appliedTo": "Model Space (Visuals only)."
          }
        ]
      },
      "tokens_used": 8080,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Execution Started",
          "Check for ExecuteKey (Catalog entry)",
          "[Conditional] Load Properties from Catalog OR Show Dialog",
          "Prompt Entity Selection (Select Panels)",
          "Prompt Point Input (Select Start Point)",
          "Prompt Point Input (Select End Point)",
          "Validate Input (Entities & Points count)",
          "Calculate Local Coordinate System (X, Y, Z vectors)",
          "Detect Panel Edge with maximum overlap",
          "Apply Logic: Radius/Shape constraints & Overshoot",
          "[Conditional] Generate Mortise (Round) OR BeamCut (Angular)",
          "Generate Visuals (Dimension Request, Arrows, Text)"
        ],
        "conditionalBranches": [
          {
            "condition": "Execution Method (Catalog vs Manual)",
            "path1": {
              "name": "Catalog Entry",
              "steps": [
                "Script detects _kExecuteKey",
                "Locate matching catalog entry",
                "Set properties from catalog",
                "Skip Dialog"
              ]
            },
            "path2": {
              "name": "Manual Execution",
              "steps": [
                "No ExecuteKey found",
                "Execute showDialog()",
                "User modifies properties in dialog",
                "User clicks OK"
              ]
            }
          },
          {
            "condition": "Rebate Geometry (Shape vs Radius)",
            "path1": {
              "name": "Round Rebate",
              "steps": [
                "Verify sShape == 'Round' AND dRadius > 0",
                "Calculate rounded tool geometry",
                "Create Mortise tool",
                "Generate Radial Dimension Request",
                "Display Radius Text (e.g., R50)"
              ]
            },
            "path2": {
              "name": "Angular / Rectangular Rebate",
              "steps": [
                "Condition: sShape == 'Angular shaped' OR dRadius <= 0",
                "Force sShape to 'Angular shaped' if Radius is 0",
                "Calculate rectangular tool geometry",
                "Create BeamCut tool",
                "No radial dimension requested"
              ]
            }
          },
          {
            "condition": "Overshoot Configuration",
            "path1": {
              "name": "Overshoot Active",
              "steps": [
                "Check Map flags: OverShootStart or OverShootEnd are true",
                "Extend tool length (dYT) beyond grip points",
                "Adjust tool center position"
              ]
            },
            "path2": {
              "name": "Standard Fit",
              "steps": [
                "Overshoot flags are false",
                "Tool geometry strictly bounded by Start and End points"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "N/A (Automatic erase)",
            "recovery": "Script detects insertCycleCount() > 1 and automatically erases the duplicate instance."
          },
          {
            "check": "Entity Selection",
            "errorMessage": "ScriptName: invalid reference or grip points",
            "recovery": "User must select at least one valid Sip (Panel) element during insertion."
          },
          {
            "check": "Point Definition",
            "errorMessage": "ScriptName: invalid grip positions",
            "recovery": "User must define two distinct points. Start and End points cannot be in the same location (zero length)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Flip Side",
            "how": "Right-click Context Menu -> Flip Side (Doubleclick)",
            "effect": "Toggles the 'sFace' property between 'Reference Side' and 'Opposite Side', moving the rebate to the other face of the panel."
          },
          {
            "action": "Toggle Overshoot",
            "how": "Right-click Context Menu -> Overshoot Start / Overshoot End / Overshoot (Both)",
            "effect": "Toggles the boolean map flags for 'OverShootStart' and 'OverShootEnd'. This extends the cutting tool beyond the defined start or end grip points."
          },
          {
            "action": "Edit Properties",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Modify Depth, Width, Radius, or Shape. Changing Radius to 0 automatically locks Shape to 'Angular shaped'."
          },
          {
            "action": "Move Grips",
            "how": "Click and Drag Start or End grips in the model",
            "effect": "Updates the location and length of the rebate. The script recalculates the edge orientation and tool placement."
          }
        ]
      },
      "tokens_used": 10257,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-RebateEdge.mcr\n\n## Overview\nCreates a single rebate (notch) along the edge of a CLT or SIP panel, supporting rounded or angular profiles. This tool is typically used to create seating recesses for floor joists, rafters, or cross-members.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script modifies 3D geometry directly. |\n| Paper Space | No | Not designed for 2D layouts. |\n| Shop Drawing | No | Does not generate shop drawing views. |\n\n## Prerequisites\n- **Required Entities**: Sip (Panel) element.\n- **Minimum Beam Count**: 1 Panel.\n- **Required Settings**: None specific.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCLT-RebateEdge.mcr`\n*Note: If executed from a catalog, the property dialog may be skipped.*\n\n### Step 2: Select Panel\n```\nCommand Line: Select panels\nAction: Click on the CLT or SIP panel edge where you want to apply the rebate.\n```\n\n### Step 3: Define Start Point\n```\nCommand Line: Start point [pick]\nAction: Click on the panel edge to define the start location of the rebate.\n```\n\n### Step 4: Define End Point\n```\nCommand Line: End point [pick]\nAction: Click along the same edge to define the end location. This sets the length.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| sFace | dropdown | Reference Side | Selects which side of the panel the rebate depth is calculated from (Reference or Opposite). |\n| dDepth | number | 20 mm | The depth of the rebate cut perpendicular to the panel edge. |\n| dWidth | number | 40 mm | The length of the rebate opening measured along the panel edge. |\n| dRadius | number | 0 mm | The radius of the rebate corners. Setting this to 0 forces an angular shape. |\n| sShape | dropdown | Round | Determines the profile of the rebate corners (Round or Angular shaped). |\n| OverShootStart | Yes/No | No | Extends the rebate cut past the user-defined start point. |\n| OverShootEnd | Yes/No | No | Extends the rebate cut past the user-defined end point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Flip Side (Doubleclick) | Toggles the rebate to the opposite face of the panel (Reference vs Opposite). |\n| Overshoot Start | Toggles the extension of the cut beyond the start grip point. |\n| Overshoot End | Toggles the extension of the cut beyond the end grip point. |\n| Overshoot (Both) | Toggles extensions for both start and end points simultaneously. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: All parameters are managed via the Properties Palette.\n\n## Tips\n- **Quick Flip**: Double-click the script grip in the model to instantly flip the rebate to the other side of the panel.\n- **Radius Constraints**: If you set the `dRadius` to 0, the `sShape` property automatically locks to \"Angular shaped\". To enable \"Round\", ensure `dRadius` is greater than 0.\n- **Geometry Limits**: If you use \"Angular shaped\" with a radius larger than the width, the tool will automatically adjust the width to fit the radius.\n- **Visuals**: When using a \"Round\" shape, the script will generate a radial dimension request and display the radius value (e.g., \"R50\") in the model.\n\n## FAQ\n- **Q: Why is the 'Shape' property locked and grayed out?**\n  **A:** This happens when the `dRadius` is set to 0. Increase the radius value to unlock the \"Round\" shape option.\n  \n- **Q: How do I make the cut go all the way through a connected member?**\n  **A:** Select the script instance, right-click, and choose \"Overshoot Start\" or \"Overshoot End\" to extend the tool body beyond the grip points."
      },
      "tokens_used": 5376,
      "error": null
    }
  }
}