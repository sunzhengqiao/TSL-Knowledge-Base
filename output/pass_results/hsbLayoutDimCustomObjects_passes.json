{
  "filename": "hsbLayoutDimCustomObjects.mcr",
  "status": "completed",
  "total_tokens": 56063,
  "processing_time": 357.0612082481384,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "This TSL creates dimension lines in paperspace in dependency of an element viewport.\nIt collects tsl's and offers filter options for the referenced objects to limit the selection set.\nThe dimension lines may have additional points of certain references such as openings or intersecting walls.",
        "versionHistory": [
          {
            "version": "1.7",
            "date": "31mar16",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "tsl origin excluded if map based dimRequests are attached to the dimension instance"
          },
          {
            "version": "1.6",
            "date": "31mar16",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix opening / element references, introduced 1.4"
          },
          {
            "version": "1.5",
            "date": "27nov15",
            "author": "th@hsbCAD.de",
            "changes": "bugfix tsl based dimrequests"
          },
          {
            "version": "1.4",
            "date": "22apr15",
            "author": "th@hsbCAD.de",
            "changes": "tsl based dimrequests added, new property to set local vertical dimlines"
          },
          {
            "version": "1.3",
            "date": "10oct13",
            "author": "th@hsbCAD.de",
            "changes": "tsl's will be filtered by OPM name instead of scriptname"
          },
          {
            "version": "1.2",
            "date": "12jul13",
            "author": "th@hsbCAD.de",
            "changes": "bugfix disappearing dimline solved when all dimension modes are set to parallel"
          },
          {
            "version": "1.0",
            "date": "14mar13",
            "author": "th@hsbCAD.de",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7632,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Viewport selection via getViewport(), coordinate transformation ms2ps = vp.coordSys(), dimension drawing relative to insertion point in layout, explicit description 'creates dimension lines in paperspace'."
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout) containing a Viewport linked to an hsbCAD Element",
          "requiredSettings": []
        }
      },
      "tokens_used": 7017,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"Select a viewport\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"insertion point\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"runtimeInteractions\": [\n      {\n        \"context\": \"Context Menu - Add Point\",\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnRecalc && _kExecuteKey == sTrigger[0]\"\n      },\n      {\n        \"context\": \"Context Menu - Delete Point\",\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnRecalc && _kExecuteKey == sTrigger[1]\"\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimstyle\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sDescAlias\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Description Alias\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color\",\n      \"defaultValue\": 171,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dScaleFactor\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Scale Factor\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"Sets the scale factor of the dimension line.\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sIncludeZone\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Include entities of Zone\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Objects\",\n      \"description\": \"Separate multiple entries by ' ;'\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sIncludeTsl\",\n      \"type\": \"PropString\",\n      \"displayName\": \"TSL byName\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Objects\",\n      \"description\": \"Separate multiple entries by ' ;'\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sIncludeColor\",\n      \"type\": \"PropString\",\n      \"displayName\": \"TSL byColor\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Objects\",\n      \"description\": \"Separate multiple entries by ' ;'\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sIncludeZoneRef\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter Reference Zone\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Reference\",\n      \"description\": \"Enter Zone"
      },
      "tokens_used": 10273,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the creation of 2D layout dimensions in PaperSpace by detecting and measuring the positions of TSL objects (e.g., windows, doors), openings, and structural zones within a wall or floor element.",
          "category": "ShopDrawing/Annotation",
          "typicalUseCase": "Used during the detailing phase to automatically generate elevation dimensions for wall panels, ensuring accurate placement of windows, studs, and connections on the final manufacturing drawings."
        },
        "parameters": [
          {
            "name": "sDimStyle",
            "technicalDefault": "",
            "businessMeaning": "Selects the visual appearance of the dimension (arrow style, text font, precision) from pre-defined CAD styles.",
            "validRange": "Any existing DimStyle in the drawing template",
            "unit": "String",
            "affectsOutput": "Visual appearance of dimension arrows and text."
          },
          {
            "name": "dScaleFactor",
            "technicalDefault": 1,
            "businessMeaning": "Adjusts the overall size of dimension features (text height, arrow size) relative to the viewport scale.",
            "validRange": "0.1 - 10.0",
            "unit": "Multiplier",
            "affectsOutput": "Scales the size of dimension geometry up or down."
          },
          {
            "name": "sDescAlias",
            "technicalDefault": "",
            "businessMeaning": "User-defined label text to identify the specific view or wall segment being dimensioned (e.g., 'Wall A Elevation').",
            "validRange": "Text string",
            "unit": "String",
            "affectsOutput": "Draws a text label at the dimension insertion point."
          },
          {
            "name": "nColor",
            "technicalDefault": 171,
            "businessMeaning": "Sets the CAD color index for the dimension lines and text to adhere to layering or office standards.",
            "validRange": "0 - 255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Color of the generated dimensions."
          },
          {
            "name": "sIncludeZone",
            "technicalDefault": "",
            "businessMeaning": "Filters which structural zones (e.g., 'EndZone', 'MiddleZone') within the element should generate dimension points.",
            "validRange": "Zone names defined in element properties",
            "unit": "String (semicolon separated)",
            "affectsOutput": "Determines which internal regions of the wall are measured."
          },
          {
            "name": "sIncludeTsl",
            "technicalDefault": "",
            "businessMeaning": "Filters dimensions based on the specific script name of TSL objects (e.g., only dimension 'hsbWindow' objects).",
            "validRange": "TSL Script filenames",
            "unit": "String (semicolon separated)",
            "affectsOutput": "Restricts dimension points to specific accessory types."
          },
          {
            "name": "sIncludeColor",
            "technicalDefault": "",
            "businessMeaning": "Filters dimensions based on the assigned color of the TSL objects in the model.",
            "validRange": "Color Indices",
            "unit": "String (semicolon separated)",
            "affectsOutput": "Restricts dimension points to objects of specific colors."
          },
          {
            "name": "sRefModeHor",
            "technicalDefault": "Element",
            "businessMeaning": "Defines the reference points for Horizontal dimensions. Options include Overall Element, Internal Zones, Openings, or Intersecting Walls.",
            "validRange": "Element, Reference Zone, Opening, Opening+Walls, Walls",
            "unit": "Enum",
            "affectsOutput": "Changes the origin and extension lines of horizontal dimensions (e.g., measuring wall width vs measuring window spacing)."
          },
          {
            "name": "sRefModeVer",
            "technicalDefault": "Element",
            "businessMeaning": "Defines the reference points for Vertical dimensions (Height).",
            "validRange": "Element, Reference Zone, Opening, Opening+Element",
            "unit": "Enum",
            "affectsOutput": "Changes the origin and extension lines of vertical dimensions."
          },
          {
            "name": "sIncludeZoneRef",
            "technicalDefault": "",
            "businessMeaning": "Filters reference zones to be used specifically for calculating the main dimension reference points.",
            "validRange": "Zone Indices",
            "unit": "String (semicolon separated)",
            "affectsOutput": "Filters which structural zones act as the bounding box for dimensions."
          },
          {
            "name": "sDisplayModeHorDelta",
            "technicalDefault": "Parallel",
            "businessMeaning": "Controls how individual horizontal measurements (Delta) are displayed. 'Parallel' aligns text with the object, 'Perpendicular' aligns horizontally.",
            "validRange": "Parallel, Perpendicular, None",
            "unit": "Enum",
            "affectsOutput": "Orientation and visibility of individual horizontal dimension texts."
          },
          {
            "name": "sDisplayModeHorChain",
            "technicalDefault": "Parallel",
            "businessMeaning": "Controls how continuous horizontal measurements (Chain) are displayed.",
            "validRange": "Parallel, Perpendicular, None",
            "unit": "Enum",
            "affectsOutput": "Orientation and visibility of continuous horizontal dimension strings."
          },
          {
            "name": "sDisplayModeVerDelta",
            "technicalDefault": "Perpendicular",
            "businessMeaning": "Controls how individual vertical measurements are displayed.",
            "validRange": "Parallel, Perpendicular, None",
            "unit": "Enum",
            "affectsOutput": "Orientation and visibility of individual vertical dimension texts."
          },
          {
            "name": "sDisplayModeVerChain",
            "technicalDefault": "Perpendicular",
            "businessMeaning": "Controls how continuous vertical measurements are displayed.",
            "validRange": "Parallel, Perpendicular, None",
            "unit": "Enum",
            "affectsOutput": "Orientation and visibility of continuous vertical dimension strings."
          },
          {
            "name": "sTslByInstance",
            "technicalDefault": "No",
            "businessMeaning": "Toggles between one global vertical dimension line for the wall vs. individual vertical dimension lines for each TSL object (e.g., local height dim for every window).",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "Significantly changes the layout of vertical dimensions (Global vs Local)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sDisplayModeHorDelta AND sDisplayModeHorChain AND sDisplayModeVerDelta AND sDisplayModeVerChain are all set to 'None'",
            "effect": "The script detects invalid settings and resets Horizontal and Vertical Delta modes to their defaults ('Parallel' and 'Perpendicular' respectively) to prevent drawing nothing.",
            "cascade": [
              "sDisplayModeHorDelta",
              "sDisplayModeVerDelta"
            ]
          },
          {
            "trigger": "sTslByInstance is set to 'Yes'",
            "effect": "Overrides standard vertical reference logic. Instead of using the element's reference points for a single vertical dimension line, it iterates through all filtered TSLs to create local dimensions.",
            "cascade": [
              "sDisplayModeVerDelta",
              "sDisplayModeVerChain"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Dimension (AutoCAD)",
            "description": "2D dimension lines (Linear, Aligned) placed in PaperSpace.",
            "appliedTo": "Layout/Sheet View"
          },
          {
            "type": "Text Label",
            "description": "Optional alias text label based on sDescAlias property.",
            "appliedTo": "Layout/Sheet View"
          },
          {
            "type": "Grip Points (Map)",
            "description": "Interactive points stored in the script map allowing users to add custom dimension locations manually via right-click context menu.",
            "appliedTo": "Script Instance"
          }
        ]
      },
      "tokens_used": 10439,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Execution Start (Insert or Recalc)",
          "2. [Insert Phase] Show Properties Dialog (showDialog)",
          "3. [Insert Phase] User selects Viewport linked to hsbCAD Element",
          "4. [Insert Phase] User selects Insertion Point in PaperSpace",
          "5. [Run Phase] Validate Viewport and Element existence",
          "6. [Run Phase] Calculate Coordinate Systems (ModelSpace to PaperSpace transformation)",
          "7. [Run Phase] Collect Reference Entities (Openings, Connected Walls) based on OPM 'RefMode' settings",
          "8. [Run Phase] Filter TSL entities based on OPM 'Include' settings (Zone, Name, Color)",
          "9. [Run Phase] Restore User-defined points from Script Map",
          "10. [Run Phase] Calculate Reference Points for Horizontal and Vertical dimensions",
          "11. [Conditional Branch] Check 'sTslByInstance' (Vertical Local vs Global)",
          "12. [Run Phase] Iterate TSLs to collect 'DimRequest' points or TSL Origins",
          "13. [Run Phase] Sort and Snap dimension points to Element Outline",
          "14. [Run Phase] Draw Horizontal Dimensions",
          "15. [Run Phase] Draw Vertical Dimensions (Global or Local)",
          "16. [Run Phase] Draw Description Alias Text (if enabled)",
          "17. Script Completion"
        ],
        "conditionalBranches": [
          {
            "condition": "sTslByInstance Property Value",
            "path1": {
              "name": "Local Vertical Dimensions (Yes)",
              "steps": [
                "Clear standard vertical point array",
                "Iterate through filtered TSLs",
                "Read 'DimRequest' map from individual TSL instances",
                "Create individual vertical dimension lines for each TSL",
                "Alternate dimension line side (left/right) for each TSL",
                "Skip the Global Vertical Dimension drawing step later in the script"
              ]
            },
            "path2": {
              "name": "Global Vertical Dimensions (No)",
              "steps": [
                "Calculate global vertical reference points (Element, Zone, Openings)",
                "Append TSL origins or requested points to the global array",
                "Draw single or collective vertical dimension lines for the whole element"
              ]
            }
          },
          {
            "condition": "sRefModeHor / sRefModeVer Properties",
            "path1": {
              "name": "Element/Zone Reference",
              "steps": [
                "Calculate bounding box of the Element or specific Structural Zones",
                "Use these extents as the start/end points for the dimension chain"
              ]
            },
            "path2": {
              "name": "Opening/Wall Reference",
              "steps": [
                "Collect all Opening sub-elements or Connected Wall elements",
                "Calculate bounding box of these sub-elements",
                "Use these extents as the start/end points for the dimension chain"
              ]
            }
          },
          {
            "condition": "sIncludeTsl Filter Result",
            "path1": {
              "name": "Match Found",
              "steps": [
                "Populate TSL array",
                "Proceed to dimension calculation"
              ]
            },
            "path2": {
              "name": "No Match (Empty Set)",
              "steps": [
                "Script execution halts immediately",
                "No dimensions are drawn",
                "No Alias text is drawn"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Element Validity",
            "errorMessage": "(Implicit) Script exits silently or draws nothing.",
            "recovery": "Ensure the selected viewport in PaperSpace is linked to a valid hsbCAD Element/Model."
          },
          {
            "check": "Display Modes Configuration",
            "errorMessage": "Properties set to default. Current Properties would not display anything.",
            "recovery": "Script automatically resets 'Delta' modes to 'Parallel' and 'Perpendicular' respectively if all modes are set to 'None'."
          },
          {
            "check": "Filter Constraints",
            "errorMessage": "(Implicit) No output generated.",
            "recovery": "Verify 'sIncludeTsl', 'sIncludeZone', and 'sIncludeColor' properties actually match entities in the model."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Move Grip Points",
            "how": "Click and drag script instance grips (_PtG)",
            "effect": "Updates the coordinate in the 'userPoints' Map, causing the dimension lines to dynamically adjust to the new location."
          },
          {
            "action": "Add Custom Point",
            "how": "Right-click script instance -> 'Add Point'",
            "effect": "Prompts user for a location; adds a new persistent dimension reference point to the current element's map."
          },
          {
            "action": "Delete Custom Point",
            "how": "Right-click script instance -> 'Delete Point'",
            "effect": "Prompts user for a location; removes the nearest user-defined point from the map."
          },
          {
            "action": "Reset Custom Points",
            "how": "Right-click script instance -> 'Delete all Points' or 'Delete all Points of all Elements'",
            "effect": "Clears the stored 'userPoints' Map for the current element or all elements respectively."
          },
          {
            "action": "Modify OPM Properties",
            "how": "Select script instance and change values in AutoCAD Properties Palette",
            "effect": "Triggers a recalculation. Changing filters (Zone/Color/Name) updates the selection set. Changing RefModes or DisplayModes updates the dimension layout."
          }
        ]
      },
      "tokens_used": 12380,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbLayoutDimCustomObjects.mcr\n\n## Overview\nThis script automatically creates dimension lines in PaperSpace (Layouts) based on the content of a selected Model Space viewport. It detects TSL objects (like windows or doors), openings, and structural zones to generate precise elevation dimensions for your drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | Dimensions are created in PaperSpace. |\n| Paper Space | Yes | This is the primary environment for this script. |\n| Shop Drawing | Yes | Used for detailing views on production drawings. |\n\n## Prerequisites\n- **Required Entities**: An existing Layout (PaperSpace) with a Viewport that is linked to an hsbCAD Element.\n- **Minimum Beams**: None (Works with Elements and TSLs).\n- **Required Settings**: The Element linked to the viewport must contain TSL objects (e.g., `hsbWindow`, `hsbDoor`) or structural zones to generate dimensions.\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT`\n1.  Type `TSLINSERT` in the command line.\n2.  Browse and select `hsbLayoutDimCustomObjects.mcr`.\n3.  The Properties Palette may appear immediately to configure initial settings.\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the viewport in the Layout that displays the Element you want to dimension.\n```\n\n### Step 3: Set Insertion Point\n```\nCommand Line: insertion point\nAction: Click in the PaperSpace to define where the dimension lines (and description alias) will be placed.\n```\n\n## Properties Panel Parameters\n\n### General Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimstyle | dropdown | (empty) | Select the visual style (arrows, text font) from your CAD's pre-defined dimension styles. |\n| Description Alias | text | (empty) | Enter a label to identify the view (e.g., \"Wall Elevation\"). This text appears at the insertion point. |\n| Color | number | 171 | Sets the AutoCAD color index for the dimension lines and text. |\n| Scale Factor | number | 1.0 | Multiplies the size of the dimension features (text height, arrow size) relative to the viewport scale. |\n\n### Object Filtering\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Include entities of Zone | text | (empty) | Filters which structural zones to dimension. Separate multiple zone names with `;` (e.g., \"EndZone;MiddleZone\"). |\n| TSL byName | text | (empty) | Filters dimensions by specific TSL script names. Separate names with `;` (e.g., \"hsbWindow;hsbDoor\"). |\n| TSL byColor | text | (empty) | Filters dimensions by the color index of the TSL objects. Separate indices with `;`. |\n| Filter Reference Zone | text | (empty) | Filters which structural zones act as the bounding box for reference points. |\n\n### Horizontal Dimensions\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| RefModeHor | dropdown | Element | Determines reference points: `Element` (overall width), `Reference Zone`, `Opening`, `Opening+Walls`, or `Walls`. |\n| DisplayModeHorDelta | dropdown | Parallel | Controls orientation of individual measurements: `Parallel`, `Perpendicular`, or `None`. |\n| DisplayModeHorChain | dropdown | Parallel | Controls orientation of continuous measurements: `Parallel`, `Perpendicular`, or `None`. |\n\n### Vertical Dimensions\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| RefModeVer | dropdown | Element | Determines vertical reference points (e.g., `Element`, `Reference Zone`, `Opening`). |\n| DisplayModeVerDelta | dropdown | Perpendicular | Controls orientation of individual vertical measurements. |\n| DisplayModeVerChain | dropdown | Perpendicular | Controls orientation of continuous vertical measurements. |\n| TSL by Instance | dropdown | No | **Yes**: Creates individual vertical dimensions for each filtered TSL. **No**: Creates one global vertical dimension for the whole element. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Add Point | Allows you to click a location in the viewport to add a custom user-defined dimension reference point. |\n| Delete Point | Allows you to click near a custom point to remove it from the dimension calculation. |\n| Delete all Points | Removes all custom points associated with the current Element/Script instance. |\n| Delete all Points of all Elements | Clears all custom points stored by this script for every element in the project. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: This script relies entirely on the Properties Palette parameters and the geometry of the selected Element.\n\n## Tips\n- **Filtering**: If no dimensions appear, check your **TSL byName** or **Include entities of Zone** filters. If the filter does not match any objects in the model, the script will produce no output.\n- **Separators**: When entering multiple items in text fields (like Colors or Zones), ensure you separate them with a semicolon and a space (`; `).\n- **TSL by Instance**: Set **TSL by Instance** to \"Yes\" if you want each window or door to have its own separate height dimension line next to it, rather than one long vertical dimension chain for the whole wall.\n- **Map-Based Points**: Use the **Add Point** right-click option to manually add dimension points for unique geometry that the automatic filters might miss.\n\n## FAQ\n- **Q: Why did my dimensions disappear after I changed the Display Modes?**\n  **A:** If you set all Display Modes (Delta and Chain for both Horizontal and Vertical) to \"None\", the script detects this as an invalid state and resets the Delta modes to their defaults (\"Parallel\" and \"Perpendicular\") to ensure something is drawn.\n- **Q: Can I dimension walls that are not rectangular?**\n  **A:** This script works best with orthogonal elevations. It calculates references based on bounding boxes of the selected elements or openings.\n- **Q: How do I change the arrow style?**\n  **A:** Use the **Dimstyle** property to select a pre-defined AutoCAD dimension style that matches your company standards."
      },
      "tokens_used": 8322,
      "error": null
    }
  }
}