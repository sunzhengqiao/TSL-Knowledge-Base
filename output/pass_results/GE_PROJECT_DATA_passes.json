{
  "filename": "GE_PROJECT_DATA.mcr",
  "status": "completed",
  "total_tokens": 47951,
  "processing_time": 489.9247510433197,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6489,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getPoint to insert geometry and Display dp(-1) to draw a table. It lacks sd_ prefix, _Viewport usage, and #Type E declarations, indicating standard Model Space operation. It creates MapObjects and sets project properties (setProjectName) rather than generating fabrication drawings."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Requires user to select an insertion point via getPoint. Typically Model Space.",
          "requiredSettings": []
        }
      },
      "tokens_used": 6543,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"\\nSelect the upper left corner ot the table\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"strDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dim Style\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"_DimStyles\",\n      \"category\": \"GENERAL\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dpTH\",\n      \"type\": \"PropDouble\",\n      \"displayName\":"
      },
      "tokens_used": 9578,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Inserts a customizable Project Information and Revision table into the drawing and synchronizes this data with the global hsbCAD Project Properties and MapObjects for use in labels and reports.\",\n    \"category\": \"Project Management / Administration\",\n    \"typicalUseCase\": \"Used at the start of a project to input metadata (Client, Address) and whenever a design revision is issued to update the revision history and current status displayed in the model.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"strDim\",\n      \"technicalDefault\": \"_DimStyles\",\n      \"businessMeaning\": \"The AutoCAD dimension style used to define the font and appearance of the text within the project table.\",\n      \"validRange\": \"Any existing DimStyle in the drawing\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the font and text formatting of the drawn table.\"\n    },\n    {\n      \"name\": \"dpTH\",\n      \"technicalDefault\": \"U(10)\",\n      \"businessMeaning\": \"The height of the text characters in the project table.\",\n      \"validRange\": \"2.0 to 6.0 (inches depending on drawing scale)\",\n      \"unit\": \"Inches\",\n      \"affectsOutput\": \"Increases text size and row height (row height is 2x text height).\"\n    },\n    {\n      \"name\": \"strPName\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The official name of the construction project.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table text and the global 'Project Name' property used for exports and BIM data.\"\n    },\n    {\n      \"name\": \"strPTitle\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The specific title or phase of the project plan.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display.\"\n    },\n    {\n      \"name\": \"strPNum\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The unique project identification number or Job ID assigned by the firm.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table text and the global 'Project Number' property.\"\n    },\n    {\n      \"name\": \"strPClient\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The name of the client or owner commissioning the project.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table text and contributes to the internal 'Project Name' string.\"\n    },\n    {\n      \"name\": \"strPArchitect\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The name of the architectural firm or architect of record.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display.\"\n    },\n    {\n      \"name\": \"strPAddressLn1 / strPAddressLn2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The physical location of the project site.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display and the global 'Project City' property.\"\n    },\n    {\n      \"name\": \"strPDesigner\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The name of the lead designer or engineer responsible for the timber design.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display and the global 'Project User' property.\"\n    },\n    {\n      \"name\": \"strPCheck\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The name of the checker or QA personnel who verified the design.\",\n      \"validRange\": \"Free text\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display and the global 'Project User' property.\"\n    },\n    {\n      \"name\": \"strPDate\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The start date of the project or the date of the initial design issue.\",\n      \"validRange\": \"Date format (MM/DD/YYYY)\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Updates the table display and the global 'Project Street' property.\"\n    },\n    {\n      \"name\": \"strRev1-17 (Date & Desc)\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"History log of design changes. Includes the date of the revision and a brief description of what changed.\",\n      \"validRange\": \"Free text / Date\",\n      \"unit\": \"String"
      },
      "tokens_used": 9391,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches the GE_PROJECT_DATA script.",
          "2. Script checks the _bOnInsert flag to determine if this is a new insertion.",
          "3. [Conditional - New Insertion] Script checks insertCycleCount(). If > 1, the instance is immediately erased to prevent duplicates.",
          "4. [Conditional - New Insertion] User is prompted via command line to select an insertion point (getPoint).",
          "5. [Conditional - New Insertion] The Property Palette (showDialogOnce) is displayed automatically for initial data entry.",
          "6. Script calculates text dimensions based on the 'Dim Style' and 'Text Height' properties.",
          "7. Script initializes grip points (_PtG) for column width adjustment, aligning them horizontally.",
          "8. Script compiles property data into arrays (Project Data on the left, Revisions on the right).",
          "9. Script iterates through Revision data to identify the latest revision based on non-empty date fields.",
          "10. Script draws the table geometry (lines, text, rectangles) based on the calculated layout and data arrays.",
          "11. Script updates global hsbCAD Project Properties (Name, Number, Street, City, etc.) using the input data.",
          "12. Script compiles all data into Map objects (mpProjectXData, mpProjectRevisions).",
          "13. Script erases the existing MapObject 'MoProjectData' from the database and recreates it with the current data (Upsert)."
        ],
        "conditionalBranches": [
          {
            "condition": "Is this a new script insertion? (_bOnInsert == true)",
            "path1": {
              "name": "Insert Mode",
              "steps": [
                "Check insertCycleCount to prevent duplicates.",
                "Prompt user for Insertion Point (getPoint).",
                "Show Properties Dialog (showDialogOnce).",
                "Execute Geometry generation."
              ]
            },
            "path2": {
              "name": "Recalc/Update Mode",
              "steps": [
                "Skip point selection and dialog prompts.",
                "Read existing _Pt0 and Property values.",
                "Regenerate Geometry based on changes.",
                "Update MapObject and Project Properties."
              ]
            }
          },
          {
            "condition": "Revision Date field population check (strRevX.length() > 0)",
            "path1": {
              "name": "Valid Revision Found",
              "steps": [
                "Update iLatestRev index.",
                "Store revision description and date in variables.",
                "Mark specific revision row as active (internal logic)."
              ]
            },
            "path2": {
              "name": "Empty Revision",
              "steps": [
                "Skip updating latest revision index.",
                "Render empty row in table."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent)",
            "recovery": "If the script is inserted multiple times in a single command cycle, subsequent instances are automatically erased. User simply re-runs the command normally."
          },
          {
            "check": "Insertion Point Selection",
            "errorMessage": "None (Standard AutoCAD behavior)",
            "recovery": "If the user presses Esc during getPoint, the script terminates without creating an instance."
          },
          {
            "check": "Text Height Property",
            "errorMessage": "None",
            "recovery": "Defaults to Dim Style height if dpTH is 0 or logic implies default usage."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Project Information",
            "how": "Properties Palette (OPM)",
            "effect": "Updates the text inside the drawn table, updates global hsbCAD Project Properties, and refreshes the embedded MapObject data."
          },
          {
            "action": "Update Revisions",
            "how": "Properties Palette (OPM) - Revisions category",
            "effect": "Updates the revision table rows. If a new date is entered into a higher-numbered revision slot, the 'Latest Revision' logic updates automatically to reflect the new entry."
          },
          {
            "action": "Adjust Column Widths",
            "how": "Grip Edit",
            "effect": "There are 5 grips located at the top of the table. Dragging these grips left or right adjusts the position of the vertical dividers, resizing the 'Label', 'Value', 'Rev Header', 'Date', and 'Description' columns."
          },
          {
            "action": "Move Table",
            "how": "Standard AutoCAD Move/Select",
            "effect": "Moves the entire table geometry relative to the insertion point."
          }
        ]
      },
      "tokens_used": 9601,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_PROJECT_DATA.mcr\n\n## Overview\nInserts a customizable Project Information and Revision table into the drawing. This script allows you to define project metadata (Client, Architect, Address) and manage a revision history, automatically syncing this data with global hsbCAD Project Properties for use in labels and reports.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script is designed for insertion into the 3D model or 2D plan view. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required entities**: None.\n- **Minimum beam count**: 0.\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Select `GE_PROJECT_DATA.mcr` from the file dialog.\n\n### Step 2: Select Insertion Point\n```\nCommand Line: Select the upper left corner of the table\nAction: Click in the drawing to place the top-left corner of the project table.\n```\n\n### Step 3: Edit Project Data\n1. After insertion, the Properties Palette (OPM) will open automatically.\n2. Enter the Project details (Name, Number, Client, etc.).\n3. Fill in the initial Revision history if applicable.\n4. The table geometry in the drawing updates instantly to reflect your entries.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Visual Settings** | | | |\n| Dim Style | dropdown | _DimStyles | Selects the AutoCAD dimension style to control font and text appearance. |\n| Text Height | number | U(10) | Sets the height of the text in the table. Row height adjusts automatically (2x text height). |\n| **Project Information** | | | |\n| Project Name | text | | Sets the official Project Name (updates global hsbCAD Project Name). |\n| Project Title | text | | The specific title or phase of the plan. |\n| Project Number | text | | Unique Job ID (updates global hsbCAD Project Number). |\n| Client | text | | Name of the client or owner. |\n| Architect | text | | Name of the architectural firm or architect. |\n| Address Line 1 | text | | First line of the site address. |\n| Address Line 2 | text | | Second line of the site address (updates global Project City). |\n| Designer | text | | Lead designer/engineer name (updates global Project User). |\n| Checker | text | | QA/Checker name (updates global Project User). |\n| Date | text | | Project start or issue date (updates global Project Street). |\n| **Revisions** | | | |\n| Revision 1-17 | text/date | | Enter the Date and Description for up to 17 revisions. The script automatically highlights the latest revision with a non-empty date. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Refreshes the script geometry if manual changes were made or to force an update. |\n\n## Settings Files\nNone used.\n\n## Tips\n- **Column Widths**: You can adjust the width of the table columns by selecting the table and dragging the **5 square grips** located at the top edge.\n- **Global Data**: Changes made to Project Name, Number, Designer, and Date in this table automatically update the global hsbCAD project properties, which can be utilized by other scripts (e.g., labels).\n- **Latest Revision**: The script identifies the \"Latest Revision\" based on the last entry in the list that has a date filled in. Ensure you fill in the Date field for the revision you want to mark as current.\n\n## FAQ\n- **Q: How do I resize the columns?**\n  A: Select the table in the drawing. You will see 5 grip points at the top of the table. Click and drag these grips left or right to resize the specific columns.\n- **Q: Why didn't the global project properties update?**\n  A: Ensure you have entered text into the relevant fields (e.g., Project Name, Project Number) in the Properties Palette and pressed Enter. The table must remain in the drawing to maintain the link.\n- **Q: Can I change the text font?**\n  A: Yes. Use the \"Dim Style\" property in the Properties Palette to select any existing Dimension Style in your drawing to match text fonts and sizes."
      },
      "tokens_used": 6349,
      "error": null
    }
  }
}