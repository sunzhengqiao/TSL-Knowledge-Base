{
  "filename": "hsb_InventoryDB.mcr",
  "status": "completed",
  "total_tokens": 18730,
  "processing_time": 409.470664024353,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.13",
            "date": "05072013",
            "author": "Allberto Jena",
            "changes": "Change the name of the argument for the loosematerial."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2965,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script is executed as an insert command utility. It checks for _bOnInsert, triggers a .NET dialog, and immediately calls eraseInstance(). It lacks 'sd_' prefixes, '#Type E', or '_Viewport' references, indicating it is not a ShopDrawing or Paper Space script, but a transient tool used in Model Space to launch an external UI."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (Insertion point _PtW), though the script object is self-deleting.",
          "requiredSettings": [
            "External DLL: _kPathHsbInstall + '\\Utilities\\hsbLooseMaterials\\hsbLooseMaterialsUI.dll'",
            "Catalog entry for initial properties (via setPropValuesFromCatalog)"
          ]
        }
      },
      "tokens_used": 1409,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "External .NET Form",
            "trigger": "Script Insertion (_bOnInsert)",
            "title": "ShowInventoryEditorDialog",
            "dataSource": "hsbLooseMaterialsUI.dll (hsbCad.LooseMaterials.UI.MapTransaction)",
            "features": {
              "searchable": null,
              "multiSelect": null
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3599,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script serves as a utility launcher to open the external hsbCAD 'Loose Materials Inventory Editor' dialog. It allows users to manage and edit the database of non-timber construction items (such as hardware, fasteners, and metal plates) without generating any geometry in the model.",
          "category": "Data Management / Utilities",
          "typicalUseCase": "A user needs to add a new specific screw type, metal bracket, or other loose material to the project catalog, or needs to edit the pricing/dimensions of existing inventory items."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": []
      },
      "tokens_used": 3922,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User inserts script 'hsb_InventoryDB.mcr' into the drawing",
          "Script initializes unit system to 'mm'",
          "System sets properties from catalog based on execution key (_kExecuteKey) if on database creation or insertion",
          "Script checks the insertCycleCount to determine if this is the first execution cycle",
          "[Conditional] If insertCycleCount > 1, the script instance is erased and execution stops",
          "[Primary Path] If insertCycleCount <= 1, script defines the path to the external .NET DLL (hsbLooseMaterialsUI.dll)",
          "Script creates an input Map (mpIn)",
          "Script calls the external .NET function 'ShowInventoryEditorDialog' via 'callDotNetFunction2'",
          "External 'Loose Materials Inventory Editor' UI is launched, allowing the user to manage database items",
          "User completes actions in the external dialog and closes it",
          "Script captures any return data into mpOut map and assigns it to internal Map _Map",
          "Script returns, ending execution",
          "System runs the final 'eraseInstance' command to remove the script object from the drawing"
        ],
        "conditionalBranches": [
          {
            "condition": "Check insertCycleCount during the insertion event (_bOnInsert)",
            "path1": {
              "name": "Re-execution / Cleanup Cycle",
              "steps": [
                "insertCycleCount() is determined to be greater than 1",
                "eraseInstance() is called immediately",
                "Script returns, terminating without opening the dialog"
              ]
            },
            "path2": {
              "name": "Initial Execution Cycle",
              "steps": [
                "insertCycleCount() is less than or equal to 1",
                "Paths to .NET resources are defined",
                "External .NET function is invoked to show UI",
                "Return map is processed",
                "Script returns"
              ]
            }
          },
          {
            "condition": "System State Trigger (_bOnInsert)",
            "path1": {
              "name": "On Insert / Load",
              "steps": [
                "_bOnInsert is True",
                "Properties are updated from catalog",
                "Insert cycle logic runs",
                "Dialog is launched (if valid cycle)"
              ]
            },
            "path2": {
              "name": "Standard Recalc / Update",
              "steps": [
                "_bOnInsert is False",
                "Script skips internal logic",
                "eraseInstance() is called immediately",
                "Script returns"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Existence of the external DLL at the path defined by _kPathHsbInstall + '\\Utilities\\hsbLooseMaterials\\hsbLooseMaterialsUI.dll'",
            "errorMessage": "No specific error message is handled in the script; a failure typically results in a hsbCAD/CAD system error indicating the DLL could not be loaded.",
            "recovery": "User must ensure hsbCAD is correctly installed and the hsbLooseMaterials module is present."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 2782,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_InventoryDB.mcr\n\n## Overview\nThis script serves as a utility launcher that opens the external \"Loose Materials Inventory Editor.\" It allows you to manage and edit the database of non-timber construction items (such as screws, metal plates, and hardware) without creating any geometry in your drawing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be inserted in Model Space to function. |\n| Paper Space | No | The script is not intended for use in Layouts or Paper Space. |\n| Shop Drawing | No | This is a project management tool, not a detailing script. |\n\n## Prerequisites\n- **Required entities**: None.\n- **Minimum beam count**: 0.\n- **Required settings**: \n  - The external DLL file `hsbLooseMaterialsUI.dll` must be present in your hsbCAD installation directory (`...\\Utilities\\hsbLooseMaterials\\`).\n  - Appropriate write permissions for the project catalog/database are recommended.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse to and select `hsb_InventoryDB.mcr`.\n3. Click **Open**.\n\n### Step 2: Open Inventory Editor\n```\nCommand Line: [No prompts]\nAction: The \"Loose Materials Inventory Editor\" window appears automatically.\n```\n*Note: You do not need to click a point in the drawing. The script runs immediately upon loading.*\n\n### Step 3: Manage Database\n1. Use the dialog window to search, add, or modify loose material items (e.g., changing dimensions or prices for specific bolts).\n2. Make your desired changes to the inventory list.\n\n### Step 4: Close and Finish\n1. Click **OK** or **Close** in the Inventory Editor window.\n2. The script automatically deletes itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| *None* | *N/A* | *N/A* | This script executes immediately and does not expose parameters to the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | The script instance erases itself immediately after use, preventing persistent right-click menu interactions. |\n\n## Settings Files\n- **Filename**: None internal to the script.\n- **Location**: N/A\n- **Purpose**: This script relies on the external `hsbLooseMaterialsUI.dll` to access the project's existing material catalogs and databases.\n\n## Tips\n- **Self-Cleaning Tool**: Do not be alarmed if the script object disappears from the drawing immediately after you close the dialog. This is intended behavior to prevent drawing clutter.\n- **Database Connection**: Ensure you are working in the correct project environment, as changes made in the editor will affect the project's available loose materials.\n\n## FAQ\n- **Q: I inserted the script, but nothing happened.**\n  - A: This usually means the external `hsbLooseMaterialsUI.dll` is missing or not registered. Contact your IT support or hsbCAD administrator to verify the Utilities installation.\n\n- **Q: Where is the script object in my model?**\n  - A: The script automatically runs `eraseInstance()` after closing the dialog. It leaves no permanent trace in your drawing.\n\n- **Q: Can I use this to edit timber beam sizes?**\n  - A: No, this tool is specifically for \"Loose Materials\" (accessories, hardware, metal parts), not structural timber elements."
      },
      "tokens_used": 4053,
      "error": null
    }
  }
}