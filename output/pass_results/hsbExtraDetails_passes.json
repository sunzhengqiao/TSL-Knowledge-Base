{
  "filename": "hsbExtraDetails.mcr",
  "status": "completed",
  "total_tokens": 33505,
  "processing_time": 437.8642725944519,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "050404",
            "author": "Thorsten Huck",
            "changes": ""
          },
          {
            "version": "1.2",
            "date": "29.02.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Àdd code to work from the palette"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5280,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select ElementWallSF entities and modifies element properties (setConstrDetailLeft, setConstrDetailRight, etc.). It utilizes the _Element array and finishes with eraseInstance(), indicating a batch processing tool for the 3D model rather than a drawing generator."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 3808,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog (showDialogOnce)",
            "trigger": "On Insert (if _kExecuteKey is empty)",
            "title": null,
            "dataSource": "Properties (PropInt/PropString)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nLevel",
            "type": "PropInt",
            "displayName": "Level",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDetL",
            "type": "PropString",
            "displayName": "Detail Left",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for left side of the element. String must not contain Elementcode!"
          },
          {
            "index": 1,
            "variable": "sDetR",
            "type": "PropString",
            "displayName": "Detail Right",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for right side of the element. String must not contain Elementcode!"
          },
          {
            "index": 2,
            "variable": "sDetT",
            "type": "PropString",
            "displayName": "Detail Top",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for top side of the element. String must not contain Elementcode!"
          },
          {
            "index": 3,
            "variable": "sDetB",
            "type": "PropString",
            "displayName": "Detail Bottom",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for bottom side of the element. String must not contain Elementcode!"
          },
          {
            "index": 4,
            "variable": "sDetLT",
            "type": "PropString",
            "displayName": "Detail Left Top",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for left top side of the element. String must not contain Elementcode!"
          },
          {
            "index": 5,
            "variable": "sDetRT",
            "type": "PropString",
            "displayName": "Detail Right Top",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Defines details for right top side of the element. String must not contain Elementcode!"
          },
          {
            "index": 6,
            "variable": "sOverWrite",
            "type": "PropString",
            "displayName": "Overwrite existing details",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sUseElemCode",
            "type": "PropString",
            "displayName": "Add Elementcode to Detailname",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5391,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Batch assigns construction layer details (such as sheathing, cladding, or insulation) to specific sides of multiple selected wall elements simultaneously.\",\n    \"category\": \"Construction\",\n    \"typicalUseCase\": \"Applying specific finishing details (e.g., 'OSB_18mm') to the exterior sides of a series of wall elements after the structural layout is finalized.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"nLevel\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Specifies the index of the construction layer (within the wall's build-up) to which the details should be applied. This allows targeting specific layers like outer sheathing vs. inner drywall.\",\n      \"validRange\": \"0 to 10 (typically)\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Determines which material layer in the wall assembly receives the new detail definitions.\"\n    },\n    {\n      \"name\": \"sDetL\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the left side of the wall elements (e.g., specific cladding or connection macro).\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the left-side construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sDetR\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the right side of the wall elements.\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the right-side construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sDetT\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the top side of the wall elements.\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the top-side construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sDetB\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the bottom side of the wall elements.\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the bottom-side construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sDetLT\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the top-left corner area of the wall elements.\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the top-left corner construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sDetRT\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The name of the construction detail to apply to the top-right corner area of the wall elements.\",\n      \"validRange\": \"String matching existing detail names in the hsbCAD catalog\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Generates geometry and properties for the top-right corner construction layer based on the named detail.\"\n    },\n    {\n      \"name\": \"sOverWrite\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Controls whether to clear existing details if the input field is empty. If 'No', existing details are preserved. If 'Yes', empty inputs effectively remove the detail from that side.\",\n      \"validRange\": \"No, Yes\",\n      \"unit\": \"state\",\n      \"affectsOutput\": \"Determines if empty fields result in no change (preserving current state) or removal of the detail on the element.\"\n    },\n    {\n      \"name\": \"sUseElemCode\",\n      \"technicalDefault\": \"No\",\n      \"businessMean"
      },
      "tokens_used": 7033,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script starts and initializes properties (Level, Details Left/Right/Top/Bottom/etc., Overwrite, Use ElementCode).",
          "Check if the script is in Insert mode (_bOnInsert).",
          "If Inserting: Check if it is a subsequent cycle (insertCycleCount > 1). If yes, script self-destructs (eraseInstance).",
          "If Inserting: Check if _kExecuteKey is empty. If yes, display the Property Dialog once (showDialogOnce).",
          "Prompt user to select a set of wall elements (ElementWallSF) via PrEntity.",
          "Validate the selection: If no elements are selected or the first element is invalid, script self-destructs.",
          "Retrieve the construction level from the first selected element and update the script's 'nLevel' property to match.",
          "End Insertion phase (return), allowing the script to proceed to the calculation cycle.",
          "Loop through all elements in the _Element array.",
          "Inside Loop: Determine the Element Code prefix based on 'sUseElemCode' property.",
          "Inside Loop: Set the construction level on the element.",
          "Inside Loop: Apply specific details (Left, Right, Top, Bottom, Left-Top, Right-Top) if the corresponding property strings are not empty.",
          "Inside Loop: If 'sOverWrite' is 'Yes', explicitly clear details for any side where the property string is empty.",
          "Finish Loop: After all elements are processed, script self-destructs (eraseInstance)."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert Cycle Check",
            "path1": {
              "name": "Subsequent Cycle",
              "steps": [
                "Erase Instance",
                "Exit"
              ]
            },
            "path2": {
              "name": "First Cycle",
              "steps": [
                "Check Execution Key",
                "Prompt User"
              ]
            }
          },
          {
            "condition": "Execution Source",
            "path1": {
              "name": "Manual Insert (_kExecuteKey is empty)",
              "steps": [
                "Show Dialog",
                "Proceed to Selection"
              ]
            },
            "path2": {
              "name": "Batch/Palette Execution (_kExecuteKey is set)",
              "steps": [
                "Skip Dialog",
                "Proceed to Selection"
              ]
            }
          },
          {
            "condition": "Detail Assignment Logic",
            "path1": {
              "name": "Property String is Not Empty",
              "steps": [
                "Apply Detail Name (+Optional ElementCode) to Element Side"
              ]
            },
            "path2": {
              "name": "Property String is Empty AND Overwrite is Yes",
              "steps": [
                "Clear/Remove Detail from Element Side"
              ]
            }
          },
          {
            "condition": "Element Code Prefix",
            "path1": {
              "name": "sUseElemCode is 'No'",
              "steps": [
                "Use empty string for prefix"
              ]
            },
            "path2": {
              "name": "sUseElemCode is 'Yes'",
              "steps": [
                "Retrieve Element Code and use as prefix"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection Set",
            "errorMessage": "None (Silent failure)",
            "recovery": "User must restart the command and select valid ElementWallSF entities."
          },
          {
            "check": "Entity Validity",
            "errorMessage": "None (Silent failure)",
            "recovery": "User must ensure selection contains valid hsbCAD Wall elements."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (One-shot execution)",
            "how": "N/A",
            "effect": "The script executes and removes itself from the drawing. Modifications are permanent on the selected elements until manually changed or another batch tool is run."
          }
        ]
      },
      "tokens_used": 5807,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbExtraDetails.mcr\n\n## Overview\nBatch assigns construction layer details (such as sheathing, cladding, or insulation) to specific sides of multiple selected wall elements simultaneously.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates directly on 3D wall elements. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | This is a model modification tool, not a drawing generator. |\n\n## Prerequisites\n- **Required Entities**: `ElementWallSF` (hsbCAD Wall Elements)\n- **Minimum Beams**: 1 (Recommended to select multiple for batch processing)\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `hsbExtraDetails.mcr`\n\n### Step 2: Configure Details\n```\nInterface: Dynamic Dialog\nAction: A dialog window appears upon insertion. Enter the names of the construction details you wish to apply (e.g., \"OSB_18mm\", \"Plasterboard\") into the relevant fields (Left, Right, Top, Bottom, etc.).\n```\n\n### Step 3: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click to select the desired wall elements in the model. Press Enter to confirm the selection.\n```\n\n*(Note: After processing, the script instance will automatically erase itself from the drawing.)*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Level | number | 0 | Specifies the index of the construction layer (0-10) to which the details should be applied within the wall's build-up. |\n| Detail Left | text | \"\" | The name of the construction detail to apply to the left side of the wall. |\n| Detail Right | text | \"\" | The name of the construction detail to apply to the right side of the wall. |\n| Detail Top | text | \"\" | The name of the construction detail to apply to the top side of the wall. |\n| Detail Bottom | text | \"\" | The name of the construction detail to apply to the bottom side of the wall. |\n| Detail Left Top | text | \"\" | The name of the construction detail to apply to the top-left corner area. |\n| Detail Right Top | text | \"\" | The name of the construction detail to apply to the top-right corner area. |\n| Overwrite existing details | dropdown | No | If set to \"Yes\", empty input fields will remove existing details from the element sides. If \"No\", existing details are preserved. |\n| Add Elementcode to Detailname | dropdown | No | If set to \"Yes\", the Element Code of the wall is automatically prefixed to the detail name (e.g., \"W1_OSB\"). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific right-click context menu items. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external settings files; it uses OPM properties for configuration.\n\n## Tips\n- **Batch Processing**: This script is designed to handle multiple elements at once. Use a window selection to update all external walls in a floor quickly.\n- **Preserving Details**: By default, the \"Overwrite existing details\" option is set to \"No\". This means if you only fill in the \"Detail Left\" field, the script will only update the left side and leave the Right, Top, and Bottom details untouched.\n- **Removing Details**: To strip a detail (e.g., remove sheathing) from a side, set \"Overwrite existing details\" to \"Yes\" and leave the specific side's field empty.\n- **Self-Destructing**: Do not be alarmed if the script instance disappears from the drawing after running; this is intentional behavior.\n\n## FAQ\n- **Q: Can I use this on individual beams?**\n  - A: No, this script is specifically designed for `ElementWallSF` entities and will not work on standard beams or columns.\n- **Q: What happens if I enter a detail name that doesn't exist?**\n  - A: The script will attempt to assign the name provided. If the construction detail does not exist in your hsbCAD catalog, the wall element may not generate the expected geometry or may show an error.\n- **Q: Why did my existing details disappear?**\n  - A: You likely had \"Overwrite existing details\" set to \"Yes\". When this is active, any empty field in the dialog acts as a command to clear that detail on the element. Change it to \"No\" to preserve existing details."
      },
      "tokens_used": 6186,
      "error": null
    }
  }
}