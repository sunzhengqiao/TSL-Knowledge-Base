{
  "filename": "hsb_ConvertBeamToJoistProfile.mcr",
  "status": "completed",
  "total_tokens": 22758,
  "processing_time": 154.3849172592163,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "09.03.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.1",
            "date": "14.04.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Added Property for Zones"
          },
          {
            "version": "1.2",
            "date": "22.11.2012",
            "author": "",
            "changes": "Add the option to select a zone and will convert all the beams of that zone into sheets"
          },
          {
            "version": "1.3",
            "date": "23.01.2014",
            "author": "",
            "changes": "Control the color of the new sheet"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3512,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script interacts with 3D entities using 'Element' and 'Beam' classes via 'PrEntity' and 'el.beam()'. It modifies beam properties (setExtrProfile) in the model. There are no references to 'sd_' prefixes, '_Viewport', or '#Type E' which indicate Paper Space or Shop Drawing environments."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing Elements with Beams.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2004,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sFilterBeams",
            "type": "PropString",
            "displayName": "Convert Beams with Code",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Separate multiple entries by| ';'"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4685,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Standardizes the cross-sectional profile of specific structural beams within selected elements to match the profile of the element's center joist.",
          "category": "Framing",
          "typicalUseCase": "Updating joists or rafters in a floor or roof zone to a new standard size after the primary center joist profile has been modified or defined."
        },
        "parameters": [
          {
            "name": "sFilterBeams",
            "technicalDefault": "",
            "businessMeaning": "A whitelist of beam codes (e.g., 'Rafter', 'Purlin') that identify which beams should be updated to match the center joist profile.",
            "validRange": "Text strings corresponding to the project's Beam Codes. Multiple entries separated by ';'.",
            "unit": "String",
            "affectsOutput": "Only beams whose code matches an entry in this list will have their profile changed. Other beams remain unchanged."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User selects Elements via command prompt",
            "effect": "Script iterates through beams in those elements. It identifies the 'Target Profile' from the first center joist found and applies it to beams matching the sFilterBeams list.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Geometric modification of the beam cross-section (width and height) via setExtrProfile.",
            "appliedTo": "Beams contained within the user-selected Elements that possess a Beam Code matching the sFilterBeams filter."
          }
        ]
      },
      "tokens_used": 2817,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 6456,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ConvertBeamToJoistProfile.mcr\n\n## Overview\nThis script standardizes the cross-sectional profile of specific beams within selected elements. It automatically updates the width and height of filtered beams to match the profile of the element's center joist.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D Elements and Beams in the model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities:** Elements containing Beams.\n- **Minimum Beam Count:** 1\n- **Required Settings:** None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse the file list and select `hsb_ConvertBeamToJoistProfile.mcr`.\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the Elements (or Zones) in the model that contain the beams you wish to update. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Filter (Optional)\nAction: Before or after selecting elements, open the **Properties Palette** (Ctrl+1). Enter the specific Beam Codes you wish to target in the *Convert Beams with Code* field.\n\n### Step 4: Execution\nAction: Once the elements are selected, the script will automatically identify the center joist's profile and apply it to all matching beams within those elements.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Convert Beams with Code | Text | \"\" | Enter the Beam Codes (e.g., 'Rafter', 'Purlin') to identify which beams should be updated. Separate multiple codes with a semicolon ';'. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom right-click menu options are available for this script. |\n\n## Settings Files\n- **Filename**: None required.\n\n## Tips\n- **Target Profile:** Ensure that the \"Center Joist\" of the element already has the correct profile before running the script, as this is the source shape used for the conversion.\n- **Beam Codes:** If the `Convert Beams with Code` field is left empty, the script may not update any beams depending on your project setup. Always verify the Beam Codes in your model match the text entered in the properties.\n- **Zone Selection:** You can select an entire Zone (if supported by your project structure), and the script will attempt to convert all applicable beams within that Zone.\n\n## FAQ\n- **Q: Why didn't my beams change size?**\n  **A:** Check the `Convert Beams with Code` property. Ensure the Beam Codes assigned to your beams in the model exactly match the text you entered (remember to separate them with `;`).\n- **Q: Which profile is applied to the beams?**\n  **A:** The script reads the cross-section from the first \"Center Joist\" found in the selected Element. Ensure this beam has the desired dimensions."
      },
      "tokens_used": 3284,
      "error": null
    }
  }
}