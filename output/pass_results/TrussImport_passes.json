{
  "filename": "TrussImport.mcr",
  "status": "completed",
  "total_tokens": 21897,
  "processing_time": 258.19596552848816,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2380,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses ModelMap and dbInterpretMap to generate entities. No sd_ prefix, _Viewport usage, or #Type E declarations found. The logic focuses on importing data via an external DLL and inserting it into the 3D model."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Utilities\\hsbCloudStorage\\hsbTrussIO.dll"
          ]
        }
      },
      "tokens_used": 2563,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "pTrussGroupName",
            "type": "PropString",
            "displayName": "Truss Group Name",
            "defaultValue": "Trusses\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "pBeamGroupName",
            "type": "PropString",
            "displayName": "Beam Group Name",
            "defaultValue": "Beams\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "pRoofPlaneGroupName",
            "type": "PropString",
            "displayName": "Roof Plane Group Name",
            "defaultValue": "RoofPlanes\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "pCeilingPlaneGroupName",
            "type": "PropString",
            "displayName": "Ceiling Plane Group Name",
            "defaultValue": "CeilingPlanes\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5092,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Imports engineered truss geometry and structural data from an external source into the hsbCAD model, automatically organizing components into specified project groups.",
          "category": "Framing/Import",
          "typicalUseCase": "Used after a structural engineer designs trusses in dedicated software (e.g., via hsbCloud) to import the 3D geometry, beams, and planes into the CAD model for detailing and manufacturing."
        },
        "parameters": [
          {
            "name": "pTrussGroupName",
            "technicalDefault": "\"Trusses\\Ground_Floor\"",
            "businessMeaning": "The destination folder path in the project catalog or model tree where the main Truss assemblies (collections of beams) will be placed.",
            "validRange": "Valid group path string (e.g., 'Structure\\Trusses\\Roof1')",
            "unit": "String",
            "affectsOutput": "Determines the organizational location of the truss assemblies in the project browser; does not affect physical geometry or dimensions."
          },
          {
            "name": "pBeamGroupName",
            "technicalDefault": "\"Beams\\Ground_Floor\"",
            "businessMeaning": "The destination folder path where the individual timber elements (top chords, bottom chords, webs) will be placed.",
            "validRange": "Valid group path string (e.g., 'Structure\\Members')",
            "unit": "String",
            "affectsOutput": "Determines where the physical timber parts appear in the project structure, facilitating filtering and material take-offs."
          },
          {
            "name": "pRoofPlaneGroupName",
            "technicalDefault": "\"RoofPlanes\\Ground_Floor\"",
            "businessMeaning": "The destination folder path for Roof Plane entities generated from the truss geometry, often used for sheathing or architectural reference.",
            "validRange": "Valid group path string",
            "unit": "String",
            "affectsOutput": "Controls the grouping of roof surface geometry; ensures planes are distinct from structural timber for drawing generation."
          },
          {
            "name": "pCeilingPlaneGroupName",
            "technicalDefault": "\"CeilingPlanes\\Ground_Floor\"",
            "businessMeaning": "The destination folder path for Ceiling Plane entities generated from the bottom chord geometry.",
            "validRange": "Valid group path string",
            "unit": "String",
            "affectsOutput": "Controls the grouping of ceiling surface geometry; useful for interior detailing or drywall layout."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Insertion of the script",
            "effect": "All parameters are passed as a configuration map to the external DLL. If a target group does not exist, the creation policy depends on the external DLL.",
            "cascade": [
              "pTrussGroupName",
              "pBeamGroupName",
              "pRoofPlaneGroupName",
              "pCeilingPlaneGroupName"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam/GenBeam",
            "description": "Structural timber elements representing chords and webs based on the imported design.",
            "appliedTo": "Imported Truss Geometry"
          },
          {
            "type": "Plane/Element",
            "description": "Surfaces representing the roof and ceiling boundaries derived from the truss geometry.",
            "appliedTo": "Imported Truss Geometry"
          },
          {
            "type": "Assembly",
            "description": "Logical groupings of beams to represent complete truss units.",
            "appliedTo": "Imported Truss Geometry"
          }
        ]
      },
      "tokens_used": 4519,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 3080,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# TrussImport.mcr\n\n## Overview\nImports engineered truss geometry and structural data from an external source into the hsbCAD model, automatically organizing the generated components (beams, planes, and assemblies) into specified project groups.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script generates 3D geometry and entities within the active model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities:** None (This script creates new entities).\n- **Minimum Beam Count:** 0.\n- **Required Settings:** \n  - The external DLL file `Utilities\\hsbCloudStorage\\hsbTrussIO.dll` must be present in your hsbCAD installation.\n  - Valid truss data must be available from the connected external engineering source (e.g., hsbCloud).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `TrussImport.mcr`\n\n### Step 2: Configure Grouping\nBefore the script processes the import, you can define where the elements will be placed in your project structure.\n```\nAction: Select the script instance in the model (if inserted at 0,0,0) or check Properties immediately after insertion.\nInput: Update the \"Group Name\" parameters in the Properties Palette to match your desired project folder structure (e.g., \"Structure\\Roof\\Level1\").\n```\n\n### Step 3: Execute Import\n```\nAction: Once properties are set, the script communicates with the external DLL to generate the trusses.\nNote: If the import does not start automatically, verify the connection to the external data source.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Truss Group Name | text | Trusses\\Ground_Floor | The destination folder path in the project browser where the main Truss assemblies will be placed. |\n| Beam Group Name | text | Beams\\Ground_Floor | The destination folder path where the individual timber elements (chords and webs) will be placed. |\n| Roof Plane Group Name | text | RoofPlanes\\Ground_Floor | The destination folder path for Roof Plane entities generated from the truss geometry. |\n| Ceiling Plane Group Name | text | CeilingPlanes\\Ground_Floor | The destination folder path for Ceiling Plane entities generated from the bottom chord geometry. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | No specific context menu options are defined for this script. Configuration is handled via the Properties Palette. |\n\n## Settings Files\n- **Filename**: `hsbTrussIO.dll`\n- **Location**: `Utilities\\hsbCloudStorage\\`\n- **Purpose**: This external library handles the logic to interpret structural data and generate the specific geometry, beams, and planes within the model.\n\n## Tips\n- **Project Organization:** Use backslashes `\\` when typing group paths to define subfolders (e.g., `ProjectName\\Level2\\Trusses`).\n- **Batch Imports:** If importing multiple floors or sections, change the \"Group Name\" properties (e.g., from \"Ground_Floor\" to \"First_Floor\") and insert the script again to keep your model tree organized.\n- **Troubleshooting:** If the script inserts but produces no geometry, check that the `hsbTrussIO.dll` is not blocked by firewall or antivirus software, as it needs to communicate with external data sources.\n\n## FAQ\n- **Q: Where do I select the specific truss file to import?**\n  - A: This script relies on a pre-configured connection or active session handled by the `hsbTrussIO.dll`. You typically select the job or data within the external engineering tool or cloud interface before running this script.\n- **Q: Can I modify the truss shape after importing?**\n  - A: Yes, once the beams and planes are generated in the model, they become standard hsbCAD entities that can be edited or detailed further.\n- **Q: What happens if I enter a Group Name that doesn't exist?**\n  - A: The script (or the underlying system) will typically attempt to create the group structure automatically based on the path provided."
      },
      "tokens_used": 4263,
      "error": null
    }
  }
}