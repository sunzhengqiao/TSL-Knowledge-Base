{
  "filename": "hsbPanelHeaderAboveOpening.mcr",
  "status": "completed",
  "total_tokens": 18295,
  "processing_time": 160.54282236099243,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2871,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script focuses on 3D geometry creation and manipulation (Element, Beam, Sip, BeamCut, CoordSys). It lacks ShopDrawing specific API calls like sd_* or #Type E and does not check for Viewports."
        },
        "prerequisites": {
          "requiredEntities": [
            "Opening",
            "Element",
            "Sip"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space within an hsbCAD project containing an Opening assigned to an Element that contains Sips.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1617,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getOpening",
              "promptOriginal": "|Select opening|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Insertion (_bOnInsert)",
            "title": null,
            "dataSource": "PropDouble properties defined in script",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dHeight",
            "type": "PropDouble",
            "displayName": "|Height|",
            "defaultValue": "100mm",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dWidth",
            "type": "PropDouble",
            "displayName": "|Width|",
            "defaultValue": "100mm",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dXL",
            "type": "PropDouble",
            "displayName": "|Extension| |Left|",
            "defaultValue": "100mm",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dXR",
            "type": "PropDouble",
            "displayName": "|Extension| |Right|",
            "defaultValue": "100mm",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "dOffsetZ",
            "type": "PropDouble",
            "displayName": "|Offset| Z",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3006,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a structural header beam above a selected wall opening and automatically cuts the surrounding Structural Insulated Panels (SIPs) to accommodate it.",
          "category": "Framing",
          "typicalUseCase": "Adding a lintel or header beam above a door or window in a timber frame structure with SIPs, ensuring the panels are notched out for the beam."
        },
        "parameters": [
          {
            "name": "dHeight",
            "technicalDefault": "100mm",
            "businessMeaning": "The vertical cross-sectional height (depth) of the header beam.",
            "validRange": "45mm to 300mm",
            "unit": "mm",
            "affectsOutput": "Determines the vertical size of the created beam and the height of the void cut into the SIPs."
          },
          {
            "name": "dWidth",
            "technicalDefault": "100mm",
            "businessMeaning": "The thickness (width) of the header beam, typically matching the wall thickness.",
            "validRange": "45mm to 300mm",
            "unit": "mm",
            "affectsOutput": "Determines the thickness of the created beam and the width of the void cut into the SIPs."
          },
          {
            "name": "dXL",
            "technicalDefault": "100mm",
            "businessMeaning": "The horizontal distance the header extends past the left side of the opening.",
            "validRange": "0mm to 600mm",
            "unit": "mm",
            "affectsOutput": "Extends the beam length to the left and extends the SIP cutout accordingly."
          },
          {
            "name": "dXR",
            "technicalDefault": "100mm",
            "businessMeaning": "The horizontal distance the header extends past the right side of the opening.",
            "validRange": "0mm to 600mm",
            "unit": "mm",
            "affectsOutput": "Extends the beam length to the right and extends the SIP cutout accordingly."
          },
          {
            "name": "dOffsetZ",
            "technicalDefault": "0",
            "businessMeaning": "Vertical displacement of the header relative to the top of the opening (positive = up, negative = down).",
            "validRange": "-200mm to 200mm",
            "unit": "mm",
            "affectsOutput": "Moves the beam vertically up or down, shifting the location of the SIP cutout."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in dXL or dXR",
            "effect": "Modifies the total length of the header beam and the span of the machining on the SIPs.",
            "cascade": [
              "Beam Length",
              "SIP Cutout Width"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "A rectangular timber header beam created centered above the opening with the specified extensions and dimensions.",
            "appliedTo": "The Element associated with the selected Opening."
          },
          {
            "type": "BeamCut",
            "description": "A void cut applied to any SIP within the element that intersects with the header beam.",
            "appliedTo": "All Sips belonging to the parent Element."
          }
        ]
      },
      "tokens_used": 3543,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 2909,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbPanelHeaderAboveOpening\n\n## Overview\nGenerates a structural header beam above a selected wall opening and automatically cuts the surrounding Structural Insulated Panels (SIPs) to accommodate the new beam.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Must be used within an hsbCAD project. |\n| Paper Space | No | Not applicable for layout generation. |\n| Shop Drawing | No | This is a 3D model generation script. |\n\n## Prerequisites\n- **Required Entities:** An existing Opening entity.\n- **Parent Element:** The Opening must be assigned to an Element.\n- **Components:** The Element must contain Structural Insulated Panels (SIPs). If the element only has beams, this script will not perform machining.\n- **Minimum Beam Count:** None required prior to running.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbPanelHeaderAboveOpening.mcr`\n\n### Step 2: Configure Dimensions\n*If a dynamic dialog appears upon insertion:*\n- Verify the default height, width, and extension values.\n- Adjust as necessary for your specific construction requirements.\n\n### Step 3: Select Opening\n```\nCommand Line: Select opening\nAction: Click on the desired opening (door or window) in your model.\n```\n**Result:** The script inserts a header beam and creates a void (cut) in any intersecting SIPs within the wall element.\n\n### Step 4: Adjustments (Optional)\n- Select the newly created script instance (or the opening it is associated with).\n- Open the **Properties Palette** (Ctrl+1).\n- Modify parameters (e.g., extend the header further left or right) and the model will update automatically.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Height | Number | 100mm | The vertical cross-sectional height (depth) of the header beam. |\n| Width | Number | 100mm | The thickness of the header beam (usually matches the wall thickness). |\n| Extension Left | Number | 100mm | How far the beam extends past the left side of the opening. |\n| Extension Right | Number | 100mm | How far the beam extends past the right side of the opening. |\n| Offset Z | Number | 0 | Vertical displacement. Positive values move the beam up; negative values move it down relative to the top of the opening. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom items to the right-click context menu. |\n\n## Settings Files\n- No external settings files are required for this script.\n\n## Tips\n- **Bearing Length:** Use the *Extension Left* and *Extension Right* properties to ensure the header has adequate bearing on the supporting wall studs.\n- **SIP Integration:** Ensure your Element definition actually includes SIP entities; otherwise, the automatic void cutting feature will not generate any machining.\n- **Offset Z:** If you need the header to sit *flush* with the top of the opening (e.g., for specific aesthetic or structural reasons), check your `Offset Z` value. A standard header usually sits directly on top.\n\n## FAQ\n\n- **Q: The beam was created, but the SIPs weren't cut. Why?**\n  A: Verify that the wall element actually contains SIP entities. If the element is defined strictly as a stud frame without panel objects, the script has nothing to cut.\n\n- **Q: Can I use this on multiple openings at once?**\n  A: No, this script requires you to select a single opening instance per insertion.\n\n- **Q: What units does this script use?**\n  A: The script respects your current hsbCAD project units, though the defaults are displayed in millimeters (mm)."
      },
      "tokens_used": 4349,
      "error": null
    }
  }
}