{
  "filename": "hsbCLT-EdgeSlot.mcr",
  "status": "completed",
  "total_tokens": 44535,
  "processing_time": 305.05888319015503,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "This tsl creates a slot on an edge of a panel",
        "versionHistory": [
          {
            "version": "1.2",
            "date": "02dec2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix jig preview"
          },
          {
            "version": "1.1",
            "date": "30nov2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "now compatible with V22"
          },
          {
            "version": "1.0",
            "date": "27nov2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7578,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses Sip sip = _Sip[0] and sip.addTool() to directly modify the geometry of a panel in the 3D model. No Paper Space specific keywords (_Viewport, #Type E) or SD functions (sd_*) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sip"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6466,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "Select panel and insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "Insertion",
            "title": null,
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dWidth",
            "type": "PropDouble",
            "displayName": "Width",
            "defaultValue": "8",
            "inputType": "number",
            "options": [],
            "category": "Geometry",
            "description": "Defines the Width"
          },
          {
            "index": 1,
            "variable": "dDepth",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "Geometry",
            "description": "Defines the Depth"
          },
          {
            "index": 2,
            "variable": "dLength",
            "type": "PropDouble",
            "displayName": "Length",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "Geometry",
            "description": "Defines the length of the slot. 0 = complete depth or full length of edge"
          },
          {
            "index": 0,
            "variable": "sAlignment",
            "type": "PropString",
            "displayName": "Alignment",
            "defaultValue": "Center",
            "inputType": "dropdown",
            "options": [
              "Left",
              "Center",
              "Right"
            ],
            "category": "Alignment",
            "description": "Defines the Alignment"
          },
          {
            "index": 3,
            "variable": "dAngle",
            "type": "PropDouble",
            "displayName": "Angle",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "Alignment",
            "description": "Defines the angle of the slot seen perpendicular to the edge, must be in range of -90 > Value < 90"
          },
          {
            "index": 4,
            "variable": "dRotation",
            "type": "PropDouble",
            "displayName": "Rotation",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "Alignment",
            "description": "Rotates the slot around the perpendicular axis relative to the edge.A rotation 90° creates a slot along the edge."
          },
          {
            "index": 5,
            "variable": "dAxisOffset",
            "type": "PropDouble",
            "displayName": "Axis Offset",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "Alignment",
            "description": "Defines the offset from the axis"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "TslDoubleClick",
            "handler": "sDoubleClick",
            "action": "Standard double-click action (implied by constant definition, specific logic not visible in snippet)",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 7254,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a parametric slot (groove or housing) on the edge of a CLT panel to accommodate connecting members or fittings.",
          "category": "Machining/CNC",
          "typicalUseCase": "Creating a seating groove for floor joists, beams, or splines on the edge of a timber panel."
        },
        "parameters": [
          {
            "name": "dWidth",
            "technicalDefault": "U(8)",
            "businessMeaning": "The width of the slot, typically matching the thickness of the material being inserted (e.g., a beam web or steel plate).",
            "validRange": "6 mm to 300 mm (depending on tooling)",
            "unit": "mm",
            "affectsOutput": "Adjusts the opening width of the slot geometry along the face tangent."
          },
          {
            "name": "dDepth",
            "technicalDefault": "U(100)",
            "businessMeaning": "How far the slot penetrates into the panel from the edge surface.",
            "validRange": "1 mm to Panel Thickness",
            "unit": "mm",
            "affectsOutput": "Determines how deep the cutter removes material perpendicular to the panel surface."
          },
          {
            "name": "dLength",
            "technicalDefault": "U(0)",
            "businessMeaning": "The linear length of the slot along the edge. A value of 0 calculates the maximum possible length based on panel geometry.",
            "validRange": "0 (Auto) to Panel Edge Length",
            "unit": "mm",
            "affectsOutput": "Sets the travel distance of the slot along the edge direction."
          },
          {
            "name": "sAlignment",
            "technicalDefault": "Center",
            "businessMeaning": "Positions the slot relative to the insertion point or axis.",
            "validRange": "Left, Center, Right",
            "unit": "enum",
            "affectsOutput": "Shifts the slot geometry so the insertion point represents the left, center, or right end of the slot length."
          },
          {
            "name": "dAngle",
            "technicalDefault": "0",
            "businessMeaning": "Applies a slant or bevel to the slot, allowing for angled connections (e.g., wedged connections).",
            "validRange": "-89° to 89°",
            "unit": "degrees",
            "affectsOutput": "Rotates the slot profile around its longitudinal axis."
          },
          {
            "name": "dRotation",
            "technicalDefault": "0",
            "businessMeaning": "The primary orientation of the slot relative to the panel edge normal. 0° is perpendicular (standard slot), 90° is parallel (dado/housing along the edge).",
            "validRange": "-180° to 180°",
            "unit": "degrees",
            "affectsOutput": "Rotates the direction of the cut on the edge surface."
          },
          {
            "name": "dAxisOffset",
            "technicalDefault": "0",
            "businessMeaning": "Moves the slot position along the edge axis from the clicked insertion point.",
            "validRange": "± Panel Width/Height",
            "unit": "mm",
            "affectsOutput": "Translates the slot centerline linearly along the edge."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Moving Grip Point _PtG0",
            "effect": "Updates the dDepth property.",
            "cascade": [
              "dDepth"
            ]
          },
          {
            "trigger": "Moving Grip Points _PtG1 or _PtG2",
            "effect": "Calculates distance to update dLength and centers the Insertion Point (_Pt0) between them.",
            "cascade": [
              "dLength",
              "_Pt0"
            ]
          },
          {
            "trigger": "Changing dRotation to 90° (Parallel)",
            "effect": "Disables the ability to drag the insertion point (_Pt0) if dLength is set to 0 (Auto).",
            "cascade": [
              "_Pt0 Grip State"
            ]
          },
          {
            "trigger": "Setting dAngle outside -90 to 90",
            "effect": "Resets dAngle to 0 and reports an error.",
            "cascade": [
              "dAngle"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Slot",
            "description": "A rectangular or prismatic void cut into the panel edge.",
            "appliedTo": "The selected Panel (Sip entity)"
          }
        ]
      },
      "tokens_used": 8587,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Launch via Command (TSLCONTENT)",
          "Load Catalog Entries (if _kExecuteKey is set) or Show Dialog",
          "Prompt User: 'Select panel and insertion point' (getPoint)",
          "Validate Panel Selection",
          "Calculate Local Coordinate System based on Insertion Point and Panel Geometry",
          "Validate Slot Parameters (Angle check)",
          "Detect Edge Geometry if rotation indicates Edge Slot",
          "Calculate Slot Length (Auto or Fixed)",
          "Generate and Add Slot Tool to Panel",
          "Create Visualization and Grip Points"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Trigger Mode",
            "path1": {
              "name": "Command Key / Catalog",
              "steps": [
                "Load properties from catalog matching _kExecuteKey",
                "Skip dialog",
                "Prompt for point"
              ]
            },
            "path2": {
              "name": "Standard Insert",
              "steps": [
                "Show standard properties dialog",
                "Prompt for point"
              ]
            }
          },
          {
            "condition": "Slot Length (dLength)",
            "path1": {
              "name": "Auto Length (dLength <= 0)",
              "steps": [
                "Determine maximum possible length based on edge geometry",
                "Disable dragging of Insertion Point (_Pt0) if Rotation is 90° (Parallel)",
                "Calculate start and end points of slot"
              ]
            },
            "path2": {
              "name": "Fixed Length (dLength > 0)",
              "steps": [
                "Use user-defined dLength",
                "Allow standard grip editing"
              ]
            }
          },
          {
            "condition": "Slot Orientation (dRotation)",
            "path1": {
              "name": "Perpendicular / Standard",
              "steps": [
                "Calculate standard normal vector",
                "Standard slot creation"
              ]
            },
            "path2": {
              "name": "Parallel / Edge Slot (Rotation ~90°)",
              "steps": [
                "Identify closest valid SipEdge",
                "Project tool location onto edge plane",
                "Create slot along edge direction"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Panel Reference",
            "errorMessage": "Invalid reference. Tool will be deleted",
            "recovery": "Script auto-deletes, user must re-insert on a valid panel."
          },
          {
            "check": "Angle Range (dAngle)",
            "errorMessage": "Angle must be between >-90° and < 90°",
            "recovery": "Angle is automatically reset to 0 by script."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Depth",
            "how": "Drag Grip Point _PtG0 or change Property dDepth in OPM",
            "effect": "Updates the penetration depth of the slot into the panel."
          },
          {
            "action": "Edit Length",
            "how": "Drag Grip Points _PtG1 and _PtG2",
            "effect": "Calculates new length based on distance between grips, centers the slot (_Pt0) between them, and updates dLength property."
          },
          {
            "action": "Move Slot",
            "how": "Drag Insertion Point _Pt0 (Disabled if dLength=0 and Rotation=90°)",
            "effect": "Repositions the slot along the edge/face based on new projection location."
          },
          {
            "action": "Edit Geometry",
            "how": "Change Properties (Width, Depth, Length, Rotation, Angle, Alignment) in OPM",
            "effect": "Regenerates the slot geometry immediately."
          },
          {
            "action": "Edit Catalog",
            "how": "Right-click Context Menu (TslDoubleClick)",
            "effect": "Opens the standard properties dialog to save/load configurations."
          }
        ]
      },
      "tokens_used": 8723,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-EdgeSlot\n\n## Overview\nThis script creates a parametric slot (groove or housing) on the edge of a CLT panel. It is designed to accommodate connecting members, fittings, or floor joists by machining a precise void into the panel geometry.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script modifies the 3D model geometry directly. |\n| Paper Space | No | Not intended for 2D drawings. |\n| Shop Drawing | No | Not an annotation script. |\n\n## Prerequisites\n- **Required Entities**: A CLT Panel (Sip entity) must exist in the model.\n- **Minimum Beam Count**: 0\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` (or `TSLCONTENT` if using a catalog)\nAction: Browse and select `hsbCLT-EdgeSlot.mcr`.\n\n### Step 2: Configure Properties\n**Dialog:** Properties Dialog\nAction: Define the initial dimensions of the slot (Width, Depth, Length) and click OK.\n*Note: If using a Catalog Entry, this dialog may be skipped or pre-filled.*\n\n### Step 3: Select Location\n```\nCommand Line: Select panel and insertion point\nAction: Click on the desired CLT Panel edge where the slot should be placed.\n```\nThe script will automatically project the slot onto the selected edge.\n\n### Step 4: Adjust Geometry (Optional)\nAction: Use the on-screen grip points to fine-tune the position or modify dimensions via the Properties palette.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | Number | 8 mm | The width of the slot opening (usually matches the thickness of the material being inserted). |\n| Depth | Number | 100 mm | How far the slot penetrates into the panel from the edge surface. |\n| Length | Number | 0 mm | The linear length of the slot along the edge. Set to **0** for automatic maximum length. |\n| Alignment | Dropdown | Center | Positions the slot relative to the insertion point. Options: Left, Center, Right. |\n| Angle | Number | 0° | Applies a slant or bevel to the slot perpendicular to the edge. Must be between -90° and 90°. |\n| Rotation | Number | 0° | Rotates the slot around the perpendicular axis. Use **90°** to create a slot parallel to the edge (dado/housing). |\n| Axis Offset | Number | 0 mm | Shifts the slot linearly along the edge axis from the clicked point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| TslDoubleClick | Opens the Properties dialog to allow you to load or save catalog configurations for the slot. |\n\n## Settings Files\n- **Filename**: None specified\n- **Location**: N/A\n- **Purpose**: This script operates using internal properties and standard catalogs.\n\n## Tips\n- **Full Length Slot:** Leave the **Length** property set to `0` to automatically calculate the longest possible slot for the selected edge.\n- **Edge Housing:** Set **Rotation** to `90°` to machine a slot parallel to the edge, rather than perpendicular.\n- **Interactive Editing:**\n    - Drag the **Depth Grip** (usually displayed perpendicular to the edge) to change penetration depth.\n    - Drag the **Length Grips** (displayed along the edge) to stretch the slot. The insertion point will automatically center between these grips.\n- **Angle Limits:** The script will automatically reset the **Angle** to `0` if you enter a value outside the valid range (-90° to 90°).\n\n## FAQ\n- **Q: I cannot move the slot along the edge after insertion. Why?**\n  **A:** This happens if **Rotation** is set to 90° and **Length** is set to 0 (Auto). In this mode, the slot calculates the full edge length automatically and fixes the position. To enable movement, set a specific **Length** or change the Rotation.\n- **Q: How do I create a wedge-shaped slot?**\n  **A:** Use the **Angle** property. A positive or negative value (e.g., 5°) will tilt the slot profile.\n- **Q: The script disappeared after I clicked.**\n  **A:** Ensure you clicked on a valid Sip (CLT) panel. The script deletes itself if the reference entity is invalid."
      },
      "tokens_used": 5927,
      "error": null
    }
  }
}