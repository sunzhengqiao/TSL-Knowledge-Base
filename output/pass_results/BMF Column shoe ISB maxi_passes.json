{
  "filename": "BMF Column shoe ISB maxi.mcr",
  "status": "completed",
  "total_tokens": 27465,
  "processing_time": 238.4515061378479,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "2006/Jan/26",
            "author": "Roberto Hallo, rh@hsb-cad.com",
            "changes": "initial version"
          },
          {
            "version": "1.1 (Modified)",
            "date": "2006/Jan/30",
            "author": "Roberto Hallo, TSL Team, Quito, Ecuador.",
            "changes": ""
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5788,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script operates on '_Beam0' (GenBeam) using 3D geometry construction (Body, PLine, Cut, Slot) and 'dxaout' which is typical for ModelSpace generation. No 'sd_' prefixes, 'Viewport' usage, or '#Type E' patterns associated with ShopDrawing/Multipage scripts found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "The script must be run on or interact with a GenBeam entity in Model Space. It uses coordinate system entities (_Pt0, _X0, _Y0, _Z0) implying it is either inserted on a beam or expects to be placed relative to a beam's local coordinate system.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2418,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dBaseHeigh",
            "type": "PropDouble",
            "displayName": "Base Height",
            "defaultValue": "0",
            "inputType": "number",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "strFixing",
            "type": "PropString",
            "displayName": "Type of Fixing",
            "defaultValue": "Dowels",
            "inputType": "dropdown",
            "options": [
              "Dowels",
              "Bolts"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "prStrType",
            "type": "PropString",
            "displayName": "Type",
            "defaultValue": "ISB-160",
            "inputType": "dropdown",
            "options": [
              "ISB-160",
              "ISB-260",
              "ISB-Maxi"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3251,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a 3D model and machining details for a specific BMF steel column shoe (ISB series) used to anchor timber columns to concrete foundations.",
          "category": "Hardware/Connection",
          "typicalUseCase": "When detailing a timber column that requires a steel shoe base connection (BMF ISB type) to be anchored to a concrete floor or foundation."
        },
        "parameters": [
          {
            "name": "dBaseHeigh",
            "technicalDefault": "0",
            "businessMeaning": "The vertical offset (Z-axis) of the column shoe from the bottom of the timber column or the reference insertion point. It effectively sets the gap between the timber column end and the steel shoe top plate.",
            "validRange": "0 to 500 mm",
            "unit": "mm",
            "affectsOutput": "Moves the entire steel shoe assembly down or up relative to the column's insertion point, adjusting the depth of the beam cut (slot) to accommodate the shoe height and offset."
          },
          {
            "name": "strFixing",
            "technicalDefault": "Dowels",
            "businessMeaning": "Specifies the method of anchoring the shoe to the foundation, determining the type of fasteners (chemical anchors/dowels or bolts) required.",
            "validRange": "Dowels, Bolts",
            "unit": "Selection",
            "affectsOutput": "Updates the Article Number and Designation string appended to the model (e.g., 'ISB-160-Dowels' vs 'ISB-160-Bolts'). Does not visibly change geometry in this specific script version."
          },
          {
            "name": "prStrType",
            "technicalDefault": "ISB-160",
            "businessMeaning": "Selects the specific model of the BMF ISB column shoe, which defines the physical dimensions (width, depth, plate thickness) and load-bearing capacity.",
            "validRange": "ISB-160, ISB-260, ISB-Maxi",
            "unit": "Selection",
            "affectsOutput": "Changes the dimensions of the steel parts (tube size, plate width/depth, thickness) and the size of the slot cut into the timber beam to match the selected shoe profile."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing prStrType",
            "effect": "Updates internal geometry arrays (arSa...arStd) and the resulting Article Number/Designation.",
            "cascade": [
              "dSa",
              "dSb",
              "dSc",
              "dSd",
              "dSf",
              "dSg",
              "dSh",
              "dSt1",
              "dSt2",
              "dStd",
              "strSm"
            ]
          },
          {
            "trigger": "Changing strFixing",
            "effect": "Updates the material designation suffix.",
            "cascade": [
              "strSm",
              "srtType"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MetalPart (Body)",
            "description": "Creates a 3D representation of the BMF column shoe consisting of a vertical tube, a bottom base plate, and a top connecting plate.",
            "appliedTo": "Model Space (visualized at the column base point)"
          },
          {
            "type": "Slot / Cut",
            "description": "Cuts a slot into the bottom of the timber column to receive the vertical web of the steel shoe. Also cuts the beam bottom to account for the base plate and offset height.",
            "appliedTo": "_Beam0 (The selected timber column)"
          },
          {
            "type": "Material / Properties",
            "description": "Assigns a material label ('BMF Material') and generates an Article Number (e.g., 'ISB-160') and Designation (e.g., 'BMF - 31960') for listing in BOMs.",
            "appliedTo": "Generated MetalPart"
          }
        ]
      },
      "tokens_used": 4284,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution launched.",
          "Initialize coordinate system visualization (_X0, _Y0, _Z0, _Pt0).",
          "Define and display user-editable Properties (dBaseHeigh, strFixing, prStrType).",
          "Evaluate 'prStrType' property to determine the index (iIndex: 0, 1, or 2).",
          "Extract geometric dimensions (dSa, dSb, etc.) from arrays based on the calculated index.",
          "Execute vertical Cut on _Beam0 at calculated offset to create space for the shoe.",
          "Generate 3D Body for the central steel Tube.",
          "Generate 3D Body for the bottom rectangular Plate.",
          "Generate 3D Body for the top rectangular Plate.",
          "Generate 3D Body for the main vertical Leg connecting top and bottom plates.",
          "Apply a Slot tool to _Beam0 to receive the vertical Leg of the shoe.",
          "Update Material and Article strings by appending the selected 'Type of Fixing'.",
          "Write Material ('BMF Material') and Designation to the model attributes."
        ],
        "conditionalBranches": [
          {
            "condition": "Value of property 'prStrType' (Shoe Model)",
            "path1": {
              "name": "ISB-160",
              "steps": [
                "Set index iIndex = 0",
                "Load dimensions: arSa[0]=100, arSf[0]=160, arStd[0]=42, etc.",
                "Set base article string to 'ISB-160'"
              ]
            },
            "path2": {
              "name": "ISB-260",
              "steps": [
                "Set index iIndex = 1",
                "Load dimensions: arSa[1]=100, arSf[1]=260, arStd[1]=42, etc.",
                "Set base article string to 'ISB-260'"
              ]
            },
            "path3": {
              "name": "ISB-Maxi",
              "steps": [
                "Set index iIndex = 2",
                "Load dimensions: arSa[2]=120, arSf[2]=200, arStd[2]=70, etc.",
                "Set base article string to 'ISB-Maxi'"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Assignment",
            "errorMessage": "Not explicitly handled in code; runtime error expected if _Beam0 is invalid.",
            "recovery": "Script must be run on a valid GenBeam entity in Model Space."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Adjust Base Height",
            "how": "OPM Property 'dBaseHeigh'",
            "effect": "Moves the steel shoe assembly vertically along the beam axis and updates the beam cut/slot depth accordingly."
          },
          {
            "action": "Change Shoe Type",
            "how": "OPM Property 'prStrType'",
            "effect": "Switches geometry to ISB-160, ISB-260, or ISB-Maxi dimensions and updates the base Article Number."
          },
          {
            "action": "Change Fixing Type",
            "how": "OPM Property 'strFixing'",
            "effect": "Updates the Article Number suffix and Material Designation (e.g., appending '-Dowels' or '-Bolts')."
          }
        ]
      },
      "tokens_used": 6578,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# BMF Column Shoe ISB Maxi\n\n## Overview\nThis script generates the 3D model and necessary machining details for a BMF steel column shoe (ISB series). It creates the steel connection hardware and automatically cuts a slot in the timber column to anchor it securely to a concrete foundation.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script creates 3D geometry and modifies the beam in the model. |\n| Paper Space | No | This script does not generate 2D views or drawings. |\n| Shop Drawing | No | Not intended for shop drawing generation. |\n\n## Prerequisites\n- **Required Entities**: A single timber column (GenBeam) must exist in the model.\n- **Minimum Beam Count**: 1 (The script must be applied to a beam).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT` or right-click on a beam in the model.\n**Action:** Select the script file `BMF Column shoe ISB maxi.mcr` from the file browser.\n\n### Step 2: Select Beam\n**Action:** Click on the timber column (GenBeam) where you wish to install the column shoe.\n*Note: The script typically attaches to the bottom of the column based on the beam's coordinate system.*\n\n### Step 3: Adjust Position and Parameters\n**Action:** Once inserted, select the generated connection or the beam. Press `Ctrl+1` to open the **Properties Palette**.\n**Action:** Modify the parameters (see below) to fit your specific connection requirements (e.g., shoe size, fixing type, height offset).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Type** (prStrType) | dropdown | ISB-160 | Select the model of the BMF column shoe. Options: ISB-160, ISB-260, ISB-Maxi. Changing this updates the physical dimensions of the shoe and the slot size in the wood. |\n| **Base Height** (dBaseHeigh) | number | 0 | Sets the vertical offset (Z-axis) of the shoe relative to the bottom of the timber column. Use this to adjust for grout gaps or concrete cover. |\n| **Type of Fixing** (strFixing) | dropdown | Dowels | Specifies the anchoring method for the shoe. Options: Dowels or Bolts. This updates the Article Number and labeling for ordering purposes. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom items to the right-click context menu. All adjustments are made via the Properties Palette. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: All configuration is handled via script properties.\n\n## Tips\n- **Grout Gaps**: Use the **Base Height** parameter to lower the steel shoe if you need to leave space for grout between the timber column and the concrete foundation.\n- **BOM Updates**: Changing the **Type of Fixing** (Dowels vs. Bolts) updates the Article Number in the Bill of Materials (BOM), ensuring you order the correct hardware package.\n- **Visualizing the Cut**: If the shoe does not appear to fit correctly, check your UCS or the beam's orientation. The script cuts a slot based on the beam's local coordinate system.\n\n## FAQ\n- **Q: Why is the shoe not appearing at the bottom of my column?**\n  **A:** Check the **Base Height** property. If it is set to a high value, the shoe may be pushed far down or up relative to the insertion point.\n- **Q: Does this script draw the anchor bolts into the concrete?**\n  **A:** No, this script models the steel shoe attached to the timber column and the necessary slot. Anchors into the concrete are typically handled as separate 2D details or specific concrete elements."
      },
      "tokens_used": 5146,
      "error": null
    }
  }
}