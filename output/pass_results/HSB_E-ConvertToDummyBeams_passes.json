{
  "filename": "HSB_E-ConvertToDummyBeams.mcr",
  "status": "completed",
  "total_tokens": 25818,
  "processing_time": 410.44821310043335,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "31.08.2016",
            "author": "AS",
            "changes": "First revision"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4791,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses _kModelSpace in TslInst.dbCreate. It processes Element and GenBeam objects from the construction model. No references to sd_*, Multipage*, or _Viewport found. No #Type E metadata found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing elements with beams.",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 1912,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select elements|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "PropertyDialog",
            "trigger": "On insert (via showDialog())",
            "title": null,
            "dataSource": "Script Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sequenceForGeneration",
            "type": "PropInt",
            "displayName": "|Sequence number|",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Generation|",
            "description": "|The sequence number is used to sort the list of tsls during the generation of the element.|"
          },
          {
            "index": 0,
            "variable": "beamCodesToConvert",
            "type": "PropString",
            "displayName": "|Beam codes to convert|",
            "defaultValue": "DUMMY*",
            "inputType": "text",
            "options": [],
            "category": "|Beam filter|",
            "description": "|Sets the beam codes of the beams to convert.|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4244,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically converts specific structural beams into 'dummy' beams (non-manufacturable parts) based on a filter of beam codes.",
          "category": "Model Management",
          "typicalUseCase": "Converting spacer blocks, theoretical alignment members, or temporary construction parts into non-physical elements that are ignored in production lists and CNC exports."
        },
        "parameters": [
          {
            "name": "beamCodesToConvert",
            "technicalDefault": "DUMMY*",
            "businessMeaning": "Defines the filter criteria (using wildcards) to select which beams should be converted to dummy beams based on their assigned Beam Code property.",
            "validRange": "Any string (standard wildcards * and ? are supported, e.g., 'SPACER*', 'TMP_*')",
            "unit": "Text",
            "affectsOutput": "Determines exactly which beams within the selected element are flagged as dummy. Only beams matching this code pattern will lose their manufacturable status."
          },
          {
            "name": "sequenceForGeneration",
            "technicalDefault": "0",
            "businessMeaning": "Controls the execution order priority of this script relative to other scripts during the 'Generate Construction' process.",
            "validRange": "0 to 1000 (Standard priority range)",
            "unit": "Integer",
            "affectsOutput": "If set too low, other scripts might process the beam (add cuts/hardware) before it is converted to dummy. If set appropriately high, it ensures the beam is treated as dummy before processing scripts run."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing beamCodesToConvert",
            "effect": "Alters the set of beams targeted by the HSB_G-FilterGenBeams utility.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Modified GenBeam",
            "description": "Beams have their internal 'Dummy' flag set to true (via setBIsDummy), removing them from manufacturing and BOM calculations while retaining their 3D position.",
            "appliedTo": "Beams within the selected Elements that match the beamCodesToConvert pattern."
          }
        ]
      },
      "tokens_used": 4039,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution begins (Insert or Generate Construction).",
          "2. [Check] Verify if insertCycleCount > 1 (Prevent recursive runs).",
          "3. [Check] Verify if an Execute Key (_kExecuteKey) is provided.",
          "4. [Action] If no Execute Key, display Property Dialog for user configuration (Beam codes, Sequence).",
          "5. [Action] Prompt user to select Elements via command line (PrEntity).",
          "6. [Loop] Iterate through all selected elements.",
          "7. [Action] Create a new TSL instance attached to each selected Element in ModelSpace (dbCreate).",
          "8. [Action] Pass 'ManualInserted' flag via Map to the new instances.",
          "9. [Action] Erase the original 'launcher' script instance.",
          "10. [Transition] Execution passes to the newly created child instances.",
          "11. [Check] Verify if the attached Element is valid (Length > 0).",
          "12. [Action] Retrieve all GenBeams from the Element.",
          "13. [Action] Call utility script HSB_G-FilterGenBeams using the beamCodesToConvert property.",
          "14. [Action] Iterate through the filtered list of beams returned by the utility.",
          "15. [Action] Set the BIsDummy property to TRUE for each filtered beam.",
          "16. [Action] Erase the child script instance."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert cycle status",
            "path1": {
              "name": "Recursive Cycle",
              "steps": [
                "Detect insertCycleCount > 1",
                "Erase instance immediately",
                "Return (Exit script)"
              ]
            },
            "path2": {
              "name": "First Run",
              "steps": [
                "Continue to property loading",
                "Check for Execute Key"
              ]
            }
          },
          {
            "condition": "Execute Key usage",
            "path1": {
              "name": "Automatic Execute",
              "steps": [
                "Detect valid _kExecuteKey",
                "Load properties from specific catalog",
                "Skip Property Dialog"
              ]
            },
            "path2": {
              "name": "Manual Insert",
              "steps": [
                "Execute Key is empty or invalid",
                "Execute showDialog()",
                "User enters Beam Codes and Sequence manually"
              ]
            }
          },
          {
            "condition": "Element Selection",
            "path1": {
              "name": "Selection Made",
              "steps": [
                "User selects elements and confirms",
                "Script processes selected elements",
                "Attaches instances to elements"
              ]
            },
            "path2": {
              "name": "Selection Cancelled",
              "steps": [
                "User cancels or provides no input",
                "Script falls through",
                "Instance is erased"
              ]
            }
          },
          {
            "condition": "Element Validity (Child Instance)",
            "path1": {
              "name": "Valid Element",
              "steps": [
                "_Element array has entries",
                "Proceed to beam filtering and conversion"
              ]
            },
            "path2": {
              "name": "Invalid Element",
              "steps": [
                "Detect _Element.length == 0",
                "Report 'invalid or no element selected'",
                "Erase instance"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent failure)",
            "recovery": "N/A - Script exits to prevent infinite loops during regeneration."
          },
          {
            "check": "Element Selection Result",
            "errorMessage": "None (Silent exit)",
            "recovery": "User must re-run the command and select elements."
          },
          {
            "check": "Child Instance Element Attachment",
            "errorMessage": "|invalid or no element selected.|",
            "recovery": "Ensure the script is attached to a valid Element or that the Element was not deleted after insertion."
          },
          {
            "check": "Beam Validity during processing",
            "errorMessage": "None (Skipped in loop)",
            "recovery": "Invalid beams found in the filter list are ignored automatically."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Script Properties",
            "how": "Not Applicable (Instance Self-Destructs)",
            "effect": "The script instance erases itself immediately after running. Changes cannot be made to the specific instance via OPM because it no longer exists in the drawing database."
          },
          {
            "action": "Undo or Re-run Conversion",
            "how": "Standard AutoCAD Undo or Re-run script with different 'Beam codes to convert'",
            "effect": "Re-running the script on the same element will re-filter beams based on the new codes. Beams already set to Dummy that no longer match the code will remain dummy unless manually reset, but logic is typically additive or requires a 'Reset' script not present here."
          }
        ]
      },
      "tokens_used": 5850,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-ConvertToDummyBeams.mcr\n\n## Overview\nThis script converts specific structural beams into \"dummy\" (non-manufacturable) parts based on their Beam Code property. It is typically used to mark spacer blocks, temporary members, or alignment parts so they are ignored in production lists and CNC exports.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on Elements and Beams within the 3D model. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Not intended for detailing views. |\n\n## Prerequisites\n- **Required Entities**: Elements containing GenBeams (beams).\n- **Minimum beam count**: 0.\n- **Required Settings**: The utility script `HSB_G-FilterGenBeams` must be available in the hsbCAD environment.\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command**: `TSLINSERT` â†’ Browse and select `HSB_E-ConvertToDummyBeams.mcr`\n\n### Step 2: Configure Properties\n```\nDialog Box: Script Properties\nAction:\n1. In the \"Beam codes to convert\" field, enter the filter criteria (e.g., \"DUMMY*\" or \"SPACER\").\n2. (Optional) Adjust the \"Sequence number\" if execution order matters relative to other scripts.\n3. Click OK to proceed.\n```\n\n### Step 3: Select Elements\n```\nCommand Line: Select elements\nAction:\n1. Click on the Elements in the model that contain the beams you wish to convert.\n2. Press Enter to confirm selection.\n```\n\n### Step 4: Execution\nThe script will automatically filter the beams within the selected elements, convert matching beams to dummy status, and then remove itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beam codes to convert | Text | DUMMY* | Determines which beams are converted. Use standard wildcards (e.g., * or ?) to match beam codes (e.g., \"TMP_*\"). |\n| Sequence number | Number | 0 | Defines the execution order during the generation process. Higher numbers run later. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| (None) | This script erases itself after execution and does not provide persistent right-click options. |\n\n## Settings Files\nThis script relies on the logic within the internal utility script **HSB_G-FilterGenBeams**. No separate XML settings file is required for configuration.\n\n## Tips\n- **Wildcards**: You can use `*` to represent any group of characters and `?` for a single character. For example, entering `*NO-CNC` will match any beam code ending with \"-NO-CNC\".\n- **Self-Deleting**: This script instance will disappear from your drawing immediately after it runs. This is normal behavior.\n- **Verification**: After running the script, you can check if a beam is a dummy by selecting it and looking at its properties in the AutoCAD Properties palette (check the manufacturing status or dummy flag).\n- **Undo**: If you make a mistake, you can use the standard AutoCAD `UNDO` command to revert the changes.\n\n## FAQ\n- **Q: Where did the script instance go after I ran it?**\n  - A: The script is designed to erase itself immediately after modifying the beams. The changes to the beams remain, but the script instance is removed to keep the drawing clean.\n- **Q: How do I make a beam \"real\" again after it has been converted to a dummy?**\n  - A: Re-running this script with a different filter will not automatically \"un-dummy\" beams. You must manually select the beam and change its status/Dummy property in the Properties palette, or use a script specifically designed to reset dummy status.\n- **Q: Can I use this on multiple elements at once?**\n  - A: Yes, you can window-select multiple elements during the \"Select elements\" prompt."
      },
      "tokens_used": 4982,
      "error": null
    }
  }
}