{
  "filename": "hsb_CreateSheetAroundOpening.mcr",
  "status": "completed",
  "total_tokens": 39000,
  "processing_time": 290.39800453186035,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.5",
            "date": "22.06.2023",
            "author": "Marsel Nakuci",
            "changes": "HSB-18953: swap name and material it was other way around"
          },
          {
            "version": "1.4",
            "date": "02.09.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-16394: add property to define whether sidegape will be applied at opening or not"
          },
          {
            "version": "1.3",
            "date": "24.06.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-15357: add properties to controll sides and top, bottom"
          },
          {
            "version": "1.1",
            "date": "20.09.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.2",
            "date": "21.09.2011",
            "author": "",
            "changes": "BugFix with the orientation of the sheet"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6089,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses PrEntity to prompt user selection of Element() objects. It casts these to ElementWallSF and iterates through them. It creates Sheet entities using dbCreate() and assigns them to element groups. No sd_* function calls, _Viewport references, or 2D generation logic are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF",
            "OpeningSF"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D Model)",
          "requiredSettings": []
        }
      },
      "tokens_used": 4554,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"\\nSelect a set of elements\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"psExtType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Wall Code\",\n      \"defaultValue\": \"A;B;\",\n      \"inputType\": \"text\",\n      \"options\": null,\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dThick\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Sheet Thickness\",\n      \"defaultValue\": \"9\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Sheet Name\",\n      \"defaultValue\": \"OSB\",\n      \"inputType\": \"text\",\n      \"options\":"
      },
      "tokens_used": 7811,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates structural sheathing or blocking sheets (e.g., OSB/plywood) around door and window openings in designated wall types.",
          "category": "Framing/Sheathing",
          "typicalUseCase": "Applying rigid sheathing patches around rough openings for structural racking resistance or as a substrate for finishes in timber frame walls."
        },
        "parameters": [
          {
            "name": "psExtType",
            "technicalDefault": "A;B;",
            "businessMeaning": "Filter determining which walls are processed based on their wall code (e.g., External vs. Internal).",
            "validRange": "Semicolon-separated list of project-specific codes (e.g., 'EXT;FW;')",
            "unit": "text",
            "affectsOutput": "Controls which ElementWallSF entities are selected for sheet generation."
          },
          {
            "name": "dThick",
            "technicalDefault": "9",
            "businessMeaning": "The thickness of the sheathing material to be inserted.",
            "validRange": "6 to 25 (Typical plywood/OSB thicknesses in mm)",
            "unit": "mm",
            "affectsOutput": "Determines the 3D thickness of the created Sheet entities and the size of the gap applied to the opening if enabled."
          },
          {
            "name": "sName",
            "technicalDefault": "OSB",
            "businessMeaning": "The label/identifier for the sheet entity in the model and reports.",
            "validRange": "Text (e.g., 'OSB', 'Plywood', 'Structural Panel')",
            "unit": "text",
            "affectsOutput": "Sets the 'Name' attribute of the generated Sheet entity."
          },
          {
            "name": "sMaterial",
            "technicalDefault": "OSB",
            "businessMeaning": "The physical material class defining properties like density, grade, and finish.",
            "validRange": "Catalog material names (e.g., 'C24', 'OSB3', 'PLYWOOD_18MM')",
            "unit": "text",
            "affectsOutput": "Sets the 'Material' attribute of the generated Sheet entity for BOM and weight calculations."
          },
          {
            "name": "nZones",
            "technicalDefault": "0",
            "businessMeaning": "Specifies the construction layer or zone to which the sheet is assigned.",
            "validRange": "0 to 10 (mapped to project zone IDs)",
            "unit": "index",
            "affectsOutput": "Assigns the Sheet entity to a specific ElementGroup/Zone for layer management."
          },
          {
            "name": "sTop",
            "technicalDefault": "No",
            "businessMeaning": "Toggle to generate sheathing on the top header of the opening.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "If 'Yes', creates a sheet above the opening."
          },
          {
            "name": "sBottom",
            "technicalDefault": "No",
            "businessMeaning": "Toggle to generate sheathing on the bottom sill/plate of the opening.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "If 'Yes', creates a sheet below the opening."
          },
          {
            "name": "sSides",
            "technicalDefault": "No",
            "businessMeaning": "Toggle to generate sheathing on the vertical jambs of the opening.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "If 'Yes', creates sheets on the left and right sides of the opening."
          },
          {
            "name": "sGapSide",
            "technicalDefault": "Yes",
            "businessMeaning": "Controls whether the script modifies the opening geometry (Gap properties) to accommodate the sheet thickness.",
            "validRange": "Yes/No",
            "unit": "boolean",
            "affectsOutput": "If 'Yes', applies `setDGapSide/Top/Bottom` to the opening, effectively pushing surrounding studs or trimming the opening to fit the sheet."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sGapSide is set to 'Yes'",
            "effect": "Activates the gap application logic on the Opening object, using 'dThick' as the gap value.",
            "cascade": [
              "dThick",
              "sTop",
              "sBottom",
              "sSides"
            ]
          },
          {
            "trigger": "dThick",
            "effect": "Updates the geometry size of the sheet and the value of the gap applied if 'sGapSide' is active.",
            "cascade": [
              "sGapSide"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet",
            "description": "Rectangular planar elements representing sheathing material (e.g., OSB) wrapped around the perimeter of the opening.",
            "appliedTo": "ElementWallSF (assigned to specific zones/groups)"
          }
        ]
      },
      "tokens_used": 6719,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 8823,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_CreateSheetAroundOpening.mcr\n\n## Overview\nThis script automatically generates structural sheathing or blocking sheets (e.g., OSB or plywood) around door and window openings in designated wall types. It allows precise control over placement (top, bottom, sides) and material properties.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D wall elements. |\n| Paper Space | No | Not applicable for 2D drawing generation. |\n| Shop Drawing | No | Does not generate views or dimensions. |\n\n## Prerequisites\n- **Required Entities**: Walls (ElementWallSF) containing Openings (OpeningSF).\n- **Minimum Beam Count**: Not applicable (Script selects whole elements).\n- **Required Settings**: None (Uses internal properties).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_CreateSheetAroundOpening.mcr`\n\n### Step 2: Select Wall Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the wall elements (or use a window selection) that contain the openings you wish to sheet. Press Enter to confirm.\n```\n\n### Step 3: Configure Properties\nAfter selection, the script attaches to the elements. Select an element and open the **Properties Palette** (Ctrl+1) to adjust settings like thickness, placement sides, and material.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Wall Code (`psExtType`) | Text | A;B; | Determines which walls are processed based on their wall code. Separate multiple codes with semicolons (e.g., \"EXT;INT;\"). |\n| Sheet Thickness (`dThick`) | Number | 9 | Thickness of the sheathing material to be created (in project units, typically mm). |\n| Sheet Name (`sName`) | Text | OSB | The identifier/name of the sheet entity for reporting and lists. |\n| Material (`sMaterial`) | Text | OSB | The physical material grade applied to the sheet (must exist in your catalog). |\n| Zones (`nZones`) | Integer | 0 | The construction layer or zone index to which the sheet is assigned. |\n| Top (`sTop`) | Yes/No | No | If set to \"Yes\", generates a sheet above the opening. |\n| Bottom (`sBottom`) | Yes/No | No | If set to \"Yes\", generates a sheet below the opening. |\n| Sides (`sSides`) | Yes/No | No | If set to \"Yes\", generates sheets on the left and right jambs of the opening. |\n| Gap Side (`sGapSide`) | Yes/No | Yes | If set to \"Yes\", applies a gap to the opening geometry equal to the sheet thickness to prevent clashes. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the sheet geometry based on current property values or changes in the wall geometry. |\n| Delete | Removes the script and all generated sheets from the selected elements. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies entirely on the Properties Palette for configuration and does not require external XML settings files.\n\n## Tips\n- **Visibility**: By default, `sTop`, `sBottom`, and `sSides` are set to \"No\". You must change at least one of these to \"Yes\" to see generated sheets.\n- **Wall Filtering**: Ensure the `Wall Code` property matches the wall codes defined in your project (e.g., \"EXT\") or the script will skip those walls.\n- **Gap Handling**: Use `sGapSide` = \"Yes\" if you want the script to automatically adjust the opening size (Gap properties) to accommodate the thickness of the new sheet. This prevents the sheet from overlapping the opening geometry incorrectly.\n\n## FAQ\n- **Q: I ran the script but nothing appeared.**\n  **A:** Check the Properties Palette. By default, the Top, Bottom, and Sides options are set to \"No\". Change the relevant side(s) to \"Yes\" and recalculate.\n  \n- **Q: Can I apply this to multiple walls at once?**\n  **A:** Yes, during the insertion prompt, you can select multiple wall elements using a window selection.\n\n- **Q: What unit is the thickness in?**\n  **A:** The unit follows your current project settings (typically millimeters for timber construction)."
      },
      "tokens_used": 5004,
      "error": null
    }
  }
}