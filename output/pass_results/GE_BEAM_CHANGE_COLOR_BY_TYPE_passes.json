{
  "filename": "GE_BEAM_CHANGE_COLOR_BY_TYPE.mcr",
  "status": "completed",
  "total_tokens": 43184,
  "processing_time": 277.92055439949036,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.1",
            "date": "29-ago-2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Strings added to translation"
          },
          {
            "version": "v1.0",
            "date": "16-mar-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4902,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Beam() objects and iterates through _Beam[]. It uses bm.setColor() to modify beam properties directly. No sd_ prefixes, _Viewport usage, or #Type E definitions found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing Beams with specific types (e.g., Stud, Top Plate, Header).",
          "requiredSettings": []
        }
      },
      "tokens_used": 4492,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"\\\\n|Select beam (s)|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDialogOnce\",\n      \"trigger\": \"On Insert (if _kExecuteKey is empty)\",\n      \"title\": \"Properties\",\n      \"dataSource\": \"OPM Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sTopPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Top Plate|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sSFTopPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|SF Top Plate|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSFVeryTopPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|SF Very Top Plate|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sSFBottomPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|SF Bottom Plate|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sSFAngledTopPlateRight\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Angled Top Plate Right|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sSFAngledTopPlateLeft\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Angled Top Plate Left|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sStud\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Stud|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Default brown| (32)\",\n        \"|Light brown| (40)\",\n        \"|White|\",\n        \"|Red|\",\n        \"|Yellow|\",\n        \"|Green|\",\n        \"|Cyan|\",\n        \"|Blue|\",\n        \"|Magenta|\"\n      ],\n      \"category\": \"0\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sKingStud\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|King Stud|\",\n      \"defaultValue\": \"|Default brown| (32)\",\n      \"input"
      },
      "tokens_used": 7640,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Batch assigns specific visual colors to timber beams based on their functional type (e.g., Studs, Plates, Headers) to distinguish structural elements in the model.\",\n    \"category\": \"Visualization/Management\",\n    \"typicalUseCase\": \"A user selects a group of wall elements or beams and runs this script to automatically color-code studs, top plates, and headers differently, making it easier to verify wall composition or generate colored drawings.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sTopPlate\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for horizontal Top Plate beams.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI (AutoCAD Color Index)\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Top Plate.\"\n    },\n    {\n      \"name\": \"sSFTopPlate\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for specific Shop Floor/System (SF) Top Plate variants.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as an SF Top Plate.\"\n    },\n    {\n      \"name\": \"sSFVeryTopPlate\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for the uppermost Top Plate layer in double or triple plate configurations.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Very Top Plate.\"\n    },\n    {\n      \"name\": \"sSFBottomPlate\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for horizontal Bottom Plate (Sole Plate) beams.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Bottom Plate.\"\n    },\n    {\n      \"name\": \"sSFAngledTopPlateRight\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for angled top plates (e.g., gable ends) on the right side.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as an Angled Top Plate (Right).\"\n    },\n    {\n      \"name\": \"sSFAngledTopPlateLeft\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for angled top plates (e.g., gable ends) on the left side.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as an Angled Top Plate (Left).\"\n    },\n    {\n      \"name\": \"sStud\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for standard vertical wall Studs.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a standard Stud.\"\n    },\n    {\n      \"name\": \"sKingStud\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for King Studs (full-height studs framing openings).\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a King Stud.\"\n    },\n    {\n      \"name\": \"sLeftStud\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for left-side specific studs (often end studs).\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Left Stud.\"\n    },\n    {\n      \"name\": \"sRightStud\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for right-side specific studs (often end studs).\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Right Stud.\"\n    },\n    {\n      \"name\": \"sSupportingBeam\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for beams that support other loads (e.g., rim beams or lintels).\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Supporting Beam.\"\n    },\n    {\n      \"name\": \"sJackOverOpening\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for Jack Studs (Trimmers) located above an opening.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Jack Over Opening.\"\n    },\n    {\n      \"name\": \"sJackUnderOpening\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for Jack Studs (Trimmers) located below an opening.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Jack Under Opening.\"\n    },\n    {\n      \"name\": \"sRightShim\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for packing/shim pieces on the right.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Right Shim.\"\n    },\n    {\n      \"name\": \"sLeftShim\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for packing/shim pieces on the left.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Left Shim.\"\n    },\n    {\n      \"name\": \"sTopShim\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for packing/shim pieces on the top.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Top Shim.\"\n    },\n    {\n      \"name\": \"sBottomShim\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for packing/shim pieces on the bottom.\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Bottom Shim.\"\n    },\n    {\n      \"name\": \"sSill\",\n      \"technicalDefault\": \"|Default brown| (32)\",\n      \"businessMeaning\": \"Controls the display color for Sill plates (bottom plates or window sills).\",\n      \"validRange\": \"Dropdown list (ACI 0, 1-6, 32, 40)\",\n      \"unit\": \"ACI\",\n      \"affectsOutput\": \"Modifies the color property of any beam identified as a Sill.\"\n    },\n   "
      },
      "tokens_used": 8677,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution initiated via command.",
          "2. Script checks insertCycleCount; if > 1, it erases itself immediately to prevent recursion.",
          "3. If _kExecuteKey is empty (standard run), the Properties Palette (OPM) is displayed.",
          "4. User configures desired colors for specific beam types (e.g., Studs, Plates) in the OPM.",
          "5. Command line prompt 'Select beam(s)' is displayed.",
          "6. User selects one or more beams in the model.",
          "7. Selection is stored in the internal _Beam array.",
          "8. Script triggers a recalculation event.",
          "9. Script validates that beams were selected; if not, it erases itself.",
          "10. Script iterates through each selected beam.",
          "11. For each beam, the script reads the beam's functional type (e.g., _kStud, _kTopPlate).",
          "12. Script maps the beam type to the user-selected color property.",
          "13. Script applies the new color to the beam using bm.setColor().",
          "14. Script erases its own instance from the drawing (Cleanup)."
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count",
            "path1": {
              "name": "Standard Insert (Cycle 1)",
              "steps": [
                "Proceed to show Properties Palette.",
                "Prompt for beam selection."
              ]
            },
            "path2": {
              "name": "Recursive/Update Cycle (> 1)",
              "steps": [
                "Erase script instance immediately.",
                "Exit script."
              ]
            }
          },
          {
            "condition": "Selection Validation",
            "path1": {
              "name": "Valid Selection",
              "steps": [
                "Process beams.",
                "Apply colors."
              ]
            },
            "path2": {
              "name": "Empty/Invalid Selection",
              "steps": [
                "Erase script instance.",
                "Exit without changes."
              ]
            }
          },
          {
            "condition": "Beam Type Matching",
            "path1": {
              "name": "Type Match Found",
              "steps": [
                "Identify specific type constant (e.g., _kStud).",
                "Retrieve corresponding color integer.",
                "Apply color to beam."
              ]
            },
            "path2": {
              "name": "No Type Match",
              "steps": [
                "Skip color application for this specific condition check.",
                "Continue to next type check."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent exit)",
            "recovery": "Script automatically prevents multiple execution cycles."
          },
          {
            "check": "Beam Selection Existence",
            "errorMessage": "None (Silent exit)",
            "recovery": "If the user cancels the selection or selects nothing, the script removes itself from the drawing."
          },
          {
            "check": "Beam Object Validity",
            "errorMessage": "None",
            "recovery": "Script checks bm.bIsValid() inside the loop; if a beam is invalid, it is skipped, and the loop continues to the next beam."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Script Self-Deletion",
            "how": "Automatic (eraseInstance)",
            "effect": "The script instance is removed from the drawing immediately after processing. The beams retain their new colors, but there is no script entity left to edit or grip-edit afterwards."
          },
          {
            "action": "Re-running the script",
            "how": "Command Line",
            "effect": "User can run the command again on the same beams to change colors, as the previous script instance is gone."
          }
        ]
      },
      "tokens_used": 9390,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_CHANGE_COLOR_BY_TYPE.mcr\n\n## Overview\nThis script batch-assigns specific visual colors to timber beams based on their functional type (e.g., Studs, Top Plates, King Studs). It is used to color-code structural elements to improve model verification and drawing clarity.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Select existing beams directly from the model. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Does not generate shop drawings. |\n\n## Prerequisites\n- **Required Entities:** Timber Beams (GenBeam).\n- **Minimum Beam Count:** 1 (selected during execution).\n- **Required Settings:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Navigate to the folder containing `GE_BEAM_CHANGE_COLOR_BY_TYPE.mcr`.\n3. Select the file and click **Open**.\n\n### Step 2: Configure Colors\n1. The **Properties Palette** (OPM) will open automatically upon insertion.\n2. Locate the various beam type parameters (e.g., Top Plate, Stud, King Stud).\n3. Click the dropdown menu next to a parameter to select the desired color (e.g., Red, Yellow, Light Brown).\n\n### Step 3: Select Beams\n```\nCommand Line: Select beam(s)\nAction: Click on the beams in the model you wish to update. You can select multiple beams at once.\n```\n1. After selecting the beams, press **Enter** or right-click to confirm.\n\n### Step 4: Completion\nThe script will automatically detect the type of each selected beam, apply the configured color, and then delete itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Top Plate | Dropdown | Default brown (32) | Sets the color for horizontal Top Plate beams. |\n| SF Top Plate | Dropdown | Default brown (32) | Sets the color for specific System Floor (SF) Top Plate variants. |\n| SF Very Top Plate | Dropdown | Default brown (32) | Sets the color for the uppermost layer in double/triple plate configurations. |\n| SF Bottom Plate | Dropdown | Default brown (32) | Sets the color for horizontal Bottom Plate (Sole Plate) beams. |\n| Angled Top Plate Right | Dropdown | Default brown (32) | Sets the color for angled top plates (right side). |\n| Angled Top Plate Left | Dropdown | Default brown (32) | Sets the color for angled top plates (left side). |\n| Stud | Dropdown | Default brown (32) | Sets the color for standard vertical wall studs. |\n| King Stud | Dropdown | Default brown (32) | Sets the color for King Studs (full-height studs framing openings). |\n| Left Stud | Dropdown | Default brown (32) | Sets the color for left-side specific studs (end studs). |\n| Right Stud | Dropdown | Default brown (32) | Sets the color for right-side specific studs (end studs). |\n| Supporting Beam | Dropdown | Default brown (32) | Sets the color for structural supporting beams (rim beams/lintels). |\n| Jack Over Opening | Dropdown | Default brown (32) | Sets the color for Jack Studs (Trimmers) located above an opening. |\n| Jack Under Opening | Dropdown | Default brown (32) | Sets the color for Jack Studs (Trimmers) located below an opening. |\n| Right Shim | Dropdown | Default brown (32) | Sets the color for packing/shim pieces on the right. |\n| Left Shim | Dropdown | Default brown (32) | Sets the color for packing/shim pieces on the left. |\n| Top Shim | Dropdown | Default brown (32) | Sets the color for packing/shim pieces on the top. |\n| Bottom Shim | Dropdown | Default brown (32) | Sets the color for packing/shim pieces on the bottom. |\n| Sill | Dropdown | Default brown (32) | Sets the color for Sill plates (bottom plates or window sills). |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | The script instance deletes itself immediately after execution. There are no editable context menus available after running. |\n\n## Settings Files\n- **Filename:** None used.\n- **Location:** N/A\n- **Purpose:** N/A\n\n## Tips\n- **Batch Processing:** You can select a large number of beams (e.g., an entire wall) at once. The script will filter them by type and apply the correct color to each one automatically.\n- **Re-running:** Since the script deletes itself after use, simply run `TSLINSERT` again if you need to change colors for a different set of beams or adjust the color scheme.\n- **Undo:** If you make a mistake, use the standard AutoCAD `UNDO` command to revert the color changes.\n\n## FAQ\n- **Q: I cannot find the script in the model after running it. Is that normal?**\n  - A: Yes. This is a \"command script\" designed to perform an action and then clean up after itself. The beams keep their new colors, but the script instance is removed to keep the drawing clean.\n- **Q: Why didn't my beam change color?**\n  - A: Ensure the beam type in the hsbCAD properties matches one of the categories in the Properties Panel (e.g., \"Stud\" vs \"King Stud\"). If the type is generic or not listed, the script will not modify it."
      },
      "tokens_used": 8083,
      "error": null
    }
  }
}