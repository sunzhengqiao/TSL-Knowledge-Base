{
  "filename": "Simpson StrongTie - ITB Backer Free Connector.mcr",
  "status": "completed",
  "total_tokens": 36110,
  "processing_time": 328.4151999950409,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6648,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates 3D geometry using Body and PLine classes, applies cuts to beams using _Beam0.addTool(), and interacts directly with GenBeam entities (_Beam0, _Beam1) without sd_ prefixes, _Viewport usage, or _Entity arrays."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space with two beams that are perpendicular and have aligned bottom faces.",
          "requiredSettings": []
        }
      },
      "tokens_used": 5061,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select male beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getBeam",
              "promptOriginal": "Select female beam",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "prdMaleTlorenace",
            "type": "PropDouble",
            "displayName": "Male Tolerance",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "If beam is smallest that expected by manufacturer, a measure of tolerance can be added"
          },
          {
            "index": 1,
            "variable": "prdFemaleTlorenace",
            "type": "PropDouble",
            "displayName": "Female Tolerance",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "If beam is smallest that expected by manufacturer, a measure of tolerance can be added"
          },
          {
            "index": 0,
            "variable": "prstrModel",
            "type": "PropString",
            "displayName": "Model",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5072,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates geometry and machining for a Simpson Strong-Tie ITB Backer-Free timber connector, a heavy-duty top-flange hanger used to connect joists perpendicular to carrying members without requiring a backing block.",
          "category": "Hardware",
          "typicalUseCase": "Used when framing floor or roof systems where a joist (male beam) meets a rim beam or header (female beam) and a backer block cannot be used, requiring the connector to resist loads via flanges and legs."
        },
        "parameters": [
          {
            "name": "prdMaleTlorenace",
            "technicalDefault": 0,
            "businessMeaning": "Allows the user to specify a negative manufacturing tolerance for the male beam (joist) width. This ensures a proper fit if the timber is slightly smaller than the nominal size expected by the connector.",
            "validRange": "0mm to 5mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the lower bound check when selecting the appropriate connector width class (e.g., treating a 44mm beam as acceptable for a 45mm nominal hanger)."
          },
          {
            "name": "prdFemaleTlorenace",
            "technicalDefault": 0,
            "businessMeaning": "Allows the user to specify a negative manufacturing tolerance for the female beam (header) height. This ensures the selected hanger height fits if the supporting timber is slightly undersized.",
            "validRange": "0mm to 10mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the lower bound check when selecting the specific hanger height model (e.g., allows a 290mm tall beam to fit a 302mm tall hanger)."
          },
          {
            "name": "prstrModel",
            "technicalDefault": "",
            "businessMeaning": "The specific Simpson Strong-Tie catalog number (e.g., ITB200/40) automatically selected based on the calculated beam dimensions. This defines the exact geometry of the metal part and the hardware list.",
            "validRange": "N/A (Calculated from beam sizes)",
            "unit": "String",
            "affectsOutput": "Drives the geometry generation (height, width, plate thickness) and sets the material name/model number output for production reports."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "prdMaleTlorenace or prdFemaleTlorenace",
            "effect": "Modifies the lookup logic for beam dimensions against the hardcoded hanger arrays, potentially changing which 'flag' index is selected.",
            "cascade": [
              "prstrModel"
            ]
          },
          {
            "trigger": "Input Beams (Width/Height)",
            "effect": "Determines the 'flag' (width category) and 'flag2' (height category) indices.",
            "cascade": [
              "dHw",
              "dHh",
              "prstrModel"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MetalPart",
            "description": "A 3D solid body representing the ITB hanger, including a bottom plate, side flanges, legs, and top flange.",
            "appliedTo": "N/A (New Element)"
          },
          {
            "type": "Cut",
            "description": "A vertical saw cut applied to the male beam to ensure the top-flange hanger sits flush against the side of the beam.",
            "appliedTo": "_Beam0 (Male Joist)"
          },
          {
            "type": "Hardware",
            "description": "Nail definition (Simpson 3.75 x 30mm) associated with the hanger for BOM generation.",
            "appliedTo": "Hanger Instance"
          }
        ]
      },
      "tokens_used": 5926,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script / Insert Instance",
          "2. Prompt: Select male beam (Joist)",
          "3. Prompt: Select female beam (Header/Carrier)",
          "4. Execute: Verify beams are perpendicular",
          "5. Execute: Verify beam bottom faces are coplanar",
          "6. Execute: Determine Male Beam Width Category (apply tolerance)",
          "7. [Conditional Branch] Select Width Group & Populate Height Arrays",
          "8. Execute: Determine Female Beam Height Match (apply tolerance)",
          "9. Execute: Cut Male Beam (vertical saw cut at intersection)",
          "10. Execute: Generate 3D Hanger Geometry (Plates, Flanges, Legs)",
          "11. Execute: Assign Model Number, Material, and Hardware"
        ],
        "conditionalBranches": [
          {
            "condition": "Male Beam Width (dMw) matches specific array index",
            "path1": {
              "name": "Width Index 0 (38mm)",
              "steps": [
                "Set Hanger Width (dHw) to 40mm",
                "Populate model list with ITB heights for 38mm series"
              ]
            },
            "path2": {
              "name": "Width Index 1 (45mm)",
              "steps": [
                "Set Hanger Width (dHw) to 45mm",
                "Populate model list with ITB heights for 45mm series"
              ]
            },
            "path3": {
              "name": "Width Index 2-4 (58-60mm)",
              "steps": [
                "Set Hanger Width (dHw) to 60mm",
                "Populate model list with ITB heights for 60mm series"
              ]
            },
            "path4": {
              "name": "Width Index 5 (72mm)",
              "steps": [
                "Set Hanger Width (dHw) to 75mm",
                "Populate model list with ITB heights for 72mm series"
              ]
            },
            "path5": {
              "name": "Width Index 6 (2ply 38mm)",
              "steps": [
                "Set Hanger Width (dHw) to 78mm",
                "Populate model list with ITB heights for 2x38mm series"
              ]
            },
            "path6": {
              "name": "Width Index 7-8 (2ply 45mm)",
              "steps": [
                "Set Hanger Width (dHw) to 90mm",
                "Populate model list with ITB heights for 2x45mm series"
              ]
            },
            "path7": {
              "name": "Width Index 9 (97mm)",
              "steps": [
                "Set Hanger Width (dHw) to 100mm",
                "Populate model list with ITB heights for 97mm series"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Perpendicularity of beams (X-axis of male vs Z-axis of female)",
            "errorMessage": "Beams must be perpendicular",
            "recovery": "Rotate one of the beams to be 90 degrees perpendicular to the other."
          },
          {
            "check": "Bottom face coplanarity (Z-axis alignment and vertical offset)",
            "errorMessage": "Beams bottom faces are not coplanaries",
            "recovery": "Vertically align the male and female beams so their bottom faces are on the same level."
          },
          {
            "check": "Male beam width fits valid hanger sizes (including Male Tolerance)",
            "errorMessage": "Male beam doesnt fit in hanger",
            "recovery": "Select a different male beam with a width within the supported range (38mm to 97mm) or increase the Male Tolerance property."
          },
          {
            "check": "Female beam height fits valid hanger heights (including Female Tolerance)",
            "errorMessage": "Female beam doesn't fit in hanger",
            "recovery": "Select a different female beam with a height within the supported range (145mm to 302mm) or increase the Female Tolerance property."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Adjust Tolerances",
            "how": "OPM Properties Palette",
            "effect": "Modifying 'Male Tolerance' or 'Female Tolerance' triggers a recalculation. If the new value allows a different category fit, the script automatically updates the 'Model' selection (prstrModel) and regenerates the 3D geometry to match the new dimensions."
          },
          {
            "action": "Move/Rotate Beams",
            "how": "Grip Edit / AutoCAD Commands",
            "effect": "Moving the beams updates the intersection point (_Pt0) and orientation vectors. The script redraws the hanger at the new location. If the move breaks alignment or perpendicularity, the instance is erased."
          }
        ]
      },
      "tokens_used": 7960,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Simpson StrongTie - ITB Backer Free Connector\n\n## Overview\nThis script generates the 3D geometry and machining for Simpson Strong-Tie ITB Backer-Free timber connectors. It is designed to connect a joist perpendicular to a carrying member (header/rim beam) without requiring a backing block.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script creates 3D solids and applies beam cuts. |\n| Paper Space | No | This script does not create 2D annotations. |\n| Shop Drawing | No | This is a connection generation script for the 3D model. |\n\n## Prerequisites\n- **Two Beams**: You must have two `GenBeam` entities (beams).\n- **Geometry**: The beams must be perpendicular (90° angle) to each other.\n- **Alignment**: The bottom faces of both beams must be on the same level (coplanar).\n- **Dimensions**: Beam dimensions must fall within the supported ITB range (Width: 38mm–97mm; Height: approx. 145mm–302mm).\n\n## Usage Steps\n\n### Step 1: Launch Script\nExecute the command `TSLINSERT` (or use the hsbCAD insert menu) and select `Simpson StrongTie - ITB Backer Free Connector.mcr`.\n\n### Step 2: Select Male Beam\n```\nCommand Line: Select male beam\nAction: Click on the joist (the beam being supported) that will sit inside the hanger.\n```\n\n### Step 3: Select Female Beam\n```\nCommand Line: Select female beam\nAction: Click on the header or rim beam (the supporting beam) that the hanger will attach to.\n```\n\n*Note: Once the second beam is selected, the script automatically calculates the correct Simpson Strong-Tie model based on the beam dimensions and generates the connector.*\n\n## Properties Panel Parameters\n\nAfter inserting the connector, you can modify these parameters via the AutoCAD Properties Palette (Ctrl+1).\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Model | Dropdown (Calculated) | *Auto-detected* | The specific Simpson Strong-Tie catalog number (e.g., ITB200/40). This is determined automatically based on beam sizes. |\n| Male Tolerance | Number | 0 | Allows adjustment if the male beam (joist) width is undersized. Increases the acceptable range for the joist width. |\n| Female Tolerance | Number | 0 | Allows adjustment if the female beam (header) height is undersized. Increases the acceptable range for the header height. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom items to the right-click context menu. Use the Properties Palette to adjust parameters. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external XML settings files. All connector data is embedded within the script.\n\n## Tips\n- **Alignment**: Ensure the joist and header are perfectly perpendicular before running the script. If they are slightly off, the script will fail with an error message.\n- **Undersized Timber**: If your timber is machined slightly smaller than nominal size and the script reports \"Male beam doesn't fit,\" try increasing the **Male Tolerance** property to force a fit.\n- **Visual Check**: After insertion, verify that the hanger flanges sit flush against the side of the joist and the bottom plate is correctly seated.\n\n## FAQ\n\n- **Q: The script says \"Beams must be perpendicular.\" What do I do?**\n  A: Use the `Rotate` or `Align` command in AutoCAD to ensure the male beam is exactly 90 degrees relative to the female beam.\n\n- **Q: The script says \"Beams bottom faces are not coplanaries.\"**\n  A: Move the beams vertically so that their bottom faces are exactly level with each other. The ITB connector requires the bottom of the joist to be level with the bottom of the header.\n\n- **Q: It says \"Female beam doesn't fit in hanger.\"**\n  A: The height of your header beam is likely too tall for the available ITB sizes. Check the Simpson Strong-Tie catalog for maximum heights, or verify you selected the correct beam. If the timber is just slightly undersized, use the **Female Tolerance** property."
      },
      "tokens_used": 5443,
      "error": null
    }
  }
}