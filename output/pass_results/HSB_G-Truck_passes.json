{
  "filename": "HSB_G-Truck.mcr",
  "status": "completed",
  "total_tokens": 22132,
  "processing_time": 444.2837643623352,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 4953,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getPoint() for insertion location and constructs a Body using world coordinate vectors (_Pt0, _XW, _YW, _ZW). No sd_ prefixes, _Viewport usage, or #Type E directives found."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 1929,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "_bOnInsert && (!_kExecuteKey || catalogNames.find(_kExecuteKey) == -1)",
            "title": "Properties",
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "truckLength",
            "type": "PropDouble",
            "displayName": "|Length|",
            "defaultValue": "U(21000)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "truckWidth",
            "type": "PropDouble",
            "displayName": "|Width|",
            "defaultValue": "U(2200)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "truckHeight",
            "type": "PropDouble",
            "displayName": "|Height|",
            "defaultValue": "U(3000)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4477,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Creates a 3D bounding box representing a truck's cargo space, used to visualize and verify if timber packages or stacks fit within transport dimensions.\",\n    \"category\": \"Logistics\",\n    \"typicalUseCase\": \"Placing the truck placeholder in the production yard layout or 3D model to arrange prefabricated timber stacks (pallets) and ensure they do not exceed the truck's physical loading capacity.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"truckLength\",\n      \"technicalDefault\": \"U(21000)\",\n      \"businessMeaning\":The usable cargo length of the truck trailer available for loading timber stacks.\",\n      \"validRange\": \"6,000 - 24,000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Extends or shortens the 3D visualization box along the X-axis (local length).\"\n    },\n    {\n      \"name\": \"truckWidth\",\n      \"technicalDefault\": \"U(2200)\",\n      \"businessMeaning\": \"The internal width of the truck trailer available for loading.\",\n      \"validRange\": \"2,000 - 2,600 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Widens or narrows the 3D visualization box along the Y-axis (local width).\"\n    },\n    {\n      \"name\": \"truckHeight\",\n      \"technicalDefault\": \"U(3000)\",\n      \"businessMeaning\": \"The maximum vertical stacking height allowed on the truck bed, respecting legal road limits or physical bridge clearances.\",\n      \"validRange\": \"2,500 - 4,000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Increases or decreases the height of the 3D visualization box along the Z-axis (local height).\"\n    }\n  ],\n  \"parameterDependencies\": [],\n  \"outputEntities\": [\n    {\n      \"type\": \"Body\",\n      \"description\": \"A rectangular 3D solid representing the volume of the truck bed.\",\n      \"appliedTo\": \"Model Space (Inserted at user-selected point)\"\n    }\n  ]\n}\n```"
      },
      "tokens_used": 3218,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Start",
          "Properties Initialization (Length, Width, Height)",
          "Check for Execute Key",
          "Check Insertion Status (_bOnInsert)",
          "[Insert Branch] Prompt user for Position (getPoint)",
          "[Insert Branch] Return/Exit Script",
          "[Recalc Branch] Check for Debug or Property Change",
          "[Recalc Branch] Retrieve or Create 'Truck' Body from Map",
          "[Recalc Branch] Update Body Dimensions based on Properties",
          "Draw/Display 3D Visualization"
        ],
        "conditionalBranches": [
          {
            "condition": "Is Insertion Mode? (_bOnInsert)",
            "path1": {
              "name": "Insertion Flow",
              "steps": [
                "Check Execute Key validity",
                "If No Valid Key: Show Properties Dialog",
                "Prompt User for Insertion Point (_Pt0)",
                "Return (Stop)"
              ]
            },
            "path2": {
              "name": "Recalculation Flow",
              "steps": [
                "Check Debug or Property Change trigger",
                "Initialize/Update Entity Map",
                "Check Map for existing 'Truck' Body",
                "Retrieve existing or Create new Body",
                "Apply dimensions (Length, Width, Height)",
                "Render Display"
              ]
            }
          },
          {
            "condition": "Valid Execute Key provided on Insertion?",
            "path1": {
              "name": "Catalog/Key Insertion",
              "steps": [
                "Load preset values from Catalog",
                "Suppress Properties Dialog",
                "Prompt for Insertion Point"
              ]
            },
            "path2": {
              "name": "Manual Insertion",
              "steps": [
                "Show Properties Dialog for user input",
                "Prompt for Insertion Point"
              ]
            }
          },
          {
            "condition": "Does Entity Map contain 'Truck' Body?",
            "path1": {
              "name": "Update Existing",
              "steps": [
                "Retrieve Body reference",
                "Update geometry parameters"
              ]
            },
            "path2": {
              "name": "Create New",
              "steps": [
                "Instantiate new Body object",
                "Add to Entity Map"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Execute Key Catalog Existence",
            "errorMessage": "(None explicitly defined in code, likely defaults to manual input)",
            "recovery": "User proceeds with manual dialog or input"
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Truck Dimensions",
            "how": "OPM Properties Palette (Length, Width, Height)",
            "effect": "Updates the 3D Body geometry immediately upon property change."
          },
          {
            "action": "Move Truck Location",
            "how": "CAD Grips / Move Command",
            "effect": "Relocates the insertion point (_Pt0) and the entire Body."
          }
        ]
      },
      "tokens_used": 3273,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-Truck.mcr\n\n## Overview\nThis script creates a 3D bounding box representing a truck's cargo space. It is used to visualize and verify if timber packages or stacks fit within transport dimensions.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script is inserted directly into the 3D model. |\n| Paper Space | No | Not intended for 2D layout sheets. |\n| Shop Drawing | No | Not intended for manufacturing views. |\n\n## Prerequisites\n- **Required entities:** None.\n- **Minimum beam count:** 0.\n- **Required settings files:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse and select `HSB_G-Truck.mcr`.\n\n### Step 2: Configure Dimensions\nIf you are not using a pre-configured catalog entry, a dialog or property prompt will appear:\n1. Review the default dimensions (Length: 21000mm, Width: 2200mm, Height: 3000mm).\n2. Adjust the values if your truck has different loading specifications.\n\n### Step 3: Place Truck\n```\nCommand Line: |Select a position|\nAction: Click in the Model Space to set the insertion point (usually the rear-left corner or center of the truck bed).\n```\n*Note: The script will generate the 3D volume immediately after clicking.*\n\n### Step 4: Adjust Dimensions (Post-Insertion)\n1. Select the inserted Truck object in the drawing.\n2. Open the **Properties Palette** (Ctrl+1).\n3. Modify the **Length**, **Width**, or **Height** values.\n4. The 3D box will automatically update to reflect the new dimensions.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Length | Number | 21000 mm | The usable cargo length of the truck trailer. |\n| Width | Number | 2200 mm | The internal width of the truck trailer. |\n| Height | Number | 3000 mm | The maximum vertical stacking height allowed (respecting road limits). |\n\n## Right-Click Menu Options\nNo specific custom options are added to the right-click menu. Standard AutoCAD/hsbCAD options (Move, Rotate, Copy, Erase) apply.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Yard Layout:** Use this script when planning production yard layouts to ensure stacks of timber do not exceed the size of the transport trucks.\n- **Visual Check:** Use the 3D visual to simulate how pallets will be loaded.\n- **Unit Independence:** The script automatically handles unit conversions; ensure your working units in CAD are set correctly (usually Millimeters for timber construction).\n\n## FAQ\n- **Q: Can I change the truck size after I have placed it?**\n  A: Yes. Select the object and change the dimensions in the Properties Palette.\n- **Q: Does this script generate manufacturing data?**\n  A: No, this is purely a visual aid (Body entity) for layout planning and checking.\n- **Q: The box is too small/big for my truck.**\n  A: Modify the `Length`, `Width`, and `Height` properties in the Properties Palette to match your specific truck model."
      },
      "tokens_used": 4282,
      "error": null
    }
  }
}