{
  "filename": "hsbCLT-JointBoardNG.mcr",
  "status": "completed",
  "total_tokens": 53026,
  "processing_time": 916.7063267230988,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": \"\",\n    \"numBeamsReq\": 0,\n    \"keywords\": [],\n    \"majorVersion\": 0,\n    \"minorVersion\": 0,\n    \"dxaOut\": 0,\n    \"implInsert\": 0\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"0.20\",\n      \"date\": \"10.01.2022\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-14081 bugfix group assignment\"\n    },\n    {\n      \"version\": \"0.19\",\n      \"date\": \"14.12.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 auto grouping (see settings) supported\"\n    },\n    {\n      \"version\": \"0.18\",\n      \"date\": \"14.12.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 bugfix when inserting with <Enter>, beamcuts consider angled edges\"\n    },\n    {\n      \"version\": \"0.17\",\n      \"date\": \"08.12.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-14094 solid representation enhanced\"\n    },\n    {\n      \"version\": \"0.16\",\n      \"date\": \"15.11.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 bugfix non perpendicular joint boards\"\n    },\n    {\n      \"version\": \"0.15\",\n      \"date\": \"15.11.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 beam creation and symbol added\"\n    },\n    {\n      \"version\": \"0.14\",\n      \"date\": \"12.11.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 default orientation set for certain views\"\n    },\n    {\n      \"version\": \"0.13\",\n      \"date\": \"12.11.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-13615 new property to choose between gap and relief gap, distinction between stretching and rejoining during drag\"\n    },\n    {\n      \"version\": \"0.12\",\n      \"date\": \"11.11.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-136"
      },
      "tokens_used": 9359,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit usage of `_kModelSpace` in `tslDialog.dbCreate`. Operates on 3D entities (`Body`, `PlaneProfile`, `GenBeam`, `Sip`) and uses 3D coordinate systems (`CoordSys`). No `sd_` prefixes, `_Viewport` checks, or `#Type E` patterns found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sip"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "XML Settings file (optional)",
            "MapObject 'hsbTSLDebugController' (optional, for debug mode)"
          ]
        }
      },
      "tokens_used": 8078,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 10702,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a connecting spline or joint board to fill gaps or join two CLT/SIP panels, with options to create physical timber beams or graphical representations.",
          "category": "Connection/Framing",
          "typicalUseCase": "Used when two prefabricated timber panels need to be connected by a timber spline (e.g., for stability, closing a gap, or creating a butt-joint connection). The user selects the panels, defines the board size, and the script inserts the board."
        },
        "parameters": [
          {
            "name": "Width",
            "technicalDefault": "inferred from map or default 100",
            "businessMeaning": "The thickness (width) of the timber board/spline used to connect the panels.",
            "validRange": "40 - 300 mm",
            "unit": "mm",
            "affectsOutput": "Changes the cross-sectional thickness of the generated joint board. Determines how deep the board sits into or between the panels."
          },
          {
            "name": "Height",
            "technicalDefault": "inferred from map or default 200",
            "businessMeaning": "The vertical height (depth) of the timber board/spline.",
            "validRange": "40 - 300 mm",
            "unit": "mm",
            "affectsOutput": "Changes the vertical dimension of the generated joint board."
          },
          {
            "name": "GapWidth",
            "technicalDefault": "inferred from map or default 0",
            "businessMeaning": "The horizontal clearance or tolerance gap between the joint board and the panel edges.",
            "validRange": "0 - 20 mm",
            "unit": "mm",
            "affectsOutput": "Reduces the effective width of the board or creates a relief space around the board within the opening."
          },
          {
            "name": "GapHeight",
            "technicalDefault": "inferred from map or default 0",
            "businessMeaning": "The vertical clearance or tolerance gap between the joint board and the panel edges.",
            "validRange": "0 - 20 mm",
            "unit": "mm",
            "affectsOutput": "Reduces the effective height of the board or creates a relief space above/below the board."
          },
          {
            "name": "Face (Alignment)",
            "technicalDefault": "0",
            "businessMeaning": "Determines the positioning of the board relative to the panel surface (e.g., Center, Positive side, Negative side).",
            "validRange": "Integer indices (0, 1, -1, etc.)",
            "unit": "count",
            "affectsOutput": "Offsets the board geometry along the panel's normal vector (Z-axis)."
          },
          {
            "name": "ConvertToBeam",
            "technicalDefault": "No",
            "businessMeaning": "Toggle to generate a physical 'GenBeam' entity (for CNC/BOM) instead of a graphical 'Body' representation.",
            "validRange": "Yes/No",
            "unit": "bool",
            "affectsOutput": "If Yes, creates a constructible timber element in the model. If No, creates a purely visual representation."
          },
          {
            "name": "AutoGroup",
            "technicalDefault": "hsbDefault",
            "businessMeaning": "The name of the construction group to which the generated joint board will be assigned.",
            "validRange": "Any valid group name string",
            "unit": "string",
            "affectsOutput": "Organization of the element in the CAD tree and reports."
          },
          {
            "name": "TextHeight",
            "technicalDefault": "2.5",
            "businessMeaning": "The height of dimension text or annotations generated by the script.",
            "validRange": "1.0 - 10.0 mm (drawing units)",
            "unit": "mm",
            "affectsOutput": "Visual size of labels/dimensions."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing 'ConvertToBeam' to Yes",
            "effect": "The script generates a GenBeam entity instead of a Body, enabling it for machining and lists.",
            "cascade": [
              "AutoGroup"
            ]
          },
          {
            "trigger": "Changing 'Face'",
            "effect": "Updates the 'Alignment' property in the UI, effectively repositioning the board relative to the panel normal.",
            "cascade": [
              "Width",
              "Height"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "A parametric timber beam representing the joint board/spline, created if 'ConvertToBeam' is enabled.",
            "appliedTo": "The gap/intersection area between the selected Sip/CLT panels."
          },
          {
            "type": "Body",
            "description": "A static graphical representation of the joint board, created if 'ConvertToBeam' is disabled.",
            "appliedTo": "The gap/intersection area between the selected Sip/CLT panels."
          }
        ]
      },
      "tokens_used": 9656,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization: Load constants, debug flags, and properties from Map or Defaults.",
          "2. Insert Mode Start: Prompt user to select CLT/SIP panels (Sip entities).",
          "3. Selection Validation: Verify selected entities are valid Sip panels. If valid, add to internal array `_Sip`.",
          "4. Preview Generation (Jigs): Calculate potential joint board geometry (Join mode vs. Split mode).",
          "5. Interactive Preview: Display graphical preview (Body) tracking mouse movement to visualize board placement.",
          "6. User Placement: User clicks or presses Enter to confirm location.",
          "7. Entity Creation: Generate either a `GenBeam` or `Body` based on the 'ConvertToBeam' property.",
          "8. Data Persistence: Store geometry (points, vectors, profiles) and properties in the `_Map`.",
          "9. Post-Insertion Idle: Wait for property changes or context menu triggers."
        ],
        "conditionalBranches": [
          {
            "condition": "Entity Mode (ConvertToBeam)",
            "path1": {
              "name": "Create GenBeam",
              "steps": [
                "Calculate cross-section and path.",
                "Instantiate `GenBeam` object.",
                "Apply material and group assignment."
              ]
            },
            "path2": {
              "name": "Create Body",
              "steps": [
                "Calculate profile and extrusion vector.",
                "Instantiate `Body` object.",
                "Apply display color and transparency."
              ]
            }
          },
          {
            "condition": "Selection Geometry (Join vs Split)",
            "path1": {
              "name": "Join Panel",
              "steps": [
                "Calculate intersection of multiple panels.",
                "Define board along the common edge.",
                "Fit board within the intersection profile."
              ]
            },
            "path2": {
              "name": "Split Panel",
              "steps": [
                "Calculate single panel geometry.",
                "Define board along a split line (user defined).",
                "Fit board within the single panel profile."
              ]
            }
          },
          {
            "condition": "Settings Map Existence",
            "path1": {
              "name": "Import Available",
              "steps": [
                "Detect 'hsbCLT-JointBoardNG.xml' in path.",
                "Enable 'Import Settings' context menu.",
                "Load values on trigger."
              ]
            },
            "path2": {
              "name": "No Import",
              "steps": [
                "Use hard-coded or script default values.",
                "Hide 'Import Settings' option."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Panel Selection Count",
            "errorMessage": "Implicitly handled; requires at least 1 panel to generate geometry.",
            "recovery": "User must select valid Sip entities when prompted."
          },
          {
            "check": "Export File Overwrite",
            "errorMessage": "Prompt: 'Are you sure to overwrite existing settings?'",
            "recovery": "User selects 'No' to cancel or 'Yes' to overwrite."
          },
          {
            "check": "Geometry Intersection",
            "errorMessage": "Board geometry fails to generate (empty profile) if panels are too far apart or geometry is invalid.",
            "recovery": "User adjusts panel positions or Gap settings."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Flip Side",
            "how": "Context Menu (Right-click) or Double Click",
            "effect": "Toggles the `Face` property (Center/Positive/Negative), repositioning the board relative to the panel surface."
          },
          {
            "action": "Join + Erase",
            "how": "Context Menu",
            "effect": "Joins all selected `_Sip` panels into one database entity and deletes the TSL instance."
          },
          {
            "action": "Erase",
            "how": "Context Menu",
            "effect": "Deletes all generated beams/bodies created by this instance and removes the TSL."
          },
          {
            "action": "Settings",
            "how": "Context Menu -> Settings",
            "effect": "Opens a dialog to change Beam Mode (Body vs Beam), Group Name, Dimensions, and Display properties."
          },
          {
            "action": "Import/Export Settings",
            "how": "Context Menu",
            "effect": "Loads current configuration to/from an XML file in the hsbCAD path."
          }
        ]
      },
      "tokens_used": 9242,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-JointBoardNG.mcr\n\n## Overview\nThis script generates a connecting spline or joint board to bridge gaps or join two CLT/SIP panels. It allows you to create either a physical timber beam for manufacturing (CNC/BOM) or a graphical representation for visualization.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in 3D Model Space. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not designed for 2D detailing views. |\n\n## Prerequisites\n- **Required Entities**: At least one CLT or SIP panel (`Sip` entity).\n- **Minimum Beam Count**: 0 (Operates on panels/elements).\n- **Required Settings**: None strictly required, though an XML settings file can be used for preset configurations.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCLT-JointBoardNG.mcr` from the list.\n\n### Step 2: Select Panels\n```\nCommand Line: Select Sip entities:\nAction: Click on the CLT or SIP panels you wish to connect or fill a gap between. Press Enter to confirm selection.\n```\n\n### Step 3: Position and Preview\n```\nCommand Line: Specify location or [Press Enter to accept]:\nAction: Move your mouse to adjust the board's position relative to the panels. A graphical preview will appear. Click to place the board, or press Enter to accept the default calculated position.\n```\n\n### Step 4: Configuration (Optional)\nAfter insertion, select the generated joint board and modify dimensions or settings in the Properties Palette (Ctrl+1).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | Number | 100 mm | The thickness of the timber joint board. |\n| Height | Number | 200 mm | The vertical height (depth) of the joint board. |\n| GapWidth | Number | 0 mm | Horizontal clearance (tolerance) between the board and panel edges. |\n| GapHeight | Number | 0 mm | Vertical clearance (tolerance) between the board and panel edges. |\n| Face | Dropdown | 0 | Aligns the board relative to the panel surface (e.g., Center, Positive side, Negative side). |\n| ConvertToBeam | Yes/No | No | If **Yes**, creates a physical GenBeam for production. If **No**, creates a graphical Body only. |\n| AutoGroup | String | hsbDefault | The construction group name assigned to the generated element. |\n| TextHeight | Number | 2.5 mm | The height of annotation text or dimensions (if visible). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Flip Side** | Toggles the board alignment (Center/Positive/Negative) relative to the panel surface. |\n| **Join + Erase** | Joins the selected panels into a single database entity and removes this script instance. |\n| **Erase** | Deletes the generated joint board and removes the script instance from the drawing. |\n| **Settings** | Opens a dialog to quickly adjust dimensions, beam mode, and display properties. |\n| **Import Settings** | Loads configuration parameters from an external XML file. |\n| **Export Settings** | Saves the current configuration parameters to an external XML file. |\n\n## Settings Files\n- **Filename**: `hsbCLT-JointBoardNG.xml`\n- **Location**: hsbCAD Company or Install path.\n- **Purpose**: Stores default values for dimensions, material assignments, and visual settings so they can be shared between projects or users.\n\n## Tips\n- **Visual vs. Real**: If you need the joint board to appear in your Cut Lists or CNC files, ensure **ConvertToBeam** is set to **Yes**.\n- **Tolerances**: Use the **GapWidth** and **GapHeight** parameters if you need assembly clearance between the spline and the panels.\n- **Quick Adjustment**: If the board is inserted on the wrong side of the wall, simply right-click the element and select **Flip Side**.\n- **Grouping**: Use the **AutoGroup** property to ensure the board is organized correctly in your CAD tree and reports.\n\n## FAQ\n- **Q: Why does the board disappear when I change views?**\n  - **A:** Ensure **ConvertToBeam** is set to **Yes** if you want a permanent constructible element. If set to **No**, it creates a \"Body\" which depends on specific display settings.\n- **Q: Can I use this script for standard timber beams?**\n  - **A:** No, this script is specifically designed for CLT and SIP panels (`Sip` entities). It will not function correctly on standard beams.\n- **Q: How do I save my preferred board size for future use?**\n  - **A:** Configure the parameters in the Properties Palette, then right-click the element and choose **Export Settings** to save them to an XML file. You can import these settings for future instances."
      },
      "tokens_used": 5989,
      "error": null
    }
  }
}