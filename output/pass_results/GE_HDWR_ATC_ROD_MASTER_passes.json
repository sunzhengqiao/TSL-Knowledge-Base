{
  "filename": "GE_HDWR_ATC_ROD_MASTER.mcr",
  "status": "completed",
  "total_tokens": 33573,
  "processing_time": 964.6231808662415,
  "passes": {
    "1": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getElement() to select a Wall and accesses 3D wall properties (ptOrg, vecX, ptStartOutline). It inserts sub-instances using tsl.dbCreate(). It contains no Paper Space indicators such as #Type, _Viewport, or sd_ prefixes."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "TSL script 'GE_HDWR_ATC_ROD_ANCHORS' must be available in the TSL search path"
          ]
        }
      },
      "tokens_used": 5428,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "\nSelect a Wall",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getInt",
              "promptOriginal": "\nSpecify Engineering Type\n1=1/2 ATC 2=1/2 ATC+ANCHOR 3=CUP 4= 3/8 ATC 5=None[1/2/3/4/5] <3>",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strType",
            "type": "PropString",
            "displayName": "Scenario",
            "defaultValue": "1/2\" ATC Engineering",
            "inputType": "dropdown",
            "options": [
              "1/2\" ATC Engineering",
              "1/2\" ATC & Anchor Engineering",
              "CUP Engineering",
              "3/8\" ATC Engineering",
              "None"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dSpacing",
            "type": "PropDouble",
            "displayName": "Spacing",
            "defaultValue": "U(48)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": " Re-distribute",
            "handler": "_kExecuteKey == \" Re-distribute\"",
            "action": "Recalculates and redistributes the ATC rods and anchors along the wall.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": " Remove Existing",
            "handler": "_kExecuteKey == \" Remove Existing\"",
            "action": "Removes all ATC rods and anchors attached to the wall.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 7080,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically distributes and inserts Continuous Rod Tie-Down (ATC) hardware and screw anchors along the bottom plate of a selected wall based on specific engineering scenarios.",
          "category": "Hardware / Engineering Automation",
          "typicalUseCase": "Applying hold-down connectors (like Simpson ATC or similar) to ground floor walls or shear walls to resist uplift forces, ensuring spacing meets engineering requirements."
        },
        "parameters": [
          {
            "name": "strType",
            "technicalDefault": "\"1/2\\\" ATC Engineering\"",
            "businessMeaning": "Defines the specific engineering hardware configuration to apply. Determines whether the wall gets 1/2\" rods, 3/8\" rods, screw anchors, or a combination thereof. 'None' removes hardware (often auto-applied to upper floors).",
            "validRange": "Enumerated List: 1/2\" ATC, 1/2\" ATC & Anchor, CUP Engineering, 3/8\" ATC, None",
            "unit": "N/A",
            "affectsOutput": "Switches the Map properties sent to the sub-script, resulting in different metal parts (Rods vs. Anchors) being generated."
          },
          {
            "name": "dSpacing",
            "technicalDefault": "U(48)",
            "businessMeaning": "The maximum on-center spacing between the primary hold-down rods along the wall.",
            "validRange": "12 to 120 (inches), typically 24, 48, or 96 depending on load calculations.",
            "unit": "Inches",
            "affectsOutput": "Calculates the quantity and insertion points of the rods. In scenarios with anchors (Type 2), anchors are placed at half this spacing (offset) between rods."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Wall Elevation Height > ~5 feet (59 inches)",
            "effect": "Automatically sets strType to 'None' to prevent engineering hardware on upper floors.",
            "cascade": [
              "strType"
            ]
          },
          {
            "trigger": "Map Data 'TYPE' attached to Wall",
            "effect": "Overrides the user selection for strType if a valid integer (1-4) is found in the element's hsbData map.",
            "cascade": [
              "strType"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "TSL Instance (Sub-script)",
            "description": "Inserts instances of the script 'GE_HDWR_ATC_ROD_ANCHORS' at calculated intervals along the wall bottom plate.",
            "appliedTo": "The selected Wall Element (ElementWallSF)"
          },
          {
            "type": "Hardware / MetalPart",
            "description": "The sub-script generates physical hardware representations (1/2\" Rod, 3/8\" Rod, or 3/8\" x 6\" Screw Anchor) depending on the selected Scenario.",
            "appliedTo": "Wall Bottom Plate"
          }
        ]
      },
      "tokens_used": 7104,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Execution Start",
          "2. Check if duplicate insertion cycle; erase instance if true",
          "3. [Conditional: On Insert] Prompt user to Select a Wall",
          "4. [Conditional: On Insert] Prompt user to Specify Engineering Type (1-5)",
          "5. Validate Wall Selection; if empty, erase instance",
          "6. Assign script instance to selected Wall Element",
          "7. [Conditional: On Insert or DB Created] Calculate Wall Elevation",
          "8. [Conditional: Elevation > 59\"] Override Engineering Type to 'None' and report message",
          "9. [Conditional: Type != 'None'] Calculate geometry: Wall length, openings, and segments",
          "10. [Conditional: Type != 'None'] Identify valid insertion points for Rods (Start, End, Openings, Spacing)",
          "11. [Conditional: Type 2 or 3] Calculate valid insertion points for Anchors (Offset spacing)",
          "12. [Conditional: Distribution Trigger] Erase all existing attached hardware sub-scripts",
          "13. Insert new 'GE_HDWR_ATC_ROD_ANCHORS' sub-scripts at calculated points with specific Map properties",
          "14. Draw reference circle and text 'E' at wall start"
        ],
        "conditionalBranches": [
          {
            "condition": "Wall Elevation Check (Height)",
            "path1": {
              "name": "Height > 59 inches (Upper Floor)",
              "steps": [
                "Override 'strType' to 'None'",
                "Display message stating no engineering components added",
                "Skip hardware generation",
                "Retain Master script on wall"
              ]
            },
            "path2": {
              "name": "Height <= 59 inches (Ground Floor)",
              "steps": [
                "Proceed with user-selected or Map-defined Engineering Type",
                "Calculate Rod and Anchor points",
                "Generate Hardware"
              ]
            }
          },
          {
            "condition": "Map Data Override (hsbData)",
            "path1": {
              "name": "Map contains 'TYPE' (Int 1-4)",
              "steps": [
                "Read 'TYPE' value from Wall hsbData",
                "Ignore user command line input (if any)",
                "Set 'strType' to corresponding value from Map array",
                "Remove Map entry after reading"
              ]
            },
            "path2": {
              "name": "No Map Data",
              "steps": [
                "Use user-selected Engineering Type from command line or OPM"
              ]
            }
          },
          {
            "condition": "Engineering Type Selection",
            "path1": {
              "name": "Type 1 (1/2\" ATC)",
              "steps": [
                "Generate '1/2\" ATC Rod' at Rod points",
                "No Anchors generated"
              ]
            },
            "path2": {
              "name": "Type 2 (1/2\" ATC + Anchor)",
              "steps": [
                "Generate '1/2\" ATC Rod' at Rod points",
                "Generate '3/8\" x 6\" Screw Anchor' at Plate (offset) points"
              ]
            },
            "path3": {
              "name": "Type 3 (CUP)",
              "steps": [
                "Generate '3/8\" x 6\" Screw Anchor' at Rod points",
                "Generate '3/8\" x 6\" Screw Anchor' at Plate (offset) points"
              ]
            },
            "path4": {
              "name": "Type 4 (3/8\" ATC)",
              "steps": [
                "Generate '3/8\" ATC Rod' at Rod points",
                "No Anchors generated"
              ]
            },
            "path5": {
              "name": "Type 5 (None)",
              "steps": [
                "Exit script logic (Hardware generation skipped)"
              ]
            }
          },
          {
            "condition": "Duplicate Master Instance Detected",
            "path1": {
              "name": "Another Master Script found on Wall",
              "steps": [
                "Erase current instance immediately",
                "Return"
              ]
            },
            "path2": {
              "name": "No Duplicate found",
              "steps": [
                "Continue execution"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Valid Wall Selection",
            "errorMessage": "None (Silent)",
            "recovery": "Script executes eraseInstance() if no wall is selected in the array."
          },
          {
            "check": "Element Type Validity",
            "errorMessage": "None (Silent)",
            "recovery": "Script executes eraseInstance() if the selected element cannot be cast to ElementWallSF."
          },
          {
            "check": "Duplicate Instance",
            "errorMessage": "None (Silent)",
            "recovery": "Script automatically self-destructs if another instance of this script is already attached to the same wall number."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Spacing",
            "how": "OPM Properties Palette",
            "effect": "Recalculates the distribution of Rods and Anchors. Triggers a full clean-up of existing hardware and re-insertion at new intervals."
          },
          {
            "action": "Change Scenario (Type)",
            "how": "OPM Properties Palette",
            "effect": "Swaps the hardware configuration (e.g., from Rods to Anchors) based on the new selection."
          },
          {
            "action": "Re-distribute",
            "how": "Right-click Context Menu",
            "effect": "Forces a recalculation of insertion points (useful if wall length or openings change). Deletes old hardware and inserts new."
          },
          {
            "action": "Remove Existing",
            "how": "Right-click Context Menu",
            "effect": "Deletes all attached 'GE_HDWR_ATC_ROD_ANCHORS' sub-scripts from the wall but keeps the Master script instance."
          }
        ]
      },
      "tokens_used": 8600,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_HDWR_ATC_ROD_MASTER.mcr\n\n## Overview\nAutomates the distribution and insertion of Continuous Rod Tie-Down (ATC) hardware and screw anchors along the bottom plate of a selected wall. It calculates placement based on engineering types and spacing, handling different hardware configurations like 1/2\" rods, 3/8\" rods, or cup anchors.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in 3D model context. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | Not applicable for generating 2D outputs. |\n\n## Prerequisites\n- **Required Entities**: A standard Wall (`ElementWallSF`).\n- **Required Settings**: The sub-script `GE_HDWR_ATC_ROD_ANCHORS.mcr` must be present in the TSL search path.\n- **Minimum Beams**: N/A (Operates on Wall Elements).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_HDWR_ATC_ROD_MASTER.mcr` from the file dialog.\n\n### Step 2: Select a Wall\n```\nCommand Line: Select a Wall\nAction: Click on the desired wall element in the Model Space.\n```\n\n### Step 3: Specify Engineering Type\n```\nCommand Line: Specify Engineering Type\n1=1/2 ATC 2=1/2 ATC+ANCHOR 3=CUP 4= 3/8 ATC 5=None[1/2/3/4/5] <3>\nAction: Type the number corresponding to the required engineering scenario and press Enter.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Scenario | Dropdown | \"1/2\" ATC Engineering\" | Defines the hardware configuration to apply. Options include 1/2\" ATC, 1/2\" ATC + Anchor, CUP, 3/8\" ATC, or None. |\n| Spacing | Number | 48\" | The on-center spacing between the primary hold-down rods. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Re-distribute | Recalculates rod and anchor positions based on current wall length, openings, and properties. Useful after modifying the wall geometry. |\n| Remove Existing | Deletes all hardware sub-scripts currently attached to the wall, effectively removing the rods and anchors while keeping the Master script active. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Upper Floor Logic**: This script automatically checks the wall elevation. If the wall bottom is higher than ~59 inches (typically an upper floor), the Scenario automatically defaults to \"None\" to prevent engineering hardware from being placed where it isn't needed.\n- **Map Data Override**: If the wall element has specific map data attached (Key \"TYPE\"), it will override the Scenario selected in the properties or command line.\n- **Updating Geometry**: If you change the length of the wall or add/remove window/door openings, use the **Re-distribute** right-click option to update hardware locations without re-running the script.\n- **Spacing Impact**: When \"Scenario\" is set to \"1/2\" ATC & Anchor\" (Type 2), anchors are placed at half the spacing specified in the properties, offset between the main rods.\n\n## FAQ\n- **Q: I ran the script, but no hardware appeared. Why?**\n  **A:** Check the **Scenario** property in the Properties Palette. If the wall is on an upper floor (elevation > 59\"), the script automatically sets the scenario to \"None\". You can manually change this back if required, though it usually indicates the wall is not a shear wall.\n  \n- **Q: How do I change the spacing between rods?**\n  **A:** Select the wall or the script instance, open the Properties Palette (Ctrl+1), locate the **Spacing** parameter, and change the value. The script will automatically recalculate.\n\n- **Q: What happens if I select \"None\" as the Scenario?**\n  **A:** The script will remain attached to the wall but will not generate any physical hardware or sub-scripts. This is useful for temporarily disabling engineering without deleting the configuration."
      },
      "tokens_used": 5361,
      "error": null
    }
  }
}