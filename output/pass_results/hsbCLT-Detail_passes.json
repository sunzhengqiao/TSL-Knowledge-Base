{
  "filename": "hsbCLT-Detail.mcr",
  "status": "completed",
  "total_tokens": 31992,
  "processing_time": 655.366140127182,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This TSL specifies a detail section. A Detail will always be seen towards the outer grip of the section. If both grips are not outside the panel the grip which is closer to the panel profile will determine the direction",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "10apr14",
            "author": "th@hsbCAD.de",
            "changes": "bugfix of published orientation"
          },
          {
            "version": "1.0",
            "date": "04apr14",
            "author": "th@hsbCAD.de",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6448,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses _kModelSpace in collectEntities, interacts with sip (Structural Insertion Point) properties like sip.plEnvelope() and sip.realBody(), and performs 3D geometric calculations (Body intersection). No usage of _kPaperSpace, _Viewport, or Sheet objects."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "ModelSpace (Must be attached to a panel/element)",
          "requiredSettings": []
        }
      },
      "tokens_used": 5937,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getSip",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Select first point of section line|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrPoint",
              "promptOriginal": "|Select second point of section line|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "sViewNumber",
            "type": "PropString",
            "displayName": "|View Number|",
            "defaultValue": "A",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "|Defines the view number. Enter a character for alphanumeric or a number to create numeric detail numbers|"
          },
          {
            "index": 3,
            "variable": "sFullRange",
            "type": "PropString",
            "displayName": "|Section Full Range|",
            "defaultValue": "|No|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": "|Defines if the detail view is based on an infinte intersection with the panel or if it will take only the range between the grips.|"
          },
          {
            "index": 6,
            "variable": "dTxtH",
            "type": "PropDouble",
            "displayName": "|Text Height|",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "|Defines the text height and scaling of the symbol|"
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "|Dimstyle|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sLineType",
            "type": "PropString",
            "displayName": "|Line Type|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "_LineTypes"
            ],
            "category": null,
            "description": "|Defines the linetype of the section line|"
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "145",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Flip Direction|",
            "handler": "|Flip Direction|",
            "action": "Flips the direction of the detail view vector",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 6312,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a parametric detail section marker on CLT panels and generates the corresponding cross-section geometry for drawing production.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used when the draftsman needs to create a detailed cut-through view of a specific area of a timber panel, such as showing floor layer buildup or wall connections, tagged with a unique identifier (e.g., Detail A)."
        },
        "parameters": [
          {
            "name": "sViewNumber",
            "technicalDefault": "A",
            "businessMeaning": "The unique identifier (tag) for the detail view, typically a single letter or number, used to label the callout and the resulting detail drawing.",
            "validRange": "A-Z or 1-26 (Single character)",
            "unit": "String",
            "affectsOutput": "Updates the text displayed at the section marker. Includes logic to auto-increment to the next available number if the chosen one is already used on the same panel."
          },
          {
            "name": "sFullRange",
            "technicalDefault": "No",
            "businessMeaning": "Determines if the detail view cut extends infinitely across the entire panel geometry or is limited strictly to the segment between the two selected grip points.",
            "validRange": "Yes, No",
            "unit": "Enumeration",
            "affectsOutput": "If 'Yes', the generated detail view body intersects the entire panel width along the cut line. If 'No', it only shows the specific slice defined between the start and end points."
          },
          {
            "name": "dTxtH",
            "technicalDefault": "1",
            "businessMeaning": "The plot height of the detail label text and the overall scale of the marker symbol (circles and arrows).",
            "validRange": "0.1 to 10 (Typical drawing text sizes, e.g., 2.5mm or 3.5mm)",
            "unit": "Current Length Units (mm/inch)",
            "affectsOutput": "Resizes the text string and geometric marker elements. Larger values make the detail callout more visible but may clutter the plan view."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "The CAD dimension style applied to the text label, controlling font and appearance.",
            "validRange": "Any Dimension Style defined in the drawing",
            "unit": "String",
            "affectsOutput": "Changes the font and visual style of the View Number text."
          },
          {
            "name": "sLineType",
            "technicalDefault": "_LineTypes",
            "businessMeaning": "The visual style of the cutting line (e.g., continuous, dashed, dash-dot).",
            "validRange": "Any LineType defined in the drawing",
            "unit": "String",
            "affectsOutput": "Changes the linestyle pattern of the section line drawn between the grips."
          },
          {
            "name": "nColor",
            "technicalDefault": "145",
            "businessMeaning": "The display color of the section line, arrows, and text label.",
            "validRange": "0-255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the on-screen color of the generated graphical elements."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Insertion / sViewNumber modification",
            "effect": "The script automatically checks for duplicate view numbers within the same panel group. If a duplicate is found, it increments the ID to the next available alphanumeric value.",
            "cascade": [
              "sViewNumber"
            ]
          },
          {
            "trigger": "Moving Grips (_PtG)",
            "effect": "Recalculates the section geometry. The logic also re-evaluates the position of the grips relative to the panel profile to determine the 'view direction' automatically.",
            "cascade": [
              "Section geometry",
              "View Direction"
            ]
          },
          {
            "trigger": "dTxtH modification",
            "effect": "The geometry of the circles and arrows is scaled proportionally based on the text height to maintain correct symbol aspect ratio.",
            "cascade": [
              "Marker geometry",
              "Text display"
            ]
          },
          {
            "trigger": "Context Menu 'Flip Direction'",
            "effect": "Inverts the viewing vector of the detail section (looks at the opposite side of the cut line) without moving the grips.",
            "cascade": [
              "View Direction vectors",
              "Detail Body"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Detail Marker",
            "description": "Graphical symbol consisting of a section line, two end circles, directional arrows, and a label (View Number) placed in ModelSpace.",
            "appliedTo": "CLT Panel / Element"
          },
          {
            "type": "Detail Body",
            "description": "A 3D Body representing the intersection of the panel with the cutting plane, specifically filtered for the 'Detail' display representation to generate 2D drawings.",
            "appliedTo": "CLT Panel / Element"
          }
        ]
      },
      "tokens_used": 7657,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-Detail.mcr\n\n## Overview\nThis script creates a parametric detail section marker on CLT panels and generates the corresponding cross-section geometry for drawing production.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script must be attached to a panel/element in 3D model. |\n| Paper Space | No | Not supported in Paper Space. |\n| Shop Drawing | No | This is a model-space script used to define details that appear in drawings. |\n\n## Prerequisites\n- **Required Entities**: GenBeam or Element (CLT Panel).\n- **Minimum Beam Count**: 1.\n- **Required Settings Files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCLT-Detail.mcr`\n\n### Step 2: Select Panel\n```\nCommand Line: Select element/beam\nAction: Click on the CLT panel or beam where you want to create the detail.\n```\n\n### Step 3: Define Section Line Start\n```\nCommand Line: Select first point of section line\nAction: Click in the model to place the start point of the detail cut.\n```\n\n### Step 4: Define Section Line End\n```\nCommand Line: Select second point of section line\nAction: Click to place the end point. The detail view direction is automatically calculated based on which side of the panel the grips are located.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| View Number | Text | A | The identifier for the detail (e.g., \"A\", \"B\", \"1\"). Automatically increments if the chosen number is already used on the panel. |\n| Section Full Range | Dropdown | No | Determines if the cut is infinite across the panel (\"Yes\") or limited to the space between the grips (\"No\"). |\n| Text Height | Number | 1 | Controls the size of the text label and the scaling of the marker symbol. |\n| Dimstyle | Dropdown | _DimStyles | The dimension style applied to the text label. |\n| Line Type | Dropdown | _LineTypes | The linetype used for the section cutting line. |\n| Color | Number | 145 | The color of the section line and marker elements. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Flip Direction | Reverses the viewing direction of the detail section. Use this if the detail is looking at the wrong side of the panel. |\n\n## Settings Files\n- No external settings files are required for this script.\n\n## Tips\n- **Automatic Direction**: The script automatically determines the view direction by checking which grip is further from the panel profile.\n- **Avoiding Duplicates**: If you set the View Number to \"A\" and it already exists on the same panel, the script will automatically change it to \"B\" (or the next available value).\n- **Scaling**: Adjust the `Text Height` property if the detail callout is too small or too large on your plans.\n\n## FAQ\n- Q: How do I make the detail cut through the entire wall length?\n- A: Set the `Section Full Range` property to \"Yes\".\n- Q: The detail is pointing the wrong way. How do I fix it?\n- A: Select the detail in the model, right-click, and choose `Flip Direction`.\n- Q: Why did my view number change from \"1\" to \"2\"?\n- A: The script detected that \"1\" was already used on this specific panel and automatically assigned the next available number."
      },
      "tokens_used": 5638,
      "error": null
    }
  }
}