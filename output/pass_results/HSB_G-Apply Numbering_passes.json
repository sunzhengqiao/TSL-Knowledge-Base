{
  "filename": "HSB_G-Apply Numbering.mcr",
  "status": "completed",
  "total_tokens": 36457,
  "processing_time": 526.7716953754425,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 6338,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Use of `_kModelSpace` in `Group().collectEntities()` calls. The script iterates through `_Entity` (collection of Elements) and modifies `GenBeam` properties (`assignPosnum`). No references to `_kPaperSpace`, `_Viewport`, or `sd_` prefixes. It functions as a batch processing utility on the structural model."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing Elements with assigned GenBeams.",
          "requiredSettings": []
        }
      },
      "tokens_used": 3760,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 7042,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Batch assigns position numbers to structural beams based on label filtering rules and user-defined sequences.\",\n    \"category\": \"DataManagement\",\n    \"typicalUseCase\": \"Separating numbering sequences for different material types (e.g., wall studs starting at 1, floor joists starting at 100) within a specific model area or floor level.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sInsertType\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Determines the scope of the model to be processed. Defines whether the numbering applies to the entire drawing, a specific floor level, the current working group, or a manual selection.\",\n      \"validRange\": \"0 (All), 1 (Floor List), 2 (Current Floor), 3 (Manual Select)\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Controls which set of Elements (and their GenBeams) are passed into the numbering loop.\"\n    },\n    {\n      \"name\": \"sNameFloorGroup\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Identifies the specific floor level to process when 'Select floor level in floor level list' is chosen.\",\n      \"validRange\": \"List of available floor group names in the model\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Filters the collection of Elements to those belonging to the specified floor group.\"\n    },\n    {\n      \"name\": \"sKeepExisting\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Controls whether existing position numbers are cleared before the assignment process attempts to re-apply them. If No, all existing numbers in the selection are released first.\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"bool\",\n      \"affectsOutput\": \"Determines if the numbering map is reset for the selected beams before applying new labels.\"\n    },\n    {\n      \"name\": \"sLabel01\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"A semicolon-separated list of beam labels (e.g., 'WAL;STU') used to identify the first group of beams. Supports wildcards '*' (e.g., '*WAL*').\",\n      \"validRange\": \"String list of label tokens\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Identifies beams that will receive the numbering sequence defined by 'nStartAt01'.\"\n    },\n    {\n      \"name\": \"nStartAt01\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"The starting position number for beams matching the criteria in 'sLabel01'. Subsequent matching beams will increment from this value.\",\n      \"validRange\": \"0 to large integer\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Sets the numerical value of the Position Number (PosNum) property for the first matching beam in Group 1.\"\n    },\n    {\n      \"name\": \"sLabel02\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"A semicolon-separated list of beam labels used to identify a second group of beams for a different numbering sequence.\",\n      \"validRange\": \"String list of label tokens\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Identifies beams that will receive the numbering sequence defined by 'nStartAt02'.\"\n    },\n    {\n      \"name\": \"nStartAt02\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"The starting position number for beams matching the criteria in 'sLabel02'.\",\n      \"validRange\": \"0 to large integer\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Sets the numerical value of the Position Number (PosNum) property for the first matching beam in Group 2.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sInsert"
      },
      "tokens_used": 6622,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 7536,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-Apply Numbering\n\n## Overview\nThis script automates the assignment of position numbers (PosNum) to structural beams based on specific label filters. It allows you to create separate numbering sequences for different beam types (e.g., starting wall studs at 1 and floor joists at 100) within a selected scope of the model.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on structural elements (GenBeams) in the model. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | Not applicable for shop drawing generation. |\n\n## Prerequisites\n- **Required Entities:** Elements with assigned GenBeams (structural timber beams).\n- **Minimum Beam Count:** 0.\n- **Required Settings:** None. Ensure your beams have Labels assigned (e.g., \"WAL\" for walls, \"FLR\" for floors) to use the filtering features effectively.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-Apply Numbering.mcr`\n1. Type `TSLINSERT` in the command line.\n2. Browse to the location of `HSB_G-Apply Numbering.mcr` and select it.\n3. Click **OK** to insert the script into the drawing.\n\n### Step 2: Configure Parameters\n1. Select the script object in the drawing (if not already selected).\n2. Open the **Properties Palette** (Ctrl+1).\n3. Adjust the parameters (e.g., **Insert Type**, **Labels**, **Start Numbers**) to define your numbering rules. See the Parameters section below for details.\n\n### Step 3: Execute Numbering\n1. With the script selected, right-click in the drawing area.\n2. Select the appropriate context menu option (e.g., **Recalculate** or a specific trigger like **Apply Numbering**) to run the script.\n3. If **Insert Type** is set to \"Manual Select\", follow the command line prompts to select the beams you wish to process.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| sInsertType | Dropdown | 3 (Manual Select) | Determines the scope of beams to process. <br>0: All beams in drawing.<br>1: Select a specific floor level.<br>2: Current floor only.<br>3: Manually select beams. |\n| sNameFloorGroup | Text | \"\" | The name of the floor group to process (only used if Insert Type is \"Floor List\"). |\n| sKeepExisting | Yes/No | Yes | **Yes**: Retains existing position numbers on beams that already have one.<br>**No**: Clears all position numbers in the selection before applying new ones. |\n| sLabel01 | Text | \"\" | Enter beam labels for Group 1, separated by semicolons (e.g., `WAL;STU`). Supports wildcards `*` (e.g., `*WAL*`). |\n| nStartAt01 | Number | 0 | The starting position number for beams matching the criteria in **sLabel01**. |\n| sLabel02 | Text | \"\" | Enter beam labels for Group 2. |\n| nStartAt02 | Number | 0 | The starting position number for beams matching the criteria in **sLabel02**. |\n\n*(Note: The script may contain additional groups such as sLabel03/nStartAt03 depending on the specific version. Check the Properties Palette for full availability.)*\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate / Apply | Executes the numbering logic based on the current properties and assigns numbers to the beams. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies entirely on Properties Palette parameters; no external XML settings file is required.\n\n## Tips\n- **Wildcards:** Use `*` in label fields to catch variations. For example, `*Wall*` will match \"IntWall\", \"ExtWall\", etc.\n- **Numbering Gaps:** To ensure numbering sequences do not overlap (e.g., walls vs. floors), set the **nStartAt** values significantly apart (e.g., Walls start at 1, Floors start at 500).\n- **Renumbering:** If you want to completely re-sequence a model, set **sKeepExisting** to \"No\". This clears previous numbers so you can start fresh without duplicates or gaps.\n\n## FAQ\n- Q: Why are my beams not getting numbered?\n  A: Check the **sLabel** fields. Ensure the text matches the actual Label property of your beams exactly (or use wildcards). Also, verify that the **Insert Type** scope includes the beams you are trying to number.\n- Q: Can I number multiple different types at once?\n  A: Yes. Use **sLabel01** for your first type (e.g., Studs) and **sLabel02** for your second type (e.g., Plates). Assign different **nStartAt** values to each group.\n- Q: What happens if I set sKeepExisting to \"No\"?\n  A: The script will wipe the Position Number property from all beams in the selected scope before applying the new numbers. Use this with caution."
      },
      "tokens_used": 5159,
      "error": null
    }
  }
}