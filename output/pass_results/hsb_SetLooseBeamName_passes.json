{
  "filename": "hsb_SetLooseBeamName.mcr",
  "status": "completed",
  "total_tokens": 18581,
  "processing_time": 146.10652589797974,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "27.05.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2523,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity with Beam() selection and _Beam array manipulation. No 'sd_' prefixes, no '_Viewport' usage, and no '#Type E' or '_Entity[]' patterns found. It operates on 3D model entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 1316,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialogOnce",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "Please select beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sName",
            "type": "PropString",
            "displayName": "Beam Names",
            "defaultValue": "B1",
            "inputType": "dropdown",
            "options": [
              "B1",
              "B2",
              "B3",
              "B4",
              "B5",
              "B6",
              "B7",
              "B8",
              "B9",
              "B10",
              "B11",
              "B12",
              "B13",
              "B14",
              "B15",
              "B16",
              "B17",
              "B18",
              "B19",
              "B20"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2253,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script used to batch rename a selection of loose beams to a specific identifier (e.g., B1, B2) in a single operation.",
          "category": "Naming/Utility",
          "typicalUseCase": "Assigning a specific assembly code or name to a group of loose timber elements (such as purlins or posts) for labeling, sorting in BOMs, or project organization."
        },
        "parameters": [
          {
            "name": "sName",
            "technicalDefault": "B1",
            "businessMeaning": "The specific identifier or 'Name' property assigned to the selected beams. This serves as the primary label for the element in lists, drawings, and production data.",
            "validRange": "B1 through B20 (Fixed list)",
            "unit": "Text/String",
            "affectsOutput": "Updates the 'Name' property of the selected beams in the CAD model and database. It does not change physical geometry or machining, but alters how the element is identified and sorted."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Script Insertion",
            "effect": "The script prompts for a beam selection and applies the chosen name immediately. The script instance is then deleted from the model.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Property Update",
            "description": "Sets the 'Name' attribute of the target beams to the value specified in the sName parameter.",
            "appliedTo": "All beams selected by the user during the 'PrEntity' selection phase."
          }
        ]
      },
      "tokens_used": 3652,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via command or toolbar",
          "Properties palette/Dialog displays options for 'Beam Names'",
          "User selects desired Name (e.g., B1) from the list",
          "Script verifies insert cycle count (must be first cycle)",
          "Command line prompts: 'Please select beams'",
          "User selects one or more loose beams in the model",
          "User confirms selection (Enter or Right-click)",
          "Script stores selected entities in internal list",
          "Script iterates through the list and applies the selected Name to the 'Name' property of each beam",
          "Script erases its own instance from the model"
        ],
        "conditionalBranches": [
          {
            "condition": "Insert Cycle Check",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase script instance",
                "Exit (Stop execution)"
              ]
            },
            "path2": {
              "name": "Cycle == 1",
              "steps": [
                "Proceed to Entity Selection Prompt"
              ]
            }
          },
          {
            "condition": "Beam Selection Confirmation (PrEntity)",
            "path1": {
              "name": "Selection Confirmed",
              "steps": [
                "Retrieve selected beam set",
                "Populate internal beam array"
              ]
            },
            "path2": {
              "name": "Selection Cancelled",
              "steps": [
                "Internal beam array remains empty",
                "Proceed to Empty List Check"
              ]
            }
          },
          {
            "condition": "Internal Beam Array Length",
            "path1": {
              "name": "Length == 0 (Empty)",
              "steps": [
                "Erase script instance",
                "Exit (No changes applied)"
              ]
            },
            "path2": {
              "name": "Length > 0 (Populated)",
              "steps": [
                "Loop through beams",
                "Set Name property",
                "Erase script instance"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Check if beam array is populated after selection",
            "errorMessage": "None (Silent)",
            "recovery": "Script deletes itself. User must re-run the command to make a selection."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 4569,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetLooseBeamName\n\n## Overview\nThis script is a utility tool used to batch rename a selection of loose beams to a specific identifier (such as B1, B2, etc.) in a single operation. It is useful for assigning assembly codes or names to groups of timber elements for better organization in lists and production data.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D model entities. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | Not applicable for shop drawing views. |\n\n## Prerequisites\n- **Required Entities**: Loose beams (GenBeam) must already exist in the model.\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SetLooseBeamName.mcr` from the file list and click Open.\n\n### Step 2: Configure Beam Name\nBefore proceeding to the selection prompt, locate the **Properties Palette** (usually on the right side of the screen).\n1. Find the property named **Beam Names**.\n2. Click the dropdown menu and select the desired identifier (e.g., B1, B2, B3...).\n3. Once set, the command line will proceed to the next step.\n\n### Step 3: Select Beams\n```\nCommand Line: Please select beams\nAction: Click on the loose beams you wish to rename.\n```\n- You can select multiple beams.\n- Once all beams are highlighted, press **Enter** or **Right-click** to confirm the selection.\n\n### Step 4: Completion\nThe script will immediately apply the selected name to the 'Name' property of all chosen beams and then automatically delete its own instance from the model.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beam Names | dropdown | B1 | The specific identifier code to apply to the selected beams. Options range from B1 to B20. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific options to the entity right-click menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A (Script uses internal fixed list for options).\n\n## Tips\n- **Set Property First**: Ensure you change the \"Beam Names\" property in the Properties Palette *before* you finish selecting the beams in the model. The value is locked in once you confirm the selection.\n- **Self-Cleaning**: You do not need to delete the script instance after running; it removes itself automatically.\n- **Batching**: You can window-select multiple beams at once during the selection step to rename them all rapidly.\n\n## FAQ\n- Q: Can I use a custom name not in the list (e.g., \"Rafter1\")?\n  A: No, this script currently only supports the fixed list of options from B1 to B20.\n- Q: What happens if I cancel the selection?\n  A: The script will simply delete itself, and no changes will be made to your beams.\n- Q: I ran the script, but nothing happened.\n  A: Ensure you actually selected beams and pressed Enter. If you missed the selection step, the script exits silently."
      },
      "tokens_used": 4268,
      "error": null
    }
  }
}