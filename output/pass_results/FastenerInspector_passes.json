{
  "filename": "FastenerInspector.mcr",
  "status": "completed",
  "total_tokens": 34129,
  "processing_time": 169.36832213401794,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "Displays the content of a selected fastenerAssemblyDefinition Style",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "28.08.2025",
            "author": "Thorsten Huck",
            "changes": "HSB-22933 improved version"
          },
          {
            "version": "1.0",
            "date": "24.01.2025",
            "author": "Thorsten Huck",
            "changes": "HSB-22933 initial version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6357,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_ or Multipage prefix. No #Type E or _Entity[] usage. No _Viewport usage. Uses Display dp(7) and getPoint() for standard Model Space visualization and insertion."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "None explicitly enforced, but standard execution is Model Space.",
          "requiredSettings": [
            "FastenerAssemblyDefinition entries must exist in the catalog"
          ]
        }
      },
      "tokens_used": 3896,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getFastenerAssemblyEnt",
              "promptOriginal": "Select fastener assembly",
              "condition": "sDefinition == '<|bySelection|>'",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Point:",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Palette",
            "trigger": "On Insert (showDialog)",
            "title": "---",
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sDefinition",
            "type": "PropString",
            "displayName": "|Fastener Style|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "<|bySelection|>",
              "FastenerAssemblyDef().getAllEntryNames()..."
            ],
            "category": "|General|",
            "description": "|Defines the Style|"
          },
          {
            "index": 1,
            "variable": "dTextHeight",
            "type": "PropDouble",
            "displayName": "|Text Height|",
            "defaultValue": "50",
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": "|Defines the TextHeight|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "TSLCONTENT",
            "handler": "CAD Command Definition",
            "action": "Executes hsb_ScriptInsert for FastenerInspector",
            "alsoTriggeredBy": "N/A"
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 6720,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Displays detailed textual information about a selected Fastener Assembly style (screws, bolts, etc.) in the model, including dimensions, materials, and article data.",
          "category": "Inspection/Documentation",
          "typicalUseCase": "Used by engineers or detailers to verify the exact configuration and data (lengths, diameters, material properties) defined within a specific fastener style from the catalog, or to identify the style of an existing fastener in the model."
        },
        "parameters": [
          {
            "name": "sDefinition",
            "technicalDefault": "",
            "businessMeaning": "Selects the specific Fastener Assembly Style (e.g., 'SPAX 8x200', 'LAG Screw 12x240') to inspect. It also allows selecting an existing fastener in the model to read its style.",
            "validRange": "List of available FastenerAssemblyDef entries in the catalog",
            "unit": "String (Name)",
            "affectsOutput": "Determines the entire content of the displayed text, including description, component data, article numbers, dimensions, and mapping attributes."
          },
          {
            "name": "dTextHeight",
            "technicalDefault": "50",
            "businessMeaning": "Controls the size of the text displayed in the model view for the inspection report.",
            "validRange": "10 - 500",
            "unit": "mm",
            "affectsOutput": "Scales the text size up or down; larger values make the report more legible from a distance but consume more screen space."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sDefinition set to '<|bySelection|>'",
            "effect": "Hides the dropdown prompt and waits for the user to click a Fastener Assembly entity in the drawing. The selected entity's style name is then loaded into the parameter.",
            "cascade": [
              "sDefinition"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text Elements (Visualization)",
            "description": "Generates a multi-line text display in Model Space showing Name, Type, Manufacturer, Material, Group, Article Numbers, Lengths, Thread Lengths, and Map attributes (like PilotDiameter, HeadHeight) for the selected fastener style.",
            "appliedTo": "None (Independent visualization placed at user click point _Pt0)"
          }
        ]
      },
      "tokens_used": 5235,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User executes script insert command (TSLCONTENT)",
          "Properties Palette (OPM) opens automatically displaying 'Fastener Style' and 'Text Height'",
          "User selects a Fastener Style from the dropdown list OR selects '<|bySelection|>'",
          "[Conditional] If '<|bySelection|>' is active: User selects an existing Fastener Assembly entity from the Model",
          "User confirms properties and closes the Palette (or clicks in drawing)",
          "Command line prompts: 'Point:' for insertion location",
          "User clicks to place the inspector report",
          "Script validates the Fastener Assembly Definition against the catalog",
          "Script draws the detailed text report (Description, Component Data, Article Data, Heads, Tails) at the insertion point"
        ],
        "conditionalBranches": [
          {
            "condition": "sDefinition property value",
            "path1": {
              "name": "Selection from Catalog List",
              "steps": [
                "User chooses a style name from the dropdown",
                "Script proceeds to getPoint prompt"
              ]
            },
            "path2": {
              "name": "Selection by Entity Pick",
              "steps": [
                "User selects '<|bySelection|>' from dropdown",
                "Prompt: 'Select fastener assembly' appears",
                "User clicks an existing fastener in model",
                "Script extracts style name from entity",
                "Script proceeds to getPoint prompt"
              ]
            }
          },
          {
            "condition": "Validity of Fastener Assembly Definition",
            "path1": {
              "name": "Valid Definition",
              "steps": [
                "Script parses component and article data",
                "Visualization is generated and displayed"
              ]
            },
            "path2": {
              "name": "Invalid Definition / Selection Cancelled",
              "steps": [
                "Script reports 'Invalid Definition' (if catalog lookup fails)",
                "Script erases instance",
                "Execution terminates"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "FastenerAssemblyEnt selection validity (when using '<|bySelection|>')",
            "errorMessage": "None (Script silently erases instance)",
            "recovery": "Ensure a valid Fastener Assembly is clicked during the selection step."
          },
          {
            "check": "FastenerAssemblyDef catalog existence",
            "errorMessage": "Invalid Definition",
            "recovery": "Select a style that exists in the current Fastener Assembly catalog or ensure the selected entity has a valid definition."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Fastener Style",
            "how": "Properties Palette (OPM) -> Fastener Style",
            "effect": "Script recalculates and redraws the visualization with the new style's data."
          },
          {
            "action": "Adjust Text Height",
            "how": "Properties Palette (OPM) -> Text Height",
            "effect": "Script redraws all text elements at the new scale."
          }
        ]
      },
      "tokens_used": 7359,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# FastenerInspector.mcr\n\n## Overview\nDisplays detailed textual information about a selected Fastener Assembly style (such as screws, bolts, or connectors) directly in the model view. It is used to verify configuration data, dimensions, materials, and article numbers defined in the catalog.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Standard execution environment. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Fastener Catalog Entries**: Fastener Assembly Definitions must exist in your current hsbCAD catalog.\n- **Existing Entities** (Optional): If using the selection option, a Fastener Assembly entity must already exist in the model.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `FastenerInspector.mcr`\n\n### Step 2: Configure Fastener Style\nThe Properties Palette (OPM) opens automatically.\n- **Action**: Select a Fastener Style from the dropdown list (e.g., \"SPAX 8x200\").\n- **Alternative**: Select `<|bySelection|>` from the top of the list to identify a style already placed in the model.\n\n### Step 3: Select Entity (Conditional)\n*Only appears if `<|bySelection|>` was chosen in Step 2.*\n```\nCommand Line: Select fastener assembly\nAction: Click on an existing fastener in the drawing.\n```\n\n### Step 4: Insert Location\n```\nCommand Line: Point:\nAction: Click in the Model Space to place the text report.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| |Fastener Style| | Dropdown | Empty | Selects the specific Fastener Assembly Style to inspect. Choose `<|bySelection|>` to pick an entity from the model. |\n| |Text Height| | Number | 50 | Sets the height of the generated text in the model (in mm). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Properties | Opens the Properties Palette to change the Fastener Style or Text Height, which updates the visualization immediately. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies solely on the internal Fastener Assembly Catalog (FastenerAssemblyDef).\n\n## Tips\n- **Identify Unknown Fasteners**: If you see a fastener in the model but don't know its specific catalog definition, insert this script, choose `<|bySelection|>`, and click the fastener to view its details.\n- **Readability**: If the text report is too small to read at your current zoom level, increase the **Text Height** parameter in the Properties Palette.\n- **Data Verification**: Use this tool to double-check thread lengths, pilot diameters, and material properties before generating production data.\n\n## FAQ\n- **Q: What happens if I select `<|bySelection|>` but click the wrong object?**\n  **A:** The script will likely report an invalid definition or fail to generate the text. Select the object again via the Properties Palette `Fastener Style` dropdown or re-insert the script.\n- **Q: Can I update the report if the catalog definition changes?**\n  **A:** Yes. Select the generated text in the model, open the Properties Palette, and simply re-select the style name from the dropdown to force a refresh."
      },
      "tokens_used": 4562,
      "error": null
    }
  }
}