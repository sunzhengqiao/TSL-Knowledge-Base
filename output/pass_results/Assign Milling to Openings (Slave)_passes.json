{
  "filename": "Assign Milling to Openings (Slave).mcr",
  "status": "completed",
  "total_tokens": 60344,
  "processing_time": 577.2159750461578,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9399,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script interacts with the 3D model by selecting an Element using getElement(), retrieves geometric data (CoordSys, Sheets, Openings), and creates ElemMill objects added to the Element via el.addTool(). There are no references to sd_ functions, Viewports, or 2D layout generation. The logic is focused on calculating milling paths for manufacturing (CAM) based on 3D geometry."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Opening",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (Element context)",
          "requiredSettings": []
        }
      },
      "tokens_used": 6957,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select an element",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 12,
            "variable": "sMode",
            "type": "PropString",
            "displayName": "Milling mode",
            "defaultValue": "|Opening|",
            "inputType": "dropdown",
            "options": [
              "|Opening|",
              "|Opening where sheets intersect|"
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 0,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "Zone",
            "defaultValue": 5,
            "inputType": "dropdown",
            "options": [
              -5,
              -4,
              -3,
              -2,
              -1,
              1,
              2,
              3,
              4,
              5
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 1,
            "variable": "nToolingIndex",
            "type": "PropInt",
            "displayName": "Tooling index",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 0,
            "variable": "strSide",
            "type": "PropString",
            "displayName": "Side",
            "defaultValue": "Left",
            "inputType": "dropdown",
            "options": [
              "Left",
              "Right"
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 1,
            "variable": "strTurn",
            "type": "PropString",
            "displayName": "Turning direction",
            "defaultValue": "Against course",
            "inputType": "dropdown",
            "options": [
              "Against course",
              "With course"
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 2,
            "variable": "strOShoot",
            "type": "PropString",
            "displayName": "Overshoot",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 3,
            "variable": "strVacuum",
            "type": "PropString",
            "displayName": "Vacuum",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "|Milling data|",
            "description": null
          },
          {
            "index": 0,
            "variable": "millDepth",
            "type": "PropDouble",
            "displayName": "Milling Depth",
            "defaultValue": "U(9/16)",
            "inputType": "number",
            "options": [],
            "category": "|Dimensions|",
            "description": null
          },
          {
            "index": 1,
            "variable": "dOffsetOpening",
            "type": "PropDouble",
            "displayName": "Offset milling around opening",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "|Dimensions|",
            "description": null
          },
          {
            "index": 2,
            "variable": "dOffsetTop",
            "type": "PropDouble",
            "displayName": "Offset milling panel top",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "|Dimensions|",
            "description": null
          },
          {
            "index": 3,
            "variable": "dOffsetSide",
            "type": "PropDouble",
            "displayName": "Offset milling panel sides",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "|Dimensions|",
            "description": null
          },
          {
            "index": 4,
            "variable": "sMillingOnTop",
            "type": "PropString",
            "displayName": "Milling on top",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 5,
            "variable": "sMillingOnTopLeft",
            "type": "PropString",
            "displayName": "Milling on top-left",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 6,
            "variable": "sMillingOnLeft",
            "type": "PropString",
            "displayName": "Milling on left",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 7,
            "variable": "sMillingOnBottomLeft",
            "type": "PropString",
            "displayName": "Milling on bottom-left",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 8,
            "variable": "sMillingOnBottom",
            "type": "PropString",
            "displayName": "Milling on bottom",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 9,
            "variable": "sMillingOnBottomRight",
            "type": "PropString",
            "displayName": "Milling on bottom-right",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 10,
            "variable": "sMillingOnRight",
            "type": "PropString",
            "displayName": "Milling on right",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 11,
            "variable": "sMillingOnTopRight",
            "type": "PropString",
            "displayName": "Milling on top-right",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": "|Locations|",
            "description": null
          },
          {
            "index": 4,
            "variable": "dEdgeOffsetFromHole",
            "type": "PropDouble",
            "displayName": "Offset from hole edge",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "|Dimensions|",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9968,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically assigns CNC milling operations (contours) to wall panel surfaces based on element openings and the overall panel profile.\",\n    \"category\": \"Manufacturing/CAM\",\n    \"typicalUseCase\": \"Used to generate milling paths for wall panels where openings (windows/doors) exist, or to profile the perimeter of the panel, for CNC machinery.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sMode\",\n      \"technicalDefault\": \"|Opening|\",\n      \"businessMeaning\": \"Determines the strategy for generating milling paths: either directly around the opening geometry, or specifically where sheet material intersects the opening area (useful for complex panel layouts).\",\n      \"validRange\": \"|Opening|, |Opening where sheets intersect|\",\n      \"unit\": \"selection\",\n      \"affectsOutput\": \"Switches the calculation logic between a simple outline of the opening or a boolean intersection of the opening shape with the actual sheeting profiles in the zone.\"\n    },\n    {\n      \"name\": \"nZone\",\n      \"technicalDefault\": \"5\",\n      \"businessMeaning\": \"Specifies the construction layer (Zone) of the element to which the milling operations are applied (e.g., inner lining, outer sheathing, structural layer).\",\n      \"validRange\": \"-5 to 5\",\n      \"unit\": \"layer index\",\n      \"affectsOutput\": \"Changes the depth reference and the planar surface on which the milling path is generated.\"\n    },\n    {\n      \"name\": \"nToolingIndex\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Links the milling operation to a specific CNC tool number defined in the machine settings or databases.\",\n      \"validRange\": \"1 to 999\",\n      \"unit\": \"integer ID\",\n      \"affectsOutput\": \"Output CAM data includes this tool number, instructing the machine which spindle/bit to use.\"\n    },\n    {\n      \"name\": \"strSide\",\n      \"technicalDefault\": \"Left\",\n      \"businessMeaning\": \"Indicates the side of the panel material from which the milling is approached (often relevant for machine setup or finish quality).\",\n      \"validRange\": \"Left, Right\",\n      \"unit\": \"direction\",\n      \"affectsOutput\": \"Updates the side attribute in the generated ElemMill object.\"\n    },\n    {\n      \"name\": \"strTurn\",\n      \"technicalDefault\": \"Against course\",\n      \"businessMeaning\": \"Defines the direction the tool travels around the profile (Clockwise vs Counter-Clockwise), affecting climb vs conventional milling.\",\n      \"validRange\": \"Against course, With course\",\n      \"unit\": \"direction\",\n      \"affectsOutput\": \"Sets the rotation direction code in the CNC output.\"\n    },\n    {\n      \"name\": \"strOShoot\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Controls whether the tool path extends beyond the start/end points to avoid dwell marks or for lead-in/lead-out moves.\",\n      \"validRange\": \"No, Yes\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Modifies the toolpath start and end points to overshoot the target geometry.\"\n    },\n    {\n      \"name\": \"strVacuum\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Signals whether vacuum hold-downs should be enabled/disabled for this specific operation on the CNC machine.\",\n      \"validRange\": \"No, Yes\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Adds vacuum control flags to the machining operation.\"\n    },\n    {\n      \"name\": \"millDepth\",\n      \"technicalDefault\": \"U(9/16)\",\n      \"businessMeaning\": \"The depth of cut for the milling operation, usually matching the thickness of the sheet material being processed.\",\n      \"validRange\": \"1mm to 100mm (material dependent)\",\n      \"unit\": \"length (mm/inches)\",\n      \"affectsOutput\": \"Sets the Z-depth of the toolpath.\"\n    },\n    {\n      \"name\": \"dOffsetOpening\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"An additional clearance gap around the opening profile (positive value mills larger, negative mills smaller).\",\n      \"validRange\": \"-50mm to 50mm\",\n      \"unit\": \"length (mm/inches)\",\n      \"affectsOutput\": \"Expands or contracts the milling path around the opening geometry.\"\n    },\n    {\n      \"name\": \"dOffsetTop\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Shifts the milling path specifically at the top edge of the panel or opening, often for gable walls or alignment.\",\n      \"validRange\": \"-100mm to 100mm\",\n      \"unit\": \"length (mm/inches)\",\n      \"affectsOutput\": \"Translates the top horizontal segments of the toolpath.\"\n    },\n    {\n      \"name\": \"dOffsetSide\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Shifts the milling path at the vertical sides of the panel or opening.\",\n      \"validRange\": \"-100mm to 100mm\",\n      \"unit\": \"length (mm/inches)\",\n      \"affectsOutput\": \"Translates the vertical segments of the toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnTop\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the top horizontal edge of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the top edge segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnTopLeft\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the top-left corner/slope of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the top-left segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnLeft\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the left vertical edge of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the left vertical segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnBottomLeft\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the bottom-left corner/slope of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the bottom-left segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnBottom\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the bottom horizontal edge of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the bottom horizontal segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnBottomRight\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the bottom-right corner/slope of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the bottom-right segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnRight\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the right vertical edge of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the right vertical segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"sMillingOnTopRight\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables or disables milling on the top-right corner/slope of the panel profile.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"Includes or excludes the top-right segment from the perimeter toolpath.\"\n    },\n    {\n      \"name\": \"dEdgeOffsetFromHole\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Specific offset applied to edges of milling paths when using the 'Opening where sheets intersect' mode, useful for tolerancing around sheet joints.\",\n      \"validRange\": \"-50mm to 50mm\",\n      \"unit\": \"length (mm/inches)\",\n      \"affectsOutput\": \"Refines the path edges based on sheet intersection geometry.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sMode is set to '|Opening where sheets intersect|'\",\n      \"effect\": \"Activates the logic that uses dEdgeOffsetFromHole to calculate paths based on actual sheeting profiles rather than just the opening outline.\",\n      \"cascade\": [\n        \"dEdgeOffsetFromHole\"\n      ]\n    },\n    {\n      \"trigger\": \"nZone is changed\",\n      \"effect\": \"Updates the reference plane and depth context for all milling operations.\",\n      \"cascade\": [\n        \"millDepth\"\n      ]\n    }\n  ],\n  \"output"
      },
      "tokens_used": 11442,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script: User runs the TSL script.",
          "2. Select Element: Command line prompt 'Select an element'. User picks a wall/element.",
          "3. Display Dialog: Properties palette or initial dialog shows configuration options.",
          "4. Initialize Data: Script reads OPM properties (Mode, Zone, Offsets, etc.).",
          "5. Gather Geometry: Retrieve Beams, Sheets (in specified Zone), and Openings from the selected Element.",
          "6. Calculate Sheet Profiles: Generate a unified 'PlaneProfile' representing all sheet material in the target zone.",
          "7. Iterate Openings: Loop through every Opening found in the element.",
          "8. Locate Sill: For each opening, search for an intersecting Sill beam.",
          "9. Calculate Opening Bounds: Determine 4 corner points of the milling box (applying Gaps and Offsets).",
          "10. Branch: Evaluate 'Milling Mode' property (Mode 0 vs Mode 1).",
          "11. Generate Opening Milling: Create 'ElemMill' objects based on the selected mode logic.",
          "12. Process Element Perimeter: Retrieve the gross profile ('Brutto') of the element.",
          "13. Analyze Perimeter Segments: Check direction and type of every edge (Top, Bottom, Left, Right, Corners).",
          "14. Filter Perimeter Segments: Exclude segments if specific 'Milling on [Location]' properties are set to 'No'.",
          "15. Apply Perimeter Offsets: Shift segments based on 'Offset panel top/sides' and Zone gap settings.",
          "16. Generate Perimeter Milling: Create 'ElemMill' objects for the outer profile.",
          "17. Commit Tools: Add all generated 'ElemMill' objects to the element.",
          "18. Finalize: Group script instance to element for automatic updates."
        ],
        "conditionalBranches": [
          {
            "condition": "Script execution state (Insert vs Update)",
            "path1": {
              "name": "Initial Insertion",
              "steps": [
                "Prompt user to select Element ('Select an element').",
                "Show Properties Dialog.",
                "Store Element reference.",
                "Stop execution (returns)."
              ]
            },
            "path2": {
              "name": "Recalculation / Update",
              "steps": [
                "Retrieve stored Element reference.",
                "Execute full geometric calculation loop.",
                "Update existing Millings on the Element."
              ]
            }
          },
          {
            "condition": "Milling Mode property (sMode)",
            "path1": {
              "name": "Simple Opening (|Opening|)",
              "steps": [
                "Generate a rectangular PLine around the opening.",
                "Check for valid Sill beam.",
                "If Sill exists: Modify bottom edge to cut around sill (C-Shape).",
                "If Sill missing: Keep rectangular shape.",
                "Create single ElemMill."
              ]
            },
            "path2": {
              "name": "Sheet Intersection (|Opening where sheets intersect|)",
              "steps": [
                "Create a rectangular PlaneProfile for the opening.",
                "Intersect with the aggregate Sheet Profile.",
                "Loop through resulting intersection rings.",
                "Apply 'Offset from hole edge' logic.",
                "Create separate ElemMill for each intersection ring."
              ]
            }
          },
          {
            "condition": "Perimeter Segment Analysis",
            "path1": {
              "name": "Segment Enabled",
              "steps": [
                "Check 'Milling on [Location]' property (e.g., Top, Left).",
                "If 'Yes': Apply offsets (dOffsetTop, dOffsetSide, dGapZn).",
                "Generate LineSeg for milling."
              ]
            },
            "path2": {
              "name": "Segment Disabled",
              "steps": [
                "Check 'Milling on [Location]' property.",
                "If 'No': Skip generation for this segment."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "Implicit (Script erases self)",
            "recovery": "User must re-insert the script and select a valid Element."
          },
          {
            "check": "Zone Validity",
            "errorMessage": "Implicit (No sheets found)",
            "recovery": "User must verify that the selected Element has material in the specified 'Zone' index."
          },
          {
            "check": "Opening/Sill Intersection",
            "errorMessage": "None (Uses default gap of 0)",
            "recovery": "If a specific bottom cutout is required, ensure a Sill beam is drawn crossing the opening width."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Parameters (OPM)",
            "how": "Select the script instance in the model and edit properties in the AutoCAD Properties Palette.",
            "effect": "Script recalculates immediately. Changes to Offsets, Depth, or Tooling Index update the CNC data. Toggling 'Milling on [Location]' adds or removes perimeter cuts."
          },
          {
            "action": "Update Element Geometry",
            "how": "Grip edit the Element, resize Openings, or add/remove Sheets.",
            "effect": "Script is grouped to the element; updates automatically trigger to adjust milling paths to new geometry."
          }
        ]
      },
      "tokens_used": 13309,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Assign Milling to Openings (Slave).mcr\n\n## Overview\nAutomatically assigns CNC milling operations (contours) to wall panel surfaces based on element openings (windows/doors) and the overall panel profile. It allows for precise control of tool paths, depths, and offsets for manufacturing preparation.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be inserted onto an Element in the 3D model. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | This script focuses on 3D/CAM data, not drawing annotations. |\n\n## Prerequisites\n- **Required entities**: An Element (e.g., Wall Panel) containing Openings and Sheets.\n- **Minimum beam count**: 0 (Requires an Element, not standalone beams).\n- **Required settings**: None (Uses OPM properties).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Assign Milling to Openings (Slave).mcr`\n\n### Step 2: Select Element\n```\nCommand Line: Select an element\nAction: Click on the desired Wall Element in the model to attach the script.\n```\n*Note: Upon selection, the script instance is created. Configuration is done via the Properties Palette.*\n\n### Step 3: Configure Parameters\n```\nAction: With the script instance selected, press [Ctrl + 1] to open the Properties Palette.\nAction: Adjust the Milling Mode, Zone, Offsets, and Locations as required.\nAction: The script automatically recalculates when parameters are changed.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Milling mode | dropdown | \\|Opening\\| | Determines if milling follows the opening outline or where sheets intersect the opening. |\n| Zone | number | 5 | The construction layer index to apply milling to (e.g., -5 to 5). |\n| Tooling index | number | 1 | The CNC tool number to assign to these milling operations. |\n| Side | dropdown | Left | The side of the material from which the milling is approached. |\n| Turning direction | dropdown | Against course | The direction the tool travels around the profile (Climb vs Conventional). |\n| Overshoot | dropdown | No | Extends the tool path beyond start/end points to avoid dwell marks. |\n| Vacuum | dropdown | Yes | Enables vacuum hold-down flags for the CNC machine. |\n| Milling Depth | number | U(9/16) | The depth of the cut (Z-axis). |\n| Offset milling around opening | number | U(0) | Clearance gap added around the opening profile. |\n| Offset milling panel top | number | U(0) | Shifts the milling path at the top edge of the panel. |\n| Offset milling panel sides | number | U(0) | Shifts the milling path at the vertical sides of the panel. |\n| Milling on top | dropdown | Yes | Enables or disables milling on the top horizontal edge. |\n| Milling on top-left | dropdown | Yes | Enables or disables milling on the top-left corner. |\n| Milling on left | dropdown | Yes | Enables or disables milling on the left vertical edge. |\n| Milling on bottom-left | dropdown | Yes | Enables or disables milling on the bottom-left corner. |\n| Milling on bottom | dropdown | Yes | Enables or disables milling on the bottom horizontal edge. |\n| Milling on bottom-right | dropdown | Yes | Enables or disables milling on the bottom-right corner. |\n| Milling on right | dropdown | Yes | Enables or disables milling on the right vertical edge. |\n| Milling on top-right | dropdown | Yes | Enables or disables milling on the top-right corner. |\n| Offset from hole edge | number | U(0) | Specific offset used when Mode is \"Opening where sheets intersect\". |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add custom context menu items. Use the Properties Palette to modify settings. |\n\n## Settings Files\n- **Filename**: *None*\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Zone Selection**: Ensure the `Zone` parameter matches the actual layer (e.g., sheathing or structural) you wish to machine. If the zone is empty, no milling will be generated.\n- **Openings with Sills**: If you select the simple \"Opening\" mode, the script automatically detects if a Sill beam is present and adjusts the bottom cut of the milling accordingly (creating a C-shape around the sill).\n- **Partial Perimeter**: You can mill only specific sides of the panel by setting the \"Milling on [Location]\" properties to \"No\". This is useful for panels that are pre-cut on certain edges.\n- **Sheet Intersection**: Use the \"Opening where sheets intersect\" mode if your wall has complex sheeting layouts (like staggered studs) and you only want to mill where the sheet material actually exists in the opening.\n\n## FAQ\n- **Q: Why don't I see any milling paths generated?**\n  **A:** Check if the `Zone` selected actually contains sheets in your element. Also, ensure the `Milling on [Location]` options are not set to \"No\".\n- **Q: How do I add a clearance gap for window foam tape?**\n  **A:** Set the `Offset milling around opening` parameter to the desired width of the gap (e.g., 5mm or 1/4\").\n- **Q: Can I change the CNC tool after creating the script?**\n  **A:** Yes, simply select the script instance and change the `Tooling index` in the Properties Palette. The update is immediate."
      },
      "tokens_used": 9269,
      "error": null
    }
  }
}