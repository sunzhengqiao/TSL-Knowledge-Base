{
  "filename": "BMF Column shoe vertically adjustable LS type.mcr",
  "status": "completed",
  "total_tokens": 29465,
  "processing_time": 328.3646779060364,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4398,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses _Beam.append(getBeam()) for selection, Body/Display/Point3d for 3D geometry construction, _Beam0.addTool(Cut) for modifying beam solids, and model()/material()/dxaout() for data generation. No sd_ prefixes, _Viewport checks, or #Type E declarations found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 3935,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "null",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "null",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Insertion",
            "title": "null",
            "dataSource": "Internal properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "prStrType",
            "type": "PropString",
            "displayName": "Type",
            "defaultValue": "LS 60x65",
            "inputType": "dropdown",
            "options": [
              "LS 60x65",
              "LS 60x165",
              "LS 80x90",
              "LS 80x190",
              "LB 60x65",
              "LB 60x165",
              "LB 80x90",
              "LB 80x190"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "prStrFixing",
            "type": "PropString",
            "displayName": "Fixing",
            "defaultValue": "nails",
            "inputType": "dropdown",
            "options": [
              "nails",
              "screws"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "prdExtH",
            "type": "PropDouble",
            "displayName": "Extra Beam Height",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "prdElev",
            "type": "PropDouble",
            "displayName": "Elevation",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4252,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 7367,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched",
          "2. Dynamic Dialog displayed for initial configuration (Type, Fixing, Elevation, etc.)",
          "3. User prompted to select a GenBeam",
          "4. User prompted to click an insertion point (_Pt0) on the beam",
          "5. Script identifies the Shoe Type index based on the 'Type' property",
          "6. Script checks if the Type index is valid",
          "7. Branch execution: Determine geometry based on Type (LS vs LB)",
          "8. Generate hardware bodies (Base plate, Rods, Nuts, Bottom/Lateral plates)",
          "9. Apply Cut operation to the selected beam",
          "10. Assign Model, Material, and Designation data"
        ],
        "conditionalBranches": [
          {
            "condition": "Check if Shoe Type index is greater than 3 (i.e., LB Types vs LS Types)",
            "path1": {
              "name": "LB Type Construction (Indices 4-7)",
              "steps": [
                "Calculate reference point including Base Plate offset",
                "Draw Base Plate (thickness dSth2)",
                "Draw Drill (length dSb)",
                "Draw Nut 1 and Nut 2",
                "Draw Bottom Plate (thickness dSth1)",
                "Cut the beam at current reference point",
                "Draw Lateral Plate"
              ]
            },
            "path2": {
              "name": "LS Type Construction (Indices 0-3)",
              "steps": [
                "Calculate reference point (no Base Plate offset)",
                "Draw Drill (length dSs)",
                "Draw Nut 1 and Nut 2",
                "Draw Bottom Plate (thickness dSth1)",
                "Draw Lateral Plate",
                "Cut the beam at reference point"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Verify the selected 'Type' property exists in the internal array (arStrType)",
            "errorMessage": "\nShoe cannot be used!",
            "recovery": "The script instance is erased. User must restart and select a valid Type from the dropdown list."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Shoe Configuration",
            "how": "OPM (Properties Palette)",
            "effect": "Modifying 'Type', 'Fixing', 'Extra Beam Height', or 'Elevation' triggers a recalculation, regenerating the geometry and cut."
          }
        ]
      },
      "tokens_used": 5728,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# BMF Column shoe vertically adjustable LS type.mcr\n\n## Overview\nThis script generates a vertically adjustable column shoe (specifically LS and LB types) attached to a selected timber beam. It automatically creates the necessary hardware geometry, including base plates, rods, and nuts, and performs the required cut on the beam to accommodate the connection.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for 3D geometry creation and beam modification. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: GenBeam (Generic Beam)\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `BMF Column shoe vertically adjustable LS type.mcr`\n\n### Step 2: Initial Configuration\nA dialog will appear automatically upon insertion.\n```\nAction: Configure basic settings (Type, Fixing, etc.) in the dialog, or accept defaults to proceed.\n```\n\n### Step 3: Select Beam\n```\nCommand Line: Select a beam\nAction: Click on the timber beam (GenBeam) you wish to attach the column shoe to.\n```\n\n### Step 4: Define Insertion Point\n```\nCommand Line: Specify insertion point\nAction: Click on the beam to define the exact location for the column shoe.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | dropdown | LS 60x65 | Selects the shoe profile (LS or LB series). Options include various size combinations (e.g., LS 60x65, LB 80x190). |\n| Fixing | dropdown | nails | Specifies the type of fasteners to be used. Options: nails, screws. |\n| Extra Beam Height | number | 0 | Adjusts the beam height calculation/cut by this additional amount. |\n| Elevation | number | 0 | Vertically adjusts the position of the column shoe. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not use external settings files; all configurations are handled via properties.\n\n## Tips\n- **Switching Types**: You can switch between LS and LB types via the Properties Palette (OPM) after insertion. This regenerates the geometry automatically (LS types do not include a base plate offset, while LB types do).\n- **Error Handling**: If you manually enter a Type that does not exist in the internal list, the script will erase the instance and display \"Shoe cannot be used!\". Always select from the dropdown list.\n\n## FAQ\n- **Q: Can I adjust the shoe height after placing it?**\n  - A: Yes, use the **Elevation** parameter in the Properties Palette to move the shoe vertically.\n- **Q: What is the difference between LS and LB types?**\n  - A: The script generates different geometry for these groups. LS types (Indices 0-3) are constructed without a base plate offset, whereas LB types (Indices 4-7) include calculations for a base plate thickness.\n- **Q: Why did the script disappear when I changed the Type?**\n  - A: This likely occurs if an invalid type was selected. Ensure the type selected matches the predefined options in the dropdown list exactly."
      },
      "tokens_used": 3785,
      "error": null
    }
  }
}