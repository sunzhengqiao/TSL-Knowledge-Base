{
  "filename": "hsbOpeningBattens.mcr",
  "status": "completed",
  "total_tokens": 49671,
  "processing_time": 417.89576530456543,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "24.11.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-13478: add hidden property to store selected painterdefinition"
          },
          {
            "version": "1.0",
            "date": "04jan2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-9991 splitting of top batten added"
          },
          {
            "version": "0.1",
            "date": "18dec2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-9991 first beta"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8555,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script explicitly uses _kModelSpace during instance creation. It interacts with physical entities (OpeningSF, ElementWallSF, Beam, Sheet) and generates 3D geometry (Body, PlaneProfile). It does not contain ShopDrawing prefixes (sd_), _Viewport checks, or SD-specific entity types."
        },
        "prerequisites": {
          "requiredEntities": [
            "Opening",
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "PainterDefinition collection named 'OpeningBattens' (Script creates defaults if missing)"
          ]
        }
      },
      "tokens_used": 7349,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select openings and/or elements|",
              "condition": "_bOnInsert",
              "required": true,
              "details": "Allows selection of ElementWallSF and OpeningSF entities."
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "_bOnInsert (standard mode) or _bOnMapIO",
            "title": "Properties",
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "|Zone|",
            "defaultValue": 6,
            "inputType": "dropdown",
            "options": [
              -5,
              -4,
              -3,
              -2,
              -1,
              0,
              1,
              2,
              3,
              4,
              5
            ],
            "category": "|General|",
            "description": "|Defines the Zone|"
          },
          {
            "index": 0,
            "variable": "dWidth",
            "type": "PropDouble",
            "displayName": "|Width|",
            "defaultValue": 0,
            "inputType": "number",
            "category": "|General|",
            "description": "|Defines the Width|, |0 = byZone|"
          },
          {
            "index": 1,
            "variable": "dOffset",
            "type": "PropDouble",
            "displayName": "|Offset|",
            "defaultValue": 0,
            "inputType": "number",
            "category": "|General|",
            "description": "|Defines the Offset|"
          },
          {
            "index": 0,
            "variable": "sPainter",
            "type": "PropString",
            "displayName": "|Opening Painter|",
            "defaultValue": "<|Disabled|>",
            "inputType": "dropdown",
            "options": [
              "<|Disabled|>",
              "[Dynamic Painter List from 'OpeningBattens' collection]"
            ],
            "category": "|Filter|",
            "description": "|Defines the Painter definition to filter openings|"
          },
          {
            "index": 1,
            "variable": "sPainterStream",
            "type": "PropString",
            "displayName": "|Painter Definition|",
            "defaultValue": "",
            "inputType": "text",
            "category": "|General|",
            "description": "|Stores the data of the used painter definition to copy the definition via catalog|",
            "visibility": "Hidden unless Debug mode is active"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9348,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates timber battens (trimming or stiffening members) around wall openings in a specific construction zone, including automatic splitting of intersecting sheets or beams at the top of the opening.",
          "category": "Framing/Finishing",
          "typicalUseCase": "Adding framing surrounds to windows or doors, installing drywall backers, or creating sub-sills and headers within a specific wall layer."
        },
        "parameters": [
          {
            "name": "nZone",
            "technicalDefault": "6",
            "businessMeaning": "Specifies the construction layer (zone) within the wall element where the battens will be generated. This determines the batten's position, height, and default material properties.",
            "validRange": "-5 to 5",
            "unit": "Index",
            "affectsOutput": "Sets the vertical height of the battens and their alignment in the wall cross-section. If Width is 0, this also sets the batten thickness."
          },
          {
            "name": "dWidth",
            "technicalDefault": "0",
            "businessMeaning": "Defines the thickness of the batten material. A value of 0 instructs the script to use the default width defined by the selected Zone's properties.",
            "validRange": "0 to 300 (0 = Zone Default)",
            "unit": "mm",
            "affectsOutput": "Controls the cross-sectional width (depth into the wall) of the generated beams."
          },
          {
            "name": "dOffset",
            "technicalDefault": "0",
            "businessMeaning": "Sets the clearance gap between the edge of the opening (e.g., window frame) and the inner face of the batten.",
            "validRange": "-50 to 50",
            "unit": "mm",
            "affectsOutput": "Moves the batten geometry outward (positive gap) or inward (negative overlap) relative to the opening perimeter."
          },
          {
            "name": "sPainter",
            "technicalDefault": "<Disabled>",
            "businessMeaning": "Filters which openings receive battens based on specific properties (e.g., 'Window', 'Door', or specific size constraints) defined in the 'OpeningBattens' painter collection.",
            "validRange": "List of Painter Definitions",
            "unit": "Selection",
            "affectsOutput": "Determines if battens are generated for a specific opening. If the opening does not match the painter rule, it is skipped."
          },
          {
            "name": "sPainterStream",
            "technicalDefault": "",
            "businessMeaning": "Internal storage for the painter configuration to allow settings to be saved and loaded via Catalogs.",
            "validRange": "N/A",
            "unit": "String",
            "affectsOutput": "None (configuration only)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "nZone is changed",
            "effect": "If dWidth is set to 0, the batten width updates to match the new Zone's width.",
            "cascade": [
              "dWidth"
            ]
          },
          {
            "trigger": "dWidth is set to 0",
            "effect": "The script ignores the manual width input and calculates it based on the nZone definition.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "Vertical and horizontal timber members surrounding the opening.",
            "appliedTo": "Openings filtered by the Painter definition within the specified Wall Element."
          },
          {
            "type": "Split Operation",
            "description": "Existing sheets or beams in the zone that intersect the top batten geometry are automatically split or cut to accommodate the batten.",
            "appliedTo": "GenBeams and Sheets found in the specified Zone."
          }
        ]
      },
      "tokens_used": 8652,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11173,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbOpeningBattens.mcr\n\n## Overview\nThis script automatically generates timber battens (framing members) around wall openings (windows and doors) in a specific construction zone. It also handles splitting existing sheets or beams at the top of the opening to accommodate the new framing.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script is designed for 3D model detailing. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | This script modifies the 3D model geometry. |\n\n## Prerequisites\n- **Required Entities**: At least one Wall Element (`ElementWallSF`) or Opening (`OpeningSF`) must exist in the model.\n- **Minimum Beam Count**: 0\n- **Required Settings**: A Painter Definition collection named 'OpeningBattens' is expected. The script will create default entries if this collection is missing.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse to and select `hsbOpeningBattens.mcr`\n\n### Step 2: Select Openings/Elements\n```\nCommand Line: Select openings and/or elements\nAction: Click on the wall openings or the wall elements themselves where you want to install battens. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Properties\nAfter selection, the Properties palette will appear. Adjust the parameters (see below) to define the size, position, and filtering logic for the battens. The script will update automatically as you change values.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Zone | dropdown | 6 | Select the construction layer (Zone index from -5 to 5) where the battens will be placed. This determines height and default material. |\n| Width | number | 0 | Defines the thickness of the batten. Enter `0` to use the default width of the selected Zone. |\n| Offset | number | 0 | Defines the clearance gap between the opening edge and the batten. Use positive values for a gap and negative values for overlap. |\n| Opening Painter | dropdown | `<Disabled>` | Select a Painter Definition to filter which openings receive battens (e.g., only apply to \"Windows\"). |\n| Painter Definition | text | *Hidden* | Internal storage for the painter configuration (used for catalogs). |\n\n## Right-Click Menu Options\nThis script does not add specific custom options to the right-click context menu.\n\n## Settings Files\n- **Filename**: N/A (Uses internal defaults)\n- **Location**: N/A\n- **Purpose**: The script interacts with the hsbCAD Painter Definitions named \"OpeningBattens\". If these do not exist in your catalog, the script will generate them automatically.\n\n## Tips\n- **Zone Width**: If you want the battens to match the exact thickness of the wall layer (Zone), leave the **Width** property as `0`.\n- **Filtering**: Use the **Opening Painter** property to apply battens only to specific types of openings (e.g., apply to windows but skip doors) without selecting them individually.\n- **Splitting**: The script automatically calculates where the top batten sits and splits any existing structural beams or sheets in that zone, ensuring clean connections without manual interference.\n\n## FAQ\n- **Q: Why are no battens appearing even though I selected an opening?**\n- **A: Check the **Zone** setting. If the selected zone does not exist in the wall element, or if the **Opening Painter** is set to a rule that excludes your specific opening, no battens will be generated. Try setting **Opening Painter** to `<Disabled>` to see all openings.\n- **Q: How do I make the battens overlap the frame?**\n- **A: Enter a negative value in the **Offset** property (e.g., `-10` to move the batten 10mm into the opening)."
      },
      "tokens_used": 4594,
      "error": null
    }
  }
}