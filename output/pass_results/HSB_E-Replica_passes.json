{
  "filename": "HSB_E-Replica.mcr",
  "status": "completed",
  "total_tokens": 33810,
  "processing_time": 234.7542667388916,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": null,\n    \"majorVersion\": 4,\n    \"minorVersion\": 0,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"2.00\",\n      \"date\": \"28.01.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Redo the copy with the new function dbCopyEntitiesFrom\"\n    },\n    {\n      \"version\": \"2.01\",\n      \"date\": \"13.02.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Add option to add replica's and do check on element outline\"\n    },\n    {\n      \"version\": \"2.02\",\n      \"date\": \"20.02.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Add mirror option\"\n    },\n    {\n      \"version\": \"2.03\",\n      \"date\": \"24.02.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Change mirror option\"\n    },\n    {\n      \"version\": \"2.04\",\n      \"date\": \"10.03.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Get all entities from group\"\n    },\n    {\n      \"version\": \"2.05\",\n      \"date\": \"17.03.2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Do not recalc at dwgin\"\n    },\n    {\n      \"version\": \"2.06\",\n      \"date\": \"27.03"
      },
      "tokens_used": 6206,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script interacts directly with Element objects (e.g., mainElement.plEnvelope(), replicatedElement.subMapX) and checks types like ElementWall(). It uses Map storage (_Map) which is typical for Model Space logic. There are no sd_* prefixes, no Multipage logic, and no interaction with _Viewport or paper space entities. It also explicitly erases itself on manual insert (_bOnInsert), indicating it is an automated logic script running on elements within the 3D model."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "The script requires an environment with at least 2 Elements accessible via _Element array. It relies on specific Map data structures ('Hsb_production'/'Hsb_replicator') existing on the elements. It also expects a companion TSL script named 'HSB_E-Replicator' to be present on the main element to control execution.",
          "requiredSettings": [
            "Map 'Hsb_production' with sub-map 'Hsb_replicator' containing entity references and flags",
            "HSB_E-Replicator TSL instance on the main element"
          ]
        }
      },
      "tokens_used": 3202,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "reportWarning",
              "promptOriginal": "|This tsl can not be inserted manually|",
              "condition": "_bOnInsert",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dimStyle",
            "type": "PropString",
            "displayName": "|Dimension style|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": "",
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "textHeight",
            "type": "PropDouble",
            "displayName": "|Text height|",
            "defaultValue": 100,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Recalculate All|",
            "handler": "arSTrigger[0]",
            "action": "Triggers recalculation on the main Replicator TSL instance.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Delete Construction|",
            "handler": "arSTrigger[1]",
            "action": "Placeholder for delete logic (no specific code found in this snippet).",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Make element unique and delete tsl|",
            "handler": "arSTrigger[2]",
            "action": "Erases the current TSL instance to make the element unique.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Select new main element|",
            "handler": "arSTrigger[3]",
            "action": "Erases the current TSL instance.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Mirror|",
            "handler": "arSTrigger[4]",
            "action": "Toggles the 'isMirrored' flag for the replicated element.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Recalc|",
            "handler": "arSTrigger[5]",
            "action": "Triggers specific recalculation on the main Replicator TSL instance associated with the current element.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 4429,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Maintains a synchronized replica (copy) of a master element, handling visual indicators, mirroring logic, and the connection to the main 'Replicator' script.",
          "category": "Model Management / Logic",
          "typicalUseCase": "Creating multiple identical or mirrored walls/floors where design changes in the 'Main Element' must automatically propagate to the 'Replica' elements."
        },
        "parameters": [
          {
            "name": "dimStyle",
            "technicalDefault": "",
            "businessMeaning": "Defines the visual style (font, arrows, units) used for the labels indicating the replication status in the 3D model.",
            "validRange": "Any dimension style name currently loaded in the drawing (or empty for default)",
            "unit": "String",
            "affectsOutput": "Alters the appearance of the text and dimension markers drawn on the element envelope."
          },
          {
            "name": "textHeight",
            "technicalDefault": 100,
            "businessMeaning": "Sets the height of the text label used to display the Main Element number and mirroring status.",
            "validRange": "50 - 500 mm (Typical text sizes for 3D model visibility)",
            "unit": "mm",
            "affectsOutput": "Changes the size of the information label projected in 3D space."
          },
          {
            "name": "Mirror (Context Menu)",
            "technicalDefault": "false",
            "businessMeaning": "Toggles whether the replica is a geometric mirror image of the master element (e.g., switching a Left Gable to a Right Gable).",
            "validRange": "true / false",
            "unit": "Boolean",
            "affectsOutput": "Geometrically mirrors the replica's construction and beams relative to the master element."
          },
          {
            "name": "Recalculate All (Context Menu)",
            "technicalDefault": "N/A",
            "businessMeaning": "Forces a complete refresh of the replication logic on the Master Element.",
            "validRange": "N/A",
            "unit": "Action",
            "affectsOutput": "Updates all replicas to match the current state of the master."
          },
          {
            "name": "Make element unique and delete tsl (Context Menu)",
            "technicalDefault": "N/A",
            "businessMeaning": "Breaks the link between this element and the master, converting it into a standalone, independent element.",
            "validRange": "N/A",
            "unit": "Action",
            "affectsOutput": "Removes the replication script and stops the element from updating based on the master."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Executing 'Mirror' from context menu",
            "effect": "Toggles the 'isMirrored' state and sends a trigger to the Main Element to re-process the geometry.",
            "cascade": [
              "replicatedElement geometry",
              "Main Element Replicator script"
            ]
          },
          {
            "trigger": "Executing 'Make element unique'",
            "effect": "Erases the current TSL instance and cleans up Map data ('Hsb_replicator') from the element.",
            "cascade": [
              "Hsb_replicator Map",
              "Synchronization logic"
            ]
          },
          {
            "trigger": "Changing 'dimStyle' or 'textHeight'",
            "effect": "Refreshes the Display object to reflect new visual settings.",
            "cascade": [
              "Visualization Display"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Visualization / Display",
            "description": "Draws the element envelope (plEnvelope) and a text label indicating the Main Element number and Mirror status in the 3D model.",
            "appliedTo": "The current Element (The Replica)"
          }
        ]
      },
      "tokens_used": 6597,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script Execution starts\",\n    \"Check insertion method (Manual vs Automatic)\",\n    \"Load configuration maps ('Hsb_production', 'Hsb_replicator')"
      },
      "tokens_used": 8403,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-Replica.mcr\n\n## Overview\nThis script maintains a synchronized \"Replica\" of a master element (Main Element). It handles the geometric copying and mirroring logic, ensuring that changes made to the Main Element are automatically propagated to this element, while displaying the connection status visually in the 3D model.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on Elements within the 3D model. |\n| Paper Space | No | Not intended for 2D layouts or drawings. |\n| Shop Drawing | No | Does not generate manufacturing views. |\n\n## Prerequisites\n- **Required Entities:** \n  - A \"Main Element\" with the `HSB_E-Replicator` script applied.\n  - A target \"Replica Element\" to which this script is applied.\n- **Minimum beam count:** 0 (Dependent on the content of the Main Element).\n- **Required settings:** \n  - The script relies on Map data (`Hsb_production` / `Hsb_replicator`) created by the Main Element.\n\n## Usage Steps\n\n### Step 1: Automatic Application\n**Command:** N/A\n**Action:** This script is typically applied automatically when you use the `HSB_E-Replicator` tool on a Main Element to generate copies. \n*Note: Attempting to insert this script manually via the command line will display a warning that it cannot be inserted manually.*\n\n### Step 2: Verify Status\n**Action:** Select the Replica element in the model. You should see a visual label (text) on the element envelope indicating the number of the Main Element it is linked to.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension style | dropdown | | Selects the visual style (arrows, text font) for the labels drawn in the model to indicate the replication link. |\n| Text height | number | 100 | Sets the height (in mm) of the text label displaying the Main Element number and mirror status. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate All | Forces the Main Element to refresh and update all connected Replica elements. |\n| Delete Construction | Placeholder option for construction cleanup. |\n| Make element unique and delete tsl | Breaks the link to the Main Element. The script will erase itself, and the element will become a standalone, unique element that no longer updates automatically. |\n| Select new main element | Removes the current script instance, allowing you to link this element to a different Main Element. |\n| Mirror | Toggles the mirror status. If active, the replica geometry is mirrored (e.g., converting a left wall to a right wall) relative to the Main Element. |\n| Recalc | Triggers a refresh of the replication logic specifically for this element. |\n\n## Settings Files\nThis script does not use external XML settings files. It stores configuration data directly in the Element's Map properties.\n\n## Tips\n- **Breaking the Link:** If you need to modify a specific wall without affecting the others, right-click the Replica element and select **Make element unique and delete tsl**.\n- **Mirroring:** Use the **Mirror** context menu option to quickly create opposite hand walls (e.g., Left vs. Right Gable) that stay synchronized with the master design.\n- **Visibility:** If the text labels are too small to read in the 3D model, increase the **Text height** property in the Properties Palette.\n\n## FAQ\n- **Q: Why does the script disappear when I insert it?**\n  - A: This script is designed for automated management only. It must be applied via the `HSB_E-Replicator` script running on the Main Element.\n- **Q: How do I stop the replica from updating when I change the master?**\n  - A: Select the replica, right-click, and choose **Make element unique and delete tsl**. This converts it into a standard, independent element."
      },
      "tokens_used": 4973,
      "error": null
    }
  }
}