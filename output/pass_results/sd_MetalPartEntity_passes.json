{
  "filename": "sd_MetalPartEntity.mcr",
  "status": "completed",
  "total_tokens": 46134,
  "processing_time": 615.4614036083221,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.2",
            "date": "11.03.2011",
            "author": "th@hsbCAD.de",
            "changes": "bugfix assembly dimensions alignment\nthe metalpart collection may now be composed by genbeams and not only beams"
          },
          {
            "version": "1.1",
            "date": "25.10.2010",
            "author": "th@hsbCAD.de",
            "changes": "assembly dimensions limited to entities parallel/ perpendicular to the the ent coordSys"
          },
          {
            "version": "1.0",
            "date": "19.10.2010",
            "author": "th@hsbCAD.de",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8561,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": false,
          "detectionEvidence": "Script filename uses 'sd_' prefix indicating ShopDrawing usage. Documentation explicitly states 'This tsl is only executed by the shopdraw engine'. Code contains '_bOnGenerateShopDrawing' flag check. Script handles 'DimRequestPoint' and 'DimRequestPLine' entities which are specific to shop drawing generation. It consumes '_Entity[]' which is characteristic of ShopDrawing scripts attached to entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "MetalPartCollectionEnt"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Must be run within the ShopDrawing engine (Paper Space), typically appended to the ruleset of a multipage style.",
          "requiredSettings": []
        }
      },
      "tokens_used": 5699,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getEntity",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Shown on MapIO (_bOnMapIO)",
            "title": "---",
            "dataSource": "Local PropString and PropDouble variables",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "ChainContentDrill",
            "type": "PropString",
            "displayName": "Chain Content Drill",
            "defaultValue": "Chain Dimension",
            "inputType": "dropdown",
            "options": [
              "Chain Dimension",
              "Chain Dimension with Diameter",
              "Diameter only",
              "Diameter only at Start"
            ],
            "category": null,
            "description": "Defines the text content of the chain dimension points"
          },
          {
            "index": 1,
            "variable": "DiameterUnit",
            "type": "PropString",
            "displayName": "Diameter Units",
            "defaultValue": "DWG Unit",
            "inputType": "dropdown",
            "options": [
              "DWG Unit",
              "m",
              "cm",
              "mm",
              "in",
              "ft"
            ],
            "category": null,
            "description": "Sets the unit for any text which displays diameter or radius values"
          },
          {
            "index": 1,
            "variable": "offsetBaselineContour",
            "type": "PropDouble",
            "displayName": "Offset Dimline Contour",
            "defaultValue": "800",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "The offset of the dimension line to the dimensioned object (0 = do not show)"
          },
          {
            "index": 2,
            "variable": "offsetBaselineExtremes",
            "type": "PropDouble",
            "displayName": "Offset Dimline Extremes",
            "defaultValue": "1400",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "The offset of the dimension line to the dimensioned object (0 = do not show)"
          },
          {
            "index": 3,
            "variable": "offsetBaselineDrill",
            "type": "PropDouble",
            "displayName": "Offset Dimline Drills",
            "defaultValue": "200",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "The offset of the dimension line to the dimensioned object (0 = do not show)"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7318,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically generates detailed shop drawing dimensions for Metal Part Collections, including overall extents, internal sub-assembly contours, and drill hole positions with diameters.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"Used during the generation of production drawings for metal connection plates or assemblies to annotate hole spacing and part geometry without manual drafting.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"ChainContentDrill\",\n      \"technicalDefault\": \"Chain Dimension\",\n      \"businessMeaning\": \"Determines what information is displayed at each drill hole position within a chain dimension (e.g., just the distance, or distance plus diameter).\",\n      \"validRange\": \"Chain Dimension, Chain Dimension with Diameter, Diameter only, Diameter only at Start\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Changes the text labels on the dimension line marking drill holes. If multiple different drill diameters exist on the part, the script forces this to 'Chain Dimension' or 'Diameter only' to prevent errors.\"\n    },\n    {\n      \"name\": \"DiameterUnit\",\n      \"technicalDefault\": \"DWG Unit\",\n      \"businessMeaning \"Sets the unit of measurement for the numeric value of drill diameters displayed in the drawing.\",\n      \"validRange\": \"DWG Unit, m, cm, mm, in, ft\",\n      \"unit\": \"Length Unit\",\n      \"affectsOutput\": \"Converts the displayed drill diameter text to the specified unit (e.g., displaying 10mm as 0.01m or 0.394in).\"\n    },\n    {\n      \"name\": \"offsetBaselineContour\",\n      \"technicalDefault\": \"800\",\n      \"businessMeaning\": \"The distance from the metal part's edge to the dimension line that describes internal assembly contours or sub-components.\",\n      \"validRange\": \"0 to ~2000 (0 disables this dimension line)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the 'Contour' dimension line inward or outward. Setting this to 0 suppresses the internal contour dimensions.\"\n    },\n    {\n      \"name\": \"offsetBaselineExtremes\",\n      \"technicalDefault\": \"1400\",\n      \"businessMeaning\": \"The distance from the metal part's edge to the outermost dimension line that describes the overall maximum extents (width/height).\",\n      \"validRange\": \"0 to ~3000 (0 disables this dimension line)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the 'Extremes' dimension line (usually the outer-most line). Setting this to 0 suppresses the overall dimensions.\"\n    },\n    {\n      \"name\": \"offsetBaselineDrill\",\n      \"technicalDefault\": \"200\",\n      \"businessMeaning\": \"The distance from the metal part's edge to the dimension line specifically used for detailing drill hole positions.\",\n      \"validRange\": \"0 to ~2000 (0 disables this dimension line)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the 'Drill' dimension line (typically the inner-most line relative to the part). Setting this to 0 suppresses drill dimensions.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"Multiple distinct drill diameters detected in the MetalPart\",\n      \"effect\": \"The script automatically simplifies the 'ChainContentDrill' setting. Options that imply a single diameter for all points (like 'Diameter only at Start') are changed to 'Diameter only' or 'Chain Dimension'.\",\n      \"cascade\": [\n        \"ChainContentDrill\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"DimRequestPoint\",\n      \"description\": \"Points defining the nodes of chain dimensions. Stereotypes include 'Extremes' (overall size), 'Contour' (internal assembly), and 'Drill' (hole centers).\",\n      \"appliedTo\": \"MetalPartCollection\"\n    },\n    {\n      \"type\": \"DimRequestPLine\",\n      \"description\": \"Polylines used to visualize projection lines (typically for debugging purposes).\",\n      \"appliedTo\": \"MetalPartCollection\"\n    }\n  ]\n}\n```"
      },
      "tokens_used": 7948,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11267,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# sd_MetalPartEntity.mcr\n\n## Overview\nThis script automatically generates detailed shop drawing dimensions for metal connection plates and assemblies. It creates dimensions for overall extents, internal sub-assembly contours, and drill hole positions, including specific diameter annotations.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is not intended for use in the 3D model. |\n| Paper Space | Yes | Executed automatically by the Shop Drawing engine during drawing generation. |\n| Shop Drawing | Yes | Designed specifically to run within the shop drawing generation process. |\n\n## Prerequisites\n- **Required Entities**: Metal Part Collection (`MetalPartCollectionEnt`).\n- **Minimum Beam Count**: N/A (Script targets metal parts/plates).\n- **Required Settings**: None. Must be appended to the ruleset of a Multipage Shop Drawing style.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `sd_MetalPartEntity.mcr`\n*(Note: This script is typically run automatically by the Shop Drawing engine. Manual insertion is primarily for testing.)*\n\n### Step 2: Select Entity\n```\nCommand Line: Select Entity:\nAction: Click on the Metal Part Collection entity in the drawing that you wish to dimension.\n```\n\n### Step 3: Specify Insertion Point\n```\nCommand Line: Specify Insertion Point:\nAction: Click in the drawing to place the script entity.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Chain Content Drill | dropdown | Chain Dimension | Determines what information is displayed at drill hole positions. Options: Chain Dimension, Chain Dimension with Diameter, Diameter only, Diameter only at Start. |\n| Diameter Unit | dropdown | DWG Unit | Sets the unit of measurement for displayed drill diameters (e.g., mm, inch). Options: DWG Unit, m, cm, mm, in, ft. |\n| Offset Dimline Contour | number | 800 | The offset distance from the metal part edge to the dimension line for internal assembly contours. Set to 0 to hide this dimension. |\n| Offset Dimline Extremes | number | 1400 | The offset distance from the metal part edge to the dimension line for overall maximum extents (width/height). Set to 0 to hide this dimension. |\n| Offset Dimline Drills | number | 200 | The offset distance from the metal part edge to the dimension line for drill holes. Set to 0 to hide this dimension. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are added by this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external settings files.\n\n## Tips\n- **Controlling Dimension Visibility**: You can toggle specific dimension lines on or off by setting their respective \"Offset\" properties to `0`.\n- **Dimension Layering**: To prevent dimension lines from overlapping, adjust the offset values. Generally, set \"Offset Dimline Drills\" smallest (closest to part) and \"Offset Dimline Extremes\" largest (farthest from part).\n- **Multiple Drill Sizes**: If the metal part contains drill holes with different diameters, the script will automatically override the \"Chain Content Drill\" setting to \"Chain Dimension\" or \"Diameter only\" to prevent labeling errors.\n\n## FAQ\n- **Q: Why are my drill dimension labels not showing the diameters as configured?**\n  **A:** If the metal part has multiple different drill diameters, the script automatically simplifies the labeling logic. Options like \"Diameter only at Start\" are incompatible with mixed diameters and will be ignored in favor of safer options.\n- **Q: How do I hide the overall dimensions but keep the drill dimensions?**\n  **A:** Change the property `Offset Dimline Extremes` to `0`. Ensure `Offset Dimline Drills` is set to a value greater than 0 (e.g., 200)."
      },
      "tokens_used": 5341,
      "error": null
    }
  }
}