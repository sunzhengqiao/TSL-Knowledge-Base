{
  "filename": "SwapBeamWidthHeight.mcr",
  "status": "completed",
  "total_tokens": 17502,
  "processing_time": 171.2856216430664,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "07.12.2022",
            "author": "Thorsten Huck",
            "changes": "HSB-17248 new command to switch Y- and Z-Axis but keep geometry in space"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3676,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `PrEntity` to select `Beam()` objects directly from the drawing, processes geometry via `dW()` and `dH()`, and pushes CAD commands (`_HSB_BEAMSWITCHYZ`). No `sd_` functions, `_Viewport` checks, or Shop Drawing entities (`_Entity[]`) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing existing Beam entities",
          "requiredSettings": []
        }
      },
      "tokens_used": 1326,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1807,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Rotates the cross-section of selected beams by swapping their width and height values while maintaining their original position in 3D space.",
          "category": "Edit/Modification",
          "typicalUseCase": "Used when a beam was drawn with the incorrect orientation (e.g., lying flat instead of standing upright) and needs to be corrected without deleting and redrawing the element."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Empty selection",
            "businessMeaning": "The set of structural timber beams (Glulam, CLT, Solid Timber) selected by the user to have their cross-sectional dimensions swapped.",
            "validRange": "1 or more existing Beam entities in Model Space",
            "unit": "Entities",
            "affectsOutput": "Identifies which beams will have their Width (Y-axis) and Height (Z-axis) dimensions exchanged and their local coordinate systems updated."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Beam (Modification)",
            "description": "The script modifies existing beams by swapping the Y and Z axis dimensions. It updates the geometry definition so the physical width becomes the height and vice versa, preserving the spatial location of the beam.",
            "appliedTo": "All entities contained within the user selection set 'ssE'."
          }
        ]
      },
      "tokens_used": 3083,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script initialized via command call",
          "2. Check insertion cycle count",
          "3. [Conditional] If cycle count > 1, erase instance and exit immediately",
          "4. Prompt user to select beams using PrEntity",
          "5. [Conditional] Validate user selection (Success vs Cancel/Empty)",
          "6. If selection valid: Iterate through all selected beams in the selection set",
          "7. For each beam: Retrieve current Width (Y-axis) and Height (Z-axis)",
          "8. For each beam: Swap values (Set Y dimension to old Height, Set Z dimension to old Width)",
          "9. For each beam: Push native CAD command '_HSB_BEAMSWITCHYZ' to command stack with beam handle",
          "10. Erase script instance from drawing",
          "11. Exit"
        ],
        "conditionalBranches": [
          {
            "condition": "Check for recursive calculation cycles",
            "path1": {
              "name": "Subsequent Cycle",
              "steps": [
                "Detect insertCycleCount() > 1",
                "Execute eraseInstance()",
                "Return (Stop script)"
              ]
            },
            "path2": {
              "name": "Initial Run",
              "steps": [
                "Detect insertCycleCount() == 1",
                "Proceed to prompt user for beam selection"
              ]
            }
          },
          {
            "condition": "User Selection Validation",
            "path1": {
              "name": "Valid Selection",
              "steps": [
                "ssE.go() returns true",
                "Populate beams array",
                "Execute dimension swapping loop",
                "Push CAD commands to stack",
                "Erase instance"
              ]
            },
            "path2": {
              "name": "Cancel/No Selection",
              "steps": [
                "ssE.go() returns false",
                "Skip processing loop",
                "Erase instance"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Type Selection",
            "errorMessage": "Implicit standard error (e.g., 'Invalid selection' or prompt repetition)",
            "recovery": "User must select at least one entity of type Beam or press Esc to cancel."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script Self-Deletes)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after pushing commands. There are no OPM properties or context menu items to interact with post-insertion. The changes are applied immediately to the selected beams via the pushed CAD commands."
          }
        ]
      },
      "tokens_used": 3840,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# SwapBeamWidthHeight.mcr\n\n## Overview\nThis script allows you to rotate the cross-section of selected timber beams by swapping their width and height values. It corrects the beam orientation (e.g., changing a beam from lying flat to standing upright) while keeping the beam's position in the 3D model exactly the same.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in Model Space where beam entities exist. |\n| Paper Space | No | Not supported in layouts. |\n| Shop Drawing | No | This is a model modification tool, not a detailing tool. |\n\n## Prerequisites\n- **Required Entities**: At least one existing Beam (Glulam, CLT, Solid Timber) in the drawing.\n- **Minimum Beam Count**: 1 (Multiple beams can be selected at once).\n- **Required Settings Files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the AutoCAD command line.\n2. Navigate to the folder containing `SwapBeamWidthHeight.mcr`.\n3. Select the file and click **Open**.\n\n### Step 2: Select Beams\n```\nCommand Line: Select beams\nAction: Click on the beam(s) you wish to modify, then press Enter.\n```\n*Note: You can select multiple beams using a window selection or by picking them individually.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose any properties in the AutoCAD Properties Palette. It runs immediately upon selection. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add any custom options to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Quick Correction**: Use this tool when you realize a beam was drawn with the wrong rotation (e.g., the width is actually the height).\n- **No Geometry Movement**: The script only updates the profile dimensions and orientation data; it does not move the start or end points of the beam.\n- **Self-Deleting**: The script instance removes itself from the drawing immediately after processing, so you do not need to delete it manually.\n\n## FAQ\n- **Q: Can I use this on curved beams?**\n  - A: Yes, as long as the entity is recognized as a standard Beam in hsbCAD, the cross-section dimensions will be swapped.\n- **Q: Does this affect the material or machining?**\n  - A: The script only swaps the width (Y-axis) and height (Z-axis). If your material or machining rules are dimension-dependent, they will update to the new dimensions automatically.\n- **Q: Why did the script disappear after I ran it?**\n  - A: This is a \"command\" style script designed to perform an action and then clean itself up. The changes are applied directly to the selected beams."
      },
      "tokens_used": 3770,
      "error": null
    }
  }
}