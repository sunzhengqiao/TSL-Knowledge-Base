{
  "filename": "DialogExample.mcr",
  "status": "completed",
  "total_tokens": 39360,
  "processing_time": 232.63569831848145,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6154,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_* or Multipage* prefix found. No _Viewport or #Type E usage detected. Script execution is wrapped in 'if (_bOnInsert)' followed by 'eraseInstance()', indicating it runs purely for logic execution/UI display without creating graphical elements in any specific space."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "None (Dialog/Utility script)",
          "requiredSettings": [
            "TslUtilities.dll located at _kPathHsbInstall + \"\\Utilities\\DialogService\\TslUtilities.dll\""
          ]
        }
      },
      "tokens_used": 4476,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "SelectFromList",
            "trigger": "Variable bListSelector (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "Map mpItems (containing Strings and Maps with ToolTips)",
            "features": {
              "searchable": true,
              "multiSelect": true
            }
          },
          {
            "type": "ShowMultilineNotice",
            "trigger": "After SelectFromList (if bListSelector and bNotice enabled)",
            "title": "**Custom Title**",
            "dataSource": "Map containing the Selection and SelectedIndex from previous dialog",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "SelectOption",
            "trigger": "Variable bOptions (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "Map mpItems (reused from SelectFromList)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "GetText",
            "trigger": "Variable bText (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "User input",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "AskYesNo",
            "trigger": "Variable bAsk (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "Question: 'Do you like Jimmy?'",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "AskYesNo",
            "trigger": "Variable bYesNo (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "Question: 'Do you like Jimmy?' with custom buttons",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "ShowNotice",
            "trigger": "Variable bNotice (currently disabled)",
            "title": "**Custom Title**",
            "dataSource": "String: 'You are using a super awesome dialog service'",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "ShowMultilineNotice",
            "trigger": "Variable bMultiNotice (currently disabled)",
            "title": null,
            "dataSource": "Map containing 'Jimmy says Notice Me!', Double 4.2, and Vector3d",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "ShowDynamicDialog",
            "trigger": "Variable bDynamic (enabled by default)",
            "title": "Dynamic Dialog",
            "dataSource": "Generated Rows and Columns via Map",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7806,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A developer utility script used to demonstrate and test the various User Interface (UI) dialog capabilities available in the TslUtilities.dll, such as list selection, text input, and dynamic forms.",
          "category": "Utility/Debug",
          "typicalUseCase": "Used by TSL developers to copy code snippets for dialog implementations or to verify that the TslUtilities.dll is functioning correctly in the current environment."
        },
        "parameters": [
          {
            "name": "bListSelector",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of the searchable multi-selection list dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'SelectFromList' dialog appears during script execution."
          },
          {
            "name": "bOptions",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of the single-selection radio button dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'SelectOption' dialog appears during script execution."
          },
          {
            "name": "bText",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of the simple text input dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'GetText' dialog appears during script execution."
          },
          {
            "name": "bNotice",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of the simple notification message dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'ShowNotice' dialog appears during script execution."
          },
          {
            "name": "bMultiNotice",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of the multi-line notice dialog, which can display various data types.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'ShowMultilineNotice' dialog appears during script execution."
          },
          {
            "name": "bAsk",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of a standard Yes/No question dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'AskYesNo' dialog (standard) appears during script execution."
          },
          {
            "name": "bYesNo",
            "technicalDefault": "false (0)",
            "businessMeaning": "Flag to enable or disable the demonstration of a Yes/No question dialog with custom button labels and tooltips.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'AskYesNo' dialog (custom) appears during script execution."
          },
          {
            "name": "bDynamic",
            "technicalDefault": "true (1)",
            "businessMeaning": "Flag to enable or disable the demonstration of the complex dynamic data grid dialog.",
            "validRange": "0 (Disabled) or 1 (Enabled)",
            "unit": "Boolean",
            "affectsOutput": "Determines whether the 'ShowDynamicDialog' (Data Grid) appears during script execution."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": []
      },
      "tokens_used": 5989,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script is launched (Inserted or Run)",
          "Global flags are initialized (bDynamic=true, others false)",
          "System enters '_bOnInsert' block (Insertion mode)",
          "DLL path and method names are defined for TslUtilities",
          "Input Map 'mpListIn' is prepared with sample items (Strings, Ints, Maps with ToolTips)",
          "[Conditional] If 'bListSelector' is true: Display 'SelectFromList' dialog and store result in 'mpOut'",
          "[Conditional] If 'bNotice' is true: Display 'ShowMultilineNotice' dialog using data from 'mpOut'",
          "[Conditional] If 'bOptions' is true: Display 'SelectOption' dialog (reusing 'mpListIn')",
          "[Conditional] If 'bText' is true: Display 'GetText' dialog",
          "[Conditional] If 'bAsk' is true: Display standard 'AskYesNo' dialog ('Do you like Jimmy?')",
          "[Conditional] If 'bYesNo' is true: Display custom 'AskYesNo' dialog ('He's Awesome' / 'Bad Jimmy')",
          "[Conditional] If 'bNotice' is true: Display standard 'ShowNotice' dialog",
          "[Conditional] If 'bMultiNotice' is true: Display 'ShowMultilineNotice' dialog with complex data types (String, Double, Vector3d)",
          "[Conditional] If 'bDynamic' is true: Generate Row/Column definitions and Display 'ShowDynamicDialog' (Data Grid)",
          "Script executes 'eraseInstance()'",
          "Script terminates (returns)"
        ],
        "conditionalBranches": [
          {
            "condition": "Flag 'bListSelector' is true",
            "path1": {
              "name": "Enable List Selector",
              "steps": [
                "Call 'SelectFromList' method",
                "Pass 'mpListIn' (Items, Title, Prompt)",
                "Capture output in 'mpOut'"
              ]
            },
            "path2": {
              "name": "Disable List Selector",
              "steps": [
                "Skip method call",
                "'mpOut' remains uninitialized"
              ]
            }
          },
          {
            "condition": "Flag 'bNotice' is true",
            "path1": {
              "name": "Enable Notice Dialogs",
              "steps": [
                "Display 'ShowMultilineNotice' using 'mpOut' data",
                "Display standard 'ShowNotice'"
              ]
            },
            "path2": {
              "name": "Disable Notice Dialogs",
              "steps": [
                "Skip both 'ShowMultilineNotice' and 'ShowNotice' calls"
              ]
            }
          },
          {
            "condition": "Flag 'bOptions' is true",
            "path1": {
              "name": "Enable Options Dialog",
              "steps": [
                "Call 'SelectOption' method",
                "Pass 'mpListIn'",
                "Report debug messages if 'bInDebug' is true"
              ]
            },
            "path2": {
              "name": "Disable Options Dialog",
              "steps": [
                "Skip method call"
              ]
            }
          },
          {
            "condition": "Flag 'bText' is true",
            "path1": {
              "name": "Enable Text Input",
              "steps": [
                "Call 'GetText' method",
                "Report debug messages if 'bInDebug' is true"
              ]
            },
            "path2": {
              "name": "Disable Text Input",
              "steps": [
                "Skip method call"
              ]
            }
          },
          {
            "condition": "Flag 'bAsk' is true",
            "path1": {
              "name": "Enable Standard Yes/No",
              "steps": [
                "Call 'AskYesNo' with standard question",
                "Report debug messages if 'bInDebug' is true"
              ]
            },
            "path2": {
              "name": "Disable Standard Yes/No",
              "steps": [
                "Skip method call"
              ]
            }
          },
          {
            "condition": "Flag 'bYesNo' is true",
            "path1": {
              "name": "Enable Custom Yes/No",
              "steps": [
                "Call 'AskYesNo' with custom prompts/tooltips",
                "Report debug messages if 'bInDebug' is true"
              ]
            },
            "path2": {
              "name": "Disable Custom Yes/No",
              "steps": [
                "Skip method call"
              ]
            }
          },
          {
            "condition": "Flag 'bMultiNotice' is true",
            "path1": {
              "name": "Enable Multi-line Notice",
              "steps": [
                "Call 'ShowMultilineNotice' with Map containing String, Double, Vector3d",
                "Report debug messages if 'bInDebug' is true"
              ]
            },
            "path2": {
              "name": "Disable Multi-line Notice",
              "steps": [
                "Skip method call"
              ]
            }
          },
          {
            "condition": "Flag 'bDynamic' is true",
            "path1": {
              "name": "Enable Dynamic Dialog",
              "steps": [
                "Configure 'mpDialogConfig' (Width, Height, Min/Max dimensions)",
                "Define Column Definitions (Label, TextBox, CheckBox, ComboBox, IntegerBox, DoubleBox)",
                "Loop to generate 5 Row Definitions with dummy data",
                "Call 'ShowDynamicDialog'"
              ]
            },
            "path2": {
              "name": "Disable Dynamic Dialog",
              "steps": [
                "Skip method call"
              ]
            }
          }
        ],
        "validationRules": [],
        "postInsertionActions": []
      },
      "tokens_used": 8282,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# DialogExample.mcr\n\n## Overview\nThis script is a developer utility designed to demonstrate and test the various User Interface (UI) dialog capabilities provided by the `TslUtilities.dll`. It allows users to preview different dialog types—such as selection lists, text inputs, and dynamic data grids—without generating any geometric elements.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment for the script. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: None.\n- **Minimum Beam Count**: 0.\n- **Required Settings**: The script requires `TslUtilities.dll` to be located at `_kPathHsbInstall + \"\\Utilities\\DialogService\\TslUtilities.dll\"`.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  Type `TSLINSERT` in the AutoCAD command line.\n2.  Select `DialogExample.mcr` from the catalog list.\n\n### Step 2: Configure Dialog Options\nBefore placing the script in the drawing:\n1.  Open the **Properties Palette** (Ctrl+1) if not already open.\n2.  With the script command active, look for the \"Parameters\" section in the Properties Palette.\n3.  By default, only `bDynamic` is set to `1` (True). Change the values of the parameters below to `1` to enable specific dialog demonstrations.\n    *   *Note: The script will erase itself immediately after execution, so parameters must be set before the script finishes running.*\n\n### Step 3: Execute Script\n1.  Click in the Model Space to insert the script instance.\n2.  The selected dialog(s) will appear on the screen.\n3.  Interact with the dialog (select items, enter text, or click options).\n4.  Click OK or Cancel on the dialog.\n5.  The script instance will automatically erase itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| bListSelector | Boolean (0/1) | 0 | If set to 1, displays a searchable, multi-selection list dialog. |\n| bOptions | Boolean (0/1) | 0 | If set to 1, displays a radio-button style selection dialog. |\n| bText | Boolean (0/1) | 0 | If set to 1, displays a simple text input dialog. |\n| bNotice | Boolean (0/1) | 0 | If set to 1, displays a simple notification message. If `bListSelector` is also active, this notice will show the results of the list selection. |\n| bMultiNotice | Boolean (0/1) | 0 | If set to 1, displays a multi-line notice dialog capable of showing different data types (String, Number, Coordinates). |\n| bAsk | Boolean (0/1) | 0 | If set to 1, displays a standard Yes/No question dialog (\"Do you like Jimmy?\"). |\n| bYesNo | Boolean (0/1) | 0 | If set to 1, displays a custom Yes/No dialog with specific button labels (\"He's Awesome\" / \"Bad Jimmy\"). |\n| bDynamic | Boolean (0/1) | 1 | If set to 1, displays a complex dynamic data grid dialog with various input types (labels, text boxes, checkboxes, etc.). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific items to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None (XML configuration not used).\n- **Dependency**: `TslUtilities.dll` (Required for UI functions).\n\n## Tips\n- **Parameter Speed**: Since the script erases itself instantly, it is often easier to modify the parameters by selecting the script name in the insert dialog *before* clicking into the drawing, or by having the Properties Palette active and ready.\n- **Debugging**: If dialogs do not appear, ensure the `TslUtilities.dll` is present in the correct `Utilities\\DialogService` folder of your hsbCAD installation.\n- **Data Grid**: The `bDynamic` parameter demonstrates the most complex UI element, showing how data grids are constructed programmatically.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I inserted it?**\n- A: This is intended behavior. The script is designed to demonstrate the UI logic and then execute `eraseInstance()` to clean up the drawing.\n- **Q: How can I see multiple dialogs at once?**\n- A: Set multiple parameters (e.g., `bListSelector` and `bAsk`) to `1` in the Properties Palette before inserting. They will appear sequentially.\n- **Q: I changed a parameter to 1, but the dialog didn't show up.**\n- A: Ensure you changed the parameter *before* the script finished inserting. If the script disappears before you can change the setting, re-insert it and change the setting in the Properties Palette immediately after selecting the script from the catalog but before clicking in the drawing space."
      },
      "tokens_used": 6653,
      "error": null
    }
  }
}