{
  "filename": "sd_DrillDE.mcr",
  "status": "completed",
  "total_tokens": 52433,
  "processing_time": 339.2442877292633,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "3.6",
            "date": "07.10.2009",
            "author": "th@hsbCAD.de",
            "changes": "reference point of x-dimline corrected"
          },
          {
            "version": "3.5",
            "date": "25.09.2009",
            "author": "th@hsbCAD.de",
            "changes": "mirrored Dimlines for drilling depth corrected (again ;-))"
          },
          {
            "version": "3.4",
            "date": "24.09.2009",
            "author": "th@hsbCAD.de",
            "changes": "mirrored Dimlines for drilling depth corrected"
          },
          {
            "version": "3.3",
            "date": "14.08.2009",
            "author": "th@hsbCAD.de",
            "changes": "compass mode enhanced options showAllInOneLeft and showInOneRight use the same stereotype. it is mandatory to set the viewing direction relative to offset direction"
          },
          {
            "version": "3.2",
            "date": "25.07.2009",
            "author": "th@hsbCAD.de",
            "changes": "Dialog driven setup enhanced, only values different from default will shown as _Map entry display of the zero at ref point suppressed"
          },
          {
            "version": "3.1",
            "date": "26.06.2009",
            "author": "th@hsbCAD.de",
            "changes": ""
          },
          {
            "version": "3.0",
            "date": "25.06.2009",
            "author": "th@hsbCAD.de",
            "changes": "supports Dialog driven setup of options requires hsbCAD 2009+ or higher"
          },
          {
            "version": "2.9",
            "date": "01.06.2009",
            "author": "th@hsbCAD.de",
            "changes": "bugfix"
          },
          {
            "version": "2.8",
            "date": "17.03.2009",
            "author": "th@hsbCAD.de",
            "changes": "- Option showDiameterIfEqual works in conjunction with the option showDiameter when it is set to display the radius or diameter as an appendix to the dimpoint - the option showDiameter with value 0 or 1 (display radius or diameter as an appendix to the dimpoint) now integrates composite drills (collection of drill and sinkholes) and displays the different radius's separated by a / - the option showJapanesSymbols is set to ON if entity is consumed by sd_BmJP. If the entity is consumed by sd_BmDE it is turned off. In conjunction either tsl it can now be turned ON(1) or OFF (0)."
          },
          {
            "version": "2.7",
            "date": "06.03.2009",
            "author": "th@hsbCAD.de",
            "changes": "various enhancements for japanese shopdrawings"
          },
          {
            "version": "2.2",
            "date": "20.01.2009",
            "author": "th@hsbCAD.de",
            "changes": "Enhancements on diameter and depth display bugfix length"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8623,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ShopDrawing",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": true,
          "detectionEvidence": "Filename prefix 'sd_', explicit comment 'This tsl is only executed by the shopdraw engine', usage of addDimRequest with DimRequestChain/DimRequestText/DimRequestRadial, usage of Stereotypes ('SectionLeft', 'SectionRight'), and MapIO configuration for rulesets."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Must be executed via the Shopdrawing engine in a multipage style ruleset.",
          "requiredSettings": []
        }
      },
      "tokens_used": 7457,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 10236,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates detailed dimensioning and annotation for drilling operations on timber beams within shop drawings, supporting various display styles (European, Japanese) and viewing directions.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used automatically by the shopdrawing engine when generating production drawings to display the location, size (diameter/radius), and depth of drilled holes on beams."
        },
        "parameters": [
          {
            "name": "showIndividualAxisOffset",
            "technicalDefault": "0",
            "businessMeaning": "Creates a specific dimension line indicating the offset of a drill's axis relative to the beam edges.",
            "validRange": "0 (Off), 1 (On)",
            "unit": "boolean",
            "affectsOutput": "Adds or removes a local dimension line showing where the hole is drilled from the side/top/bottom face."
          },
          {
            "name": "suppressDepth",
            "technicalDefault": "0",
            "businessMeaning": "Hides the depth dimension for drills. Usually hidden for through-holes, but shown for blind holes.",
            "validRange": "0 (Show), 1 (Suppress)",
            "unit": "boolean",
            "affectsOutput": "Removes depth text/lines from the drawing view when active."
          },
          {
            "name": "showJapaneseSymbols",
            "technicalDefault": "0",
            "businessMeaning": "Enables specific symbols used in Japanese timber construction drawings to represent drill holes.",
            "validRange": "0 (Off), 1 (On)",
            "unit": "boolean",
            "affectsOutput": "Replaces standard dimension text with Japanese graphical symbols or appends them to the hole indicator."
          },
          {
            "name": "JapaneseStyle",
            "technicalDefault": "Off",
            "businessMeaning": "Activates a set of dimensioning rules specific to Japanese standards, including specific point selection (top vs center) based on beam orientation.",
            "validRange": "Off, On",
            "unit": "mode",
            "affectsOutput": "Changes the location of dimension points and text alignment to match Japanese drafting conventions."
          },
          {
            "name": "showOffsetDrill",
            "technicalDefault": "0",
            "businessMeaning": "Determines how the location (offset) of the drill is displayed relative to the beam's reference system.",
            "validRange": "0 (Individual line), 1 (Near origin), 2 (Collect at start/end), 3 (Do not display)",
            "unit": "count",
            "affectsOutput": "Modifies the placement and grouping of dimension lines indicating the hole's position along and across the beam."
          },
          {
            "name": "showDiameter",
            "technicalDefault": "0",
            "businessMeaning": "Controls how the hole size is represented (Diameter vs Radius) and where the text is placed.",
            "validRange": "0 (Dia as appendix), 1 (Rad as appendix), 2 (Dia as text), 3 (Rad as text), 4 (Radial dim), 5 (Hide)",
            "unit": "count",
            "affectsOutput": "Switches between showing diameter (Ø) or radius (R), and places the text either attached to the dimpoint or as a leader note."
          },
          {
            "name": "showDiameterIfEqual",
            "technicalDefault": "0",
            "businessMeaning": "Optimization to avoid cluttering drawings with repeated size information for multiple identical holes.",
            "validRange": "0 (Show once if equal), 1 (Show all)",
            "unit": "count",
            "affectsOutput": "If '0', the diameter is only labeled on the first hole of a group of identical holes; subsequent holes show only location."
          },
          {
            "name": "hideDrillInSection",
            "technicalDefault": "0",
            "businessMeaning": "Controls the visibility of the drill hole representation in sectional views (cross-sections).",
            "validRange": "0 (Show), 1 (Hide)",
            "unit": "count",
            "affectsOutput": "Visually removes the hole from the sectional geometry in the drawing."
          },
          {
            "name": "ShowDrillAxisView",
            "technicalDefault": "0",
            "businessMeaning": "Filters the display of the drill based on the viewing direction relative to the drill's axis.",
            "validRange": "0 (Parallel), 1 (Perpendicular), 2 (Side View), 3 (Top View), 4 (Hide)",
            "unit": "count",
            "affectsOutput": "Suppresses dimensioning if the current view does not match the selected criteria."
          },
          {
            "name": "ShowInfoSeparate",
            "technicalDefault": "0",
            "businessMeaning": "Separates additional information (like diameter or depth text) into its own dimension line to avoid overcrowding.",
            "validRange": "0 (Same dimline), 1 (Separate dimline)",
            "unit": "count",
            "affectsOutput": "Moves text annotations to a distinct layer/line in the drawing."
          },
          {
            "name": "ShowAllInOneLeft",
            "technicalDefault": "0",
            "businessMeaning": "Aggregates all left-side offsets into a single chain dimension.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "boolean",
            "affectsOutput": "Combines individual offset markers into one continuous dimension line for the left side."
          },
          {
            "name": "ShowAllInOneRight",
            "technicalDefault": "0",
            "businessMeaning": "Aggregates all right-side offsets into a single chain dimension.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "boolean",
            "affectsOutput": "Combines individual offset markers into one continuous dimension line for the right side."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "showDiameter is set to 0 or 1 (Appendix mode)",
            "effect": "Enables the 'showDiameterIfEqual' parameter to function.",
            "cascade": [
              "showDiameterIfEqual"
            ]
          },
          {
            "trigger": "showJapaneseSymbols is On",
            "effect": "Overrides standard text display with symbols, potentially interacting with 'showDiameter'.",
            "cascade": [
              "showDiameter",
              "JapaneseStyle"
            ]
          },
          {
            "trigger": "suppressDepth is On",
            "effect": "Disables all depth dimensioning logic regardless of drill type (blind/through).",
            "cascade": []
          },
          {
            "trigger": "ShowDrillAxisView is 4 (Hide)",
            "effect": "Prevents any dimensioning for the drill in the view.",
            "cascade": [
              "showOffsetDrill",
              "showDiameter"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "DimRequestChain",
            "description": "Linear dimension lines indicating hole position (offsets) and depth.",
            "appliedTo": "GenBeam in ShopDrawing views"
          },
          {
            "type": "DimRequestRadial",
            "description": "Radial dimension lines showing the radius of the drill hole.",
            "appliedTo": "GenBeam in ShopDrawing views"
          },
          {
            "type": "DimRequestText",
            "description": "Text annotations displaying diameter, radius, or depth values.",
            "appliedTo": "GenBeam in ShopDrawing views"
          },
          {
            "type": "DimRequestPoint",
            "description": "Individual point markers used for offset dimensions.",
            "appliedTo": "GenBeam in ShopDrawing views"
          }
        ]
      },
      "tokens_used": 9118,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Initialization (Unit setup, Constants)",
          "Insert Mode Check (_bOnInsert)",
          "[Insert Mode] Prompt user for Beam (getBeam)",
          "[Insert Mode] Prompt user for Point near tool (getPoint)",
          "[Insert Mode] Assign to _Beam and _Pt0, Exit Script",
          "Shopdraw Engine Mode (MapIO Configuration)",
          "Read Custom Map Settings (ShowAllInOneLeft, ShowOffsetDrill, showDiameter, etc.)",
          "Retrieve Element Context (Element/GenBeam collection)",
          "Iterate through all Beams in the Element",
          "Filter Beams based on 'Stereotype' (SectionLeft/Right) and View Direction",
          "For each valid Beam: Collect and Analyze Tools (Drills, Sinkholes)",
          "Process Tool Collections (Composite drills, Grouping by axis/side)",
          "Generate Dimension Requests (DimRequestChain, DimRequestRadial, DimRequestText)",
          "Apply Display Logic (Japanese vs Standard symbols, Offset vs In-line dimensions)",
          "Finalize and Add Dimension Requests to Drawing View"
        ],
        "conditionalBranches": [
          {
            "condition": "Script Execution Context",
            "path1": {
              "name": "Insert Mode",
              "steps": [
                "Prompt for Beam selection",
                "Prompt for Point selection near tool",
                "Store references and terminate"
              ]
            },
            "path2": {
              "name": "Calculation/Shopdraw Mode",
              "steps": [
                "Read MapIO settings",
                "Process all beams in element",
                "Generate dimensions"
              ]
            }
          },
          {
            "condition": "ShowDrillAxisView setting (0-4)",
            "path1": {
              "name": "Show Drill",
              "steps": [
                "Check viewing direction (Parallel/Perpendicular/Side/Top)",
                "Proceed to generate dimension requests"
              ]
            },
            "path2": {
              "name": "Hide Drill (ShowDrillAxisView==4)",
              "steps": [
                "Skip dimension generation for this drill"
              ]
            }
          },
          {
            "condition": "Diameter Display Mode (showDiameter 0-5)",
            "path1": {
              "name": "Appendix Mode (0 or 1)",
              "steps": [
                "Check 'showDiameterIfEqual' condition",
                "Append text to dimension point"
              ]
            },
            "path2": {
              "name": "Text Mode (2 or 3)",
              "steps": [
                "Create separate DimRequestText entity near drill"
              ]
            },
            "path3": {
              "name": "Radial Mode (4)",
              "steps": [
                "Create DimRequestRadial entity"
              ]
            },
            "path4": {
              "name": "Hide (5)",
              "steps": [
                "Suppress diameter/radius display"
              ]
            }
          },
          {
            "condition": "Offset Display Mode (showOffsetDrill 0-3)",
            "path1": {
              "name": "Individual (0)",
              "steps": [
                "Create specific dimline for axis offset",
                "Chain other drills at same location"
              ]
            },
            "path2": {
              "name": "Near Origin (1)",
              "steps": [
                "Display offset relative to beam edges in separate dimlines"
              ]
            },
            "path3": {
              "name": "Collect Start/End (2)",
              "steps": [
                "Group all offsets to start or end of beam dimline"
              ]
            },
            "path4": {
              "name": "Hide (3)",
              "steps": [
                "Do not create offset dimensions"
              ]
            }
          },
          {
            "condition": "Depth Display (suppressDepth)",
            "path1": {
              "name": "Show Depth",
              "steps": [
                "Check if drill is through-hole (bThrough)",
                "Check for composite sinkholes",
                "Generate depth dimlines for Blind holes or Composites"
              ]
            },
            "path2": {
              "name": "Suppress Depth",
              "steps": [
                "Skip depth dimensioning logic entirely"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Existence",
            "errorMessage": "Implicitly handled by getBeam() returning null or empty.",
            "recovery": "User must select a valid beam during Insert mode or ensure the Element contains beams in Shopdraw mode."
          },
          {
            "check": "Tool/Drill Existence",
            "errorMessage": "No dimensions generated if no drills found.",
            "recovery": "Ensure the beam has drilling operations applied before running the shopdrawing style."
          },
          {
            "check": "View Direction Match",
            "errorMessage": "Drill dimensions not appearing in specific views.",
            "recovery": "Check 'ShowDrillAxisView' setting in the Map/Properties to ensure it matches the current drawing view (e.g., Side View, Top View)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Dimensioning Options",
            "how": "Properties Palette (OPM) / MapIO",
            "effect": "Changing properties like 'showDiameter', 'suppressDepth', or 'showOffsetDrill' dynamically updates the generated shopdrawing dimensions upon recalculation."
          },
          {
            "action": "Recalculate Script",
            "how": "Right-click Context Menu / hsbCAD Recalculate",
            "effect": "Re-runs the dimension logic, applying new property values or reflecting changes in the beam's geometry/drills."
          }
        ]
      },
      "tokens_used": 9853,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# sd_DrillDE.mcr\n\n## Overview\nGenerates detailed dimensions and annotations for drill holes on timber beams within shop drawings. It supports various display styles (European, Japanese) and offers extensive control over how hole diameter, depth, and location are dimensioned.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed for shop drawings. |\n| Paper Space | Yes | Executes within the Shopdrawing engine layout. |\n| Shop Drawing | Yes | Primary usage context via rulesets. |\n\n## Prerequisites\n- **Required Entities**: A `GenBeam` (Timber Beam) with drilling operations applied.\n- **Minimum Beam Count**: 1.\n- **Required Settings**: Must be configured within a Shopdrawing Style (Ruleset) to run automatically.\n\n## Usage Steps\n\nThis script is typically executed automatically by the hsbCAD Shopdrawing engine. However, it can be inserted manually for testing or configuration setup.\n\n### Step 1: Launch Script (Manual Insert)\nCommand: `TSLINSERT` → Select `sd_DrillDE.mcr` from the list.\n\n### Step 2: Select Beam\n```\nCommand Line: Select beam:\nAction: Click on the timber beam you wish to dimension.\n```\n\n### Step 3: Select Reference Point\n```\nCommand Line: Give a point near the tool:\nAction: Click a point close to the drill holes on the selected beam.\nAction: The script will attach to the beam and wait for the Shopdrawing engine to calculate views.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| showIndividualAxisOffset | Int | 0 | Shows a specific dimension line for the drill axis offset. (0=Off, 1=On) |\n| suppressDepth | Int | 0 | Hides the depth dimension for drills. Useful for through-holes. (0=Show, 1=Suppress) |\n| showJapaneseSymbols | Int | 0 | Enables symbols specific to Japanese timber construction standards. (0=Off, 1=On) |\n| JapaneseStyle | Int | 0 | Activates Japanese dimensioning rules (point selection based on orientation). (0=Off, 1=On) |\n| showOffsetDrill | Int | 0 | Controls how hole location is displayed: <br>0 = Individual dimension line <br>1 = Near origin <br>2 = Collected at start/end <br>3 = Do not display |\n| showDiameter | Int | 0 | Controls hole size display style: <br>0 = Diameter as appendix text <br>1 = Radius as appendix text <br>2 = Diameter as separate text <br>3 = Radius as separate text <br>4 = Radial dimension line <br>5 = Hide |\n| showDiameterIfEqual | Int | 0 | Optimization for multiple identical holes. <br>0 = Show only once if equal <br>1 = Show on all holes |\n| hideDrillInSection | Int | 0 | Toggles visibility of the hole in sectional views. (0=Show, 1=Hide) |\n| ShowDrillAxisView | Int | 0 | Filters display based on viewing direction: <br>0 = Parallel view <br>1 = Perpendicular view <br>2 = Side view <br>3 = Top view <br>4 = Hide in all views |\n| ShowInfoSeparate | Int | 0 | Separates diameter/depth info onto a different dimension line to avoid clutter. (0=Same line, 1=Separate) |\n| ShowAllInOneLeft | Int | 0 | Aggregates all left-side offsets into one chain dimension. (0=No, 1=Yes) |\n| ShowAllInOneRight | Int | 0 | Aggregates all right-side offsets into one chain dimension. (0=No, 1=Yes) |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Refreshes the script to apply changes made in the Properties Panel or updates based on modified beam geometry. |\n\n## Settings Files\n- **Filename**: None specified.\n- **Location**: N/A.\n- **Purpose**: This script relies on `MapIO` properties passed from the Shopdrawing Style configuration rather than external XML files.\n\n## Tips\n- **Clean Drawings**: Use the `showDiameterIfEqual` set to `0` when you have many holes of the same size. This labels the size only once, reducing drawing clutter.\n- **View Specifics**: If dimensions are missing in a specific view (e.g., Top View), check the `ShowDrillAxisView` property. It might be set to only show in `Side View` or `Parallel View`.\n- **Japanese Standards**: If working for a market requiring Japanese symbols, enable both `showJapaneseSymbols` and `JapaneseStyle` to ensure correct point selection and text representation.\n- **Depth Clarity**: For blind holes (holes that don't go all the way through), keep `suppressDepth` set to `0` to ensure the depth is clearly visible. For through-holes, set it to `1` to remove redundant information.\n\n## FAQ\n- **Q: Why are my drill dimensions not appearing in the drawing?**\n- **A:** Check the `ShowDrillAxisView` property. Ensure it is set to match the current view direction (e.g., set to `2` for Side View or `3` for Top View). If set to `4`, it will be hidden in all views.\n\n- **Q: The diameter is only shown on the first hole, but I want it on all of them.**\n- **A:** Change the `showDiameterIfEqual` property from `0` to `1`.\n\n- **Q: I see the dimension lines, but no text for the size (Diameter/Radius).**\n- **A:** Check the `showDiameter` property. If it is set to `5`, the size is hidden. Also, verify that `ShowInfoSeparate` hasn't moved the text to a layer that is frozen or off.\n\n- **Q: The drill hole appears in the 3D model but is missing in the 2D cross-section.**\n- **A:** Check the `hideDrillInSection` property. If it is set to `1`, the hole will be hidden in sectional views."
      },
      "tokens_used": 7146,
      "error": null
    }
  }
}