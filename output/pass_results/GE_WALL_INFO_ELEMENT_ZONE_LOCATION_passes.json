{
  "filename": "GE_WALL_INFO_ELEMENT_ZONE_LOCATION.mcr",
  "status": "completed",
  "total_tokens": 22815,
  "processing_time": 352.27005648612976,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": null,\n    \"minorVersion\": null,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"v1.0\",\n      \"date\": \"no date\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"\"\n    },\n    {\n      \"version\": \"v2.0\",\n      \"date\": \"19.mar.2013\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Added display of ptOrg for selected zone)\"\n    }\n  ],\n  \"settingsFiles\": [],\n  \""
      },
      "tokens_used": 5168,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `getElement()` and `getPoint()` for user interaction during `_bOnInsert`, which are standard for 3D Model Space operations. It visualizes `ElemZone` and `PlaneProfile` geometry relative to the element's `CoordSys` using a standard `Display` object. No `_Viewport` checks, `sd_` prefixes, or shop drawing entity filtering are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 2992,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "Zone index",
            "defaultValue": 5,
            "inputType": "dropdown",
            "options": [
              0,
              1,
              2,
              3,
              4,
              5,
              -1,
              -2,
              -3,
              -4,
              -5
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dOff",
            "type": "PropDouble",
            "displayName": "Offset",
            "defaultValue": "30",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2631,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Visualizes the origin point (ptOrg) of specific element zones within a wall element to assist in locating and referencing critical vertical positions.",
          "category": "Visualization/Construction Aids",
          "typicalUseCase": "Used during detailing or assembly planning to identify and verify the exact Z-height origin of specific wall zones (e.g., floor levels or window sill heights) relative to a chosen reference point."
        },
        "parameters": [
          {
            "name": "nZone",
            "technicalDefault": "5",
            "businessMeaning": "Selects which zone number of the wall element to locate and visualize. Positive numbers typically indicate construction zones (e.g., stories), while negative numbers might indicate extensions or basements.",
            "validRange": "-5 to 5",
            "unit": "Index",
            "affectsOutput": "Controls which vertical zone's origin (ptOrg) is calculated and highlighted by the marker and text label."
          },
          {
            "name": "dOff",
            "technicalDefault": "30",
            "businessMeaning": "A horizontal offset distance applied to the visual marker, used to shift the indicator line away from the reference point to avoid visual clutter or align with a specific dimension line.",
            "validRange": "0 to 500",
            "unit": "mm",
            "affectsOutput": "Shifts the start point of the dimension/marker line horizontally from the calculated zone origin along the element's X-axis."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Graphic/PLine",
            "description": "Draws a 2D polyline leader (indicator) starting from the calculated zone origin, offset by the specified distance, to visualize the exact location.",
            "appliedTo": "Model Space (visual overlay on the selected Element)"
          },
          {
            "type": "Text",
            "description": "Draws a text label indicating the zone index (e.g., 'Zone (5) ptOrg') at the end of the leader line.",
            "appliedTo": "Model Space"
          }
        ]
      },
      "tokens_used": 2816,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch script insertion command.",
          "2. User selects a Wall Element via getElement().",
          "3. User specifies a reference point (location) via getPoint().",
          "4. [Recalculate] Script checks if Element is attached to instance.",
          "5. Script retrieves Element and establishes local Coordinate System (CoordSys) at the reference point.",
          "6. Script loops through indices -5 to 5, drawing vertical PLine markers for every available zone to provide visual context.",
          "7. Script calculates the specific origin point (ptOrg) for the zone defined in property 'nZone'.",
          "8. Script applies the horizontal offset defined in property 'dOff'.",
          "9. Script draws the specific leader line and text label indicating the selected zone's origin."
        ],
        "conditionalBranches": [
          {
            "condition": "State of script execution (Insertion vs. Recalculation)",
            "path1": {
              "name": "Initial Insertion",
              "steps": [
                "Prompt user to select Element.",
                "Prompt user to select Location Point.",
                "Store inputs in script instance variables.",
                "Exit execution flow (return)."
              ]
            },
            "path2": {
              "name": "Subsequent Recalculation",
              "steps": [
                "Check if Element exists.",
                "Execute visualization logic (Draw zones).",
                "Execute specific marker logic."
              ]
            }
          },
          {
            "condition": "Element Attachment Check (_Element.length())",
            "path1": {
              "name": "Element Missing",
              "steps": [
                "Call eraseInstance().",
                "Terminate script execution."
              ]
            },
            "path2": {
              "name": "Element Present",
              "steps": [
                "Retrieve Element object.",
                "Proceed with drawing logic."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Attachment",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script automatically calls eraseInstance() if the element array is empty, effectively cancelling the placement if the user escaped the selection prompt."
          },
          {
            "check": "Zone Availability",
            "errorMessage": "None",
            "recovery": "The script attempts to access zones -5 through 5. If a specific index in 'nZone' does not exist in the wall element definition, standard hsbCAD behavior usually returns a default or null zone, which may result in the marker snapping to 0,0,0 of the element or not drawing."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Zone Index",
            "how": "OPM (Object Properties Palette) - Edit 'Zone index' (nZone)",
            "effect": "The leader line and text label jump to the origin (ptOrg) of the newly selected zone index."
          },
          {
            "action": "Adjust Offset",
            "how": "OPM (Object Properties Palette) - Edit 'Offset' (dOff)",
            "effect": "The start point of the leader line shifts horizontally along the element's X-axis."
          },
          {
            "action": "Update Geometry",
            "how": "Modify the source Wall Element geometry",
            "effect": "Script recalculates automatically (due to setDependencyOnEntity) to update the position of all zone markers and labels."
          }
        ]
      },
      "tokens_used": 4836,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_INFO_ELEMENT_ZONE_LOCATION\n\n## Overview\nVisualizes the origin point (ptOrg) of specific vertical zones within a wall element. This script helps CAD operators identify and verify the exact vertical height of specific wall zones (such as floor levels) relative to a chosen reference point.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Operates in 3D model space only. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: One Wall Element.\n- **Minimum Beam Count**: 1.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WALL_INFO_ELEMENT_ZONE_LOCATION.mcr`\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select Element\nAction: Click on the desired Wall Element in the drawing.\n```\n\n### Step 3: Specify Reference Location\n```\nCommand Line: Specify Location\nAction: Click a point in the drawing to define the local coordinate system origin and placement location for the information.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Zone index | dropdown | 5 | Selects which vertical zone number to highlight. Positive values usually indicate construction zones (stories), while negative values may indicate basements or extensions. |\n| Offset | number | 30 | Sets the horizontal distance (in mm) that the indicator line is drawn away from the calculated origin point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (None) | No specific context menu options are added by this script. Use the Properties Palette to adjust settings. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A.\n- **Purpose**: N/A.\n\n## Tips\n- **Visual Context**: The script automatically draws vertical markers for all zones from index -5 to 5. This allows you to see the relative stack of all zones even if you are only highlighting one specific zone.\n- **Dynamic Updates**: If you modify the geometry of the source Wall Element, the zone markers will automatically update to reflect the new heights.\n- **Avoid Clutter**: If the label overlaps with other geometry, increase the **Offset** property to shift the leader line horizontally.\n\n## FAQ\n- **Q: What happens if I select a zone index that doesn't exist in my wall?**\n- **A:** The marker will likely snap to the element's origin (0,0,0) or may not display the specific label correctly. Ensure the selected zone index corresponds to a valid zone defined in your wall properties.\n- **Q: How do I change which zone is highlighted after insertion?**\n- **A:** Select the script object in the model, open the Properties Palette (Ctrl+1), and change the value in the **Zone index** dropdown."
      },
      "tokens_used": 4372,
      "error": null
    }
  }
}