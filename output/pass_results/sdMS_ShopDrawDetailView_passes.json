{
  "filename": "sdMS_ShopDrawDetailView.mcr",
  "status": "completed",
  "total_tokens": 56703,
  "processing_time": 1032.6104807853699,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8735,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": true,
          "detectionEvidence": "Filename starts with 'sdMS' (ShopDrawing Multipage). Insert logic contains prompt: 'Select Multipage Shopdrawing or ViewGenerator TSL'. Script functionality generates 2D projected views (Plan/Section) with titles, tags, and scales typical of drawing annotations."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element (Multipage Shopdrawing or ViewGenerator TSL)"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout)",
          "requiredSettings": []
        }
      },
      "tokens_used": 7180,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "Select Multipage Shopdrawing or ViewGenerator TSL",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select first defining point",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrPoint.go",
              "promptOriginal": "Select 2nd defining point",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 4,
              "function": "PrPoint.go",
              "promptOriginal": "Select 3rd point or return",
              "condition": "_bOnInsert",
              "required": false
            },
            {
              "step": 5,
              "function": "getPoint",
              "promptOriginal": "Select location for generated linework",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "psOperationMode",
            "type": "PropString",
            "displayName": "Type",
            "defaultValue": "Rectangle Plan",
            "inputType": "dropdown",
            "options": [
              "Rectangle Plan",
              "Sect/Elev Cut",
              "Circle Plan"
            ],
            "category": "Mode",
            "description": null
          },
          {
            "index": 5,
            "variable": "psDoFlippedReverseView",
            "type": "PropString",
            "displayName": "Flipped Reverse View",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Mode",
            "description": null
          },
          {
            "index": 6,
            "variable": "psDoHighDetail",
            "type": "PropString",
            "displayName": "Detail Level",
            "defaultValue": "High",
            "inputType": "dropdown",
            "options": [
              "High",
              "Low (Outline)"
            ],
            "category": "Mode",
            "description": "This option only relevant to Collection Entities"
          },
          {
            "index": 0,
            "variable": "pdScale",
            "type": "PropDouble",
            "displayName": "Scale",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": "Mode",
            "description": null
          },
          {
            "index": 1,
            "variable": "piVisibleColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": 4,
            "inputType": "number",
            "options": [],
            "category": "Mode",
            "description": null
          },
          {
            "index": 0,
            "variable": "piHiddenColor",
            "type": "PropInt",
            "displayName": "Color ",
            "defaultValue": 7,
            "inputType": "number",
            "options": [],
            "category": "Hidden Linework",
            "description": null
          },
          {
            "index": 0,
            "variable": "psHiddenLinetype",
            "type": "PropString",
            "displayName": "Linetype",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "Hidden Linework",
            "description": null
          },
          {
            "index": 7,
            "variable": "pdHiddenLinetypeScale",
            "type": "PropDouble",
            "displayName": "Linetype Scale",
            "defaultValue": -1,
            "inputType": "number",
            "options": [],
            "category": "Hidden Linework",
            "description": null
          },
          {
            "index": 4,
            "variable": "psTitle",
            "type": "PropString",
            "displayName": "Title",
            "defaultValue": "Enter Title",
            "inputType": "text",
            "options": [],
            "category": "Title",
            "description": null
          },
          {
            "index": 4,
            "variable": "piTextColor",
            "type": "PropInt",
            "displayName": "Color  ",
            "defaultValue": 6,
            "inputType": "number",
            "options": [],
            "category": "Title",
            "description": null
          },
          {
            "index": 3,
            "variable": "pdTitleHeight",
            "type": "PropDouble",
            "displayName": "Text Height",
            "defaultValue": 15,
            "inputType": "number",
            "options": [],
            "category": "Title",
            "description": null
          },
          {
            "index": 3,
            "variable": "psDetailTag",
            "type": "PropString",
            "displayName": "Tag",
            "defaultValue": "A",
            "inputType": "text",
            "options": [],
            "category": "Tag",
            "description": null
          },
          {
            "index": 5,
            "variable": "piTagColor",
            "type": "PropInt",
            "displayName": "Color   ",
            "defaultValue": 6,
            "inputType": "number",
            "options": [],
            "category": "Tag",
            "description": null
          },
          {
            "index": 4,
            "variable": "pdTagHeight",
            "type": "PropDouble",
            "displayName": "Text Height ",
            "defaultValue": 20,
            "inputType": "number",
            "options": [],
            "category": "Tag",
            "description": null
          },
          {
            "index": 2,
            "variable": "piCutlineColor",
            "type": "PropInt",
            "displayName": "Cut-Line Color",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 6,
            "variable": "pdVerticalOffset",
            "type": "PropDouble",
            "displayName": "Section Vertical Offset",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 7,
            "variable": "psDrawConnector",
            "type": "PropString",
            "displayName": "Draw Connector",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 2,
            "variable": "psDrawBorder",
            "type": "PropString",
            "displayName": "Draw Border",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 3,
            "variable": "piBorderColor",
            "type": "PropInt",
            "displayName": "Border Color",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 5,
            "variable": "pdBorderPadding",
            "type": "PropDouble",
            "displayName": "Border Padding",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 1,
            "variable": "pdArrowL",
            "type": "PropDouble",
            "displayName": "Arrow Length",
            "defaultValue": 60,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          },
          {
            "index": 2,
            "variable": "pdArrowH",
            "type": "PropDouble",
            "displayName": "Arrowhead Scale",
            "defaultValue": 30,
            "inputType": "number",
            "options": [],
            "category": "General Linework",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9147,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Creates projected 2D detail views (Plan or Section/Elevation) from a Multipage Shopdrawing or ViewGenerator entity in Paper Space, allowing for custom scales, tags, and boundary styling.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"A detailer needs to generate a specific 'blow-up' view of a complex connection or assembly from a 3D model onto a 2D drawing sheet with a specific callout tag (e.g., Detail A) and scale.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"psOperationMode\",\n      \"technicalDefault\": \"Rectangle Plan\",\n      \"businessMeaning\": \"Defines the projection method: a rectangular top-down plan, a circular plan view, or a vertical section/elevation cut.\",\n      \"validRange\": \"Rectangle Plan / Sect/Elev Cut / Circle Plan\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Switches the calculation logic between planar projection (Z-axis) and sectional projection, changing the shape of the source boundary (rectangle/circle) and the direction of the view rays.\"\n    },\n    {\n      \"name\": \"psDoFlippedReverseView\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Mirrors the generated detail view 180 degrees relative to the view axis.\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"bool\",\n      \"affectsOutput\": \"Transforms the generated linework to appear reversed, useful for showing the 'back' of a connection in the same orientation as the 'front' of another.\"\n    },\n    {\n      \"name\": \"psDoHighDetail\",\n      \"technicalDefault\": \"High\",\n      \"businessMeaning\": \"Determines if individual element outlines are drawn (High) or if they are merged into a single silhouette/outline (Low).\",\n      \"validRange\": \"High / Low (Outline)\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"In High mode, draws linework for every beam in the collection. In Low mode, draws a single unified outline of the entire selected volume.\"\n    },\n    {\n      \"name\": \"pdScale\",\n      \"technicalDefault\": 1,\n      \"businessMeaning\": \"The scale factor at which the detail is generated (e.g., 1:10).\",\n      \"validRange\": \"0.1 to 50 (e.g., 0.5 for 1:2, 10 for 1:10)\",\n      \"unit\": \"factor\",\n      \"affectsOutput\": \"Determines the size of the 2D linework generated in Paper Space and updates the automatic 'Scale 1:X' text label.\"\n    },\n    {\n      \"name\": \"piVisibleColor\",\n      \"technicalDefault\": 4,\n      \"businessMeaning\": \"The AutoCAD color index for visible (cut) edges in the detail view.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the projection lines representing visible geometry.\"\n    },\n    {\n      \"name\": \"piHiddenColor\",\n      \"technicalDefault\": 7,\n      \"businessMeaning\": \"The AutoCAD color index for hidden lines (edges behind the cut plane).\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the projection lines representing geometry obscured by the front faces.\"\n    },\n    {\n      \"name\": \"psHiddenLinetype\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The linetype style (e.g., Hidden, Dashed) applied to hidden geometry.\",\n      \"validRange\": \"Any loaded AutoCAD Linetype\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Changes the dash/dot pattern of the hidden lines.\"\n    },\n    {\n      \"name\": \"pdHiddenLinetypeScale\",\n      \"technicalDefault\": -1,\n      \"businessMeaning\": \"Scale factor for the hidden linetype. -1 typically uses the system default.\",\n      \"validRange\": \"> -1.0\",\n      \"unit\": \"factor\",\n      \"affectsOutput\": \"Stretches or compresses the dash pattern of the hidden lines.\"\n    },\n    {\n      \"name\": \"psTitle\",\n      \"technicalDefault\": \"Enter Title\",\n      \"businessMeaning\": \"The descriptive text label for the detail (e.g., 'Ridge Connection', 'Floor Joist Detail').\",\n      \"validRange\": \"Alphanumeric string\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Updates the text label drawn below the generated view.\"\n    },\n    {\n      \"name\": \"piTextColor\",\n      \"technicalDefault\": 6,\n      \"businessMeaning\": \"The AutoCAD color index for the Title and Tag text.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the annotation text.\"\n    },\n    {\n      \"name\": \"pdTitleHeight\",\n      \"technicalDefault\": 15,\n      \"businessMeaning\": \"The plotted height of the title text in millimeters.\",\n      \"validRange\": \"2.5 - 50 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Scales the size of the title text block.\"\n    },\n    {\n      \"name\": \"psDetailTag\",\n      \"technicalDefault\": \"A\",\n      \"businessMeaning\": \"The identifier code (bubble) for this detail (e.g., 'A', 'B1', 'DET-1').\",\n      \"validRange\": \"Alphanumeric string\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Updates the tag label placed near the source point and prefixes the title text.\"\n    },\n    {\n      \"name\": \"piTagColor\",\n      \"technicalDefault\": 6,\n      \"businessMeaning\": \"The AutoCAD color index for the Tag text specifically.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the detail identifier/tag.\"\n    },\n    {\n      \"name\": \"pdTagHeight\",\n      \"technicalDefault\": 20,\n      \"businessMeaning\": \"The plotted height of the tag text in millimeters.\",\n      \"validRange\": \"2.5 - 50 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Scales the size of the tag text.\"\n    },\n    {\n      \"name\": \"piCutlineColor\",\n      \"technicalDefault\": 1,\n      \"businessMeaning\": \"The AutoCAD color index for the source boundary/cut line.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the rectangle/circle/line defining the view source in the model or layout.\"\n    },\n    {\n      \"name\": \"pdVerticalOffset\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Moves the section cut plane vertically relative to the defining point.\",\n      \"validRange\": \"-5000 to 5000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"In Section/Elev mode, shifts the height of the slice upwards or downwards.\"\n    },\n    {\n      \"name\": \"psDrawConnector\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Toggles a visual leader line connecting the source area to the generated detail.\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"bool\",\n      \"affectsOutput\": \"If Yes, draws a line linking the source boundary and the detail border.\"\n    },\n    {\n      \"name\": \"psDrawBorder\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Toggles a border around the generated detail view.\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"bool\",\n      \"affectsOutput\": \"If Yes, draws a rectangle or circle enclosing the detail linework.\"\n    },\n    {\n      \"name\": \"piBorderColor\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The AutoCAD color index for the border.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Sets the color of the detail border (if drawn).\"\n    },\n    {\n      \"name\": \"pdBorderPadding\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The clearance distance between the outermost linework and the border.\",\n      \"validRange\": \"0 -"
      },
      "tokens_used": 10908,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script 'sdMS_ShopDrawDetailView.mcr'.",
          "2. Script checks for duplicate insertion; if 'insertCycleCount() > 1', instance is erased.",
          "3. User selects a target Entity (Multipage Shopdrawing or ViewGenerator TSL) via command line prompt.",
          "4. User defines the source boundary geometry by clicking 2 or 3 points for Origin, Length/Radius, and Width/Depth.",
          "5. User selects the destination point in Paper Space for the generated detail view.",
          "6. Script initializes Grip points (G0-G5) and persists vectors to internal Map.",
          "7. Script determines 'Operation Mode' (Rectangle Plan, Sect/Elev Cut, or Circle Plan).",
          "8. Script calculates view boundaries and cuts geometry (Body) based on Mode and Scale properties.",
          "9. Script generates 2D linework (Visible and Hidden) via projection.",
          "10. Script draws annotations (Tag, Title, Border, Connector) based on property settings.",
          "11. Script finalizes the view and updates the drawing."
        ],
        "conditionalBranches": [
          {
            "condition": "Operation Mode (psOperationMode)",
            "path1": {
              "name": "Rectangle Plan",
              "steps": [
                "Uses 3 grips to define a rectangular box.",
                "Projects geometry along Z-axis (Plan view).",
                "Draws rectangular cut line and border.",
                "Read-only property 'pdVerticalOffset' is ignored."
              ]
            },
            "path2": {
              "name": "Sect/Elev Cut",
              "steps": [
                "Uses 3 grips to define cut line and depth, adds a 4th grip (G5) for view height.",
                "Projects geometry perpendicular to cut line.",
                "Draws arrowed cut line.",
                "Applies 'pdVerticalOffset' to shift cut plane height.",
                "Ensures Grip 2 stays orthogonal to Grip 1."
              ]
            },
            "path3": {
              "name": "Circle Plan",
              "steps": [
                "Uses 2nd point to define radius.",
                "Projects geometry along Z-axis.",
                "Draws circular cut line and border.",
                "Positions title tag at bottom of circle."
              ]
            }
          },
          {
            "condition": "Detail Level (psDoHighDetail)",
            "path1": {
              "name": "High",
              "steps": [
                "Iterates through all individual entities in the collection.",
                "Projects visible lines for every entity.",
                "Produces detailed linework showing individual parts."
              ]
            },
            "path2": {
              "name": "Low (Outline)",
              "steps": [
                "Combines all entities into a single Body.",
                "Projects only the outer silhouette/outline.",
                "Produces simplified linework."
              ]
            }
          },
          {
            "condition": "Grip Edit - Moving Origin (Grip 0)",
            "path1": {
              "name": "Rigid Move of Source",
              "steps": [
                "Calculates relative offsets of Grips 1, 2, and 4 from Map.",
                "Moves the entire source boundary group.",
                "Target view location (Grip 3) remains static."
              ]
            }
          },
          {
            "condition": "Grip Edit - Moving View Target (Grip 3) in Section Mode",
            "path1": {
              "name": "Rigid Move of View",
              "steps": [
                "Calculates relative offset of Grip 5 (Height) from Map.",
                "Moves the entire generated view and text.",
                "Source boundary remains static."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Section Cut Geometry Orthogonality",
            "errorMessage": "None explicitly returned to user (handled silently).",
            "recovery": "Script automatically forces Grip 2 (depth) to be orthogonal to Grip 1 (cut line) using vector projection logic."
          },
          {
            "check": "Section View Height Direction",
            "errorMessage": "None explicitly returned to user.",
            "recovery": "Script checks the dot product of the height vector against the Y-axis. If negative, it flips the height grip (Grip 5) to the positive side."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify View Type",
            "how": "OPM Property 'Type'",
            "effect": "Toggles between Plan, Section, and Circle modes. Changes available grips and projection direction."
          },
          {
            "action": "Adjust Scale",
            "how": "OPM Property 'Scale'",
            "effect": "Re-calculates and re-draws the 2D linework size at the target location. Updates 'Scale 1:X' text."
          },
          {
            "action": "Resize Source Area",
            "how": "Drag Grip 1, 2, or 4",
            "effect": "Updates the boundary box/line used to clip the model geometry. Regenerates detail."
          },
          {
            "action": "Relocate Detail View",
            "how": "Drag Grip 3",
            "effect": "Moves the generated 2D detail, border, and text to a new position on the sheet."
          },
          {
            "action": "Update Annotations",
            "how": "OPM Properties ('Title', 'Tag', 'Color')",
            "effect": "Immediately updates the text content, height, or color of the tags and title."
          }
        ]
      },
      "tokens_used": 11753,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# sdMS_ShopDrawDetailView.mcr\n\n## Overview\nThis script generates projected 2D detail views (Plan, Section, or Elevation) from a Multipage Shopdrawing or ViewGenerator entity in Paper Space. It allows you to create specific \"blow-up\" views with custom scales, tags, and boundary styling for detailed documentation.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed for Paper Space (Layout) only. |\n| Paper Space | Yes | This is the primary environment for inserting and editing this script. |\n| Shop Drawing | Yes | Specifically requires a Multipage Shopdrawing or ViewGenerator element. |\n\n## Prerequisites\n- **Required Entities**: An existing Multipage Shopdrawing or ViewGenerator TSL already inserted in the drawing.\n- **Minimum Beam Count**: 0 (Operates on existing drawing entities).\n- **Required Settings**: None (Uses default internal settings if not specified).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` (or insert tool) â†’ Select `sdMS_ShopDrawDetailView.mcr`.\n\n### Step 2: Select Source Entity\n```\nCommand Line: Select Multipage Shopdrawing or ViewGenerator TSL\nAction: Click on the Shopdrawing or ViewGenerator element in the Model or Layout you wish to detail.\n```\n\n### Step 3: Define Source Boundary\n```\nCommand Line: Select first defining point\nAction: Click the first corner (or center for circles) of the area you want to detail.\n\nCommand Line: Select 2nd defining point\nAction: Click to define the length or radius of the detail area.\n\nCommand Line: Select 3rd point or return\nAction: Click a third point to define width/depth (for rectangles), or press Enter to accept default/square dimensions.\n```\n\n### Step 4: Place Detail View\n```\nCommand Line: Select location for generated linework\nAction: Click in the Paper Space layout where you want the detail view to appear.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Mode** | | | |\n| Type | dropdown | Rectangle Plan | Selects the view projection: \"Rectangle Plan\" (Top-down), \"Sect/Elev Cut\" (Vertical slice), or \"Circle Plan\" (Circular top-down). |\n| Flipped Reverse View | dropdown | No | Mirrors the generated detail view 180 degrees. Useful for showing the reverse side of a connection. |\n| Detail Level | dropdown | High | \"High\" draws outlines for every beam; \"Low (Outline)\" merges them into a single silhouette. |\n| Scale | number | 1 | Sets the scale factor for the detail view (e.g., enter 10 for 1:10 scale). |\n| Color | number | 4 | Sets the AutoCAD color index for visible lines in the detail. |\n| **Hidden Linework** | | | |\n| Color | number | 7 | Sets the color for hidden lines (geometry behind the cut plane). |\n| Linetype | dropdown | [Empty] | Sets the linetype (e.g., Hidden) for hidden lines. |\n| Linetype Scale | number | -1 | Adjusts the scale of the hidden linetype pattern (-1 uses system default). |\n| **Title** | | | |\n| Title | text | Enter Title | The descriptive text label (e.g., \"Ridge Connection\"). |\n| Color | number | 6 | Sets the color of the title text. |\n| Text Height | number | 15 | Sets the height of the title text in millimeters. |\n| **Tag** | | | |\n| Tag | text | A | The identifier code for the detail bubble (e.g., \"A\", \"B1\"). |\n| Color | number | 6 | Sets the color of the tag text. |\n| Text Height | number | 20 | Sets the height of the tag text in millimeters. |\n| **General Linework** | | | |\n| Cut-Line Color | number | 1 | Sets the color of the source boundary/cut line in the model. |\n| Section Vertical Offset | number | 0 | Moves the section cut plane up or down. Only applies to Section/Elev mode. |\n| Draw Connector | dropdown | No | If \"Yes\", draws a leader line connecting the source area to the detail view. |\n| Draw Border | dropdown | No | If \"Yes\", draws a border around the generated detail view. |\n| Border Color | number | 0 | Sets the color of the detail border. |\n| Border Padding | number | 0 | Sets the clearance distance between the linework and the border. |\n| Arrow Length | number | 60 | Sets the length of cut line arrows (Section/Elev mode). |\n| Arrowhead Scale | number | 30 | Sets the size of the arrowheads. |\n\n## Right-Click Menu Options\nNo specific custom context menu items are defined by this script. Modifications are handled via the Properties Palette (OPM) and direct grip editing.\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Resizing:** Use the **Grips** on the source boundary (in Model/Layout) to resize the detail area dynamically. The view will update automatically.\n- **Relocating:** Drag the **View Location Grip** (where the detail is placed) to move the generated 2D view around your sheet without changing the source area.\n- **Section Mode:** When using \"Sect/Elev Cut\", ensure you define the cut line direction carefully. The script automatically keeps the depth vector orthogonal to the cut line.\n- **Performance:** Use \"Low (Outline)\" detail level for large assemblies to simplify the drawing and improve regeneration speed.\n\n## FAQ\n- **Q: How do I change the scale of the detail after inserting it?**\n  A: Select the script entity, open the Properties Palette, and change the \"Scale\" value.\n- **Q: Can I switch from a Plan view to a Section view later?**\n  A: Yes, change the \"Type\" property in the Properties Palette from \"Rectangle Plan\" to \"Sect/Elev Cut\" (or vice versa).\n- **Q: Why is my detail view blank?**\n  A: Ensure the \"Source Boundary\" (defined in steps 3) actually intersects with 3D model geometry. You may need to move the source grips to encompass the timber elements.\n- **Q: What does \"Flipped Reverse View\" do?**\n  A: It mirrors the output. If you are drawing a section cut looking North, enabling this will make it look as if you are looking South, which can be useful for aligning details on a drawing sheet."
      },
      "tokens_used": 8980,
      "error": null
    }
  }
}