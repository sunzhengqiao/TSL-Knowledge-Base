{
  "filename": "HSB_D-SheetOpening.mcr",
  "status": "completed",
  "total_tokens": 57950,
  "processing_time": 239.03542923927307,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 6,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "10.09.2013",
            "author": "AS",
            "changes": "Pilot version."
          },
          {
            "version": "1.01",
            "date": "11.09.2013",
            "author": "AS",
            "changes": "Add reference points."
          },
          {
            "version": "1.02",
            "date": "11.09.2013",
            "author": "AS",
            "changes": "Filter zones"
          },
          {
            "version": "1.03",
            "date": "11.09.2013",
            "author": "AS",
            "changes": "Add extremes of element"
          },
          {
            "version": "1.04",
            "date": "24.02.2014",
            "author": "AS",
            "changes": "Correct outline index"
          },
          {
            "version": "1.05",
            "date": "03.05.2016",
            "author": "AS",
            "changes": "Use Body::extractContactFaceInPlane instead of Sheet::profShape to get to the openings added as tools."
          },
          {
            "version": "1.06",
            "date": "16.10.2017",
            "author": "AS",
            "changes": "Add option to merge zone and treat the zone as a sheet."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8232,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses _Viewport.append(getViewport(...)) to select a viewport. It references Viewport vp = _Viewport[0]; and Element el = vp.element();. Calculates scale via ps2ms.scale() and transforms dimensions using ms2ps. These patterns indicate the script is designed to run in a Paper Space environment (Shop Drawing) context to dimension sheet openings based on a selected viewport."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Sheet",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "The script must be run in a Shop Drawing (Paper Space) with a selected Viewport containing an Element.",
          "requiredSettings": []
        }
      },
      "tokens_used": 6148,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"Select a viewport\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a position\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDialog\",\n      \"trigger\": \"Insertion (if _kExecuteKey is empty)\",\n      \"title\": null,\n      \"dataSource\": \"OPM Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"nZoneProp\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Zone\",\n      \"defaultValue\": 1,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"1\",\n        \"2\",\n        \"3\",\n        \"4\",\n        \"5\",\n        \"6\",\n        \"7\",\n        \"8\",\n        \"9\",\n        \"10\"\n      ],\n      \"category\": \"Selection\",\n      \"description\": null\n    },\n    {\n      \"index\": 18,\n      \"variable\": \"mergeSheetsProp\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Merge sheets\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": \"Selection\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"mergeSheetsWithGap\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Merge sheets with gap\",\n      \"defaultValue\": \"10.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Selection\",\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"sFilterBC\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams with beamcode\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Filter\",\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"sFilterLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with label\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Filter\",\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"sFilterMaterial\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with material\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Filter\",\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"sFilterHsbID\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with hsbID\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Filter\",\n      \"description\": null\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"sFilterZone\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter zones\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Filter\",\n      \"description\": null\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"sObject\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Object\",\n      \"defaultValue\": \"Openings in sheet\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Openings in sheet\"\n      ],\n      \"category\": \"Dimension Object\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sPosition\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Position\",\n      \"defaultValue\": \"Horizontal top\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Horizontal top\",\n        \"Horizontal bottom\",\n        \"Vertical left\",\n        \"Vertical right\"\n      ],\n      \"category\": \"Positioning\",\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"sDimensionPerOpening\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension per opening\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Positioning\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sUsePSUnits\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Offset in paperspace units\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Positioning\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Offset\",\n      \"defaultValue\": \"6.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Positioning\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension style\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": \"Style\",\n      \"description\": \"System dimension styles\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nDimColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Style\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"nColorName\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Default name color\",\n      \"defaultValue\": -1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Name and description\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"nColorActiveFilter\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Filter other element color\",\n      \"defaultValue\": 30,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\":"
      },
      "tokens_used": 10495,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically creates dimension lines for openings (windows, doors, cutouts) in wall sheets or panels within a shop drawing viewport.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"Generating detailed dimensions for rough openings in wall panels on production drawings, particularly when panels consist of multiple sheet layers or require specific zoning.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"nZoneProp\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Selects the specific layer or build-up index of the element (wall) to analyze. Defines which 'skin' of the wall the openings belong to.\",\n      \"validRange\": \"1-10\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Determines which set of geometric profiles (sheets) are retrieved for dimensioning. Incorrect selection may result in dimensions on the wrong layer or no dimensions.\"\n    },\n    {\n      \"name\": \"mergeSheetsProp\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Toggles the grouping of adjacent individual sheets into a single continuous profile. Useful for walls made of multiple boards where the user wants to dimension the overall aggregate opening rather than openings per board.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"If 'Yes', treats separate sheets in the zone as one unified surface; if 'No', treats them as distinct objects.\"\n    },\n    {\n      \"name\": \"mergeSheetsWithGap\",\n      \"technicalDefault\": \"10.0\",\n      \"businessMeaning\": \"The width of the joint or gap between adjacent sheets to be ignored/negated during the merge process.\",\n      \"validRange\": \"0-50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Allows the script to bridge small gaps between sheets so they merge into a single profile. Too small and profiles remain separate; too large and sheets might merge incorrectly.\"\n    },\n    {\n      \"name\": \"sFilterBC\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Exclude specific structural beams based on their Beam Code.\",\n      \"validRange\": \"String (e.g., 'SPL', 'STUD')\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Removes specified beams from the calculation of the overall element extents used for dimension positioning.\"\n    },\n    {\n      \"name\": \"sFilterLabel\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Exclude specific beams or sheets based on their assigned Label.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Filters out elements with specific labels from the dimensioning logic.\"\n    },\n    {\n      \"name\": \"sFilterMaterial\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Exclude specific beams or sheets based on their Material name.\",\n      \"validRange\": \"String (e.g., 'C24', 'OSB')\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Filters out elements made of specific materials from the dimensioning logic.\"\n    },\n    {\n      \"name\": \"sFilterHsbID\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Exclude specific entities based on their unique hsbCAD ID.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Allows precise exclusion of specific elements by ID.\"\n    },\n    {\n      \"name\": \"sFilterZone\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Exclude specific entities based on their Zone index.\",\n      \"validRange\": \"String (list of integers)\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Filters out elements belonging to specific zones.\"\n    },\n    {\n      \"name\": \"sPosition\",\n      \"technicalDefault\": \"Horizontal top\",\n      \"businessMeaning\": \"Determines where the dimension line is placed relative to the element geometry.\",\n      \"validRange\": \"Horizontal top, Horizontal bottom, Vertical left, Vertical right\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Changes the location of the dimension line (above, below, left, or right of the openings).\"\n    },\n    {\n      \"name\": \"sDimensionPerOpening\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Controls whether openings are dimensioned individually or as a single chain.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"If 'Yes', draws a separate dimension line for each opening. If 'No', draws a single cumulative dimension line covering all openings.\"\n    },\n    {\n      \"name\": \"sUsePSUnits\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Defines if the offset distance is measured in Paper Space (drawing sheet) or Model Space (real world).\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"boolean\",\n      \"affectsOutput\": \"If 'Yes', the offset is constant on the drawing page regardless of viewport scale. If 'No', the offset scales with the viewport.\"\n    },\n    {\n      \"name\": \"dOffset\",\n      \"technicalDefault\": \"6.0\",\n      \"businessMeaning\": \"The distance between the object geometry (or reference point) and the dimension line.\",\n      \"validRange\": \"1-100\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the dimension line closer or further away from the object.\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"System Default\",\n      \"businessMeaning\": \"The visual style (arrowheads, text size, ticks) applied to the dimension.\",\n      \"validRange\": \"System Dimension Styles\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Changes the appearance of the dimension entities.\"\n    },\n    {\n      \"name\": \"nDimColor\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"The AutoCAD color index for the dimension lines.\",\n      \"validRange\": \"0-256\",\n      \"unit\": \"color index\",\n      \"affectsOutput\": \"Changes the color of the generated dimensions.\"\n    },\n    {\n      \"name\": \"nColorActiveFilter\",\n      \"technicalDefault\": \"30\",\n      \"businessMeaning\": \"Color used to display the script instance when a filter is active on *other* elements.\",\n      \"validRange\": \"0-256\",\n      \"unit\": \"color index\",\n      \"affectsOutput\": \"Visual feedback on the script instance indicating it is currently filtered out.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"mergeSheetsProp is 'Yes'\",\n      \""
      },
      "tokens_used": 11848,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 13470,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_D-SheetOpening.mcr\n\n## Overview\nAutomatically creates dimension lines for openings (windows, doors, and cutouts) in wall sheets or panels within a shop drawing viewport.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed for layouts. |\n| Paper Space | Yes | This script must be run in a Layout tab. |\n| Shop Drawing | Yes | Requires a viewport containing an Element. |\n\n## Prerequisites\n- **Required Entities**: An existing Layout with a Viewport displaying an Element (e.g., a Wall or Floor).\n- **Openings**: The selected Element must contain tools (cutouts/openings) within its sheet layers.\n- **Minimum Beam Count**: 0.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_D-SheetOpening.mcr`\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click inside the viewport that shows the wall/element you want to dimension.\n```\n\n### Step 3: Select Position\n```\nCommand Line: Select a position\nAction: Click in the drawing area to define where the dimension line will be placed (e.g., above or below the wall).\n```\n\n## Properties Panel Parameters\n\n### Selection\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Zone | Number | 1 | Selects the specific layer index (1-10) of the element build-up to analyze for openings. |\n| Merge sheets | Dropdown | No | If 'Yes', treats multiple adjacent sheets as a single profile. If 'No', dimensions sheets individually. |\n| Merge sheets with gap | Number | 10.0 | The maximum gap width (mm) to ignore when merging adjacent sheets. |\n\n### Filter\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Filter beams with beamcode | Text | | Excludes beams matching this Beam Code from extent calculations. |\n| Filter beams and sheets with label | Text | | Excludes entities matching this Label. |\n| Filter beams and sheets with material | Text | | Excludes entities made of this Material. |\n| Filter beams and sheets with hsbID | Text | | Excludes entities with this specific hsbCAD ID. |\n| Filter zones | Text | | Excludes entities belonging to specific zones. |\n\n### Positioning\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Position | Dropdown | Horizontal top | Sets where the dimension line is placed (Horizontal top/bottom, Vertical left/right). |\n| Dimension per opening | Dropdown | No | If 'Yes', creates a dimension for every opening. If 'No', creates one chain dimension for all openings. |\n| Offset in paperspace units | Dropdown | No | If 'Yes', the offset distance is fixed on the printed paper. If 'No', it scales with the viewport. |\n| Offset | Number | 6.0 | Distance between the object geometry and the dimension line. |\n\n### Style\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension style | Dropdown | [System] | Selects the visual style (arrows, text) for the dimensions. |\n| Color | Number | 1 | AutoCAD color index for the dimension lines (e.g., 1 = Red, 7 = White/Black). |\n| Default name color | Number | -1 | Color index for the script instance name display. |\n| Filter other element color | Number | 30 | Color used to indicate the script is filtered out relative to other elements. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the dimensions to reflect changes in the model or property settings. |\n\n## Settings Files\nNo specific settings files are required for this script.\n\n## Tips\n- **Composite Walls**: If dimensioning a wall made of multiple narrow boards, set **Merge sheets** to \"Yes\" to create a clean dimension line across the entire aggregate opening, rather than broken lines for every board joint.\n- **Consistent Plotting**: Enable **Offset in paperspace units** if you want the dimension line to maintain the exact same distance from the wall on paper, regardless of the Viewport scale (e.g., 1:50 vs 1:100).\n- **Troubleshooting**: If dimensions do not appear, check the **Zone** property. It must match the specific layer of the wall that contains the openings.\n\n## FAQ\n- **Q: Why are my dimensions appearing in the middle of the wall instead of the edge?**\n  A: Check the **Position** property. It might be set to \"Vertical\" when you need \"Horizontal\", or the reference point selected during insertion was interpreted differently than expected.\n- **Q: What does \"Merge sheets with gap\" do?**\n  A: It allows the script to ignore small joints (e.g., 10mm gaps between OSB boards) so it treats the surface as one solid sheet for dimensioning purposes.\n- **Q: Can I dimension openings in the inner layer of a cavity wall?**\n  A: Yes. Change the **Zone** property to match the index number of the inner layer sheet."
      },
      "tokens_used": 7757,
      "error": null
    }
  }
}