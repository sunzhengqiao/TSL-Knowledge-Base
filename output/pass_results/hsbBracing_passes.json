{
  "filename": "hsbBracing.mcr",
  "status": "completed",
  "total_tokens": 50742,
  "processing_time": 205.1879210472107,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.5",
            "date": "10.05.2023",
            "author": "Thorsten Huck",
            "changes": "HSB-18650 standard display published for share and make"
          },
          {
            "version": "1.4",
            "date": "31.03.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-9044: Support side/zone changing on jig modus"
          },
          {
            "version": "1.3",
            "date": "31.03.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-9044: Support gable walls"
          },
          {
            "version": "1.2",
            "date": "28.03.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-9044: Implement for sheeting"
          },
          {
            "version": "1.1",
            "date": "28.03.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-9044: Fix angle calculation on jig mode"
          },
          {
            "version": "1.0",
            "date": "07.03.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-9044: initial version"
          }
        ],
        "settingsFiles": [
          "hsbBracing.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 8975,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script directly manipulates Element and Beam entities (e.g., el.beam(), beam.dD()) and creates Sheets using dbCreate within the 3D context. It lacks ShopDrawing-specific prefixes (sd_*, Multipage*), _Viewport references, or #Type E + _Entity[] patterns used for generating 2D drawings. The presence of eraseInstance() indicates a generative modeling script that runs and cleans up in the Model Space."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space. An Element must be selected (or active) that contains at least two beams (typically studs and horizontal plates) to define the bracing or sheeting area.",
          "requiredSettings": [
            "hsbBracing.xml"
          ]
        }
      },
      "tokens_used": 6099,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Type|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "|Cross Brace|",
              "|Sheet|"
            ],
            "category": "|General|",
            "description": "|Defines the Type of the bracing|"
          },
          {
            "index": 1,
            "variable": "sZone",
            "type": "PropString",
            "displayName": "|Zone|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "1",
              "-1"
            ],
            "category": "|General|",
            "description": "|Defines the Zone for the side of the bracing|"
          },
          {
            "index": 2,
            "variable": "sStudTie",
            "type": "PropString",
            "displayName": "|Stud Tie|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": "|General|",
            "description": "|Defines the StudTie|"
          },
          {
            "index": 3,
            "variable": "sManufacturer",
            "type": "PropString",
            "displayName": "|Manufacturer|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Manufacturer|"
          },
          {
            "index": 4,
            "variable": "sFamily",
            "type": "PropString",
            "displayName": "|Family|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Family|"
          },
          {
            "index": 5,
            "variable": "sModel",
            "type": "PropString",
            "displayName": "|Model|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Model|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "strJigAction1",
            "handler": "strJigAction1",
            "action": "Handles dynamic jig input for visual feedback during insertion/editing",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "hsbBracing.xml",
            "searchPaths": [
              "_kPathHsbCompany\\TSL\\Settings\\",
              "_kPathHsbInstall\\Content\\General\\TSL\\Settings\\"
            ],
            "purpose": "Provides configuration for Manufacturers, Families, and Models to populate dropdown properties.",
            "required": true
          }
        ]
      },
      "tokens_used": 7698,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates structural wall bracing or sheathing sheets within a selected timber wall element, automatically calculating placement based on manufacturer constraints.\",\n    \"category\": \"Framing / Structural\",\n    \"typicalUseCase\": \"A structural engineer or designer needs to add diagonal wind bracing (metal straps) or structural sheeting (OSB/Plywood) to a timber frame wall to meet racking load requirements.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sType\",\n      \"technicalDefault\": \"|Cross Brace|\",\n      \"businessMeaning\": \"Selects the method of bracing: either diagonal cross-bracing (typically metal straps) or solid sheeting (panels).\",\n      \"validRange\": \"|Cross Brace|, |Sheet|\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Switches the generation logic between creating diagonal MetalParts/GenBeams and creating rectangular Sheet entities.\"\n    },\n    {\n      \"name\": \"sZone\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Defines which side of the wall the bracing is applied to (e.g., interior vs. exterior face).\",\n      \"validRange\": \"1, -1\",\n      \"unit\": \"Side Indicator\",\n      \"affectsOutput\": \"Determines the normal vector direction for placing the bracing geometry relative to the wall's coordinate system.\"\n    },\n    {\n      \"name\": \"sStudTie\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Specifies whether to add connections (ties) where the bracing intersects the studs.\",\n      \"validRange\": \"|No|, |Yes|\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"If Yes, likely generates additional fasteners or machining at the intersection points between the brace and the wall studs.\"\n    },\n    {\n      \"name\": \"sManufacturer\",\n      \"technicalDefault\": null,\n      \"businessMeaning \"Selects the brand of the bracing product (e.g., Simpson, MiTek) to ensure geometric compatibility.\",\n      \"validRange\": \"Configurable (from hsbBracing.xml)\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Filters the available Families and Models, ensuring only products from the chosen manufacturer are available.\"\n    },\n    {\n      \"name\": \"sFamily\",\n      \"technicalDefault\": null,\n      \"businessMeaning\": \"Selects the product family within the manufacturer's catalog (e.g., specific type of strap or panel).\",\n      \"validRange\": \"Configurable (from hsbBracing.xml)\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Filters the available Models.\"\n    },\n    {\n      \"name\": \"sModel\",\n      \"technicalDefault\": null,\n      \"businessMeaning\": \"Selects the specific product model, which defines the physical dimensions (width, thickness) and engineering constraints (min/max length, min/max angle).\",\n      \"validRange\": \"Configurable (from hsbBracing.xml)\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Directly controls the size of the generated Sheets or Braces and validates if the wall geometry fits the product's engineering limits.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sManufacturer selection\",\n      \"effect\": \"Updates the list of available sFamily options.\",\n      \"cascade\": [\n        \"sFamily\"\n      ]\n    },\n    {\n      \"trigger\": \"sFamily selection\",\n      \"effect\": \"Updates the list of available sModel options.\",\n      \"cascade\": [\n        \"sModel\"\n      ]\n    },\n    {\n      \"trigger\": \"sModel selection\",\n      \"effect\": \"Loads specific geometric constraints (Width, Height, Thickness, Min/Max Angle) from the XML settings used during generation.\",\n      \"cascade\": [\n        \"dLMin\",\n        \"dLMax\",\n        \"dAngleMin\",\n        \"dAngleMax\",\n        \"dWidthSheet\",\n        \"dHeightSheet\",\n        \"dThicknessSheet\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Sheet\",\n      \"description\": \"Rectangular sheathing panels (e.g., OSB or Plywood) generated in a grid pattern to cover the specified wall area.\",\n      \"appliedTo\": \"Element (Wall)\"\n    },\n    {\n      \"type\": \"GenBeam / MetalPart\",\n      \"description\": \"Diagonal bracing elements (likely metal straps or solid timber diagonals) placed between studs based on angle and width constraints defined in the selected Model.\",\n      \"appliedTo\": \"Element (Wall) and specific Studs\"\n    },\n    {\n      \"type\": \"PlaneProfile\",\n      \"description\": \"Graphical preview indicating the valid placement area during the Jig/Insert phase.\",\n      \"appliedTo\": \"Element (Wall)\"\n    }\n  ]\n}\n```"
      },
      "tokens_used": 9550,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Initialization: Script checks for 'hsbBracing.xml' settings file in Company or Install path and loads Manufacturer/Family/Model data.\",\n    \"2. Property Selection: User configures bracing parameters via Properties Palette (Type, Zone, Stud Tie, Manufacturer, Family, Model).\",\n    \"3. Dependency Update: Selecting a Manufacturer updates the Family list; selecting a Family updates the Model list.\",\n    \"4. User Input (Jig): User clicks points in the model to define the bracing start and end (or area).\",\n    \"5. Jig Processing (Branch based on Type):\",\n    \"   - Cross Brace: Calculates diagonal geometry, checks Angle and Length against Model limits (min/max). Updates visual preview (Green/Red).\",\n    \"   - Sheet: Updates visual preview of the sheathing area.\",\n    \"6. Execution (Sheet Generation Logic):\",\n    \"   - Retrieves Wall Envelope (PlaneProfile ppSheet).\",\n    \"   - Calculates grid start point based on input points and closest Stud.\",\n    \"   - Loops through grid (Columns and Rows) based on Model dimensions (Width/Height).\",\n    \"   - Checks intersection of potential Sheet with Wall Envelope.\",\n    \"7. Entity Creation: Creates Sheet entities for valid intersections. Assigns them to the Element Group on the specified Zone.\",\n    \"8. Cleanup: Script erases its own instance (eraseInstance).\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Type Property (sType)\",\n      \"path1\": {\n        \"name\": \"Cross Brace\",\n        \"steps\": [\n          \"Retrieves Model constraints: WidthMin, WidthMax, AngleMin, AngleMax"
      },
      "tokens_used": 11873,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbBracing.mcr\n\n## Overview\nGenerates structural wall bracing (diagonal cross straps) or sheathing sheets within a selected timber wall element, automating placement based on manufacturer-specific constraints defined in external settings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script generates 3D model elements (Sheets, GenBeams, MetalParts). |\n| Paper Space | No | Not intended for 2D drawing generation. |\n| Shop Drawing | No | This is a generative modeling script, not a detailing script. |\n\n## Prerequisites\n- **Required Entities**: An Element (Wall) must be selected or active.\n- **Minimum Beams**: The Element must contain at least two beams (typically top/bottom plates and studs) to define the geometry.\n- **Required Settings**: The `hsbBracing.xml` file must be present in the specified Company or Install paths to populate manufacturer options.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbBracing.mcr` from the list.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select Element:\nAction: Click on the wall Element (or individual beams belonging to a wall) where you want to apply the bracing or sheeting.\n```\n\n### Step 3: Configure Properties\nBefore placing the bracing, open the **Properties Palette** (Ctrl+1).\n1.  **Type**: Choose between `|Cross Brace|` (diagonal straps) or `|Sheet|` (panels).\n2.  **Zone**: Select `1` or `-1` to define which side of the wall the bracing applies to.\n3.  **Manufacturer**: Select a brand from the dropdown (populated from XML).\n4.  **Family**: Select the product family (filtered by Manufacturer).\n5.  **Model**: Select the specific model code (filtered by Family).\n6.  **Stud Tie**: Set to `|Yes|` if you want automatic connections/ties at stud intersections.\n\n### Step 4: Define Placement (Jig Mode)\n```\nCommand Line: Specify start point:\nAction: Click in the model to define the start corner of the bracing area.\n\nCommand Line: Specify end point:\nAction: Click to define the opposite corner.\nNote: A visual preview will appear. For Cross Braces, ensure the preview is Green (valid). Red indicates the angle or length exceeds the Model's limits.\n```\n\n### Step 5: Generation\nThe script will automatically generate the Sheets or Cross Braces, assign them to the correct Element group on the specified side, and then erase its own instance.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Options | Description |\n|-----------|------|---------|-------------|\n| |Type| |Dropdown| \\|Cross Brace\\|, \\|Sheet\\| |Defines the type of bracing to generate: diagonal straps or solid sheathing panels. |\n| |Zone| |Dropdown| 1, -1 |Defines which side of the wall the bracing is applied to (e.g., interior vs exterior face). |\n| |Stud Tie| |Dropdown| \\|No\\|, \\|Yes\\| |If \"Yes\", generates connections or machining where the bracing intersects wall studs. |\n| |Manufacturer| |Dropdown| *(From XML)* |Selects the product brand (e.g., Simpson, MiTek). |\n| |Family| |Dropdown| *(From XML)* |Selects the product category (e.g., strap type). List updates based on Manufacturer. |\n| |Model| |Dropdown| *(From XML)* |Selects the specific product size/constraints. List updates based on Family. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| strJigAction1 | Triggers the visual Jig mode again, allowing you to re-click points to adjust the bracing area or angle dynamically. |\n\n## Settings Files\n- **Filename**: `hsbBracing.xml`\n- **Location**: \n  - `_kPathHsbCompany\\TSL\\Settings\\`\n  - `_kPathHsbInstall\\Content\\General\\TSL\\Settings\\`\n- **Purpose**: Contains the catalog of Manufacturers, Families, and Models, along with their geometric constraints (min/max angle, width, height, thickness).\n\n## Tips\n- **Missing Data**: If the Manufacturer, Family, or Model dropdowns are empty, check that `hsbBracing.xml` is located in one of the Settings folders listed above.\n- **Visual Validation**: When inserting `|Cross Brace|`, watch the preview color. Green means the angle fits the manufacturer's specs; Red means it is too steep or too shallow for the selected model.\n- **Grid Alignment**: For `|Sheet|` types, the script automatically calculates a grid based on the Model's dimensions and aligns it to the wall geometry and stud layout.\n\n## FAQ\n- **Q: Why does the script not create any bracing?**\n  A: Ensure you have selected a valid `sModel` in the properties. If the wall dimensions are smaller than the minimum size defined in the XML, the script may generate nothing.\n  \n- **Q: How do I switch the bracing to the other side of the wall?**\n  A: Change the `sZone` property in the Properties Palette from `1` to `-1` (or vice versa) and run the Jig action or re-insert the script.\n\n- **Q: Can I use this for gable walls?**\n  A: Yes, the script supports gable walls (implemented in v1.3). Ensure your selection includes the gable geometry."
      },
      "tokens_used": 6547,
      "error": null
    }
  }
}