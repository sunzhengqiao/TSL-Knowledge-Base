{
  "filename": "GE_BEAM_CREATE_ANY_LUMBER_ITEM.mcr",
  "status": "completed",
  "total_tokens": 38688,
  "processing_time": 297.66589283943176,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.4",
            "date": "03.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Stickframe path added to mapIn when calling dll"
          },
          {
            "version": "1.3",
            "date": "29.ago.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Strings added to translation"
          },
          {
            "version": "1.2",
            "date": "15.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail updated"
          },
          {
            "version": "1.1",
            "date": "25.jul.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added"
          },
          {
            "version": "1.0",
            "date": "24.jul.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5895,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates geometry using Beam.dbCreate() based on Point3d inputs obtained via getPoint(). No interaction with Viewports, sd_ prefixes, or _Entity arrays."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll"
          ]
        }
      },
      "tokens_used": 4408,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 7987,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a single generic timber beam (blocking or miscellaneous lumber) between two user-selected points, allowing selection from a pre-defined inventory list or manual size entry.",
          "category": "Framing",
          "typicalUseCase": "Creating blocking, nogs, stiffeners, or temporary members where a specific beam from the inventory is required but a specific tool (e.g., wall generation) is not being used."
        },
        "parameters": [
          {
            "name": "sBmLumberItem",
            "technicalDefault": "First item in Inventory list",
            "businessMeaning": "Selects a predefined timber profile (Material, Grade, Width, Height) from the hsbCAD Inventory database.",
            "validRange": "List of valid keys from hsbFramingDefaults.Inventory.dll or 'Manual Size'",
            "unit": "Selection",
            "affectsOutput": "Determines the cross-section dimensions (Width/Height), material grade, and name of the beam unless overridden by manual settings."
          },
          {
            "name": "dBlockWidthOPM",
            "technicalDefault": "U(35, 1.5)",
            "businessMeaning": "The width (thickness) of the beam when 'Manual Size' is selected, or if used to override inventory values.",
            "validRange": "15mm to 300mm",
            "unit": "mm",
            "affectsOutput": "The horizontal width of the generated beam geometry."
          },
          {
            "name": "dBlockHeightOPM",
            "technicalDefault": "U(42, 3.5)",
            "businessMeaning": "The height (depth) of the beam when 'Manual Size' is selected, or if used to override inventory values.",
            "validRange": "35mm to 600mm",
            "unit": "mm",
            "affectsOutput": "The vertical height of the generated beam geometry."
          },
          {
            "name": "sBlockType",
            "technicalDefault": "28 (Solid Stud)",
            "businessMeaning": "Classifies the beam for reporting, nesting, and material take-off purposes (e.g., Stud, Joist, Blocking).",
            "validRange": "Any integer from the _BeamTypes list (0-31 typically)",
            "unit": "Index",
            "affectsOutput": "Sets the entity type property of the beam in the CAD model."
          },
          {
            "name": "nBlockColorOPM",
            "technicalDefault": "32",
            "businessMeaning": "The visual display color of the beam in the 3D model and 2D drawings.",
            "validRange": "0 to 255 (AutoCAD Color Index) or -1 (ByLayer)",
            "unit": "ACI",
            "affectsOutput": "Graphical representation in ModelSpace."
          },
          {
            "name": "sBlockNameOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "A user-defined name or tag for the specific beam instance.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Populates the 'Name' attribute of the beam entity."
          },
          {
            "name": "sBlockMaterialOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Overrides the material species (e.g., Spruce, Pine, LVL) defined in the selected Lumber Item.",
            "validRange": "Any text string matching standard materials",
            "unit": "Text",
            "affectsOutput": "Updates the beam's material property for schedules and reporting."
          },
          {
            "name": "sBlockGradeOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Overrides the structural grade (e.g., C24, SS) defined in the selected Lumber Item.",
            "validRange": "Any text string matching standard grades",
            "unit": "Text",
            "affectsOutput": "Updates the beam's grade property for engineering reports."
          },
          {
            "name": "dElevation",
            "technicalDefault": "0",
            "businessMeaning": "Vertical Z-offset applied to the start point, moving the beam up or down from the clicked location.",
            "validRange": "-5000mm to 5000mm",
            "unit": "mm",
            "affectsOutput": "Shifts the beam vertically in 3D space relative to the input points."
          },
          {
            "name": "sBlockInformationOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Custom notes or additional data appended to the beam entity.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Populates the 'Information' field of the beam."
          },
          {
            "name": "sBlockLabelOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Primary label or marker text associated with the beam.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Sets the beam's Label property."
          },
          {
            "name": "sBlockSubLabelOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Secondary label or marker text.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Sets the beam's SubLabel property."
          },
          {
            "name": "sBlockSubLabel2OPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Tertiary label or marker text.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Sets the beam's SubLabel2 property."
          },
          {
            "name": "sBlockBeamCodeOPM",
            "technicalDefault": "\"\"",
            "businessMeaning": "Specific production code for CNC machinery or factory logic.",
            "validRange": "Any text string",
            "unit": "Text",
            "affectsOutput": "Sets the beam's BeamCode property."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sBmLumberItem is set to 'Manual Size'",
            "effect": "Enables and requires input from dBlockWidthOPM and dBlockHeightOPM to define geometry. Ignores inventory dimensions.",
            "cascade": [
              "dBlockWidthOPM",
              "dBlockHeightOPM"
            ]
          },
          {
            "trigger": "sBlockMaterialOPM or sBlockGradeOPM is not empty",
            "effect": "Overwrites the Material and Grade values derived from the sBmLumberItem selection.",
            "cascade": [
              "sBlockMaterial",
              "sBlockGrade"
            ]
          },
          {
            "trigger": "dBlockWidth or dBlockHeight <= 0",
            "effect": "Script execution aborts and deletes the instance, reporting a data incomplete error.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "A linear timber element created between two points in 3D space.",
            "appliedTo": "Model Space"
          }
        ]
      },
      "tokens_used": 6611,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Initialization: Load Lumber Inventory list from hsbFramingDefaults.Inventory.dll and populate selection arrays.",
          "2. Insertion Trigger: Script instance is created in Model Space.",
          "3. Initial Setup: If inserting for the first time, display configuration dialog (showDialogOnce) to set initial properties.",
          "4. Point Input: Prompt user to select Start Point (getPoint) and store in Map.",
          "5. Point Input: Prompt user to select End Point (PrPoint) and store in Map.",
          "6. Property Resolution: Determine Width, Height, Material, and Grade based on selected Lumber Item or Manual inputs.",
          "7. Validation: Check if Width and Height are greater than zero.",
          "8. Geometry Calculation: Calculate beam vector, adjust Z-axis based on Elevation and Height/2 to center beam, and align End point to Start point height.",
          "9. Entity Creation: Execute Beam.dbCreate with calculated parameters.",
          "10. Attribute Assignment: Apply Name, Material, Grade, Type, Color, and Labels to the new Beam.",
          "11. Cleanup: Erase the script instance (eraseInstance), leaving only the generated Beam."
        ],
        "conditionalBranches": [
          {
            "condition": "Source of Lumber Dimensions",
            "path1": {
              "name": "Inventory Item Selected",
              "steps": [
                "Script identifies selection index from sLumberItemNames array.",
                "Script iterates through mapOut (DLL result) using the corresponding Key.",
                "Extracts WIDTH, HEIGHT, HSB_MATERIAL, and HSB_GRADE from Inventory."
              ]
            },
            "path2": {
              "name": "Manual Size Selected",
              "steps": [
                "Script identifies that 'Manual Size' is the selected item (last index).",
                "Script ignores Inventory values.",
                "Extracts dimensions from dBlockWidthOPM and dBlockHeightOPM.",
                "Sets Material and Grade to empty strings initially."
              ]
            }
          },
          {
            "condition": "Material/Grade Overwrite",
            "path1": {
              "name": "OPM Fields are Empty",
              "steps": [
                "Use Material and Grade derived from Inventory (if Inventory path taken) or leave blank (if Manual path taken)."
              ]
            },
            "path2": {
              "name": "OPM Fields Contain Text",
              "steps": [
                "Override derived Material with sBlockMaterialOPM.",
                "Override derived Grade with sBlockGradeOPM."
              ]
            }
          },
          {
            "condition": "Geometry Validation",
            "path1": {
              "name": "Valid Geometry (Width>0 and Height>0)",
              "steps": [
                "Proceed to create beam.",
                "Set 'ExecutionMode' in Map to 1."
              ]
            },
            "path2": {
              "name": "Invalid Geometry (Width<=0 or Height<=0)",
              "steps": [
                "Display ReportNotice: 'Data incomplete, check values...'.",
                "Execute eraseInstance().",
                "Script terminates without creating geometry."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Dimensions (Width and Height)",
            "errorMessage": "Data incomplete, check values for selected lumber item. Lists Name, Material, Grade, Width, and Height.",
            "recovery": "User must insert the script again and ensure a valid Lumber Item is selected or valid Manual Sizes are entered."
          },
          {
            "check": "Color Index (nBlockColorOPM)",
            "errorMessage": "None (Silent correction)",
            "recovery": "Script automatically resets the color to 32 (default) if the value is outside the range [-1, 255]."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Beam Geometry or Properties",
            "how": "Direct Grips / Beam Properties Palette (since script instance is erased)",
            "effect": "Because the script executes 'eraseInstance()' at the end, the TSL instance no longer exists. The user modifies the resulting 'Beam' entity using standard AutoCAD/hsbCAD beam editing tools (stretches, properties palette), not the TSL script parameters."
          }
        ]
      },
      "tokens_used": 7777,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_CREATE_ANY_LUMBER_ITEM\n\n## Overview\nCreates a single generic timber beam (such as blocking, nogs, or stiffeners) between two user-selected points. It allows you to select a profile from a predefined inventory list or enter manual dimensions.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment for creating 3D beams. |\n| Paper Space | No | Not designed for 2D layout views. |\n| Shop Drawing | No | Not used for generating drawings directly. |\n\n## Prerequisites\n- **Required entities**: None.\n- **Minimum beam count**: 0.\n- **Required settings**: `hsbFramingDefaults.Inventory.dll` must be configured with available lumber items.\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command**: `TSLINSERT`\n**Action**: Browse and select `GE_BEAM_CREATE_ANY_LUMBER_ITEM.mcr`.\n\n### Step 2: Configuration\n**Action**: A dialog will appear upon first insertion. Select the desired **Lumber Item** from the inventory list or choose \"Manual Size\" to define dimensions yourself.\n\n### Step 3: Define Start Point\n```\nCommand Line: Specify start point:\nAction: Click in the Model Space to set the beginning of the beam.\n```\n\n### Step 4: Define End Point\n```\nCommand Line: Specify end point:\nAction: Click to set the endpoint of the beam. The beam will be generated, and the script instance will automatically disappear, leaving a standard beam entity.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Lumber Item | Dropdown | *First in List* | Select a predefined profile from the inventory or \"Manual Size\". |\n| Width | Number | 35 mm | The thickness (width) of the beam. Used when \"Manual Size\" is selected. |\n| Height | Number | 42 mm | The depth (height) of the beam. Used when \"Manual Size\" is selected. |\n| Block Type | Index | 28 (Solid Stud) | Classifies the beam for reporting (e.g., Stud, Joist, Blocking). |\n| Color | Number | 32 | The display color of the beam (AutoCAD Color Index). |\n| Name | Text | *Empty* | A user-defined name or tag for the beam. |\n| Material | Text | *Empty* | Overrides the material species from the inventory selection. |\n| Grade | Text | *Empty* | Overrides the structural grade from the inventory selection. |\n| Elevation | Number | 0 mm | Vertical Z-offset applied to the start point. Shifts the beam up or down. |\n| Information | Text | *Empty* | Custom notes appended to the beam entity. |\n| Label | Text | *Empty* | Primary label or marker text. |\n| SubLabel | Text | *Empty* | Secondary label or marker text. |\n| SubLabel2 | Text | *Empty* | Tertiary label or marker text. |\n| BeamCode | Text | *Empty* | Production code for CNC machinery or factory logic. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | The script instance erases itself immediately after creating the beam. To modify the beam, use the standard AutoCAD/hsbCAD properties and grips on the resulting beam object. |\n\n## Settings Files\n- **Filename**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: hsbCAD Install path or Company Standards folder.\n- **Purpose**: Provides the list of available Lumber Items (Materials, Grades, and Dimensions) used in the Lumber Item dropdown.\n\n## Tips\n- **Manual Dimensions**: If you select \"Manual Size\" in the Lumber Item dropdown, ensure you manually input valid values for Width and Height in the properties palette before insertion.\n- **Vertical Adjustment**: Use the **Elevation** property to place blocking at specific heights relative to the points you click, which is useful for mid-height blocking in walls.\n- **Post-Creation Editing**: Once created, the beam is a standard hsbCAD entity. You can stretch it using grips or change its properties via the Properties Palette.\n- **Overrides**: You can use the **Material** and **Grade** fields in the properties to quickly switch species or grade without changing the Inventory selection.\n\n## FAQ\n- **Q: Why can't I find the script to edit it after insertion?**\n  A: The script is designed to \"run once\" and delete itself (`eraseInstance`). It converts itself into a native beam entity for better performance in the model.\n- **Q: What happens if my dimensions are 0 or negative?**\n  A: The script will detect invalid dimensions, display an error (\"Data incomplete...\"), and abort the creation process without leaving any geometry.\n- **Q: Can I use this to create curved beams?**\n  A: No, this script creates straight linear beams between two defined points."
      },
      "tokens_used": 6010,
      "error": null
    }
  }
}