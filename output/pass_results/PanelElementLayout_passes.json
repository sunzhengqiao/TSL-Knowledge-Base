{
  "filename": "PanelElementLayout.mcr",
  "status": "completed",
  "total_tokens": 60289,
  "processing_time": 480.5679259300232,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "Primarily intended to be inserted by the user on PS Viewports",
        "versionHistory": [
          {
            "version": "0.1",
            "date": "January2009",
            "author": "Craig Colomb",
            "changes": "Initial inception"
          },
          {
            "version": "0.5",
            "date": "11MARCH2009",
            "author": "Craig Colomb",
            "changes": "Bugfixes, added tolerance property, option to limit extension lines"
          },
          {
            "version": "0.55",
            "date": "15June2009",
            "author": "Craig Colomb",
            "changes": "Bugfix on sorting unique points (avoid redundant dimensions)"
          },
          {
            "version": "0.60",
            "date": "16Oct2009",
            "author": "Craig Colomb",
            "changes": "Added dimensioning for Far face of element"
          },
          {
            "version": "0.65",
            "date": "22Oct2009",
            "author": "Craig Colomb",
            "changes": "Bugfix on farside dimcolor"
          },
          {
            "version": "0.75",
            "date": "20March2010",
            "author": "Craig Colomb",
            "changes": "Revised to dimension per panel, and added Roof functionality"
          },
          {
            "version": "0.80",
            "date": "7April2010",
            "author": "Craig Colomb",
            "changes": "bugfix on point collection & sorting"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8386,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly calls `getViewport(T(\"Select a viewport\"))` during `_bOnInsert`, which is a Paper Space specific operation. It stores the viewport in `_Viewport` and calculates coordinate transformations using `vp.coordSys()` (ms2ps) and `ps2ms`. Dimensions are transformed via `dmNear.transformBy(ms2ps)` before drawing. The file header comments state: 'For use on a static HSB Viewport in PS.'"
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout Tab)",
          "requiredSettings": []
        }
      },
      "tokens_used": 7159,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"Select a viewport\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"psDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension Style Near\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"psDimStyleFar\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension Style Far\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"psBeamDimstyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Beam Dimstyle\",\n      \"defaultValue\": \"|Do Not Dimension|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Do Not Dimension|\",\n        \"|Combine with Near|\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"pdChainSpace\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Dimension Chain Spacing\",\n      \"defaultValue\": \"1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"pdDimPointTol\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Dimension point tolerance\",\n      \"defaultValue\": \".125\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"psDimLimit\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Limit Extension Lines\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"psDimWhat\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Detail Level\",\n      \"defaultValue\": \"Extremes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Extremes\",\n        \"All Points\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"psDrawTopDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Display Top Dim\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"psDrawBotDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Display Bottom Dim\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"psDrawLeftDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Display Left Dim\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"psDrawRightDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Display Right Dim\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"psDimConnectedElements\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dim Connected Female Elements\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"psUseGrips\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Use Grips\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"pdDimOffTop\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Top Dim Offset\",\n      \"defaultValue\": \"12\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"pdDimOffBot\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Bottom Dim Offset\",\n      \"defaultValue\": \"12\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"pdDimOffLeft\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Left Dim Offset\",\n      \"defaultValue\": \"12\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"pdDimOffRight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Right Dim Offset\",\n      \"defaultValue\": \"12\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"psAddSipPtsLeft\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Add Sip Points Left\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"psAddSipPtsRight\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Add Sip Points Right\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"psDimTypeTop\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Top Dim Type\",\n      \"defaultValue\": \"Delta\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Delta\",\n        \"Cummulative\",\n        \"Both\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"psDimTypeBot\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Bottom Dim Type\",\n      \"defaultValue\": \"Delta\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Delta\",\n        \"Cummulative\",\n        \"Both\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"psDimTypeLeft\",\n      \"type\":"
      },
      "tokens_used": 10076,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automates the dimensioning of Wall or Roof panel elements in Paper Space viewports, creating detailed shop drawings with configurable offsets, styles, and detail levels.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"Generating production drawings for timber frame panels where overall dimensions, intermediate stud/joist locations, and elevation markers need to be placed automatically around the panel in a layout view.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"psDimStyle\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The visual style (text size, arrowheads, precision) applied to dimensions on the side of the panel facing the viewer.\",\n      \"validRange\": \"Any valid AutoCAD dimstyle name in the drawing\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Visual appearance (text height, arrows) of the front-face dimensions.\"\n    },\n    {\n      \"name\": \"psDimStyleFar\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The visual style applied to dimensions on the back (far) side of the panel.\",\n      \"validRange\": \"Any valid AutoCAD dimstyle name in the drawing\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Visual appearance of the back-face dimensions.\"\n    },\n    {\n      \"name\": \"psBeamDimstyle\",\n      \"technicalDefault\": \"|Do Not Dimension|\",\n      \"businessMeaning\": \"Determines how internal members (studs/joists) are dimensioned. 'Do Not Dimension' ignores them; 'Combine with Near' adds their positions to the main dimension chain.\",\n      \"validRange\": \"|Do Not Dimension|, |Combine with Near|\",\n      \"unit\": \"Enumeration\",\n      \"affectsOutput\": \"Presence or absence of dimensions for internal framing members.\"\n    },\n    {\n      \"name\": \"pdChainSpace\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"The vertical or horizontal distance between stacked dimension lines (e.g., between the overall height dimension and the delta dimensions).\",\n      \"validRange\": \"0.1 to 10.0 inches (drawing units)\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Spacing between parallel dimension lines to ensure text legibility.\"\n    },\n    {\n      \"name\": \"pdDimPointTol\",\n      \"technicalDefault\": \".125\",\n      \"businessMeaning\": \"The tolerance used to merge dimension points that are close together. Points closer than this distance are treated as the same point to avoid duplicate dimensions.\",\n      \"validRange\": \"0.0 to 2.0 inches\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Filtering of redundant or nearly-coincident dimension points.\"\n    },\n    {\n      \"name\": \"psDimLimit\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"If 'Yes', dimension extension lines (the vertical lines) stop at the panel geometry. If 'No', they extend fully to the dimension line.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Length and termination of dimension extension lines.\"\n    },\n    {\n      \"name\": \"psDimWhat\",\n      \"technicalDefault\": \"Extremes\",\n      \"businessMeaning\": \"Controls the amount of detail dimensioned. 'Extremes' dimensions only the overall width/height. 'All Points' dimensions every vertex, step, or opening in the wall.\",\n      \"validRange\": \"Extremes, All Points\",\n      \"unit\": \"Enumeration\",\n      \"affectsOutput\": \"Number of dimension points generated (Overall envelope vs. detailed geometry).\"\n    },\n    {\n      \"name\": \"psDrawTopDim\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggle to enable or disable dimensioning on the top edge of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Presence of dimensions above the panel.\"\n    },\n    {\n      \"name\": \"psDrawBotDim\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggle to enable or disable dimensioning on the bottom edge of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Presence of dimensions below the panel.\"\n    },\n    {\n      \"name\": \"psDrawLeftDim\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggle to enable or disable dimensioning on the left edge of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Presence of dimensions to the left of the panel.\"\n    },\n    {\n      \"name\": \"psDrawRightDim\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggle to enable or disable dimensioning on the right edge of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Presence of dimensions to the right of the panel.\"\n    },\n    {\n      \"name\": \"psDimConnectedElements\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Controls whether to include dimensions for intersecting elements (e.g., perpendicular walls) attached to the main panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Inclusion of geometry from connected elements in the dimension calculation.\"\n    },\n    {\n      \"name\": \"psUseGrips\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Enables interactive 'Grips' (handles) on the dimension lines, allowing the user to drag and adjust dimension locations directly in the CAD view.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Interaction capability (Editability) of the generated dimensions.\"\n    },\n    {\n      \"name\": \"pdDimOffTop\",\n      \"technicalDefault\": \"12\",\n      \"businessMeaning\": \"The distance from the top edge of the panel to the first dimension line.\",\n      \"validRange\": \"2 to 100 inches\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Position of the top dimension string.\"\n    },\n    {\n      \"name\": \"pdDimOffBot\",\n      \"technicalDefault\": \"12\",\n      \"businessMeaning\": \"The distance from the bottom edge of the panel to the first dimension line.\",\n      \"validRange\": \"2 to 100 inches\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Position of the bottom dimension string.\"\n    },\n    {\n      \"name\": \"pdDimOffLeft\",\n      \"technicalDefault\": \"12\",\n      \"businessMeaning\": \"The distance from the left edge of the panel to the first dimension line.\",\n      \"validRange\": \"2 to 100 inches\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Position of the left dimension string.\"\n    },\n    {\n      \"name\": \"pdDimOffRight\",\n      \"technicalDefault\": \"12\",\n      \"businessMeaning\": \"The distance from the right edge of the panel to the first dimension line.\",\n      \"validRange\": \"2 to 100 inches\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Position of the right dimension string.\"\n    },\n    {\n      \"name\": \"psAddSipPtsLeft\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Includes dimension points for specific sub-elements or inserts on the left side of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Number of dimension points on the left vertical edge.\"\n    },\n    {\n      \"name\": \"psAddSipPtsRight\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Includes dimension points for specific sub-elements or inserts on the right side of the panel.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Number of dimension points on the right vertical edge.\"\n    },\n    {\n      \"name\": \"psDimTypeTop\",\n      \"technicalDefault\": \"Delta\",\n      \"businessMeaning\": \"The type of dimensioning logic used for the top edge. 'Delta' shows individual spacing, 'Cumulative' shows running total, 'Both' shows stacked lines.\",\n      \"validRange\": \"Delta, Cumulative, Both\",\n      \"unit\": \"Enumeration\",\n      \"affectsOutput\": \"Logical layout and values of top dimensions.\"\n    },\n    {\n      \"name\": \"psDimTypeBot\",\n      \"technicalDefault\": \"Delta\",\n      \"businessMeaning\": \"The type of dimensioning logic used for the bottom edge.\",\n      \"validRange\": \"Delta, Cumulative, Both\",\n      \"unit\": \"Enumeration\",\n      \"affectsOutput\": \"Logical layout and values of bottom dimensions.\"\n    },\n    {\n      \"name\": \"psDimTypeLeft\",\n      \"technicalDefault\": \"Delta\",\n      \"businessMeaning\": \"The type of dimensioning logic"
      },
      "tokens_used": 11720,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Execution initiated.",
          "2. User prompted to select a Paper Space (PS) Viewport.",
          "3. Script validates the selected Viewport and retrieves the associated Element.",
          "4. Element is checked for Sips (geometry segments).",
          "5. Coordinate transformation (Model Space to Paper Space) is established.",
          "6. Dimension lines are calculated for Top, Right, Bottom, and Left sides based on offsets and scale.",
          "7. Geometry points are collected for each side based on 'Detail Level' and 'Connected Elements' settings.",
          "8. Points are filtered: User-added points included, User-removed points excluded, duplicates removed based on tolerance.",
          "9. Dimension objects are created and transformed to Paper Space.",
          "10. Dimensions are drawn to the Display.",
          "11. Post-Insertion Loop: User can modify Properties, drag Grips, or use Context Menu items to refine points, triggering recalculation."
        ],
        "conditionalBranches": [
          {
            "condition": "Presence of Geometry (Sips)",
            "path1": {
              "name": "Valid Geometry",
              "steps": [
                "Proceed to calculate envelope and dimensions.",
                "Generate Near and Far side dimensions."
              ]
            },
            "path2": {
              "name": "No Geometry",
              "steps": [
                "Draw 'Nothing to dimension' text at Viewport center.",
                "Halt execution."
              ]
            }
          },
          {
            "condition": "Side Display Toggles (psDrawTopDim, psDrawRightDim, etc.)",
            "path1": {
              "name": "Enabled (Yes)",
              "steps": [
                "Calculate dimension line position.",
                "Collect and filter points.",
                "Draw dimensions for that side."
              ]
            },
            "path2": {
              "name": "Disabled (No)",
              "steps": [
                "Skip dimension generation for that side.",
                "Continue to next side."
              ]
            }
          },
          {
            "condition": "Extension Line Limit (psDimLimit)",
            "path1": {
              "name": "Limit (Yes)",
              "steps": [
                "Project dimension points onto the Element's outline profile.",
                "Extension lines stop at the panel geometry."
              ]
            },
            "path2": {
              "name": "No Limit",
              "steps": [
                "Project points perpendicular to the dimension line.",
                "Extension lines extend fully to the dimension text."
              ]
            }
          },
          {
            "condition": "Vertical Dimension & Elevation Value (pdAddElevation > 0)",
            "path1": {
              "name": "Apply Elevation",
              "steps": [
                "Calculate vertical distance from reference point.",
                "Add elevation offset value.",
                "Override dimension text with formatted string."
              ]
            },
            "path2": {
              "name": "Standard Dimensioning",
              "steps": [
                "Use standard dimension measurement."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Selection",
            "errorMessage": "Script erases instance if no viewport is stored in internal array.",
            "recovery": "Re-insert the script and select a valid Viewport."
          },
          {
            "check": "Element Validity",
            "errorMessage": "Display 'Nothing to dimension' if Element has no Sips (segments).",
            "recovery": "Ensure the Viewport contains a valid Wall or Roof Element with geometry."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Dimension Offsets and Styles",
            "how": "OPM (AutoCAD Properties Palette)",
            "effect": "Updates the position, style, and type (Delta/Cumulative) of dimensions immediately upon change."
          },
          {
            "action": "Add/Remove Dimension Points",
            "how": "Right-click Context Menu (Add Near Points, Remove Near Points, etc.)",
            "effect": "Opens a selection loop. User clicks in Paper Space to add points or remove existing points from the dimension chain."
          },
          {
            "action": "Move Dimension Lines",
            "how": "Grip Edit",
            "effect": "If 'Use Grips' is enabled, user can drag the dimension line (arrow/text) to a new location."
          },
          {
            "action": "Reset Manual Modifications",
            "how": "Right-click Context Menu (Reset Added/Removed Points)",
            "effect": "Clears the arrays of manually added or removed points, reverting to the automatic geometric dimensioning."
          }
        ]
      },
      "tokens_used": 13231,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# PanelElementLayout.mcr\n\n## Overview\nThis script automates the dimensioning of Wall or Roof panel elements directly in Paper Space viewports. It creates detailed shop drawings by generating configurable dimension chains, offsets, and elevation markers around the selected panel geometry.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script operates specifically on Layout tabs. |\n| Paper Space | Yes | Designed for use on static hsbCAD Viewports. |\n| Shop Drawing | Yes | Used for generating production drawings. |\n\n## Prerequisites\n- **Required Entities**: A Paper Space Viewport containing a Wall or Roof Element (with geometry).\n- **Minimum Beam Count**: 0.\n- **Required Settings**: Valid AutoCAD Dimension Styles must exist in the drawing for the script to reference.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `PanelElementLayout.mcr`\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the viewport border that displays the Wall or Roof element you wish to dimension.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension Style Near | String | *Empty* | The AutoCAD dimension style to use for the front face of the panel. |\n| Dimension Style Far | String | *Empty* | The AutoCAD dimension style to use for the back (far) face of the panel. |\n| Beam Dimstyle | Dropdown | \\|Do Not Dimension\\| | Determines how internal members (studs/joists) are dimensioned. Choose \"\\|Do Not Dimension\\|\" or \"\\|Combine with Near\\|\". |\n| Dimension Chain Spacing | Number | 1 | The distance between stacked dimension lines (e.g., between overall height and detailed dimensions). |\n| Dimension point tolerance | Number | .125 | Points closer than this distance (in inches) are merged to prevent duplicate dimensions. |\n| Limit Extension Lines | Dropdown | Yes | If \"Yes\", extension lines stop at the panel geometry. If \"No\", they extend fully to the dimension line. |\n| Detail Level | Dropdown | Extremes | Sets the detail level. \"Extremes\" dimensions only the overall width/height; \"All Points\" dimensions every vertex and opening. |\n| Display Top Dim | Dropdown | Yes | Toggle to enable or disable dimensioning on the top edge. |\n| Display Bottom Dim | Dropdown | Yes | Toggle to enable or disable dimensioning on the bottom edge. |\n| Display Left Dim | Dropdown | Yes | Toggle to enable or disable dimensioning on the left edge. |\n| Display Right Dim | Dropdown | Yes | Toggle to enable or disable dimensioning on the right edge. |\n| Dim Connected Female Elements | Dropdown | Yes | If \"Yes\", includes dimensions for intersecting elements (e.g., perpendicular walls) attached to the main panel. |\n| Use Grips | Dropdown | Yes | If \"Yes\", enables interactive handles (Grips) on dimension lines for dragging and adjusting locations. |\n| Top Dim Offset | Number | 12 | Distance from the top edge of the panel to the first dimension line. |\n| Bottom Dim Offset | Number | 12 | Distance from the bottom edge of the panel to the first dimension line. |\n| Left Dim Offset | Number | 12 | Distance from the left edge of the panel to the first dimension line. |\n| Right Dim Offset | Number | 12 | Distance from the right edge of the panel to the first dimension line. |\n| Add Sip Points Left | Dropdown | Yes | Includes dimension points for specific sub-elements on the left side. |\n| Add Sip Points Right | Dropdown | Yes | Includes dimension points for specific sub-elements on the right side. |\n| Top Dim Type | Dropdown | Delta | Sets the logic: \"Delta\" (individual spacing), \"Cummulative\" (running total), or \"Both\". |\n| Bottom Dim Type | Dropdown | Delta | Sets the logic: \"Delta\", \"Cummulative\", or \"Both\". |\n| Left Dim Type | Dropdown | Delta | Sets the logic: \"Delta\", \"Cummulative\", or \"Both\". |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Add Near Points | Allows you to click in Paper Space to add custom points to the front-face dimension chain. |\n| Remove Near Points | Allows you to click on existing dimension points to remove them from the chain. |\n| Reset Added/Removed Points | Clears all manually added or removed points, reverting to the automatic geometric calculation. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies on standard AutoCAD properties and does not require external XML settings files.\n\n## Tips\n- **Cleaner Drawings**: Set **Detail Level** to \"Extremes\" for overall dimensions only, or \"All Points\" for full fabrication details.\n- **Adjusting Layouts**: If dimensions overlap with other annotations, use the **Grips** (if enabled) or increase the **Dim Offset** properties to move the dimension strings further away from the panel.\n- **Tolerance**: If you see duplicate dimensions very close to each other, slightly increase the **Dimension point tolerance** to merge them.\n\n## FAQ\n- **Q: The script displays \"Nothing to dimension\" in the viewport.**\n  - **A:** This means the selected viewport does not contain a valid Wall or Roof Element with geometry (Sips). Ensure the element is generated and visible in Model Space.\n- **Q: Can I dimension the back side of the panel differently?**\n  - **A:** Yes. Set the **Dimension Style Far** property to a different AutoCAD style (e.g., one with dashed lines or a different color) to distinguish back-face dimensions.\n- **Q: How do I move a dimension line without changing the offset property for all sides?**\n  - **A:** Ensure **Use Grips** is set to \"Yes\". Select the script instance, click the square grip on the dimension text/arrow, and drag it to the desired location."
      },
      "tokens_used": 9717,
      "error": null
    }
  }
}