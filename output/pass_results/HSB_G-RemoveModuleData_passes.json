{
  "filename": "HSB_G-RemoveModuleData.mcr",
  "status": "completed",
  "total_tokens": 14026,
  "processing_time": 174.5176477432251,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2329,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses PrEntity to select GenBeam objects directly from the drawing. It does not use sd_ prefixes, _Viewport, or #Type E patterns. It immediately erases the instance (_bOnInsert block) after processing, which is typical for single-run command-line utilities operating on model entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing GenBeam entities",
          "requiredSettings": []
        }
      },
      "tokens_used": 993,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select entities|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1474,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script used to remove the 'Module' property assignment from selected timber beams, effectively dissociating them from specific manufacturing or export groups.",
          "category": "Utility/DataManagement",
          "typicalUseCase": "When a user needs to reclassify beams that were accidentally assigned to a module, or when preparing a selection of beams to be ungrouped before re-processing."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Prompt: 'Select entities', Filter: GenBeam()",
            "businessMeaning": "The selection of timber beams (GenBeams) that the user wishes to remove from a module group.",
            "validRange": "1 to N existing GenBeam entities in the drawing",
            "unit": "Count (Entities)",
            "affectsOutput": "Resets the internal 'Module' string property of the selected beams to an empty string (NULL), removing any logical grouping data attached to them."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "PropertyUpdate",
            "description": "Clears the 'Module' name/ID from the entity properties.",
            "appliedTo": "User-selected GenBeam entities"
          }
        ]
      },
      "tokens_used": 2915,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches the script (insertion via toolbar or command line)",
          "System initializes execution setting _bOnInsert flag to true",
          "Script prompts user: '|Select entities|'",
          "User selects one or more GenBeam entities in the drawing and presses Enter",
          "System retrieves the selected set of entities",
          "Script iterates through every entity in the selection set",
          "For each entity, script verifies if the entity is valid",
          "For valid entities, script sets the 'Module' property to an empty string",
          "Script executes eraseInstance() to remove the script object from the drawing",
          "Execution terminates"
        ],
        "conditionalBranches": [
          {
            "condition": "User completes the selection prompt (ssE.go())",
            "path1": {
              "name": "Selection Confirmed",
              "steps": [
                "Retrieve selection set",
                "Loop through entities",
                "Check validity and clear Module data",
                "Erase script instance"
              ]
            },
            "path2": {
              "name": "Selection Cancelled",
              "steps": [
                "Skip processing loop",
                "Erase script instance immediately"
              ]
            }
          },
          {
            "condition": "Entity validity check inside loop (gBm.bIsValid())",
            "path1": {
              "name": "Valid Entity",
              "steps": [
                "Cast to GenBeam",
                "Execute setModule(\"\") to clear data"
              ]
            },
            "path2": {
              "name": "Invalid Entity",
              "steps": [
                "Execute continue statement",
                "Proceed to next entity in loop"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Type Filter",
            "errorMessage": "None explicitly raised by script, but interaction is constrained.",
            "recovery": "User must select GenBeam entities; other types cannot be picked due to PrEntity filter."
          },
          {
            "check": "Entity Handle Validity",
            "errorMessage": "None",
            "recovery": "Automatic; if an entity in the set is invalid (e.g., already deleted), the script skips it automatically via continue."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None available",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after execution, removing the interactive object from the drawing. No OPM properties or context menus are available for this script instance after it runs."
          }
        ]
      },
      "tokens_used": 2962,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-RemoveModuleData\n\n## Overview\nThis utility script clears the \"Module\" property assignment from selected timber beams (GenBeams). It is used to dissociate specific beams from their current logical manufacturing or export groups.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates directly on 3D model elements. |\n| Paper Space | No | Not designed for layout views or annotations. |\n| Shop Drawing | No | Not designed for use within drawing views. |\n\n## Prerequisites\n- **Required entities:** At least one GenBeam (Timber Beam) currently existing in the drawing.\n- **Minimum beam count:** 1\n- **Required settings files:** None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-RemoveModuleData.mcr`\n\n### Step 2: Select Entities\n```\nCommand Line: Select entities\nAction: Click on the timber beams you wish to remove from the current module group. You may select multiple beams.\n         Press Enter to confirm the selection.\n```\n*(Note: The script will automatically filter for valid timber beams. Once confirmed, the script updates the properties and closes.)*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script runs immediately upon insertion and does not have editable properties in the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | No context menu options are available. The script instance is removed immediately after execution. |\n\n## Settings Files\nNone required.\n\n## Tips\n- **Re-grouping:** Use this script when you have accidentally assigned beams to the wrong Module ID or if you need to re-organize your export groups before generating production data.\n- **No Cleanup Needed:** The script object deletes itself automatically from the drawing after processing, so you do not need to manually erase the script instance.\n\n## FAQ\n- **Q: Will this delete my beams?**\n  A: No, this script only clears the internal \"Module\" name property. It does not delete or modify the geometry of the beams.\n- **Q: Can I use this on walls or other elements?**\n  A: No, this script is specifically designed to work on GenBeam entities. It will ignore other element types.\n- **Q: How do I know it worked?**\n  A: Select a processed beam and look at its properties (or use a script that reports the Module name); the Module field should now be empty."
      },
      "tokens_used": 3353,
      "error": null
    }
  }
}