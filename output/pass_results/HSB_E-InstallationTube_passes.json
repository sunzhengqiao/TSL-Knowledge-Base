{
  "filename": "HSB_E-InstallationTube.mcr",
  "status": "completed",
  "total_tokens": 57771,
  "processing_time": 368.45927715301514,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9167,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No 'sd_' or 'Multipage' filename prefix found. The script manipulates 3D construction entities (Element, Beam, Drill, ElemMill, ElemNoNail) and uses Body intersection logic, typical of Model Space generation scripts. It does not use _Viewport or #Type E with _Entity[] for drawing generation."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "3D Model Space containing a wall Element",
          "requiredSettings": []
        }
      },
      "tokens_used": 6608,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": \"Select element\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"SelectOption\",\n        \"promptOriginal\": \"Select option\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"PLine.getByUser\",\n        \"promptOriginal\": \"Polyline to describe tube path\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"SelectOption\",\n      \"trigger\": \"Insertion\",\n      \"title\": \"Select option\",\n      \"dataSource\": \"arSInputMode\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 14,\n      \"variable\": \"sInsertMode\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Input mode\",\n      \"defaultValue\": \"Based on installation point\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Based on installation point\",\n        \"Based on element\"\n      ],\n      \"category\": \"Insert\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sSideInstallationPoint\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Side installation point\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Position\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSideInstallationTube\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Side installation tube\",\n      \"defaultValue\": \"Same as installation point\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Same as installation point\",\n        \"Front\",\n        \"Back\",\n        \"Center\"\n      ],\n      \"category\": \"Position\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dTubeDiameter\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Tube diameter\",\n      \"defaultValue\": \"16.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Position\",\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"dDepthOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Depth offset\",\n      \"defaultValue\": \"20.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Position\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nTubeColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color of tube\",\n      \"defaultValue\": \"5\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sTubeLineType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Line type of tube\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"sShowTube\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Tube visualization type\",\n      \"defaultValue\": \"Tube\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Tube\",\n        \"Line\"\n      ],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"sZoneLayer\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Assign to layer\",\n      \"defaultValue\": \"Tooling\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Tooling\",\n        \"Information\",\n        \"Zone\",\n        \"Element\"\n      ],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 23,\n      \"variable\": \"sDescriptionStart\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Description Start\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 24,\n      \"variable\": \"sDescriptionEnd\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Description End\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 18,\n      \"variable\": \"sDescription\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Segment Description\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 25,\n      \"variable\": \"descriptionSide\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Segment description before or after length\",\n      \"defaultValue\": \"Before\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Before\",\n        \"After\"\n      ],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"nColorDescriptionStartEnd\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color description start and end\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nColorDescription\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color description\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"textSizeStartEnd\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Text size start and end\",\n      \"defaultValue\": \"-1.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dTextSize\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Text size\",\n      \"defaultValue\": \"-1.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 19,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension style\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 56,\n      \"variable\": \"sShowIndividualTubeLengths\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Show individual tube lengths\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"Yes + description\",\n        \"Yes rounded + description\",\n        \"No\"\n      ],\n      \"category\": \"Visualization\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sToolTypeFrame\",\n      \"type\": \"PropString\",\n      \"displayName\": \"(F) Tooltype frame\",\n      \"defaultValue\": \"No tooling\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No tooling\",\n        \"Drill\",\n        \"Mill\"\n      ],\n      \"category\": \"Frame tooling (F)\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sFilterBCFrameTool\",\n      \"type\": \"PropString\",\n      \"displayName\": \"(F) Filter beams with beamcode\",\n      \"defaultValue\": \"\",\n      \"input"
      },
      "tokens_used": 9862,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates electrical or conduit tubing paths within timber wall elements, including 3D visualization, BOM data, and automatic CNC machining (holes/slots) for frame beams.\",\n    \"category\": \"Hardware / MEP\",\n    \"typicalUseCase\": \"Plumbing and electrical planning to model pipe runs, calculate material lengths, and cut holes in timber studs where pipes pass through.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sInsertMode\",\n      \"technicalDefault\": \"\\\"Based on installation point\\\"\",\n      \"businessMeaning\": \"Method of defining the tube path: relative to an existing electrical installation point or by manually selecting a wall and drawing a path.\",\n      \"validRange\": \"List selection\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Controls if the script inherits properties from a parent object or starts a new independent instance.\"\n    },\n    {\n      \"name\": \"sSideInstallationPoint\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Read-only display indicating the side (Front/Back/Center) of the referenced installation point.\",\n      \"validRange\": \"N/A\",\n      \"unit\": \"N/A\",\n      \"affectsOutput\": \"None (Informational).\"\n    },\n    {\n      \"name\": \"sSideInstallationTube\",\n      \"technicalDefault\": \"\\\"Same as installation point\\\"\",\n      \"businessMeaning\": \"Specifies on which side of the wall (Front, Back, or Center) the tube should be placed.\",\n      \"validRange\": \"Front, Back, Center\",\n      \"unit\": \"Position\",\n      \"affectsOutput\": \"Moves the 3D tube geometry and machining path horizontally within the wall cross-section.\"\n    },\n    {\n      \"name\": \"dTubeDiameter\",\n      \"technicalDefault\": \"16.0\",\n      \"businessMeaning\": \"The physical outer diameter of the tubing/conduit.\",\n      \"validRange\": \"12.0 - 100.0 mm (Typical: 16, 20, 25, 32, 40, 50)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Determines the thickness of the tube visualization and the default size for 'No Nail' protection zones.\"\n    },\n    {\n      \"name\": \"dDepthOffset\",\n      \"technicalDefault\": \"20.0\",\n      \"businessMeaning\": \"The distance from the wall surface (or chosen side) to the center of the tube.\",\n      \"validRange\": \"0.0 - Wall Thickness mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Adjusts the depth position of the tube within the wall assembly.\"\n    },\n    {\n      \"name\": \"nTubeColor\",\n      \"technicalDefault\": \"5\",\n      \"businessMeaning\": \"The CAD color index used to draw the tube.\",\n      \"validRange\": \"0 - 255 (AutoCAD Color Index)\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual appearance in Model Space.\"\n    },\n    {\n      \"name\": \"sTubeLineType\",\n      \"technicalDefault\": \"null\",\n      \"businessMeaning\": \"The line style (e.g., Continuous, Hidden, Dash) used if the tube is visualized as a line.\",\n      \"validRange\": \"Available CAD Linetypes\",\n      \"unit\": \"Style\",\n      \"affectsOutput\": \"Visual style of the tube path.\"\n    },\n    {\n      \"name\": \"sShowTube\",\n      \"technicalDefault\": \"\\\"Tube\\\"\",\n      \"businessMeaning\": \"Determines if the tube is drawn as a 3D solid cylinder or a 2D line.\",\n      \"validRange\": \"Tube, Line\",\n      \"unit\": \"Geometry Type\",\n      \"affectsOutput\": \"Switches generation between a Body object and a PLine/Line object.\"\n    },\n    {\n      \"name\": \"sZoneLayer\",\n      \"technicalDefault\": \"\\\"Tooling\\\"\",\n      \"businessMeaning\": \"The CAD layer on which the tube geometry is created.\",\n      \"validRange\": \"Tooling, Information, Zone, Element\",\n      \"unit\": \"Layer\",\n      \"affectsOutput\": \"Layer assignment for the generated tube.\"\n    },\n    {\n      \"name\": \"sDescriptionStart\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Custom text label placed at the start point of the tube.\",\n      \"validRange\": \"String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Adds text entity at the start of the path.\"\n    },\n    {\n      \"name\": \"sDescriptionEnd\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Custom text label placed at the end point of the tube.\",\n      \"validRange\": \"String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Adds text entity at the end of the path.\"\n    },\n    {\n      \"name\": \"sDescription\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Custom text label assigned to specific segments of the tube path.\",\n      \"validRange\": \"String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Adds text entities along the path segments.\"\n    },\n    {\n      \"name\": \"descriptionSide\",\n      \"technicalDefault\": \"\\\"Before\\\"\",\n      \"businessMeaning\": \"Controls whether the segment description appears before or after the length dimension.\",\n      \"validRange\": \"Before, After\",\n      \"unit\": \"Layout\",\n      \"affectsOutput\": \"Formatting of dimension text on screen.\"\n    },\n    {\n      \"name\": \"nColorDescriptionStartEnd\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Color for the start/end description text (-1 usually defaults to the tube color).\",\n      \"validRange\": \"-1 or 0-255\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Color of start/end text labels.\"\n    },\n"
      },
      "tokens_used": 11605,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Launch script via 'Insert TSL' or Catalog Browser.",
          "User selects an Element (Wall) via getGenBeam.",
          "Dialog 'Select option' prompts for Input Mode (Based on installation point vs Based on element).",
          "User picks Polyline to describe the tube path via PLine.getByUser.",
          "Script filters Element Beams into Frame and Soleplate arrays based on BeamCode properties.",
          "Script calculates 3D path geometry based on 'Side installation tube', 'Depth offset', and 'Tube diameter'.",
          "Script generates Tube Visualization: Body (if sShowTube='Tube') or PLine (if sShowTube='Line').",
          "Script generates Text/Dimension labels for Start, End, and Segments based on 'Show individual tube lengths' settings.",
          "Script loops through tube path segments to process intersections with Frame and Soleplate beams.",
          "If intersection exists and ToolType is 'Drill': Adds Drill tool to the beam.",
          "If intersection exists and ToolType is 'Mill': Adds BeamCut (Slot) to the beam and potentially ElemMill for sheeting.",
          "Script creates No Nail protection zones if enabled.",
          "Script writes BOM data (Tube length, diameter) to _Map.",
          "Script saves current property map to _Map for future reference."
        ],
        "conditionalBranches": [
          {
            "condition": "Input Mode Selection (sInsertMode)",
            "path1": {
              "name": "Based on installation point",
              "steps": [
                "Script searches for HSB_E-InstallationPoint in the element.",
                "Inherits properties (Side, Offset) from the Installation Point's map.",
                "Positions tube relative to that specific point."
              ]
            },
            "path2": {
              "name": "Based on element",
              "steps": [
                "Uses explicit user selections for Element and Polyline.",
                "Positions tube based on script properties (Front/Back/Center, Offset) independent of other points."
              ]
            }
          },
          {
            "condition": "Frame/Soleplate Tooling Logic (sToolTypeFrame / sToolTypeSolePlate)",
            "path1": {
              "name": "No Tooling (0)",
              "steps": [
                "Skip tooling generation for the beam group.",
                "Only visualization and BOM are created."
              ]
            },
            "path2": {
              "name": "Drill (1)",
              "steps": [
                "Detect intersection between Tube segment and Beam.",
                "Calculate insertion point.",
                "Add Drill tool (diameter from properties) to the beam."
              ]
            },
            "path3": {
              "name": "Mill (2)",
              "steps": [
                "Detect intersection between Tube segment and Beam.",
                "Calculate insertion point and orientation vectors.",
                "Apply Mill offsets (Width, Depth, Offset).",
                "Add BeamCut (Slot) tool to the beam.",
                "Add ElemMill tool for sheeting if geometry dictates."
              ]
            }
          },
          {
            "condition": "Visualization Type (sShowTube)",
            "path1": {
              "name": "Tube",
              "steps": [
                "Generate 3D cylindrical Body along path.",
                "Apply Color and Layer."
              ]
            },
            "path2": {
              "name": "Line",
              "steps": [
                "Generate 2D PLine along path.",
                "Apply LineType, Color, and Layer."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "Prompt loop continues until valid element is selected.",
            "recovery": "User must click a valid Wall Element."
          },
          {
            "check": "Polyline Validity",
            "errorMessage": "ReportWarning 'No points found in polyline' if path is empty.",
            "recovery": "Script execution halts geometry generation; user must reset/delete and retry."
          },
          {
            "check": "Tooling Geometry",
            "errorMessage": "No explicit error, but tooling skipped if Beam vector is perpendicular to Tool vector.",
            "recovery": "N/A (Automatic skip to prevent invalid geometry)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Geometry/Position",
            "how": "Grips (for path) or OPM Properties (for Diameter, Offset, Side)",
            "effect": "Recalculates 3D tube shape, updates BOM length, and moves associated tooling (Drills/Mills) to new positions."
          },
          {
            "action": "Change Visualization",
            "how": "OPM Property 'Tube visualization type'",
            "effect": "Switches between 3D Tube representation and 2D Line representation."
          },
          {
            "action": "Modify Tooling Settings",
            "how": "OPM Properties 'Frame tooling' or 'Soleplate tooling'",
            "effect": "Switches between Drill, Mill, or No Tooling. Adding/removing CNC data from the wall beams instantly."
          },
          {
            "action": "Update Labels",
            "how": "OPM Properties 'Description', 'Show individual tube lengths'",
            "effect": "Adds, removes, or reformats text labels and dimensions along the tube path."
          }
        ]
      },
      "tokens_used": 11317,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-InstallationTube.mcr\n\n## Overview\nGenerates 3D electrical or conduit tubing paths within timber wall elements. It supports automatic CNC machining (drilling/milling) for studs, visualization customization, and BOM data generation.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script generates 3D geometry (Body/PLine) and modifies Element tooling. |\n| Paper Space | No | Not a drawing generation script. |\n| Shop Drawing | No | Does not generate 2D views or dimensions for layouts. |\n\n## Prerequisites\n- **Required Entities**: An existing Wall **Element**.\n- **Minimum Beam Count**: 0 (Script functions on the element shell and associated beams).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_E-InstallationTube.mcr` from the catalog or file browser.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select element\nAction: Click on the Wall Element where the installation tube should be placed.\n```\n\n### Step 3: Choose Input Mode\n```\nCommand Line: Select option\nAction: Choose one of the following from the dialog:\n- Based on installation point: Use if an HSB_E-InstallationPoint exists in the wall.\n- Based on element: Use to define the path independently relative to the wall.\n```\n\n### Step 4: Define Tube Path\n```\nCommand Line: Polyline to describe tube path\nAction: Draw or select a 2D Polyline in the XY plane that represents the path of the tube.\n```\n\n## Properties Panel Parameters\n\n### Insert\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Input mode | dropdown | Based on installation point | Determines how the tube position and properties are initialized. |\n| Side installation point | text | (Empty) | Read-only display of the referenced installation point side. |\n\n### Position\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Side installation tube | dropdown | Same as installation point | Sets the side of the wall for the tube (Front, Back, or Center). |\n| Tube diameter | number | 16.0 | The physical outer diameter of the tube (in mm). |\n| Depth offset | number | 20.0 | Distance from the selected wall surface to the center of the tube (in mm). |\n\n### Visualization\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Color of tube | number | 5 | AutoCAD color index for the tube visualization. |\n| Line type of tube | dropdown | (Current) | Line style used if 'Tube visualization type' is set to 'Line'. |\n| Tube visualization type | dropdown | Tube | Renders the path as a 3D solid 'Tube' or a 2D 'Line'. |\n| Assign to layer | dropdown | Tooling | Specifies the CAD layer for the generated tube geometry. |\n| Description Start | text | (Empty) | Custom text label placed at the start of the tube. |\n| Description End | text | (Empty) | Custom text label placed at the end of the tube. |\n| Segment Description | text | (Empty) | Custom text label for specific segments. |\n| Segment description before or after length | dropdown | Before | Position of segment description relative to length dimension. |\n| Color description start and end | number | -1 | Color index for start/end text. -1 uses tube color. |\n| Color description | number | -1 | Color index for segment description text. |\n| Text size start and end | number | -1.0 | Height of text labels at start/end (-1 uses default). |\n| Text size | number | -1.0 | Height of segment description text (-1 uses default). |\n| Dimension style | dropdown | (Current) | Dimension style used for length labels. |\n| Show individual tube lengths | dropdown | Yes | Controls display of length labels (Yes, Yes + description, etc.). |\n\n### Frame tooling (F)\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| (F) Tooltype frame | dropdown | No tooling | Type of CNC operation on frame studs (None, Drill, Mill). |\n| (F) Filter beams with beamcode | text | (Empty) | Filter to apply tooling only to specific beam codes. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Properties | Opens the Properties Palette to edit parameters listed above. Changing properties triggers automatic recalculation of geometry and tooling. |\n| Erase | Deletes the script instance and all generated tube geometry/tooling. |\n\n## Settings Files\nNo specific external XML settings files are required. The script uses BeamCodes defined in the hsbCAD project for filtering tooling targets.\n\n## Tips\n- **Performance**: For complex models with many tubes, change `Tube visualization type` to **Line** to improve graphical performance.\n- **Milling**: If you need a slot for the tube (e.g., to slide it in), set `(F) Tooltype frame` to **Mill**. Ensure the tube diameter is slightly larger than the physical tube for clearance.\n- **Integration**: Use the **Based on installation point** mode to automatically match the wall layer and depth settings defined in your electrical installation points.\n- **Labeling**: Use `Show individual tube lengths` set to **Yes rounded + description** to create clean production labels directly in the 3D model.\n\n## FAQ\n- **Q: Why are no holes appearing in my studs?**\n  - A: Check the `(F) Tooltype frame` property. It is likely set to \"No tooling\". Change it to \"Drill\" or \"Mill\". Also, verify that the beams intersecting the tube match the filter in `(F) Filter beams with beamcode`.\n- **Q: Can I change the path after inserting?**\n  - A: Yes, select the tube, open the Properties Palette, and look for the graphical grip or specific coordinate fields if exposed by the script version, or delete and re-insert if the polyline logic is locked post-insertion (depends on specific script version constraints). *Note: Typically, path modification requires re-insertion or editing the grip if available.*\n- **Q: What does \"Depth offset\" do?**\n  - A: It controls how far into the wall the tube sits. A value of 0 places the center of the tube exactly on the surface (Front/Back). Increase this value to bury the tube deeper into the insulation or structure."
      },
      "tokens_used": 9212,
      "error": null
    }
  }
}