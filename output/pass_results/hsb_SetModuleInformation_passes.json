{
  "filename": "hsb_SetModuleInformation.mcr",
  "status": "completed",
  "total_tokens": 23315,
  "processing_time": 156.79362654685974,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "13.02.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4674,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `PrEntity` to select `Element` objects and casts them to `ElementWallSF`. It operates on 3D entities (`Beam`, `Sheet`) within the model to assign module properties based on geometric intersection (`PlaneProfile`, `intersectWith`). It uses `eraseInstance()` at the end of execution, indicating it is a utility script that modifies model data rather than generating 2D shop drawings. No `sd_` prefixes or `_Viewport` references found."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF",
            "Sheet",
            "Beam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing Structural Frame Wall Elements",
          "requiredSettings": []
        }
      },
      "tokens_used": 3643,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2499,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically assigns 'Module' names to Sheets (cladding/panels) based on the modules of the intersecting Structural Beams within a Wall Element.",
          "category": "Data Management / Model Organization",
          "typicalUseCase": "Used after defining modules (e.g., 'Left Wing', 'Main Body') on wall studs/plates to ensure the associated sheathing panels inherit the same module information for lists, numbering, or export filtering."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Module Property Assignment",
            "description": "Updates the 'Module' property data of Sheet entities. No physical geometry is created or modified; only the attribute data is altered.",
            "appliedTo": "Sheets (Sheathing/Cladding) belonging to the selected Wall Elements that geometrically overlap with a defined beam module."
          }
        ]
      },
      "tokens_used": 2387,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution triggered (Insertion).",
          "2. Script checks insert cycle count; if > 1, it immediately erases itself and stops.",
          "3. Prompt user to select a set of Wall Elements.",
          "4. User selects elements and confirms selection.",
          "5. Store selected elements in the internal Element list.",
          "6. (Next Cycle) Validate if elements were selected. If list is empty, erase instance and stop.",
          "7. Iterate through each selected element (cast to ElementWallSF).",
          "8. Filter out invalid elements.",
          "9. For each valid element, collect all Beams and Sheets.",
          "10. Scan all Beams to identify a list of unique 'Module' names currently assigned.",
          "11. Iterate through each unique Module name found.",
          "12. For the current Module, collect all Beams assigned to it and sort them geometrically.",
          "13. Calculate the Left and Right geometric extents of the Beams in this module.",
          "14. Create a large rectangular search profile (PlaneProfile) covering the width of the module and extending 3000mm in/out of the wall.",
          "15. Iterate through all Sheets in the element.",
          "16. Check if the Sheet's geometry intersects with the Module's search profile.",
          "17. If intersecting, update the Sheet's 'Module' property to match the current Module name.",
          "18. After processing all modules and elements, set the erase flag.",
          "19. Script erases itself from the model (Utility complete)."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert cycle count",
            "path1": {
              "name": "Repeat Cycle (>1)",
              "steps": [
                "Erase instance",
                "Return"
              ]
            },
            "path2": {
              "name": "First Cycle (1)",
              "steps": [
                "Prompt user for Entity selection"
              ]
            }
          },
          {
            "condition": "User Selection Input",
            "path1": {
              "name": "Selection Successful",
              "steps": [
                "Append elements to list",
                "Proceed to Main Loop"
              ]
            },
            "path2": {
              "name": "Selection Failed/Empty",
              "steps": [
                "Erase instance",
                "Return"
              ]
            }
          },
          {
            "condition": "Element Validity (ElementWallSF)",
            "path1": {
              "name": "Valid Element",
              "steps": [
                "Calculate Envelope/CoordSys",
                "Process Beams and Sheets"
              ]
            },
            "path2": {
              "name": "Invalid Element",
              "steps": [
                "Continue to next element"
              ]
            }
          },
          {
            "condition": "Module Beam Count",
            "path1": {
              "name": "Beams found for Module",
              "steps": [
                "Calculate geometry",
                "Check intersection with Sheets"
              ]
            },
            "path2": {
              "name": "No Beams found",
              "steps": [
                "Continue to next Module name"
              ]
            }
          },
          {
            "condition": "Geometric Intersection (Sheet vs Module Profile)",
            "path1": {
              "name": "Intersection Detected",
              "steps": [
                "Sheet module property updated"
              ]
            },
            "path2": {
              "name": "No Intersection",
              "steps": [
                "Sheet remains unchanged"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "None (Silent exit)",
            "recovery": "User must re-run script and select valid Wall Elements."
          },
          {
            "check": "Element Type",
            "errorMessage": "None (Skipped via cast)",
            "recovery": "Ensure selected objects are 'ElementWallSF' (Structural Frame Walls). Other types are ignored."
          },
          {
            "check": "Module Data on Beams",
            "errorMessage": "None",
            "recovery": "If Beams have no Module names assigned, the script finds no modules and performs no updates."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None",
            "how": "Script instance is automatically erased upon completion.",
            "effect": "The script is a transient utility. No instance remains for OPM editing or Context Menu interaction. The only effect is the updated 'Module' properties on the Sheet entities in the database."
          }
        ]
      },
      "tokens_used": 5930,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetModuleInformation.mcr\n\n## Overview\nThis utility script automatically assigns \"Module\" names to sheathing panels (Sheets) based on the modules assigned to the structural framing (Beams) within selected Wall Elements. It ensures that cladding and structural components share consistent module data for organization, numbering, and export filtering.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D Wall Elements containing beams and sheets. |\n| Paper Space | No | This tool does not function in layout views. |\n| Shop Drawing | No | This is a model organization tool, not a drawing generation script. |\n\n## Prerequisites\n- **Required Entities:** Structural Frame Wall Elements (`ElementWallSF`) that contain both Beams (structure) and Sheets (sheathing/cladding).\n- **Module Data:** The structural Beams within the walls must already have a \"Module\" property assigned. If the beams have no module name, the script has nothing to transfer to the sheets.\n- **Model Space:** You must be in the Model Space to select and process the elements.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse to the script location and select `hsb_SetModuleInformation.mcr`.\n\n### Step 2: Select Wall Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the Wall Elements you wish to update. You can select multiple walls at once. Press Enter to confirm your selection.\n```\n\n### Step 3: Automatic Processing\nAction: The script will automatically calculate the geometric extents of each module defined by the beams and apply those names to any overlapping sheets. The script instance will automatically delete itself from the model once the process is complete.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script is a transient utility and does not create a persistent entity with editable properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script removes itself from the model after execution; no context menu is available. |\n\n## Settings Files\n- **Filename:** None\n- **Location:** N/A\n- **Purpose:** This script does not rely on external settings files.\n\n## Tips\n- **Preparation:** Verify your wall beams (studs, plates, etc.) have the correct \"Module\" names in the Properties Palette before running this script.\n- **Verification:** Since the script erases itself immediately, check the \"Module\" property of a few Sheets in the wall to confirm the update was successful.\n- **Complex Walls:** The script works by geometrically checking where sheets fall relative to the beam modules. Ensure your wall geometry is clean for the best results.\n\n## FAQ\n- **Q: I ran the script, but the Sheets still have no Module name. Why?**\n  **A:** Check the Beams in the wall. If the Beams do not have a \"Module\" name assigned, the script cannot detect which module the sheets belong to.\n- **Q: Why did the script disappear from the model?**\n  **A:** This is a \"utility\" script designed to perform a task and then clean up after itself. It does not need to remain in the drawing.\n- **Q: Can I use this on roof elements?**\n  **A:** The script is designed for `ElementWallSF` (Structural Frame Walls). While it might technically process other element types if they contain beams and sheets, it is intended for vertical wall applications."
      },
      "tokens_used": 4182,
      "error": null
    }
  }
}