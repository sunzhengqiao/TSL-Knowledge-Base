{
  "filename": "hsb_CHHImport.mcr",
  "status": "completed",
  "total_tokens": 23218,
  "processing_time": 195.6323218345642,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2006,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script performs an import operation using `callDotNetFunction2` and interprets the results into the database using `mm.dbInterpretMap`, followed by `eraseInstance()`. This pattern is characteristic of a Model Space generation/import wizard that creates geometry and then removes the script instance. No Paper Space (_Viewport) or ShopDrawing (sd_, #Type E) detection patterns were found."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": [
            "hsbSteicoIO.dll (located in hsbInstall\\Utilities\\hsbCloudStorage)"
          ]
        }
      },
      "tokens_used": 2310,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "pFloorElementGroupName",
            "type": "PropString",
            "displayName": "Floor Element Group Name",
            "defaultValue": "Floors\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "pBeamGroupName",
            "type": "PropString",
            "displayName": "Beam Group Name",
            "defaultValue": "Beams\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4821,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Imports structural timber data (floors, beams, and joists) from a CHH IFC file into the hsbCAD model, organizing the imported elements into specific model groups.",
          "category": "Import/Data Exchange",
          "typicalUseCase": "Used when transferring floor designs and joist layouts from external engineering packages (specifically Steico or compatible CHH format providers) into hsbCAD for further detailing and manufacturing."
        },
        "parameters": [
          {
            "name": "pFloorElementGroupName",
            "technicalDefault": "Floors\\Ground_Floor",
            "businessMeaning": "Defines the destination folder path in the hsbCAD Model Tree where floor panels or slabs (plate elements) imported from the CHH file will be stored.",
            "validRange": "Any valid folder path string (e.g., 'Project\\1st Floor', 'Roof\\Terrace')",
            "unit": "String (Path)",
            "affectsOutput": "Determines the organizational grouping of imported floor elements. If the group does not exist, it is typically created during the import process."
          },
          {
            "name": "pBeamGroupName",
            "technicalDefault": "Beams\\Ground_Floor",
            "businessMeaning": "Defines the destination folder path in the hsbCAD Model Tree where structural members (joists, beams, studs) imported from the CHH file will be stored.",
            "validRange": "Any valid folder path string (e.g., 'Project\\1st Floor Joists', 'Structural\\Beams')",
            "unit": "String (Path)",
            "affectsOutput": "Determines the organizational grouping of imported timber beams and joists. Does not alter geometry, only model hierarchy."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "External CHH File Selection (via DLL)",
            "effect": "Both parameters determine where the content of that specific file is placed.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Structural timber members such as joists, beams, or ribs defined in the CHH file.",
            "appliedTo": "Groups defined by pBeamGroupName"
          },
          {
            "type": "Element",
            "description": "Plate or panel elements (such as CLT floors or decking) defined in the CHH file.",
            "appliedTo": "Groups defined by pFloorElementGroupName"
          },
          {
            "type": "Properties/Materials",
            "description": "Attributes mapped from the CHH file (e.g., member type, material descriptions) based on internal mapping formats (e.g., ijoistTypePropertyFormat).",
            "appliedTo": "Respective GenBeams and Elements created during import."
          }
        ]
      },
      "tokens_used": 3856,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches script (Insert command or drag-and-drop)",
          "Properties are initialized from catalog using setPropValuesFromCatalog",
          "[Conditional] Check for _kExecuteKey",
          "If _kExecuteKey is empty, showDialogOnce() triggers to allow property input",
          "User specifies Target Group Names (Floor Element Group, Beam Group)",
          "Script constructs path to hsbSteicoIO.dll",
          "Script prepares input Map with Group Names and Property Mapping formats",
          "reportMessage() displays the DLL assembly path",
          "Script calls external .NET function 'ImportCHHIFC' via callDotNetFunction2",
          "User selects CHH IFC file in the external dialog",
          "External DLL returns data Map (mapRet)",
          "ModelMap object (mm) is populated with the returned data",
          "ModelMapInterpretSettings are configured (resolve by handle/element number)",
          "mm.dbInterpretMap() generates the GenBeam and Element entities in the Model",
          "Script executes eraseInstance() to remove itself from the drawing"
        ],
        "conditionalBranches": [
          {
            "condition": "Check if the script was executed via a specific command key (_kExecuteKey)",
            "path1": {
              "name": "Standard Insert (Key is Empty)",
              "steps": [
                "showDialogOnce() is called",
                "Properties palette or dialog opens automatically",
                "User must confirm or input Group Names before proceeding"
              ]
            },
            "path2": {
              "name": "Command/Preset Execution (Key is Defined)",
              "steps": [
                "Dialog is skipped",
                "Script proceeds immediately with catalog or preset property values",
                "Import runs automatically (headless mode)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "hsbSteicoIO.dll Availability",
            "errorMessage": "Implicit failure reported by callDotNetFunction2 if DLL is missing at path hsbInstall\\Utilities\\hsbCloudStorage\\",
            "recovery": "Verify hsbCAD installation includes the hsbCloudStorage utilities and the hsbSteicoIO.dll file."
          },
          {
            "check": "External Data Map Integrity",
            "errorMessage": "If the user cancels the file dialog in the external DLL, mapRet may be empty, resulting in no geometry creation.",
            "recovery": "Re-run the script and ensure a valid CHH IFC file is selected in the popup dialog."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script is Transient)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after generating the geometry. The script object is deleted from the model. Changes to parameters require inserting a new instance of the script."
          }
        ]
      },
      "tokens_used": 5569,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_CHHImport.mcr\n\n## Overview\nImports structural timber data (floors and beams) from a CHH IFC file into the hsbCAD model, automatically organizing the imported elements into specified model groups and then removing itself from the drawing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script generates 3D geometry (GenBeams and Elements) directly in the model. |\n| Paper Space | No | This script does not create 2D views or annotations. |\n| Shop Drawing | No | This script is not used for detailing or creating manufacturing drawings. |\n\n## Prerequisites\n- **Required entities**: None (The script creates new entities).\n- **Minimum beam count**: 0.\n- **Required settings files**:\n  - `hsbSteicoIO.dll` must be located in `hsbInstall\\Utilities\\hsbCloudStorage`.\n\n## Usage Steps\n\n### Step 1: Launch Script\n```\nCommand Line: TSLINSERT\nAction: Browse and select hsb_CHHImport.mcr, then click Open.\n```\n\n### Step 2: Configure Group Names\n```\nAction: Use the Properties Palette (OPM) to set the destination paths for your imported data.\nDetails: By default, the script suggests \"Floors\\Ground_Floor\" for floor elements and \"Beams\\Ground_Floor\" for beams. Adjust these paths to match your project's Model Tree structure.\n```\n\n### Step 3: Select CHH File\n```\nAction: A file selection dialog (from the external hsbSteicoIO tool) will appear automatically.\nDetails: Navigate to and select the source CHH IFC file you wish to import.\n```\n\n### Step 4: Complete Import\n```\nAction: The script processes the file and generates the geometry.\nResult: The imported floor elements and beams appear in the Model Tree under the groups specified in Step 2. The script instance is automatically deleted from the drawing.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Floor Element Group Name | text | `Floors\\Ground_Floor` | The destination folder path in the Model Tree where imported floor panels or slabs (plate elements) will be stored. |\n| Beam Group Name | text | `Beams\\Ground_Floor` | The destination folder path in the Model Tree where imported structural members (joists, beams) will be stored. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script is transient and deletes itself immediately after running; it does not remain in the model to offer context menu options. |\n\n## Settings Files\n- **Filename**: `hsbSteicoIO.dll`\n- **Location**: `hsbInstall\\Utilities\\hsbCloudStorage`\n- **Purpose**: Provides the external functionality to parse the CHH IFC file format and map the data for hsbCAD.\n\n## Tips\n- **Script Behavior**: This script is designed as a \"one-shot\" wizard. Once the import is complete, the script object is erased. To re-import or change settings, you must insert the script again.\n- **Folder Preparation**: Ensure the Group Names specified in the Properties Panel exist in your Model Tree, or be prepared to create them manually if the automatic creation fails (depending on your hsbCAD configuration).\n- **Headless Mode**: If executed via a specific preset or command key (_kExecuteKey), the script may run without showing the property dialog, using the last known or catalog default values.\n\n## FAQ\n- **Q: Why does the script disappear after I run it?**\n  **A:** The script is designed to be a transient import tool. Once it calls the external DLL and generates the geometry, it executes `eraseInstance()` to clean up the drawing.\n- **Q: What happens if the file selection dialog does not appear?**\n  **A:** This usually means `hsbSteicoIO.dll` is missing or located in the wrong folder. Verify that it exists in `hsbInstall\\Utilities\\hsbCloudStorage`.\n- **Q: Can I import into an existing group?**\n  **A:** Yes. Simply type the exact path of the existing group (e.g., `Project\\Level 1\\Walls`) into the corresponding Group Name property before running the import."
      },
      "tokens_used": 4656,
      "error": null
    }
  }
}