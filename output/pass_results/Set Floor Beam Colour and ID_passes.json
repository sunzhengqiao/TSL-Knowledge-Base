{
  "filename": "Set Floor Beam Colour and ID.mcr",
  "status": "completed",
  "total_tokens": 28500,
  "processing_time": 478.82399559020996,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3295,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script targets Beam entities using PrEntity and modifies Beam properties (Color, HSB ID) directly. No references to Viewports, Sheets, or 2D drawing entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 3403,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": false
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "select a set of beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "On Insert (_bOnInsert)",
            "title": null,
            "dataSource": "Script Properties (OPM)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 1,
            "variable": "beamtypes",
            "type": "PropString",
            "displayName": "Select Beam Type",
            "defaultValue": "C16Joist",
            "inputType": "dropdown",
            "options": [
              "C16Joist",
              "C24Joist",
              "Battens",
              "Bridging",
              "Ply Packer",
              "Backer Block",
              "Noggin",
              "TJI - 150",
              "TJI - 350",
              "TJI - 550",
              "Timberstrand",
              "Parallam",
              "Glulam",
              "PRI - 40",
              "PRI - 60",
              "TJI 110",
              "TJI 360",
              "TJI 560",
              "BCI5000",
              "Versa-Lam",
              "BCI90",
              "HL240",
              "MP240",
              "RIM240",
              "BB4240",
              "BB9240",
              "Web Stiffener"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "Grade",
            "type": "PropString",
            "displayName": "Enter Timber Grade",
            "defaultValue": " ",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "Infor",
            "type": "PropString",
            "displayName": "Enter Information",
            "defaultValue": " ",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sName",
            "type": "PropString",
            "displayName": "Enter Beam Name",
            "defaultValue": " ",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6154,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Batch assigns specific material properties, AutoCAD colors, and internal manufacturing IDs to selected floor beams based on a predefined product catalog.",
          "category": "Project Management / Data Standards",
          "typicalUseCase": "Used during the initial setup or cleanup of a floor model to convert generic structural beams into specific engineered wood products (like TJI joists or LVL beams) so they display correctly and have the correct export IDs for production."
        },
        "parameters": [
          {
            "name": "beamtypes",
            "technicalDefault": "C16Joist",
            "businessMeaning": "The specific product type or material class of the floor beam (e.g., I-Joist series, LVL type, or standard joist grade). This selection determines the visual representation and the internal ID used for manufacturing lists.",
            "validRange": "Fixed list of 27 options (e.g., C16Joist, TJI - 350, Glulam, Web Stiffener).",
            "unit": "Enumeration",
            "affectsOutput": "Sets the AutoCAD Color Index (visual layering) and the HSB ID (classification code) for all selected beams."
          },
          {
            "name": "Grade",
            "technicalDefault": " ",
            "businessMeaning": "The structural strength grade of the timber (e.g., C16, C24, GL24h).",
            "validRange": "Any alphanumeric string representing timber grades.",
            "unit": "String",
            "affectsOutput": "Updates the 'Grade' attribute on the beam entity, which appears in labels and Bills of Materials (BOM)."
          },
          {
            "name": "sName",
            "technicalDefault": " ",
            "businessMeaning": "The unique name or mark assigned to the beam for identification in drawings and schedules.",
            "validRange": "Any alphanumeric text.",
            "unit": "String",
            "affectsOutput": "Updates the 'Name' attribute of the beam entity."
          },
          {
            "name": "Infor",
            "technicalDefault": " ",
            "businessMeaning": "User-defined notes or additional descriptive information regarding the beam.",
            "validRange": "Any text.",
            "unit": "String",
            "affectsOutput": "None. (Defined in the UI properties but the current script logic does not apply this value to the beam entities)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing 'beamtypes'",
            "effect": "Automatically sets the internal HSB ID and AutoCAD Color based on hardcoded mapping rules (e.g., 'C16Joist' forces ID 10001 and Color 32).",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Beam Properties",
            "description": "Modifies attributes (Color, HSB ID, Name, Grade) of existing beam entities in the model. Does not create new geometry.",
            "appliedTo": "User-selected set of beams."
          }
        ]
      },
      "tokens_used": 5871,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script via command or catalog.",
          "2. Script displays Dynamic Dialog allowing selection of 'Beam Type' (dropdown), 'Grade', 'Information', and 'Name'.",
          "3. User confirms selections in the dialog.",
          "4. Command line prompts: 'select a set of beams'.",
          "5. User selects one or more Beam entities and confirms.",
          "6. Script iterates through every Beam in the selection set.",
          "7. For each Beam, the script evaluates the 'beamtypes' property to determine the correct attribute mapping.",
          "8. Script updates the Beam's AutoCAD Color, HSB ID, Name, and Grade attributes.",
          "9. The 'Information' property is ignored (defined in UI but not written to the beam).",
          "10. Script instance self-destructs (eraseInstance) to leave only the modified beams."
        ],
        "conditionalBranches": [
          {
            "condition": "User cancels the beam selection prompt",
            "path1": {
              "name": "Cancellation",
              "steps": [
                "User presses Esc or cancels selection",
                "Script detects !ssE.go() is true",
                "Script executes eraseInstance()",
                "Script terminates immediately"
              ]
            },
            "path2": {
              "name": "Selection Successful",
              "steps": [
                "User selects beams and presses Enter",
                "Script retrieves Beam array",
                "Script enters the modification loop"
              ]
            }
          },
          {
            "condition": "Comparison of 'beamtypes' property against specific strings",
            "path1": {
              "name": "Type Match Found",
              "steps": [
                "Identifies specific type (e.g., 'TJI - 350')",
                "Sets Beam Color based on mapped value (usually 32, sometimes 1, 6, or 8)",
                "Sets Beam HSB ID based on mapped value (e.g., 10021)",
                "Updates Beam Name and Grade from OPM inputs"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection",
            "errorMessage": "None explicitly thrown to user.",
            "recovery": "If the user selects nothing or cancels, the script simply deletes itself. PrEntity filters enforce that only Beams can be selected."
          }
        ],
        "postInsertionActions": [],
        "notes": "The script utilizes the 'eraseInstance()' command at the end of the insertion block. Consequently, the script instance does not persist in the drawing. There are no post-insertion modifications available via OPM or context menus for the script itself, as it ceases to exist immediately after processing."
      },
      "tokens_used": 4856,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Set Floor Beam Colour and ID\n\n## Overview\nThis script batch assigns specific material properties, AutoCAD colors, and internal manufacturing IDs to selected floor beams based on a predefined product catalog. It is used to apply consistent data standards and visual coding to structural elements.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in Model Space where beams are located. |\n| Paper Space | No | Not applicable for 2D layouts or sheets. |\n| Shop Drawing | No | Does not generate views or annotations for drawings. |\n\n## Prerequisites\n- **Required entities**: Existing Beam entities (GenBeam) in the model.\n- **Minimum beam count**: At least 1 beam must be selected for the script to process.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Select `Set Floor Beam Colour and ID.mcr` from the file dialog.\n\n### Step 2: Configure Beam Attributes\nA dialog window will appear automatically upon insertion. Configure the following fields before proceeding:\n1. **Select Beam Type**: Click the dropdown to choose the specific product (e.g., C16Joist, TJI - 350, Glulam).\n2. **Enter Timber Grade**: Type the structural grade (e.g., C24, GL24h).\n3. **Enter Beam Name**: Type a specific name or mark for the beams.\n4. Click **OK** to confirm your settings.\n\n### Step 3: Select Beams\n```\nCommand Line: select a set of beams\nAction: Click on the beams in the model you wish to modify. Press Enter to confirm selection.\n```\n*Note: The script will automatically apply the color, ID, grade, and name to all selected beams and then remove itself from the drawing.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Select Beam Type | dropdown | C16Joist | Determines the product class, which automatically sets the AutoCAD Color and HSB ID (e.g., TJI - 350). |\n| Enter Timber Grade | text | (Space) | Sets the structural grade attribute on the beam (e.g., C16, C24). |\n| Enter Information | text | (Space) | A text field for notes. *Note: Currently, this field does not update the beam entity.* |\n| Enter Beam Name | text | (Space) | Assigns a name or mark to the beam for identification in schedules. |\n\n## Right-Click Menu Options\nThere are no right-click menu options available. The script instance deletes itself immediately after processing the beams to keep the drawing clean.\n\n## Settings Files\nNone required.\n\n## Tips\n- **Visual Verification**: The script changes the AutoCAD Color Index of the beams. Use this to visually verify that the correct product type has been assigned to different areas of the floor.\n- **Batch Processing**: You can window select multiple beams at once during the \"select a set of beams\" prompt to apply properties to an entire floor section quickly.\n- **Re-running**: Since the script deletes itself after use, simply run `TSLINSERT` again if you need to modify a different set of beams with new properties.\n\n## FAQ\n- **Q: Why did the script disappear after I selected the beams?**\n  - A: This is intended behavior. The script runs once to update the data and then self-destructs (`eraseInstance`) so it does not clutter your project tree.\n- **Q: I entered text in the \"Information\" field, but I don't see it on the beam.**\n  - A: The current version of the script defines this field in the dialog, but the logic to write this data to the beam entity is not implemented. Only Grade, Name, Color, and ID are updated."
      },
      "tokens_used": 4921,
      "error": null
    }
  }
}