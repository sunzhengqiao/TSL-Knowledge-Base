{
  "filename": "HSB-SectionManagerProps.mcr",
  "status": "completed",
  "total_tokens": 20170,
  "processing_time": 218.29821252822876,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "25.04.2012",
            "author": "AS",
            "changes": "Pilot version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2598,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script terminates immediately on insert with 'eraseInstance()'. No 'sd_' prefix, no Multipage prefix, no _Viewport usage, and no '#Type E' with _Entity[] patterns found. The script relies entirely on _Map for input and defines properties, characteristic of a utility/macro script."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Likely triggered via right-click context menu or macro, as it reads state from _Map.",
          "requiredSettings": [
            "Map data: 'Mode' (int, specifically value 1)",
            "Map data: 'SectionNames' (Map containing String list)"
          ]
        }
      },
      "tokens_used": 1238,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "eraseInstance",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Section|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "Dynamic list from Map: 'SectionNames'"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dDepth",
            "type": "PropDouble",
            "displayName": "|New Depth|",
            "defaultValue": "500 (Unit dependent)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1984,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Provides a user interface to select a timber section type from a dynamic list and define a specific height/depth for the beam.",
          "category": "Utility/Editing",
          "typicalUseCase": "Used during a macro operation or property modification workflow to change the cross-section of a timber element, likely when the width is fixed by a specific type but the height needs adjustment or specification."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "First string from 'SectionNames' Map",
            "businessMeaning": "The specific type or designation of the timber section (e.g., 'Solid C24', 'Glulam GL28h'). This usually dictates the material and width of the beam.",
            "validRange": "Restricted to the list of names provided dynamically by the parent process via the _Map.",
            "unit": "String (Selection)",
            "affectsOutput": "Determines the section class/width and potentially the default dimensions associated with that specific timber profile."
          },
          {
            "name": "dDepth",
            "technicalDefault": "500",
            "businessMeaning": "The vertical height (depth) of the timber beam. This is a critical structural dimension.",
            "validRange": "45mm to 600mm (typical range for residential/structural timber, extendable for glulam)",
            "unit": "mm",
            "affectsOutput": "Directly modifies the Y-axis size of the beam geometry, affecting structural span capabilities and visual representation."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Script Execution (Mode == 1)",
            "effect": "The 'SectionNames' map must be populated by the calling script before this script runs.",
            "cascade": [
              "sType"
            ]
          },
          {
            "trigger": "Selection of 'sType'",
            "effect": "While not explicitly coded in this snippet, typically selecting a section type would auto-populate the 'dDepth' or 'dWidth' values, though here 'dDepth' is exposed for manual override.",
            "cascade": [
              "dDepth"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Property Update",
            "description": "Updates the Section properties of the target element.",
            "appliedTo": "Target GenBeam or Element identified by the parent macro/process."
          }
        ]
      },
      "tokens_used": 3588,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered",
          "Check if script is being inserted (_bOnInsert)",
          "[Conditional] If inserting, execute eraseInstance() and terminate immediately",
          "If running, retrieve 'Mode' integer from _Map",
          "Evaluate value of 'Mode'",
          "[Conditional] If 'Mode' equals 1, proceed to UI setup",
          "Retrieve 'SectionNames' map from _Map",
          "Iterate through 'SectionNames' to build string array for dropdown",
          "Define PropString 'sType' for Section selection",
          "Define PropDouble 'dDepth' for New Depth input",
          "Properties are displayed in AutoCAD Properties Palette (OPM)",
          "User interacts with OPM to select Section and input Depth",
          "(Implicit) Calling script reads modified values from properties to update target element"
        ],
        "conditionalBranches": [
          {
            "condition": "Script Initialization State (_bOnInsert)",
            "path1": {
              "name": "Insertion Trigger",
              "steps": [
                "Detect _bOnInsert is true",
                "Run eraseInstance()",
                "Terminate script"
              ]
            },
            "path2": {
              "name": "Runtime/Macro Trigger",
              "steps": [
                "Detect _bOnInsert is false",
                "Read 'Mode' from _Map",
                "Proceed to Mode evaluation"
              ]
            }
          },
          {
            "condition": "Execution Mode (from _Map)",
            "path1": {
              "name": "Edit Depth Mode (Mode == 1)",
              "steps": [
                "Access 'SectionNames' map",
                "Populate sType dropdown list",
                "Expose sType and dDepth properties to OPM"
              ]
            },
            "path2": {
              "name": "Idle/Unknown Mode",
              "steps": [
                "Skip property creation",
                "Script terminates without UI output"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Existence of 'SectionNames' Map in _Map",
            "errorMessage": "(No specific error message in code, but UI fails silently)",
            "recovery": "Ensure the parent macro writes a valid Map containing section name strings to the 'SectionNames' key before running this script."
          },
          {
            "check": "Value of 'Mode' integer in _Map",
            "errorMessage": "(No specific error message, UI does not load)",
            "recovery": "Ensure the parent macro sets 'Mode' to 1 to trigger the property definition logic."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 5246,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "```json\n{\n  \"documentation\": \"# HSB-SectionManagerProps.mcr\\n\\n## Overview\\nThis script is a background utility designed to facilitate the modification of timber beam sections. It provides a user interface within the AutoCAD Properties Palette to select a section type and specify a new depth/height. It is intended to be launched by a parent macro, not inserted manually.\\n\\n## Usage Environment\\n| Space | Supported | Notes |\\n|-------|-----------|-------|\\n| Model Space | Yes | This is the primary environment for modifying beam properties. |\\n| Paper Space | No | Not supported. |\\n| Shop Drawing | No | This is a model editing tool. |\\n\\n## Prerequisites\\n- **Parent Macro**: This script must be executed by a calling script (Macro) that initializes the required data.\\n- **Map Data**: The calling macro must provide a list of section names via the `_Map` (Key: `SectionNames`).\\n- **Target Entity**: A GenBeam or Element must be selected/active for the properties to apply effectively.\\n\\n## Usage Steps\\n\\n### Step 1: Launch Script\\n**Method**: Via Parent Macro\\n- Run the main \\\"Section Manager\\\" or related macro command from your hsbCAD toolbar.\\n- *Note*: Do not use `TSLINSERT`. If you try to insert this script manually, it will detect the insertion state and immediately delete itself, as it is a utility helper.\\n\\n### Step 2: Access Properties\\n```\\nCommand Line: (No prompts appear)\\nAction:\\n1. Select the beam(s) you wish to modify.\\n2. Open the AutoCAD Properties Palette (Press Ctrl+1).\\n3. Look for the 'hsbCAD' or specific extension properties at the top of the palette.\\n```\\n\\n### Step 3: Modify Section Data\\n```\\nInterface: AutoCAD Properties Palette\\nAction: \\n1. Click on the 'Section' dropdown and select the desired timber type.\\n2. Enter the desired value in the 'New Depth' field.\\n3. The parent macro will apply these changes to the selected element.\\n```\\n\\n## Properties Panel Parameters\\n\\n| Parameter | Type | Default | Description |\\n|-----------|------|---------|-------------|\\n| \\\\|Section\\\\| | Dropdown | (Dynamic) | Select the timber section profile (e.g., Solid C24, Glulam). The options are dynamically loaded from the catalog. |\\n| \\\\|New Depth\\\\| | Number | 500 | Specify the vertical height (depth) of the beam. Units depend on your project settings (typically mm). |\\n\\n## Right-Click Menu Options\\n\\n| Menu Item | Description |\\n|-----------|-------------|\\n| None | This script does not add custom context menu items. |\\n\\n## Settings Files\\n- **Filename**: None required.\\n- **Location**: N/A\\n- **Purpose**: This script reads configuration directly from the parent macro's memory (_Map), requiring no external XML files.\\n\\n## Tips\\n- **Unit Awareness**: The script uses internal unit conversions. Ensure your project units are set correctly (Metric vs Imperial) so the 'New Depth' value is interpreted correctly.\\n- **Palette Visibility**: If you do not see the options, ensure the AutoCAD Properties Palette (Ctrl+1) is active and that you have selected the target element.\\n- **Macro Dependency**: If the dropdown list for 'Section' is empty, the parent macro may have failed to retrieve the catalog data. Restart the parent macro.\\n\\n## FAQ\\n- Q: Can I insert this script into my drawing?\\n- A: No. This is a utility script that runs in the background. If you attempt to insert it, it will automatically erase itself to prevent cluttering the drawing.\\n\\n- Q: Where do I type the new beam height?\\n- A: You do not type it on the command line. You must change the 'New Depth' value in the AutoCAD Properties Palette.\\n\\n- Q: Why are there no sections in the dropdown list?\\n- A: The list is provided by the parent macro. Ensure the parent tool is active and has successfully connected to the hsbCAD catalog database.\"\n}\n```"
      },
      "tokens_used": 5516,
      "error": null
    }
  }
}