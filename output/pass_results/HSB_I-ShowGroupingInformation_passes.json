{
  "filename": "HSB_I-ShowGroupingInformation.mcr",
  "status": "completed",
  "total_tokens": 27210,
  "processing_time": 418.3808379173279,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": null,\n    \"minorVersion\": null,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": null,\n  \"versionHistory\": [\n    {\n      \"version\": \"1.00\",\n      \"date\": \"03.04.2019"
      },
      "tokens_used": 5884,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Entity entities[] = Group().collectEntities(true, Entity(), _kModelSpace);"
        },
        "prerequisites": {
          "requiredEntities": [
            "Entities with HSB_ grouping MapX data (specifically keys containing 'CHILD' and 'PARENT')"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing grouped elements",
          "requiredSettings": []
        }
      },
      "tokens_used": 3569,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3620,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a visual text report in the ModelSpace displaying the hierarchy and sequence of grouped elements (parent-child relationships) based on HSB_ MapX data.",
          "category": "Visualization/Diagnostics",
          "typicalUseCase": "Used to verify that complex grouping logic (such as stacking or assembly orders) has been applied correctly to elements before generating manufacturing data."
        },
        "parameters": [
          {
            "name": "_Pt0",
            "technicalDefault": "User input via getPoint",
            "businessMeaning": "The anchor point in the 3D model where the grouping information report list will be generated.",
            "validRange": "Any coordinate in ModelSpace (usually clicked near the grouped elements or in an empty area of the layout)",
            "unit": "3D Coordinates (mm)",
            "affectsOutput": "Determines the spatial location of the generated text report. Moving this point moves the entire list of grouping data."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Text Display (Visualization)",
            "description": "A formatted list of text strings showing Group Type, Parent ID, Sequence Number, and Child Element Numbers/Handles.",
            "appliedTo": "ModelSpace (Non-geometric annotation)"
          }
        ]
      },
      "tokens_used": 3912,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered (Insert)",
          "Check Insert Cycle Count",
          "Prompt user for a position point (_Pt0) in ModelSpace",
          "Create Script Instance and Pause",
          "[On Recalc/Update] Collect all entities within the current group",
          "Iterate through collected entities and scan MapX keys",
          "Identify keys matching 'HSB_...CHILD' and 'HSB_...PARENT' patterns",
          "Populate arrays for Children, Parents, Sequences, and Grouping Types",
          "Sort data: First by Child Sequence number, then by Parent UID",
          "Initialize Display object (text size, row height, alignment)",
          "Draw Header 'PROJECT GROUPS'",
          "Loop through sorted Children array",
          "Check if current child belongs to a different Parent Group than previous child",
          "If New Group: Lookup Parent Sequence, Draw Group Header (Type & UID), Move cursor to new line",
          "Draw Child Name (Element Number or Handle)",
          "Move cursor to next horizontal column",
          "End Loop"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count check (Insert Phase)",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase Script Instance",
                "Return (Exit)"
              ]
            },
            "path2": {
              "name": "Cycle = 1",
              "steps": [
                "Execute getPoint() for position",
                "Return (Finish Insert)"
              ]
            }
          },
          {
            "condition": "MapX Key Analysis (Recalc Phase)",
            "path1": {
              "name": "Key ends with 'CHILD'",
              "steps": [
                "Extract Grouping Type",
                "Store Child Entity, Sequence, Parent UID",
                "Add Grouping Type to list if new"
              ]
            },
            "path2": {
              "name": "Key ends with 'PARENT'",
              "steps": [
                "Extract Grouping Type",
                "Store Parent Entity",
                "Add Grouping Type to list if new"
              ]
            }
          },
          {
            "condition": "Group Change Detection (Visualization Loop)",
            "path1": {
              "name": "New Group Detected (Parent UID differs from previous)",
              "steps": [
                "Search Parents array for matching UID and Type",
                "Extract Parent Sequence Number",
                "Draw Group Header string (e.g., 'Stacking [UID] - Sequence: 1')",
                "Reset Column Position",
                "Move Row Start down by Row Height"
              ]
            },
            "path2": {
              "name": "Same Group",
              "steps": [
                "Draw Child Entity Name at current Column Position",
                "Increment Column Position horizontally"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Existence of HSB_ MapX Data",
            "errorMessage": "No explicit error message (Script runs silently)",
            "recovery": "Ensure elements in the group possess valid MapX attributes starting with 'HSB_' and containing 'CHILD' or 'PARENT'. Without this, the script only draws the 'PROJECT GROUPS' header."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Move Report",
            "how": "Grip Edit / Standard AutoCAD Move Command",
            "effect": "Updates the _Pt0 variable, causing the entire text report to regenerate at the new location."
          }
        ]
      },
      "tokens_used": 6318,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_I-ShowGroupingInformation.mcr\n\n## Overview\nThis script generates a visual text report in the ModelSpace that displays the hierarchy and sequence of grouped elements (parent-child relationships) based on HSB_ MapX data. It is typically used to verify that complex grouping logic, such as stacking or assembly orders, has been applied correctly to elements before generating manufacturing data.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The report is generated in the 3D model environment. |\n| Paper Space | No | Not supported for layouts. |\n| Shop Drawing | No | This is a model visualization tool. |\n\n## Prerequisites\n- **Required Entities**: Entities within the current group must possess HSB_ grouping MapX data (specifically keys containing 'CHILD' and 'PARENT').\n- **Minimum Beam Count**: 0 (However, grouped elements are required to generate a visible report).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_I-ShowGroupingInformation.mcr`\n\n### Step 2: Select Position\n```\nCommand Line: Select a position\nAction: Click anywhere in the ModelSpace to define where the grouping report list will be placed.\n```\n\n## Properties Panel Parameters\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| None | N/A | N/A | This script does not expose any editable parameters in the Properties Palette. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | N/A |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Relocating the Report**: You can move the generated text list by selecting the script instance and using the standard AutoCAD **Move** command or dragging the grip point associated with the insertion location.\n- **Data Verification**: If the script only draws the \"PROJECT GROUPS\" header but lists no data, check that your elements actually have the required MapX attributes (keys starting with 'HSB_' and ending with 'CHILD' or 'PARENT').\n- **Organization**: The report automatically sorts children by sequence number and then by Parent UID, making it easier to read complex hierarchies.\n\n## FAQ\n- **Q: Why does the report only show \"PROJECT GROUPS\" and nothing else?**\n- **A**: The script runs silently if it cannot find valid data. Ensure the elements in the group have the specific HSB_ MapX attributes (containing 'CHILD' and 'PARENT') required for the report.\n\n- **Q: Can I change the text size or formatting of the report?**\n- **A**: No, the text size and formatting are hardcoded within the script logic. You can scale the entire report by scaling the script instance if necessary, but individual font properties are not editable via the properties panel."
      },
      "tokens_used": 3907,
      "error": null
    }
  }
}