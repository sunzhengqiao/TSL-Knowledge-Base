{
  "filename": "GE_WDET_LADDER_EDGE.mcr",
  "status": "completed",
  "total_tokens": 36036,
  "processing_time": 569.2479531764984,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "0.4",
            "date": "10.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added\n\t- Thumbnail added\n\t- Copyright added"
          },
          {
            "version": "0.3_RL",
            "date": "Jan 5 2011",
            "author": "RL",
            "changes": "Adjusted for materials coming from _MAP"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5903,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script utilizes `getElement()` for selection and performs 3D geometric operations such as creating Beams (`bm1.dbCreate`), calculating 3D coordinates (`ptBlock.transformBy`), and handling Body intersections (`bm.realBody().hasIntersection`). No Shop Drawing (`sd_`) or Paper Space specific entities are used."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element (Wall/ElementWallSF)"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 4592,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select an element",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select an insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strEmpty0",
            "type": "PropString",
            "displayName": "PLACEMENT PROPERTIES",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dStartOffset",
            "type": "PropDouble",
            "displayName": "  Start Offset",
            "defaultValue": "U(600, 24)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dEndOffset",
            "type": "PropDouble",
            "displayName": "  End Offset",
            "defaultValue": "U(0, 0)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dSpacing",
            "type": "PropDouble",
            "displayName": "  Spacing",
            "defaultValue": "U(600, 24)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "strEmpty1",
            "type": "PropString",
            "displayName": "MATERIAL PROPERTIES",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "strMat",
            "type": "PropString",
            "displayName": "  Material",
            "defaultValue": "SPF",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "strGrade",
            "type": "PropString",
            "displayName": "  Grade",
            "defaultValue": "#2",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5725,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates 'ladder' framing (horizontal blocking) between two vertical studs or trimmers to reinforce a wall edge or support stair stringers.",
          "category": "Framing",
          "typicalUseCase": "Creating a stiffened edge for floor openings, providing nailing backing for stair stringers, or reinforcing wall ends where standard stud spacing is not present."
        },
        "parameters": [
          {
            "name": "dStartOffset",
            "technicalDefault": "U(600, 24)",
            "businessMeaning": "The vertical distance from the insertion point (usually the bottom plate) to the center (or specified alignment) of the first horizontal blocking piece.",
            "validRange": "0 mm to 1000 mm (0\" to 39\")",
            "unit": "mm / inch",
            "affectsOutput": "Moves the starting position of the blocking run up or down. If set to 0, it aligns with the bottom plate logic."
          },
          {
            "name": "dEndOffset",
            "technicalDefault": "U(0, 0)",
            "businessMeaning": "The distance from the top of the opening/studs to the top of the blocking run. Effectively creates a top margin or clearance.",
            "validRange": "0 mm to 600 mm (0\" to 24\")",
            "unit": "mm / inch",
            "affectsOutput": "Determines where the blocking run stops vertically. If 0, the blocking extends to the top edge. If > 0, it leaves a gap at the top."
          },
          {
            "name": "dSpacing",
            "technicalDefault": "U(600, 24)",
            "businessMeaning": "The on-center spacing between consecutive blocking pieces.",
            "validRange": "300 mm to 1200 mm (12\" to 48\")",
            "unit": "mm / inch",
            "affectsOutput": "Controls the density of the blocking. Changing this adds or removes pieces in the array."
          },
          {
            "name": "strMat",
            "technicalDefault": "\"SPF\"",
            "businessMeaning": "The material code assigned to the generated blocking beams.",
            "validRange": "Any valid material name in the catalog (e.g., SPF, SYP, GLULAM)",
            "unit": "String",
            "affectsOutput": "Updates the material property in the BOM and physical properties of the beams."
          },
          {
            "name": "strGrade",
            "technicalDefault": "\"#2\"",
            "businessMeaning": "The structural grade code assigned to the generated blocking beams.",
            "validRange": "Any valid grade name in the catalog (e.g., #2, #1, SS)",
            "unit": "String",
            "affectsOutput": "Updates the grade property for engineering calculations and labeling."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Insertion Point (_Pt0) selection",
            "effect": "Identifies the two bounding vertical studs (left and right) and determines the vertical start reference.",
            "cascade": [
              "dStartOffset",
              "dSpacing",
              "dEndOffset"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam (Blocking)",
            "description": "Creates horizontal blocking beams (Type: _kSFBlocking) sized approximately 38mm x 25mm (depth/width) spanning between the two identified studs.",
            "appliedTo": "The selected Wall Element."
          },
          {
            "type": "Visual Change",
            "description": "Colors the two bounding studs (left and right) to color index 2 (usually Yellow) to indicate they are part of this detail.",
            "appliedTo": "Existing Studs found during insertion."
          }
        ]
      },
      "tokens_used": 6230,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script via command or toolbar.",
          "2. Script checks for properties in _Map or defaults (Catalog, StartOffset, etc.).",
          "3. User selects a Wall Element (ElementWallSF).",
          "4. User selects an Insertion Point (usually near the bottom plate between two studs).",
          "5. Script validates element and retrieves geometry (Coordinate System, Vectors).",
          "6. Script filters all beams in element into Vertical and Horizontal arrays.",
          "7. Script identifies the immediate left and right vertical studs relative to the insertion point.",
          "8. Script creates a collision body and erases any existing horizontal blocking within the stud bay.",
          "9. Script calculates the top and bottom boundaries based on wall geometry and offset properties.",
          "10. Script iterates vertically to calculate center points for new blocking based on Spacing.",
          "11. Script generates Beam entities at calculated points, stretching them between left and right studs.",
          "12. Script applies Material, Grade, Color, and Module properties to new beams.",
          "13. Script applies Color and Module to the bounding studs.",
          "14. Script erases its own instance (Logic Instance removed, leaving only geometry)."
        ],
        "conditionalBranches": [
          {
            "condition": "Start Offset value (dStartOffset)",
            "path1": {
              "name": "Default to Bottom Plate",
              "steps": [
                "Check if dStartOffset == 0",
                "Calculate start position as (Bottom Plate Thickness + Half Block Size)",
                "Ensures first block sits tight to plate"
              ]
            },
            "path2": {
              "name": "Custom Offset",
              "steps": [
                "Check if dStartOffset > 0",
                "Calculate start position as (Insertion Point Y + dStartOffset)",
                "Places first block at user defined height"
              ]
            }
          },
          {
            "condition": "End Offset Logic (dEndOffset)",
            "path1": {
              "name": "Full Height (Offset 0)",
              "steps": [
                "dMaxHeight reduced by half block size",
                "Loop runs up to reduced height",
                "No extra block forced at top"
              ]
            },
            "path2": {
              "name": "Standard Clearance",
              "steps": [
                "dMaxHeight reduced by (End Offset + 1 Block Size)",
                "Loop runs up to reduced height",
                "Top block position explicitly calculated and added to array"
              ]
            }
          },
          {
            "condition": "Bounding Stud Detection",
            "path1": {
              "name": "Success",
              "steps": [
                "Valid beam found to the left and right of insertion point",
                "Script proceeds to blocking generation"
              ]
            },
            "path2": {
              "name": "Failure",
              "steps": [
                "No beam found on either side",
                "Report Message: 'TSL... cannot find a connecting stud...'",
                "Script calls eraseInstance() and terminates"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Validity",
            "errorMessage": "Implicit (Instance erased)",
            "recovery": "User must select a valid ElementWallSF that returns valid for Wall() cast."
          },
          {
            "check": "Stud Availability",
            "errorMessage": "TSL[ScriptName] cannot find a connecting stud on element [ElementNumber]",
            "recovery": "User must select insertion point between two valid vertical studs, not outside the wall or in a gap larger than the search threshold (10000mm)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script is non-persistent)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() at the end of the execution. The TSL logic object is removed from the drawing, leaving only the generated beams and modified studs as standard CAD entities. Parameters cannot be edited via OPM after insertion."
          }
        ]
      },
      "tokens_used": 8171,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WDET_LADDER_EDGE.mcr\n\n## Overview\nGenerates horizontal blocking (ladder framing) between two existing vertical studs within a wall element. This is typically used to reinforce wall edges, provide nailing backing for stair stringers, or frame around floor openings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in 3D Model Space. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not intended for 2D detailing views. |\n\n## Prerequisites\n- **Required Entities**: An existing Wall Element (`ElementWallSF`) containing at least two vertical studs.\n- **Minimum Beam Count**: 2 vertical studs (the bounding studs for the blocking).\n- **Required Settings**: None. Uses default catalog or properties if available.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: Run the script via your custom toolbar, macro, or the `TSLINSERT` command selecting `GE_WDET_LADDER_EDGE.mcr`.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select an element\nAction: Click on the wall (Element) where you want to add the ladder framing.\n```\n\n### Step 3: Select Insertion Point\n```\nCommand Line: Select an insertion point\nAction: Click a point in the empty space between the two vertical studs where you want the blocking to run. \nNote: The script detects the immediate left and right studs based on this click location.\n```\n\n## Properties Panel Parameters\n*Note: These parameters must be set *before* running the script, as the script instance deletes itself upon completion.*\n\n### Placement Properties\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Start Offset | Number | 600 mm (24\") | The vertical distance from the bottom plate/reference point to the center of the first blocking piece. Set to 0 to align tight against the bottom. |\n| End Offset | Number | 0 mm (0\") | The distance from the top of the studs to the top of the blocking run. Use this to create a clearance gap at the top. |\n| Spacing | Number | 600 mm (24\") | The on-center vertical distance between consecutive blocking pieces. |\n\n### Material Properties\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Material | Text | SPF | The material code assigned to the generated blocking beams (e.g., SPF, SYP). |\n| Grade | Text | #2 | The structural grade code assigned to the generated blocking beams. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script is non-persistent. Once executed, the script logic instance is removed, leaving only the generated beams. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: Script relies on internal defaults and OPM properties; no external settings file is required.\n\n## Tips\n- **Stud Selection**: Ensure you click precisely between the two studs you intend to use as boundaries. The script looks for the closest vertical studs to the left and right of your insertion point.\n- **Visual Feedback**: After running, the two bounding studs will change color (usually to Yellow) to indicate they are part of this specific detail.\n- **Cleanup**: If there is already horizontal blocking in the selected bay, this script will automatically detect and erase it before generating the new ladder framing.\n- **Non-Persistent**: Since the script deletes itself after running, you cannot double-click the result later to change the spacing or offsets. You must delete the beams and re-run the script with new settings.\n\n## FAQ\n- **Q: Why do I get the error \"Cannot find a connecting stud\"?**\n  A: The script could not locate two vertical studs immediately to the left and right of your insertion point. Ensure you are clicking inside the wall bounds and within a reasonable distance of the studs (less than 10m).\n- **Q: Can I edit the spacing after I have created the blocking?**\n  A: No. This script generates static geometry and then removes itself from the drawing. To change the spacing, delete the generated blocking beams and run the script again.\n- **Q: What happens to the existing blocking between the studs?**\n  A: The script creates a \"collision body\" in the bay and automatically erases any existing horizontal blocking beams in that space before adding the new ones."
      },
      "tokens_used": 5415,
      "error": null
    }
  }
}