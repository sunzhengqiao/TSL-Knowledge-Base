{
  "filename": "hsbDrill.mcr",
  "status": "completed",
  "total_tokens": 42357,
  "processing_time": 732.5501222610474,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9103,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses GenBeam, Drill, and Mortise classes and calls addTool() methods on GenBeams. No ShopDrawing specific prefixes (sd_), Viewport handling, or #Type E declarations found. The logic modifies physical 3D geometry."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6299,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getGenBeam",
              "promptOriginal": "Select main genbeam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getGenBeam",
              "promptOriginal": "Select additional genbeams",
              "condition": "_bOnInsert",
              "required": false
            },
            {
              "step": 3,
              "function": "getPoint",
              "promptOriginal": "Select startpoint",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 4,
              "function": "getPoint",
              "promptOriginal": "Select endpoint",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dDepth",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Sets the depth of the drill 0=complete through"
          },
          {
            "index": 1,
            "variable": "dDiameter",
            "type": "PropDouble",
            "displayName": "Diameter",
            "defaultValue": "U(18)",
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Sets the diameter of the drill"
          },
          {
            "index": 2,
            "variable": "sAlignment",
            "type": "PropString",
            "displayName": "UCS",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "-Z",
              "-Y",
              "Z",
              "Y"
            ],
            "category": "General",
            "description": "Sets the alignment of the drills in relation to the most aligned beam direction of the current UCS"
          },
          {
            "index": 3,
            "variable": "sSnapAxis",
            "type": "PropString",
            "displayName": "Snap to center line",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "General",
            "description": "Defines if the drills will placed along the axis of the first selected beam"
          },
          {
            "index": 4,
            "variable": "dDepthSink1",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Sinkhole Reference Side",
            "description": "Sets the depth of the sink hole A negative value shortens the drill in the main object if applicable."
          },
          {
            "index": 5,
            "variable": "dDiameterSink1",
            "type": "PropDouble",
            "displayName": "Diameter",
            "defaultValue": "U(18)",
            "inputType": "number",
            "options": [],
            "category": "Sinkhole Reference Side",
            "description": "Sets the diameter of the drill"
          },
          {
            "index": 6,
            "variable": "dDepthSink2",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Sinkhole opposite Side",
            "description": "Sets the depth of the drill 0=complete through"
          },
          {
            "index": 7,
            "variable": "dDiameterSink2",
            "type": "PropDouble",
            "displayName": "Diameter",
            "defaultValue": "U(18)",
            "inputType": "number",
            "options": [],
            "category": "Sinkhole opposite Side",
            "description": "Sets the diameter of the drill"
          },
          {
            "index": 8,
            "variable": "dLength",
            "type": "PropDouble",
            "displayName": "Length",
            "defaultValue": "U(18)",
            "inputType": "number",
            "options": [],
            "category": "Slotted Hole",
            "description": "Sets a slotted hole if the length exceeds the diameter."
          },
          {
            "index": 9,
            "variable": "sSlottedType",
            "type": "PropString",
            "displayName": "Assignment",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "none",
              "first object",
              "second object",
              "all"
            ],
            "category": "Slotted Hole",
            "description": "Defines which objects of the selection set receive a slotted hole"
          },
          {
            "index": 10,
            "variable": "sHWDescription",
            "type": "PropString",
            "displayName": "Hardware",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "",
              "Schlüsselschraube 16 x 220",
              "Schlüsselschraube 16 x 260",
              "Stehbolzen kurz",
              "Stehbolzen lang"
            ],
            "category": "Baufritz",
            "description": "Definiert die verwendeten Verbindungsmittel"
          },
          {
            "index": 11,
            "variable": "dOffsetAxis",
            "type": "PropDouble",
            "displayName": "Axis offset",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "General",
            "description": "Defines the offset from the beam axis. Only active for nonzero entries and when Snap to center line is set to no."
          },
          {
            "index": 12,
            "variable": "sDistributionMode",
            "type": "PropString",
            "displayName": "Mode",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "Even Distribution",
              "Fixed Distribution"
            ],
            "category": "Distribution",
            "description": "Sets the distribution of the distribution"
          },
          {
            "index": 13,
            "variable": "dOffset",
            "type": "PropDouble",
            "displayName": "Inter distance",
            "defaultValue": "U(70)",
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": "Sets the offset of the distribution"
          },
          {
            "index": 14,
            "variable": "dOffsetStart",
            "type": "PropDouble",
            "displayName": "Distance from startpoint",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": "Sets the distance of start point of the distribution to the given point"
          },
          {
            "index": 15,
            "variable": "dOffsetEnd",
            "type": "PropDouble",
            "displayName": "Distance from endpoint",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": "Sets the distance of end point of the distribution to the given point"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "TslDoubleClick",
            "handler": "TslDoubleClick",
            "action": "Re-executes the script or performs default double-click action",
            "alsoTriggeredBy": "Double Click"
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 9063,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Creates a linear distribution of drills (round holes), slotted holes, and sinkholes (counterbores) across one or multiple selected beams to facilitate mechanical connections.\",\n    \"category\": \"Machining / Connection\",\n    \"typicalUseCase\": \"Aligning multiple timber members (e.g., top plates, studs, or posts) for bolting or screwing together, allowing for counterbores for washers/nuts and slotted holes to accommodate wood movement or alignment tolerances.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"dDepth\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The total depth of the cylindrical hole. A value of 0 means the hole penetrates completely through all selected materials.\",\n      \"validRange\": \"0 to beam thickness (0 = Through)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Determines how deep the drill bit cuts. If 0, it ensures complete penetration.\"\n    },\n    {\n      \"name\": \"dDiameter\",\n      \"technicalDefault\": \"U(18)\",\n      \"businessMeaning\": \"The diameter of the main shaft of the drill.\",\n      \"validRange\": \"6mm to 100mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the width of the hole or the width of a slotted hole.\"\n    },\n    {\n      \"name\": \"sAlignment\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Sets the orientation of the drill axis relative to the current User Coordinate System (UCS).\",\n      \"validRange\": \"-Z, -Y, Z, Y\",\n      \"unit\": \"Direction\",\n      \"affectsOutput\": \"Determines the direction the holes are drilled (e.g., vertically down, horizontally sideways).\"\n    },\n    {\n      \"name\": \"sSnapAxis\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Forces the drill path to lock exactly onto the centerline axis of the first selected beam.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Controls whether the drill position is fixed to the beam center or can float (allowing 'Axis offset' to work).\"\n    },\n    {\n      \"name\": \"dDepthSink1\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The depth of the counterbore (sinkhole) on the Reference Side (start side). A negative value shortens the drill in the main object for dowel-like connections.\",\n      \"validRange\": \"-50mm to 50mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Creates a larger cylindrical cavity at the start of the hole for bolt heads/nuts. Affects where the main drill starts cutting.\"\n    },\n    {\n      \"name\": \"dDiameterSink1\",\n      \"technicalDefault\": \"U(18)\",\n      \"businessMeaning\": \"The diameter of the counterbore on the Reference Side.\",\n      \"validRange\": \">= dDiameter\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the width of the cavity at the start of the hole.\"\n    },\n    {\n      \"name\": \"dDepthSink2\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The depth of the counterbore (sinkhole) on the Opposite Side (end side). 0 means complete through.\",\n      \"validRange\": \"0 to 50mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Creates a larger cylindrical cavity at the end of the hole for washers/nuts.\"\n    },\n    {\n      \"name\": \"dDiameterSink2\",\n      \"technicalDefault\": \"U(18)\",\n      \"businessMeaning\": \"The diameter of the counterbore on the Opposite Side.\",\n      \"validRange\": \">= dDiameter\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the width of the cavity at the end of the hole.\"\n    },\n    {\n      \"name\": \"dLength\",\n      \"technicalDefault\": \"U(18)\",\n      \"businessMeaning\": \"The length of the hole along the beam axis. If this exceeds the Diameter, a slotted hole is created.\",\n      \"validRange\": \">= dDiameter\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Transforms a round hole into a slotted hole (oval) if Length > Diameter.\"\n    },\n    {\n      \"name\": \"sSlottedType\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Specifies which beams in the selection set receive the slotted hole versus the round hole.\",\n      \"validRange\": \"none, first object, second object, all\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Allocates the slot geometry to specific beams (e.g., slot the outer beam, drill round holes in inner beams).\"\n    },\n    {\n      \"name\": \"sHWDescription\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Selects specific hardware fasteners (Baufritz specific) to associate with the machining.\",\n      \"validRange\": \"Schlüsselschraube 16 x 220, Stehbolzen, etc.\",\n      \"unit\": \"Catalog\",\n      \"affectsOutput\": \"Inserts a Hardware entity for BOM/reporting and may preset dimensions.\"\n    },\n    {\n      \"name\": \"dOffsetAxis\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Shifts the row of holes laterally away from the beam's centerline.\",\n      \"validRange\": \"-BeamWidth/2 to +BeamWidth/2\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the drilling path perpendicular to the beam axis.\"\n    },\n    {\n      \"name\": \"sDistributionMode\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Determines how the holes are spaced along the selected path.\",\n      \"validRange\": \"Even Distribution, Fixed Distribution\",\n      \"unit\": \"Mode\",\n      \"affectsOutput\": \"Calculates spacing. 'Even' divides space by count; 'Fixed' uses specific 'Inter distance'.\"\n    },\n    {\n      \"name\": \"dOffset\",\n      \"technicalDefault\": \"U(70)\",\n      \"businessMeaning\": \"The center-to-center distance between holes.\",\n      \"validRange\": \"40mm+\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Controls the density/spacing of the holes.\"\n    },\n    {\n      \"name\": \"dOffsetStart\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The distance from the selected start point to the"
      },
      "tokens_used": 11058,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbDrill.mcr\n\n## Overview\nCreates a linear distribution of drills (round holes), slotted holes, and sinkholes (counterbores) across one or multiple selected beams to facilitate mechanical connections like bolting.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D model entities. |\n| Paper Space | No | Not supported in layouts. |\n| Shop Drawing | No | Does not generate 2D drawing views directly. |\n\n## Prerequisites\n- **Required Entities**: GenBeam (Timber Beams)\n- **Minimum Beam Count**: 1\n- **Required Settings Files**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `hsbDrill.mcr`\n\n### Step 2: Select Main Beam\n```\nCommand Line: Select main genbeam\nAction: Click on the primary timber beam to define the reference context.\n```\n\n### Step 3: Select Additional Beams\n```\nCommand Line: Select additional genbeams\nAction: Click any other beams you wish to drill through simultaneously. Press Enter to finish selection if only drilling one beam.\n```\n\n### Step 4: Define Start Point\n```\nCommand Line: Select startpoint\nAction: Click in the model to set the starting location for the row of holes.\n```\n\n### Step 5: Define End Point\n```\nCommand Line: Select endpoint\nAction: Click to set the ending location for the row of holes.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **General** | | | |\n| Depth | Number | 0 | Depth of the drill hole. Use 0 for a through hole. |\n| Diameter | Number | U(18) | Diameter of the main drill hole. |\n| UCS | Dropdown | - | Aligns the drill direction relative to the current UCS (-Z, -Y, Z, Y). |\n| Snap to center line | Dropdown | - | If \"Yes\", locks the drill path to the beam's axis. |\n| Axis offset | Number | U(0) | Lateral offset from the beam centerline (Only active if Snap to center line is \"No\"). |\n| **Sinkhole Reference Side** | | | |\n| Depth | Number | 0 | Depth of the counterbore on the start side. Negative value shortens the drill. |\n| Diameter | Number | U(18) | Diameter of the counterbore on the start side. |\n| **Sinkhole opposite Side** | | | |\n| Depth | Number | 0 | Depth of the counterbore on the end side. 0 for through. |\n| Diameter | Number | U(18) | Diameter of the counterbore on the end side. |\n| **Slotted Hole** | | | |\n| Length | Number | U(18) | Length of the hole. If Length > Diameter, a slotted hole is created. |\n| Assignment | Dropdown | - | Selects which objects get the slotted hole (none, first object, second object, all). |\n| **Baufritz** | | | |\n| Hardware | Dropdown | - | Selects specific hardware fasteners (e.g., Schlüsselschraube, Stehbolzen) for reporting/BOM. |\n| **Distribution** | | | |\n| Mode | Dropdown | - | Sets spacing logic: \"Even Distribution\" or \"Fixed Distribution\". |\n| Inter distance | Number | U(70) | Center-to-center distance between holes (used in Fixed mode). |\n| Distance from startpoint | Number | 0 | Offsets the first hole from the selected start point. |\n| Distance from endpoint | Number | 0 | Offsets the last hole from the selected end point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| TslDoubleClick | Re-executes the script or performs the default double-click action to modify parameters. |\n\n## Settings Files\nNone defined.\n\n## Tips\n- **Through Holes**: Always set the main Depth to `0` to ensure the hole goes completely through the material, regardless of thickness changes.\n- **Counterbores**: Use the Sinkhole parameters to create space for bolt heads or washers. A negative depth on \"Sinkhole Reference Side\" is useful for hiding bolt heads or creating dowel-like connections.\n- **Slotted Holes**: To create a slot, ensure the `Length` property is larger than the `Diameter`. Use the `Assignment` property to apply the slot only to specific beams in a stack (e.g., allow movement on the outer beam while fixing the inner beam).\n- **Alignment**: If holes are not drilling in the intended direction, check the `UCS` property to ensure it matches your current view orientation (e.g., switch between Z or Y).\n\n## FAQ\n- **Q: How do I drill multiple holes in a line?**\n  A: The script automatically creates a distribution based on the start and end points you selected. Adjust the `Inter distance` or `Distribution Mode` in the properties to control spacing.\n- **Q: My hole is not going all the way through the beam.**\n  A: Check the `Depth` property under General. Ensure it is set to `0`.\n- **Q: Can I offset the holes from the center of the beam?**\n  A: Yes. Set `Snap to center line` to \"No\" and define a value for `Axis offset`.\n- **Q: What does the Hardware dropdown do?**\n  A: This is primarily for reporting (BOM) and potentially presetting dimensions for specific manufacturers (Baufritz standards)."
      },
      "tokens_used": 6834,
      "error": null
    }
  }
}