{
  "filename": "hsb_SetHeadBinderCode.mcr",
  "status": "completed",
  "total_tokens": 22450,
  "processing_time": 260.2570414543152,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "26.05.2010",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.2",
            "date": "26.05.2010",
            "author": "",
            "changes": "Bugfix"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3932,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses PrEntity to prompt the user for 'ElementWall' selection during _bOnInsert. It accesses the _Element collection and iterates through Beam objects (el.beam()) to modify their properties (beamCode and type) in 3D. There are no references to _Viewport, sd_ functions, or ShopDrawing entities (#Type E)."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall",
            "Beam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "3D Model Space (AutoCAD)",
          "requiredSettings": []
        }
      },
      "tokens_used": 2728,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2309,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Identifies top plates in wall elements that intersect with perpendicular binders/joists, automatically renaming them with a specific 'V' prefix and reclassifying them as 'Very Top Plates'.",
          "category": "Framing/Data Automation",
          "typicalUseCase": "Used after wall generation to distinguish and rename specific top plates that serve as head binders for intersecting structural members (e.g., floor joists or roof purlins) for downstream manufacturing or reporting."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "User Selection",
            "businessMeaning": "The set of Wall Elements (ElementWall) selected by the user to be scanned for top plates requiring reclassification.",
            "validRange": "Any valid ElementWall entity in the drawing containing beams.",
            "unit": "Selection",
            "affectsOutput": "Determines which walls are analyzed; only top plates within these selected elements will be evaluated and potentially renamed."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Property Update",
            "description": "Modifies the BeamCode (prepending 'V') and the Type (set to _kSFVeryTopPlate) of existing beams.",
            "appliedTo": "Top plates within the selected walls that are located at the highest elevation and physically intersect with perpendicular beams."
          }
        ]
      },
      "tokens_used": 4461,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 6161,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetHeadBinderCode.mcr\n\n## Overview\nThis script identifies specific top plates within wall elements that intersect with perpendicular beams (such as binders or joists). It automatically renames these top plates by adding a 'V' prefix and updates their classification to \"Very Top Plate\".\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in the 3D model where wall elements and beams reside. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not intended for 2D shop drawing generation. |\n\n## Prerequisites\n- **Required entities**: Wall Elements (`ElementWall`) containing Beams.\n- **Minimum beam count**: 0\n- **Required settings files**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SetHeadBinderCode.mcr`\n\n### Step 2: Select Wall Elements\n```\nCommand Line: \nSelect a set of elements\n```\n**Action**: Click on the Wall Elements in the drawing that you wish to analyze. Once selected, press Enter to confirm.\n\n## Properties Panel Parameters\n\nNo Properties Panel parameters are available for this script.\n\n## Right-Click Menu Options\n\nNo Right-Click menu options are available for this script.\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- Ensure that the intersecting binders or joists are already drawn or present in the model before running this script, as it relies on geometric intersection to identify the correct top plates.\n- The script specifically targets the highest plate in the wall (the top plate) that crosses the path of a perpendicular beam.\n- Check your naming scheme afterwards; the script prepends the character 'V' to the existing BeamCode of the identified plates.\n\n## FAQ\n- **Q: What does the 'V' prefix stand for?**\n  A: The 'V' denotes a \"Very Top Plate,\" which is often treated differently in manufacturing or lists than standard top plates because it serves as a head binder for intersecting members.\n- **Q: Why did the script not rename any plates in my wall?**\n  A: Ensure that the selected wall elements actually have beams intersecting them perpendicularly. If there are no intersecting binders/joists, or if they do not physically cross the top plate, the script will not make any changes.\n- **Q: Does this script create new beams?**\n  A: No, this script only modifies the properties (Name and Type) of existing beams within the selected elements."
      },
      "tokens_used": 2859,
      "error": null
    }
  }
}