{
  "filename": "hsb_CreateAdditionalSillPlates.mcr",
  "status": "completed",
  "total_tokens": 26604,
  "processing_time": 195.58068013191223,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2797,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select ElementWallSF objects and iterates through Element.beam() collections. It performs 3D coordinate calculations (CoordSys, Vector3d) and modifies the model by copying beams (dbCopy) and stretching jacks. No ShopDrawing (sd_*) or Viewport logic is present."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D) with Wall Elements containing openings",
          "requiredSettings": []
        }
      },
      "tokens_used": 3550,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select one or More Elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nNumberOfSills",
            "type": "PropInt",
            "displayName": "Number of sills to create",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5217,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Adds extra sill plates beneath existing window or door sills to fill vertical space and adjusts jack studs accordingly.",
          "category": "Framing",
          "typicalUseCase": "Increasing the height of an opening sill assembly (e.g., stacking 2x4s or 2x6s) when a standard single sill is insufficient, or to match specific structural requirements."
        },
        "parameters": [
          {
            "name": "nNumberOfSills",
            "technicalDefault": "1",
            "businessMeaning": "The number of additional sill plates to stack vertically beneath the current bottom-most sill of each opening.",
            "validRange": "1 to 5 (practical limit depends on the gap between the existing sill and the bottom plate)",
            "unit": "count",
            "affectsOutput": "Creates that many copies of the bottom sill, stacking them downwards. If space is insufficient, no action is taken for that opening. Jack studs are stretched to the new lowest sill or erased if space runs out."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "New timber sill plates generated by copying the existing bottom-most sill.",
            "appliedTo": "Wall openings (ElementWallSF) where sufficient vertical space exists between the sill and bottom plate."
          }
        ]
      },
      "tokens_used": 4434,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script launches: Checks for re-insertion cycles (erases if duplicate).\",\n    \"2. Dialog Phase: Displays a dialog allowing the user to set 'Number of sills to create' (nNumberOfSills).\",\n    \"3. Selection Phase: Prompts user to 'Select one or More Elements' (ElementWallSF).\",\n    \"4. Execution Phase: Iterates through each selected Wall Element.\",\n    \"5. Geometry Analysis: For each wall, iterates through all openings. Calculates center, left, and right points of each opening.\",\n    \"6. Beam Identification: Scans all beams in the wall to identify Sills, Bottom Plates, and Jacks associated with the current opening.\",\n    \"7. Sorting: Sorts Sills and Bottom Plates vertically to find the lowest existing Sill and the highest Bottom Plate.\",\n    \"8. Validation (Opening): Checks if valid Sills and Bottom Plates exist for the opening.\",\n    \"9. Validation (Space): Calculates the vertical gap between the lowest Sill and the Bottom Plate. Checks if the gap is large enough to fit the requested number of new sills.\",\n    \"10. Modification (Sills): Copies the bottom-most sill 'n' times and moves the copies downwards to fill the gap.\",\n    \"11. Modification (Jacks): Stretches the Jack studs down to the new lowest sill.\",\n    \"12. Cleanup: The script instance erases itself from the model (Run-once behavior).\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"User Selection Input\",\n      \"path1\": {\n        \"name\": \"Selection Successful\",\n        \"steps\": [\n          \"Elements added to processing list\",\n          \"Proceed to Wall Iteration loop\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Selection Cancelled / Empty\",\n        \"steps\": [\n          \"Check if _Element list is empty\",\n          \"Erase script instance\",\n          \"Exit workflow\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Opening Components Found\",\n      \"path1\": {\n        \"name\": \"Sills and Plates Present\",\n        \"steps"
      },
      "tokens_used": 6837,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_CreateAdditionalSillPlates.mcr\n\n## Overview\nThis script adds extra sill plates beneath existing window or door sills in timber frame walls. It automatically adjusts the height of jack studs to accommodate the new stack of sills.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates in the 3D model environment. |\n| Paper Space | No | Not applicable for layouts. |\n| Shop Drawing | No | This script modifies the physical model, not drawing views. |\n\n## Prerequisites\n- **Required Entities**: Wall Elements (ElementWallSF) containing openings (windows/doors) with existing sill and bottom plate structures.\n- **Minimum Beam Count**: 0 (The script scans existing elements).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_CreateAdditionalSillPlates.mcr`\n\n### Step 2: Configure Properties (Optional)\nAction: Before selecting elements, you can adjust the \"Number of sills to create\" in the Properties Palette (usually accessed by pressing `Ctrl`+`1` if the script is active).\n\n### Step 3: Select Wall Elements\n```\nCommand Line: Select one or More Elements\nAction: Click on the Wall Elements containing the openings you wish to modify. Press Enter to confirm selection.\n```\n\n### Step 4: Processing\nAction: The script automatically analyzes the selected walls, identifies openings with sufficient vertical space, copies the bottom sill, stacks the new sills downwards, and stretches the jack studs to reach the new height. The script instance will then remove itself from the model.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Number of sills to create | number | 1 | Enter the quantity of additional sill plates to stack vertically beneath the existing bottom sill. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script runs immediately upon insertion and selection; there are no custom right-click context menu options. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Space Check**: The script checks the vertical gap between the existing sill and the bottom plate. If the gap is too small for the requested number of sills, no changes will be made to that specific opening.\n- **Jack Studs**: You do not need to manually trim the jack studs; the script automatically stretches them down to the bottom of the new sill stack.\n- **Run-Once**: This script is designed to run once and then deletes itself from the project tree to avoid clutter.\n\n## FAQ\n- **Q: Why didn't the script add sills to my opening?**\n  **A:** The vertical distance between your current sill and the bottom plate might be too small to fit the requested number of additional sills. Try reducing the \"Number of sills to create\" property.\n- **Q: Does this work on all wall types?**\n  **A:** This script is designed specifically for ElementWallSF (Stick Frame) entities that contain generated beams.\n- **Q: What happens to the original sill?**\n  **A:** The original sill remains in place. The script copies it and places the new copies underneath it."
      },
      "tokens_used": 3769,
      "error": null
    }
  }
}