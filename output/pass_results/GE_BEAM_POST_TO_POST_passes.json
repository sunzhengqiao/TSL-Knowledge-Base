{
  "filename": "GE_BEAM_POST_TO_POST.mcr",
  "status": "completed",
  "total_tokens": 43864,
  "processing_time": 388.205114364624,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.3",
            "date": "03.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Stickframe path added to mapIn when calling dll"
          },
          {
            "version": "1.2",
            "date": "15.may.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail added\nDescription added"
          },
          {
            "version": "1.1",
            "date": "25.jan.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Updated grade and material info from inventory\nAdded some beam props to manual definition."
          },
          {
            "version": "1.0",
            "date": "24.jul.2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7947,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates physical beams using Beam.dbCreate() and interacts with existing beams via getBeam() which are operations in Model Space. No usage of 'sd_' prefixes, Viewport entities, or ShopDrawing specific types."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "The script requires selecting two vertical posts (GenBeams) during insertion to define the placement location.",
          "requiredSettings": [
            "\\Utilities\\hsbFramingDefaultsEditor\\hsbFramingDefaults.Inventory.dll"
          ]
        }
      },
      "tokens_used": 4808,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 9193,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 8773,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Initialization: Load Lumber Inventory items from hsbFramingDefaults.Inventory.dll\",\n    \"2. Define Properties: Set up OPM fields for beam count, distribution, sizing, and material info\",\n    \"3. Insert Cycle: Check if insertCycleCount > 1 (erase if true to prevent loops)\",\n    \"4. User Input: Prompt 'Select first post'\",\n    \"5. User Input: Prompt 'Select another post'\",\n    \"6. Validation: Check if first post is vertical (vecX parallel to ZW)\",\n    \"7. Validation: Check if second post is vertical\",\n    \"8. Validation: Check if posts are top-aligned (same Z height)\",\n    \"9. Interaction: Show Dialog to accept or modify properties\",\n    \"10. Data Processing: Retrieve dimensions/material from Inventory or Manual overrides\",\n    \"11. Validation: Check if calculated dimensions are valid (non-zero)\",\n    \"12. Geometry Calculation: Determine coordinate system based on posts\",\n    \"13. Validation: Check if selected number of beams fit on the post width (with tolerance)\",\n    \"14. Geometry Branch: Calculate beam positions based on 'Distribution' setting (Left/Center/Right)\",\n    \"15. Execution: Create new GenBeams using dbCreate\",\n    \"16. Processing: Apply static cut tool based on second post location\",\n    \"17. Assignment: Apply material, grade, color, and naming to new beams\",\n    \"18. Termination: Erase script instance (leaving only the new beams)\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Source of Beam Dimensions (sSizeOPM)\",\n      \"path1\": {\n        \"name\": \"From Inventory\",\n        \"steps\": [\n          \"Lookup Width, Height, Material, Grade using the selected Lumber Item Key\",\n          \"Override Material/Grade if Manual OPM fields are populated\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Manual Selection\",\n        \"steps\": [\n          \"Set Width to fixed value 38.1mm (1.5 inches)\",\n          \"Set Height based on the selected nominal size (e.g., 2x4, 2x6)\",\n          \"Use Material/Grade strictly from Manual OPM fields\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Distribution Strategy (nDistribution)\",\n      \"path1\": {\n        \"name\": \"Left to Right (0)\",\n        \"steps\": [\n          \"Start at the 'left' edge of the post profile\",\n          \"Stack beams sequentially towards the 'right'\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Centered (1)\",\n        \"steps\": [\n          \"Calculate center point of post area\",\n          \"Place beams alternating outward from the center (Left/Right/Left...)\"\n        ]\n      },\n      \"path3\": {\n        \"name\": \"Right to Left (2)\",\n        \"steps\": [\n          \"Start at the 'right' edge of the post profile\",\n          \"Stack beams sequentially towards the 'left'\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Fit Check Validation\",\n      \"path1\": {\n"
      },
      "tokens_used": 8745,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_POST_TO_POST.mcr\n\n## Overview\nThis script automatically generates filler beams (studs or blocking) between two selected vertical posts. It allows for manual or inventory-based sizing and offers options for beam distribution across the post width.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment for generating beams. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | This is a modeling script, not a detailing tool. |\n\n## Prerequisites\n- **Required Entities**: Two existing `GenBeam` entities representing vertical posts.\n- **Minimum Beam Count**: 2 existing beams must be selected during insertion.\n- **Required Settings**:\n    - `hsbFramingDefaults.Inventory.dll`: Used to retrieve material grades and standard lumber sizes.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_BEAM_POST_TO_POST.mcr` from the list.\n\n### Step 2: Select First Post\n```\nCommand Line: Select first post\nAction: Click on the first vertical GenBeam (post) you wish to span between.\n```\n\n### Step 3: Select Second Post\n```\nCommand Line: Select another post\nAction: Click on the second vertical GenBeam.\n```\n\n### Step 4: Configure Properties\n```\nAction: The Dynamic Dialog appears automatically. Adjust the number of beams, size source, and distribution pattern as needed. Click OK to generate.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Distribution | Integer | 0 | Determines how beams are arranged: 0=Left to Right, 1=Centered, 2=Right to Left. |\n| Beam Count | Integer | 1 | The number of filler beams to generate between the posts. |\n| Size Source | String | Inventory | Choose between \"Inventory\" (uses dll defaults) or \"Manual\" (uses custom properties). |\n| Manual Size | String | 2x4 | Nominal size (e.g., 2x6, 2x8) used only if Size Source is set to Manual. |\n| Material | String | - | The material name. Can be pulled from Inventory or entered manually. |\n| Grade | String | - | The structural grade of the lumber. Can be pulled from Inventory or entered manually. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This is a \"Generator\" script. It runs once, creates the beams, and then erases itself from the drawing. It does not remain for context menu editing. |\n\n## Settings Files\n- **DLL**: `hsbFramingDefaults.Inventory.dll`\n- **Location**: hsbCAD installation directory (typically mapped in `TSL.INI`).\n- **Purpose**: Provides default dimensions, material names, and grade information based on the selected lumber item key.\n\n## Tips\n- **Post Alignment**: Ensure the two selected posts are vertical and have their top surfaces at the same Z-height. The script validates this and may fail if they are misaligned.\n- **Fit Check**: The script calculates if the selected number of beams will physically fit on the width of the post. If the total width of the new beams exceeds the post width (plus a small tolerance), generation may fail.\n- **Centered Distribution**: Use the \"Centered\" (1) distribution option for symmetrical layouts like window sills or headers between posts.\n\n## FAQ\n- Q: Why did the script disappear immediately after I ran it?\n- A: This is normal behavior for generator scripts. Once the beams are created and added to the model, the script instance removes itself to prevent duplicate data.\n- Q: Can I edit the beams after creation?\n- A: Yes. You can select the newly generated GenBeams and modify their properties using the standard AutoCAD Properties Palette (OPM) or other hsbCAD editing tools."
      },
      "tokens_used": 4398,
      "error": null
    }
  }
}