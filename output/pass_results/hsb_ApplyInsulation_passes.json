{
  "filename": "hsb_ApplyInsulation.mcr",
  "status": "completed",
  "total_tokens": 60671,
  "processing_time": 286.0675868988037,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9235,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Element objects (3D model entities), creates 3D Sheet entities using Sheet.dbCreate(), assigns geometry to Element Groups using assignToElementGroup(), and uses Element.beams() to calculate geometry. No usage of _Viewport, sd_ prefixes, or ShopDrawing specific APIs."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 7056,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Insertion",
            "title": "hsb_ApplyInsulation Properties",
            "dataSource": "showDialogOnce()",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "pnZoneToInsulate",
            "type": "PropInt",
            "displayName": "Insulate zone",
            "defaultValue": "0",
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10"
            ],
            "category": "Zone to insulate",
            "description": null
          },
          {
            "index": 1,
            "variable": "pnZoneToAssign",
            "type": "PropInt",
            "displayName": "Attach Insulation to Zone",
            "defaultValue": "10",
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "-1",
              "-2",
              "-3",
              "-4",
              "-5"
            ],
            "category": "Zone to insulate",
            "description": null
          },
          {
            "index": 0,
            "variable": "sName1",
            "type": "PropString",
            "displayName": "Insulation Name",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Main Insulation",
            "description": null
          },
          {
            "index": 1,
            "variable": "sMaterial1",
            "type": "PropString",
            "displayName": "Insulation Material",
            "defaultValue": "Insulation",
            "inputType": "text",
            "options": [],
            "category": "Main Insulation",
            "description": null
          },
          {
            "index": 0,
            "variable": "dThick1",
            "type": "PropDouble",
            "displayName": "Insulation Thickness",
            "defaultValue": "89",
            "inputType": "number",
            "options": [],
            "category": "Main Insulation",
            "description": null
          },
          {
            "index": 1,
            "variable": "dStockWidth1",
            "type": "PropDouble",
            "displayName": "Insulation Width",
            "defaultValue": "1200",
            "inputType": "number",
            "options": [],
            "category": "Main Insulation",
            "description": null
          },
          {
            "index": 2,
            "variable": "dStockHeight1",
            "type": "PropDouble",
            "displayName": "Insulation Height",
            "defaultValue": "8000",
            "inputType": "number",
            "options": [],
            "category": "Main Insulation",
            "description": null
          },
          {
            "index": 2,
            "variable": "sName2",
            "type": "PropString",
            "displayName": "Insulation Name",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Secondary Insulation (Thinner Insulation)",
            "description": null
          },
          {
            "index": 3,
            "variable": "sMaterial2",
            "type": "PropString",
            "displayName": "Insulation Material",
            "defaultValue": "Insulation",
            "inputType": "text",
            "options": [],
            "category": "Secondary Insulation (Thinner Insulation)",
            "description": null
          },
          {
            "index": 3,
            "variable": "dThick2",
            "type": "PropDouble",
            "displayName": "Insulation Thickness for Connections",
            "defaultValue": "60",
            "inputType": "number",
            "options": [],
            "category": "Secondary Insulation (Thinner Insulation)",
            "description": null
          },
          {
            "index": 4,
            "variable": "dStockWidth2",
            "type": "PropDouble",
            "displayName": "Insulation Width",
            "defaultValue": "1200",
            "inputType": "number",
            "options": [],
            "category": "Secondary Insulation (Thinner Insulation)",
            "description": null
          },
          {
            "index": 5,
            "variable": "dStockHeight2",
            "type": "PropDouble",
            "displayName": "Insulation Height",
            "defaultValue": "8000",
            "inputType": "number",
            "options": [],
            "category": "Secondary Insulation (Thinner Insulation)",
            "description": null
          },
          {
            "index": 6,
            "variable": "dWDecrease",
            "type": "PropDouble",
            "displayName": "Tolerance width",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "Decrease overall width of all insulation sheets"
          },
          {
            "index": 7,
            "variable": "dHDecrease",
            "type": "PropDouble",
            "displayName": "Tolerance height",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "Decrease overall height of all insulation sheets"
          },
          {
            "index": 8,
            "variable": "dMinWidth",
            "type": "PropDouble",
            "displayName": "Minimal width/height",
            "defaultValue": "20",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "Any Insulation Sheet smaler that this value wont be created"
          },
          {
            "index": 9,
            "variable": "dMinThickness",
            "type": "PropDouble",
            "displayName": "Minimal Thickness",
            "defaultValue": "20",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "Any Insulation Sheet smaler that this value wont be created"
          },
          {
            "index": 11,
            "variable": "dMaxInsulationHeight",
            "type": "PropDouble",
            "displayName": "Max Insulation Height",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "If the value is set to 0 then it will go full height"
          },
          {
            "index": 4,
            "variable": "sExternalWalls",
            "type": "PropString",
            "displayName": "Fillter by Wall Code",
            "defaultValue": "EA;EB;",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please set the wall codes that you want to Insulate, use ; to insert more than one code"
          },
          {
            "index": 5,
            "variable": "sDisplay",
            "type": "PropString",
            "displayName": "Display Hatch Pattern",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Display",
            "description": null
          },
          {
            "index": 6,
            "variable": "pHatchPattern",
            "type": "PropString",
            "displayName": "Hatch Pattern",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "Display",
            "description": null
          },
          {
            "index": 10,
            "variable": "dHatchScale",
            "type": "PropDouble",
            "displayName": "Hatch Scale",
            "defaultValue": "7.5",
            "inputType": "number",
            "options": [],
            "category": "Display",
            "description": null
          },
          {
            "index": 2,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Hatch Color",
            "defaultValue": "51",
            "inputType": "number",
            "options": [],
            "category": "Display",
            "description": null
          },
          {
            "index": 7,
            "variable": "sDispRep",
            "type": "PropString",
            "displayName": "|Show Only In Disp Rep Name|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Display",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9843,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically generates and inserts 3D insulation sheets (batts) into timber wall elements based on cavity sizes, with options for primary and secondary insulation thicknesses, tolerances, and hatch visualization.\",\n    \"category\": \"Finishing/Insulation\",\n    \"typicalUseCase\": \"Used to fill wall cavities with insulation material during the detailing phase, ensuring accurate material takeoffs and avoiding clashes with framing.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"pnZoneToInsulate\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Identifies the specific construction layer or zone in the wall where the insulation should be physically located and fitted.\",\n      \"validRange\": \"0-10\",\n      \"unit\": \"Zone Index\",\n      \"affectsOutput\": \"Determines the depth within the wall assembly where the script calculates voids to fill.\"\n    },\n    {\n      \"name\": \"pnZoneToAssign\",\n      \"technicalDefault\": \"10\",\n      \"businessMeaning\": \"Sets the logical Element Group zone to which the generated insulation sheets are assigned for reporting and layer management.\",\n      \"validRange\": \"0-10 (mapped to -5 to 5)\",\n      \"unit\": \"Zone Index\",\n      \"affectsOutput\": \"Controls the organizational grouping and potential layering of the created Sheet objects.\"\n    },\n    {\n      \"name\": \"sName1\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The commercial product name or code for the main insulation material (e.g., specific brand or type).\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Labels the generated sheets for BOMs and schedules.\"\n    },\n    {\n      \"name\": \"sMaterial1\",\n      \"technicalDefault\": \"Insulation\",\n      \"businessMeaning\": \"The generic material classification assigned to the main insulation sheets.\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Affects rendering properties and material reports.\"\n    },\n    {\n      \"name\": \"dThick1\",\n      \"technicalDefault\": \"89\",\n      \"businessMeaning\": \"The thickness of the main insulation batts to be fitted into the wall cavities.\",\n      \"validRange\": \"40 - 300\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Determines the Z-depth (width of the wall) of the generated 3D sheets.\"\n    },\n    {\n      \"name\": \"dStockWidth1\",\n      \"technicalDefault\": \"1200\",\n      \"businessMeaning\": \"The standard manufactured width of the main insulation stock (used for optimization/calculation).\",\n      \"validRange\": \"400 - 1200\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Used for material calculation and optimization logic.\"\n    },\n    {\n      \"name\": \"dStockHeight1\",\n      \"technicalDefault\": \"8000\",\n      \"businessMeaning\": \"The standard manufactured length of the main insulation stock.\",\n      \"validRange\": \"2000 - 12000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Used for material calculation and takeoff.\"\n    },\n    {\n      \"name\": \"sName2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The commercial product name for the secondary/thinner insulation used at connections.\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Labels secondary sheets separately for BOMs.\"\n    },\n    {\n      \"name\": \"sMaterial2\",\n      \"technicalDefault\": \"Insulation\",\n      \"businessMeaning\": \"The generic material classification for the secondary insulation.\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Affects rendering properties of secondary sheets.\"\n    },\n    {\n      \"name\": \"dThick2\",\n      \"technicalDefault\": \"60\",\n      \"businessMeaning\": \"The thickness of the thinner insulation used specifically for connection areas where full depth is not possible.\",\n      \"validRange\": \"20 - 150\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Determines the depth of insulation in complex connection zones.\"\n    },\n    {\n      \"name\": \"dStockWidth2\",\n      \"technicalDefault\": \"1200\",\n      \"businessMeaning\": \"The standard width of the secondary insulation stock.\",\n      \"validRange\": \"400 - 1200\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Used for material calculation.\"\n    },\n    {\n      \"name\": \"dStockHeight2\",\n      \"technicalDefault\": \"8000\",\n      \"businessMeaning\": \"The standard length of the secondary insulation stock.\",\n      \"validRange\": \"2000 - 12000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Used for material calculation.\"\n    },\n    {\n      \"name\": \"dWDecrease\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Global tolerance to reduce the width of generated sheets, ensuring a friction fit or accounting for swelling.\",\n      \"validRange\": \"0 - 10\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Reduces the horizontal dimension of all generated sheets.\"\n    },\n    {\n      \"name\": \"dHDecrease\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Global tolerance to reduce the height of generated sheets.\",\n      \"validRange\": \"0 - 10\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Reduces the vertical dimension of all generated sheets.\"\n    },\n    {\n      \"name\": \"dMinWidth\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"The minimum size threshold; gaps smaller than this will be left uninsulated.\",\n      \"validRange\": \"10 - 100\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Filters out small slivers of insulation that are impractical to install.\"\n    },\n    {\n      \"name\": \"dMinThickness\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Minimum valid thickness for an insulation sheet.\",\n      \"validRange\": \"10 - 50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Prevents creation of sheets where clearance is too low.\"\n    },\n    {\n      \"name\": \"dMaxInsulationHeight\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Limits the height of generated sheets (0 = full available height).\",\n      \"validRange\": \"0 - 3000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Truncates the vertical length of insulation if set > 0.\"\n    },\n    {\n      \"name\": \"sExternalWalls\",\n      \"technicalDefault\": \"EA;EB;\",\n      \"businessMeaning\": \"Filter to select specific wall types (by Wall Code) to process.\",\n      \"validRange\": \"Semicolon-separated codes\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Restricts insulation generation to walls matching the codes.\"\n    },\n    {\n      \"name\": \"sDisplay\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the visibility of the 2D hatch pattern in drawings.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Enables or disables the hatch graphic in plan views.\"\n    },\n    {\n      \"name\": \"pHatchPattern\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The visual style of the insulation pattern (e.g., ANSI31).\",\n      \"validRange\": \"CAD Pattern Names\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Changes the visual appearance of the hatch.\"\n    },\n    {\n      \"name\": \"dHatchScale\",\n      \"technicalDefault\": \"7.5\",\n      \"businessMeaning\": \"Controls the density/size of the hatch pattern.\",\n      \"validRange\": \"1 - 100\",\n      \"unit\": \"Scale\",\n      \"affectsOutput\": \"Scales the hatch pattern up or down.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": \"51\",\n      \"businessMeaning\": \"The color of the insulation bodies and hatch.\",\n      \"validRange\": \"0-255\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Visual color of the generated entities.\"\n    },\n    {\n      \"name\": \"sDispRep\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Limits hatch visibility"
      },
      "tokens_used": 11520,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User executes script 'hsb_ApplyInsulation'",
          "2. Script checks execution context (Insertion vs Recalculation)",
          "3. [Insertion Phase] If _kExecuteKey is empty, 'ShowDynamicDialog' appears for configuration",
          "4. Command prompt displays: 'Select a set of elements'",
          "5. User selects one or more Element entities (e.g., Timber Walls)",
          "6. Script parses Wall Code filter string from properties",
          "7. Script creates a temporary instance of itself attached to each selected Element",
          "8. Original 'Insertion' instance is erased (self-destructs after spawning children)",
          "9. [Calculation Phase - runs on each attached instance]",
          "10. Script iterates through all beams within the Element",
          "11. Filters beams based on 'Fillter by Wall Code' and Zone location",
          "12. Extracts beam profiles in the insulation plane and calculates total void space",
          "13. Applies width and height tolerances (shrinks profiles)",
          "14. Iterates through calculated void areas (rings)",
          "15. Checks if void area dimensions exceed 'Minimal width/height'",
          "16. [Conditional] Creates 3D Sheet entity if valid",
          "17. Applies Material, Name, and Color properties to the Sheet",
          "18. Assigns Sheet to Element Group (Zone)",
          "19. Applies Hatch pattern to Sheet if 'Display Hatch Pattern' is Yes",
          "20. Script assigns itself to Element Group and finishes"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase current instance immediately",
                "Return to prevent infinite loops"
              ]
            },
            "path2": {
              "name": "Cycle == 1",
              "steps": [
                "Proceed with Selection and Spawning logic"
              ]
            }
          },
          {
            "condition": "Execution Key (Catalog/ToolPalette usage)",
            "path1": {
              "name": "Key is Empty",
              "steps": [
                "Show 'hsb_ApplyInsulation Properties' dialog",
                "Wait for user input"
              ]
            },
            "path2": {
              "name": "Key is Present",
              "steps": [
                "Skip dialog",
                "Use properties loaded from catalog/toolpalette"
              ]
            }
          },
          {
            "condition": "Wall Code Filter",
            "path1": {
              "name": "Code matches Filter",
              "steps": [
                "Include beam in void calculation logic"
              ]
            },
            "path2": {
              "name": "Code does not match",
              "steps": [
                "Ignore beam (treated as solid/void boundary or ignored depending on zone logic)"
              ]
            }
          },
          {
            "condition": "Insulation Zone Selection",
            "path1": {
              "name": "Zone 0 selected",
              "steps": [
                "Calculate standard voids",
                "Transform final Sheet geometry by -vz * dZ (shift to front)"
              ]
            },
            "path2": {
              "name": "Other Zone selected",
              "steps": [
                "Calculate voids in that specific Z-depth",
                "No Z-transform applied"
              ]
            }
          },
          {
            "condition": "Size Validation (Min Width/Height)",
            "path1": {
              "name": "Dimensions > dMinWidth",
              "steps": [
                "Proceed to create Sheet object",
                "Draw Hatch if enabled"
              ]
            },
            "path2": {
              "name": "Dimensions <= dMinWidth",
              "steps": [
                "Skip creation (slivers ignored)"
              ]
            }
          },
          {
            "condition": "Display Hatch Pattern Property",
            "path1": {
              "name": "sDisplay == Yes",
              "steps": [
                "Generate Display object",
                "Draw Hatch pattern on Sheet profile"
              ]
            },
            "path2": {
              "name": "sDisplay == No",
              "steps": [
                "Skip Hatch generation"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection",
            "errorMessage": "None (Implicit)",
            "recovery": "User must select valid Elements when prompted 'Select a set of elements'. If nothing is selected, the script ends gracefully or performs no action."
          },
          {
            "check": "Minimum Dimensions",
            "errorMessage": "None (Silent Filter)",
            "recovery": "Calculated voids smaller than 'Minimal width/height' or 'Minimal Thickness' are automatically skipped. User can lower these property values to capture smaller pieces."
          },
          {
            "check": "Wall Code Match",
            "errorMessage": "None (Silent Filter)",
            "recovery": "If no insulation appears, check if the Element's Wall Code exists in the 'Fillter by Wall Code' property list."
          },
          {
            "check": "Insertion Loop Protection",
            "errorMessage": "None (System Handled)",
            "recovery": "Script detects `insertCycleCount() > 1` and self-erases to prevent corruption."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Insulation Parameters",
            "how": "OPM (AutoCAD Properties Palette)",
            "effect": "Changing properties (e.g., Thickness, Material, Color) triggers a recalculation. Sheets are deleted and regenerated with new parameters."
          },
          {
            "action": "Toggle Visuals",
            "how": "OPM - Change 'Display Hatch Pattern' or 'Hatch Color'",
            "effect": "Immediately updates the 2D hatch representation without necessarily regenerating geometry (depending on internal implementation of Display)."
          },
          {
            "action": "Adjust Tolerances",
            "how": "OPM - Change 'Tolerance width' or 'Tolerance height'",
            "effect": "Regenerates sheets with expanded or contracted dimensions relative to the beam voids."
          },
          {
            "action": "Delete Insulation",
            "how": "Select Element and erase the TSL instance or use 'Erase' command on generated sheets (if not mapped to auto-delete, though script sets 'Erase' map key suggesting it manages its own sheets).",
            "effect": "Removes the generated Sheet entities from the model."
          }
        ]
      },
      "tokens_used": 13359,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ApplyInsulation.mcr\n\n## Overview\nThis script automatically generates and inserts 3D insulation sheets (batts) into selected timber wall elements based on calculated cavity sizes. It allows users to define primary and secondary insulation layers, apply tolerances for friction fitting, and configure visual hatch patterns for drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D Element entities (e.g., Timber Walls). |\n| Paper Space | No | Not designed for 2D layout or detailing views. |\n| Shop Drawing | No | Not a shop drawing script. |\n\n## Prerequisites\n- **Required Entities**: Timber Wall Elements (or other Elements containing beams).\n- **Minimum Beam Count**: 1 (The script processes beams within the selected Element).\n- **Required Settings**: None (uses standard script properties).\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT` â†’ Select `hsb_ApplyInsulation.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the timber wall elements you wish to insulate. Press Enter to confirm selection.\n```\n*Note: Once selected, the script attaches itself to these elements and begins calculation. The original insertion instance is removed.*\n\n### Step 3: Configure Properties (Optional)\nIf not launched from a pre-configured catalog, a properties dialog may appear upon insertion. Alternatively, select the generated script instance (or the parent element) and modify parameters in the **Properties Palette**.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Zone to insulate** | dropdown | 0 | Identifies the specific construction layer or zone in the wall where the insulation should be physically located (0-10). |\n| **Attach Insulation to Zone** | dropdown | 10 | Sets the logical Element Group zone to which the generated insulation sheets are assigned for reporting. |\n| **Insulation Name (Main)** | text | | Commercial product name for the main insulation used in BOMs/schedules. |\n| **Insulation Material (Main)** | text | Insulation | Generic material classification for the main insulation sheets. |\n| **Insulation Thickness (Main)** | number | 89 | Thickness of the main insulation batts to be fitted into the wall cavities (mm). |\n| **Insulation Width (Main)** | number | 1200 | Standard manufactured width of the main insulation stock (mm). |\n| **Insulation Height (Main)** | number | 8000 | Standard manufactured length of the main insulation stock (mm). |\n| **Insulation Name (Secondary)** | text | | Product name for thinner insulation used at connections. |\n| **Insulation Material (Secondary)** | text | Insulation | Material classification for the secondary insulation. |\n| **Insulation Thickness (Secondary)** | number | 60 | Thickness of insulation used specifically for connection areas where full depth is not possible (mm). |\n| **Insulation Width (Secondary)** | number | 1200 | Standard width of the secondary insulation stock (mm). |\n| **Insulation Height (Secondary)** | number | 8000 | Standard length of the secondary insulation stock (mm). |\n| **Tolerance width** | number | 0 | Global reduction in sheet width to ensure a friction fit or account for swelling (mm). |\n| **Tolerance height** | number | 0 | Global reduction in sheet height (mm). |\n| **Minimal width/height** | number | 20 | Gaps smaller than this value will be left uninsulated (filters out slivers) (mm). |\n| **Minimal Thickness** | number | 20 | Minimum valid thickness; sheets thinner than this will not be created (mm). |\n| **Max Insulation Height** | number | 0 | Limits the height of generated sheets. Set to 0 to allow full available height. |\n| **Fillter by Wall Code** | text | EA;EB; | Filters which wall types to process. Enter wall codes separated by a semicolon (;). |\n| **Display Hatch Pattern** | dropdown | Yes | Toggles the visibility of the 2D hatch pattern in drawings. |\n| **Hatch Pattern** | dropdown | | The visual style of the insulation pattern (e.g., ANSI31). |\n| **Hatch Scale** | number | 7.5 | Controls the density/size of the hatch pattern. |\n| **Hatch Color** | number | 51 | The color index of the insulation bodies and hatch. |\n| **\\|Show Only In Disp Rep Name\\|** | text | | Limits hatch visibility to specific display representations. |\n\n## Right-Click Menu Options\nThis script does not add specific custom items to the right-click context menu. All modifications are handled via the Properties Palette (OPM).\n\n## Settings Files\n- **Filename**: None detected.\n- **Location**: N/A\n- **Purpose**: N/A (Script uses standard properties).\n\n## Tips\n- **Filtering Walls**: If insulation is not appearing in specific walls, check the `Fillter by Wall Code` property. Ensure the wall codes in the model (e.g., \"EA\") match the list in the properties (e.g., \"EA;EB;\").\n- **Updating Geometry**: To change insulation thickness or size, select the script instance in the model, change the values in the Properties Palette, and the sheets will automatically recalculate.\n- **Tolerances**: Use the `Tolerance width` and `Tolerance height` settings (e.g., 2-5mm) to ensure insulation batts do not overlap or clash with adjacent timbers due to manufacturing variances.\n- **Small Gaps**: If you see small uninsulated gaps that you want filled, lower the `Minimal width/height` value. If you see many tiny slivers cluttering the model, increase this value.\n\n## FAQ\n- **Q: Why are some walls not getting insulation?**\n  **A:** Check the `Fillter by Wall Code` property. The script only processes walls whose codes match the list provided in this property (e.g., \"EA;EB;\").\n\n- **Q: The insulation is too tight/clashing with studs. How can I fix this?**\n  **A:** Increase the `Tolerance width` or `Tolerance height` values slightly. This will shrink the calculated insulation sheets.\n\n- **Q: How can I see the insulation in a specific view only?**\n  **A:** Use the `|Show Only In Disp Rep Name|` property. Enter the name of the Display Representation (e.g., \"Presentation\") to limit the hatch visibility to that view style."
      },
      "tokens_used": 9658,
      "error": null
    }
  }
}