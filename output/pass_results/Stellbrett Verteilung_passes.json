{
  "filename": "Stellbrett Verteilung.mcr",
  "status": "completed",
  "total_tokens": 51758,
  "processing_time": 263.96461248397827,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6090,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getBeam, getPoint, and interactively selects entities like ERoofPlane and Walls/Polylines in the drawing. It creates GenBeam entities and Body geometry. No ShopDrawing specific commands (sd_*), #Type E annotations, or _Viewport usage detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "ERoofPlane",
            "GenBeam (Rafter)",
            "Element (Wall) or PLine (if Mode = Wall or Polyline)",
            "GenBeam (Plate) (if Mode = Plate)"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Requires a 3D Model environment containing Roof Planes and structural Beams (Rafters).",
          "requiredSettings": []
        }
      },
      "tokens_used": 5146,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getERoofPlane\",\n        \"promptOriginal\": \"select roofplane\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"select rafter(s)\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 4,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"select wall  or polyline\",\n        \"condition\": \"_bOnInsert && sMode == 'Wall or Polyline'\",\n        \"required\": true\n      },\n      {\n        \"step\": 5,\n        \"function\": \"getBeam\",\n        \"promptOriginal\": \"select plate\",\n        \"condition\": \"_bOnInsert && sMode == 'Plate'\",\n        \"required\": true\n      },\n      {\n        \"step\": 6,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Point\",\n        \"condition\": \"_bOnInsert && sMode == 'Point'\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"dWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Thickness\",\n      \"defaultValue\": \"U(19)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dDepth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Depth of groove\",\n      \"defaultValue\": \"U(4)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dGapAtSide\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Gap at side\",\n      \"defaultValue\": \"U(1)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dGapLength\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Gap in length\",\n      \"defaultValue\": \"U(1)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Offset\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dTrauf\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Thickness Traufschalung\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dBlockingHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Height of Blocking\",\n      \"defaultValue\": \"U(190)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"sMode\",\n      \"type\": \"Prop"
      },
      "tokens_used": 9465,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates 'Stellbrett' (blocking/nogging) between rafters or cuts grooves into them, positioned relative to a roof plane and a reference (wall, plate, or point).\",\n    \"category\": \"Framing\",\n    \"typicalUseCase\": \"Automating the insertion of solid blocking between rafters to support roofing/sheathing or creating dadoes in rafters to receive such blocking.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"dWidth\",\n      \"technicalDefault\": \"U(19)\",\n      \"businessMeaning\": \"Thickness of the blocking timber or the width of the groove cut into the rafters.\",\n      \"validRange\": \"10 - 100\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the X-axis dimension of the generated Body/Beam or the width of the machining cut.\"\n    },\n    {\n      \"name\": \"dDepth\",\n      \"technicalDefault\": \"U(4)\",\n      \"businessMeaning\": \"Depth of penetration for the groove cut into the rafter, or additional length added to the blocking piece.\",\n      \"validRange\": \"0 - 50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Increases the calculated length of the blocking/cut by 2 * dDepth, effectively extending the groove into the rafter sides.\"\n    },\n    {\n      \"name\": \"dGapAtSide\",\n      \"technicalDefault\": \"U(1)\",\n      \"businessMeaning\": \"Lateral gap/clearance between the blocking and the rafter faces.\",\n      \"validRange\": \"0 - 10\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Expands the tool width for cutting (dWidth + 2*dGapAtSide), ensuring clearance in the groove.\"\n    },\n    {\n      \"name\": \"dGapLength\",\n      \"technicalDefault\": \"U(1)\",\n      \"businessMeaning\": \"Longitudinal gap/clearance at the ends of the blocking between rafters.\",\n      \"validRange\": \"0 - 20\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Expands the tool length for cutting (dLength + 2*dGapLength), creating space at the ends of the groove.\"\n    },\n    {\n      \"name\": \"dOffset\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Displacement of the blocking along the roof slope axis from the reference point.\",\n      \"validRange\": \"-1000 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Shifts the insertion point up or down the roof, changing which rafters are intersected and the blocking position.\"\n    },\n    {\n      \"name\": \"dTrauf\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Thickness of the eaves/sheathing layer to account for in height calculations.\",\n      \"validRange\": \"0 - 100\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Reduces the effective blocking height by subtracting from the measured height to the roof plane.\"\n    },\n    {\n      \"name\": \"dBlockingHeight\",\n      \"technicalDefault\": \"U(190)\",\n      \"businessMeaning\": \"The vertical (or perpendicular) height of the blocking element.\",\n      \"validRange\": \"50 - 600\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Determines the Z-height of the generated geometry. Can also force recalculation of offset if 'Calculate height' is disabled.\"\n    },\n    {\n      \"name\": \"sMode\",\n      \"technicalDefault\": \"Wall or Polyline\",\n      \"businessMeaning\": \"Determines the method for defining the start position of the blocking run.\",\n      \"validRange\": \"Wall or Polyline | Plate | Point\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Changes the insertion logic to derive the origin point from a Wall/PLine boundary, a Plate beam center, or a specific 3D point.\"\n    },\n    {\n      \"name\": \"sCalcBlocking\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Toggle to automatically calculate blocking height based on geometry vs using a fixed value.\",\n      \"validRange\": \"No | Yes\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"If 'Yes', calculates height based on Roof Plane and Offset. If 'No', uses 'dBlockingHeight' and adjusts offset to match.\"\n    },\n    {\n      \"name\": \"sOrient\",\n      \"technicalDefault\": \"Perpendicular to RCS\",\n      \"businessMeaning\": \"Reference axis for the blocking height measurement (Roof Plane Normal vs World Vertical).\",\n      \"validRange\": \"Perpendicular to RCS | Perpendicular to WCS\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Switches math between normal-to-roof calculations (plumb to roof) and true vertical (plumb to world) height logic.\"\n    },\n    {\n      \"name\": \"sToBeams\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Specifies whether to generate physical structural beams or just cut grooves into existing rafters.\",\n      \"validRange\": \"No | Yes\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"If 'No', generates Bodies and adds Cuts to rafters. If 'Yes', creates new GenBeam entities and erases the script instance.\"\n    },\n    {\n      \"name\": \"sName\",\n      \"technicalDefault\": \"Stellbrett\",\n      \"businessMeaning\": \"Name property assigned to the generated beam entities.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Name' attribute in the resulting GenBeam properties.\"\n    },\n    {\n      \"name\": \"sMat\",\n      \"technicalDefault\": \"Dreischicht\",\n      \"businessMeaning\": \"Material specification for the blocking timber.\",\n      \"validRange\": \"String (Material List)\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Material' attribute for reporting and visualization.\"\n    },\n    {\n      \"name\": \"sGrade\",\n      \"technicalDefault\": \"BC\",\n      \"businessMeaning\": \"Timber grade/strength class.\",\n      \"validRange\": \"String (Grades)\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Grade' attribute.\"\n    },\n    {\n      \"name\": \"sInfo\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"User-defined information field.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Information' attribute.\"\n    },\n    {\n      \"name\": \"sLabel\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Label for grouping or identification.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Label' attribute.\"\n    },\n    {\n      \"name\": \"sSublabel\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Secondary label.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Sublabel' attribute.\"\n    },\n    {\n      \"name\": \"sSublabel2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Tertiary label.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Sets the 'Sublabel2' attribute.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": \"170\",\n      \"businessMeaning\": \"Display color index for the generated elements.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Changes the visual color of the generated Body or GenBeam.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sMode changes\",\n      \"effect\": \"Changes required user inputs during insertion. Restricts ability to switch modes after insertion (locked to 'Point' if changed).\",\n      \"cascade\": [\"Selection inputs (Wall/Plate/Point)\"]\n    },\n    {\n      \"trigger\": \"sO"
      },
      "tokens_used": 10063,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script / Insert Instance",
          "2. Open Properties Dialog (User configures Thickness, Depth, Gaps, Offset, Mode, etc.)",
          "3. Prompt User: Select Roof Plane (ERoofPlane)",
          "4. Prompt User: Select Rafters (GenBeam) - Loop allows multiple selections",
          "5. [Branch] Select Reference Object based on sMode property:",
          "   - Mode 'Wall or Polyline': Select Wall or Polyline (AcDbPolyline)",
          "   - Mode 'Plate': Select Plate Beam (GenBeam)",
          "   - Mode 'Point': Select 3D Point (getPoint)",
          "6. Store Insertion Data and exit Insert Mode (Script calculates geometry)",
          "7. Validate Links (Roof plane and Rafters must exist)",
          "8. Determine Reference Point (_Pt0) based on stored Mode and Geometry",
          "9. Calculate Blocking Height and Offset based on sOrient (WCS/RCS) and sCalcBlocking (Yes/No)",
          "10. Validate Dimensions (Height and Blocking Height must be > 0)",
          "11. Identify Intersecting Rafters (LineBeamIntersect) along the roof slope",
          "12. Sort Rafters spatially",
          "13. Loop through pairs of adjacent rafters",
          "14. [Conditional] Skip pair if rafters are touching or too close",
          "15. Calculate position and length for blocking between rafters",
          "16. [Branch] Generate Output:",
          "   - sToBeams='No': Create visual Body and add BeamCut (Groove) to rafters",
          "   - sToBeams='Yes': Create GenBeam entities, spawn new TSL instances, and erase original script"
        ],
        "conditionalBranches": [
          {
            "condition": "sMode (Reference Selection) during Insertion",
            "path1": {
              "name": "Wall or Polyline",
              "steps": [
                "Prompt for Wall or Polyline",
                "If Wall: Store in _Element",
                "If Polyline: Extract vertices, create PLine, store in _Map as 'insertPoly'"
              ]
            },
            "path2": {
              "name": "Plate",
              "steps": [
                "Prompt for Plate Beam",
                "Store in _Map as 'insertPlate' and append to _Beam collection"
              ]
            },
            "path3": {
              "name": "Point",
              "steps": [
                "Prompt for Point",
                "Store in _Pt0"
              ]
            }
          },
          {
            "condition": "sMode modification after Insertion",
            "path1": {
              "name": "Switch to Point",
              "steps": [
                "Allowed",
                "Mode switches to Point logic (uses _Pt0)"
              ]
            },
            "path2": {
              "name": "Switch to Wall/Plate",
              "steps": [
                "Blocked",
                "Report Error: 'after insertion the mode can only be changed to Point'",
                "Property reverts to original Mode"
              ]
            }
          },
          {
            "condition": "sOrient (Orientation) calculation",
            "path1": {
              "name": "Perpendicular to RCS (Roof)",
              "steps": [
                "Calculate height normal to roof plane",
                "If sCalcBlocking=Yes: Auto-calc height based on offset",
                "If sCalcBlocking=No: Adjust dOffset to match user-defined dBlockingHeight"
              ]
            },
            "path2": {
              "name": "Perpendicular to WCS (Vertical)",
              "steps": [
                "Calculate height using World Z axis",
                "Use Trigonometry (tan, cos) to account for roof slope",
                "Calculate RepositionOffset for visual placement"
              ]
            }
          },
          {
            "condition": "sToBeams (Output Generation)",
            "path1": {
              "name": "No (Default)",
              "steps": [
                "Create temporary Body for visualization",
                "Create BeamCut (Machining) with dimensions (Length+Gap, Width+Gap, Height)",
                "Apply Cut to both adjacent rafters",
                "Draw Body in display color"
              ]
            },
            "path2": {
              "name": "Yes (Convert to Beams)",
              "steps": [
                "dbCreate new GenBeam (Blocking)",
                "Assign Properties (Name, Material, Grade, etc.)",
                "Create new TSL Instance attached to the new beam",
                "Transfer relevant data (Roof Plane, Props) to new TSL",
                "Erase current Script Instance"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Required Entity Links",
            "errorMessage": "Missing link / Missing link to roofplane or rafters",
            "recovery": "User must ensure script is linked to a valid ERoofPlane and at least one GenBeam (Rafter)."
          },
          {
            "check": "Reference Object Validity (Post-Insert)",
            "errorMessage": "No valid object found for mode",
            "recovery": "Ensure the referenced Wall, PLine, or Plate still exists in the drawing."
          },
          {
            "check": "Geometric Validity (Height)",
            "errorMessage": "Offset invalid, check properties",
            "recovery": "Adjust 'Offset' or 'Height of Blocking' properties to ensure positive height values relative to the roof plane."
          },
          {
            "check": "Geometric Validity (Blocking Height)",
            "errorMessage": "Height of Blocking invalid, check properties",
            "recovery": "Increase 'Height of Blocking' or enable 'Calculate height of blocking'."
          },
          {
            "check": "Color Index",
            "errorMessage": "None (Silent fix)",
            "recovery": "Script auto-corrects nColor to 170 if out of range (0-255)."
          },
          {
            "check": "Rafter Intersection",
            "errorMessage": "no interscting rafters found",
            "recovery": "Move script closer to rafters or adjust Offset/Mode to ensure the reference line crosses rafter geometry."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Dimensions (Width, Depth, Gaps)",
            "how": "OPM Properties Palette",
            "effect": "Updates the size of the visual Body and the dimensions of the Grooves cut into the rafters."
          },
          {
            "action": "Modify Offset/Height",
            "how": "OPM Properties Palette",
            "effect": "Moves the blocking up/down the roof slope or perpendicular to it. Triggers recalculation of geometry."
          },
          {
            "action": "Switch Calculation Mode (sCalcBlocking)",
            "how": "OPM Properties Palette",
            "effect": "Toggles between calculating height automatically based on roof geometry vs. using a fixed user height."
          },
          {
            "action": "Convert to Beams (sToBeams)",
            "how": "OPM Properties Palette (Change 'No' to 'Yes')",
            "effect": "Replaces visual bodies with actual GenBeam entities, spawns independent scripts for each block, and deletes the parent distribution script."
          },
          {
            "action": "Change Mode (sMode)",
            "how": "OPM Properties Palette",
            "effect": "Restricted. Can only switch to 'Point' mode. Other modes revert to original insertion method."
          }
        ]
      },
      "tokens_used": 11599,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Stellbrett Verteilung\n\n## Overview\nGenerates blocking (nogging) between rafters or cuts grooves into them. It positions the elements relative to a roof plane and a reference boundary defined by a wall, plate, or point.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Requires 3D geometry (Roof Planes, Beams). |\n| Paper Space | No | Not designed for 2D layouts. |\n| Shop Drawing | No | Not a shop drawing annotation script. |\n\n## Prerequisites\n- **Roof Plane**: An existing `ERoofPlane` entity.\n- **Rafters**: Structural beams (GenBeam) representing the rafters.\n- **Reference Object**:\n  - Mode \"Wall or Polyline\": An Element (Wall) or Polyline.\n  - Mode \"Plate\": A GenBeam acting as a plate.\n  - Mode \"Point\": A 3D point in space.\n- **Settings**: No specific settings files required.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Stellbrett Verteilung.mcr`\n\n### Step 2: Configure Properties\nA dialog appears automatically upon insertion.\nAction: Set initial parameters like **Thickness**, **Mode**, and **Height of Blocking**. Click OK to proceed.\n\n### Step 3: Select Roof Plane\n```\nCommand Line: select roofplane\nAction: Click on the ERoofPlane entity that defines the roof slope.\n```\n\n### Step 4: Select Rafters\n```\nCommand Line: select rafter(s)\nAction: Select the rafters (GenBeams) where blocking is needed. You can select multiple rafters.\n```\n\n### Step 5: Select Reference Object\nThe prompt changes based on the **sMode** property selected in Step 2.\n```\nMode: Wall or Polyline\nCommand Line: select wall or polyline\nAction: Click a wall element or a polyline defining the start edge.\n\nMode: Plate\nCommand Line: select plate\nAction: Click the plate beam (GenBeam) defining the start edge.\n\nMode: Point\nCommand Line: Point\nAction: Click a specific 3D point in the drawing to define the start location.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **sMode** | dropdown | Wall or Polyline | Determines how the start position is defined. Options: Wall or Polyline, Plate, Point. |\n| **dWidth** | number | 19 mm | Thickness of the blocking timber. |\n| **dDepth** | number | 4 mm | Depth of the groove cut into the rafters. |\n| **dGapAtSide** | number | 1 mm | Lateral clearance between the blocking and rafters. |\n| **dGapLength** | number | 1 mm | Longitudinal clearance at the ends of the blocking. |\n| **dOffset** | number | 0 mm | Displacement of the blocking along the roof slope from the reference. |\n| **dTrauf** | number | 0 mm | Thickness of the eaves/sheathing layer (Traufschalung). |\n| **dBlockingHeight** | number | 190 mm | Height of the blocking element. |\n| **sCalcBlocking** | dropdown | No | If 'Yes', calculates blocking height automatically based on geometry. |\n| **sOrient** | dropdown | Perpendicular to RCS | Reference axis for height. 'Perpendicular to RCS' is plumb to roof; 'Perpendicular to WCS' is true vertical. |\n| **sToBeams** | dropdown | No | If 'Yes', creates real structural beams (GenBeams). If 'No', creates visual bodies and cuts grooves. |\n| **sName** | text | Stellbrett | Name assigned to generated beam entities. |\n| **sMat** | text | Dreischicht | Material specification. |\n| **sGrade** | text | BC | Timber grade/strength class. |\n| **nColor** | number | 170 | Display color index of the generated elements. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the script geometry based on current property values or changes in linked elements (Roof/Rafters). |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies on internal properties and drawing geometry; no external settings file is required.\n\n## Tips\n- **Converting to Beams**: To generate actual timber pieces for production/BOM, set the **sToBeams** property to 'Yes'. This replaces the script instance with individual beam elements.\n- **Mode Limitations**: After inserting the script, you can only switch the **sMode** to 'Point'. Switching back to 'Wall' or 'Plate' mode is blocked by the script logic.\n- **Automatic Height**: Use **sCalcBlocking** set to 'Yes' to let the script determine the correct blocking height based on the roof plane, which helps avoid errors on complex roof pitches.\n- **Clearance**: Use **dGapAtSide** and **dGapLength** to ensure easy assembly by adding slight tolerances to the cut grooves.\n\n## FAQ\n- **Q: The script reports \"Height of Blocking invalid\". What should I do?**\n  A: Check the **dBlockingHeight** value. Ensure it is positive and large enough for the geometry. Alternatively, enable **sCalcBlocking** to calculate it automatically.\n- **Q: Why can't I switch to 'Plate' mode in the properties palette?**\n  A: The script allows switching to 'Point' mode after insertion to allow adjustments, but switching back to Wall/Plate requires re-inserting the script or specific link handling which is restricted.\n- **Q: The blocking is cutting through my rafters incorrectly.**\n  A: Verify the **dDepth** (groove depth) and **dWidth** (thickness) settings. Ensure the rafters are actually intersecting the calculated reference plane."
      },
      "tokens_used": 9395,
      "error": null
    }
  }
}