{
  "filename": "hsbCLT-Slot-Distribution.mcr",
  "status": "completed",
  "total_tokens": 58870,
  "processing_time": 372.15405225753784,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": null,\n    \"majorVersion\": null,\n    \"minorVersion\": null,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.4\",\n      \"date\": \"19.10.2023\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-20373 bugfix on insert\"\n    },\n    {\n      \"version\": \"1.3\",\n      \"date\": \"17.10.2023\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-20373 sectional edits improved, distribution rules enhanced, new grips\"\n    },\n    {\n      \"version\": \"1.2\",\n      \"date\": \"02.02.2022\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-14553 dimpoints patterns enhanced\"\n    },\n    {\n      \"version\": \"1.1\",\n      \"date\": \"01.02.2022\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-14553 dimpoints published, new context command to configure shopdrawing\"\n    },\n    {\n      \"version\": \"1.0\",\n      \"date\": \"19.01.2022\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"HSB-14429 inital version\"\n    }\n  ],\n  \"settingsFiles\": [\n    \"hsbCLT-Slot-Distribution.xml\"\n  ],\n  \"dependencies\": [\n    \"hsbCLT-Slot.mcr"
      },
      "tokens_used": 9068,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates physical Slot geometry using 'Slot(...).addMeToGenBeamsIntersect(sips)'. It explicitly uses '_kModelSpace' in 'el.getBodyProfiles(_kModelSpace)' and 'tslNew.dbCreate(..., _kModelSpace, ...)'. While it generates 'DimRequest[]' maps and queries 'MultiPageStyle' for configuration, it executes in the 3D model to modify Element/GenBeam entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing coplanar panels",
          "requiredSettings": [
            "hsbCLT-Slot-Distribution.xml"
          ]
        }
      },
      "tokens_used": 7776,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": [
            {
              "prompt": "Are you sure to overwrite existing settings? [No/Yes]",
              "options": [
                "No",
                "Yes"
              ]
            }
          ]
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Right-click context menu: Configure Shopdrawing",
            "title": "Configure Shopdrawing",
            "dataSource": "OPM Properties of a temporary TSL instance (DialogMode=1)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dWidth",
            "type": "PropDouble",
            "displayName": "Width",
            "defaultValue": 8,
            "inputType": "number",
            "options": [],
            "category": "Geometry",
            "description": "Defines the Width"
          },
          {
            "index": 1,
            "variable": "dDepth",
            "type": "PropDouble",
            "displayName": "Depth",
            "defaultValue": 16,
            "inputType": "number",
            "options": [],
            "category": "Geometry",
            "description": "Defines the Depth"
          },
          {
            "index": 0,
            "variable": "sFace",
            "type": "PropString",
            "displayName": "Face",
            "defaultValue": "Reference Side",
            "inputType": "dropdown",
            "options": [
              "Reference Side",
              "Opposite Side"
            ],
            "category": "Alignment",
            "description": "Defines the Face"
          },
          {
            "index": 1,
            "variable": "dAngle",
            "type": "PropDouble",
            "displayName": "Angle",
            "defaultValue": 19.5,
            "inputType": "number",
            "options": [],
            "category": "Alignment",
            "description": "Defines the angle of the slot to the normal of the face, must be in range of -90 > Value < 90"
          },
          {
            "index": 2,
            "variable": "dInterdistance",
            "type": "PropDouble",
            "displayName": "Interdistance",
            "defaultValue": 60,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": "Defines the Interdistance"
          },
          {
            "index": 3,
            "variable": "sDistributionMode",
            "type": "PropString",
            "displayName": "Mode",
            "defaultValue": "Fixed",
            "inputType": "dropdown",
            "options": [
              "Fixed",
              "Even"
            ],
            "category": "Distribution",
            "description": "Defines the DistributionMode"
          },
          {
            "index": 4,
            "variable": "dRotation",
            "type": "PropDouble",
            "displayName": "Rotation",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": "Defines the rotation of the slot distribution"
          },
          {
            "index": 5,
            "variable": "dLeft",
            "type": "PropDouble",
            "displayName": "Left",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Distribution Offsets",
            "description": "Defines the Left"
          },
          {
            "index": 6,
            "variable": "dRight",
            "type": "PropDouble",
            "displayName": "Right",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "Distribution Offsets",
            "description": "Defines the Right"
          },
          {
            "index": 7,
            "variable": "dStartDistance",
            "type": "PropDouble",
            "displayName": "Start Distance",
            "defaultValue": 150,
            "inputType": "number",
            "options": [],
            "category": "Distribution Offsets",
            "description": "Defines the Start Distance"
          },
          {
            "index": 8,
            "variable": "dEndDistance",
            "type": "PropDouble",
            "displayName": "End Distance",
            "defaultValue": 150,
            "inputType": "number",
            "options": [],
            "category": "Distribution Offsets",
            "description": "Defines the End Distance"
          },
          {
            "index": 0,
            "variable": "sFormat",
            "type": "PropString",
            "displayName": "Format",
            "defaultValue": "@(Quantity-2)x  @(Width) / @(Depth)  >@(Angle)°",
            "inputType": "text",
            "options": [],
            "category": "Dimension",
            "description": "Defines the Format"
          },
          {
            "index": 1,
            "variable": "sStereotype",
            "type": "PropString",
            "displayName": "Stereotype",
            "defaultValue": "*",
            "inputType": "dropdown",
            "options": [
              "<Disabled>",
              "*",
              "Dynamic List from Styles"
            ],
            "category": "Dimension",
            "description": "Defines the stereotype"
          },
          {
            "index": 2,
            "variable": "sView",
            "type": "PropString",
            "displayName": "View",
            "defaultValue": "XY-View",
            "inputType": "dropdown",
            "options": [
              "XY-View",
              "Section"
            ],
            "category": "Dimension",
            "description": "Defines the View"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Flip Side",
            "handler": "|Flip Side|",
            "action": "Toggles the side of the panel the slots are applied to",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Add Panels",
            "handler": "|Add Panels|",
            "action": "Initiates selection of additional panels to add to the distribution",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Remove Panels",
            "handler": "|Remove Panels|",
            "action": "Initiates selection of panels to remove from the distribution",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Edit in Place",
            "handler": "|Edit in Place|",
            "action": "Switches script to 'Edit in Place' mode, turning slots into editable instances",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Configure Shopdrawing",
            "handler": "|Configure Shopdrawing|",
            "action": "Opens a dialog to configure dimension format, stereotype, and view",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Import Settings",
            "handler": "|Import Settings|",
            "action": "Imports configuration from 'hsbCLT-Slot-Distribution.xml'",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Export Settings",
            "handler": "|Export Settings|",
            "action": "Exports current configuration to 'hsbCLT-Slot-Distribution.xml'",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "hsbCLT-Slot-Distribution.xml",
            "searchPaths": [
              "_kPathHsbCompany\\TSL\\Settings",
              "_kPathHsbInstall\\Content\\General\\TSL\\Settings"
            ],
            "purpose": "Stores persistent configuration for Dimension settings (Format, Stereotype, View) and general map object data.",
            "required": false
          }
        ]
      },
      "tokens_used": 9545,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the creation of ventilation, wiring, or architectural slot patterns across multiple coplanar CLT panels.",
          "category": "Machining",
          "typicalUseCase": "Applying a consistent array of angled or horizontal slots through CLT floor or wall panels for airflow or cable passage."
        },
        "parameters": [
          {
            "name": "dWidth",
            "technicalDefault": 8,
            "businessMeaning": "The width of the individual slot opening (the visible gap on the panel face).",
            "validRange": "4 - 100",
            "unit": "mm",
            "affectsOutput": "Changes the width of the rectangular cut geometry."
          },
          {
            "name": "dDepth",
            "technicalDefault": 16,
            "businessMeaning": "The half-depth of the slot penetration. The actual cut through the panel will be twice this value.",
            "validRange": "5 - 150",
            "unit": "mm",
            "affectsOutput": "Controls how deep the slot cuts into the panel thickness. (Total Cut Depth = dWidth * 2)."
          },
          {
            "name": "sFace",
            "technicalDefault": "Reference Side",
            "businessMeaning": "Determines which side of the panel the angle is calculated from or which surface is used as the primary reference.",
            "validRange": "Reference Side, Opposite Side",
            "unit": "enum",
            "affectsOutput": "Flips the direction of the angle calculation or the side of the profile used for alignment."
          },
          {
            "name": "dAngle",
            "technicalDefault": 19.5,
            "businessMeaning": "The inclination of the slot relative to the panel normal. Allows for drainage or architectural alignment.",
            "validRange": "-89 to 89",
            "unit": "degrees",
            "affectsOutput": "Rotates the slot geometry around the panel surface; 90 degrees is forbidden (would create an infinite plane)."
          },
          {
            "name": "dInterdistance",
            "technicalDefault": 60,
            "businessMeaning": "The distance between the centers of consecutive slots in 'Fixed' mode.",
            "validRange": "20 - 2000",
            "unit": "mm",
            "affectsOutput": "Determines the spacing density of the slots along the distribution axis."
          },
          {
            "name": "sDistributionMode",
            "technicalDefault": "Fixed",
            "businessMeaning": "Defines the calculation logic for spacing: 'Fixed' uses the exact Interdistance; 'Even' calculates spacing to fill the available area.",
            "validRange": "Fixed, Even",
            "unit": "enum",
            "affectsOutput": "Switches between constant spacing and calculated spacing that respects Start/End distances."
          },
          {
            "name": "dRotation",
            "technicalDefault": 0,
            "businessMeaning": "Rotates the entire distribution line of slots relative to the default panel axis.",
            "validRange": "-180 to 180",
            "unit": "degrees",
            "affectsOutput": "Changes the orientation of the array (e.g., from horizontal to diagonal across the panel)."
          },
          {
            "name": "dLeft",
            "technicalDefault": 0,
            "businessMeaning": "Offset applied to the start of the distribution axis.",
            "validRange": "-1000 to 1000",
            "unit": "mm",
            "affectsOutput": "Shifts the entire pattern of slots along the distribution axis from the start."
          },
          {
            "name": "dRight",
            "technicalDefault": 0,
            "businessMeaning": "Offset applied to the end of the distribution axis.",
            "validRange": "-1000 to 1000",
            "unit": "mm",
            "affectsOutput": "Shifts the entire pattern of slots along the distribution axis from the end."
          },
          {
            "name": "dStartDistance",
            "technicalDefault": 150,
            "businessMeaning": "The mandatory margin or 'keep-out' zone from the start edge of the panel/selection to the first slot.",
            "validRange": "0 - 3000",
            "unit": "mm",
            "affectsOutput": "Prevents slots from being placed too close to the starting edge."
          },
          {
            "name": "dEndDistance",
            "technicalDefault": 150,
            "businessMeaning": "The mandatory margin or 'keep-out' zone from the end edge of the panel/selection to the last slot.",
            "validRange": "0 - 3000",
            "unit": "mm",
            "affectsOutput": "Prevents slots from being placed too close to the ending edge."
          },
          {
            "name": "sFormat",
            "technicalDefault": "@(Quantity-2)x  @(Width) / @(Depth)  >@(Angle)°",
            "businessMeaning": "The text template used to label the slot group in shop drawings.",
            "validRange": "String with placeholders",
            "unit": "text",
            "affectsOutput": "Updates the dimension label text in generated views."
          },
          {
            "name": "sStereotype",
            "technicalDefault": "*",
            "businessMeaning": "Links the dimension object to a specific drafting style/stereotype for automated shopdrawing filtering.",
            "validRange": "List from Styles",
            "unit": "enum",
            "affectsOutput": "Controls the visual appearance and layering of the dimension annotations."
          },
          {
            "name": "sView",
            "technicalDefault": "XY-View",
            "businessMeaning": "Specifies the drawing view direction where the dimension labels are valid/visible.",
            "validRange": "XY-View, Section",
            "unit": "enum",
            "affectsOutput": "Determines if dimensions appear in plan view or sectional view."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sDistributionMode changes to 'Even'",
            "effect": "The 'dInterdistance' value is likely overridden by a calculated value to evenly space slots between Start and End offsets.",
            "cascade": [
              "dInterdistance"
            ]
          },
          {
            "trigger": "dDepth value input",
            "effect": "The actual physical cut depth is double the entered value (dDepth * 2).",
            "cascade": [
              "Slot Geometry Depth"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Slot",
            "description": "A rectangular void cut through the CLT panel, defined by Width, Depth (2*Input), and Angle.",
            "appliedTo": "Selected GenBeam/Element entities (CLT Panels)."
          },
          {
            "type": "DimRequest",
            "description": "Annotation data object containing text, position, and style information for shopdrawing labels.",
            "appliedTo": "Model Space (associated with the TSL instance)."
          }
        ]
      },
      "tokens_used": 10844,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Launch: Load TSL interpreter and constants",
          "Settings Initialization: Check for 'hsbCLT-Slot-Distribution.xml' in Company/Install paths or existing MapObject",
          "Properties Declaration: Define Geometry, Alignment, Distribution, and Dimension parameters in OPM",
          "DialogMode Check: If triggered with 'DialogMode=1', show Shopdrawing configuration UI and return",
          "Insertion Sequence (_bOnInsert):",
          "  - Set Filter to 'All'",
          "  - Prompt User: Select Entities (Panels)",
          "  - Validation: If no entities selected, erase and abort",
          "  - Prompt User: Specify insertion point (Origin)",
          "  - Prompt User: Specify rotation point (Direction)",
          "  - Validation: Create Element at insertion point; if invalid, erase and abort",
          "  - dbCreate: Instantiate script in Model Space with selected entities and calculated rotation",
          "Execution Sequence (Recalc):",
          "  - Read properties from OPM and MapObject",
          "  - Retrieve linked panels (GenBeams/Elements)",
          "  - Coordinate System Calculation: Define CS based on Origin, Panel Normal, and Rotation Property",
          "  - Distribution Calculation:",
          "    - Calculate effective length based on Left/Right offsets",
          "    - Branch: 'Fixed' mode uses dInterdistance to calculate slot count",
          "    - Branch: 'Even' mode calculates spacing to fit available length",
          "  - Slot Generation Loop:",
          "    - Construct PlaneProfile for each slot position",
          "    - Branch: If 'Edit in Place' is active, create 'hsbCLT-Slot' sub-instances",
          "    - Branch: Otherwise, create direct 'Slot' machining operations on panels",
          "  - Visualization: Draw preview graphics in 3D and Section views",
          "  - Dimensioning: Generate DimRequest maps for shopdrawings based on View/Format settings",
          "Context Menu Handling: Execute specific triggers (Flip, Add/Remove, Config, Import/Export)"
        ],
        "conditionalBranches": [
          {
            "condition": "Distribution Mode Property (sDistributionMode)",
            "path1": {
              "name": "Fixed Mode",
              "steps": [
                "Read 'dInterdistance' property value",
                "Calculate number of slots (nSlots) based on fixed spacing and available length",
                "Generate slots at strict intervals defined by 'dInterdistance'"
              ]
            },
            "path2": {
              "name": "Even Mode",
              "steps": [
                "Calculate number of slots to fit within 'Start' and 'End' distances",
                "Compute even spacing (override dInterdistance) to distribute slots uniformly across the effective length",
                "Generate slots at calculated even intervals"
              ]
            }
          },
          {
            "condition": "Edit in Place Status (Context Menu Trigger)",
            "path1": {
              "name": "Standard Machining",
              "steps": [
                "Script creates 'Slot' objects directly",
                "Adds slots to intersecting GenBeams immediately",
                "Visualizes solid cut geometry"
              ]
            },
            "path2": {
              "name": "Edit in Place",
              "steps": [
                "Script creates instances of 'hsbCLT-Slot.mcr' at each slot position",
                "Parent script erases itself to allow independent editing of sub-slots",
                "User can modify individual slots instead of the whole distribution"
              ]
            }
          },
          {
            "condition": "Export Settings File Existence",
            "path1": {
              "name": "File Exists",
              "steps": [
                "Prompt user on command line: 'Are you sure to overwrite existing settings? [No/Yes]'",
                "If 'No', abort export",
                "If 'Yes', write current map to XML"
              ]
            },
            "path2": {
              "name": "File Does Not Exist",
              "steps": [
                "Create folder structure if missing",
                "Write current map to XML immediately",
                "Report success message"
              ]
            }
          },
          {
            "condition": "DialogMode State",
            "path1": {
              "name": "DialogMode = 1 (Configure Shopdrawing)",
              "steps": [
                "Set OPM Key to 'Shopdrawing'",
                "Expose only Dimension properties (Format, Stereotype, View)",
                "Wait for user input in Properties Palette",
                "Save changes to MapObject on completion",
                "Return (skip script execution)"
              ]
            },
            "path2": {
              "name": "DialogMode = 0 (Normal)",
              "steps": [
                "Proceed to full script execution",
                "Generate geometry and machining"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection during Insertion",
            "errorMessage": "(Implicit) Script aborts/erases if no entities selected.",
            "recovery": "User must restart the command and select valid CLT panels."
          },
          {
            "check": "Reference Element Validity",
            "errorMessage": "Element created at insertion point is invalid.",
            "recovery": "User must select a point that lies on a valid planar surface (CLT Panel)."
          },
          {
            "check": "Distribution Mode Index",
            "errorMessage": "Index out of bounds (corrupt property).",
            "recovery": "Script automatically resets property to 'Fixed' (Index 0) and recalculates."
          },
          {
            "check": "Slot Geometry Dimensions",
            "errorMessage": "Width or Depth is too small (<= dEps).",
            "recovery": "Script skips generation of invalid slots to prevent geometry errors."
          },
          {
            "check": "Angle Range",
            "errorMessage": "Angle is outside -90 > Value < 90.",
            "recovery": "User must manually adjust 'dAngle' property in OPM to avoid mathematical errors/infinite planes."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Geometry Parameters",
            "how": "OPM Properties Palette (Geometry Category)",
            "effect": "Immediately updates Width, Depth, Face, and Angle of all slots in the distribution."
          },
          {
            "action": "Modify Distribution Pattern",
            "how": "OPM Properties Palette (Distribution Category)",
            "effect": "Updates spacing, mode (Fixed/Even), and rotation. Adds or removes slots to match new pattern."
          },
          {
            "action": "Flip Side",
            "how": "Right-click Context Menu",
            "effect": "Toggles 'sFace' property, reversing the side of the panel the slots penetrate."
          },
          {
            "action": "Add/Remove Panels",
            "how": "Right-click Context Menu",
            "effect": "Prompts user to select additional panels to include in the current distribution set or removes selected panels."
          },
          {
            "action": "Configure Shopdrawing",
            "how": "Right-click Context Menu",
            "effect": "Opens a filtered dialog to set text Format, Stereotype, and View (Plan vs Section) for dimension labels."
          },
          {
            "action": "Edit in Place",
            "how": "Right-click Context Menu",
            "effect": "Explodes the distribution into individual 'hsbCLT-Slot' instances, allowing granular editing of single slots."
          },
          {
            "action": "Import/Export Settings",
            "how": "Right-click Context Menu",
            "effect": "Persists current configuration (Dim settings, offsets) to XML or loads a saved configuration."
          }
        ]
      },
      "tokens_used": 12971,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-Slot-Distribution.mcr\n\n## Overview\nAutomates the creation of ventilation, wiring, or architectural slot patterns across multiple coplanar CLT panels. It allows for adjustable spacing, angles, and depth for consistent machining across a selection of elements.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates in 3D model space to create physical slots. |\n| Paper Space | No | Not applicable for 2D layout. |\n| Shop Drawing | No | Generates geometry used in shop drawings but does not run within the drawing view itself. |\n\n## Prerequisites\n- **Required Entities:** GenBeam or Element entities (CLT Panels).\n- **Minimum Beam Count:** 1.\n- **Required Settings:** `hsbCLT-Slot-Distribution.xml` (Optional, used to save/load dimension configurations).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `hsbCLT-Slot-Distribution.mcr`\n\n### Step 2: Select Entities\n```\nCommand Line: Select Entities\nAction: Select the CLT panels (GenBeams/Elements) you wish to apply the slot distribution to. Press Enter to confirm.\n```\n\n### Step 3: Specify Insertion Point\n```\nCommand Line: Specify insertion point\nAction: Click in the model space to define the origin point for the distribution (usually on the face of a panel).\n```\n\n### Step 4: Specify Rotation\n```\nCommand Line: Specify rotation point\nAction: Click a second point to define the direction/orientation of the slot distribution line.\n```\n\n## Properties Panel Parameters\n\n### Geometry\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | number | 8 mm | The visible width of the slot opening on the panel face. |\n| Depth | number | 16 mm | The half-depth of the slot. **Note:** The physical cut depth will be twice this value (Total Cut = Depth * 2). |\n\n### Alignment\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Face | dropdown | Reference Side | Determines which side of the panel the angle calculation references (Reference Side or Opposite Side). |\n| Angle | number | 19.5° | The inclination of the slot relative to the panel normal. Range: -89° to 89°. |\n\n### Distribution\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Mode | dropdown | Fixed | **Fixed:** Uses exact `Interdistance`. **Even:** Calculates spacing to fill area between Start/End offsets. |\n| Interdistance | number | 60 mm | Distance between the centers of consecutive slots (used in Fixed mode). |\n| Rotation | number | 0° | Rotates the entire distribution line of slots relative to the default axis. |\n\n### Distribution Offsets\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Left | number | 0 mm | Offsets the start of the distribution pattern. |\n| Right | number | 0 mm | Offsets the end of the distribution pattern. |\n| Start Distance | number | 150 mm | Margin from the start edge before the first slot appears. |\n| End Distance | number | 150 mm | Margin from the end edge after the last slot appears. |\n\n### Dimension\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Format | text | @(Quantity-2)x @(Width) / @(Depth) >@(Angle)° | Text template for labeling the slot group in shop drawings. |\n| Stereotype | dropdown | * | Links the dimension to a specific drafting style for layering/filtering. |\n| View | dropdown | XY-View | Specifies if dimensions appear in Plan view (XY) or Section view. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Flip Side | Toggles the `Face` property, switching the slots to the opposite side of the panel. |\n| Add Panels | Prompts you to select additional panels to add to the current distribution group. |\n| Remove Panels | Prompts you to select panels to remove from the current distribution group. |\n| Edit in Place | Converts the distribution into individual `hsbCLT-Slot` instances. This allows you to edit single slots independently. The main script instance is removed. |\n| Configure Shopdrawing | Opens a dialog to quickly adjust Dimension settings (Format, Stereotype, View). |\n| Import Settings | Loads configuration settings from `hsbCLT-Slot-Distribution.xml`. |\n| Export Settings | Saves current configuration to `hsbCLT-Slot-Distribution.xml`. |\n\n## Settings Files\n- **Filename**: `hsbCLT-Slot-Distribution.xml`\n- **Location**: `_kPathHsbCompany\\TSL\\Settings` or `_kPathHsbInstall\\Content\\General\\TSL\\Settings`\n- **Purpose**: Stores persistent configuration for Dimension settings (Format, Stereotype, View) and general map object data, allowing you to share settings between projects.\n\n## Tips\n- **Avoid 90° Angle:** Ensure the `Angle` property is not set to 90° or -90°, as this creates an invalid infinite plane and will cause the script to fail.\n- **Edit in Place:** If you need to adjust just one slot in a wall (e.g., avoid a structural beam), use the **Edit in Place** context menu option. This breaks the link to the main distribution and lets you move individual slots.\n- **Even vs Fixed:** Use **Even** mode if you want a specific number of slots to perfectly fill a gap between two defined margins. Use **Fixed** mode to maintain standard construction spacing regardless of the panel length.\n- **Depth Calculation:** Remember that the value you enter for `Depth` is only half the total penetration. If you need a 40mm deep cut, enter `20`.\n\n## FAQ\n- **Q: Can I add panels to an existing slot distribution without starting over?**\n  **A:** Yes. Select the script instance in the model, right-click, and choose **Add Panels**. You can then select the new panels to include.\n  \n- **Q: Why are my slots not cutting through the full panel thickness?**\n  **A:** Check the `Depth` property in the Properties Palette. The script calculates total depth as `2 * dDepth`. Double your input value if the cut is too shallow.\n\n- **Q: What happens if I use \"Edit in Place\"?**\n  **A:** The main `hsbCLT-Slot-Distribution` script will delete itself and replace the pattern with individual `hsbCLT-Slot` scripts. You can no longer control the whole pattern as one unit, but you can move or modify specific slots.\n\n- **Q: How do I apply the same slot settings to another project?**\n  **A:** Configure your slots as desired, right-click the instance, and select **Export Settings**. In the new project, insert the script and select **Import Settings** to load the configuration."
      },
      "tokens_used": 8666,
      "error": null
    }
  }
}