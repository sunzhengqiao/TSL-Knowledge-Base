{
  "filename": "HSB_W-SplitPlates.mcr",
  "status": "completed",
  "total_tokens": 29788,
  "processing_time": 406.19177317619324,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "07.05.2014",
            "author": "AJ",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "19.05.2014",
            "author": "AS",
            "changes": "Add translation pipes, add support for attachment to wall definition."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5199,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select ElementWall objects and iterates through Beam collections within those walls. It performs geometric calculations (Vector3d, Point3d) and modifies the database using Beam.dbSplit(). No SD- or Multipage functions are present. No Viewport or 2D layout logic exists."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall",
            "Beam (TopPlate/BottomPlate)"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 3327,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Please select Element|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4479,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically splits long wall top and bottom plates into shorter segments to match standard raw material lengths or handling constraints.",
          "category": "Framing",
          "typicalUseCase": "Used during the design phase to break down continuous wall plates longer than available timber stock (e.g., 5m or 6m) into manageable pieces for manufacturing and transportation."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Empty Selection",
            "businessMeaning": "The set of wall elements selected by the user to be processed for plate splitting.",
            "validRange": "Existing ElementWall entities in the drawing.",
            "unit": "Entity",
            "affectsOutput": "Defines the scope of the operation; only top and bottom plates contained within the selected walls will be checked and split. If no walls are selected, the script deletes itself."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Modified Beams (Split)",
            "description": "Top plates and bottom plates are split into multiple beams. Bottom plates are split at 5000mm intervals. Top plates are split at 5000mm if they are between 5m and 6m long, or split to extract a 5000mm center section if they are longer than 6000mm.",
            "appliedTo": "Top Plates (types: _kSFTopPlate, _kSFAngledTPLeft, _kSFAngledTPRight) and Bottom Plates (type: _kSFBottomPlate) within the selected ElementWall."
          }
        ]
      },
      "tokens_used": 6436,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch (User executes command)",
          "2. Prompt User to select ElementWall entities",
          "3. Validate Selection (Check if walls selected)",
          "4. [Condition] If selection is empty: Erase script instance and exit",
          "5. [Condition] If selection is valid: Store walls in _Element array",
          "6. Loop through each selected ElementWall",
          "7. Identify and filter Beams into Top Plates and Bottom Plates",
          "8. Loop through Bottom Plates",
          "9. [Condition] Check Bottom Plate Length",
          "10. Loop through Top Plates",
          "11. [Condition] Check Top Plate Length",
          "12. Apply splitting operations based on logic",
          "13. End Loop (Walls)",
          "14. Erase script instance (Cleanup)"
        ],
        "conditionalBranches": [
          {
            "condition": "User Input during Insertion",
            "path1": {
              "name": "Valid Wall Selection",
              "steps": [
                "Entities stored in _Element array",
                "Flag 'ManualInsert' set to true",
                "Script proceeds to processing loop"
              ]
            },
            "path2": {
              "name": "Empty/Invalid Selection",
              "steps": [
                "eraseInstance() called",
                "Script terminates immediately"
              ]
            }
          },
          {
            "condition": "Bottom Plate Length vs. Threshold (5000mm)",
            "path1": {
              "name": "Length > 5000mm",
              "steps": [
                "Calculate split point 5000mm from the end",
                "Execute dbSplit",
                "Check if remaining segment > 5000mm",
                "If yes, split again recursively"
              ]
            },
            "path2": {
              "name": "Length <= 5000mm",
              "steps": [
                "No action taken",
                "Beam remains unchanged"
              ]
            }
          },
          {
            "condition": "Top Plate Length vs. Thresholds (5000mm, 6000mm)",
            "path1": {
              "name": "Length between 5000mm and 6000mm",
              "steps": [
                "Calculate split point 5000mm from the left/start",
                "Execute dbSplit (Creates one 5000mm piece and one remainder)"
              ]
            },
            "path2": {
              "name": "Length > 6000mm",
              "steps": [
                "Calculate split points around the center (+/- 2500mm)",
                "Execute dbSplit twice to extract a 5000mm center section",
                "Leaves two tail end segments"
              ]
            },
            "path3": {
              "name": "Length <= 5000mm",
              "steps": [
                "No action taken",
                "Beam remains unchanged"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection Type",
            "errorMessage": "Implicit (Prompt filters for ElementWall)",
            "recovery": "User must select an ElementWall entity from the model."
          },
          {
            "check": "Selection Set Empty",
            "errorMessage": "|No selected walls, TSL will be deleted|!",
            "recovery": "User must re-run the script and select at least one wall."
          },
          {
            "check": "Beam Content",
            "errorMessage": "None (Script skips empty walls)",
            "recovery": "Script continues if wall contains 0 beams, but processes only specific beam types (Top/Bottom plates)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Fire and Forget)",
            "how": "N/A",
            "effect": "The script automatically calls eraseInstance() after processing. It does not remain in the model for OPM editing or parameter modification."
          }
        ]
      },
      "tokens_used": 6122,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_W-SplitPlates.mcr\n\n## Overview\nThis script automatically splits long wall top and bottom plates into shorter segments to match standard raw material lengths (e.g., 5m or 6m). It helps optimize wall elements for manufacturing and transportation constraints by breaking down continuous plates into manageable pieces.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the 3D Model Space. |\n| Paper Space | No | Not supported for 2D layouts or viewports. |\n| Shop Drawing | No | This is a modeling tool and does not generate shop drawings. |\n\n## Prerequisites\n- **Required Entities**: `ElementWall` (Wall objects) that contain Top Plates or Bottom Plates.\n- **Minimum Beam Count**: 0 (The script handles empty walls gracefully, but requires walls to be present to function).\n- **Required Settings Files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: Type `TSLINSERT` in the command line and select `HSB_W-SplitPlates.mcr` from the file dialog.\n\n### Step 2: Select Wall Elements\n```\nCommand Line: Please select Element\nAction: Click on the wall(s) in your model that require plate splitting. You can select multiple walls. Press Enter to confirm.\n```\n\n*(Note: If no walls are selected, the script will display a message and terminate immediately.)*\n\n### Step 3: Automatic Processing\nThe script will automatically detect the Top and Bottom plates within the selected walls and split them according to the logic defined below. The script instance deletes itself automatically once finished.\n\n## Properties Panel Parameters\nThis script does not expose any editable parameters in the Properties Palette. It is a \"fire and forget\" tool that executes immediately based on the geometry of the selected walls.\n\n## Right-Click Menu Options\nNone. The script runs once upon insertion and does not remain in the model to provide context menu options.\n\n## Settings Files\nNone. The script does not rely on external XML or configuration files.\n\n## Tips\n- **Selection Efficiency**: You can select multiple walls at once before pressing Enter to process an entire floor or section quickly.\n- **Undo**: If the results are not as expected, use the standard AutoCAD `UNDO` command to revert the changes, as the script deletes itself after running.\n- **Split Logic Awareness**:\n    - **Bottom Plates**: are split recursively at 5000mm intervals. If a plate is 12m long, it will be split into pieces of 5m, 5m, and 2m.\n    - **Top Plates**:\n        - If length is **> 5000mm and < 6000mm**: It splits to create a 5000mm piece and a remainder.\n        - If length is **> 6000mm**: It extracts a 5000mm section from the center, leaving two tail pieces (e.g., a 7m plate becomes a 1m tail, 5m center, and 1m tail).\n\n## FAQ\n- **Q: Can I customize the split length (e.g., change 5000mm to 6000mm)?**\n  - A: No, the split thresholds are currently hardcoded within the script logic.\n- **Q: Why did the script disappear after I ran it?**\n  - A: This is intentional behavior. The script is designed as a one-time command tool. It performs the splits and then removes its own instance from the drawing to keep the project clean.\n- **Q: Does this script split studs or other wall components?**\n  - A: No, it specifically targets Top Plates and Bottom Plates within the ElementWall. It does not affect studs, headers, or other wall members."
      },
      "tokens_used": 4225,
      "error": null
    }
  }
}