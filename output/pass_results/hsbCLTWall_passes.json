{
  "filename": "hsbCLTWall.mcr",
  "status": "completed",
  "total_tokens": 39547,
  "processing_time": 271.5074305534363,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": 0,\n    \"keywords\": [],\n    \"majorVersion\": 0,\n    \"minorVersion\": 0,\n    \"dxaOut\": 0,\n    \"implInsert\": 0\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.7\",\n      \"date\": \"09.11.2023\",\n      \"author\": \"Holzius\",\n      \"changes\": \"get style by thicknesses only if found style doesnt match the SF zone thickness Author: Marsel Nakuci\"\n    },\n    {\n      \"version\": \"1.6\",\n      \"date\": \"10apr19\",\n      \"author\": \"marsel.nakuci@hsbcad.com\",\n      \"changes\": \"allow \\\"KEEPBEAM\\\" for both ppShape and ppShapeSub\"\n    },\n    {\n      \"version\": \"1.5\",\n      \"date\": \"25oct17\",\n      \"author\": \"florian.wuermseer@hsbcad.com\",\n      \"changes\": \"Contour of \\\"KEEPBEAM\\\" beams"
      },
      "tokens_used": 7856,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates on ElementWallSF and GenBeam entities to generate Sip (CLT) panels. It contains no references to _Viewport, sd_* prefixes, or #Type E syntax, indicating it runs exclusively in the 3D modeling environment."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing a StickFrame Wall (HRB-Wand).",
          "requiredSettings": [
            "SipStyle entries must exist that match the material names of the wall's structural beams or the thickness of the wall's Zone 0."
          ]
        }
      },
      "tokens_used": 4487,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select wall elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6244,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 8538,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script Launch: Initialize variables and debug settings.\",\n    \"2. Insertion Check: Verify if running during insert cycle.\",\n    \"3. Cycle Guard: If insertCycleCount > 1, erase instance immediately to prevent recursion.\",\n    \"4. User Prompt: PrEntity command to select wall elements (ElementWallSF).\",\n    \"5. Selection Filter: Iterate selected elements; remove any that already have this TSL attached.\",\n    \"6. Assignment: Assign valid elements to _Element and Return (waiting for next update cycle).\",\n    \"7. Update Cycle Check: If _Element is empty or element was deleted, erase instance.\",\n    \"8. Geometry Setup: Extract Coordinate System and Zone thickness from the first wall element.\",\n    \"9. Style Loading: Retrieve all available SipStyle names and thicknesses from the catalog.\",\n    \"10. Beam Collection: Retrieve all beams from the wall. If zero beams found, return (wait for construction).\",\n    \"11. Beam Classification Loop: Iterate through every beam to build profiles and determine logic.\",\n    \"12. Branching based on BeamCode ('-', 'KEEPBEAM', 'CLT', or Default):\",\n        \"   - '-'      -> Add to Dummy list (for static tools).\",\n        \"   - 'KEEPBEAM' -> Add to Subtraction Profile (cutout) and Exclude from Deletion.\",\n        \"   - 'CLT'    -> Add to Additional Panel list.\",\n        \"   - Default  -> Add to Main Contour Profile and Deletion list.\",\n    \"13. Style Detection: Check first vertical beam with valid material name to set default Style.\",\n    \"14. Style Validation: Check if detected Style thickness matches Wall Zone thickness.\",\n    \"15. Thickness Fallback: If thickness mismatches, search catalog for any Style matching the Zone thickness.\",\n    \"16. Critical Failure: If no valid Style found (material or thickness), report error and erase instance.\",\n    \""
      },
      "tokens_used": 8510,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLTWall.mcr\n\n## Overview\nThis script automatically generates Cross Laminated Timber (CLT) panels from selected StickFrame walls (ElementWallSF). It determines the panel geometry based on the wall structure, handles cutouts for openings, and assigns specific CLT styles based on material names or wall thickness.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script runs in the 3D model environment. |\n| Paper Space | No | Not supported for layout generation. |\n| Shop Drawing | No | Does not generate 2D drawing views directly. |\n\n## Prerequisites\n- **Required Entities**: `ElementWallSF` (StickFrame Wall / HRB-Wand) must exist in the model.\n- **Minimum Beam Count**: At least 1 beam in the wall (though typically a complete wall frame is required).\n- **Required Settings**: Valid `SipStyle` entries must exist in the catalog.\n  - Ideally, the material name of the wall's structural beams should match a Style name.\n  - Alternatively, a Style with a thickness matching the wall's **Zone 0** must exist.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCLTWall.mcr` from the file browser.\n\n### Step 2: Select Wall Elements\n```\nCommand Line: Select wall elements\nAction: Click on the desired StickFrame Wall in the drawing window.\n```\n*Note: The script will attach to the wall. If you select a wall that already has this script attached, it will be skipped to prevent errors.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose specific user-editable parameters in the Properties Palette. It operates automatically based on wall and beam properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | No custom context menu items are added by this script. |\n\n## Settings Files\n- **Catalog**: `SipStyle`\n- **Location**: Defined in your hsbCAD Company or Installation path.\n- **Purpose**: This catalog provides the definitions (thickness, material name, etc.) used to generate the CLT panels. The script searches this catalog to find the best match for the wall geometry.\n\n## Tips\n- **Using `KEEPBEAM`**: If you want an opening (like a window or door) cut out of the CLT panel but want to keep the symbolic beam in the drawing, assign the beam code **`KEEPBEAM`** to the beams defining that opening.\n- **Using `CLT` Code**: Assign the beam code **`CLT`** to beams if you wish to generate a separate, additional panel at that specific location.\n- **Style Matching**: The script first tries to find a style matching the structural beam's material name. If the thickness of that style does not match the wall's Zone 0 thickness, or if no material match is found, it searches for *any* style that matches the Zone 0 thickness exactly.\n- **Debugging**: If a panel is not generated, check the command line for errors regarding missing styles or thickness mismatches.\n\n## FAQ\n- **Q: Why did the script delete itself immediately after running?**\n  - A: This usually happens if no matching style is found in the `SipStyle` catalog for the wall's thickness or material, or if the wall contains 0 beams.\n- **Q: How can I control the thickness of the generated panel?**\n  - A: The thickness is determined by the wall's **Zone 0** properties. Ensure your wall definition has the correct core layer thickness, and that a matching `SipStyle` exists in the catalog.\n- **Q: What happens to the original wall beams?**\n  - A: By default, standard structural beams are deleted after the panel is generated. Only beams with the code `KEEPBEAM` or `-` are preserved."
      },
      "tokens_used": 3912,
      "error": null
    }
  }
}