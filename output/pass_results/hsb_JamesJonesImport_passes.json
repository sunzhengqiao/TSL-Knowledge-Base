{
  "filename": "hsb_JamesJonesImport.mcr",
  "status": "completed",
  "total_tokens": 18951,
  "processing_time": 383.233434677124,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2000,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script logic is wrapped in _bOnInsert, operates via ModelMap (mm) interpretation into the project database, and uses eraseInstance(). No PaperSpace (_Viewport), ShopDrawing (sd_*, #Type E), or Multipage prefixes are present."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "ModelSpace",
          "requiredSettings": [
            "External DLL: hsbCloudStorage\\hsbSteicoIO.dll"
          ]
        }
      },
      "tokens_used": 1213,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "pIJoistGroupName",
            "type": "PropString",
            "displayName": "IJoist Group Name",
            "defaultValue": "I-Joists\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "pBeamGroupName",
            "type": "PropString",
            "displayName": "Beam Group Name",
            "defaultValue": "Beams\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4034,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Imports structural floor framing data (I-Joists and beams) generated by James Jones software into the hsbCAD model via an external IFC processor.",
          "category": "DataExchange/Import",
          "typicalUseCase": "Used when the engineer or designer provides a floor layout created in James Jones design software that needs to be realized as physical beams and joists within the hsbCAD 3D model."
        },
        "parameters": [
          {
            "name": "pIJoistGroupName",
            "technicalDefault": "I-Joists\\Ground_Floor",
            "businessMeaning": "Specifies the destination location (Group path) in the hsbCAD Project Browser / Element Tree where the imported floor joists will be organized.",
            "validRange": "String path valid for hsbCAD element tree (e.g., 'Floor1\\Joists', 'Level02\\I-Joists')",
            "unit": "String (Path)",
            "affectsOutput": "Changes the hierarchical organization of the imported joist elements in the drawing database. Does not alter geometry or material properties."
          },
          {
            "name": "pBeamGroupName",
            "technicalDefault": "Beams\\Ground_Floor",
            "businessMeaning": "Specifies the destination location (Group path) in the hsbCAD Project Browser / Element Tree where the imported structural beams (rim joists, trimmers, carriers) will be organized.",
            "validRange": "String path valid for hsbCAD element tree (e.g., 'Floor1\\RimBeams', 'Structure\\Beams')",
            "unit": "String (Path)",
            "affectsOutput": "Changes the hierarchical organization of the imported beam elements in the drawing database. Does not alter geometry or material properties."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "External Data Import",
            "effect": "The script acts as a wrapper for an external DLL (hsbSteicoIO.dll). The parameters are passed to this DLL, meaning the validity of the data import depends entirely on the external James Jones IFC file and the DLL's ability to parse it.",
            "cascade": [
              "pIJoistGroupName",
              "pBeamGroupName"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Structural floor joists (I-Joists) and supporting timber beams are generated based on the external IFC data.",
            "appliedTo": "New elements placed into the specific groups defined by the script parameters."
          }
        ]
      },
      "tokens_used": 3247,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via command or catalog insertion.",
          "Property values are loaded from the catalog entry using setPropValuesFromCatalog.",
          "Check insertion state: Is the script being inserted for the first time (_bOnInsert)?",
          "IF Yes (First Insertion): Check if _kExecuteKey is empty (standard insert).",
          "IF Yes: Display configuration dialog (showDialogOnce) to user.",
          "Construct path to external DLL (hsbSteicoIO.dll) located in hsbCloudStorage.",
          "Prepare input Map with parameters: pIJoistGroupName, pBeamGroupName, and profile format separator.",
          "Report the assembly path to the user (reportMessage).",
          "Call external .NET function 'ImportJamesJonesIFC' in hsbSteicoIO.dll.",
          "Retrieve result Map (IFC data/geometry instructions) and store in ModelMap (mm).",
          "ELSE (Re-calculation/update): Load state from internal _Map variable into ModelMap (mm).",
          "Configure ModelMap interpretation settings (resolve entities by handle and element number).",
          "Execute ModelMap interpretation (mm.dbInterpretMap) to generate or update geometry (GenBeams).",
          "Script self-destructs (eraseInstance) as it is a one-time import utility."
        ],
        "conditionalBranches": [
          {
            "condition": "Is this the initial insertion event? (_bOnInsert)",
            "path1": {
              "name": "Initial Import",
              "steps": [
                "Check for execute key presence.",
                "Show dialog if no execute key.",
                "Call external DLL to parse James Jones IFC file.",
                "Process returned data into ModelMap."
              ]
            },
            "path2": {
              "name": "Re-calculation",
              "steps": [
                "Load existing data from script map (_Map).",
                "Interpret map to update geometry."
              ]
            }
          },
          {
            "condition": "Is the insert command standard? (_kExecuteKey == \"\")",
            "path1": {
              "name": "Standard Insert",
              "steps": [
                "Show properties dialog to user.",
                "Proceed to DLL call."
              ]
            },
            "path2": {
              "name": "Catalog/Scripted Insert",
              "steps": [
                "Skip dialog (use catalog values).",
                "Proceed directly to DLL call."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "External DLL availability (hsbSteicoIO.dll).",
            "errorMessage": "Script failure likely to occur if file is missing at Utilities\\hsbCloudStorage\\ path.",
            "recovery": "Ensure hsbCAD installation is complete or manually place the DLL in the specified directory."
          },
          {
            "check": "Input Map structure compatibility with hsbSteicoIO.dll.",
            "errorMessage": ".NET runtime error or invalid return map.",
            "recovery": "Verify that the 'ImportJamesJonesIFC' function expects the keys 'ijoistGroupname', 'beamGroupName', and 'extProfFormatNameSplit'."
          },
          {
            "check": "IFC file validity (handled internally by DLL).",
            "errorMessage": "Potential empty or malformed ModelMap returned.",
            "recovery": "Ensure the source IFC file from James Jones software is valid and located where the DLL expects it (or the DLL prompts for it)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Imported Geometry",
            "how": "Standard AutoCAD/hsbCAD grips or properties on the generated GenBeams.",
            "effect": "The imported beams/joists become native elements; they can be moved, trimmed, or modified individually."
          },
          {
            "action": "Script Status",
            "how": "None",
            "effect": "The script instance deletes itself (eraseInstance). Re-running the import requires re-inserting the script from the catalog/command line. There is no 'update' handle left on the drawing."
          }
        ]
      },
      "tokens_used": 3547,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_JamesJonesImport.mcr\n\n## Overview\nThis script imports structural floor framing data (I-Joists and beams) generated by James Jones design software into the hsbCAD model. It processes external IFC files to generate native timber elements within the specified project groups.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script must be inserted into the Model Space to generate geometry. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not applicable for shop drawing generation. |\n\n## Prerequisites\n- **External Dependency**: The file `hsbSteicoIO.dll` must be present in the `hsbCAD\\Utilities\\hsbCloudStorage\\` directory.\n- **Source Data**: A valid IFC file exported from James Jones software is required (usually selected via a dialog during the import process).\n- **Entities**: No existing beams or entities are required to run the script.\n\n## Usage Steps\n\n### Step 1: Launch Script\n```\nCommand: TSLINSERT\nAction: Select 'hsb_JamesJonesImport.mcr' from the file dialog and click Open.\n```\n\n### Step 2: Configure Import Groups\nUpon insertion, a configuration dialog or the Properties Palette will appear allowing you to set the destination for the imported elements.\n\n```\nAction: Verify or modify the Group Names.\n- Set \"IJoist Group Name\" to where you want joists stored (e.g., \"Floor1\\I-Joists\").\n- Set \"Beam Group Name\" to where you want beams stored (e.g., \"Floor1\\Beams\").\n```\n\n### Step 3: Execute Import\n```\nAction: The script will automatically launch the external James Jones IFC importer.\nDialog: Select the source IFC file provided by the engineer/designer when prompted.\n```\n\n### Step 4: Generate Model\n```\nAction: The script processes the file and generates the GenBeams.\nResult: The structural elements appear in the 3D model and in the Project Browser under the groups specified in Step 2.\nNote: The script instance will automatically delete itself from the drawing once the import is complete.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| IJoist Group Name | text | I-Joists\\Ground_Floor | The folder path in the Project Browser where the imported I-Joists will be placed. Use backslashes (\\) to create subfolders. |\n| Beam Group Name | text | Beams\\Ground_Floor | The folder path in the Project Browser where the imported structural beams (rim joists, trimmers) will be placed. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific options to the right-click context menu. |\n\n## Settings Files\n- **None**: No specific XML settings files are used by this script. Configuration is handled via Properties and the external DLL.\n\n## Tips\n- **Script Deletion**: This script acts as a one-time utility. It automatically deletes itself (`eraseInstance`) after generating the geometry. You cannot right-click the script to update later; to re-import, you must run the `TSLINSERT` command again.\n- **Organization**: Use the `Group Name` properties to keep your model organized. For example, use `Level 01\\Joists` and `Level 01\\Beams` to separate floors.\n- **Manual Modification**: Once imported, the beams and joists are standard hsbCAD elements. You can manually grip-edit them or change their properties via the Properties Palette.\n\n## FAQ\n- **Q: The script disappeared after I ran it. Is that normal?**\n  **A:** Yes. This is a \"run-once\" import script. It creates the geometry and removes itself to prevent clutter in the drawing.\n- **Q: How do I change the material or size of the imported beams?**\n  **A:** Select the imported beams in the model and change their properties in the AutoCAD Properties Palette (Press Ctrl+1).\n- **Q: What happens if I run the script twice?**\n  **A:** It will attempt to import the data again. You may end up with duplicate elements if you do not delete the first import or if the external DLL settings create new instances rather than updating existing ones."
      },
      "tokens_used": 4910,
      "error": null
    }
  }
}