{
  "filename": "HSB_G-BeamToSheetCatalogueProps.mcr",
  "status": "completed",
  "total_tokens": 28488,
  "processing_time": 557.4402234554291,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "18.06.2013",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "10.09.2015",
            "author": "AS",
            "changes": "Add material as property to set the converted sheets."
          },
          {
            "version": "1.02",
            "date": "12-10-2023",
            "author": "RW",
            "changes": "Improved Insert CatalogProps"
          },
          {
            "version": "1.3",
            "date": "12-10-2023",
            "author": "Ronald van Wijngaarden",
            "changes": "Create the propstring sEntryName by default instead of only in the if modes. This prevents the proces which checks for the propstring to stop when calling this tsl from the tsl HSB_G-BeamToSheet with an excutionmode."
          }
        ],
        "settingsFiles": [
          "HSB-BeamToSheetCatalogue.xml"
        ],
        "dependencies": [
          "HSB_G-BeamToSheet.mcr"
        ]
      },
      "tokens_used": 4699,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No references to _Viewport, sd_, Multipage, or #Type E. Script contains _bOnInsert logic that immediately calls eraseInstance(), indicating it is a property/utility script that does not generate geometry or drawings in any specific space."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "None specific (Script erases itself on insert)",
          "requiredSettings": [
            "HSB-BeamToSheetCatalogue.xml (located in _kPathHsbCompany\\Abbund)"
          ]
        }
      },
      "tokens_used": 3114,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sEntryName",
            "type": "PropString",
            "displayName": "Beam code",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nZoneIndex",
            "type": "PropInt",
            "displayName": "Zone index",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nColorIndex",
            "type": "PropInt",
            "displayName": "Color index",
            "defaultValue": -1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "HSB-BeamToSheetCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Provides the list of Beam codes available for selection in Mode 2.",
            "required": true
          }
        ]
      },
      "tokens_used": 4801,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Provides a property interface to manage and configure beam-to-sheet connections using a predefined catalogue or custom settings.",
          "category": "Configuration/Property",
          "typicalUseCase": "Used when generating sheeting (cladding/flooring) on timber frames to select a predefined connection type from a catalogue or to manually define material, zone, and color attributes for the sheets."
        },
        "parameters": [
          {
            "name": "sEntryName",
            "technicalDefault": "",
            "businessMeaning": "The identifier for a specific beam-to-sheet configuration preset stored in the external catalogue.",
            "validRange": "String values matching keys in 'HSB-BeamToSheetCatalogue.xml'",
            "unit": "Text",
            "affectsOutput": "Determines which set of predefined rules or geometries from the main script ('HSB_G-BeamToSheet.mcr') are applied to the element."
          },
          {
            "name": "nZoneIndex",
            "technicalDefault": "0",
            "businessMeaning": "Classifies the element into a specific logical zone (e.g., fire rating zone, quality control zone, or structural segment).",
            "validRange": "0 - 10",
            "unit": "Count",
            "affectsOutput": "Filters data processing, assigns specific attributes, or influences calculation logic based on the zone's definition in the broader project context."
          },
          {
            "name": "nColorIndex",
            "technicalDefault": "-1",
            "businessMeaning": "The visual display color for the generated sheet elements in the CAD model.",
            "validRange": "-1 (ByLayer) to 255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the graphical appearance (color) of the sheets in the model view and potentially on drawings."
          },
          {
            "name": "sMaterial",
            "technicalDefault": "",
            "businessMeaning": "The specific material grade or type assigned to the sheeting (e.g., OSB, Plywood, Particleboard).",
            "validRange": "Valid material names defined in the hsbCAD catalog or manufacturer specifications.",
            "unit": "Text",
            "affectsOutput": "Assigns physical properties (density, thickness) to the sheet, impacting nesting, reports, and machining capabilities."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Script execution Mode is set to 2 (Select from Catalogue)",
            "effect": "Restricts 'sEntryName' input to a dropdown list populated from the XML file. Manual editing of Zone, Color, and Material is typically disabled or overridden by the catalogue selection.",
            "cascade": [
              "sEntryName"
            ]
          },
          {
            "trigger": "Script execution Mode is set to 3 (Edit)",
            "effect": "Locks 'sEntryName' (read-only) to preserve the preset link, but allows the user to manually modify 'nZoneIndex', 'nColorIndex', and 'sMaterial'.",
            "cascade": [
              "nZoneIndex",
              "nColorIndex",
              "sMaterial"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Data/Properties",
            "description": "This script generates no physical geometry. It creates and manages property instances that store configuration data for the parent script ('HSB_G-BeamToSheet').",
            "appliedTo": "N/A (Script erases itself upon insertion, leaving only property definitions)."
          }
        ]
      },
      "tokens_used": 5211,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch",
          "2. Check Insertion Flag (_bOnInsert)",
          "3. [Conditional] If inserting for the first time, immediately erase the instance and stop execution.",
          "4. [Conditional] If recalculating (existing instance), proceed to property initialization.",
          "5. Read Execution 'Mode' from internal Map (Default: 0 if not found).",
          "6. [Branch] Mode 1 (Add): Initialize 'sEntryName' as editable text, plus 'nZoneIndex', 'nColorIndex', and 'sMaterial' as properties.",
          "7. [Branch] Mode 2 (Select): Load 'HSB-BeamToSheetCatalogue.xml' from _kPathHsbCompany\\Abbund. Read XML keys into array. Initialize 'sEntryName' as dropdown list from array.",
          "8. [Branch] Mode 3 (Edit): Initialize 'sEntryName' as read-only text. Initialize 'nZoneIndex', 'nColorIndex', and 'sMaterial' as editable properties.",
          "9. Expose configured properties to the user via the Properties Palette (OPM)."
        ],
        "conditionalBranches": [
          {
            "condition": "Script Execution State: Insert vs. Recalculate",
            "path1": {
              "name": "Insert",
              "steps": [
                "Trigger: User inserts the script via command palette.",
                "Action: Execute eraseInstance().",
                "Result: Script terminates immediately without creating visual geometry or staying in the drawing."
              ]
            },
            "path2": {
              "name": "Recalculate/Instance Load",
              "steps": [
                "Trigger: Script is loaded or properties are modified.",
                "Action: Parse '_Map' for the 'Mode' integer.",
                "Result: Proceed to Mode-specific property setup."
              ]
            }
          },
          {
            "condition": "Execution Mode (_Map.getInt(\"Mode\"))",
            "path1": {
              "name": "Mode 1 (Add)",
              "steps": [
                "Expose 'sEntryName' (Text Input)",
                "Expose 'nZoneIndex' (Dropdown 0-10)",
                "Expose 'nColorIndex' (Integer Input)",
                "Expose 'sMaterial' (Text Input)"
              ]
            },
            "path2": {
              "name": "Mode 2 (Select from Catalogue)",
              "steps": [
                "Construct path: _kPathHsbCompany\\Abbund\\HSB-BeamToSheetCatalogue.xml",
                "Attempt to read XML file via _Map.readFromXmlFile()",
                "Iterate Map keys to populate 'arSEntryName' array",
                "Expose 'sEntryName' (Dropdown List populated from XML)"
              ]
            },
            "path3": {
              "name": "Mode 3 (Edit)",
              "steps": [
                "Expose 'sEntryName' (Read-Only Text)",
                "Expose 'nZoneIndex' (Dropdown 0-10)",
                "Expose 'nColorIndex' (Integer Input)",
                "Expose 'sMaterial' (Text Input)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "XML File Accessibility (Mode 2 only)",
            "errorMessage": "Implicit failure if _Map.readFromXmlFile returns 0 or file is missing at the constructed path.",
            "recovery": "Ensure 'HSB-BeamToSheetCatalogue.xml' exists in the company folder (\\Abbund). Script does not contain explicit error reporting, but the dropdown will likely be empty."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Properties via OPM",
            "how": "AutoCAD Properties Palette",
            "effect": "Changing 'sEntryName' (if Mode 1/2), 'nZoneIndex', 'nColorIndex', or 'sMaterial' updates the script instance state, which is likely read by a parent script (HSB_G-BeamToSheet.mcr)."
          },
          {
            "action": "Change Execution Mode",
            "how": "External script control (via _Map variable injection)",
            "effect": "Switching between Mode 2 (Select) and Mode 3 (Edit) changes the UI presented to the user (Dropdown vs Read-only + Manual Inputs)."
          }
        ]
      },
      "tokens_used": 4666,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-BeamToSheetCatalogueProps.mcr\n\n## Overview\nThis script serves as a property manager for beam-to-sheet configurations. It allows users to define connection codes, materials, and visual properties via the Properties Palette, either by selecting from a catalogue or entering manual values.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script runs here but typically erases itself immediately after execution, leaving only property definitions. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: None.\n- **Minimum Beam Count**: 0.\n- **Required Settings Files**: `HSB-BeamToSheetCatalogue.xml` (Must be located in `_kPathHsbCompany\\Abbund`).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `HSB_G-BeamToSheetCatalogueProps.mcr`.\n\n### Step 2: Execution & Property Initialization\n```\nCommand Line: (Script executes automatically)\nAction: The script will initialize and immediately erase the graphical instance. \nNote: This is normal behavior. The script is designed to create property definitions in the background without remaining as a visible object in the drawing.\n```\n\n### Step 3: Configure Properties (Via OPM)\n```\nAction: Select the relevant element (if this script is embedded) or interact via the parent script context. \nAction: Open the Properties Palette (Ctrl+1) to modify parameters.\nNote: The available fields (Text vs. Dropdown) depend on the script's internal \"Execution Mode\".\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Beam code** (`sEntryName`) | Text/Dropdown | \"\" | The identifier for the beam-to-sheet configuration. In \"Select\" mode, this is a dropdown list populated from the XML catalogue. In \"Add/Edit\" modes, this is a text field. |\n| **Zone index** (`nZoneIndex`) | Dropdown | 0 | Classifies the element into a logical zone (0-10). Used for filtering or structural organization. |\n| **Color index** (`nColorIndex`) | Integer | -1 | Sets the visual color of the sheet elements (-1 = ByLayer). |\n| **Material** (`sMaterial`) | Text | \"\" | Specifies the material grade for the sheeting (e.g., OSB, Plywood). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom items to the right-click context menu. |\n\n## Settings Files\n- **Filename**: `HSB-BeamToSheetCatalogue.xml`\n- **Location**: `_kPathHsbCompany\\Abbund`\n- **Purpose**: Stores the list of predefined Beam codes. The script reads this file to populate the dropdown options for the **Beam code** parameter when in \"Select from Catalogue\" mode.\n\n## Tips\n- **Script Behavior**: Do not be alarmed if the script disappears immediately after insertion. This is intended; it functions as a \"property definition\" script rather than a geometry generator.\n- **Mode Dependency**: The interface for the **Beam code** property changes based on the \"Mode\" passed from the calling script. If the dropdown is empty, check if the XML file exists in the correct company folder.\n- **Integration**: This script is typically used as a dependency for `HSB_G-BeamToSheet.mcr` to handle catalogue data.\n\n## FAQ\n- **Q: Why did the script vanish immediately after I ran it?**\n- **A:** This script erases its own instance upon insertion (`_bOnInsert`) because it is a utility script designed only to expose properties to the Properties Palette or to other scripts, not to create visible geometry.\n  \n- **Q: The \"Beam code\" dropdown is empty. How do I fix it?**\n- **A:** Ensure the file `HSB-BeamToSheetCatalogue.xml` exists in your hsbCAD company folder under the `Abbund` subdirectory. The script requires this file to populate the list.\n\n- **Q: Can I manually type a beam code?**\n- **A:** Yes, but only if the script is running in \"Add\" (Mode 1) or \"Edit\" (Mode 3) mode. If it is in \"Select from Catalogue\" (Mode 2) mode, you must choose from the dropdown."
      },
      "tokens_used": 5997,
      "error": null
    }
  }
}