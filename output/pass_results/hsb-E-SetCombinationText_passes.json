{
  "filename": "hsb-E-SetCombinationText.mcr",
  "status": "completed",
  "total_tokens": 27479,
  "processing_time": 260.0327925682068,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 5682,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script structure uses eraseInstance() after execution, indicating a utility/command-style script rather than a generating object. It selects existing TslInst entities ('hsb-E-Combination') using PrEntity and modifies their properties. There is no usage of _Viewport, sd_ prefixed functions, or #Type E _Entity[] arrays, which are characteristic of Paper Space or ShopDrawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "hsb-E-Combination"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing hsb-E-Combination instances",
          "requiredSettings": []
        }
      },
      "tokens_used": 3340,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select entity(s)",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "On Insert (if no execute key provided)",
            "title": "hsb-E-SetCombinationText",
            "dataSource": "Internal Properties (sText1 through sText5)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sText1",
            "type": "PropString",
            "displayName": "Text 1",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Text 1"
          },
          {
            "index": 1,
            "variable": "sText2",
            "type": "PropString",
            "displayName": "Text 2",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Text 2"
          },
          {
            "index": 2,
            "variable": "sText3",
            "type": "PropString",
            "displayName": "Text 3",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Text 3"
          },
          {
            "index": 3,
            "variable": "sText4",
            "type": "PropString",
            "displayName": "Text 4",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Text 4"
          },
          {
            "index": 4,
            "variable": "sText5",
            "type": "PropString",
            "displayName": "Text 5",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Text 5"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4791,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script used to batch-assign specific text labels or notes to existing 'hsb-E-Combination' elements (wall/floor panels) within the model.",
          "category": "Data Management / Utility",
          "typicalUseCase": "When a user needs to populate custom text fields (e.g., manufacturing notes, quality control tags, or specific assembly instructions) on multiple panel elements simultaneously without editing each one individually."
        },
        "parameters": [
          {
            "name": "sText1",
            "technicalDefault": "",
            "businessMeaning": "The value to be written into the first available text property of the target Combination/Panel.",
            "validRange": "Any alphanumeric string up to the system limit.",
            "unit": "String",
            "affectsOutput": "Updates the 'Text 1' property on the target hsb-E-Combination entity. This data is typically used for labeling, scheduling, or filtering elements in production lists."
          },
          {
            "name": "sText2",
            "technicalDefault": "",
            "businessMeaning": "The value to be written into the second available text property of the target Combination/Panel.",
            "validRange": "Any alphanumeric string up to the system limit.",
            "unit": "String",
            "affectsOutput": "Updates the 'Text 2' property on the target hsb-E-Combination entity for downstream reporting or labeling."
          },
          {
            "name": "sText3",
            "technicalDefault": "",
            "businessMeaning": "The value to be written into the third available text property of the target Combination/Panel.",
            "validRange": "Any alphanumeric string up to the system limit.",
            "unit": "String",
            "affectsOutput": "Updates the 'Text 3' property on the target hsb-E-Combination entity."
          },
          {
            "name": "sText4",
            "technicalDefault": "",
            "businessMeaning": "The value to be written into the fourth available text property of the target Combination/Panel.",
            "validRange": "Any alphanumeric string up to the system limit.",
            "unit": "String",
            "affectsOutput": "Updates the 'Text 4' property on the target hsb-E-Combination entity."
          },
          {
            "name": "sText5",
            "technicalDefault": "",
            "businessMeaning": "The value to be written into the fifth available text property of the target Combination/Panel.",
            "validRange": "Any alphanumeric string up to the system limit.",
            "unit": "String",
            "affectsOutput": "Updates the 'Text 5' property on the target hsb-E-Combination entity."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Target Entity Property Availability",
            "effect": "The script checks if the target hsb-E-Combination instance already has content in its internal text slots (indices 90-94). The assignment (sText1-5) only occurs if the target slot is already initialized (length > 0). This prevents writing data to undefined or unused property slots.",
            "cascade": [
              "sText1",
              "sText2",
              "sText3",
              "sText4",
              "sText5"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Attribute Update",
            "description": "Modifies string properties of selected hsb-E-Combination instances. Does not create geometry.",
            "appliedTo": "hsb-E-Combination entities (Panels/Walls)"
          }
        ]
      },
      "tokens_used": 3984,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched (command or catalog execution)",
          "Check for execution key (silent mode) or dialog mode",
          "Branch: If key exists, load catalog properties; else, show dialog to input text values (sText1-5)",
          "User input properties (sText1 through sText5) are stored in memory",
          "Prompt user to select entity(s) (PrEntity) of type TslInst",
          "Filter selected entities: Only instances of 'hsb-E-Combination' are accepted",
          "Loop through each valid 'hsb-E-Combination' entity",
          "Check target entity property slots (indices 90-94) for existing initialization (length > 0)",
          "Assign sText1-5 to target entity properties if corresponding slots are initialized and source text is not empty",
          "Script erases its own instance from the model (eraseInstance)",
          "Execution completes"
        ],
        "conditionalBranches": [
          {
            "condition": "Execution Key (_kExecuteKey) provided?",
            "path1": {
              "name": "Silent/Catalog Mode",
              "steps": [
                "Check if key exists in current script's catalog list",
                "If match found: Set properties from that catalog entry",
                "If no match: Set properties from '|_LastInserted|' catalog entry",
                "Skip visual dialog interaction"
              ]
            },
            "path2": {
              "name": "Interactive Dialog Mode",
              "steps": [
                "Execute showDialog()",
                "User manually enters sText1 through sText5 values",
                "Proceed to entity selection"
              ]
            }
          },
          {
            "condition": "Entity Validation (Is hsb-E-Combination?)",
            "path1": {
              "name": "Valid Entity",
              "steps": [
                "Process text assignments based on property validation",
                "Update target entity properties",
                "Include in final set"
              ]
            },
            "path2": {
              "name": "Invalid Entity",
              "steps": [
                "Remove entity from selection array",
                "Skip processing"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Script Name",
            "errorMessage": "No explicit error message shown to user, entity is simply filtered out.",
            "recovery": "User must select a valid 'hsb-E-Combination' instance."
          },
          {
            "check": "Target Property Initialization (Indices 90-94)",
            "errorMessage": "None (silent skip)",
            "recovery": "If target property slot is empty (length 0), the script does NOT write the value. The target Combination must have pre-existing properties (e.g., initialized in its own script) to accept these values."
          },
          {
            "check": "Source Property Content",
            "errorMessage": "None",
            "recovery": "If sText1-5 inputs are empty, no assignment occurs for that specific field."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None",
            "how": "N/A",
            "effect": "The script uses eraseInstance() immediately after execution. It does not remain in the model to be edited via OPM or context menus."
          }
        ]
      },
      "tokens_used": 4589,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb-E-SetCombinationText\n\n## Overview\nThis script allows you to batch-assign custom text labels (Text 1 through Text 5) to existing Combination elements (walls or floors) in your model. It is a utility tool that updates the properties of selected elements without creating new geometry.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates here and selects existing `hsb-E-Combination` entities. |\n| Paper Space | No | Not designed for layout views or detailing. |\n| Shop Drawing | No | Not intended for manufacturing drawings. |\n\n## Prerequisites\n- **Required entities**: `hsb-E-Combination` instances (e.g., walls or floors) must exist in the model.\n- **Note**: The target Combination elements must have their text properties initialized (already containing data or defined) for the script to update them successfully. If a target text slot is completely empty/uninitialized, the script will skip updating that specific slot.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb-E-SetCombinationText.mcr`\n\n### Step 2: Input Text Values\n```\nDialog: \"hsb-E-SetCombinationText\"\nAction: A dialog window will appear prompting you to enter text strings.\n```\n- Enter the desired text into fields **Text 1** through **Text 5**.\n- Leave fields empty if you do not wish to update that specific slot.\n- Click **OK** to confirm.\n\n*(Note: If you run the script from a catalog entry with saved settings, this dialog may be skipped, and the saved values will be used automatically.)*\n\n### Step 3: Select Entities\n```\nCommand Line: Select entity(s)\nAction: Click on the Combination elements (walls/floors) you wish to update.\n```\n- You can select multiple entities at once.\n- Only valid `hsb-E-Combination` instances will be processed.\n\n### Step 4: Completion\nThe script updates the properties of the selected entities and automatically removes itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Text 1 | Text | Empty | The text string to assign to the \"Text 1\" property of the selected element. |\n| Text 2 | Text | Empty | The text string to assign to the \"Text 2\" property of the selected element. |\n| Text 3 | Text | Empty | The text string to assign to the \"Text 3\" property of the selected element. |\n| Text 4 | Text | Empty | The text string to assign to the \"Text 4\" property of the selected element. |\n| Text 5 | Text | Empty | The text string to assign to the \"Text 5\" property of the selected element. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script erases itself immediately after execution and does not remain in the model for editing. |\n\n## Settings Files\nNone required. The script uses its internal properties or catalog presets for configuration.\n\n## Tips\n- **Batch Processing**: You can select multiple walls or floors in a single run to apply the same labels (e.g., \"Phase 1\" or \"Quality Check\") to a group of elements.\n- **Catalog Usage**: Save your script properties in a Catalog if you frequently use the same set of texts. Running the script from the catalog will bypass the dialog and speed up the workflow.\n- **Property Initialization**: Ensure the Combination elements you are targeting actually have the specific text properties active. If the script seems to fail, check if the text fields on the element are currently empty or not defined in the element's own script.\n\n## FAQ\n- **Q: Why didn't the text update on my element?**\n  **A**: The script is designed to only update text slots that are already initialized (contain existing data) on the target Combination element. If the target field is completely blank or undefined, the script will skip it to avoid errors. You may need to manually initialize the property on the element first.\n- **Q: Can I undo this action?**\n  **A**: Yes, you can use the standard AutoCAD `UNDO` command to revert the property changes if needed.\n- **Q: Does this script work on single beams?**\n  **A**: No, this script is designed specifically for `hsb-E-Combination` entities (panels/walls), not individual beams."
      },
      "tokens_used": 5093,
      "error": null
    }
  }
}