{
  "filename": "HSB_R-CoverStrips.mcr",
  "status": "completed",
  "total_tokens": 54611,
  "processing_time": 307.0207576751709,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \"minorVersion\": 4,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.00"
      },
      "tokens_used": 9008,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_* or Multipage* prefix found. Uses _Sheet, _Element, GenBeam, and ElementWallSF which are Model Space entities. No references to Viewport or sd* APIs. Operates directly on 3D geometry (ElemRoofs, ElementWallSF) and creates Sheets."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElemRoof",
            "ElementWallSF",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing roof or wall elements with sheeting",
          "requiredSettings": []
        }
      },
      "tokens_used": 5462,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert && ( _kExecuteKey == \"\" || sCatalogNames.find(_kExecuteKey) == -1 )",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity.go (Select cover strips to remove/color)",
              "promptOriginal": "|Select cover strips to remove/color (as sheeting)|",
              "condition": "_bOnInsert && nAction > 0",
              "required": true
            },
            {
              "step": 3,
              "function": "PrEntity.go (Select entities)",
              "promptOriginal": "|Select entities|",
              "condition": "_bOnInsert && nAction == 0",
              "required": true
            },
            {
              "step": 4,
              "function": "getPoint",
              "promptOriginal": null,
              "condition": "_bOnInsert && bDebug",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Insertion (if no catalog key used)",
            "title": null,
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sAction",
            "type": "PropString",
            "displayName": "|Action|",
            "defaultValue": "|Create/replace|",
            "inputType": "dropdown",
            "options": [
              "|Create/replace|",
              "|Remove|",
              "|Change color|"
            ],
            "category": "|Manager|",
            "description": null
          },
          {
            "index": 1,
            "variable": "dMaxGap",
            "type": "PropDouble",
            "displayName": "|Max gap|",
            "defaultValue": "U(18)",
            "inputType": "number",
            "options": [],
            "category": "|Manager|",
            "description": "|Max separation between roof elements|"
          },
          {
            "index": 2,
            "variable": "dStripWidth",
            "type": "PropDouble",
            "displayName": "|Width|",
            "defaultValue": "U(45)",
            "inputType": "number",
            "options": [],
            "category": "|Strip|",
            "description": null
          },
          {
            "index": 3,
            "variable": "dStripThickness",
            "type": "PropDouble",
            "displayName": "|Thickness|",
            "defaultValue": "U(11)",
            "inputType": "number",
            "options": [],
            "category": "|Strip|",
            "description": null
          },
          {
            "index": 4,
            "variable": "nColorStrip",
            "type": "PropInt",
            "displayName": "|Color|",
            "defaultValue": "U(-1)",
            "inputType": "number",
            "options": [],
            "category": "|Strip|",
            "description": "|Taken from sheeting if -1|"
          },
          {
            "index": 5,
            "variable": "sBeamCode",
            "type": "PropString",
            "displayName": "|Beam code|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Strip|",
            "description": null
          },
          {
            "index": 6,
            "variable": "beamFilterDefinition",
            "type": "PropString",
            "displayName": "|Filter definition for beams|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": "filterDefinitions (from HSB_G-FilterGenBeams catalog)",
            "category": "|Filter Beams|",
            "description": "|Filter definition for beams.| |Use| HSB_G-FilterGenBeams |to define the filters|.|NOTE|: |This value gets overwriten by <Beam codes to filter> (if any set)|"
          },
          {
            "index": 7,
            "variable": "beamCodesToFilter",
            "type": "PropString",
            "displayName": "|Beam codes to filter|",
            "defaultValue": "OSP-01;OSP-02",
            "inputType": "text",
            "options": [],
            "category": "|Filter Beams|",
            "description": "|Filter beams with these beam codes.| |NOTE|: |This value overrides the filter definition|"
          },
          {
            "index": 8,
            "variable": "sWallCodesToFilter",
            "type": "PropString",
            "displayName": "|Wall codes|",
            "defaultValue": "KN",
            "inputType": "text",
            "options": [],
            "category": "|Filter Walls|",
            "description": null
          },
          {
            "index": 9,
            "variable": "sGroupNameProp",
            "type": "PropString",
            "displayName": "|Group|",
            "defaultValue": "|Don't assign|",
            "inputType": "dropdown",
            "options": "arSNameGroup (Alphabetical list of all existing groups)",
            "category": "|Group|",
            "description": null
          },
          {
            "index": 10,
            "variable": "sSelectedZone",
            "type": "PropString",
            "displayName": "     |Zone|",
            "defaultValue": "6",
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10"
            ],
            "category": "|Group|",
            "description": null
          },
          {
            "index": 11,
            "variable": "sZoneCharacter",
            "type": "PropString",
            "displayName": "     Zone character",
            "defaultValue": "'Z' for general items",
            "inputType": "dropdown",
            "options": [
              "'E' for element tools",
              "'Z' for general items",
              "'T' for beam tools",
              "'I' for information",
              "'C' for construction",
              "'D' for dimension"
            ],
            "category": "|Group|",
            "description": null
          },
          {
            "index": 12,
            "variable": "sExclusive",
            "type": "PropString",
            "displayName": "     Add exclusive",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": "|Group|",
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Delete And Remove Strips|",
            "handler": "sCustomCommandDeleteAndRemoveStrips",
            "action": "Sets bDeleteMyself flag to true, which erases the instance.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "HSB_G-FilterGenBeams",
            "searchPaths": [
              "Tsl Catalogs"
            ],
            "purpose": "Provides filter definitions used to select beams for covering.",
            "required": false
          }
        ]
      },
      "tokens_used": 8973,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates, replaces, removes, or recolors timber cover strips (sheeting) over gaps between roof elements, around dormer openings, and over specific beams or knee walls.",
          "category": "Framing/Sheeting",
          "typicalUseCase": "Used during the detailing phase to ensure watertightness and aesthetics by covering joints between structural roof panels, dormers, and timber members with finishing strips."
        },
        "parameters": [
          {
            "name": "sAction",
            "technicalDefault": "|Create/replace|",
            "businessMeaning": "Selects the operation mode: generating new strips, removing existing strips created by this tool, or changing the color of existing strips.",
            "validRange": "Dropdown: Create/replace, Remove, Change color",
            "unit": "N/A",
            "affectsOutput": "Determines whether new geometry is created, existing geometry is erased, or properties of existing geometry are modified."
          },
          {
            "name": "dMaxGap",
            "technicalDefault": "U(18)",
            "businessMeaning": "The maximum distance between adjacent roof elements or sheets that will trigger the insertion of a cover strip.",
            "validRange": "0mm to 200mm",
            "unit": "mm",
            "affectsOutput": "Controls the frequency and placement of strips. Larger values result in fewer strips; smaller values fill smaller gaps."
          },
          {
            "name": "dStripWidth",
            "technicalDefault": "U(45)",
            "businessMeaning": "The visible width (coverage) of the cover strip perpendicular to its length.",
            "validRange": "20mm to 200mm",
            "unit": "mm",
            "affectsOutput": "Directly scales the width of the generated sheet bodies."
          },
          {
            "name": "dStripThickness",
            "technicalDefault": "U(11)",
            "businessMeaning": "The material thickness of the cover strip (usually matching standard sheathing thickness).",
            "validRange": "6mm to 40mm",
            "unit": "mm",
            "affectsOutput": "Directly scales the thickness of the generated sheet bodies."
          },
          {
            "name": "nColorStrip",
            "technicalDefault": "U(-1)",
            "businessMeaning": "The CAD display color index for the strips. -1 inherits the color from the adjacent sheeting.",
            "validRange": "Integer (typically 1-255, or -1)",
            "unit": "Index",
            "affectsOutput": "Changes the visual color of the generated strips in the model; does not affect geometry."
          },
          {
            "name": "sBeamCode",
            "technicalDefault": "",
            "businessMeaning": "Assigns a specific material/production code to the generated strips. If left blank, it inherits the code from the reference sheet.",
            "validRange": "Text (e.g., 'BOARD-18')",
            "unit": "Text",
            "affectsOutput": "Updates the 'BeamCode' property of the generated Sheet entities, used for bills of materials and production."
          },
          {
            "name": "beamFilterDefinition",
            "technicalDefault": "",
            "businessMeaning": "Selects a predefined set of criteria (from the Filter catalog) to identify which beams should be covered by strips.",
            "validRange": "Dropdown (Dynamic list from HSB_G-FilterGenBeams)",
            "unit": "N/A",
            "affectsOutput": "Determines which beams in the model are treated as targets for cover strips."
          },
          {
            "name": "beamCodesToFilter",
            "technicalDefault": "OSP-01;OSP-02",
            "businessMeaning": "A semi-colon separated list of specific beam codes to target for covering. Overrides the generic filter definition.",
            "validRange": "Text (e.g., 'PURLIN;RAFTER')",
            "unit": "Text",
            "affectsOutput": "Refines the selection of beams; strips are only created over beams matching these codes."
          },
          {
            "name": "sWallCodesToFilter",
            "technicalDefault": "KN",
            "businessMeaning": "Identifies specific wall types (by code) that require cover strips, typically used for knee walls or attic walls.",
            "validRange": "Text (e.g., 'KN;ATTIC')",
            "unit": "Text",
            "affectsOutput": "Enables strip generation on wall elements matching these codes."
          },
          {
            "name": "sGroupNameProp",
            "technicalDefault": "|Don't assign|",
            "businessMeaning": "Assigns the generated strips to a specific logical group for grouping, filtering, or exporting purposes.",
            "validRange": "Dropdown (Existing groups in the project)",
            "unit": "N/A",
            "affectsOutput": "Adds the generated entities to the specified Group entity."
          },
          {
            "name": "sSelectedZone",
            "technicalDefault": "6",
            "businessMeaning": "Defines the specific manufacturing zone (0-10) within the selected group where the strips will be categorized.",
            "validRange": "0 to 10",
            "unit": "Index",
            "affectsOutput": "Sets the zone attribute for the generated strips within the group."
          },
          {
            "name": "sZoneCharacter",
            "technicalDefault": "'Z' for general items",
            "businessMeaning": "Classifies the strips by type (Element, General, Beam, Info, Construction, Dimension) for reporting or layer management.",
            "validRange": "Dropdown (E, Z, T, I, C, D)",
            "unit": "Character",
            "affectsOutput": "Sets the character attribute for the generated strips within the group."
          },
          {
            "name": "sExclusive",
            "technicalDefault": "|Yes|",
            "businessMeaning": "Determines if the strips are added exclusively to this group/zone, preventing them from appearing in other automatic groupings.",
            "validRange": "Dropdown: No, Yes",
            "unit": "N/A",
            "affectsOutput": "Controls group membership behavior (Exclusive vs. Non-exclusive)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "beamCodesToFilter is not empty",
            "effect": "Overrides the beamFilterDefinition selection, ignoring the generic filter in favor of the explicit codes provided.",
            "cascade": [
              "beamFilterDefinition"
            ]
          },
          {
            "trigger": "sAction is set to |Remove| or |Change color|",
            "effect": "Disables parameters related to geometry creation (Width, Thickness, BeamCode) as they are irrelevant for deletion or recoloring.",
            "cascade": [
              "dStripWidth",
              "dStripThickness",
              "sBeamCode",
              "dMaxGap"
            ]
          },
          {
            "trigger": "sGroupNameProp is set to |Don't assign|",
            "effect": "Disables the Zone, Zone Character, and Exclusive parameters as grouping is not active.",
            "cascade": [
              "sSelectedZone",
              "sZoneCharacter",
              "sExclusive"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet",
            "description": "Rectangular timber boards created to cover gaps between roof elements, around dormers, and over filtered beams/walls. Properties (Type, Label, Material, etc.) are inherited from adjacent sheets unless overridden.",
            "appliedTo": "Model Space (Roof Elements, Walls, GenBeams)"
          },
          {
            "type": "Group",
            "description": "If specified, the generated strips are added to the selected construction group for organization and export.",
            "appliedTo": "Model Space"
          }
        ]
      },
      "tokens_used": 10376,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Execution Start",
          "Check for Debug Mode (hsbTSLDev controller or _bOnDebug)",
          "Check if inserting via Catalog Entry (_kExecuteKey)",
          "[Insert Mode] If Catalog Key Found: Load properties from catalog",
          "[Insert Mode] If No Catalog Key: Show Dynamic Dialog (ShowDynamicDialog)",
          "[Insert Mode] Save current properties to '_LastInserted' catalog",
          "[Insert Mode] Determine Action from 'sAction' property (Create/Replace vs Remove/Color)",
          "[Branch: Remove/Color] Prompt user to select existing cover strips (PrEntity)",
          "[Branch: Remove/Color] Process selection: Erase (if Remove) or Recolor (if Color)",
          "[Branch: Remove/Color] Report count of affected strips",
          "[Branch: Remove/Color] Erase Script Instance and Exit",
          "[Branch: Create/Replace] Prompt user to select target entities (PrEntity) - Roofs, Beams, Walls",
          "[Optional Debug] Prompt for reference point (getPoint)",
          "Set '_Map' flag 'ManualInserted' to true and Exit Insertion",
          "[Recalculation/DbCreated] Load properties from '_LastInserted' catalog if manual insert",
          "Resolve Grouping properties (Group name, Zone, Character, Exclusive)",
          "Prepare Filter: Determine if using explicit Beam Codes or Filter Definitions",
          "Execute Search: Identify existing cover strips in the model (by SubMapX) and delete them",
          "Execute Search: Find Roof Elements in selection",
          "Execute Search: Filter GenBeams in selection by Beam Code or Filter Definition",
          "Execute Search: Filter ElementWallSF (Knee Walls) in selection by Wall Code",
          "[Roof Logic] Collect sheets from Roofs and User Selection",
          "[Roof Logic] Find gaps between roof elements (projected on local X/Y)",
          "[Roof Logic] Find gaps between sheets within the same roof element",
          "[Roof Logic] Find contours of dormer openings within roof elements",
          "[Roof Logic] Generate strip geometry for detected gaps/openings",
          "[Beam Logic] Iterate filtered beams",
          "[Beam Logic] Find sheets adjacent to beams (within thickness tolerance)",
          "[Beam Logic] Filter beams: Keep only if sheet gap is on the beam's edge (not internal)",
          "[Beam Logic] Generate strip geometry over valid beams",
          "[Wall Logic] Iterate filtered knee walls",
          "[Wall Logic] Calculate sheet split points based on sheet extremes",
          "[Wall Logic] Generate strip geometry for vertical splits on walls",
          "[Deduplication] Compare all generated strip centers; remove duplicates within width tolerance",
          "Assign Script Instance to Group (if group selected)",
          "Loop through all valid strip data points",
          "Create Sheet Body (Body) with specified Width, Thickness, and orientation",
          "Create Sheet Entity (Sheet.dbCreate)",
          "Inherit properties from reference sheet (Type, Label, Material, etc.)",
          "Override BeamCode if 'sBeamCode' property is set",
          "Set Color (from property or reference sheet)",
          "Write 'CoverStripsInfo' to SubMapX to identify strip as managed",
          "Assign Sheet Entity to Group (if group selected)",
          "Report Summary: Total strips created (Roofs, Beams, Walls) and Deleted",
          "[Cleanup] Erase Script Instance (unless in Debug Mode)",
          "Execution End"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Trigger Method",
            "path1": {
              "name": "Catalog Entry",
              "steps": [
                "Detect _kExecuteKey in available catalogs",
                "Apply preset properties from catalog",
                "Skip Dialog"
              ]
            },
            "path2": {
              "name": "Manual/Toolbar Launch",
              "steps": [
                "_kExecuteKey is empty or invalid",
                "Show Dynamic Dialog",
                "User confirms settings",
                "Proceed to Action selection"
              ]
            }
          },
          {
            "condition": "Action Property Selection",
            "path1": {
              "name": "Create/Replace",
              "steps": [
                "Prompt for Roof/Beam/Wall entities",
                "Calculate gaps and geometry",
                "Create new Sheets",
                "Delete existing managed strips found in selection area"
              ]
            },
            "path2": {
              "name": "Remove",
              "steps": [
                "Prompt for existing Sheet entities",
                "Filter by SubMapX 'coverstrip'",
                "Erase identified Sheets",
                "Report count",
                "Exit Script"
              ]
            },
            "path3": {
              "name": "Change Color",
              "steps": [
                "Prompt for existing Sheet entities",
                "Filter by SubMapX 'coverstrip'",
                "Update Color property",
                "Report count",
                "Exit Script"
              ]
            }
          },
          {
            "condition": "Beam Filtering Method",
            "path1": {
              "name": "Explicit Codes",
              "steps": [
                "Check if 'beamCodesToFilter' is not empty",
                "Parse semi-colon separated codes",
                "Select Beams matching BeamCode property exactly",
                "Ignore 'beamFilterDefinition'"
              ]
            },
            "path2": {
              "name": "Filter Definition",
              "steps": [
                "'beamCodesToFilter' is empty",
                "Load catalog 'HSB_G-FilterGenBeams'",
                "Use logic defined in selected filter catalog entry",
                "Select Beams based on filter criteria"
              ]
            }
          },
          {
            "condition": "Debug Mode",
            "path1": {
              "name": "Debug Active",
              "steps": [
                "Visualize intermediate geometry (Sheet bodies, Points)",
                "Visualize strip colors based on origin (Roof, Beam, Wall, Dormer)",
                "Keep Script Instance in model (do not erase)",
                "Draw dynamic debug lines at origin"
              ]
            },
            "path2": {
              "name": "Production Mode",
              "steps": [
                "Create clean geometry",
                "Set final colors",
                "Erase Script Instance from model immediately",
                "Leave only generated Sheets"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Roof/Wall Elements must have valid sheeting in the specified zone",
            "errorMessage": "None explicitly coded in script, but strips will not be generated if shAll.length() == 0.",
            "recovery": "Ensure selected elements have sheeting assigned."
          },
          {
            "check": "Gap calculation safety lock",
            "errorMessage": "Safelock broken searching strip locations on knee walls",
            "recovery": "Indicates a logic loop exceeding 100 iterations; check geometry or report to developer."
          },
          {
            "check": "Insert Cycle Count",
            "errorMessage": "Script silently erases itself if insertCycleCount() > 1",
            "recovery": "Normal behavior to prevent multiple instances during a single command invocation."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Delete And Remove Strips (Context Menu)",
            "how": "Right-click on script instance (if Debug mode keeps it) or via specific command trigger.",
            "effect": "Sets bDeleteMyself=true. If instance still exists, it erases itself. Note: Generated strips remain unless removed via 'Remove' action."
          },
          {
            "action": "Modify Properties (OPM)",
            "how": "Select generated Strips (Sheets) and edit properties in AutoCAD Properties Palette.",
            "effect": "Can change Material, Dimensions, or other standard sheet properties. However, these strips are marked with 'coverstrip' type, making them targets for future runs of this script (e.g., 'Remove' action)."
          },
          {
            "action": "Re-run Script (Create/Replace)",
            "how": "Launch script again over the same area.",
            "effect": "Script detects existing strips (via SubMapX), deletes them, and regenerates based on new parameters."
          }
        ]
      },
      "tokens_used": 12094,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_R-CoverStrips\n\n## Overview\nThis script automatically generates timber cover strips (sheeting) over gaps between roof elements, around dormer openings, and over specific beams or knee walls. It also provides options to remove or recolor existing strips created by this tool.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Operates on 3D roof elements, walls, and beams. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | Not applicable for generating 2D drawings directly. |\n\n## Prerequisites\n- **Required Entities**: Roof elements (`ElemRoof`), Wall elements (`ElementWallSF`), or Beams (`GenBeam`) must be present in the model.\n- **Sheeting**: The selected elements must have sheeting (e.g., OSB, Plywood) already assigned to calculate gaps and boundaries.\n- **Settings Files**: `HSB_G-FilterGenBeams` (Optional, used only if applying advanced beam filters).\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT` â†’ Select `HSB_R-CoverStrips.mcr` from the catalog list.\n\n### Step 2: Configure Settings (Dialog)\nUpon launch, a properties dialog appears.\n1.  **Action**: Choose what you want to do:\n    *   **Create/replace**: Generates new strips or updates existing ones in the selection.\n    *   **Remove**: Deletes strips previously generated by this script.\n    *   **Change color**: Updates the visual color of existing strips.\n2.  **Dimensions**: Set the Strip Width and Thickness (if creating).\n3.  **Filters**: Specify Beam Codes or Wall Codes to limit where strips are generated.\n4.  Click **OK** to confirm.\n\n### Step 3: Select Entities\nThe command line prompt changes based on your selected Action:\n\n*   **If Create/replace:**\n    ```\n    Command Line: Select entities\n    Action: Click on Roof elements, Walls, or Beams. Press Enter to finish selection.\n    ```\n*   **If Remove or Change color:**\n    ```\n    Command Line: Select cover strips to remove/color (as sheeting)\n    Action: Click on the existing cover strips (sheeting entities). Press Enter to finish.\n    ```\n\n### Step 4: Processing\nThe script calculates gaps, generates geometry, and assigns properties. Once complete, the script instance usually removes itself from the model, leaving only the new cover strips.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Action** | dropdown | Create/replace | Determines the operation: Create new strips, Remove existing ones, or Change color. |\n| **Max gap** | number | 18 mm | The maximum distance between roof elements that will trigger a cover strip. Larger gaps are ignored. |\n| **Width** | number | 45 mm | The width of the cover strip perpendicular to its length. |\n| **Thickness** | number | 11 mm | The material thickness of the cover strip. |\n| **Color** | number | -1 | Display color of the strip. Set to -1 to inherit the color from the adjacent sheeting. |\n| **Beam code** | text | (Empty) | Assigns a specific production/material code to the generated strips. If empty, inherits from the reference sheet. |\n| **Filter definition for beams** | dropdown | (Empty) | Selects a predefined filter set (from HSB_G-FilterGenBeams) to choose which beams to cover. |\n| **Beam codes to filter** | text | OSP-01;OSP-02 | A list of specific beam codes to cover (e.g., \"PURLIN;RAFTER\"). **Note:** This overrides the Filter definition above. |\n| **Wall codes** | text | KN | Filters wall elements (e.g., knee walls) by their code to generate vertical strips. |\n| **Group** | dropdown | Don't assign | Assigns the generated strips to a specific construction group for organization. |\n| **Zone** | dropdown | 6 | Assigns a manufacturing zone (0-10) if a Group is selected. |\n| **Zone character** | dropdown | 'Z' for general items | Categorizes the strips within the group (e.g., Element, General, Beam). |\n| **Add exclusive** | dropdown | Yes | If Yes, strips are added exclusively to the specified group/zone. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Delete And Remove Strips** | Removes the script instance from the model. (Note: This does not automatically delete the generated strips unless the script logic specifically includes it during the deletion process; usually used to clean up the script marker if it persists). |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: Tsl Catalogs\n- **Purpose**: Defines complex logic for selecting beams based on properties other than just the Beam Code (e.g., height, position, name).\n\n## Tips\n- **Rerunning for Updates**: If you change design parameters (like strip width), simply run the \"Create/replace\" action on the same area again. The script will automatically delete the old strips it created and generate new ones.\n- **Filtering**: Use `Beam codes to filter` if you only want to cover specific elements (like purlins). Leave it empty to rely on the broader filter definitions.\n- **Visual Check**: Set `Color` to a distinct value (e.g., Red) temporarily when troubleshooting to ensure strips are placed exactly where expected.\n\n## FAQ\n- **Q: Why did no strips generate on my roof?**\n  A: Check the `Max gap` setting. If the gap between your roof panels is smaller than this value, no strip will be created. Also, ensure the roof elements actually have sheeting assigned.\n- **Q: What is the difference between \"Filter definition\" and \"Beam codes to filter\"?**\n  A: \"Beam codes to filter\" is a direct text match and takes priority. If you enter anything there, the \"Filter definition\" is ignored.\n- **Q: Can I edit the strips after they are created?**\n  A: Yes, you can select the generated sheets and edit them like normal hsbCAD sheets (move, stretch, change material). However, if you run the script again in \"Create/replace\" mode, it may overwrite your manual changes."
      },
      "tokens_used": 8698,
      "error": null
    }
  }
}