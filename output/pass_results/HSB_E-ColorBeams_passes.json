{
  "filename": "HSB_E-ColorBeams.mcr",
  "status": "completed",
  "total_tokens": 23608,
  "processing_time": 916.7166407108307,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 2,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This changes the properties of beams/sheets based on a ruleset",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "25.09.2013",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "09.10.2013",
            "author": "AS",
            "changes": "TSL can now be attached to element definition."
          },
          {
            "version": "1.02",
            "date": "03.03.2014",
            "author": "AS",
            "changes": "TSL now works with a catalogue."
          }
        ],
        "settingsFiles": [
          "HSB-ColorBeamsCatalogue.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 4797,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses `_kModelSpace` explicitly in `tsl.dbCreate`. Logic operates on `Element` and `GenBeam` objects (3D model entities) to modify visual properties (Color) and Element Groups. No `sd_` functions, `_Viewport` usage, or 2D drawing generation logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB-ColorBeamsCatalogue.xml (in _kPathHsbCompany\\Abbund)"
          ]
        }
      },
      "tokens_used": 3108,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "reportNotice",
            "trigger": "Catalog file not found",
            "title": null,
            "dataSource": "Internal String",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "HSB-ColorBeamsCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Stores the mapping between Beam Codes, Colors, and Zone Indices",
            "required": true
          }
        ]
      },
      "tokens_used": 5260,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically assigns visual colors and element group zones to beams based on their specific beam codes, using an external XML catalog to define the mapping logic.\",\n    \"category\": \"Data Management/Visualization\",\n    \"typicalUseCase\": \"Tagging beams with different colors for visual clarity in the model or shop drawings, and sorting them into specific production zones (e.g., 'Studs' in Zone 1, 'Plates' in Zone 2) without manually editing each beam.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"ssE\",\n      \"technicalDefault\": \"Empty Selection\",\n      \"businessMeaning\": \"The set of structural elements (walls, floors, roofs) selected by the user to be processed. This defines the scope of the script's operations.\",\n      \"validRange\": \"Any valid hsbCAD Element in Model Space\",\n      \"unit\": \"Selection Set\",\n      \"affectsOutput\": \"Determines which elements are scanned. Beams belonging to unselected elements remain unchanged.\"\n    },\n    {\n      \"name\": \"arSBmCode\",\n      \"technicalDefault\": \"Empty (Loaded from HSB-ColorBeamsCatalogue.xml)\",\n      \"businessMeaning\": \"The list of Beam Codes (e.g., 'WAL.50', 'FLR.200') that act as triggers. If a beam's code matches an entry in this list, the script applies the associated properties.\",\n      \"validRange\": \"Any string defined in the XML catalog matching existing beam naming conventions\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Acts as the filter criteria. Beams with codes not in this list are skipped during processing.\"\n    },\n    {\n      \"name\": \"arNColorBmCode\",\n      \"technicalDefault\": \"0 (Loaded from HSB-ColorBeamsCatalogue.xml)\",\n      \"businessMeaning\": \"The AutoCAD color index to apply to matching beams. Used for visual identification on screen and in plots.\",\n      \"validRange\": \"1-255 (Standard AutoCAD Color Index)\",\n      \"unit\": \"Integer Index\",\n      \"affectsOutput\": \"Changes the visual appearance of the beam in the model and drawing views.\"\n    },\n    {\n      \"name\": \"arNZoneIndexBmCode\",\n      \"technicalDefault\": \"0 (Loaded from HSB-ColorBeamsCatalogue.xml)\",\n      \"businessMeaning\": \"The specific Element Group (Zone) index to assign the beam to. This is critical for sorting and organizing data in production"
      },
      "tokens_used": 6427,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-ColorBeams\n\n## Overview\nThis script automates the assignment of visual colors and production zones (Element Groups) to beams based on their specific Beam Codes. It reads a mapping from an external XML catalog to apply consistent styling and sorting data across selected structural elements.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script operates on 3D model elements (Walls, Floors, Roofs). |\n| Paper Space | No | Not designed for 2D layout or drawing views. |\n| Shop Drawing | No | Not applicable within shop drawing contexts. |\n\n## Prerequisites\n- **Required Entities**: Structural Elements (Walls, Floors, or Roofs) containing beams.\n- **Minimum Beam Count**: 0 (An element can be selected even if it is currently empty).\n- **Required Settings**: \n  - `HSB-ColorBeamsCatalogue.xml` must exist in the `hsbCompany\\Abbund` folder.\n\n## Usage Steps\n\n### Step 1: Launch Script\nExecute the command `TSLINSERT` in the AutoCAD command line and select `HSB_E-ColorBeams.mcr` from the file dialog.\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the structural Elements (Walls, Floors, Roofs) you wish to process and press Enter.\n```\n*Note: The script will scan all beams contained within the selected elements.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script has no editable parameters in the Properties Palette. All logic is derived from the external XML catalog. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | No custom context menu options are added by this script. |\n\n## Settings Files\n- **Filename**: `HSB-ColorBeamsCatalogue.xml`\n- **Location**: `_kPathHsbCompany\\Abbund` (Your company hsbCAD folder)\n- **Purpose**: Defines the rules for mapping specific Beam Codes to:\n  - **AutoCAD Color Index**: Determines the visual color of the beam in the model.\n  - **Zone Index**: Assigns the beam to a specific production group/element group number.\n\n## Tips\n- **Visual Verification**: Use this script to visually distinguish different beam types (e.g., Wall Studs vs. Plates) by assigning them different colors in the catalog.\n- **Pre-Processing**: Run this script before generating lists or exports to ensure beams are correctly sorted into their production zones.\n- **Updating Rules**: To change which codes get which colors, do not edit the script; instead, open and modify the `HSB-ColorBeamsCatalogue.xml` file in a text editor.\n\n## FAQ\n- **Q: I ran the script, but the beams didn't change color.**\n  - A: Check if the Beam Codes in your model match exactly (including case sensitivity) with the codes defined in the `HSB-ColorBeamsCatalogue.xml`.\n- **Q: Where can I find the XML file?**\n  - A: It is located in your company's hsbCAD installation path, typically inside a subfolder named `Abbund`.\n- **Q: Does this change the geometry of the beams?**\n  - A: No, it only modifies visual properties (Color) and data attributes (Element Group/Zone)."
      },
      "tokens_used": 4016,
      "error": null
    }
  }
}