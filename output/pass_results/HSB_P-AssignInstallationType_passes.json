{
  "filename": "HSB_P-AssignInstallationType.mcr",
  "status": "completed",
  "total_tokens": 35203,
  "processing_time": 648.1583395004272,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": 1,
          "minorVersion": 2,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This TSL assigns electrical symbols to a installation objects",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "17.06.2014",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "05.11.2014",
            "author": "AS",
            "changes": "Also export the Id"
          },
          {
            "version": "1.02",
            "date": "25.02.2015",
            "author": "AS",
            "changes": "Set the values passed in as valid properties."
          }
        ],
        "settingsFiles": [
          "HSB-InstallationTypeCatalogue.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 5603,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script executes logic exclusively within the `_bOnMapIO` block, utilizing `_Map` data structures and `PropString` definitions for the Properties Palette. It lacks `sd_` functions, `Sheet` or `Viewport` objects, and `_Entity[]` arrays, which are characteristic of Paper Space or Shop Drawing scripts. The behavior is typical of a Model Space parametric script handling custom properties."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element/GenBeam with existing Map data containing 'NrOfInstallationPoints' and 'Installations'"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB-InstallationTypeCatalogue.xml (located in _kPathHsbCompany\\Abbund)"
          ]
        }
      },
      "tokens_used": 4186,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeparator01",
            "type": "PropString",
            "displayName": "|Installation type|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sInstallationType1",
            "type": "PropString",
            "displayName": "     |Installation type| 1",
            "defaultValue": "     |Installation type| 1",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sInstallationType2",
            "type": "PropString",
            "displayName": "     |Installation type| 2",
            "defaultValue": "     |Installation type| 2",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sInstallationType3",
            "type": "PropString",
            "displayName": "     |Installation type| 3",
            "defaultValue": "     |Installation type| 3",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sInstallationType4",
            "type": "PropString",
            "displayName": "     |Installation type| 4",
            "defaultValue": "     |Installation type| 4",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sInstallationType5",
            "type": "PropString",
            "displayName": "     |Installation type| 5",
            "defaultValue": "     |Installation type| 5",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sInstallationType6",
            "type": "PropString",
            "displayName": "     |Installation type| 6",
            "defaultValue": "     |Installation type| 6",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sInstallationType7",
            "type": "PropString",
            "displayName": "     |Installation type| 7",
            "defaultValue": "     |Installation type| 7",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "sInstallationType8",
            "type": "PropString",
            "displayName": "     |Installation type| 8",
            "defaultValue": "     |Installation type| 8",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 9,
            "variable": "sInstallationType9",
            "type": "PropString",
            "displayName": "     |Installation type| 9",
            "defaultValue": "     |Installation type| 9",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          },
          {
            "index": 10,
            "variable": "sInstallationType10",
            "type": "PropString",
            "displayName": "     |Installation type| 10",
            "defaultValue": "     |Installation type| 10",
            "inputType": "dropdown",
            "options": "Dynamic (loaded from HSB-InstallationTypeCatalogue.xml)",
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "ShowDialog",
            "handler": "ShowDialog",
            "action": "Opens the installation properties dialog",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "HSB-InstallationTypeCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Provides the list of available installation types (symbols) to populate the OPM dropdown lists.",
            "required": true
          }
        ]
      },
      "tokens_used": 4886,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Assigns specific electrical installation types (symbols) to predefined installation points located on a timber element.",
          "category": "Data Management / Attributes",
          "typicalUseCase": "When an engineer needs to specify what kind of electrical box or symbol (e.g., socket, switch, light) is located at specific insertion points on a beam or wall panel, ensuring the information travels with the element for detailing or export."
        },
        "parameters": [
          {
            "name": "sSeparator01",
            "technicalDefault": "",
            "businessMeaning": "A visual separator in the properties palette to group installation-related settings.",
            "validRange": "N/A",
            "unit": "N/A",
            "affectsOutput": "None. This is purely for UI organization."
          },
          {
            "name": "sInstallationType1",
            "technicalDefault": "     |Installation type| 1",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #1 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml (e.g., 'Socket/Switch', 'Light/Outdoor', etc.)",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data ('Installations' -> 'Installation' -> 'InstallationType') for the first point. Does not directly create geometry but controls data export and potentially symbol generation in other modules."
          },
          {
            "name": "sInstallationType2",
            "technicalDefault": "     |Installation type| 2",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #2 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the second point."
          },
          {
            "name": "sInstallationType3",
            "technicalDefault": "     |Installation type| 3",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #3 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the third point."
          },
          {
            "name": "sInstallationType4",
            "technicalDefault": "     |Installation type| 4",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #4 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the fourth point."
          },
          {
            "name": "sInstallationType5",
            "technicalDefault": "     |Installation type| 5",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #5 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the fifth point."
          },
          {
            "name": "sInstallationType6",
            "technicalDefault": "     |Installation type| 6",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #6 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the sixth point."
          },
          {
            "name": "sInstallationType7",
            "technicalDefault": "     |Installation type| 7",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #7 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the seventh point."
          },
          {
            "name": "sInstallationType8",
            "technicalDefault": "     |Installation type| 8",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #8 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the eighth point."
          },
          {
            "name": "sInstallationType9",
            "technicalDefault": "     |Installation type| 9",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #9 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the ninth point."
          },
          {
            "name": "sInstallationType10",
            "technicalDefault": "     |Installation type| 10",
            "businessMeaning": "The specific electrical symbol or device type assigned to Installation Point #10 on the element.",
            "validRange": "Dependent on HSB-InstallationTypeCatalogue.xml",
            "unit": "String (Catalog Entry)",
            "affectsOutput": "Updates the internal Map data for the tenth point."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "The '_Map' data 'NrOfInstallationPoints' indicates a count N",
            "effect": "Properties for slots greater than N are set to Read-Only and disabled.",
            "cascade": [
              "sInstallationType1",
              "sInstallationType2",
              "sInstallationType3",
              "sInstallationType4",
              "sInstallationType5",
              "sInstallationType6",
              "sInstallationType7",
              "sInstallationType8",
              "sInstallationType9",
              "sInstallationType10"
            ]
          },
          {
            "trigger": "The content of 'HSB-InstallationTypeCatalogue.xml'",
            "effect": "Populates the available dropdown options for all installation type properties.",
            "cascade": [
              "sInstallationType1",
              "sInstallationType2",
              "sInstallationType3",
              "sInstallationType4",
              "sInstallationType5",
              "sInstallationType6",
              "sInstallationType7",
              "sInstallationType8",
              "sInstallationType9",
              "sInstallationType10"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Map Data (Attribute)",
            "description": "Updates the 'Installations' map within the element's MapIO structure, assigning specific installation types to specific indices.",
            "appliedTo": "The Element or GenBeam that this TSL is attached to."
          }
        ]
      },
      "tokens_used": 6333,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered (via OPM change, insertion, or context menu).",
          "Read integer 'NrOfInstallationPoints' from the Element's _Map.",
          "Read 'HSB-InstallationTypeCatalogue.xml' to retrieve available installation types.",
          "Define Properties Palette fields (sInstallationType1 through 10).",
          "[Conditional] Set Properties Read-Only: If property index > 'NrOfInstallationPoints', disable editing.",
          "Populate Properties: Set current OPM values to match existing 'Installations' data in the Map.",
          "[Conditional] Handle Context Menu: If trigger is 'ShowDialog', launch the configuration dialog.",
          "Collect Data: Aggregate values from all 10 installation type properties.",
          "Rebuild Map: Create new 'Installations' map structure containing the assigned types.",
          "Write Data: Update the Element's _Map with the new 'Installations' data."
        ],
        "conditionalBranches": [
          {
            "condition": "Comparison of Installation Index vs. NrOfInstallationPoints",
            "path1": {
              "name": "Valid Point (Enabled)",
              "steps": [
                "Index (1-10) is less than or equal to NrOfInstallationPoints.",
                "Property is set to Read-Write.",
                "User can select a value from the dropdown."
              ]
            },
            "path2": {
              "name": "Invalid Point (Disabled)",
              "steps": [
                "Index (1-10) is greater than NrOfInstallationPoints.",
                "Property is set to Read-Only (Disabled).",
                "Dropdown is grayed out and cannot be modified."
              ]
            }
          },
          {
            "condition": "Execution Key (Trigger Source)",
            "path1": {
              "name": "ShowDialog Command",
              "steps": [
                "User right-clicks and selects 'ShowDialog'.",
                "Script executes 'showDialog(\"IO\")'.",
                "User interacts with modal dialog (if implemented in external function) instead of OPM."
              ]
            },
            "path2": {
              "name": "Standard OPM Update",
              "steps": [
                "User changes value in Properties Palette or script recalculates.",
                "Dialog is not launched.",
                "Data flows directly from OPM variables to Map."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "XML File Existence",
            "errorMessage": "(No explicit error in code, implicit behavior)",
            "recovery": "If 'HSB-InstallationTypeCatalogue.xml' is missing from _kPathHsbCompany\\Abbund, the dropdown lists will be empty, preventing user selection."
          },
          {
            "check": "Map Data Integrity",
            "errorMessage": "(No explicit error in code, implicit behavior)",
            "recovery": "If 'NrOfInstallationPoints' is missing or 0, all input fields are set to Read-Only."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Installation Types",
            "how": "Properties Palette (OPM) dropdowns or Context Menu 'ShowDialog'",
            "effect": "Updates the 'InstallationType' field within the 'Installations' Map of the element."
          },
          {
            "action": "Change Element Context",
            "how": "N/A (Linked to Element Map)",
            "effect": "If the host element's 'NrOfInstallationPoints' changes, the script automatically adjusts which properties are enabled/disabled upon the next recalculation."
          }
        ]
      },
      "tokens_used": 7279,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_P-AssignInstallationType.mcr\n\n## Overview\nAssigns specific electrical installation types (e.g., sockets, switches) to predefined installation points on timber elements directly via the AutoCAD Properties Palette.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Used to assign data to Elements or GenBeams in the model. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Not intended for manufacturing drawings. |\n\n## Prerequisites\n- **Required entities**: An Element or GenBeam that already has installation points defined (the element must contain Map data with `NrOfInstallationPoints` and `Installations`).\n- **Minimum beam count**: N/A (Script is attached to existing elements).\n- **Required settings files**: `HSB-InstallationTypeCatalogue.xml` (must be present in the `Abbund` folder of your hsbCAD company path).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Select `HSB_P-AssignInstallationType.mcr` from the file browser.\n\n### Step 2: Select Element\n```\nCommand Line: Select Element/GenBeam:\nAction: Click on the timber wall or beam you want to assign electrical types to.\n```\n\n### Step 3: Configure Properties\n1. With the element selected, open the **Properties Palette** (press `Ctrl+1`).\n2. Scroll down to the \"Installation type\" section.\n3. Select the desired electrical symbol from the dropdown lists (e.g., \"Socket/Switch\", \"Light\").\n4. Only the dropdowns corresponding to actual installation points on the beam will be editable.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| |Installation type| | Text | | Visual separator for the settings group. |\n| Installation type 1 | dropdown | |Installation type| 1 | Select the electrical symbol for the first installation point on the element. |\n| Installation type 2 | dropdown | |Installation type| 2 | Select the electrical symbol for the second installation point. |\n| Installation type 3 | dropdown | |Installation type| 3 | Select the electrical symbol for the third installation point. |\n| Installation type 4 | dropdown | |Installation type| 4 | Select the electrical symbol for the fourth installation point. |\n| Installation type 5 | dropdown | |Installation type| 5 | Select the electrical symbol for the fifth installation point. |\n| Installation type 6 | dropdown | |Installation type| 6 | Select the electrical symbol for the sixth installation point. |\n| Installation type 7 | dropdown | |Installation type| 7 | Select the electrical symbol for the seventh installation point. |\n| Installation type 8 | dropdown | |Installation type| 8 | Select the electrical symbol for the eighth installation point. |\n| Installation type 9 | dropdown | |Installation type| 9 | Select the electrical symbol for the ninth installation point. |\n| Installation type 10 | dropdown | |Installation type| 10 | Select the electrical symbol for the tenth installation point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| ShowDialog | Opens a configuration dialog to modify the installation types (alternative to using the Properties Palette). |\n\n## Settings Files\n- **Filename**: `HSB-InstallationTypeCatalogue.xml`\n- **Location**: `_kPathHsbCompany\\Abbund`\n- **Purpose**: This file contains the list of available installation types (e.g., specific electrical symbols). If the dropdown lists are empty, check that this file exists in the correct directory.\n\n## Tips\n- **Read-Only Fields**: If a dropdown is grayed out (Read-Only), it means the element does not have an installation point defined at that position. You cannot assign a type to a point that doesn't exist.\n- **Data Storage**: This script updates the \"Map\" data of the element. It does not create visible geometry (lines/arcs) but ensures the correct data is attached for exports or other scripts to use.\n\n## FAQ\n- Q: Why are all my dropdowns grayed out?\n- A: This usually means the selected element does not have any \"Installation Points\" assigned to it yet. Ensure the element has the required `NrOfInstallationPoints` data.\n- Q: Where do I add new electrical symbols to the list?\n- A: You must edit the `HSB-InstallationTypeCatalogue.xml` file located in your company `Abbund` folder. The script does not create new symbols itself; it reads them from this file."
      },
      "tokens_used": 6916,
      "error": null
    }
  }
}