{
  "filename": "hsbCAD Wandverankerung.mcr",
  "status": "completed",
  "total_tokens": 59463,
  "processing_time": 289.6632936000824,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": null,\n    \"majorVersion\": 2,\n    \"minorVersion\": 5,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": null,\n  \"versionHistory\": [\n    {\n      \"version\": \"2.5\",\n      \"date\": \"16apr14\",\n      \"author\": \"th@hsbCAD.de\",\n      \"changes\": \"CNC Tools can now be turned off\"\n    },\n    {\n      \"version\": \"2.4\",\n      \"date\": \"24jan12\",\n      \"author\": \"th@hsbCAD.de\",\n      \"changes\": \"fastener guideline added, requires hsbCAD 17.2.0 or higher\"\n    },\n    {\n      \"version\": \"2.3\",\n      \"date\": \"30.11.2009\",\n      \"author\": \"th@hsbCAD.de\",\n      \"changes\": \"Content Standardisierung\"\n    },\n    {\n      \"version\": \"2.2\",\n      \"date\": \"06.05.2009\",\n      \"author\": \"th@hsbcad.de\",\n      \"changes\": \"- \\n Ausfrsung wird nun als Blatt lngs geneigt an HH bergeben\"\n    },\n    {\n      \"version\": \"2.1\",\n      \"date\": \"07.06.2006\",\n      \"author\": \"th@hsbcad.de\",\n      \"changes\": \"- neue Optionen 'Freistich' je verwendeter Zone\"\n    },\n    {\n"
      },
      "tokens_used": 10761,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No 'sd_' or 'Multipage*' prefix found. No usage of '_Viewport'. No '#Type E' with '_Entity[]'. Uses standard 'Display' with 'elemZone' for layer control (I, J, T, Z), which is typical for ModelSpace TSLs. Creates 3D geometry (Body, BeamCut, Drill) and modifies elements (ElemSaw, ElemMill)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 7516,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 11875,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates wall anchoring angles (steel brackets) and creates the necessary timber cutouts/millings and sheet material cuts to accommodate them.\",\n    \"category\": \"Hardware\",\n    \"typicalUseCase\": \"Connecting a timber wall element to a floor or substructure using standardized Simpson or BMF anchors, ensuring proper clearance in the timber and finish materials.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sType\",\n      \"technicalDefault\": \"\\\"Z1\\\"\",\n      \"businessMeaning\": \"Specifies the manufacturer and model of the wall anchor angle (e.g., Simpson HTT22, BMF 90 R). This determines the geometry of the metal part and default drilling positions.\",\n      \"validRange\": \"Selection from predefined list\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Metal part geometry, drill hole locations, default dimensions for Zone 0 cutout.\"\n    },\n    {\n      \"name\": \"sLayer\",\n      \"technicalDefault\": \"\\\"I-Layer\\\"\",\n      \"businessMeaning\": \"Controls the visibility of the anchor annotation and symbol in different drawing views (Plan, Section, Elevation).\",\n      \"validRange\": \"I-Layer, J-Layer, T-Layer, Z-Layer\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Visibility of text and graphics in Model Space and Layouts.\"\n    },\n    {\n      \"name\": \"dDepth\",\n      \"technicalDefault\": \"U(4)\",\n      \"businessMeaning\": \"The distance the metal bracket is set back (recessed) into the timber element relative to the insertion point surface.\",\n      \"validRange\": \"0 to 50 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Position of the metal Body relative to the timber surface.\"\n    },\n    {\n      \"name\": \"dWidth (Zone 0)\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"The width of the primary cutout (slot) in the timber for the anchor. A value of 0 automatically uses the width of the selected steel bracket.\",\n      \"validRange\": \"0 (Auto) to 300 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Width of the timber cutout and sheet cutout for the anchor body.\"\n    },\n    {\n      \"name\": \"dOffset\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Vertical (Z-axis) offset of the anchor insertion point relative to the element's origin.\",\n      \"validRange\": \"-1000 to 1000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Vertical position of all anchor geometry.\"\n    },\n    {\n      \"name\": \"sMill\",\n      \"technicalDefault\": \"\\\"No\\\"\",\n      \"businessMeaning\": \"Determines if the bottom of the cutout in the timber is a"
      },
      "tokens_used": 11455,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script 'Wandverankerung.mcr'.",
          "2. Script prompts user to select a timber Element (Wall).",
          "3. Script prompts user to click a point on the Element's face or surface to define the anchor origin (_Pt0).",
          "4. Script initializes properties based on the selected Element's coordinate system.",
          "5. Script executes geometry generation loop (twice, for symmetrical processing or side A/B).",
          "6. Calculate coordinate vectors (vzE normal, vy vertical, vx horizontal).",
          "7. Determine Anchor geometry (Width, Height, Depth) based on 'Type' selection.",
          "8. Generate 3D Bodies for the steel angle (visual representation).",
          "9. Process Zone 0 (Main timber cutout): Create solid subtraction using 'House' object.",
          "10. Process Zones 1-5 (Sheeting/Cladding cutouts): Iterate through zones and apply cuts/millings based on 'Width/Height/Tool' properties.",
          "11. Apply specialized drilling and fastener guidelines if Type is Z1 or Z2.",
          "12. Generate text/label annotation if enabled.",
          "13. Export data to BOM and DXA.",
          "14. Assign element group association."
        ],
        "conditionalBranches": [
          {
            "condition": "Property 'Width Milling Zone 0' value",
            "path1": {
              "name": "Auto Width",
              "steps": [
                "Check if dWidth is 0",
                "Set cutout width to default steel bracket width (dTypeW1)"
              ]
            },
            "path2": {
              "name": "Manual Width",
              "steps": [
                "Check if dWidth > 0",
                "Set cutout width to user-defined dWidth value"
              ]
            }
          },
          {
            "condition": "Property 'Lower Milling-Line' (sMill)",
            "path1": {
              "name": "Yes (Pocket)",
              "steps": [
                "Close the polyline (plMill) defining the bottom of the cutout",
                "Creates a fully enclosed pocket/milling"
              ]
            },
            "path2": {
              "name": "No (Slot)",
              "steps": [
                "Leave polyline open",
                "Creates a slot or simple cut without a closed bottom face"
              ]
            }
          },
          {
            "condition": "Anchor Type Selection (nType)",
            "path1": {
              "name": "Z1 / Z2 Types",
              "steps": [
                "Check nType == 0 or nType == 1",
                "Add Drill objects to the steel body",
                "Add FastenerGuidelines for visualization/output"
              ]
            },
            "path2": {
              "name": "Other Types (BMF/Simpson)",
              "steps": [
                "Skip specific Drill generation",
                "Only draw the steel body geometry"
              ]
            }
          },
          {
            "condition": "Zone Tool Selection (Per Zone)",
            "path1": {
              "name": "Saw",
              "steps": [
                "Identify nTool == 0",
                "Add ElemSaw tool to the element zone"
              ]
            },
            "path2": {
              "name": "Mill",
              "steps": [
                "Identify nTool == 1",
                "Add ElemMill tool to the element zone"
              ]
            },
            "path3": {
              "name": "None",
              "steps": [
                "Identify nTool == 2",
                "Skip CNC tool addition (Geometric cut via BeamCut may still occur)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Valid Element Selection",
            "errorMessage": "Script requires a valid Element to attach to.",
            "recovery": "User must select a valid timber wall element and re-insert."
          },
          {
            "check": "Zone Height Availability",
            "errorMessage": "Cutout skipped for specific zones.",
            "recovery": "If a zone (e.g., 1 or 2) has a height of 0 in the element construction, the script skips operations for that zone automatically."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Position",
            "how": "Grip Edit (Drag Grip Point)",
            "effect": "Moving the grip point (_PtG[0]) updates the insertion point (_Pt0) and regenerates all geometry (cutouts and steel) relative to the new location."
          },
          {
            "action": "Change Configuration",
            "how": "Properties Palette (OPM)",
            "effect": "Changing properties like 'Type', 'Depth', 'Width', or 'Layer' triggers an immediate recalculation of geometry and visual representation."
          },
          {
            "action": "Update Annotation",
            "how": "Properties Palette (sNY)",
            "effect": "Toggling 'Show Text' (sNY) between Yes/No shows or hides the anchor label and leader line."
          },
          {
            "action": "Move with Element",
            "how": "Standard CAD Move/Copy",
            "effect": "Since 'assignToElementGroup' is used, the anchor moves or copies automatically when the parent timber element is manipulated."
          }
        ]
      },
      "tokens_used": 11975,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Wandverankerung (Wall Anchoring)\n\n## Overview\nThis script generates wall anchoring angles (steel brackets) and automatically creates the necessary timber cutouts, millings, and sheet material clearances to accommodate them. It supports various manufacturer types (e.g., Simpson, BMF) and handles CNC output definitions.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in 3D model space. |\n| Paper Space | No | Cannot be inserted into Layouts. |\n| Shop Drawing | No | Not a shop drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: A single timber Wall Element (e.g., an outer wall).\n- **Minimum Beam Count**: N/A (Requires an Element, not individual beams).\n- **Required Settings**: None. (Manufacturer geometry is built-in).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Wandverankerung.mcr` from the file list.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select Element:\nAction: Click on the timber wall element where the anchor will be applied.\n```\n\n### Step 3: Define Insertion Point\n```\nCommand Line: Give point on element:\nAction: Click a specific point on the face or surface of the selected element.\n```\n*Note: The script calculates the anchor orientation based on the local coordinate system of the element at this point.*\n\n### Step 4: Configure Anchor (Optional)\nAfter insertion, select the newly created anchor and open the **Properties Palette** (Ctrl+1) to adjust the type, dimensions, and layer visibility as needed.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Type** (sType) | Dropdown | Z1 | Select the manufacturer and model of the anchor (e.g., Simpson HTT22, BMF 90 R). This sets the geometry size. |\n| **Layer** (sLayer) | Dropdown | I-Layer | Sets the CAD layer for visibility control (Plan, Section, Elevation, or 3D). |\n| **Depth** (dDepth) | Number | 4 mm | The distance the metal bracket is recessed into the timber element relative to the surface. |\n| **Width Milling** (dWidth) | Number | 0 mm | Width of the timber cutout. Set to `0` to automatically use the bracket's actual width. |\n| **Offset** (dOffset) | Number | 0 mm | Vertical offset of the anchor relative to the element's origin. |\n| **Lower Milling-Line** (sMill) | Yes/No | No | **Yes**: Creates a fully enclosed pocket (closed bottom). **No**: Creates an open slot. |\n| **Show Text** (sNY) | Yes/No | Yes | Toggles the visibility of the anchor annotation label. |\n| **Tool Zone [1-5]** | Dropdown | Saw/Mill | Selects the CNC operation for each construction zone (Saw, Mill, or None). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Refresh** | Recalculates the geometry based on current properties or if the wall element has moved. |\n| **Delete** | Removes the anchor and associated operations from the element. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A.\n- **Purpose**: All anchor dimensions and geometric rules are internal to the script.\n\n## Tips\n- **Auto-Sizing**: Keep the **Width Milling** property set to `0` to ensure the cutout always matches the width of the selected steel bracket type exactly.\n- **Moving Anchors**: Use the **Grip Point** (usually visible at the insertion point) to drag the anchor along the wall. The timber cutouts will update automatically.\n- **Element Updates**: Since the anchor is assigned to the element group, copying or moving the parent wall element will automatically move the anchor with it.\n- **CNC Optimization**: Use the **Tool Zone** properties to switch between Sawing (faster) and Milling (for complex shapes) for specific cladding layers.\n\n## FAQ\n- **Q: Why is there no cutout in my cladding/boarding?**\n- A: Check that the relevant **Zone [1-5]** properties have a height defined in your element construction, and ensure the **Tool** for that zone is not set to \"None\".\n\n- **Q: How do I switch between a simple slot and a pocket?**\n- A: Toggle the **Lower Milling-Line** property. \"No\" creates a slot (open), while \"Yes\" closes the bottom of the cutout to make a pocket.\n\n- **Q: Can I use this for floor connections?**\n- A: Yes, provided you select a timber element (wall or floor) and define the insertion point on the correct face. The script is orientation-agnostic based on the element's local axes."
      },
      "tokens_used": 5881,
      "error": null
    }
  }
}