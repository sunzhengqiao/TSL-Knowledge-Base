{
  "filename": "GCS.mcr",
  "status": "completed",
  "total_tokens": 51696,
  "processing_time": 458.15460228919983,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.9",
            "date": "26okt2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 Add Top drill Z offset"
          },
          {
            "version": "1.8",
            "date": "16okt2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 separate tolerance inpunt for top and width"
          },
          {
            "version": "1.7",
            "date": "30sep2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 ribbon button fixed"
          },
          {
            "version": "1.6",
            "date": "30sep2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 add top drill depth, image, top shape tolerance"
          },
          {
            "version": "1.5",
            "date": "22sep2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 when called from catalog, hide dialogue"
          },
          {
            "version": "1.4",
            "date": "21sep2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 optimized the token catalog connection"
          },
          {
            "version": "1.3",
            "date": "16sep2020",
            "author": "geoffroy.cenni@hsbcad.com",
            "changes": "HSB6484 initial"
          }
        ],
        "settingsFiles": [
          "GCS.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 8388,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script creates 3D geometry using GenBeam, Body, and Drill entities. It uses `_kModelSpace` logic implicitly by interacting with `bmPost` (GenBeam) and creating tooling. No references to sd_*, Multipage, _Viewport, or #Type E constructs."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Requires a beam (column) to attach the column shoe geometry.",
          "requiredSettings": [
            "GCS.xml"
          ]
        }
      },
      "tokens_used": 5827,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"_bOnInsert\",\n      \"title\": \"GCS - General Column Shoe\",\n      \"dataSource\": \"GCS.xml (populates Manufacturer, Family, and Article Number lists)\",\n      \"features\": {\n        \"searchable\": true,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [],\n  \"contextMenu\": [\n    {\n      \"menuItem\": \"Rotate\",\n      \"handler\": \"../|Rotate|\",\n      \"action\": \"Rotates the column shoe 90 degrees if extendable, or toggles rotation state. Checks post size compatibility.\",\n      \"alsoTriggeredBy\": null\n    },\n    {\n      \"menuItem\": \"Flip Drill Face\",\n      \"handler\": \"../|Flip Drill Face|\",\n      \"action\": \"Reverses the drill direction vector.\",\n      \"alsoTriggeredBy\": null\n    },\n    {\n      \"menuItem\": \"Cycle Drill Face\",\n"
      },
      "tokens_used": 10195,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Inserts a manufacturer-defined General Column Shoe (metal connector) at the base of a timber column, generating the 3D solid geometry and drilling the necessary bolt holes into the timber post.",
          "category": "Hardware",
          "typicalUseCase": "Used during structural detailing to anchor a timber column to a concrete foundation or substructure using a specific off-the-shelf metal column shoe (e.g., Simpson Strong-Tie)."
        },
        "parameters": [
          {
            "name": "sManufacturer",
            "technicalDefault": "\"Simpson Strong-Tie\"",
            "businessMeaning": "The company producing the column shoe.",
            "validRange": "Defined in GCS.xml",
            "unit": "String",
            "affectsOutput": "Filters the available list of product families and determines the specific geometric catalog data to load."
          },
          {
            "name": "sFamily",
            "technicalDefault": "\"PVD\"",
            "businessMeaning": "The product line or model series of the shoe.",
            "validRange": "Defined in GCS.xml (dependent on Manufacturer)",
            "unit": "String",
            "affectsOutput": "Filters the available list of specific article numbers/variants."
          },
          {
            "name": "sArticleNumber",
            "technicalDefault": "\"PVD 210\"",
            "businessMeaning": "The specific catalog reference (SKU) for the exact column shoe size and type.",
            "validRange": "Defined in GCS.xml (dependent on Family)",
            "unit": "String",
            "affectsOutput": "Drives all geometric dimensions, drill patterns, and material properties for the 3D representation and machining."
          },
          {
            "name": "dTop_Tolerance_Height / dTop_Tolerance_Width",
            "technicalDefault": "2.0",
            "businessMeaning": "Clearance gap added around the timber column for the top plate of the shoe.",
            "validRange": "1.0 - 10.0 mm",
            "unit": "mm",
            "affectsOutput": "Increases the inner void of the Top Plate Body to ensure the shoe fits over the timber despite manufacturing tolerances."
          },
          {
            "name": "iMiddle_Extendable",
            "technicalDefault": "0",
            "businessMeaning": "Indicates if the column shoe has an adjustable/telescopic middle section to accommodate varying column heights.",
            "validRange": "0 (No), 1 (Yes)",
            "unit": "Boolean/Int",
            "affectsOutput": "Enables the 'Rotate' context menu logic which checks fit in both X and Y directions. Allows the shoe to accommodate different post dimensions."
          },
          {
            "name": "dTop_Drill_Diameter",
            "technicalDefault": "12.0",
            "businessMeaning": "Diameter of the bolt holes required in the timber column for the top connection.",
            "validRange": "8.0 - 30.0 mm",
            "unit": "mm",
            "affectsOutput": "Size of the Drill entities created in the timber column (GenBeam)."
          },
          {
            "name": "iTop_Drill_Rows / iTop_Drill_Columns",
            "technicalDefault": "2",
            "businessMeaning": "The grid layout (matrix) of the bolt holes on the top plate.",
            "validRange": "1 - 4",
            "unit": "Count",
            "affectsOutput": "Determines the number and position of Drill entities generated in the timber."
          },
          {
            "name": "sDrillAlignment",
            "technicalDefault": "Front",
            "businessMeaning": "The direction from which the drill operation is simulated/processed.",
            "validRange": "Front, Right, Back, Left",
            "unit": "String",
            "affectsOutput": "Changes the start point vector of the Drill entities."
          },
          {
            "name": "sMaterial",
            "technicalDefault": "Galvanized Steel",
            "businessMeaning": "The material finish of the metal shoe.",
            "validRange": "Galvanized, Stainless Steel, Raw Steel",
            "unit": "String",
            "affectsOutput": "Updates the property data attached to the 3D Body and Hardware List (BOM)."
          },
          {
            "name": "bIsRotated",
            "technicalDefault": "false",
            "businessMeaning": "State flag indicating if the shoe has been rotated 90 degrees around the vertical axis.",
            "validRange": "true, false",
            "unit": "Boolean",
            "affectsOutput": "Swaps the Width and Depth dimensions of the shoe geometry relative to the column axes to better fit rectangular columns."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing sManufacturer",
            "effect": "Updates the available options in sFamily.",
            "cascade": [
              "sFamily",
              "sArticleNumber"
            ]
          },
          {
            "trigger": "Changing sFamily",
            "effect": "Updates the available options in sArticleNumber.",
            "cascade": [
              "sArticleNumber"
            ]
          },
          {
            "trigger": "Changing sArticleNumber",
            "effect": "Loads all geometric parameters (Dimensions, Drills, Tolerances) from the XML catalog map.",
            "cascade": [
              "dTop_...",
              "dMiddle_...",
              "dBottom_...",
              "iTop_Drill_...",
              "sMaterial"
            ]
          },
          {
            "trigger": "Right-click 'Rotate'",
            "effect": "Toggles bIsRotated. Checks compatibility between post size and shoe width/depth.",
            "cascade": [
              "bIsRotated",
              "Shoe Geometry Orientation"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Body",
            "description": "3D solid geometry representing the Column Shoe (Top Plate, Middle Bar, Bottom Plate).",
            "appliedTo": "Generated at the insertion point relative to the selected column."
          },
          {
            "type": "Drill",
            "description": "Through-holes in the timber column corresponding to the bolt pattern of the shoe.",
            "appliedTo": "The selected timber post (bmPost)."
          },
          {
            "type": "HardWrComp",
            "description": "Hardware list entries (BOM) for the main shoe and the bolts/pegs.",
            "appliedTo": "Attached to the script instance."
          }
        ]
      },
      "tokens_used": 9396,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script initializes and attempts to locate 'GCS.xml' settings file (checks Company folder, then Install folder).\",\n    \"Reads Manufacturer list from the loaded XML. If list is empty, script aborts with error.\",\n    \"Checks execution tokens (e.g., from Ribbon button command line) to pre-select specific Manufacturer/Family combinations.\",\n    \"User selects a timber column (GenBeam) to act as the host post.\",\n    \"Dynamic Dialog opens: User selects Manufacturer, Family, and specific Article Number.\",\n    \"Script loads geometric parameters (Dimensions, Drills, Tolerances) from the XML mapping for the selected article.\",\n    \"Script checks for duplicate GCS instances attached to the selected beam and erases the current instance if a duplicate is found.\",\n    \"Script generates 3D Body geometry (Top Plate, Middle Bar, Bottom Plate) based on dimensions and rotation state.\",\n    \"Script applies Drill operations to the timber post based on drill pattern and alignment settings.\",\n    \"Script updates Hardware List (BOM) with the Column Shoe and associated Bolts/Pegs.\",\n    \"User can modify the instance post-insertion using Context Menu actions or OPM Properties.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Configuration File Availability\",\n      \"path1\": {\n        \"name\": \"Found in Company Folder\",\n        \"steps\": [\"Load settings from _kPathHsbCompany\", \"Continue to entity selection\"]\n      },\n      \"path2\": {\n        \"name\": \"Found in Install Folder\",\n        \"steps\": [\"Load settings from _kPathHsbInstall\", \"Continue to entity selection\"]\n      },\n      \"path3\": {\n        \"name\": \"File Not Found\",\n        \"steps\": [\"Report error: 'Could not find general column shoe catalogue GCS.xml'\", \"Erase instance\", \"Return\"]\n      }\n    },\n    {\n      \"condition\": \"Rotation of Extendable Shoe (Context Menu: Rotate)\",\n      \"path1\": {\n        \"name\": \"Fits in one dimension only\",\n        \"steps\": [\"Force rotation to the fitting dimension (X or Y)\", \"Set bCanBeRotated to false (Lock orientation)\", \"Update geometry\"]\n      },\n      \"path2\": {\n        \"name\": \"Fits in both dimensions\",\n        \"steps\": [\"Toggle rotation state (90 deg)\", \"Update geometry\"]\n      },\n      \"path3\": {\n        \"name\": \"Fits in neither dimension\",\n        \"steps\": [\"Report error: 'Post size does not fit selected column shoe'\", \"Erase instance\", \"Return\"]\n      }\n    },\n    {\n      \"condition\": \"Drill Alignment Interaction\",\n      \"path1\": {\n        \"name\": \"Flip Drill Face\",\n        \"steps\": [\"Invert drill direction vector (nDrillDir * -1)\", \"Update sDrillAlignment property\"]\n      },\n      \"path2\": {\n        \"name\": \"Cycle Drill Face\",\n        \"steps\": [\"Select next string in sDrillAlignments array (Front->Right->Back->Left)\", \"Update sDrillAlignment property\"]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Existence of GCS.xml settings file.\",\n      \"errorMessage\": \"Could not find general column shoe catalogue GCS.xml. Tool will be deleted.\",\n      \"recovery\": \"Ensure GCS.xml exists"
      },
      "tokens_used": 11452,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GCS (General Column Shoe)\n\n## Overview\nThis script inserts a manufacturer-defined metal column shoe (connector) at the base of a timber column. It automatically generates the 3D solid geometry of the hardware and drills the necessary bolt holes into the wood post.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model to create solids and modify timber beams. |\n| Paper Space | No | Script does not generate 2D drawings directly. |\n| Shop Drawing | No | Script focuses on physical detailing (bodies and drilling). |\n\n## Prerequisites\n- **Required Entities**: 1 Timber Column (GenBeam)\n- **Minimum Beam Count**: 1\n- **Required Settings Files**: `GCS.xml` (Catalog database containing manufacturer dimensions and drill patterns)\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT` (or click the specific Ribbon button if configured)\n**Action:** Select `GCS.mcr` from the list of available scripts.\n\n### Step 2: Select Timber Column\n**Command Line:** `Select column/post:`\n**Action:** Click on the timber column (GenBeam) in the drawing where you want to install the base shoe.\n\n### Step 3: Configure Shoe\n**Dialog:** `GCS - General Column Shoe`\n**Action:** \n1. Select the **Manufacturer** from the dropdown (e.g., Simpson Strong-Tie).\n2. Select the **Family** (e.g., PVD).\n3. Select the specific **Article Number** (SKU) for the size required.\n4. Click **OK**.\n\n*Note: If you launched the script from a catalog token, these settings may be pre-selected.*\n\n### Step 4: Review and Adjust\nThe script will generate the shoe geometry and holes. If the shoe does not fit or is oriented incorrectly, select the inserted shoe and use Right-Click options to adjust.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Manufacturer | String | Simpson Strong-Tie | The manufacturer of the column shoe. |\n| Family | String | PVD | The product family or line. |\n| Article Number | String | PVD 210 | The specific catalog code defining size and geometry. |\n| Top Tolerance (Height/Width) | Number | 2.0 mm | Clearance gap added around the timber for the top plate to ensure fit. |\n| Middle Extendable | Integer (0/1) | 0 (No) | If set to 1, indicates the shoe has a telescopic middle section for height adjustment. |\n| Top Drill Diameter | Number | 12.0 mm | Diameter of the bolt holes to drill into the column. |\n| Top Drill Rows / Columns | Number | 2 | The number of bolt holes in the vertical and horizontal directions (grid layout). |\n| Drill Alignment | String | Front | The direction from which the drill is processed (Front, Right, Back, Left). |\n| Material | String | Galvanized Steel | The material finish assigned to the 3D body. |\n| Is Rotated | Boolean | False | Toggles the shoe orientation 90 degrees relative to the column axis. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Rotate | Rotates the shoe 90 degrees around the vertical axis. If the shoe is extendable, it toggles orientation; if not, it checks if the post fits the new orientation. |\n| Flip Drill Face | Reverses the direction of the drill vector (e.g., drills from the opposite side). |\n| Cycle Drill Face | Cycles the drill direction through the sequence: Front → Right → Back → Left. |\n\n## Settings Files\n- **Filename**: `GCS.xml`\n- **Location**: `_kPathHsbCompany` or `_kPathHsbInstall`\n- **Purpose**: This XML file acts as the catalog database. It stores the mapping of Manufacturers, Families, and Article Numbers to their specific geometric dimensions (width, height, depth), drill patterns, and material properties.\n\n## Tips\n- **Fit Check**: If you see an error \"Post size does not fit selected column shoe,\" your timber column is too large for the selected hardware. Try a larger Article Number or check your post dimensions.\n- **XML Requirement**: Ensure `GCS.xml` is present in your Company folder. If the script cannot find this file, it will display an error and delete the instance immediately.\n- **Rectangular Posts**: For rectangular columns, use the **Rotate** context menu option to ensure the shoe width aligns correctly with the narrower or wider face of the timber.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I selected the column?**\n  - **A:** The script could not locate the required `GCS.xml` catalog file in your standard folders. Please contact your CAD Manager to ensure the configuration file is installed correctly.\n  \n- **Q: Can I change the drill size without changing the whole shoe?**\n  - **A:** Yes, you can manually modify the `Top Drill Diameter` in the Properties Palette after insertion, though this should match the physical bolts intended for use.\n\n- **Q: What does \"Extendable\" mean?**\n  - **A:** It refers to column shoes that have a slotted middle bar to allow height adjustments (e.g., for site leveling). When enabled, it affects how the script handles rotation and dimension checks."
      },
      "tokens_used": 6438,
      "error": null
    }
  }
}