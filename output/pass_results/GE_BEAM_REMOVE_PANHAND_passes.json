{
  "filename": "GE_BEAM_REMOVE_PANHAND.mcr",
  "status": "completed",
  "total_tokens": 19920,
  "processing_time": 287.2078433036804,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3769,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No 'sd_' or Multipage prefixes found. No usage of '_Viewport', '_kPaperSpace', or '#Type E' entity sets. The script uses 'PrEntity' to select generic 'Beam' objects from the model."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Must be run in a 3D model context containing hsbCAD Beams.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1213,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "select a set beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1701,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Detaches selected structural beams from their panhandle (layout control line), breaking the automated wall generation link.",
          "category": "Modification / Logic",
          "typicalUseCase": "When a user needs to convert a wall-generated beam into a standalone beam, or remove a beam from the automated wall layout control without deleting the beam itself."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Empty Selection",
            "businessMeaning": "The collection of structural beams selected by the user to have their panhandle reference removed.",
            "validRange": "1 or more valid hsbCAD Beam entities",
            "unit": "Entities",
            "affectsOutput": "Clears the panhandle property on the specified beams, disconnecting them from the layout line or wall definition and stopping automated updates from that controller."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Beam (Modified)",
            "description": "The logical connection (panhandle property) is cleared from the existing beams. No new geometry is created.",
            "appliedTo": "The beams selected via the 'ssE' prompt."
          }
        ]
      },
      "tokens_used": 3612,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script invoked by user.\",\n    \"Check if insertCycleCount > 1; if true, erase instance and stop.\",\n    \"Prompt user on command line to select a set of beams.\",\n    \"Capture selected beams into a selection set.\",\n    \"Validate if any beams were selected.\",\n    \"If validation fails (empty selection), erase instance and stop.\",\n    \"If validation passes, store beams in internal array _Beam.\",\n    \"Script returns control to system, triggering a recalculation (Calculation Phase).\",\n    \"Check if internal array _Beam still contains beams.\",\n    \"Iterate through each beam in the array.\",\n    \"Check if the current beam entity is valid (not deleted).\",\n    \"If valid, set the beam's Panhandle property to the script instance (_ThisInst).\",\n    \"Report the total count of affected beams to the command line.\",\n    \"Erase the script instance from the drawing.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Insert Cycle Count check\",\n      \"path1\": {\n        \"name\": \"Cycle > 1 (Recalculation attempt)\",\n        \"steps\": [\n          \"Erase the script instance immediately.\",\n          \"Stop execution.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Cycle == 1 (First Insertion)\",\n        \"steps\": [\n          \"Proceed to User Selection prompt.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"User Selection (ssE)\",\n      \"path1\": {\n        \"name\": \"Selection Failed/Empty\",\n        \"steps\": [\n          \"Verify internal beam array length is 0.\",\n          \"Erase the script instance.\",\n          \"Stop execution.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Selection Successful\",\n        \"steps\": [\n          \"Extract beams from selection set.\",\n          \"Append beams to internal _Beam array.\",\n          \"Proceed to Calculation Phase.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Beam Entity Validity (bm.bIsValid)\",\n      \"path1\": {\n        \"name\": \"Valid Beam\",\n        \"steps\": [\n          \"Set Panhandle property to _ThisInst.\",\n          \"Increment counter.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Invalid/Deleted Beam\",\n        \"steps\": [\n          \"Skip current beam.\",\n          \"Continue loop.\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Insert Cycle Count\",\n      \"errorMessage\": \"(Silent failure - script simply erases itself)\",\n      \"recovery\": \"Run the script command again fresh.\"\n    },\n    {\n      \"check\": \"Beam Selection Count\",\n      \"errorMessage\": \"(Silent failure - script simply erases itself)\",\n      \"recovery\": \"Run the script command again and ensure at least one beam is selected.\"\n    },\n    {\n      \"check\": \"Beam Entity Validity\",\n      \"errorMessage\": \"(Handled internally - beam is"
      },
      "tokens_used": 5511,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_REMOVE_PANHAND\n\n## Overview\nThis script disconnects selected structural beams from their associated wall layout lines (panhandles). It converts wall-generated beams into standalone elements, preventing them from being automatically updated or controlled by the original wall definition.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the 3D model. |\n| Paper Space | No | Not supported in drawing layouts. |\n| Shop Drawing | No | Not applicable for shop drawing views. |\n\n## Prerequisites\n- **Required Entities**: At least one existing hsbCAD Beam that is currently linked to a panhandle (wall layout line).\n- **Minimum Beam Count**: 1.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse to and select `GE_BEAM_REMOVE_PANHAND.mcr`.\n3. Click **Open**.\n\n### Step 2: Select Beams\n```\nCommand Line: select a set beams\nAction: Click on the beams you wish to detach from the wall layout control. Press Enter when selection is complete.\n```\n\n### Step 3: Completion\nThe script automatically processes the selected beams, removes their link to the panhandle, and then erases itself from the drawing. A message displaying the count of affected beams will appear in the command line history.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script has no editable properties in the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add specific items to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None.\n- **Location**: N/A.\n- **Purpose**: This script operates without external settings files.\n\n## Tips\n- **\"Fire and Forget\" Script**: It is normal for this script instance to disappear immediately after processing. This indicates it has successfully finished its task.\n- **Independent Editing**: Use this script when you need to modify a specific wall beam (e.g., changing its length or position) without affecting the rest of the wall or being overwritten by wall updates.\n- **Verification**: After running the script, you can verify the disconnection by editing the wall layout line; the detached beam should no longer move or update.\n\n## FAQ\n- **Q: Does this delete my beam?**\n  **A:** No. The script only removes the logical link between the beam and the wall control line. The physical beam remains in the model.\n- **Q: Can I undo this action?**\n  **A:** You can use the standard AutoCAD `UNDO` command immediately after running the script if you made a mistake.\n- **Q: How do I put the beam back on the wall?**\n  **A:** You generally cannot simply \"re-attach\" it. You would typically need to delete the detached beam and regenerate the wall section, or manually adjust the beam to match the wall layout."
      },
      "tokens_used": 4114,
      "error": null
    }
  }
}