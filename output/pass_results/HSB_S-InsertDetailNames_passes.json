{
  "filename": "HSB_S-InsertDetailNames.mcr",
  "status": "completed",
  "total_tokens": 29645,
  "processing_time": 244.65285921096802,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "19.06.2015",
            "author": "AS",
            "changes": "Pilot version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5052,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly uses `_kModelSpace` in `TslInst.dbCreate()` calls to insert the detail name scripts. It iterates through `Element` SIP (Single Input Point) edges to determine positions, which are 3D attributes of the element. There is no usage of Viewports, `_kPaperSpace`, or `sd_` prefixes."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB_E-DetailName script file",
            "Catalog entries for detail properties"
          ]
        }
      },
      "tokens_used": 4150,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select one or more elements|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "During insertion if _kExecuteKey is empty or not found in script's catalog",
            "title": null,
            "dataSource": "Script Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sCatDetails",
            "type": "PropString",
            "displayName": "|Catalog details|",
            "defaultValue": "First entry from arSCatalogNamesDetailName",
            "inputType": "dropdown",
            "options": "arSCatalogNamesDetailName (Retrieved dynamically from HSB_E-DetailName catalogs)",
            "category": null,
            "description": "|Sets the catalog used to set the properties of the detail tsl.|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3447,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically inserts detail name labels onto timber elements based on the manufacturing codes assigned to their connection edges.",
          "category": "ShopDrawing/Annotation",
          "typicalUseCase": "Used during the detailing phase to visually label specific manufacturing details (like notches, cuts, or connections) directly on the 3D model elements for quality control or assembly visualization."
        },
        "parameters": [
          {
            "name": "sCatDetails",
            "technicalDefault": "First entry from arSCatalogNamesDetailName",
            "businessMeaning": "Selects the visual configuration (Catalog) for the detail labels. This determines the text style, height, layer, and other graphical properties of the labels generated by the detail script.",
            "validRange": "Any catalog name defined within the 'HSB_E-DetailName' script (e.g., 'Standard75', 'LargeText')",
            "unit": "String",
            "affectsOutput": "Modifies the graphical appearance (size, font, color) of the text annotations placed on the element edges."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sCatDetails selection",
            "effect": "Loads a specific set of properties from the 'HSB_E-DetailName' script's catalog to apply to the generated labels.",
            "cascade": [
              "Text Height",
              "Text Style",
              "Layer"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "TSL Instance (Annotation)",
            "description": "Creates instances of the 'HSB_E-DetailName' script, which renders text labels at the midpoint of element edges that have a detail code defined in their Single Input Point (SIP) data.",
            "appliedTo": "Selected Element (Model Space)"
          }
        ]
      },
      "tokens_used": 4569,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Initialize: Set script name 'HSB_E-DetailName' and retrieve available catalog names.\",\n    \"2. Handle Insert Cycle: If insertCycleCount > 1 (indicating a duplicate run), erase the current instance and exit.\",\n    \"3. Check Execution Context: Determine if the script was triggered by an Execute Key.\",\n    \"4. User Input (Conditional): If no Execute Key is present, display the property dialog to force user selection of 'sCatDetails'.\",\n    \"5. Entity Selection: Prompt user to select one or more Elements ('PrEntity').\",\n    \"6. Satellite Deployment Loop: Iterate through selected elements.\",\n    \"7. Cleanup Previous Instances: Remove any existing instances of 'HSB_S-InsertDetailNames' attached to the element to avoid conflicts.\",\n    \"8. Create Satellite Instance: Attach a new instance of this script to the element, passing 'MasterToSatellite' and 'ManualInsert' flags via a Map.\",\n    \"9. Installer Termination: Erase the original 'Installer' instance from the drawing (fire-and-forget pattern).\",\n    \"10. Satellite Initialization: The newly attached instance detects 'MasterToSatellite' flag and loads properties from the specific catalog entry.\",\n    \"11. Element Validation: Satellite checks if it is linked to a valid element. If not, report error and erase.\",\n    \"12. Detail Cleanup: Satellite scans the element for any existing 'HSB_E-DetailName' scripts and erases them.\",\n    \"13. SIP Processing: Retrieve Single Input Points (SIPs) and iterate through their edges.\",\n    \"14. Edge Analysis: Check if the SIP Edge contains a 'detailCode'.\",\n    \"15. Detail Creation: If a code exists, calculate coordinates and create an instance of 'HSB_E-DetailName' at the edge midpoint.\",\n    \"16. Detail Configuration: Apply the user-selected catalog ('sCatDetails') and the detail code text to the new instance.\",\n    \"17. Satellite Termination: Erase the Satellite instance, leaving only the Detail labels on the element.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Insertion Trigger (Execute Key)\",\n      \"path1\": {\n        \"name\": \"Preset Execute Key\",\n        \"steps\": [\n          \"Detect valid _kExecuteKey\",\n          \"Load properties from catalog automatically\",\n          \"Skip property dialog\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Manual Launch\",\n        \"steps\": [\n          \"Detect empty/invalid _kExecuteKey\",\n          \"Execute showDialog()\",\n          \"Wait for user to select 'Catalog details' and confirm\",\n          \"Proceed with Entity Selection\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"SIP Edge Detail Content\",\n      \"path1\": {\n        \"name\": \"Detail Code Present\",\n        \"steps\": [\n          \"Verify sDetailName.length() > 0\",\n          \"Calculate position and vectors\",\n          \"Insert HSB_E-DetailName TSL\",\n          \"Apply text and style properties\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Detail Code Empty\",\n        \"steps\": [\n          \"Verify sDetailName.length() == 0\",\n          \"Execute 'continue' (Skip this edge)\",\n          \"Proceed to next SIP Edge\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Insert Cycle Count\",\n      \"errorMessage\": \"None (Silent)\",\n      \"recovery\": \"Script automatically erases itself to prevent duplicate processing of the same selection event.\"\n    },\n    {\n      \"check\": \"Element Selection (Satellite Phase)\",\n      \"errorMessage\": \"|Invalid selection|!\",\n      \"recovery\": \"Script erases itself. User must ensure they select valid Element entities when running the script.\"\n    },\n    {\n      \"check\": \"PrEntity Selection (Installer Phase)\",\n      \"errorMessage\": \"None (Silent)\",\n      \"recovery\": \"If user cancels the selection, the script erases itself without placing any objects.\"\n    }\n  ],\n  \"postInsertionActions\": [\n    {\n      \"action\": \"Modify Detail Labels\",\n      \"how\": \"Select the resulting 'HSB_E-DetailName' instances\",\n      \"effect\": \"Since the installer script erases itself, the user must select the generated labels directly to modify them (e.g., move text, change specific properties if allowed by that sub-script).\"\n    },\n    {\n      \"action\": \"Update Detail Configuration\",\n      \"how\": \"Re-run 'HSB_S-InsertDetailNames' script on the"
      },
      "tokens_used": 7214,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_S-InsertDetailNames.mcr\n\n## Overview\nAutomatically inserts detail name labels onto timber elements in the 3D model based on manufacturing codes assigned to their connection edges. It cleans up old labels and applies a specific visual style to the new annotations.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates exclusively in the 3D model environment. |\n| Paper Space | No | Not intended for layout views or 2D drawings. |\n| Shop Drawing | No | Not intended for use within hsbShop Drawing layouts. |\n\n## Prerequisites\n- **Required Entities**: Timber Elements (Walls, Beams, or Panels) that have Single Input Point (SIP) data containing detail codes.\n- **Minimum Beam Count**: 0 (Requires Element selection, not just beams).\n- **Required Settings**:\n  - The script file `HSB_E-DetailName.mcr` must be present in the TSL search path.\n  - Valid Catalog entries (e.g., \"Standard75\") must exist within `HSB_E-DetailName` to define text styles and sizes.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_S-InsertDetailNames.mcr` from the file list.\n\n### Step 2: Select Catalog Configuration\n```\nDialog Box: Select Catalog details\nAction: Use the dropdown to choose the visual style (Catalog) for the labels (e.g., 'Standard75', 'LargeText').\nAction: Click OK to confirm.\n```\n*(Note: This step may be skipped if an Execute Key preset is used by the administrator.)*\n\n### Step 3: Select Elements\n```\nCommand Line: Select one or more elements\nAction: Click on the timber elements or walls you wish to annotate.\nAction: Press Enter to complete the selection.\n```\n*(The script will now process the elements, remove any existing detail labels on them, and insert the new ones based on the edge codes.)*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Catalog details | dropdown | First available catalog | Selects the visual configuration for the detail labels. This determines the text height, style, and layer used by the annotation script. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script uses a \"fire-and-forget\" method. It erases itself after running, so no right-click menu options are available on the script instance. |\n\n## Settings Files\n- **Filename**: Defined in `HSB_E-DetailName.mcr` catalogs\n- **Location**: hsbCAD Company or Install path\n- **Purpose**: Stores the graphical properties (Text Height, Layer, Color) for the different label styles available in the dropdown.\n\n## Tips\n- **Automatic Cleanup**: You do not need to manually delete old detail names before running this script. It automatically removes previous labels attached to the selected elements.\n- **Source Data**: Ensure your elements have valid \"Detail Codes\" assigned to their edges in the Element or Manufacturing properties. If no codes are present, no labels will be generated.\n- **Modifying Labels**: Since the main script deletes itself after running, select the individual `HSB_E-DetailName` text objects in the model if you need to move or change a specific label.\n\n## FAQ\n- **Q: Why did the script disappear after I selected the elements?**\n  **A:** This is normal behavior. The script is designed as an installer tool; it places the labels and then removes itself from the drawing to prevent clutter.\n- **Q: I ran the script, but no text appeared.**\n  **A:** Check if the selected elements have \"Detail Codes\" defined in their edge properties (SIP data). The script only creates labels where codes exist.\n- **Q: How do I change the text size?**\n  **A:** Re-run the `HSB_S-InsertDetailNames` script and select a different \"Catalog details\" option (e.g., one with larger text defined in its properties)."
      },
      "tokens_used": 5213,
      "error": null
    }
  }
}