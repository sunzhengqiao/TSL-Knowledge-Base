{
  "filename": "hsb_ColumnBaseWithFinPlate.mcr",
  "status": "completed",
  "total_tokens": 48707,
  "processing_time": 220.04487299919128,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5417,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script constructs 3D geometry using Body and Beam objects (e.g., bdTopPlate, bBottomPlate), modifies the reference beam (_Beam0) with tools (Drill, BeamCut), and employs getBeam() for user selection. No sd_ functions, _Viewport usage, or 2D drawing generation logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space with a selected beam",
          "requiredSettings": []
        }
      },
      "tokens_used": 6249,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getBeam\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"During insertion\",\n      \"title\": null,\n      \"dataSource\": \"Script Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sGrade\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Steel Grade\",\n      \"defaultValue\": \"S275\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sColor1\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dFootH\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Overall Foot Height\",\n      \"defaultValue\": \"300\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sProfile\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Extrusion profile name\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sFlipStub\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Flip Direction\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sBaseName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Name\",\n      \"defaultValue\": \"Base Plate\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dBasePlateT\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Thickness\",\n      \"defaultValue\": \"20\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dBasePlateL\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Length\",\n      \"defaultValue\": \"400\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dBasePlateW\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Width\",\n      \"defaultValue\": \"300\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"nBaseRows\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Rows\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"nBaseCols\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Columns\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"dRowDistBase\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Row Centers\",\n      \"defaultValue\": \"100\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"dColDistBase\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Col Centers\",\n      \"defaultValue\": \"100\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n"
      },
      "tokens_used": 9230,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates a steel column base connection consisting of a height-adjustable stub (column section), a bottom base plate for anchoring, a top bearing plate, and a side fin plate. The fin plate slots into and bolts through the selected timber beam for lateral stability.\",\n    \"category\": \"Steel Connections / Column Bases\",\n    \"typicalUseCase\": \"Connecting a timber column to a concrete foundation or steel structure using a custom steel stub, where the timber column sits on a bearing plate and is secured laterally by a bolted fin plate.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sGrade\",\n      \"technicalDefault\": \"S275\",\n      \"businessMeaning\": \"Specifies the material grade of the steel plates and stub (e.g., S275, S355) for structural calculations and CAM output.\",\n      \"validRange\": \"Standard steel grades (S235, S275, S355, etc.)\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Material properties assigned to generated steel bodies.\"\n    },\n    {\n      \"name\": \"sColor1\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Visual color of the generated steel parts in the 3D model.\",\n      \"validRange\": \"AutoCAD Color Index (0-255) or ByLayer (-1)\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual representation in CAD.\"\n    },\n    {\n      \"name\": \"dFootH\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"The vertical height of the steel stub (distance between the Top Plate and Base Plate). Used to raise the timber column to a specific level.\",\n      \"validRange\": \"50mm to 2000mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Length of the intermediate steel column/stub.\"\n    },\n    {\n      \"name\": \"sProfile\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The cross-sectional profile of the steel stub (e.g., HEA100, SHS 100x100, Rectangular Tube).\",\n      \"validRange\": \"Available extrusion profiles in catalog\",\n      \"unit\": \"Profile Name\",\n      \"affectsOutput\": \"Geometry and dimensions of the vertical stub body.\"\n    },\n    {\n      \"name\": \"sFlipStub\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Rotates the stub profile 90 degrees around the vertical axis, swapping width and depth alignment.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Orientation of the stub cross-section relative to the global axes.\"\n    },\n    {\n      \"name\": \"dBasePlateT\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Thickness of the bottom steel plate that anchors to the foundation.\",\n      \"validRange\": \"10mm to 50mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Thickness of Base Plate Body.\"\n    },\n    {\n      \"name\": \"dBasePlateL\",\n      \"technicalDefault\": \"400\",\n      \"businessMeaning\": \"Length of the base plate (usually along the major axis of the stub).\",\n      \"validRange\": \"150mm to 1000mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Size of Base Plate Body.\"\n    },\n    {\n      \"name\": \"dBasePlateW\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"Width of the base plate.\",\n      \"validRange\": \"150mm to 1000mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Size of Base Plate Body.\"\n    },\n    {\n      \"name\": \"nBaseRows\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Number of anchor bolt holes arranged along the width of the base plate.\",\n      \"validRange\": \"1 to 6\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Quantity of drill holes in Base Plate.\"\n    },\n    {\n      \"name\": \"nBaseCols\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Number of anchor bolt holes arranged along the length of the base plate.\",\n      \"validRange\": \"1 to 6\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Quantity of drill holes in Base Plate.\"\n    },\n    {\n      \"name\": \"dRowDistBase\",\n      \"technicalDefault\": \"100\",\n      \"businessMeaning\": \"Center-to-center spacing between anchor bolt holes along the width.\",\n      \"validRange\": \"50mm to Plate Width\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positioning of drill holes in Base Plate.\"\n    },\n    {\n      \"name\": \"dColDistBase\",\n      \"technicalDefault\": \"100\",\n      \"businessMeaning\": \"Center-to-center spacing between anchor bolt holes along the length.\",\n      \"validRange\": \"50mm to Plate Length\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positioning of drill holes in Base Plate.\"\n    },\n    {\n      \"name\": \"dBasePlateDrill\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Diameter of the holes for anchor rods in the base plate.\",\n      \"validRange\": \"12mm to 50mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Diameter of drill holes in Base Plate.\"\n    },\n    {\n"
      },
      "tokens_used": 10139,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11478,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ColumnBaseWithFinPlate.mcr\n\n## Overview\nGenerates a steel column base connection consisting of a height-adjustable stub (column section), a bottom base plate for anchoring, a top bearing plate, and a side fin plate. The fin plate slots into and bolts through the selected timber beam for lateral stability.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script constructs 3D geometry and requires a selected beam. |\n| Paper Space | No | Not designed for 2D drawing generation. |\n| Shop Drawing | No | Generates physical elements, not views. |\n\n## Prerequisites\n- **Required Entities**: At least one GenBeam (Timber Beam).\n- **Minimum Beam Count**: 1.\n- **Required Settings**: Ensure an extrusion profile catalog is available if using the `sProfile` property.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_ColumnBaseWithFinPlate.mcr`\n\n### Step 2: Select Timber Beam\n```\nCommand Line: \nAction: Click on the timber beam (column) that will receive the base connection.\n```\n\n### Step 3: Locate Insertion Point\n```\nCommand Line: \nAction: Click in the 3D model to position the base of the steel column stub.\n```\n\n### Step 4: Configure Parameters\n```\nDialog: Dynamic Properties\nAction: Adjust dimensions (Plate sizes, Stub height, Drill patterns) and click OK to generate.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Steel Grade** | Text | S275 | Specifies the material grade of the steel plates and stub (e.g., S275, S355). |\n| **Color** | Number | -1 | Visual color of the generated steel parts (-1 = ByLayer). |\n| **Overall Foot Height** | Number | 300 | Vertical height of the steel stub (distance between Top Plate and Base Plate). |\n| **Extrusion profile name** | Dropdown | | Cross-sectional profile of the steel stub (e.g., HEA100, SHS 100x100). |\n| **Flip Direction** | Dropdown | Yes | Rotates the stub profile 90 degrees around the vertical axis. |\n| **Name** | Text | Base Plate | Identifier for the Base Plate element. |\n| **Base Plate Thickness** | Number | 20 | Thickness of the bottom steel plate anchoring to the foundation. |\n| **Base Plate Length** | Number | 400 | Length of the base plate. |\n| **Base Plate Width** | Number | 300 | Width of the base plate. |\n| **Quantity of Drill Rows** | Number | 3 | Number of anchor bolt holes along the width. |\n| **Quantity of Drill Columns** | Number | 3 | Number of anchor bolt holes along the length. |\n| **Drill Row Centers** | Number | 100 | Center-to-center spacing between holes along the width. |\n| **Drill Col Centers** | Number | 100 | Center-to-center spacing between holes along the length. |\n| **Base Plate Drill** | Number | 20 | Diameter of the holes for anchor rods in the base plate. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (Standard hsbCAD Context) | Standard options like **Erase** or **Edit** are available to regenerate or delete the element. |\n\n## Settings Files\n- **Filename**: None specified.\n- **Location**: N/A\n- **Purpose**: This script relies on standard hsbCAD profile catalogs for the stub profile.\n\n## Tips\n- Use the **Flip Direction** property if the steel stub profile is oriented incorrectly relative to the timber beam's width.\n- Ensure the **Drill Row/Col Centers** are set small enough so holes fit within the **Base Plate** dimensions.\n- The script automatically creates cuts/drills in the selected timber beam for the fin plate connection.\n\n## FAQ\n- Q: Can I use a rectangular tube for the stub?\n  A: Yes, select the desired profile name from the **Extrusion profile name** dropdown in the properties.\n- Q: How do I raise the timber column off the floor?\n  A: Increase the **Overall Foot Height** value. This extends the length of the steel stub between the top and bottom plates."
      },
      "tokens_used": 6194,
      "error": null
    }
  }
}