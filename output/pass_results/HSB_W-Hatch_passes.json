{
  "filename": "HSB_W-Hatch.mcr",
  "status": "completed",
  "total_tokens": 60864,
  "processing_time": 612.4648909568787,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9535,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script creates and modifies 3D physical elements using Beam.dbCreate and Sheet.dbCreate. It retrieves geometry via el.beam() and el.sheet(), performs 3D geometric calculations (Plane, Point3d intersections), and modifies the Element structure by joining rings and splitting sheets. It lacks viewport detection or 2D drawing generation patterns typical of Shop Drawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Beam",
            "Sheet"
          ],
          "minimumBeams": 4,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6994,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "|Select a knee wall|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Select a position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Insert (if _kExecuteKey is empty)",
            "title": "Properties",
            "dataSource": "TSL script properties (PropDouble/PropInt/PropString)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeparator01",
            "type": "PropString",
            "displayName": "Hatch",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sHatchType",
            "type": "PropString",
            "displayName": "Type hatch",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "Rotating",
              "On studs"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "sSeparator04",
            "type": "PropString",
            "displayName": "All hatches",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dGapShutter",
            "type": "PropDouble",
            "displayName": "Gap hatch",
            "defaultValue": "2",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 11,
            "variable": "sOffsetTrimmerFromFloor",
            "type": "PropString",
            "displayName": "Offset horizontal trimmer from floor",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|Yes|",
              "|No|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dFloorHeight",
            "type": "PropDouble",
            "displayName": "Flooroffset from wall outline",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dFloorOffset",
            "type": "PropDouble",
            "displayName": "Offset from floor",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "znIndexSheet",
            "type": "PropInt",
            "displayName": "Zone index sheeting",
            "defaultValue": "0",
            "inputType": "dropdown",
            "options": [
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10
            ],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sSeparator03",
            "type": "PropString",
            "displayName": "Rotating hatch",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sTurningDirection",
            "type": "PropString",
            "displayName": "Turning direction",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "|Left|",
              "|Right|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sMaterialShutter",
            "type": "PropString",
            "displayName": "Material hatch",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 12,
            "variable": "sNameShutter",
            "type": "PropString",
            "displayName": "Name hatch",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 13,
            "variable": "sGradeShutter",
            "type": "PropString",
            "displayName": "Grade hatch",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dThicknessShutter",
            "type": "PropDouble",
            "displayName": "Thickness hatch",
            "defaultValue": "-1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": "Auto from sheeting zone if -1"
          },
          {
            "index": 0,
            "variable": "nColorShutter",
            "type": "PropInt",
            "displayName": "Color hatch",
            "defaultValue": "3",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "nZnIndexHatch",
            "type": "PropInt",
            "displayName": "Zone index hatch",
            "defaultValue": "2",
            "inputType": "dropdown",
            "options": [
              1,
              2,
              3,
              4,
              5,
              6,
              7,
              8,
              9,
              10
            ],
            "category": null,
            "description": null
          },
          {
            "index": 9,
            "variable": "sSeparator05",
            "type": "PropString",
            "displayName": "Hatch on studs",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 10,
            "variable": "sRotateExtraBeam",
            "type": "PropString",
            "displayName": "Rotate horizontal trimmer",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|Yes|",
              "|No|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sSeparator02",
            "type": "PropString",
            "displayName": "Style",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimension style|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sLineType",
            "type": "PropString",
            "displayName": "Line type|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "_LineTypes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color|",
            "defaultValue": "-1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Set Properties From Zone",
            "handler": "sCustomCommandSetPropertiesFromZone",
            "action": "Updates material, name, grade, and thickness properties based on the element's zone and sheeting data if values are empty or set to 'Auto'.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 10060,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Creates and manages a roof hatch (skylight) opening in a knee wall, supporting both a rotating hatch assembly and a split-sheeting configuration with automated trimming and property management.\",\n    \"category\": \"Framing\",\n    \"typicalUseCase\": \"Used when detailing a roof access hatch in a knee wall to ensure the structural opening is framed, sheeting is cut or modified correctly, and material properties match the wall specifications.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sHatchType\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Specifies the construction method: 'Rotating' creates a dedicated cover sheet and pivot lath; 'On studs' splits the existing wall sheeting to form the opening.\",\n      \"validRange\": \"Rotating, On studs\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Determines the geometric generation logic (Sheet creation vs Sheet splitting) and which specific sub-parameters are relevant.\"\n    },\n    {\n      \"name\": \"dGapShutter\",\n      \"technicalDefault\": \"2\",\n      \"businessMeaning\": \"The clearance gap maintained between the hatch frame and the surrounding structure.\",\n      \"validRange\": \"0 - 10\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Defines the expansion/shrinkage of the opening profile in 'Rotating' mode or the split offset in 'On studs' mode.\"\n    },\n    {\n      \"name\": \"sOffsetTrimmerFromFloor\",\n      \"technicalDefault\": \"|Yes|\",\n      \"businessMeaning\": \"Determines if the bottom trimmer beam height is calculated based on the floor elevation or the wall bottom plate.\",\n      \"validRange\": \"|Yes|, |No|\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Controls the vertical placement calculation of the bottom horizontal trimmer.\"\n    },\n    {\n      \"name\": \"dFloorHeight\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Vertical distance offset applied to the trimmer position relative to the floor outline.\",\n      \"validRange\": \"-500 - 2000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Adjusts the Y-coordinate of the bottom trimmer.\"\n    },\n    {\n      \"name\": \"dFloorOffset\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Fine adjustment for the trimmer height, often used for finish floor tolerances.\",\n      \"validRange\": \"-200 - 200\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Adds a vertical shift to the bottom trimmer position.\"\n    },\n    {\n      \"name\": \"znIndexSheet\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"The index of the wall construction zone used to source default material properties.\",\n      \"validRange\": \"1 - 10\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Used by the 'Set Properties From Zone' command to find material and thickness defaults.\"\n    },\n    {\n      \"name\": \"sTurningDirection\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The direction the hatch cover opens (Left or Right).\",\n      \"validRange\": \"|Left|, |Right|\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Positions the pivot lath (H-R02/H-L02) and draws the correct swing indicator geometry.\"\n    },\n    {\n      \"name\": \"sMaterialShutter\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The material specification (e.g., 'C24', 'PLY18') for the hatch sheet.\",\n      \"validRange\": \"Any valid material code\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Sets the material property of the generated or modified sheet.\"\n    },\n    {\n      \"name\": \"sNameShutter\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The specific name or code identifying the hatch sheet part.\",\n      \"validRange\": \"Any valid string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Sets the name property of the sheet.\"\n    },\n    {\n      \"name\": \"sGradeShutter\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The structural grade of the hatch material.\",\n      \"validRange\": \"Any valid grade string\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Sets the grade property of the sheet.\"\n    },\n    {\n      \"name\": \"dThicknessShutter\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Thickness of the hatch sheet. A value of -1 enables automatic detection from the sheeting zone.\",\n      \"validRange\": \"-1 or > 0 (typically 12-30mm)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Controls the 3D body thickness of the hatch sheet in 'Rotating' mode.\"\n    },\n    {\n      \"name\": \"nColorShutter\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"The CAD color index for visual representation of the hatch sheet.\",\n      \"validRange\": \"0 - 255\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual color of the sheet entity.\"\n    },\n    {\n      \"name\": \"nZnIndexHatch\",\n      \"technicalDefault\": \"2\",\n      \"businessMeaning\": \"The construction zone index to which the hatch sheet belongs.\",\n      \"validRange\": \"1 - 10\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Assigns the sheet to the correct zone in the element hierarchy.\"\n    },\n    {\n      \"name\": \"sRotateExtraBeam\",\n      \"technicalDefault\": \"|Yes|\",\n      \"businessMeaning\": \"Determines if the bottom trimmer beam is rotated 90 degrees.\",\n      \"validRange\": \"|Yes|, |No|\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Swaps the width and height orientation of the bottom trimmer beam.\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The dimension style applied to the hatch text labels.\",\n      \"validRange\": \"Defined in _DimStyles\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Visual appearance of text indicating size and material.\"\n    },\n    {\n      \"name\": \"sLineType\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The line type used for drawing the hatch swing indicator.\",\n      \"validRange\": \"Defined in _LineTypes\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Visual style of the opening direction lines.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"The color for the drawing indicators (text and lines).\",\n      \"validRange\": \"-1 or 0 - 255\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual color of the annotation overlays.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sHatchType = 'Rotating'\",\n      \"effect\": \"Activates logic to create a new Sheet and pivot Beam. 'dGapShutter' shrinks the sheet profile.\",\n      \"cascade\": [\"sTurningDirection\", \"nZnIndexHatch\", \"dThicknessShutter\"]\n    },\n    {\n      \"trigger\": \"sHatchType = 'On studs'\",\n      \"effect\": \"Activates logic to split existing wall sheets. 'dGapShutter' defines the cut gap.\",\n      \"cascade\": [\"dGapShutter\", \"sMaterialShutter\"]\n    },\n    {\n      \"trigger\": \"dThicknessShutter = -1\",\n      \"effect\": \"Retrieves default thickness from the zone specified by 'znIndexSheet'.\",\n      \"cascade\": [\"znIndexSheet\"]\n    },\n    {\n      \"trigger\": \"sOffsetTrimmerFromFloor = '|Yes|'\",\n      \"effect\": \"Enables the use of 'dFloorHeight' and 'dFloorOffset' to position the trimmer.\",\n      \"cascade\": [\"dFloorHeight\", \"dFloorOffset\"]\n    },\n    {\n      \"trigger\": \"Context Menu: 'Set Properties From Zone'\",\n      \"effect\": \"Automatically populates Material, Name, and Grade if they are empty.\",\n      \"cascade\": [\"sMaterialShutter\", \"sNameShutter\", \"sGradeShutter\"]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Sheet\",\n      \"description\": \"In 'Rotating' mode, a new sheet is created for the hatch cover. In 'On studs' mode, existing sheets are split.\",\n      \"appliedTo\": \"Selected Element (Knee Wall)\"\n    },\n    {\n      \"type\": \"Beam (Trimmer)\",\n      \"description\": \"A horizontal beam added at the bottom of the opening to frame the hatch.\",\n      \"appliedTo\": \"Selected Element\"\n    },\n    {\n      \"type\": \"Beam (Lath)\",\n      \"description\": \"A vertical beam added in 'Rotating' mode to serve as a pivot for the"
      },
      "tokens_used": 11769,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script Launch: User executes script from hsbCAD toolbar.\",\n    \"Check Execution Context: Determine if _bOnInsert (new insertion) or recalculation.\",\n    \"[Insert Mode] Show Dialog: Display Properties dialog if _kExecuteKey is empty.\",\n    \"Select Element: Prompt user to select a knee wall Element.\",\n    \"Select Position: Prompt user to pick a point to define the hatch location.\",\n    \"Validate Input: Check if the point is parallel to wall Z vector; adjust if necessary.\",\n    \"Store Execution Mode: Set internal Map 'ExecuteMode' to 1 and exit to trigger recalculation.\",\n    \"[Recalculation Mode] Restore Context: Retrieve 'ExecuteMode' from Map (1 for Insert, 0 for Update).\",\n    \"Auto-Properties Logic: If mode is 1 or 'Set Properties From Zone' triggered, query Element Zone and Sheets to auto-fill Material, Name, Grade, and Thickness.\",\n    \"Filter Beams: Retrieve Element beams and filter into Vertical (studs) and Horizontal (plates) arrays.\",\n    \"Identify Boundary Beams: Locate Left, Right, Top, and Bottom beams based on insertion point.\",\n    \"Validation Check: Ensure Left/Right studs and Top/Bottom plates exist. If not, warn and erase script instance.\",\n    \"[Conditional: Insert Mode] Create Trimmer: Calculate position for horizontal trimmer (H-B01) based on floor offset settings. Create beam, rotate if specified, and stretch to side studs.\",\n    \"Check Hatch Type: Evaluate sHatchType property ('Rotating' vs 'On studs').\",\n    \"[Branch: Rotating Hatch] Subtract Sheet Ring: Calculate profile and subtract ring from existing wall sheets in the zone.\",\n    \"[Branch: Rotating Hatch] Create Hatch Parts: Generate pivot lath (H-R02/H-L02) and cover Sheet. Set properties (Material, Grade, Thickness).\",\n    \"[Branch: On Studs Hatch] Split Sheets: Iterate through zone sheets. Split at Left, Right, and Bottom planes using calculated gap.\",\n    \"[Branch: On Studs Hatch] Update Sheet Properties: Apply Material, Name, Grade, and Color to the bottom sheet segment resulting from the split.\",\n    \"[Common] Visualize: Draw lines and text indicating hatch opening direction and dimensions.\",\n    \"Completion: Reset executeMode to 0.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"sHatchType Property Value\",\n      \"path1\": {\n        \"name\": \"Rotating Hatch\",\n        \"steps\": [\n          \"Calculate opening profile based on inner faces of boundary beams.\",\n          \"Subtract the opening profile from existing wall sheets (joinRing _kSubtract).\",\n          \"Calculate pivot lath position based on turning direction (Left/Right).\",\n          \"Create new pivot Beam (H-L02 or H-R02).\",\n          \"Create new cover Sheet with specific thickness and material properties.\",\n          \"Draw swing direction lines and text labels.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"On Studs\",\n        \"steps\": [\n          \"Calculate split planes for Left, Right, and Bottom boundaries, accounting for the Gap.\",\n          \"Iterate through existing sheets in the zone.\",\n          \"Split sheets at Left and Right vertical planes.\",\n          \"Split resulting sheets at Bottom horizontal plane.\",\n          \"Identify the sheet segment inside the opening area.\",\n          \"Update properties of the identified sheet segment (Material, Name, Grade, Color).\",\n          \"Draw crossing lines inside the opening.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"sOffsetTrimmerFromFloor Property Value\",\n      \"path1\": {\n        \"name\": \"Yes\",\n        \"steps\": [\n          \"Calculate bottom trimmer Y-position relative to wall origin.\",\n          \"Add 'Flooroffset from wall outline' (dFloorHeight) and 'Offset from floor' (dFloorOffset).\",\n          \"Place trimmer at calculated height.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"No\",\n        \"steps\": [\n          \"Calculate bottom trimmer Y-position based on selected point.\",\n          \"Use standard relative offsets without floor height adjustments.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Trigger 'Set Properties From Zone' vs Insertion\",\n      \"path1\": {\n        \"name\": \"Insertion / Element Constructed\",\n        \"steps\": [\n          \"Retrieve Material, Name, Grade, and Thickness from Zone/Sheets.\",\n          \"Check if user has manually entered values for these properties.\",\n          \"If user value exists, use user value; otherwise, use Zone value.\",\n          \"For Thickness: If user value is -1, use Zone value.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Context Menu Command\",\n        \"steps\": [\n          \"Retrieve Material, Name, and Grade from Zone/Sheets.\",\n          \"Overwrite existing script properties with these values.\",\n          \"Thickness is NOT updated in this mode (cannot rebuild Sheet body easily).\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Existence of Side Studs\",\n      \"errorMessage\": TN(\"|Invalid side studs|.\"),\n      \"recovery\": \"Script instance is erased. User must select a position with valid vertical beams on both sides.\"\n    },\n    {\n      \"check\": \"Existence of Plates (Top/Bottom)\",\n      \"errorMessage\": TN(\"|Invalid plates|.\"),\n      \"recovery\": \"Script instance is erased. User must select a position within a valid bay bounded by horizontal beams.\"\n    },\n    {\n      \"check\": \"Availability of Sheet Data for Auto-Properties\",\n      \"errorMessage\": \"Unable to define new Name and Grade\",\n      \"recovery\": \"A report message is generated. The script continues, but Name and Grade may remain empty if the zone has no sheets.\"\n    }\n  ],\n  \"postInsertionActions\": [\n    {\n      \"action\": \"Modify Hatch Dimensions/Gap\",\n      \"how\": \"OPM Properties Palette\",\n      \"effect\": \"Changing 'Gap hatch' or 'Offset' properties updates the geometry (Sheet size or Split planes) on recalculation.\"\n    },\n    {\n      \"action\": \"Update Properties from Zone\",\n      \"how\": \"Context Menu > Set Properties From Zone\",\n      \"effect\": \"Refreshes Material, Name, and Grade based on the current Element zone configuration, overriding manual inputs.\"\n    },\n    {\n      \"action\": \"Move Hatch Location\",\n      \"how\": \"Grip Edit (Move instance point)\",\n      \"effect\": \"The boundary beams (Left/Right/Top/Bottom) are re-identified, and the hatch geometry is regenerated at the new location.\"\n    },\n    {\n      \"action\": \"Change Hatch Type\",\n      \"how\": \"OPM Properties Palette (Type hatch)\",\n      \"effect\": \"Switching between 'Rotating' and 'On studs' toggles the generation method (Creating new sheet vs Splitting existing sheets).\"\n    }\n  ]\n}\n```"
      },
      "tokens_used": 12873,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_W-Hatch.mcr\n\n## Overview\nThis script automates the creation of a roof hatch (skylight) opening within a knee wall. It supports two modes: creating a rotating hatch assembly with a cover sheet or modifying the existing wall sheeting (\"On studs\") to form the opening, including automated trimmer beam insertion.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for 3D element creation and modification. |\n| Paper Space | No | |\n| Shop Drawing | No | This script generates physical construction elements. |\n\n## Prerequisites\n- An existing **Element** (Knee Wall) in the model.\n- A minimum of **4 Beams** (studs and plates) to frame the opening.\n- The script must be run in **3D Model Space**.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_W-Hatch.mcr`\n\n### Step 2: Select Wall\n```\nCommand Line: Select a knee wall\nAction: Click on the knee wall element where you want to insert the hatch.\n```\n\n### Step 3: Define Location\n```\nCommand Line: Select a position\nAction: Click inside the wall bay (between studs and plates) to define the center/bottom location of the hatch.\n```\n\n### Step 4: Configure Properties\nAfter selecting the position, the **Properties Palette** (or a dynamic dialog) will appear. Adjust the hatch type, dimensions, and materials as needed. The script will automatically generate the framing and sheeting based on these settings.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Hatch** | | | |\n| Type hatch | dropdown | | Selects the construction method: \"Rotating\" (creates a cover sheet and pivot lath) or \"On studs\" (splits existing wall sheeting). |\n| Gap hatch | number | 2 | Clearance gap between the hatch frame and the surrounding structure (mm). |\n| **All hatches** | | | |\n| Offset horizontal trimmer from floor | dropdown | \\|Yes\\| | If \"Yes\", the bottom trimmer height is calculated based on floor elevation. |\n| Flooroffset from wall outline | number | 0 | Vertical distance offset applied to the trimmer position relative to the floor outline (mm). |\n| Offset from floor | number | 0 | Fine adjustment for the trimmer height relative to the floor (mm). |\n| Zone index sheeting | dropdown | 0 | The construction zone index used to source default material properties. |\n| **Rotating hatch** | | | |\n| Turning direction | dropdown | | Direction the hatch opens: \"\\|Left\\|\" or \"\\|Right\\|\". |\n| Material hatch | text | | Material code for the hatch sheet (e.g., C24). |\n| Name hatch | text | | Specific name identifying the hatch sheet part. |\n| Grade hatch | text | | Structural grade of the hatch material. |\n| Thickness hatch | number | -1 | Thickness of the hatch sheet. Set to -1 to detect automatically from the sheeting zone. |\n| Color hatch | number | 3 | CAD color index for the hatch sheet. |\n| Zone index hatch | dropdown | 2 | Construction zone index to which the hatch sheet belongs. |\n| **Hatch on studs** | | | |\n| Rotate horizontal trimmer | dropdown | \\|Yes\\| | If \"Yes\", the bottom trimmer beam is rotated 90 degrees. |\n| **Style** | | | |\n| Dimension style\\| | dropdown | | Dimension style applied to hatch text labels. |\n| Line type\\| | dropdown | | Line type used for drawing the hatch swing indicator. |\n| Color\\| | number | -1 | Color for drawing indicators (text and lines). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Set Properties From Zone | Automatically updates the Material, Name, Grade, and Thickness properties based on the element's zone and sheeting data. Useful if the current values are empty or need to match the wall configuration. |\n\n## Settings Files\nNone required.\n\n## Tips\n- **Valid Location is Key:** Ensure you click inside a valid bay bounded by vertical studs and horizontal plates. If the script cannot find these boundaries, it will erase itself and display an error.\n- **Switching Types:** You can switch between \"Rotating\" and \"On studs\" via the Properties Palette after insertion. The script will either create a new sheet or split the existing ones accordingly.\n- **Auto-Detect Thickness:** Leave \"Thickness hatch\" set to -1 to have the script automatically match the thickness of the existing wall sheeting in the selected zone.\n- **Moving the Hatch:** Use the grip edit point to move the hatch to a different location on the wall. The script will recalculate the necessary framing and cuts.\n\n## FAQ\n- **Q: Why did the script disappear after I picked a point?**\n  **A:** The script requires valid vertical studs on the sides and horizontal plates on the top and bottom of the selected point. If these are missing, the script deletes itself to prevent errors.\n  \n- **Q: How do I adjust the size of the opening?**\n  **A:** The opening size is determined by the position relative to the wall framing. Move the insertion point closer to studs to make it narrower or adjust the \"Gap hatch\" property to change the clearance.\n\n- **Q: What is the difference between the \"Rotating\" and \"On studs\" types?**\n  **A:** \"Rotating\" creates a new physical sheet that acts as a door, complete with a pivot beam. \"On studs\" simply cuts a hole in the existing wall sheathing and modifies the bottom segment's properties."
      },
      "tokens_used": 9633,
      "error": null
    }
  }
}