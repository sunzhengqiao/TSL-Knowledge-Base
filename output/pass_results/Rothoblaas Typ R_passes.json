{
  "filename": "Rothoblaas Typ R.mcr",
  "status": "completed",
  "total_tokens": 53972,
  "processing_time": 293.143394947052,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9898,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script generates 3D geometry using 'Body' and 'PLine' classes and modifies structural elements with 'Cut', 'Drill', and 'BeamCut'. It uses 'bm0.addTool()' to apply modifications to beams. The summary states it creates post bases 'on one or multiple beams'. No 'sd_' prefixes, '#Type E' definitions, or '_Viewport' logic characteristic of Paper Space scripts were found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "The script operates in the 3D model on selected beams.",
          "requiredSettings": []
        }
      },
      "tokens_used": 7684,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getGenBeam",
              "promptOriginal": "Select beam(s) or [Point]",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select point for base insertion",
              "condition": "bGetPoint == true",
              "required": false
            }
          ],
          "keywordOptions": [
            {
              "prompt": "Select beam(s) or [Point]",
              "options": [
                "Point"
              ]
            }
          ]
        },
        "dialogs": [
          {
            "type": "SelectFromList",
            "trigger": "During insertion if no execute key preset is provided",
            "title": "Rothoblaas Typ R",
            "dataSource": "Internal script array sFamilies",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sFamily",
            "type": "PropString",
            "displayName": "A - Type",
            "defaultValue": "R10",
            "inputType": "dropdown",
            "options": [
              "R10",
              "R20",
              "R30",
              "R40"
            ],
            "category": "Category",
            "description": "Type:\n R10 = Flat top plate\n R20 = Top plate with threaded rod\n R30 = Disc type top plate with threaded rod\n R40 = uncovered, passing through threaded rod"
          },
          {
            "index": 1,
            "variable": "sSize",
            "type": "PropString",
            "displayName": "B - Size",
            "defaultValue": "1",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3"
            ],
            "category": "Category",
            "description": "R10 Size:\n 1 = 130 - 165mm\n 2 = 160 - 205mm\n 3 = 190 - 250mm"
          },
          {
            "index": 2,
            "variable": "sMill",
            "type": "PropString",
            "displayName": "D - Milled",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Tooling",
            "description": null
          },
          {
            "index": 3,
            "variable": "dMillDepth",
            "type": "PropDouble",
            "displayName": "E - Additional mill depth",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "Tooling",
            "description": null
          },
          {
            "index": 4,
            "variable": "sMounting",
            "type": "PropString",
            "displayName": "C - Mounting",
            "defaultValue": "HBS+ evo",
            "inputType": "dropdown",
            "options": [
              "HBS+ evo",
              "Screw DISC",
              "AB1",
              "SKR",
              "VINYLPRO",
              "EPOPLUS"
            ],
            "category": "Category",
            "description": "Mounting:\n HBS+ evo = Wood construction screw\n Screw DISC = Screw for Type R30\n AB1 = Expansion anchor\n SKR = Screw anchor\n VINYLPRO = Chemical dowel VINYLPRO\n EPOPLUS = Chemical dowel EPOPLUS"
          },
          {
            "index": 5,
            "variable": "dScrewLengthBottom",
            "type": "PropDouble",
            "displayName": "F - Screw length bottom",
            "defaultValue": "80",
            "inputType": "number",
            "options": [],
            "category": "Tooling",
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Rotate post base",
            "handler": "Rotate post base",
            "action": "Toggles rotation of the post base by 90 degrees",
            "alsoTriggeredBy": "TslDoubleClick"
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 8458,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates 3D models and shop drawings for Rothoblaas Typ R adjustable post bases, including necessary machining (drilling, milling, cutting) on the selected timber beam.",
          "category": "Hardware / Fasteners",
          "typicalUseCase": "Detailing the connection between a timber column and a concrete foundation where height adjustability is required."
        },
        "parameters": [
          {
            "name": "sFamily",
            "technicalDefault": "R10",
            "businessMeaning": "Selects the design variant of the post base. R10 has a flat top plate; R20/R30 include threaded rods and vertical tubes; R40 is a version with a continuous threaded rod passing through.",
            "validRange": "R10, R20, R30, R40",
            "unit": "Enum",
            "affectsOutput": "Changes the entire 3D geometry of the hardware (presence of rods, discs, tubes), the depth of the drilling in the beam, and the available size options."
          },
          {
            "name": "sSize",
            "technicalDefault": "1",
            "businessMeaning": "Selects the specific dimensions of the base, which correlates to the height adjustment range and the physical width/thickness of the base plates.",
            "validRange": "1 to 4 (depending on Family)",
            "unit": "Index",
            "affectsOutput": "Updates the scale of the 3D model (plate dimensions, tube diameters) and sets the depth of the required drilling and cutting on the timber."
          },
          {
            "name": "sMounting",
            "technicalDefault": "HBS+ evo",
            "businessMeaning": "Specifies the type of fastener used to anchor the bottom of the post base to the substrate (e.g., concrete).",
            "validRange": "HBS+ evo, Screw DISC, AB1, SKR, VINYLPRO, EPOPLUS",
            "unit": "Enum",
            "affectsOutput": "Updates the Bill of Materials (BOM) and hardware list to reflect the specific anchor screws required. Does not change the timber machining."
          },
          {
            "name": "sMill",
            "technicalDefault": "No",
            "businessMeaning": "Determines whether the top plate of the post base should be recessed (countersunk/milled) into the timber beam end.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "If 'Yes', adds a milling operation (BeamCut or Drill) to the beam head to create a recess for the top plate."
          },
          {
            "name": "dMillDepth",
            "technicalDefault": "0",
            "businessMeaning": "Defines an extra depth for the milling operation beyond the standard thickness of the top plate.",
            "validRange": "0 - 100mm",
            "unit": "mm",
            "affectsOutput": "Deepens the recess cut into the timber beam if 'Milled' is set to Yes."
          },
          {
            "name": "dScrewLengthBottom",
            "technicalDefault": "80",
            "businessMeaning": "Specifies the length of the anchor screw for the bottom connection.",
            "validRange": "Manufacturer specific (e.g., 60-200mm)",
            "unit": "mm",
            "affectsOutput": "Updates the description and labeling of the hardware in reports/BOM. Does not alter the 3D geometry of the timber or the base."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing sFamily (Type)",
            "effect": "Updates the list of available sizes (sSize) as each Type has different dimensional options.",
            "cascade": [
              "sSize"
            ]
          },
          {
            "trigger": "Changing sMill to 'No'",
            "effect": "The dMillDepth parameter becomes irrelevant as no milling operation is generated.",
            "cascade": [
              "dMillDepth"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Body",
            "description": "3D representation of the Rothoblaas Typ R post base (plates, tubes, rods) constructed from Primitives.",
            "appliedTo": "Model Space (visual representation)"
          },
          {
            "type": "Cut",
            "description": "A perpendicular cut at the insertion point to shorten the beam to accommodate the base height.",
            "appliedTo": "Selected GenBeam"
          },
          {
            "type": "Drill",
            "description": "A central hole drilled along the beam axis to accommodate the threaded rod of the post base.",
            "appliedTo": "Selected GenBeam"
          },
          {
            "type": "BeamCut / Drill",
            "description": "A recess operation (milling) at the beam head to sink the top plate flush (or deeper) into the timber.",
            "appliedTo": "Selected GenBeam (Conditional: if Milled = Yes)"
          },
          {
            "type": "HardWrComp",
            "description": "BOM entries for the post base assembly, top wood screws, and bottom concrete anchors.",
            "appliedTo": "Script Instance (Reports/BOM)"
          }
        ]
      },
      "tokens_used": 10151,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script via catalog or command line.",
          "2. Script checks if an execute key (catalog preset) is provided.",
          "3. [Conditional] If valid execute key for Family exists, skip dialog; else show Family Selection Dialog.",
          "4. Script defines available 'Sizes' based on the selected 'Family' (R10/R20/R30/R40).",
          "5. [Conditional] If valid execute key for specific Size exists, use it; else default to first available Size.",
          "6. Script prompts: 'Select beam(s) or [Point]' (getGenBeam).",
          "7. [Conditional] If user selects 'Point' keyword at command line, script prompts: 'Select point for base insertion' (getPoint).",
          "8. Script calculates insertion point on beam(s) (bottom of vertical beam default vs projected point).",
          "9. Script generates 3D Post Base geometry (Body) based on parameters.",
          "10. Script applies tools to beam: Cut (perpendicular), Drill (central rod), and optional Milling (if 'Milled' = Yes).",
          "11. Script updates BOM/HardWrComps with post base, top screws, and bottom anchors.",
          "12. Instance is created in Model Space."
        ],
        "conditionalBranches": [
          {
            "condition": "Execute Key / Catalog Entry provided",
            "path1": {
              "name": "Catalog Preset Path",
              "steps": [
                "Reads Family key (e.g., 'R20')",
                "Reads Size key (e.g., '2')",
                "Skips Family Selection Dialog",
                "Proceeds directly to beam selection prompt"
              ]
            },
            "path2": {
              "name": "Manual Insertion Path",
              "steps": [
                "Shows 'Rothoblaas Typ R' dialog",
                "User selects Family (R10-R40)",
                "Sets Size to default",
                "Proceeds to beam selection prompt"
              ]
            }
          },
          {
            "condition": "Beam Selection Method",
            "path1": {
              "name": "Default / Vertical Beam",
              "steps": [
                "User presses Enter or selects vertical beams",
                "Script identifies bottom point of beam",
                "Inserts post base pointing downwards"
              ]
            },
            "path2": {
              "name": "Point Projection / Custom Angle",
              "steps": [
                "User selects 'Point' keyword at prompt",
                "User picks a point in 3D space",
                "Script projects point onto beam X-axis",
                "Inserts base at projected location (allows sloped or inverted mounting)"
              ]
            }
          },
          {
            "condition": "Milling Setting (sMill)",
            "path1": {
              "name": "Flush / Surface Mounted",
              "steps": [
                "sMill is 'No'",
                "Beam cut is made at insertion point",
                "No additional volume removed from beam top"
              ]
            },
            "path2": {
              "name": "Recessed / Milled",
              "steps": [
                "sMill is 'Yes'",
                "Cut point is shifted by Top Plate Thickness + Additional Depth",
                "Milling operation (BeamCut or Drill) removes material for the plate",
                "Drill depth is increased to accommodate the recess"
              ]
            }
          },
          {
            "condition": "Family Geometry (sFamily)",
            "path1": {
              "name": "Type R30 (Disc)",
              "steps": [
                "Uses cylindrical Drill operation for milling",
                "Generates Disc geometry for top plate"
              ]
            },
            "path2": {
              "name": "Other Types (R10, R20, R40)",
              "steps": [
                "Uses rectangular BeamCut operation for milling",
                "Generates rectangular or square plate geometry"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Selection",
            "errorMessage": "At least one beam is necessary.",
            "recovery": "User must select a valid GenBeam to proceed."
          },
          {
            "check": "Insertion Cycle",
            "errorMessage": "None (Internal)",
            "recovery": "Script erases instance if insertCycleCount > 1 (ensures single creation)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Rotate Post Base",
            "how": "Context Menu ('Rotate post base') or Double Click (TslDoubleClick)",
            "effect": "Toggles rotation of the base geometry by 90 degrees around the beam axis."
          },
          {
            "action": "Modify Type / Size",
            "how": "Properties Palette (OPM)",
            "effect": "Updates 'Family' or 'Size' dropdowns. Recalculates dimensions, geometry, drilling depth, and BOM entries immediately."
          },
          {
            "action": "Modify Mounting",
            "how": "Properties Palette (OPM)",
            "effect": "Changes the bottom screw/anchor type in the BOM list (e.g., from AB1 to SKR)."
          },
          {
            "action": "Enable / Adjust Milling",
            "how": "Properties Palette (OPM)",
            "effect": "Toggling 'Milled' adds/removes the recess cut. Adjusting 'Additional mill depth' deepens the cut."
          }
        ]
      },
      "tokens_used": 10524,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Rothoblaas Typ R\n\n## Overview\nGenerates 3D models and applies necessary machining (drilling, milling, cutting) for Rothoblaas Typ R adjustable post bases on selected timber beams.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Generates 3D hardware geometry and modifies beams. |\n| Paper Space | No | N/A |\n| Shop Drawing | No | Generates shop drawing data (BOM) but runs in Model Space. |\n\n## Prerequisites\n- **Required Entities:** `GenBeam` (Structural Timber Beam)\n- **Minimum Beam Count:** 1\n- **Required Settings Files:** None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Rothoblaas Typ R.mcr` from the list.\n\n### Step 2: Select Base Family (If applicable)\n- **If using a catalog preset:** The script skips this step and uses the preset type.\n- **If manual insertion:** A dialog titled \"Rothoblaas Typ R\" appears. Select the desired Type (e.g., R10, R20) and click OK.\n\n### Step 3: Select Beams or Point\n```\nCommand Line: Select beam(s) or [Point]\nAction: Click on the beam(s) you wish to equip with the post base.\n```\n*Note: You can type `P` or `Point` and press Enter to specify a custom insertion point on the beam (useful for sloped beams).*\n\n### Step 4: Specify Point (If 'Point' selected in Step 3)\n```\nCommand Line: Select point for base insertion\nAction: Click on the beam where the base should be applied.\n```\n\n### Step 5: Insertion Complete\nThe script automatically generates the hardware geometry and applies the cuts, drills, and milling (if configured) to the beam.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| A - Type | dropdown | R10 | Selects the design variant: R10 (Flat top), R20 (Rod + Tube), R30 (Disc + Rod), R40 (Passing through). |\n| B - Size | dropdown | 1 | Selects dimensions correlating to height adjustment range and plate size (1=Smallest, 3=Largest). |\n| C - Mounting | dropdown | HBS+ evo | Selects the concrete anchor type (e.g., HBS+, Screw DISC, AB1, VINYLPRO, EPOPLUS). |\n| D - Milled | dropdown | No | Set to \"Yes\" to recess (countersink) the top plate into the timber beam end. |\n| E - Additional mill depth | number | 0 | Extra depth for the milling recess (in mm), added on top of the plate thickness. |\n| F - Screw length bottom | number | 80 | Length of the bottom concrete anchor screw (in mm). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Rotate post base | Rotates the base geometry by 90 degrees around the beam axis. (Also triggers on Double-Click). |\n\n## Settings Files\n- **Filename:** None\n- **Location:** N/A\n- **Purpose:** This script does not rely on external XML settings files.\n\n## Tips\n- **Catalog Presets:** Create catalog entries with specific Types (e.g., R20, Size 2) to skip the initial dialog and insert directly.\n- **Sloped Beams:** If inserting on a non-vertical beam, use the \"Point\" keyword at the command line to accurately project the base onto the beam face.\n- **Milling Depth:** If the top plate is not sitting flush after setting \"Milled\" to \"Yes\", increase the \"Additional mill depth\" value.\n\n## FAQ\n- **Q: How do I make the top plate flush with the wood?**\n- **A:** Select the script instance in the model, open the Properties palette, and set \"D - Milled\" to \"Yes\".\n- **Q: Why is there a hole drilled through my beam?**\n- **A:** Types R20, R30, and R40 require a through-drill for the internal threaded rod. Select Type R10 if you want a flat plate without a central through-hole.\n- **Q: Can I change the anchor screw type after inserting?**\n- **A:** Yes, select the instance and change the \"C - Mounting\" property in the Properties Palette."
      },
      "tokens_used": 7257,
      "error": null
    }
  }
}