{
  "filename": "hsb_OpeningDescriptionHSB2ACA.mcr",
  "status": "completed",
  "total_tokens": 15274,
  "processing_time": 208.889009475708,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "28.02.2013",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2112,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No Paper Space detection patterns (sd_*, Multipage, _Viewport) found. Script uses PrEntity for selection and operates on existing entities in the model."
        },
        "prerequisites": {
          "requiredEntities": [
            "OpeningSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing existing openings to update.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1160,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "Select openings",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1676,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Synchronizes the description property of selected openings with their internal calculated hsbCAD description, primarily for AutoCAD Architecture (ACA) interoperability.",
          "category": "DataManagement/Interoperability",
          "typicalUseCase": "Used before generating drawings or schedules to ensure that door and window tags in AutoCAD Architecture display the correct size/type data calculated by the hsbCAD timber model."
        },
        "parameters": [
          {
            "name": "ssOpening",
            "technicalDefault": "None (Prompted Selection)",
            "businessMeaning": "The set of door or window openings in the model that need to have their property descriptions updated.",
            "validRange": "1 to N valid OpeningSF entities",
            "unit": "Selection Set",
            "affectsOutput": "Determines which architectural opening objects will have their 'Description' property overwritten with the internal hsbCAD opening description string."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "PropertyUpdate",
            "description": "Sets the 'Description' attribute of the Opening entity to the value of openingDescr().",
            "appliedTo": "Selected OpeningSF entities"
          }
        ]
      },
      "tokens_used": 2883,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered (Insertion)",
          "[Conditional] Check Insert Cycle Count",
          "Prompt user to select OpeningSF entities (PrEntity)",
          "Store selected entities in internal _Entity array",
          "Return and Transition to Calculation Phase",
          "[Conditional] Check if _Entity array contains data",
          "Iterate through stored entities",
          "[Conditional] Check if current entity is valid",
          "Update entity 'Description' property with internal hsbCAD description",
          "Delete script instance (eraseInstance)",
          "Execution finished"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count (insertCycleCount)",
            "path1": {
              "name": "Multiple Triggers",
              "steps": [
                "Detects insertCycleCount > 1",
                "Erase script instance",
                "Exit immediately"
              ]
            },
            "path2": {
              "name": "First Trigger",
              "steps": [
                "Proceed to PrEntity selection prompt"
              ]
            }
          },
          {
            "condition": "Entity List Validation (_Entity.length)",
            "path1": {
              "name": "Entities Loaded",
              "steps": [
                "Enter processing loop",
                "Perform updates"
              ]
            },
            "path2": {
              "name": "Empty List",
              "steps": [
                "Erase script instance",
                "Exit"
              ]
            }
          },
          {
            "condition": "Individual Entity Validity (bIsValid)",
            "path1": {
              "name": "Valid Entity",
              "steps": [
                "Cast to OpeningSF",
                "Call setDescription()"
              ]
            },
            "path2": {
              "name": "Invalid Entity",
              "steps": [
                "Continue to next entity in loop"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script automatically terminates to prevent duplicate processing loops."
          },
          {
            "check": "Entity Array Length",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script erases itself if no entities were selected or stored."
          },
          {
            "check": "Entity Validity (bIsValid)",
            "errorMessage": "None (Silent skip)",
            "recovery": "Invalid entities found in the selection set are skipped without halting the script."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 4252,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_OpeningDescriptionHSB2ACA.mcr\n\n## Overview\nThis script updates the \"Description\" property of selected door or window openings to match the internal calculation data from hsbCAD. It ensures that opening tags and schedules in AutoCAD Architecture display the correct size and type information.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script must be run in the model where the openings are located. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | This is a model-level data utility. |\n\n## Prerequisites\n- **Required Entities**: At least one `OpeningSF` (opening) entity must exist in the model.\n- **Minimum Beam Count**: 0\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `hsb_OpeningDescriptionHSB2ACA.mcr`.\n\n### Step 2: Select Openings\n```\nCommand Line: Select openings\nAction: Click on the door or window symbols (OpeningSF entities) you wish to update. Press Enter to confirm selection.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| None | N/A | N/A | This script does not expose parameters in the Properties palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | N/A |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- Run this script immediately before generating schedules or exporting to AutoCAD Architecture to ensure your tags reflect the latest hsbCAD calculations.\n- The script instance is automatically removed from the drawing after execution to keep your project clean.\n\n## FAQ\n- **Q: Why would I need to run this?**\n  **A**: If the standard AutoCAD description property does not match the specific timber size or type calculated by hsbCAD, this script forces them to match.\n- **Q: Did the script work? It disappeared immediately.**\n  **A**: Yes, this is expected behavior. The script updates the selected openings and then deletes itself automatically."
      },
      "tokens_used": 3191,
      "error": null
    }
  }
}