{
  "filename": "HSB_G-Information.mcr",
  "status": "completed",
  "total_tokens": 66106,
  "processing_time": 340.72459506988525,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 2,\n    \"minorVersion\": 29,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"This tsl displays the amount of an element which is filled in at the element definition. Its displayed at the layout.\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.00\",\n      \"date\": \"25.10.2009\",\n      \"author\": \"AS\",\n      \"changes\": \"Pilot version\"\n    },\n    {\n      \"version\": \"1.01\",\n      \"date\": \"24.08.2010\",\n      \"author\": \"AS\",\n      \"changes\": \"Add property to select what info has to be shown\"\n    },\n    {\n      \"version\": \"1.02\",\n      \"date\": \"24.08.2010\",\n      \"author\": \"AS\",\n      \"changes\": \"Extend info-list\"\n    },\n    {\n      \"version\": \"1.03\",\n      \"date\": \"21.09.2010\",\n      \"author\": \"AS\",\n      \"changes\": \"Only show name of floorgroup. Hide domain\"\n    },\n    {\n      \"version\": \"1.04\",\n      \"date\": \"22.03.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Add square meters\"\n    },\n    {\n      \"version\": \"1.05\",\n      \"date\": \"28.04.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Add square meters without opening\"\n    },\n    {\n      \"version\": \"1.06\",\n      \"date\": \"22.09.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Add post- and prefix\"\n    },\n    {\n      \"version\": \"1.07\",\n      \"date\": \"22.09.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Add information\"\n    },\n    {\n      \"version\": \"1.08\",\n      \"date\": \"26.09.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Add 'Tsl instance'\"\n    },\n    {\n      \"version\": \"1.09\",\n      \"date\": \"02.11.2011\",\n      \"author\": \"AS\",\n      \"changes\": \"Projectnumber and element type + number added.\"\n    },\n    {\n      \"version\": \"1.10\",\n      \"date\": \"03.02.2012\",\n      \"author\": \"AS\",\n      \"changes\": \"Improve calculation of square meters.\"\n    },\n    {\n      \"version\": \"1.11\",\n      \"date\": \"03.02.2012\",\n      \"author\": \"AS\",\n      \"changes\": \"Use realBody io envelopeBody\"\n    },\n    {\n      \"version\": \"1.12\",\n      \"date\": \"23.02.2012\",\n      \"author\": \"AS\",\n      \"changes\": \"Change names of groups\"\n    },\n    {\n      \"version\": \"2.00\",\n      \"date\": \"08.03.2012"
      },
      "tokens_used": 9500,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts 'Select a viewport' using getViewport(), assigns result to _Viewport array, and explicitly checks if( _Viewport.length() == 0 ){eraseInstance(); return; }. Description states 'Its displayed at the layout'."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Viewport"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout) containing a viewport with a valid hsbCAD Element",
          "requiredSettings": []
        }
      },
      "tokens_used": 7876,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"Select a viewport\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a point\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"reportNotice\",\n      \"trigger\": \"When Custom Property is set but 'HSB_G-ContentFormat' TSL is missing or fails\",\n      \"title\": null,\n      \"dataSource\": \"Script defined\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 8,\n      \"variable\": \"sSeperator01\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"sFilterType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter type\",\n      \"defaultValue\": \"Include\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Include\",\n        \"Exclude\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"sFilterBC\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter beams with beamcode\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"sFilterName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter beams and sheets with name\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"sFilterLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter beams and sheets with label\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"sFilterMaterial\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter beams and sheets with material\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"sFilterHsbID\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter beams and sheets with hsbID\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"sFilterZone\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Filter zones\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"sSeperator02\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Information to display\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sShow\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Show\",\n      \"defaultValue\": \"Number\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Number\",\n        \"Code\",\n        \"Information\",\n        \"Sub type\",\n        \"Quantity\",\n        \"Number & Quantity\",\n        \"Floor group\",\n        \"Top group\",\n        \"Extrusion profile\",\n        \"Element area\",\n        \"Element area openings subtracted\",\n        \"Material from zone\",\n        \"Tsl instance\",\n        \"Project number\",\n        \"Element type & number\",\n        \"Main beamsection\",\n        \"Tile lath distribution\",\n        \"Counter batten distribution\",\n        \"Nail spacing\",\n        \"Weight\",\n        \"Project number/Element number\",\n        \"Area\",\n        \"Volume\",\n        \"Area as percentage\",\n        \"Volume as percentage\",\n        \"Description\",\n        \"Replicator amount\",\n        \"Name from Zone\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sPrefix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Prefix\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sPostfix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Postfix\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"propCustom\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Custom Property\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"Specify a custom property e.g. @(Material) or @(PropertySet.Property)\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nToken\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"     Token index\",\n      \"defaultValue\": 0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sToken\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Token\",\n      \"defaultValue\": \";\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nZone\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"     Zone index\",\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        0,\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sTslName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Name tsl instance\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"nPrec\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"     Precision\",\n      \"defaultValue\": 2,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sSeperator03\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Presentation\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     Dimension style\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"_DimStyles (System List)\",\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dTxtHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     Textheight\",\n      \"defaultValue\": \"100 (Unit Dependent)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable"
      },
      "tokens_used": 10987,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Displays dynamic construction data (dimensions, weight, area, codes) for a specific element on the Layout (Paper Space), typically used for labeling or material lists in shop drawings.",
          "category": "ShopDrawing/Annotation",
          "typicalUseCase": "Tagging an element in a layout view to show its Element Number, Total Area, Volume, Weight, or specific Project codes for production or assembly planning."
        },
        "parameters": [
          {
            "name": "sFilterType",
            "technicalDefault": "Include",
            "businessMeaning": "Determines if the subsequent filter criteria should include only matching entities or exclude them from the calculation.",
            "validRange": "Include, Exclude",
            "unit": "enum",
            "affectsOutput": "Modifies the set of beams/sheets used to calculate area, volume, or weight."
          },
          {
            "name": "sFilterBC",
            "technicalDefault": "",
            "businessMeaning": "Filters the calculation based on Beam Codes (e.g., 'STU' for studs, 'PLA' for plates). Use semicolons to separate multiple codes.",
            "validRange": "String (valid Beam Codes)",
            "unit": "text",
            "affectsOutput": "Restricts Area/Volume/Weight calculations to only beams with these codes."
          },
          {
            "name": "sFilterName",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their Entity Name property.",
            "validRange": "String",
            "unit": "text",
            "affectsOutput": "Restricts calculations to entities with specific names."
          },
          {
            "name": "sFilterLabel",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their Label property.",
            "validRange": "String",
            "unit": "text",
            "affectsOutput": "Restricts calculations to entities with specific labels."
          },
          {
            "name": "sFilterMaterial",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their Material designation (e.g., 'C24', 'GL24h').",
            "validRange": "String",
            "unit": "text",
            "affectsOutput": "Restricts calculations to entities of specific materials."
          },
          {
            "name": "sFilterHsbID",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their unique hsbCAD ID.",
            "validRange": "String",
            "unit": "text",
            "affectsOutput": "Restricts calculations to entities with specific IDs."
          },
          {
            "name": "sFilterZone",
            "technicalDefault": "",
            "businessMeaning": "Filters entities belonging to a specific construction zone (index).",
            "validRange": "String",
            "unit": "text",
            "affectsOutput": "Restricts calculations to entities within the specified zone."
          },
          {
            "name": "sShow",
            "technicalDefault": "Number",
            "businessMeaning": "Selects the specific data to display (e.g., Element Number, Total Area, Volume, Weight, Project Code).",
            "validRange": "List of 30+ options (Number, Code, Quantity, Element area, Weight, etc.)",
            "unit": "enum",
            "affectsOutput": "Determines the text content displayed on the layout."
          },
          {
            "name": "sPrefix",
            "technicalDefault": "",
            "businessMeaning": "Text added before the calculated value (e.g., 'Area: ').",
            "validRange": "Any text",
            "unit": "text",
            "affectsOutput": "Prefixes the output string."
          },
          {
            "name": "sPostfix",
            "technicalDefault": "",
            "businessMeaning": "Text added after the calculated value (e.g., ' m²').",
            "validRange": "Any text",
            "unit": "text",
            "affectsOutput": "Suffixes the output string."
          },
          {
            "name": "propCustom",
            "technicalDefault": "",
            "businessMeaning": "Allows pulling custom data from the element using the format @(PropertyName). Requires 'HSB_G-ContentFormat' script to be loaded.",
            "validRange": "String format @(Property)",
            "unit": "text",
            "affectsOutput": "Displays the value of a custom property if the supporting script is available."
          },
          {
            "name": "nToken",
            "technicalDefault": 0,
            "businessMeaning": "Selects which segment of the result string to display, splitting by the specified Token delimiter.",
            "validRange": "Integer >= 0",
            "unit": "index",
            "affectsOutput": "Extracts a substring from the generated info (e.g., extracting just the element number from a full code string)."
          },
          {
            "name": "sToken",
            "technicalDefault": ";",
            "businessMeaning": "The delimiter character used to split the result string for the Token Index operation.",
            "validRange": "Single character",
            "unit": "char",
            "affectsOutput": "Defines how the info string is parsed for the 'Token index'."
          },
          {
            "name": "nZone",
            "technicalDefault": 0,
            "businessMeaning": "Specifies the zone index to query data from (used for 'Material from zone' or 'Area/Volume of zone').",
            "validRange": "-10 to 10 (mapped internally)",
            "unit": "index",
            "affectsOutput": "Selects the specific zone used for area/volume/material calculations."
          },
          {
            "name": "sTslName",
            "technicalDefault": "",
            "businessMeaning": "Name of a specific TSL instance to look for within the element (used when 'Show' is set to 'Tsl instance').",
            "validRange": "Valid TSL Filename",
            "unit": "text",
            "affectsOutput": "Searches for this TSL to count or query its Quantity property."
          },
          {
            "name": "nPrec",
            "technicalDefault": 2,
            "businessMeaning": "Number of decimal places for numerical values (e.g., Area, Volume).",
            "validRange": "0 to 6",
            "unit": "count",
            "affectsOutput": "Formatting of numerical text."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "",
            "businessMeaning": "The AutoCAD Dimension Style to apply to the text (font, arrow style, etc.).",
            "validRange": "Existing Dimension Styles in drawing",
            "unit": "style",
            "affectsOutput": "Visual appearance of the text."
          },
          {
            "name": "dTxtHeight",
            "technicalDefault": "100 (Unit Dependent)",
            "businessMeaning": "The height of the text on the Layout sheet.",
            "validRange": "> 0",
            "unit": "mm/inches (Drawing Units)",
            "affectsOutput": "Size of the text in Paper Space."
          },
          {
            "name": "dRotation",
            "technicalDefault": 0,
            "businessMeaning": "Rotation angle of the text relative to the screen or UCS.",
            "validRange": "0 - 360 degrees",
            "unit": "degrees",
            "affectsOutput": "Orientation of the text."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sShow set to 'Tsl instance'",
            "effect": "Activates the search for TSL instances defined in 'sTslName'.",
            "cascade": [
              "sTslName"
            ]
          },
          {
            "trigger": "sShow set to zone-specific options (Area/Volume/Material from zone)",
            "effect": "Uses the index defined in 'nZone' to select the construction layer.",
            "cascade": [
              "nZone"
            ]
          },
          {
            "trigger": "sShow set to numerical options (Area, Volume, Weight)",
            "effect": "Uses 'nPrec' to format the output and Filters to limit the calculation scope.",
            "cascade": [
              "nPrec",
              "sFilterBC",
              "sFilterMaterial",
              "sFilterType"
            ]
          },
          {
            "trigger": "nToken > 0 or sToken not empty",
            "effect": "Parses the resulting string to extract a subset.",
            "cascade": [
              "sInfo"
            ]
          },
          {
            "trigger": "propCustom is not empty",
            "effect": "Attempts to call external script 'HSB_G-ContentFormat'.",
            "cascade": [
              "HSB_G-ContentFormat"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text Entity",
            "description": "A text object displaying the calculated information (Number, Area, Volume, etc.) in Paper Space.",
            "appliedTo": "Paper Space (Layout)"
          }
        ]
      },
      "tokens_used": 12611,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Launch Script (Insert Mode)\",\n    \"2. [User Input] Select a Viewport in Paper Space\",\n    \"3. [User Input] Select a Point for text placement\",\n    \"4. Display Properties Dialog (Optional/Implicit)\",\n    \"5. Script Instance Created\",\n    \"6. [Recalculation] Validate Viewport exists and contains valid Element\",\n    \"7. [Recalculation] Parse Filter Strings (Codes, Names, Materials, etc.)\",\n    \"8. [Recalculation] Collect Beams/Sheets from Element\",\n    \"9. [Recalculation] Apply Filters (Include/Exclude/None)\",\n    \"10. [Recalculation] Execute Calculation based on 'Show' Property Selection\",\n    \"11. [Recalculation] Check for Custom Property (if enabled)\",\n    \"12. [Recalculation] Apply Tokenization and Formatting (Prefix/Postfix)\",\n    \"13. [Recalculation] Draw Text Entity in Model/Paper Space based on Coordinate Transform\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Filter Strategy ('Filter type' property)\",\n      \"path1\": {\n        \"name\": \"Include\",\n        \"steps\": [\n          \"Iterate all element entities\",\n          \"Add entity to working array ONLY if it matches filter criteria (Code, Name, Material, etc.)\",\n          \"Proceed to calculation with filtered subset\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Exclude\",\n        \"steps\": [\n          \"Iterate all element entities\",\n          \"Add entity to working array UNLESS it matches filter criteria\",\n          \"Proceed to calculation with remaining subset\"\n        ]\n      },\n      \"path3\": {\n        \"name\": \"None (All Empty)\",\n        \"steps\": [\n          \"Detect all filter strings are empty\",\n          \"Add all entities from Element to working array\",\n          \"Proceed to calculation with full set\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Selected Information Type ('Show' property)\",\n      \"path1\": {\n        \"name\": \"Direct Element Attributes\",\n        \"steps\": [\n          \"Retrieve string/number directly from Element object (e.g., Number, Code, Project Number)\",\n          \"Format string\",\n          \"Draw\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Geometric Calculations (Area/Volume)\",\n        \"steps\": [\n          \"Generate envelope profiles for filtered beams\",\n          \"Union profiles into a single shape\",\n          \"Calculate Area or Volume\",\n          \"Apply percentage logic if 'percentage' option selected\",\n          \"Format with precision\",\n          \"Draw\"\n        ]\n      },\n      \"path3\": {\n        \"name\": \"External References (TSL/Map I/O)\",\n        \"steps\": [\n          \"Search for TSL instances (if 'Tsl instance') OR Call 'hsbCenterOfGravity' (if 'Weight')\",\n          \"If TSL instance count is 0, Exit without drawing\",\n          \"Retrieve result\",\n          \"Draw\"\n        ]\n      },\n      \"path4\": {\n        \"name\": \"Roof Specific\",\n        \"steps\": [\n          \"Cast Element to ElementRoof\",\n          \"If cast fails (Not a roof), Exit without drawing\",\n          \"Retrieve lath distribution or nail spacing\",\n          \"Draw\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Custom Property Usage\",\n      \"path1\": {\n        \"name\": \"Script Available\",\n        \"steps\": [\n          \"Call 'HSB_G-ContentFormat' script via Map I/O\",\n          \"Pass Element and Format string\",\n          \"Receive formatted string\",\n          \"Draw\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Script Missing/Error\",\n        \"steps\": [\n          \"Attempt call fails\",\n          \"Display Alert: 'Please make sure the tsl HSB_G-ContentFormat is loaded'\",\n          \"Output empty or raw property\",\n          \"Draw (or skip if empty)\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Viewport Selection\",\n      \"errorMessage\": \"None (Script erases self)\",\n      \"recovery\": \"User must insert script again and select a viewport.\"\n    },\n    {\n      \"check\": \"Viewport Element Validity\",\n      \"errorMessage\": \"None (Script exits silently)\",\n      \"recovery\": \"Select a viewport that actually contains a generated hsbCAD Element.\"\n    },\n    {\n      \"check\": \"TSL Instance Count (When 'Show' is 'Tsl instance')\",\n      \"errorMessage\": \"None (Script exits silently)\",\n      \"recovery\": \"Ensure the specified TSL exists within the element and has the 'Quantity' property, or change the 'Show' option.\"\n    },\n    {\n      \"check\": \"Element Type (Roof options)\",\n      \"errorMessage\": \"None (Script exits silently)\",\n      \"recovery\": \"Use Roof-specific 'Show' options only on Roof elements.\"\n    },\n    {\n      \"check\": \"External Script Dependency (HSB_G-ContentFormat)\",\n      \"errorMessage\": \"Report Notice: 'Please make sure the tsl HSB_G-ContentFormat is loaded in the drawing'\",\n      \"recovery\": \"Load the 'HSB_G-ContentFormat.mcr' script into the drawing or clear the 'Custom Property' field.\"\n    }\n  ],\n  \"postInsertionActions"
      },
      "tokens_used": 14773,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-Information.mcr\n\n## Overview\nThis script displays dynamic construction information (such as element number, area, volume, weight, or material data) directly on a Layout (Paper Space) viewport. It allows you to label specific elements with filtered data, formatted with custom prefixes, suffixes, and precision settings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed to place labels in Paper Space. |\n| Paper Space | Yes | Script must be inserted on a Layout tab containing an active viewport. |\n| Shop Drawing | Yes | Commonly used to tag elements or add material lists to production drawings. |\n\n## Prerequisites\n- **Viewport:** A layout viewport must exist that displays a generated hsbCAD element (wall, floor, roof, etc.).\n- **Element Data:** The element shown in the viewport must be generated and contain valid data (beams, materials, etc.).\n- **Optional Dependency:** To use the \"Custom Property\" feature, the script `HSB_G-ContentFormat.mcr` must be loaded in the drawing.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  In AutoCAD, type `TSLINSERT` and press Enter.\n2.  Browse to select `HSB_G-Information.mcr` and click Open.\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the viewport border inside the layout that displays the element you wish to label.\n```\n*Note: If no viewport is selected, the script instance will be automatically erased.*\n\n### Step 3: Placement\n```\nCommand Line: Select a point\nAction: Click anywhere in the Paper Space to position the information text.\n```\n\n### Step 4: Configure Properties\n1.  Select the newly inserted script instance.\n2.  Open the **Properties** palette (Ctrl+1).\n3.  Modify the **Filter**, **Information to display**, and **Presentation** settings as needed.\n\n## Properties Panel Parameters\n\n### Filter Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Filter | String | - | Visual separator. |\n| Filter type | Dropdown | Include | Determines if the filter criteria Include matching items or Exclude them. |\n| Filter beams with beamcode | String | - | Filter by beam code (e.g., \"STU;PLA\"). Leave empty to ignore. |\n| Filter beams and sheets with name | String | - | Filter by entity name. |\n| Filter beams and sheets with label | String | - | Filter by label property. |\n| Filter beams and sheets with material | String | - | Filter by material name (e.g., \"C24\"). |\n| Filter beams and sheets with hsbID | String | - | Filter by unique hsbCAD ID. |\n| Filter zones | String | - | Filter by specific zone name. |\n\n### Information to Display\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Information to display | String | - | Visual separator. |\n| Show | Dropdown | Number | Selects the data to calculate and display (e.g., Element area, Volume, Weight, Project number, Quantity, etc.). |\n| Prefix | String | - | Text added before the value (e.g., \"Area: \"). |\n| Postfix | String | - | Text added after the value (e.g., \" m²\"). |\n| Custom Property | String | - | Allows pulling custom data using format `@(PropertyName)`. Requires `HSB_G-ContentFormat.mcr`. |\n| Token index | Integer | 0 | If the result contains a list of values, use this index to select a specific segment (0 = first). |\n| Token | String | ; | The delimiter used to separate values for the Token index (default is semicolon). |\n| Zone index | Integer | 0 | Selects the construction zone index to query data from (0 to 10). |\n| Name tsl instance | String | - | The specific TSL filename to look for when \"Show\" is set to \"Tsl instance\". |\n| Precision | Integer | 2 | Number of decimal places for numerical values (Area, Volume, Weight). |\n\n### Presentation\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Presentation | String | - | Visual separator. |\n| Dimension style | Dropdown | Current | Selects the AutoCAD Dimension Style to apply to the text. |\n| Textheight | Double | 100 | Height of the text in Paper Space units. |\n| Rotation | Double | 0 | Rotation angle of the text in degrees. |\n\n## Right-Click Menu Options\nThis script utilizes the standard TSL context menu. You can access the following options by right-clicking the script instance in the drawing:\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the text if the element geometry or properties have changed. |\n| Erase | Removes the script instance and the displayed text. |\n\n## Settings Files\n- **Filename**: `HSB_G-ContentFormat.mcr`\n- **Location**: hsbCAD TSL Scripts folder (Company or Install path).\n- **Purpose**: Required to parse and display \"Custom Property\" strings defined in the `propCustom` parameter. If this script is missing, a report notice will be displayed.\n\n## Tips\n- **Calculating Areas:** To get the surface area of specific parts (e.g., only cladding), use the **Filter beams with beamcode** field to enter relevant codes and set **Filter type** to \"Include\".\n- **Formatting:** Use the **Prefix** and **Postfix** fields to add units automatically. For example, set Prefix to `Wt: ` and Postfix to ` kg` to display \"Wt: 450.00 kg\".\n- **Roofing Data:** If the element is a roof, you can select \"Tile lath distribution\" or \"Nail spacing\" in the **Show** dropdown to retrieve specific roofing construction details.\n- **Empty Results:** If the text does not appear after insertion, ensure the selected viewport actually contains a generated element and that your filters are not too restrictive (excluding all beams).\n\n## FAQ\n- **Q: Why does the text disappear or the script delete itself when I refresh?**\n  - A: This usually happens if the Viewport selected during insertion was deleted or if it no longer contains a valid hsbCAD Element. Re-insert the script and select a valid viewport.\n- **Q: How can I display the element code with the element number in one line?**\n  - A: Currently, the script displays one \"Show\" type per instance. To show both Number and Code, insert two instances of the script, place them next to each other, and set one to \"Number\" and the other to \"Code\".\n- **Q: I see an error about \"HSB_G-ContentFormat\". What do I do?**\n  - A: You must load the `HSB_G-ContentFormat.mcr` script into your drawing to use the Custom Property feature. Load it via `TSLLOAD` or ensure it is in your startup folder."
      },
      "tokens_used": 10359,
      "error": null
    }
  }
}