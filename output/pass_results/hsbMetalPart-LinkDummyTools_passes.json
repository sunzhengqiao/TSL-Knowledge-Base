{
  "filename": "hsbMetalPart-LinkDummyTools.mcr",
  "status": "completed",
  "total_tokens": 43055,
  "processing_time": 558.7788779735565,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This TSL clones the tools of a massgroup/metalpart and links it to the selected beam",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "10apr19",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "version description updated"
          },
          {
            "version": "1.3",
            "date": "10apr19",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix dependencies"
          },
          {
            "version": "1.2",
            "date": "10mai14",
            "author": "th@hsbCAD.de",
            "changes": "Houses are supported, symbol display enhanced"
          },
          {
            "version": "1.1",
            "date": "28feb14",
            "author": "th@hsbCAD.de",
            "changes": "Slot depth corrected"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8430,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script explicitly uses '_kModelSpace' in dbCreate. It modifies 3D geometry by adding tools (Cut, Slot, House, Mortise, BeamCut, Drill) to GenBeams based on analysis of MassGroup dummies."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "MassGroup"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 6152,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select GenBeam(s)|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "|Select Metalpart(s)|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sAddCut",
            "type": "PropString",
            "displayName": "|AddCut|",
            "defaultValue": "|No|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": "|General|",
            "description": "|Defines the AddCut|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7620,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Transfers machining details (cuts, holes, slots) from a selected metal part (MassGroup) to selected timber beams, effectively preparing the timber to receive the hardware.",
          "category": "Connection/Hardware",
          "typicalUseCase": "Used when a steel plate, bracket, or connector requires the timber beam to be pre-cut or drilled to fit perfectly during assembly."
        },
        "parameters": [
          {
            "name": "sAddCut",
            "technicalDefault": "|No|",
            "businessMeaning": "Controls whether simple planar cuts found on the metal part dummy should be transferred to the timber beam as dynamic machining operations.",
            "validRange": "|No|, |Yes|",
            "unit": "N/A",
            "affectsOutput": "If 'Yes', planar cuts (like simple end cuts or trimming) are added to the beam geometry. If 'No', these specific cuts are ignored, though slots and holes may still be processed."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Script insertion via ExecuteKey",
            "effect": "The 'AddCut' property can be preset to Yes or No based on the command key used ('ADDCUT' or 'NOCUT') during insertion.",
            "cascade": [
              "sAddCut"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Drill",
            "description": "Cylindrical holes cloned from the metal part dummy geometry.",
            "appliedTo": "Selected GenBeam(s)"
          },
          {
            "type": "Slot",
            "description": "Rectangular recesses (often for bolts or plates) cloned from the metal part dummy geometry.",
            "appliedTo": "Selected GenBeam(s)"
          },
          {
            "type": "House",
            "description": "Through-rectangular cuts (tenoning/housing) cloned from the metal part dummy geometry.",
            "appliedTo": "Selected GenBeam(s)"
          },
          {
            "type": "Mortise",
            "description": "Internal rectangular voids (pockets) cloned from the metal part dummy geometry.",
            "appliedTo": "Selected GenBeam(s)"
          },
          {
            "type": "BeamCut",
            "description": "Complex timber joint geometry (e.g., Birdsmouth, Housing) defined by the metal part dummy. The tool automatically enlarges in 'free' directions to ensure intersection with the beam.",
            "appliedTo": "Selected GenBeam(s)"
          },
          {
            "type": "Cut",
            "description": "Simple planar surface cuts cloned from the metal part dummy. Applied only if normal vectors align correctly and the AddCut property is enabled.",
            "appliedTo": "Selected GenBeam(s)"
          }
        ]
      },
      "tokens_used": 6630,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script starts via Execute Key",
          "Check Execute Key value (ADDCUT, NOCUT, or Other)",
          "[Branch] Set 'AddCut' property based on Key or Show Dialog",
          "Prompt user to select GenBeam(s)",
          "Prompt user to select Metalpart(s) (MassGroup)",
          "System creates a new script instance for each combination of Selected Beam(s) and Single Metalpart",
          "System erases the temporary 'command' instance",
          "[New Instance] Validate MassGroup entity (parent)",
          "[New Instance] Validate at least one GenBeam is linked",
          "[New Instance] Set origin to center of MassGroup real body",
          "[New Instance] Scan MassGroup children for Dummy Beams (Dummy Type 2)",
          "[New Instance] Analyze Dummy Beams for tools (Cut, Slot, Drill, House, Mortise, BeamCut)",
          "[New Instance] Process Cuts (Check AddCut property and vector alignment)",
          "[New Instance] Process Slots (Calculate profile and intersect)",
          "[New Instance] Process Houses (Apply rotation and intersection)",
          "[New Instance] Process Mortises (Apply intersection)",
          "[New Instance] Process BeamCuts (Enlarge 'free' directions and apply)",
          "[New Instance] Process Drills (Apply intersection)",
          "Generate preview geometry and update beam tools"
        ],
        "conditionalBranches": [
          {
            "condition": "Value of Execute Key used during script insertion",
            "path1": {
              "name": "ADDCUT Key",
              "steps": [
                "Set 'sAddCut' property to 'Yes'",
                "Set Catalog to '_LastInserted'",
                "Skip Dialog"
              ]
            },
            "path2": {
              "name": "NOCUT Key",
              "steps": [
                "Set 'sAddCut' property to 'No'",
                "Set Catalog to '_LastInserted'",
                "Skip Dialog"
              ]
            },
            "path3": {
              "name": "Other/No Key",
              "steps": [
                "Show Dialog",
                "User selects 'AddCut' preference manually"
              ]
            }
          },
          {
            "condition": "sAddCut Property Value during Calculation",
            "path1": {
              "name": "Yes",
              "steps": [
                "Iterate detected Cut tools on Dummies",
                "Check Cut alignment (Dot Product > 0)",
                "Add Cuts dynamically to linked GenBeams"
              ]
            },
            "path2": {
              "name": "No",
              "steps": [
                "Skip adding dynamic Cuts",
                "If Cuts were previously added, convert them to Static tools (1)"
              ]
            }
          },
          {
            "condition": "Cut Vector Alignment",
            "path1": {
              "name": "Aligned",
              "steps": [
                "Dot product of Cut Normal and Direction Vector is positive",
                "Apply Cut"
              ]
            },
            "path2": {
              "name": "Opposed",
              "steps": [
                "Dot product is negative",
                "Ignore Cut (prevents machining on wrong side)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Valid MassGroup selected",
            "errorMessage": "No massgroup found! ([Type]) Instance erased.",
            "recovery": "Select a valid MassGroup (Metalpart) entity when running the script."
          },
          {
            "check": "GenBeam Count",
            "errorMessage": "(Silent erase)",
            "recovery": "Ensure at least one GenBeam is selected in the first selection prompt."
          },
          {
            "check": "Insert Cycle Count",
            "errorMessage": "(Silent erase)",
            "recovery": "This is an internal check to prevent duplicate execution logic; no user action required."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify AddCut Property",
            "how": "OPM (Object Properties Palette)",
            "effect": "Toggles the transfer of 'Cut' tools from the metalpart to the beam. Slots, Drills, and other tools remain unaffected."
          },
          {
            "action": "Move/Rotate Metalpart",
            "how": "Grip Edit / Move / Rotate commands",
            "effect": "The script detects the dependency update and automatically recalculates/updates all tool positions on the linked beams."
          },
          {
            "action": "Modify Dummy Geometry",
            "how": "Edit the underlying MassGroup/Beams",
            "effect": "Re-running the script (or updating dependencies) updates the beam machining to match the new dummy sizes/shapes."
          }
        ]
      },
      "tokens_used": 9162,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbMetalPart-LinkDummyTools.mcr\n\n## Overview\nThis script transfers machining details (such as holes, slots, and cuts) from a selected metal part dummy to selected timber beams. It effectively prepares the timber geometry to receive the specific hardware defined by the metal part.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model to modify beam geometry. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | This script is used for design/ detailing, not shop drawing generation. |\n\n## Prerequisites\n- **Required Entities**: At least one `GenBeam` (Timber Beam) and at least one `MassGroup` (Metal Part).\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\n```\nCommand: TSLINSERT\nAction: Select 'hsbMetalPart-LinkDummyTools.mcr' from the file dialog.\n```\n\n### Step 2: Select Timber Beams\n```\nCommand Line: Select GenBeam(s)\nAction: Click on the timber beam(s) you wish to modify. Press Enter to confirm selection.\n```\n\n### Step 3: Select Metal Part\n```\nCommand Line: Select Metalpart(s)\nAction: Click on the MassGroup (Metal Part dummy) that contains the desired tool geometry (holes/cuts). Press Enter.\n```\n*Note: The script will create a link between the selected beams and the metal part. The tools defined in the metal part are now applied to the beams.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| AddCut | dropdown | No | Defines whether simple planar cuts found on the metal part are transferred to the timber beam. Select \"Yes\" to include cuts, \"No\" to ignore them. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | Standard hsbCAD context options apply. |\n\n## Settings Files\n- None required for this script.\n\n## Tips\n- **Toggle Cuts Dynamically**: You can turn planar cuts on or off after insertion without running the script again. Select the script instance and change the **AddCut** property in the Properties Palette (Ctrl+1).\n- **Auto-Update**: If you move or rotate the Metal Part, the machining on the linked timber beams will automatically update to match the new position.\n- **BeamCut Logic**: For \"BeamCut\" tools, the script automatically calculates the intersection. It ensures the cut is applied correctly by enlarging the tool geometry in \"free\" directions to fully penetrate the beam.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I selected the metal part?**\n  - A: This usually happens if no valid MassGroup was found or if no GenBeams were selected. Ensure you select a valid metal part entity and at least one timber beam.\n  \n- **Q: What types of machining are transferred?**\n  - A: The script transfers Drills, Slots, Houses, Mortises, and BeamCuts. Simple Cuts are only transferred if the `AddCut` property is set to \"Yes\".\n  \n- **Q: Can I use this on multiple beams at once?**\n  - A: Yes, you can select multiple timber beams in Step 2. The script will apply the metal part tools to all selected beams."
      },
      "tokens_used": 5061,
      "error": null
    }
  }
}