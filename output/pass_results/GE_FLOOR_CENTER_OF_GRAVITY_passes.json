{
  "filename": "GE_FLOOR_CENTER_OF_GRAVITY.mcr",
  "status": "completed",
  "total_tokens": 33639,
  "processing_time": 825.1113874912262,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7539,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses _bOnInsert to prompt user selection of Elements (specifically ElementRoof). Collects internal entities using el.elementGroup().collectEntities(..., _kModelSpace). Performs 3D geometric calculations using Body, volume, and Point3d. No 'sd_' or 'Multipage' prefixes, and no Paper Space specific keywords like '_Viewport' are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (The script requires an Element populated with 3D entities like GenBeams, Sheets, or TrussEntities to calculate Center of Gravity)",
          "requiredSettings": []
        }
      },
      "tokens_used": 7591,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "psCircleInBy",
            "type": "PropString",
            "displayName": "Length Factor",
            "defaultValue": "1/2 Length In",
            "inputType": "dropdown",
            "options": [
              "1/2 Length In",
              "1/4 Length In",
              "1/3 Length In"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "psShowCirscle",
            "type": "PropString",
            "displayName": "Show Circle",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7043,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Calculates the Center of Gravity (CG) of a floor or roof element based on material weights and automatically generates lift holes positioned at structurally sound locations relative to that CG.",
          "category": "Production/Hardware",
          "typicalUseCase": "Used when manufacturing floor panels to identify the balance point for crane lifting and to drill holes for lifting straps or chains at optimal positions along the joists."
        },
        "parameters": [
          {
            "name": "psCircleInBy",
            "technicalDefault": "1/2 Length In",
            "businessMeaning": "Determines the size of the visual 'clearance zone' circle drawn around the Center of Gravity. It defines how far in from the panel edges the lifting point should ideally remain.",
            "validRange": "1/2 Length In, 1/4 Length In, 1/3 Length In",
            "unit": "Ratio/Factor",
            "affectsOutput": "Adjusts the radius of the circle drawn in the model and layout. A smaller factor (e.g., 1/4) creates a larger circle, indicating a wider permissible area for lifting hardware attachment."
          },
          {
            "name": "psShowCirscle",
            "technicalDefault": "No",
            "businessMeaning": "Controls whether the visual lifting zone circle is displayed in the model.",
            "validRange": "Yes, No",
            "unit": "State",
            "affectsOutput": "If 'Yes', a circle is drawn around the calculated Center of Gravity. If 'No', the circle is suppressed, leaving only the CG point and crosshairs."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "psShowCirscle set to 'Yes'",
            "effect": "The circle becomes visible, and its specific size is dictated by the value selected in psCircleInBy.",
            "cascade": [
              "psCircleInBy"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text/Construction Lines",
            "description": "CG text marker and crosshairs indicating the exact center of gravity.",
            "appliedTo": "Selected Element (in Model Space and Layout Display)"
          },
          {
            "type": "Construction Circle",
            "description": "A circle representing the safe lifting zone diameter.",
            "appliedTo": "Selected Element (conditional on psShowCirscle)"
          },
          {
            "type": "Machining (Holes)",
            "description": "Generates lift holes (via 'GE_FLOOR_HOLES' sub-script) on joists or trusses. The holes are automatically positioned along the main structural members nearest to the Center of Gravity, avoiding conflicts with steel plates and sheet overlaps.",
            "appliedTo": "Internal GenBeams, TrussEntities, and Sheets within the Element"
          }
        ]
      },
      "tokens_used": 7600,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_FLOOR_CENTER_OF_GRAVITY\n\n## Overview\nThis script calculates the Center of Gravity (CG) for floor or roof elements based on material weights and automatically generates lift holes at optimal structural locations. It helps identify the balance point for crane lifting and ensures hardware is placed safely.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in Model Space on a valid Element. |\n| Paper Space | No | Not designed for Paper Space or Viewports. |\n| Shop Drawing | No | This is a production/modeling script, not a layout detailing script. |\n\n## Prerequisites\n- **Required Entities**: An Element (e.g., Floor or Roof assembly) containing internal entities such as GenBeams, Sheets, or TrussEntities.\n- **Minimum Beam Count**: 0 (The script calculates weight based on volume, but requires an Element with geometry).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_FLOOR_CENTER_OF_GRAVITY.mcr`\n\n### Step 2: Select Element\n```\nCommand Line: Select a set of elements\nAction: Click on the Floor or Roof element in the model to calculate its Center of Gravity.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Length Factor | dropdown | 1/2 Length In | Determines the radius of the visual \"clearance zone\" circle around the Center of Gravity. Options include 1/2, 1/4, or 1/3 of the length to indicate safe lifting areas. |\n| Show Circle | dropdown | No | Toggles the visibility of the lifting zone circle in the model. Select \"Yes\" to visualize the area. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external settings files.\n\n## Tips\n- **Visualizing the Safe Zone**: Set the **Show Circle** property to \"Yes\" to see the recommended clearance area around the Center of Gravity.\n- **Ensuring Accuracy**: The script requires the Element to be fully populated with beams and sheets to calculate an accurate weight-based Center of Gravity.\n- **Hole Generation**: This script automatically triggers the `GE_FLOOR_HOLES` sub-script to drill holes. Ensure that script is available in your TSL search path if machining is required.\n\n## FAQ\n- Q: Why is the circle not appearing?\n  A: Check the Properties Palette. Ensure **Show Circle** is set to \"Yes\". If it is set to \"No\", only the CG point and crosshairs will be displayed.\n- Q: How are the lift holes positioned?\n  A: The script attempts to place holes on the main structural members (joists or trusses) nearest to the calculated Center of Gravity, automatically avoiding steel plates and sheet overlaps."
      },
      "tokens_used": 3866,
      "error": null
    }
  }
}