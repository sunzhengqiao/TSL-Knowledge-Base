{
  "filename": "HSB_E-IntegratedTooling.mcr",
  "status": "completed",
  "total_tokens": 61338,
  "processing_time": 325.3082842826843,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 2,
          "minorVersion": 3,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.00",
            "date": "13.06.2017",
            "author": "YB",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "13.06.2017",
            "author": "YB",
            "changes": "Multiple female beams can now be inside one TSL, changed the way of filtering."
          },
          {
            "version": "1.02",
            "date": "14.06.2017",
            "author": "YB",
            "changes": "Added option to set male beams to dummy beams."
          },
          {
            "version": "1.03",
            "date": "19.06.2017",
            "author": "YB",
            "changes": "Added a filter for the dummy beams."
          },
          {
            "version": "1.04",
            "date": "19.06.2017",
            "author": "YB",
            "changes": "Added a name filter, added two custom actions."
          },
          {
            "version": "1.05",
            "date": "20.06.2017",
            "author": "YB",
            "changes": "Fixed the name filter."
          },
          {
            "version": "1.06",
            "date": "20.06.2017",
            "author": "YB",
            "changes": "Female beamcode and name can now be changed in properties."
          },
          {
            "version": "1.07",
            "date": "20.06.2017",
            "author": "YB",
            "changes": "Changed to multi element insert."
          },
          {
            "version": "2.00",
            "date": "26.02.2019",
            "author": "RVW",
            "changes": "Add option to override properties from dsp variables."
          },
          {
            "version": "2.01",
            "date": "12.04.2019",
            "author": "RP",
            "changes": "Check if body has intersection"
          },
          {
            "version": "2.02",
            "date": "11.03.2020",
            "author": "RP",
            "changes": "Add option to remove male and make a it a static tool"
          },
          {
            "version": "2.03",
            "date": "11.03.2020",
            "author": "RP",
            "changes": "Add option to make the beamcut square"
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "HSB_T-IntegratedTooling",
          "HSB_G-FilterGenBeams"
        ]
      },
      "tokens_used": 8017,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `PrEntity` to prompt for `Element` selection. Explicitly collects `GenBeam` entities using `el.elementGroup().collectEntities(..., _kModelSpace, false)`. No ShopDrawing patterns (`sd_`, `#Type E`) or PaperSpace references (`_Viewport`, `_kPaperSpace`) detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB_T-IntegratedTooling",
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 7058,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert && _kExecuteKey == \\\"\\\"\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select element(s)|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"Standard Property Dialog\",\n      \"trigger\": \"Insertion (_bOnInsert) when no execute key is provided\",\n      \"title\": null,\n      \"dataSource\": \"Internal TSL Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"dAdditionalWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Additional width|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"variableAdditionalWidth\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional width variable override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional width|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dAdditionalHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Additional height|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"variableAdditionalHeight\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional height variable override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional height|\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"sJustificationChoice\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Justification point|\",\n      \"defaultValue\": \"|Center|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Center|\",\n        \"|Top|\",\n        \"|Top-Left|\",\n        \"|Top-Right|\",\n        \"|Left|\",\n        \"|Right|\",\n        \"|Bottom|\",\n        \"|Bottom-Left|\",\n        \"|Bottom-Right|\"\n      ],\n      \"category\": null,\n      \"description\": \"|Sets the justification point for the additional width/ height|.\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dOffsetDirX\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset in X direction|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"variableAdditionalOffsetDirX\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional offset X axis variable override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional offset on the X axis|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dOffsetDirY\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset in Y direction|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"variableAdditionalOffsetDirY\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional offset Y axis variable override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional offset on the Y axis|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dOffsetDirZ\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset in Z direction|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"variableAdditionalOffsetDirZ\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional offset Z axis variable override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional offset on the Z axis|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dNegFrontOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Negative front offset|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"variableAdditionalNegFrontOffset\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional negative front offset override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional negative front offset override|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dPosFrontOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Positive front offset|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"variableAdditionalPosFrontOffset\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Additional positive front offset override|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Geometry|\",\n      \"description\": \"|Specify the variable to look up in dsp for the additional positive front offset override|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sModifyForCNC\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Modify section for CNC|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sConvertToDummy\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Convert to Dummy|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sConvertToStatic\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Convert to static tool|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sConvertToSquare\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Make beamcut square|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Geometry|\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"genBeamFilterDefinitionMale\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter definition for male beams|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Dynamic (from catalog HSB_G-Filter"
      },
      "tokens_used": 10187,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automates the application of integrated tooling connections (such as cuts, pockets, or custom machining) between 'Male' (target) and 'Female' (reference) beams within a selected construction element (e.g., a wall or floor panel).\",\n    \"category\": \"Connection/Machining\",\n    \"typicalUseCase\": \"A designer needs to apply specific trimming or pocketing to all studs in a wall panel where they intersect with top/bottom plates or headers, potentially using variable sizes derived from production data.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"dAdditionalWidth\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Specifies a manual clearance or expansion value for the width of the tooling/cut perpendicular to the beam's main axis.\",\n      \"validRange\": \"0 to 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Widens the cut or tooling volume on the Male beam. If 0, uses default intersection width.\"\n    },\n    {\n      \"name\": \"variableAdditionalWidth\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the width dimension to a specific variable index in the external production data (DSP) for automated sizing.\",\n      \"validRange\": \"-1 to 100 (Integer, -1 = disabled)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dAdditionalWidth' if a valid DSP value is found, allowing dimensions to be driven by external manufacturing data.\"\n    },\n    {\n      \"name\": \"dAdditionalHeight\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Specifies a manual clearance or expansion value for the height/depth of the tooling/cut.\",\n      \"validRange\": \"0 to 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Increases the vertical size of the cut or tooling volume.\"\n    },\n    {\n      \"name\": \"variableAdditionalHeight\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the height dimension to a specific variable index in the external production data (DSP) for automated sizing.\",\n      \"validRange\": \"-1 to 100 (Integer, -1 = disabled)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dAdditionalHeight' with values from the production database.\"\n    },\n    {\n      \"name\": \"sJustificationChoice\",\n      \"technicalDefault\": \"|Center|\",\n      \"businessMeaning\": \"Determines the anchor point for applying the additional width and height adjustments relative to the intersection geometry.\",\n      \"validRange\": \"List (Center, Top, Top-Left, etc.)\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Controls whether the tooling expands symmetrically (Center) or asymmetrically (e.g., only upwards or to the left) from the intersection point.\"\n    },\n    {\n      \"name\": \"dOffsetDirX\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Shifts the position of the tooling/cut along the global X-axis.\",\n      \"validRange\": \"-1000 to 1000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the tooling geometry linearly in the X direction.\"\n    },\n    {\n      \"name\": \"variableAdditionalOffsetDirX\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the X-axis offset to a specific DSP variable for automated positioning.\",\n      \"validRange\": \"-1 to 100 (Integer)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dOffsetDirX' based on production data.\"\n    },\n    {\n      \"name\": \"dOffsetDirY\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Shifts the position of the tooling/cut along the global Y-axis.\",\n      \"validRange\": \"-1000 to 1000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the tooling geometry linearly in the Y direction.\"\n    },\n    {\n      \"name\": \"variableAdditionalOffsetDirY\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the Y-axis offset to a specific DSP variable.\",\n      \"validRange\": \"-1 to 100 (Integer)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dOffsetDirY' based on production data.\"\n    },\n    {\n      \"name\": \"dOffsetDirZ\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Shifts the position of the tooling/cut along the global Z-axis.\",\n      \"validRange\": \"-1000 to 1000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Translates the tooling geometry linearly in the Z direction.\"\n    },\n    {\n      \"name\": \"variableAdditionalOffsetDirZ\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the Z-axis offset to a specific DSP variable.\",\n      \"validRange\": \"-1 to 100 (Integer)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dOffsetDirZ' based on production data.\"\n    },\n    {\n      \"name\": \"dNegFrontOffset\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Extends or reduces the length of the tooling in the negative direction along the Male beam's axis (typically backwards from intersection).\",\n      \"validRange\": \"0 to 2000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Lengthens or shortens the cut volume on one side of the intersection point.\"\n    },\n    {\n      \"name\": \"variableAdditionalNegFrontOffset\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the negative length offset to a specific DSP variable.\",\n      \"validRange\": \"-1 to 100 (Integer)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dNegFrontOffset' based on production data.\"\n    },\n    {\n      \"name\": \"dPosFrontOffset\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Extends or reduces the length of the tooling in the positive direction along the Male beam's axis (typically forwards from intersection).\",\n      \"validRange\": \"0 to 2000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Lengthens or shortens the cut volume on the other side of the intersection point.\"\n    },\n    {\n      \"name\": \"variableAdditionalPosFrontOffset\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Links the positive length offset to a specific DSP variable.\",\n      \"validRange\": \"-1 to 100 (Integer)\",\n      \"unit\": \"Index ID\",\n      \"affectsOutput\": \"Overrides 'dPosFrontOffset' based on production data.\"\n    },\n    {\n      \"name\": \"sModifyForCNC\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Enables or disables specific geometric modifications required for correct CNC machine code generation (e.g., dog-bones, fillets).\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Bool\",\n      \"affectsOutput\": \"Alters the geometry to ensure machinability; 'No' might result in sharp internal corners that CNC tools cannot cut.\"\n    },\n    {\n      \"name\": \"sConvertToDummy\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"If enabled, converts the 'Male' beams (the ones being cut) into dummy beams (non-structural, visualization only, excluded from BOMs).\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Bool\",\n      \"affectsOutput\": \"Changes beam attributes to 'Dummy', removing them from material reports and structural calculations.\"\n    },\n    {\n      \"name\": \"sConvertToStatic\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"If enabled, removes the original Male beam and replaces the tooling with a static 3D solid body, removing parametric associativity.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Bool\",\n      \"affectsOutput\": \"Deletes the original beam entity and creates a static 'Block' or Body, preventing future automatic updates if the design changes.\"\n    },\n    {\n      \"name\": \"sConvertToSquare\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Forces the cut shape on the Male beam to be a square (90-degree) cut, overriding any complex profile geometry defined by the intersection.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Bool\",\n      \"affectsOutput\": \"Changes the end cut of the beam to a simple perpendicular cut.\"\n    },\n    {\n      \"name\": \"genBeamFilterDefinitionMale\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Selects a filter preset to identify which beams in the element act as the 'Male' (target/modified) components.\",\n      \"validRange\": \"Filter Catalog Names\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Determines which beams receive the machining. Incorrect selection results in no machining or machining on the wrong beams.\"\n    },\n    {\n      \"name\": \"genBeamFilterDefinitionFeMale\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Selects a filter preset to identify which beams act as the 'Female' (reference/driving) components that define where the cuts occur.\",\n      \"validRange\": \"Filter Catalog Names\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Determines which beams trigger the cut on the Male beams based on their intersection.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"Variable Override parameters (e.g., variableAdditionalWidth) are set (> -1)\",\n      \"effect\": \"The corresponding manual Double parameter (e.g., dAdditionalWidth) is ignored in favor of the value read from the production data (DSP).\",\n      \"cascade\": [\n        \"dAdditionalWidth\",\n        \"dAdditionalHeight\",\n        \"dOffsetDir"
      },
      "tokens_used": 12062,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Execution Start",
          "2. Determine Execution Mode (Insert vs. ElementConstructed/DSPToTsl)",
          "3. [Branch A: Insert Mode] Check insertCycleCount",
          "4. [Branch A: Insert Mode] Check for Execute Key (Catalog Preset)",
          "5. [Branch A: Insert Mode] If no Execute Key, show Dialog (showDialog)",
          "6. [Branch A: Insert Mode] Prompt user to select Element(s) (PrEntity)",
          "7. [Branch A: Insert Mode] Loop through selected Elements",
          "8. [Branch A: Insert Mode] For each Element, create a new Script Instance attached to that Element",
          "9. [Branch A: Insert Mode] Erase original temporary Script Instance",
          "10. [Branch B: ElementConstructed/DSP Mode] Check for DSP Overrides",
          "11. [Branch B: ElementConstructed/DSP Mode] If 'DspToTsl' Map key exists, parse variables from Map/DSP",
          "12. [Branch B: ElementConstructed/DSP Mode] Load properties from Catalog if specified",
          "13. [Branch B: ElementConstructed/DSP Mode] Validate Element Reference",
          "14. [Branch B: ElementConstructed/DSP Mode] Collect all GenBeams within the Element",
          "15. [Branch B: ElementConstructed/DSP Mode] Call Filter Script ('HSB_G-FilterGenBeams') for Male beams",
          "16. [Branch B: ElementConstructed/DSP Mode] Call Filter Script ('HSB_G-FilterGenBeams') for Female beams",
          "17. [Branch B: ElementConstructed/DSP Mode] Loop through Filtered Male GenBeams",
          "18. [Branch B: ElementConstructed/DSP Mode] Loop through Filtered Female GenBeams",
          "19. [Branch B: ElementConstructed/DSP Mode] Check for geometric intersection between Male and Female bodies",
          "20. [Branch B: ElementConstructed/DSP Mode] If intersecting, create 'HSB_T-IntegratedTooling' instance on the Male beam with Female beam as reference",
          "21. [Branch B: ElementConstructed/DSP Mode] Erase the controlling Script Instance"
        ],
        "conditionalBranches": [
          {
            "condition": "Execution Context (Insert vs. Update/Construct)",
            "path1": {
              "name": "Manual Insert",
              "steps": [
                "Check if insertCycleCount > 1 (Erase if true)",
                "Check if _kExecuteKey is provided",
                "If Key provided: Load properties from matching Catalog entry",
                "If Key NOT provided: Open Properties Dialog",
                "Prompt 'Select element(s)'",
                "For each Element: dbCreate a new instance of this script linked to the element",
                "Erase temporary instance"
              ]
            },
            "path2": {
              "name": "Auto-Process (ElementConstructed/DSP)",
              "steps": [
                "Check if _Map has 'DspToTsl' string",
                "If true: Parse production variables (width, height, offsets) from Map tokens",
                "Fallback to OPM properties if variables are invalid/missing",
                "Validate Element exists (_Element[0])",
                "Collect GenBeams from Element",
                "Apply Male and Female filters",
                "Generate HSB_T-IntegratedTooling instances for intersections",
                "Erase instance"
              ]
            }
          },
          {
            "condition": "Property Source (Manual vs. Variable Override)",
            "path1": {
              "name": "Manual Input",
              "steps": [
                "Read OPM Property (e.g., dAdditionalWidth)",
                "Use value directly"
              ]
            },
            "path2": {
              "name": "DSP Variable Override",
              "steps": [
                "Check Variable Index (e.g., variableAdditionalWidth) > -1",
                "Read value from DSP variable string",
                "Parse string to double",
                "Override Manual Input"
              ]
            }
          },
          {
            "condition": "Filtering Success",
            "path1": {
              "name": "Success",
              "steps": [
                "Retrieve filtered GenBeam arrays",
                "Proceed to intersection loop"
              ]
            },
            "path2": {
              "name": "Failure",
              "steps": [
                "Report Warning: 'GenBeams could not be filtered!'",
                "Erase Instance",
                "Halt Execution"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent erase)",
            "recovery": "N/A - Prevents duplicate instances during single insert action."
          },
          {
            "check": "Element Selection (Insert Mode)",
            "errorMessage": "Prompt cancelled (ssE.go() returns false)",
            "recovery": "User must select valid Elements to proceed."
          },
          {
            "check": "Element Reference (Process Mode)",
            "errorMessage": "Element reference not found.",
            "recovery": "Ensure the TSL is correctly attached to an Element."
          },
          {
            "check": "GripPoints (DSP Mode)",
            "errorMessage": "No grippoints found. TSL Will be erased",
            "recovery": "Check generator logic creating the TSL instance."
          },
          {
            "check": "Filter Script Availability",
            "errorMessage": "GenBeams could not be filtered! Make sure that the tsl HSB_G-FilterGenBeams is loaded in the drawing.",
            "recovery": "Load the required 'HSB_G-FilterGenBeams' script into the drawing."
          },
          {
            "check": "Catalog Name (DSP Mode)",
            "errorMessage": "Catalogname not found",
            "recovery": "Ensure the catalog name passed via DSP/DspToTsl exists in the catalog."
          },
          {
            "check": "Geometric Intersection",
            "errorMessage": "None (Skipped)",
            "recovery": "N/A - Logic silently skips non-intersecting beam pairs."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Parameters",
            "how": "OPM (Object Properties Manager)",
            "effect": "Updating properties like Additional Width/Height or Offsets usually requires a manual recalculation or regeneration to update the geometry, as this script acts primarily as a generator/launcher."
          },
          {
            "action": "Update via DSP",
            "how": "External Data Production System",
            "effect": "Updating the variable overrides in the database allows dynamic resizing of tooling without manual CAD intervention upon regeneration."
          },
          {
            "action": "Delete/Re-run",
            "how": "Delete the generated HSB_T-IntegratedTooling instances or the Element TSL and re-insert",
            "effect": "Completely regenerates the tooling based on current filters and properties."
          }
        ]
      },
      "tokens_used": 13428,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-IntegratedTooling.mcr\n\n## Overview\nThis script automates the application of integrated tooling connections (such as cuts, pockets, or machining) between \"Male\" and \"Female\" beams within a selected construction element (e.g., a wall or floor panel). It allows for complex geometric adjustments and supports variable overrides from production data.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on Elements in the 3D model. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not a drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: At least one `Element` containing `GenBeams`.\n- **Minimum Beam Count**: 2 (requires intersecting beams to function effectively).\n- **Required Settings**: The helper script `HSB_G-FilterGenBeams` must be loaded in the drawing to filter beams correctly.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_E-IntegratedTooling.mcr` from the list.\n\n### Step 2: Configure Initial Properties\n```\nDialog: Properties Palette / Initial Dialog\nAction: Set initial dimensions (Width, Height), offsets, and filter definitions.\nNote: If a specific catalog preset is used, these steps may be skipped.\n```\n\n### Step 3: Select Element\n```\nCommand Line: Select element(s)\nAction: Click on the construction element (e.g., a wall or roof panel) that contains the beams you wish to process.\n```\n\n### Step 4: Processing\n```\nSystem: Automatically filters beams, finds intersections, and applies tooling.\nAction: The script runs and then erases itself, leaving the individual tooling instances applied to the beams.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Geometry** | | | |\n| Additional width | Number | 0 | Extra width added to the cut/tooling perpendicular to the beam axis. |\n| Additional height | Number | 0 | Extra height added to the cut/tooling. |\n| Justification point | Dropdown | Center | Anchor point for the additional size (e.g., Center, Top, Left). |\n| Offset in X direction | Number | 0 | Moves the tooling geometry along the global X axis. |\n| Offset in Y direction | Number | 0 | Moves the tooling geometry along the global Y axis. |\n| Offset in Z direction | Number | 0 | Moves the tooling geometry along the global Z axis. |\n| Negative front offset | Number | 0 | Extends the tooling length backwards from the intersection point. |\n| Positive front offset | Number | 0 | Extends the tooling length forwards from the intersection point. |\n| **DSP Overrides** | | | |\n| Additional width variable override | Integer | -1 | DSP variable index to override 'Additional width' (-1 disables). |\n| Additional height variable override | Integer | -1 | DSP variable index to override 'Additional height' (-1 disables). |\n| Additional offset X axis variable override | Integer | -1 | DSP variable index to override X offset (-1 disables). |\n| Additional offset Y axis variable override | Integer | -1 | DSP variable index to override Y offset (-1 disables). |\n| Additional offset Z axis variable override | Integer | -1 | DSP variable index to override Z offset (-1 disables). |\n| Additional negative front offset override | Integer | -1 | DSP variable index to override negative length offset (-1 disables). |\n| Additional positive front offset override | Integer | -1 | DSP variable index to override positive length offset (-1 disables). |\n| **Processing Options** | | | |\n| Modify section for CNC | Dropdown | No | Adds specific geometry (e.g. fillets) required for CNC machining. |\n| Convert to Dummy | Dropdown | No | Changes the cut beam to a dummy beam (excluded from BOMs). |\n| Convert to static tool | Dropdown | No | Removes the beam and replaces it with a static solid (non-parametric). |\n| Make beamcut square | Dropdown | No | Forces a 90-degree square cut at the intersection. |\n| **Filters** | | | |\n| Filter definition for male beams | Dropdown | [Empty] | Selects which beams are modified (targets). |\n| Filter definition for female beams | Dropdown | [Empty] | Selects which beams drive the cut shape (references). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the tooling geometry based on current property settings or changes in the model structure. |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: hsbCAD standard library\n- **Purpose**: Used to categorize and select \"Male\" and \"Female\" beams based on name, code, or other properties.\n\n## Tips\n- **Filtering is Key**: Ensure your Filter Definitions for Male and Female beams correctly target the intended parts (e.g., set \"Male\" to Studs and \"Female\" to Plates).\n- **Variable Overrides**: If using production data (DSP), ensure the variable indices (e.g., variableAdditionalWidth) match your database setup to automate sizing.\n- **Static Tools**: Use \"Convert to static tool\" only when you no longer need parametric updates, as this breaks the link to the original beam logic.\n\n## FAQ\n- Q: Why did the script run but not create any cuts?\n  A: Check your Filter Definitions. If the filters do not select any beams, or if the selected Male and Female beams do not physically intersect, no tooling will be generated.\n- Q: Can I change the cut size after inserting?\n  A: Yes. Select the generated tooling instance (or re-run the generator on the element) and adjust the \"Additional width/height\" or \"Offset\" properties in the palette, then Recalculate.\n- Q: What does \"Convert to Dummy\" do?\n  A: It marks the beam as a dummy. It remains visible in the model but will not appear in material lists or reports, useful for visualization only."
      },
      "tokens_used": 10586,
      "error": null
    }
  }
}