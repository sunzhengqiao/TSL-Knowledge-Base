{
  "filename": "hsbCAD_Multi Point Load.mcr",
  "status": "completed",
  "total_tokens": 47966,
  "processing_time": 207.9780251979828,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "04.09.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.1",
            "date": "10.09.2008",
            "author": "",
            "changes": "Fix the display when the align is changed"
          },
          {
            "version": "1.3",
            "date": "03.03.2009",
            "author": "",
            "changes": "Always show the display as center and above the element"
          },
          {
            "version": "1.4",
            "date": "24.08.2009",
            "author": "",
            "changes": "Add the option to specify an extrusion profile for the PointLoad Beams"
          },
          {
            "version": "1.5",
            "date": "24.08.2009",
            "author": "",
            "changes": "Increase the range of posible beams from 1 to 12"
          },
          {
            "version": "1.6",
            "date": "03.11.2009",
            "author": "",
            "changes": "Fix the issue when the poinload is insert in a wall with 2 bottom plates like the SuperFrame Fix the issue of duplicated child TSLs when the drawing is open. Change the Display a bit."
          },
          {
            "version": "1.7",
            "date": "21.07.2010",
            "author": "",
            "changes": "Add the code to be able to run this from the pallette"
          },
          {
            "version": "1.8",
            "date": "22.09.2010",
            "author": "",
            "changes": "Fix issue when the poinload is insert in the edge of the element and can not find intersection with the top and bottom plate"
          },
          {
            "version": "1.9",
            "date": "07.10.2010",
            "author": "",
            "changes": "Assign the icon to the group of the lowest element"
          },
          {
            "version": "1.10",
            "date": "02.02.2010",
            "author": "",
            "changes": "BeamCode \"H\" in Token Position 0 is ignored from the check for lintel body intersection with pointload beams."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 9067,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates during `_bOnInsert` using `PrEntity` to select `Element` entities and `getPoint` for placement, characteristic of Model Space tools. It uses `Display` (layer 3) for visualization and `dbCreate` to instantiate a child TSL ('hsbCAD_Point Load'). It lacks Shop Drawing indicators (no `sd_` functions, no `#Type E` drawing generation logic, no `_Viewport` usage)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Child script 'hsbCAD_Point Load' must exist in the script path",
            "Elements must contain structural beams (Top/Bottom plates) to function correctly"
          ]
        }
      },
      "tokens_used": 7773,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select an insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sAlign",
            "type": "PropString",
            "displayName": "Align",
            "defaultValue": "Left",
            "inputType": "dropdown",
            "options": [
              "Left",
              "Center",
              "Right"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nNrOfBms",
            "type": "PropInt",
            "displayName": "Nr. of beams in pointload",
            "defaultValue": 1,
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10",
              "11",
              "12"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sExtrusionProfile",
            "type": "PropString",
            "displayName": "Extrusion profile name",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Text style",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": null,
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7828,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 7679,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched and initializes properties (Align, NrOfBeams, ExtrusionProfile, DimStyle).",
          "2. [Insert Phase] Prompts user to select a set of Elements using PrEntity.",
          "3. [Insert Phase] Prompts user to select an insertion point using getPoint.",
          "4. [Insert Phase] Loads property values from catalog if available and shows Property Palette.",
          "5. [Execution Phase] Clears previous state: Erases existing child TSLs ('hsbCAD_Point Load') and their associated beams stored in internal Maps.",
          "6. Validates that elements were selected; if not, erases self and exits.",
          "7. Iterates through each selected Element:",
          "   a. Calculates beam dimensions (Width/Height) based on 'ExtrusionProfile' or default Element dimensions.",
          "   b. Classifies Element beams into lists: Top Plates, Bottom Plates, and Opening Beams (Lintels/Jacks).",
          "   c. [Validation] Checks for existence of Top and Bottom plates.",
          "   d. Identifies the specific Top and Bottom plates closest/furthest from the insertion point.",
          "   e. [Validation] Checks if the calculated PointLoad body intersects with any Opening beams (ignoring 'H' coded beams).",
          "8. Constructs the final display and Child TSLs based on validation results.",
          "9. Assigns the script instance to the group of the lowest Element selected."
        ],
        "conditionalBranches": [
          {
            "condition": "Existence of Top and Bottom Plates in the Element",
            "path1": {
              "name": "Missing Plates (Error)",
              "steps": [
                "Draws a wireframe box representation using Display layer.",
                "Draws text 'PL X' (where X is beam count).",
                "Stops script execution immediately (return), ignoring any other selected elements."
              ]
            },
            "path2": {
              "name": "Plates Found",
              "steps": [
                "Proceeds to calculate intersection with Top/Bottom plates.",
                "Checks for conflict with Opening beams."
              ]
            }
          },
          {
            "condition": "Intersection with Openings (Lintels/Jacks)",
            "path1": {
              "name": "Valid Location",
              "steps": [
                "Creates a new instance of child TSL 'hsbCAD_Point Load'.",
                "Passes Element, Point, and Properties to the child.",
                "Stores child reference in internal Map."
              ]
            },
            "path2": {
              "name": "Invalid Location (Blocked)",
              "steps": [
                "Draws two crossing PLines (an 'X') indicating the blocked area.",
                "Draws warning text 'Please change opening to fit the point load!'.",
                "Sets flag to color the main 'PL' label red."
              ]
            }
          },
          {
            "condition": "Extrusion Profile Selection",
            "path1": {
              "name": "Rectangular (Default)",
              "steps": [
                "Sets Beam Width (dBmW) to the Element's Beam Height."
              ]
            },
            "path2": {
              "name": "Custom Profile",
              "steps": [
                "Retrieves the specific ExtrProfile object.",
                "Calculates Beam Width (dBmW) based on the profile's extent in X direction."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "None (Script erases self silently or via standard CAD mechanisms)",
            "recovery": "User must re-run the script and select valid elements."
          },
          {
            "check": "Structural Beams (Top/Bottom Plates)",
            "errorMessage": "Displays wireframe symbol 'PL X' instead of generating structural beams.",
            "recovery": "User must ensure the selected element contains valid top and bottom plate beams (types: _kSFTopPlate, _kTopPlate, _kSFBottomPlate, etc.)."
          },
          {
            "check": "Opening Interference",
            "errorMessage": "Displays Red 'PL' text and a graphical 'X' at the insertion point with text 'Please change opening...'",
            "recovery": "User must move the insertion point away from openings/king studs/jacks or modify the wall opening size."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Properties via OPM (Properties Palette)",
            "how": "Change 'Align', 'Nr. of beams in pointload', 'Extrusion profile name', or 'Text style'.",
            "effect": "Script recalculates geometry, deletes old child TSLs, and generates new ones based on new parameters (e.g., moving point load left/center/right or changing width)."
          },
          {
            "action": "Grip Edit / Move",
            "how": "Select the TSL instance and move the insertion grip.",
            "effect": "Updates the insertion point (_Pt0), recalculates valid Top/Bottom targets and Opening intersections, and regenerates child TSLs."
          }
        ]
      },
      "tokens_used": 10648,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCAD_Multi Point Load\n\n## Overview\nThis script inserts structural point load reinforcements (typically vertical studs or blocking) into timber elements like walls or floors. It automatically detects top and bottom plates, validates for conflicts with wall openings, and generates the required beams based on your alignment and quantity settings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Used for 3D model generation. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required entities**: Element (e.g., a Wall or Floor panel) containing valid Top and Bottom plates.\n- **Minimum beam count**: 0 (The script analyzes beams contained within the selected Element).\n- **Required settings**: The child script `hsbCAD_Point Load` must exist in your TSL search path.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCAD_Multi Point Load.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the wall(s) or panel(s) where you want to apply the point load. Press Enter when finished.\n```\n\n### Step 3: Select Insertion Point\n```\nCommand Line: Select an insertion point\nAction: Click on the face of the element to define the location of the point load.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Align | dropdown | Left | Aligns the group of beams relative to the insertion point. Options: Left, Center, Right. |\n| Nr. of beams in pointload | dropdown | 1 | The number of vertical reinforcement beams to generate (Range: 1-12). |\n| Extrusion profile name | dropdown | *Empty* | Optional. Specifies a custom profile name. If empty, the beam width defaults to the Element's height. |\n| Text style | dropdown | *Empty* | Specifies the text style used for the \"PL\" (Point Load) label display. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (Standard hsbCAD Context) | Standard options (Erase, Move, Properties) apply. No specific custom menu items are added by this script. |\n\n## Settings Files\n- **Filename**: None used by this script.\n\n## Tips\n- **Opening Conflicts**: If the script displays a red \"PL\" text and a graphical \"X\" with a warning message, the point load location is interfering with an opening (lintel or jack stud). Move the insertion point away from the opening or adjust the opening size.\n- **Valid Elements**: Ensure your selected Element contains recognized Top and Bottom plates. If the script only draws a wireframe box \"PL X\", it could not find the necessary structural plates within the element.\n- **Adjusting Position**: You can grip-edit the insertion point after placement to move the load along the wall. The script will automatically re-check for valid plate intersections and opening conflicts.\n\n## FAQ\n- **Q: Why does my point load show as a red \"X\"?**\n  A: This indicates the location is blocked by an opening beam (like a lintel) or the script cannot safely fit the beams. Move the point load to a clear section of the wall.\n- **Q: Can I apply this to multiple walls at once?**\n  A: Yes, during the \"Select a set of elements\" prompt, you can select multiple walls. The point load will be applied to all of them at the relative insertion location."
      },
      "tokens_used": 4971,
      "error": null
    }
  }
}