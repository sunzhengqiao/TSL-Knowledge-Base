{
  "filename": "HSB_G-ContentFormat.mcr",
  "status": "completed",
  "total_tokens": 45727,
  "processing_time": 518.6968579292297,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \"minorVersion\": 11,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"Description\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.00\",\n      \"date\": \"04-11-2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Pilot version.\"\n    },\n    {\n      \"version\": \"1.01\",\n      \"date\": \"11-11-2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Get token for beamcode if element is ELEMENTWALLSF\"\n    },\n    {\n      \"version\": \"1.02\",\n      \"date\": \"14-11-2017\",\n      \"author\": \"RP\",\n      \"changes\": \"Add zone\"\n    },\n    {\n      \"version\": \"1.03\",\n      \"date\": \"07-02-2018\",\n      \"author\": \"RP\",\n      \"changes\": \"Add tsl props and check information and sublabel already set\"\n    },\n    {\n      \"version\": \"1.04\",\n      \"date\": \"05-03-2018\",\n      \"author\": \"RP\",\n      \"changes\": \"Trim tsl props with whitespaces\"\n    },\n    {\n      \"version\": \"1.05\",\n      \"date\": \"17-04-"
      },
      "tokens_used": 8710,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getEntity() to select an object and inspect its properties. It explicitly checks for hsbCAD specific 3D model entities like GenBeam and MasterPanel, accessing properties such as beamCode, SolidLength, and SolidHeight. There is no usage of _Viewport, Paper Space logic, or Shop Drawing generation patterns (#Type E)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Entity"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6934,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getEntity",
              "promptOriginal": "",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "contentFormat",
            "type": "PropString",
            "displayName": "|Content|",
            "defaultValue": "@(Material)",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "|Each autocad entity has a set of automatic properties defined. One way to see a list of the automatic properties, is to go into the AecStyleManager -> DocumentationObjects -> PropertySetDefinition, and create a dummy PropertySetDefinition. Set it to work with a single object of the type that you want to investigate in the Applies to tab. Then go to the tab Definition, and try to add an automatic property. The full list is shown.With this function, the list of automatic properties is made available in TSL. Only int, double and string entries are recognized currently.|"
          },
          {
            "index": 2,
            "variable": "contentValue",
            "type": "PropString",
            "displayName": "|Value|",
            "defaultValue": "CLS",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "|Check if this value is present in the content string|* |can be used as wildcard and| ; |as seperator|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Show Available Properties|",
            "handler": null,
            "action": "Lists available properties of the selected entity in the command line history",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 9769,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A diagnostic tool used to extract, format, and inspect data properties from any selected timber entity (beams, panels, etc.) to verify if specific values exist within those properties.",
          "category": "DataManagement",
          "typicalUseCase": "Used to verify that specific data (like 'CLS' for material) exists in an entity's properties, or to debug what data is available on a specific element."
        },
        "parameters": [
          {
            "name": "contentFormat",
            "technicalDefault": "@(Material)",
            "businessMeaning": "The template string that defines which data to extract from the selected entity. It uses tokens (e.g., '@(Material)', '@(Beamcode)') to reference Automatic Properties, Project Data, or Custom MapX data.",
            "validRange": "Any text string containing valid hsbCAD property tokens.",
            "unit": "String",
            "affectsOutput": "Generates the target string that will be checked against the 'Value' parameter. If the syntax is invalid, the script returns the raw string or an error."
          },
          {
            "name": "contentValue",
            "technicalDefault": "CLS",
            "businessMeaning": "The specific text or keyword the user wants to find inside the formatted content string.",
            "validRange": "Alphanumeric strings. Supports '*' as a wildcard and ';' to separate multiple check values.",
            "unit": "String",
            "affectsOutput": "Determines the result of the check (True/False). Does not change geometry, but affects the internal state or report notice indicating if the value was found."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Entity Selection",
            "effect": "The valid tokens for 'contentFormat' depend entirely on the type of entity selected (e.g., Panels have 'Position Number', Beams have 'Beamcode').",
            "cascade": [
              "contentFormat"
            ]
          },
          {
            "trigger": "contentFormat",
            "effect": "The resolved output of this parameter acts as the input source for the 'contentValue' search.",
            "cascade": [
              "contentValue"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "None",
            "description": "This script does not create physical geometry or machining. It generates a logic result and reports to the command line (via 'Show Available Properties').",
            "appliedTo": "N/A"
          }
        ]
      },
      "tokens_used": 6783,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Start: Define Properties (Content, Value) and Context Menu Triggers.",
          "Check Insertion State: Is _bOnInsert true?",
          "Yes (Insertion Mode):",
          "  Check Cycle Count: If insertCycleCount() > 1, erase instance and exit.",
          "  Configuration: If no Execute Key, show properties dialog to user.",
          "  User Selection: Prompt user to select a single Entity (getEntity).",
          "  Map Storage: Save selected Entity, Content string, and Value string to the Instance Map.",
          "  End Insertion: Return.",
          "No (Execution Mode):",
          "  Check Trigger: Is ManualInsert, MapIO, or Debug active?",
          "  Yes:",
          "    Load Data: Retrieve Entity, Content string, and Value string from Map (or properties if Map is empty).",
          "    Validation: Check if Entity is valid. If not, report error and erase instance.",
          "    Tokenization: Split Content string by '@(' to find dynamic properties.",
          "    Loop Tokens:",
          "      Check Syntax: Does token contain ')'?",
          "      Yes (Dynamic Property):",
          "        Check Dot Separator: Does token contain '.' (e.g., PropSet.Prop)?",
          "        Yes: Retrieve from MapX, SubMap, or Project Data.",
          "        No: Retrieve from Automatic Properties or hardcoded entity logic (Panel/Beam).",
          "      No (Static Text): Keep as is.",
          "      Append: Combine resolved parts into 'resultingString'.",
          "    Evaluation: Search 'resultingString' for the 'Value' string (handling wildcards ';').",
          "    Update State: Store result (FormatValueFound) in Map (implied by script structure).",
          "  Context Menu Action: 'Show Available Properties'?",
          "    Yes: Dump all Entity props (Project, MapX, AutoProps, TSL) to command line history."
        ],
        "conditionalBranches": [
          {
            "condition": "Token contains '.' separator",
            "path1": {
              "name": "Map/PropSet Lookup",
              "steps": [
                "Extract PropertySet name and Property key.",
                "Query Entity MapX, SubMap, or AttachedPropSets.",
                "Query Project Data if PropertySet implies project info."
              ]
            },
            "path2": {
              "name": "AutoProp/Entity Lookup",
              "steps": [
                "Extract Property key.",
                "Query Entity AutoPropertyMap.",
                "If Entity is MasterPanel, get Number/Info.",
                "If Entity is GenBeam, get Beamcode/Dimensions."
              ]
            }
          },
          {
            "condition": "Script Trigger Source",
            "path1": {
              "name": "Insertion",
              "steps": [
                "Select Entity.",
                "Store inputs to Map.",
                "Exit (wait for recalc)."
              ]
            },
            "path2": {
              "name": "Calculation/Update",
              "steps": [
                "Read inputs from Map.",
                "Resolve Content String.",
                "Perform Value check."
              ]
            },
            "path3": {
              "name": "Context Menu",
              "steps": [
                "Read Entity from Map.",
                "List all properties to Command Line."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Validity",
            "errorMessage": "|Entity not valid|",
            "recovery": "The script erases itself. User must select a valid entity and reinsert."
          },
          {
            "check": "Map Data Availability",
            "errorMessage": "(None explicitly, but defaults to OPM values)",
            "recovery": "Script defaults to empty or OPM values if Map is empty."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Content Format",
            "how": "OPM Properties Palette",
            "effect": "Changes the template string used to extract data from the entity."
          },
          {
            "action": "Modify Value",
            "how": "OPM Properties Palette",
            "effect": "Changes the string searched for within the formatted content."
          },
          {
            "action": "Show Available Properties",
            "how": "Right-click Context Menu",
            "effect": "Lists all accessible properties (Auto, MapX, Project, TSL) for the linked entity in the command line history."
          }
        ]
      },
      "tokens_used": 8133,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-ContentFormat\n\n## Overview\nThis script acts as a data inspector and verification tool for timber entities. It allows you to extract specific property data from a selected element (like material or beam code) and check if it contains a target value, which is useful for filtering or quality control.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script is designed to work on 3D model elements. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: You must select a single timber entity (Beam, Wall, Panel) when inserting the script.\n- **Minimum Beam Count**: N/A (User selects entity interactively).\n- **Required Settings Files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-ContentFormat.mcr` from the list.\n\n### Step 2: Select Target Entity\n```\nCommand Line: Select entity\nAction: Click on the timber element (beam, panel, etc.) you wish to inspect.\n```\n\n### Step 3: Configure Properties\nOnce the script is inserted and the entity is linked, select the script instance in AutoCAD and open the **Properties Palette** (Ctrl+1).\n1.  **Content**: Enter the data format you wish to extract (e.g., `@(Material)` or `@(Beamcode)`).\n2.  **Value**: Enter the text you expect to find in that data (e.g., `CLS`).\n\n### Step 4: Verify Data\n- To see a list of all available properties for the selected entity, right-click the script instance and choose **Show Available Properties**.\n- Press **F2** to open the AutoCAD Text Window and view the full list of properties.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **\\|Content\\|** | Text | `@(Material)` | The format string used to extract data from the entity. Use tokens like `@(PropertyName)` to access Automatic Properties (e.g., Material, Beamcode). |\n| **\\|Value\\|** | Text | `CLS` | The specific text string to search for within the extracted content. You can use `*` as a wildcard and `;` to separate multiple values. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **\\|Show Available Properties\\|** | Displays a comprehensive list of all properties (Automatic, MapX, Project Data, and TSL properties) associated with the selected entity in the command line history. |\n\n## Tips\n- **Finding Property Names**: If you don't know the exact name of a property (e.g., is it \"Width\" or \"WidthPlane\"?), use the **Show Available Properties** context menu option to dump the exact list to the text window.\n- **Wildcards**: In the **Value** parameter, use `*` to match parts of a string. For example, searching for `C*` would find \"CLS\", \"C24\", etc.\n- **Multiple Checks**: You can check for multiple values at once by separating them with a semicolon (e.g., `CLS;C24`).\n\n## FAQ\n- **Q: What does the `@()` syntax mean?**\n  **A:** This is a placeholder syntax that tells the script to look for an Automatic Property. Anything inside the parentheses (e.g., `@(Material)`) corresponds to a standard property defined in the hsbCAD database.\n\n- **Q: I selected an entity but got an error.**\n  **A:** Ensure the entity is a valid hsbCAD timber object (GenBeam, MasterPanel, etc.). Standard AutoCAD lines or polylines will not work.\n\n- **Q: Where can I see the result of the check?**\n  **A:** The script updates its internal state based on the check. While it does not create geometry, the \"FormatValueFound\" status is updated internally, which can be used by other scripts or filtering processes."
      },
      "tokens_used": 5398,
      "error": null
    }
  }
}