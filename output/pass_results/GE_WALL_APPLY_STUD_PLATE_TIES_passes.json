{
  "filename": "GE_WALL_APPLY_STUD_PLATE_TIES.mcr",
  "status": "completed",
  "total_tokens": 20383,
  "processing_time": 700.7175531387329,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.2",
            "date": "12.mar.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added option to erase itself when param. set to"
          },
          {
            "version": "1.1",
            "date": "28.feb.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "TSL won't do any calculations any more, sill be using .NET code to do so"
          },
          {
            "version": "1.0",
            "date": "28.jun.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4730,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for ElementWall selection using PrEntity (Model Space interaction), utilizes insertCycleCount() logic, and manages TSL instances attached to 3D elements. No 'sd_' prefixes or viewport logic present."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Utilities\\TslCustomSettings\\ITWApplyStudTies.dll"
          ]
        }
      },
      "tokens_used": 3439,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\n|Select wall(s)|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Form (via .NET Reflection)",
            "trigger": "_bOnInsert",
            "title": null,
            "dataSource": "ITWApplyStudTies.ApplyStudPlateTies.ApplyStudPlates",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sDistribution",
            "type": "PropString",
            "displayName": "|Apply to|",
            "defaultValue": "|Every stud|",
            "inputType": "dropdown",
            "options": [
              "|Every stud|",
              "|Every second stud|",
              "|Every third stud|",
              "|Remove hardware|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sAlignment",
            "type": "PropString",
            "displayName": "|Stud end|",
            "defaultValue": "|Both|",
            "inputType": "dropdown",
            "options": [
              "|Top|",
              "|Bottom|",
              "|Both|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sSide",
            "type": "PropString",
            "displayName": "|Wall side to apply harwdare|",
            "defaultValue": "|Same as icon|",
            "inputType": "dropdown",
            "options": [
              "|Same as icon|",
              "|Opposite to icon|"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "ITWApplyStudTies.dll",
            "searchPaths": [
              "\\Utilities\\TslCustomSettings"
            ],
            "purpose": "Provides logic and initial data for the script via ApplyStudPlates function.",
            "required": true
          }
        ]
      },
      "tokens_used": 3627,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Applies stud plate ties (hurricane straps/ties) to wall studs based on distribution rules and alignment settings, utilizing a .NET plugin to calculate placements.",
          "category": "Hardware",
          "typicalUseCase": "A user needs to secure wall studs to top and bottom plates with metal straps across multiple wall elements, specifying different frequencies (e.g., every second stud) and sides."
        },
        "parameters": [
          {
            "name": "sDistribution",
            "technicalDefault": "|Every stud|",
            "businessMeaning": "Controls the frequency of hardware application on the wall studs. Determines if ties are placed on all studs, or skipped according to a pattern. Includes an option to remove all generated hardware.",
            "validRange": [
              "|Every stud|",
              "|Every second stud|",
              "|Every third stud|",
              "|Remove hardware|"
            ],
            "unit": "Selection",
            "affectsOutput": "Alters the quantity and spacing of ties applied to the studs. If set to '|Remove hardware|', the script erases the instance and likely deletes associated geometry."
          },
          {
            "name": "sAlignment",
            "technicalDefault": "|Both|",
            "businessMeaning": "Specifies the vertical location of the tie on the stud relative to the wall plates.",
            "validRange": [
              "|Top|",
              "|Bottom|",
              "|Both|"
            ],
            "unit": "Selection",
            "affectsOutput": "Determines whether the tie connects the stud to the top plate, bottom plate, or both. Changes the vertical Z-position of the generated hardware."
          },
          {
            "name": "sSide",
            "technicalDefault": "|Same as icon|",
            "businessMeaning": "Determines on which side of the wall the hardware is physically applied relative to the icon or wall orientation.",
            "validRange": [
              "|Same as icon|",
              "|Opposite to icon|"
            ],
            "unit": "Selection",
            "affectsOutput": "Controls the lateral placement (Y-axis in wall coordinates) of the hardware, flipping it to the interior or exterior face of the wall."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sDistribution set to '|Remove hardware|'",
            "effect": "The script triggers an eraseInstance() command, removing the TSL instance and likely the associated hardware.",
            "cascade": [
              "sAlignment",
              "sSide"
            ]
          },
          {
            "trigger": "Selection of wall(s) during insert",
            "effect": "Invokes a .NET dialog (ITWApplyStudTies) which returns integer values mapping to the string options for Distribution, Alignment, and Side.",
            "cascade": [
              "sDistribution",
              "sAlignment",
              "sSide"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MetalPart / Hardware",
            "description": "Stud plate ties (metal straps) generated by the .NET plugin based on the configuration.",
            "appliedTo": "Studs within the selected ElementWall."
          },
          {
            "type": "TSL Instance",
            "description": "A parameterized instance of this script attached to the ElementWall, serving as a container for the configuration settings.",
            "appliedTo": "ElementWall"
          }
        ]
      },
      "tokens_used": 4166,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_APPLY_STUD_PLATE_TIES\n\n## Overview\nAutomates the application of metal stud plate ties (hurricane straps) to wall elements. It allows users to configure distribution frequency (e.g., every stud vs. every second stud), vertical alignment (top/bottom), and wall side placement for hardware.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D wall elements. |\n| Paper Space | No | Not designed for 2D layout or detailing views. |\n| Shop Drawing | No | Does not generate shop drawing views. |\n\n## Prerequisites\n- **Required Entities**: At least one `ElementWall`.\n- **Minimum Beam Count**: 1 (ElementWall).\n- **Required Settings**: `ITWApplyStudTies.dll` must be present in the `Utilities\\TslCustomSettings` folder.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WALL_APPLY_STUD_PLATE_TIES.mcr` from the file dialog.\n\n### Step 2: Select Wall\n```\nCommand Line: Select wall(s)\nAction: Click on the ElementWall(s) in the model where you want to apply ties. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Settings (Dialog)\nUpon selection, a configuration dialog (powered by the external plugin) will appear.\n```\nAction: Set the desired Distribution, Alignment, and Side preferences in the dialog. Click OK to generate the hardware.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Apply to | dropdown | Every stud | Determines how frequently ties are applied. Options: Every stud, Every second stud, Every third stud, Remove hardware. |\n| Stud end | dropdown | Both | Sets the vertical position of the tie relative to the wall plates. Options: Top, Bottom, Both. |\n| Wall side to apply hardware | dropdown | Same as icon | Determines which face of the wall the hardware is applied to. Options: Same as icon, Opposite to icon. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *Standard Options* | No custom context menu items are added. Use the Properties Palette to modify settings and recalculate. |\n\n## Settings Files\n- **Filename**: `ITWApplyStudTies.dll`\n- **Location**: `Utilities\\TslCustomSettings`\n- **Purpose**: Provides the calculation logic and the initial configuration dialog for placing stud plate ties.\n\n## Tips\n- **Removing Hardware**: To delete all generated ties without deleting the script instance, change the **Apply to** property to `Remove hardware`.\n- **Side Selection**: If the hardware appears on the wrong side of the wall (e.g., inside instead of outside), use the **Wall side to apply hardware** property to flip it.\n- **Updates**: Modifying properties in the Properties Palette will automatically trigger the .NET logic to update the hardware placement.\n\n## FAQ\n- **Q: How do I delete the ties I just created?**\n- **A:** Select the script instance (or the wall), open the Properties Palette, and change the \"Apply to\" parameter to \"Remove hardware\".\n- **Q: The script does not seem to run or shows an error.**\n- **A:** Ensure that `ITWApplyStudTies.dll` exists in your `hsbCAD\\Utilities\\TslCustomSettings` directory. This script relies entirely on this external file for its logic."
      },
      "tokens_used": 4421,
      "error": null
    }
  }
}