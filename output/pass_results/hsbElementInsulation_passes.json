{
  "filename": "hsbElementInsulation.mcr",
  "status": "completed",
  "total_tokens": 57004,
  "processing_time": 620.5849392414093,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9044,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script interacts with hsbCAD Element objects (ElementWall, ElementRoof), creates GenBeams, and modifies model data via MapX. It calculates 3D volumes and uses `eraseInstance()` to remove the TSL instance after generating physical bodies. No 'sd_' prefixes, '#Type E', or '_Viewport' references found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Must be associated with a valid Element (Wall or Roof) in the model.",
          "requiredSettings": [
            "hsbLooseMaterialsUI.dll (for Edit Inventory dialog)",
            "XML configuration file (optional, for Import/Export Settings)"
          ]
        }
      },
      "tokens_used": 5474,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": [
            {
              "prompt": "|Are you sure to overwrite existing settings?| [|No|/|Yes|]",
              "options": [
                "|No|",
                "|Yes|"
              ]
            }
          ]
        },
        "dialogs": [
          {
            "type": "ShowInventoryEditorDialog",
            "trigger": "Context Menu -> Edit Inventory",
            "title": "Edit Inventory",
            "dataSource": "hsbLooseMaterialsUI.dll",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "mapSetting",
            "type": "PropString",
            "displayName": "Catalog",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 1,
            "variable": "sManufacturer",
            "type": "PropString",
            "displayName": "Manufacturer",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 2,
            "variable": "sDescription",
            "type": "PropString",
            "displayName": "Description",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 3,
            "variable": "sMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 4,
            "variable": "sArticleNumber",
            "type": "PropString",
            "displayName": "ArticleNumber",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 5,
            "variable": "sColorLayer",
            "type": "PropString",
            "displayName": "ColorLayer",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 6,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "Zone",
            "defaultValue": 2,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 7,
            "variable": "dOffsetLeftRight",
            "type": "PropDouble",
            "displayName": "Offset Left/Right",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 8,
            "variable": "dOffsetBottomTop",
            "type": "PropDouble",
            "displayName": "Offset Bottom/Top",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 9,
            "variable": "dMaxHeight",
            "type": "PropDouble",
            "displayName": "Max Height",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 10,
            "variable": "nSides",
            "type": "PropInt",
            "displayName": "Sides",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 11,
            "variable": "bWriteToModel",
            "type": "PropInt",
            "displayName": "Write to model",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": "|General|",
            "description": null
          },
          {
            "index": 12,
            "variable": "nTransparency",
            "type": "PropInt",
            "displayName": "Transparency",
            "defaultValue": 80,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 13,
            "variable": "dFixedThickness",
            "type": "PropDouble",
            "displayName": "Fixed Thickness",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 14,
            "variable": "nThicknessVariable",
            "type": "PropInt",
            "displayName": "Thickness variable",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              "|Default|",
              "|Rigid|"
            ],
            "category": "|General|",
            "description": null
          },
          {
            "index": 15,
            "variable": "dGap",
            "type": "PropDouble",
            "displayName": "Gap",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 16,
            "variable": "sHWGroupName",
            "type": "PropString",
            "displayName": "Group",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          },
          {
            "index": 17,
            "variable": "sRValue",
            "type": "PropString",
            "displayName": "R-value",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Edit Insulation in Place",
            "handler": "|Edit Insulation in Place|",
            "action": "Invokes recalculation with key to edit insulation",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Add Area",
            "handler": "|Add Area||",
            "action": "Adds area to insulation logic",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Subtract Area",
            "handler": "|Subtract Area|",
            "action": "Subtracts area from insulation logic",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Edit Inventory",
            "handler": "|Edit Inventory|",
            "action": "Opens hsbLooseMaterialsUI inventory dialog",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Erase Insulation Sheeting",
            "handler": "|Erase Insulation Sheeting|",
            "action": "Erases generated insulation sheets and instance",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Database off",
            "handler": "|Database off|",
            "action": "Toggles inventory database usage off",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Database on",
            "handler": "|Database on|",
            "action": "Toggles inventory database usage on",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Import Settings",
            "handler": "|Import Settings|",
            "action": "Imports settings from XML configuration file",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Export Settings",
            "handler": "|Export Settings|",
            "action": "Exports current settings to XML configuration file",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "hsbLooseMaterialsUI.dll",
            "searchPaths": [
              "_kPathHsbInstall\\Utilities\\hsbLooseMaterials\\"
            ],
            "purpose": "Provides the Edit Inventory dialog",
            "required": false
          },
          {
            "filename": "hsbElementInsulation.xml",
            "searchPaths": [
              "_kPathHsbCompany\\General\\TslData\\hsbElementInsulation\\"
            ],
            "purpose": "Storage for Import/Export Settings functionality",
            "required": false
          }
        ]
      },
      "tokens_used": 9610,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically calculates and generates insulation materials (sheets or wool) within wall or roof elements based on defined structural zones and voids.\",\n    \"category\": \"Hardware\",\n    \"typicalUseCase\": \"Used during the detailing phase to populate the voids in timber frame panels or roof cassettes with specific insulation products for material take-offs (BOM) and physical representation in 3D.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"mapSetting\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Selects the specific catalog or preset configuration from the hsbLooseMaterials database that contains insulation product definitions.\",\n      \"validRange\": \"N/A (List of catalogs)\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Populates material properties (Name, Code, Manufacturer) and dimensions based on the selected catalog entry.\"\n    },\n    {\n      \"name\": \"sManufacturer\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The name of the company producing the insulation material.\",\n      \"validRange\": \"Any text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Written to the generated entity's properties and BOM data.\"\n    },\n    {\n      \"name\": \"sDescription\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A detailed text description of the insulation type (e.g., 'Mineral Wool 60mm', 'PIR Board 100mm').\",\n      \"validRange\": \"Any text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Used for identification in labels and reports.\"\n    },\n    {\n      \"name\": \"sMaterial\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The specific material classification for the insulation.\",\n      \"validRange\": \"Any text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Assigns material properties for rendering or thermal calculations.\"\n    },\n    {\n      \"name\": \"sArticleNumber\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The unique part number or SKU for purchasing and production tracking.\",\n      \"validRange\": \"Any alphanumeric string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Primary identifier in BOMs and inventory lists.\"\n    },\n    {\n      \"name\": \"sColorLayer\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Determines the CAD layer and visual color assigned to the generated insulation bodies.\",\n      \"validRange\": \"Layer names existing in the drawing\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Visual representation in the CAD model (Layer and Color).\"\n    },\n    {\n      \"name\": \"nZone\",\n      \"technicalDefault\": 2,\n      \"businessMeaning\": \"The structural zone within the wall/roof element where insulation is to be placed (e.g., zone 2 is typically the main insulation cavity between studs).\",\n      \"validRange\": \"1 to 10 (Typically 2 for walls)\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Defines the boundary volume that the insulation will fill. Incorrect selection results in placement outside the studs or in wrong layers.\"\n    },\n    {\n      \"name\": \"dOffsetLeftRight\",\n      \"technicalDefault\": 0.0,\n      \"businessMeaning\": \"Adjusts the insulation volume horizontally (relative to the element's local coordinate system) to handle off-center cavities or partial infill.\",\n      \"validRange\": \"-500mm to 500mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Shifts the insulation geometry horizontally within the element cross-section.\"\n    },\n    {\n      \"name\": \"dOffsetBottomTop\",\n      \"technicalDefault\": 0.0,\n      \"businessMeaning\": \"Adjusts the insulation volume vertically (relative to the element's local coordinate system) to allow for service runs or top/bottom plate overlap.\",\n      \"validRange\": \"-500mm to 500mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Shifts the insulation geometry vertically within the element cross-section.\"\n    },\n    {\n      \"name\": \"dMaxHeight\",\n      \"technicalDefault\": 0.0,\n      \"businessMeaning\": \"Limits the vertical extent of the insulation generation; used to prevent insulation from filling gable areas or specific ceiling heights.\",\n      \"validRange\": \"0 to Unlimited (0 = No Limit)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Cuts off insulation geometry if the element height exceeds this value.\"\n    },\n    {\n      \"name\": \"nSides\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Determines on which sides of the element the insulation is generated (e.g., Left, Right, or Both relative to insertion point).\",\n      \"validRange\": \"0 (All), 1 (Left), 2 (Right)\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Restricts insulation generation to specific sides of the element.\"\n    },\n    {\n      \"name\": \"bWriteToModel\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Controls whether the insulation is created as a physical 3D body (GenBeam/Sheet) or just calculated as virtual data.\",\n      \"validRange\": \"0 (No/Virtual), 1 (Yes/Physical)\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"If Yes, creates visible 3D sheets/wool geometry. If No, might only write attributes to the element.\"\n    },\n    {\n      \"name\": \"nTransparency\",\n      \"technicalDefault\": 80,\n      \"businessMeaning\": \"Controls the visual transparency of the generated insulation bodies to see underlying structure.\",\n      \"validRange\": \"0 (Opaque) to 90 (Near Invisible)\",\n      \"unit\": \"Percentage\",\n      \"affectsOutput\": \"Visual display style of the insulation 3D bodies.\"\n    },\n    {\n      \"name\": \"dFixedThickness\",\n      \"technicalDefault\": 0.0,\n      \"businessMeaning\": \"Forces the insulation to a specific thickness rather than automatically filling the calculated zone width.\",\n      \"validRange\": \"0 to 500mm (0 = Auto-fill zone)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Overrides the zone thickness for the generated insulation width.\"\n    },\n    {\n      \"name\": \"nThicknessVariable\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Defines the calculation strategy for handling varying cavity widths (e.g., between studs where widths might fluctuate). 'Default' adapts to cavity, 'Rigid' enforces strict dimensions.\",\n      \"validRange\": \"0 (Default/Flexible), 1 (Rigid)\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Determines how the script handles tolerances and varying widths in the generated geometry.\"\n    },\n    {\n      \"name\": \"dGap\",\n      \"technicalDefault\": 0.0,\n      \"businessMeaning\": \"Creates a shrinkage/spacing gap around the perimeter of the insulation to ensure easy fit or prevent overlap with framing.\",\n      \"validRange\": \"0mm to 20mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Reduces the plan area profile of the insulation sheets by the specified amount.\"\n    },\n    {\n      \"name\": \"sHWGroupName\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Assigns the generated insulation to a specific hardware group for BOM grouping and filtering.\",\n      \"validRange\": \"Any text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Classification in reports and hardware lists.\"\n    },\n    {\n      \"name\": \"sRValue\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The thermal resistance value of the insulation material.\",\n      \"validRange\": \"0.1 to 10.0+ (e.g., 3.5)\",\n      \"unit\": \"mÂ²K/W\",\n      \"affectsOutput\": \"Written to the entity properties for energy calculations or tagging.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"mapSetting is changed\",\n      \"effect\": \"Populates sManufacturer, sDescription, sMaterial, sArticleNumber based on database entry.\",\n      \"cascade\": [\n        \"sManufacturer\",\n        \"sDescription\",\n        \"sMaterial\",\n        \"sArticleNumber\"\n      ]\n    },\n    {\n      \"trigger\": \"nZone is changed\",\n      \"effect\": \"Recalculates the available void space based on the structural zones defined in the element.\",\n      \"cascade\": [\n        \"dOffsetLeftRight\",\n        \"dOffsetBottomTop\",\n        \"dFixedThickness\"\n      ]\n    },\n    {\n      \"trigger\": \"bWriteToModel is set to 'Yes'\",\n      \"effect\": \"Enables geometry creation logic and layer/color assignment.\",\n      \"cascade\": [\n        \"sColorLayer\",\n        \"nTransparency\"\n      ]\n    },\n    {\n      \"trigger\": \"dFixedThickness > 0\",\n      \"effect\": \"Overrides automatic thickness calculation, potentially constraining insulation to be smaller than the zone width.\",\n      \"cascade\": [\n        \"nThicknessVariable\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"GenBeam/Body\",\n      \"description\": \"3D geometric representation of the insulation sheets or wool blocks filling the voids"
      },
      "tokens_used": 11321,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Launch Script (via Command or Catalog)",
          "Prompt User to Select Element (ElementWall or ElementRoof)",
          "Validate Element Selection",
          "[Conditional] Baufritz Project Check: Detect existing TSL instance in same zone",
          "Load Settings (from Inventory Database if enabled, or Properties)",
          "Calculate Void Profile: Subtract Structural Zone from Element Contour",
          "Subtract Obstacles (Beams, Sheets, Openings) from Void Profile",
          "Process User Modifications (Add/Subtract Areas from context menu)",
          "Apply Offsets and Gaps (dOffsetLeftRight, dOffsetBottomTop, dGap)",
          "Check Max Height Constraint (dMaxHeight)",
          "Split Profile into Insulation Sheets/Batts",
          "[Conditional] Create Geometry: Generate GenBeam entities if 'Write to model' is Yes",
          "Calculate BOM Data: Accumulate Volume and Hardware Components",
          "Update Element MapX: Write 'insulationInfo' (Volume, Manufacturer, etc.)",
          "[Conditional] Self-Cleanup: Erase TSL Instance if physical sheets were created",
          "Finish"
        ],
        "conditionalBranches": [
          {
            "condition": "Existing Instance Found (Baufritz Mode)",
            "path1": {
              "name": "Overwrite",
              "steps": [
                "Detect existing instance in the same Zone",
                "Prompt Command Line: |Are you sure to overwrite existing settings?| [|No|/|Yes|]",
                "If Yes: Erase existing instance and properties",
                "Continue with new insertion logic"
              ]
            },
            "path2": {
              "name": "Cancel",
              "steps": [
                "User selects |No| or inputs nothing",
                "Terminate script execution"
              ]
            }
          },
          {
            "condition": "Database Connection Status",
            "path1": {
              "name": "Database On",
              "steps": [
                "Check if hsbLooseMaterialsUI.dll exists",
                "Enable 'ReadDatabase' flag in properties",
                "Load 'mapSetting' dropdown options from database",
                "Populate fields (Manufacturer, Article, etc.) on selection"
              ]
            },
            "path2": {
              "name": "Database Off",
              "steps": [
                "Disable 'ReadDatabase' flag",
                "Clear 'Item[]' map data",
                "Allow manual text entry for all properties"
              ]
            }
          },
          {
            "condition": "Write to Model (bWriteToModel)",
            "path1": {
              "name": "Create Physical Bodies",
              "steps": [
                "Set bCreate = true internally",
                "Generate GenBeam/Sheet entities for insulation",
                "Apply ColorLayer and Transparency",
                "Erase TSL Instance (eraseInstance())",
                "Set TSL Instance Weight to 0 to avoid duplicate mass calc"
              ]
            },
            "path2": {
              "name": "Virtual / Data Only",
              "steps": [
                "Perform volume calculation logic",
                "Write result to Element MapX",
                "Create Hardware Components (BOM entries)",
                "Retain TSL Instance in model for future updates"
              ]
            }
          },
          {
            "condition": "Export Settings File Existence",
            "path1": {
              "name": "Overwrite Existing File",
              "steps": [
                "Detect existing XML file at destination",
                "Prompt: |Are you sure to overwrite existing settings?|",
                "If Yes: Overwrite XML with current property map"
              ]
            },
            "path2": {
              "name": "Create New File",
              "steps": [
                "Confirm destination path is valid (create folders if needed)",
                "Write new XML file with current properties"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "No valid ElementWall or ElementRoof selected.",
            "recovery": "User must select a valid element entity."
          },
          {
            "check": "Zone Integrity",
            "errorMessage": "Calculated profile is empty or invalid for the selected zone.",
            "recovery": "Adjust 'nZone', 'dOffsetLeftRight', or 'dOffsetBottomTop' to match a valid cavity."
          },
          {
            "check": "Inventory DLL Availability",
            "errorMessage": "hsbLooseMaterialsUI.dll not found.",
            "recovery": "Ensure hsbCAD is installed correctly or use 'Database off' context menu option."
          },
          {
            "check": "Fixed Thickness vs Zone Width",
            "errorMessage": "Fixed thickness exceeds zone width.",
            "recovery": "Reduce 'dFixedThickness' or set to 0 for automatic calculation."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Parameters",
            "how": "Properties Palette (OPM)",
            "effect": "Modifying properties triggers recalculation and geometry update."
          },
          {
            "action": "Edit Inventory",
            "how": "Context Menu -> '|Edit Inventory|'",
            "effect": "Opens external dialog to select catalog entries; updates all relevant properties."
          },
          {
            "action": "Modify Insulation Area",
            "how": "Context Menu -> '|Add Area||' / '|Subtract Area|'",
            "effect": "Prompts selection of closed polylines to add or remove volume from the insulation calculation."
          },
          {
            "action": "Toggle Database Usage",
            "how": "Context Menu -> '|Database on|' / '|Database off|'",
            "effect": "Switches between Catalog-driven and Manual property entry modes."
          },
          {
            "action": "Import/Export Settings",
            "how": "Context Menu -> '|Import Settings|' / '|Export Settings|'",
            "effect": "Saves current configuration to XML or loads a previous configuration from XML."
          },
          {
            "action": "Remove Insulation",
            "how": "Context Menu -> '|Erase Insulation Sheeting|'",
            "effect": "Deletes generated sheets and the TSL instance."
          }
        ]
      },
      "tokens_used": 12156,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbElementInsulation.mcr\n\n## Overview\nAutomatically calculates and generates insulation materials (such as batts, wool, or rigid boards) within wall or roof elements. It fills voids defined by structural zones, allowing for both physical 3D representation and material take-off (BOM) data generation.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script interacts with hsbCAD Elements (Walls/Roofs) and creates GenBeams. |\n| Paper Space | No | This script operates on 3D model entities only. |\n| Shop Drawing | No | Not intended for 2D drawing generation. |\n\n## Prerequisites\n- **Required Entities:** An existing Element (ElementWall or ElementRoof) with defined structural zones.\n- **Minimum Beams:** N/A (Requires an Element, not individual beams).\n- **Required Settings:** \n  - `hsbLooseMaterialsUI.dll` (Optional, required for the \"Edit Inventory\" catalog dialog).\n  - XML Configuration file (Optional, used for Import/Export of settings).\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse and select `hsbElementInsulation.mcr`.\n\n### Step 2: Select Element\n```\nCommand Line: Select Element:\nAction: Click on the desired Wall or Roof element in the model.\n```\n\n### Step 3: Overwrite Check (Conditional)\nIf an insulation instance already exists in the same zone on the selected element:\n```\nCommand Line: Are you sure to overwrite existing settings? [No/Yes]\nAction: Type \"Yes\" to replace the existing insulation or \"No\" to cancel.\n```\n\n### Step 4: Configure Properties\nAfter insertion, the TSL instance is selected. Open the **Properties Palette** (Ctrl+1) to configure dimensions, materials, and behavior.\n\n### Step 5: Modify Geometry (Optional)\nRight-click the TSL instance to access context menu options for fine-tuning:\n- Select **\"Add Area\"** to include specific voids (select closed polylines).\n- Select **\"Subtract Area\"** to exclude areas (select closed polylines representing obstacles).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **General** | | | |\n| Catalog | dropdown | *Empty* | Select a preset configuration from the hsbLooseMaterials database (if available). |\n| Manufacturer | text | *Empty* | Name of the insulation manufacturer. |\n| Description | text | *Empty* | Descriptive name for the insulation type (e.g., \"Mineral Wool 100mm\"). |\n| Material | text | *Empty* | Material classification code. |\n| ArticleNumber | text | *Empty* | Unique SKU or part number for BOMs. |\n| Group | text | *Empty* | Hardware group name for sorting in reports. |\n| R-value | text | *Empty* | Thermal resistance value (e.g., 3.5). |\n| **Geometry** | | | |\n| Zone | number | 2 | The structural zone index to fill (typically Zone 2 is the main cavity between studs). |\n| Offset Left/Right | number | 0.0 | Horizontal offset (mm) relative to the element's center. |\n| Offset Bottom/Top | number | 0.0 | Vertical offset (mm) relative to the element's bottom. |\n| Max Height | number | 0.0 | Limits vertical fill; 0 means fill to top of element. |\n| Sides | number | 0 | Which sides to generate (0=All, 1=Left, 2=Right). |\n| Fixed Thickness | number | 0.0 | Forces a specific thickness (mm); 0 uses the full zone width. |\n| Thickness variable | dropdown | Default | Strategy for varying widths: \"Default\" (Flexible) or \"Rigid\". |\n| Gap | number | 0.0 | Shrinkage gap (mm) around the perimeter of the insulation. |\n| **Visualization** | | | |\n| Write to model | dropdown | No | **Yes**: Creates physical 3D bodies. **No**: Calculates virtual data/BOM only. |\n| ColorLayer | dropdown | *Empty* | The CAD layer assigned to the insulation bodies. |\n| Transparency | number | 80 | Visibility level (0=Opaque, 90=Transparent). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Edit Insulation in Place** | Triggers a recalculation/refresh of the insulation geometry. |\n| **Add Area** | Allows you to select closed polylines to add additional volume to the insulation. |\n| **Subtract Area** | Allows you to select closed polylines to create holes or exclusions in the insulation. |\n| **Edit Inventory** | Opens a dialog to select insulation products from the database (requires `hsbLooseMaterialsUI.dll`). |\n| **Erase Insulation Sheeting** | Removes the generated 3D insulation bodies and deletes the TSL instance. |\n| **Database on / off** | Toggles the connection to the inventory database. |\n| **Import Settings** | Loads configuration settings from an external XML file. |\n| **Export Settings** | Saves the current configuration to an external XML file for reuse. |\n\n## Settings Files\n- **Filename**: `hsbLooseMaterialsUI.dll`\n- **Location**: `_kPathHsbInstall\\Utilities\\hsbLooseMaterials\\`\n- **Purpose**: Provides the \"Edit Inventory\" dialog interface for selecting products from a catalog.\n\n- **Filename**: `hsbElementInsulation.xml`\n- **Location**: `_kPathHsbCompany\\General\\TslData\\hsbElementInsulation\\`\n- **Purpose**: Stores settings exported via the \"Export Settings\" menu for future import.\n\n## Tips\n- **Virtual vs. Physical:** Use \"Write to model\" = **No** if you only need insulation quantities in your BOM but do not want to clutter the 3D model with extra bodies.\n- **Zone Selection:** If insulation appears outside the studs or is missing, check the **Zone** number. Usually, Zone 1 is the internal finish/lining, Zone 2 is the framing cavity, and Zone 3 is the external sheathing.\n- **Partial Fill:** Use **Max Height** to prevent insulation from filling triangular gable ends if your wall has a pitched roof.\n- **Updating:** If you modify the wall (e.g., move a stud), select the insulation TSL instance and choose **Edit Insulation in Place** (or simply change a property) to regenerate the insulation to fit the new wall geometry.\n\n## FAQ\n- **Q: Why don't I see the insulation in my 3D view?**\n  - **A:** Check the \"Write to model\" property in the palette. It defaults to \"No\". Set it to \"Yes\" and regenerate.\n- **Q: How do I handle a window or opening that isn't being automatically detected?**\n  - **A:** Use the **Subtract Area** right-click option. Draw a polyline around the opening, select the menu item, and pick the polyline to cut that volume out.\n- **Q: Can I use this without a material database?**\n  - **A:** Yes. Right-click and select **Database off**. You can then manually type Manufacturer, Description, and Article numbers in the Properties Palette."
      },
      "tokens_used": 9399,
      "error": null
    }
  }
}