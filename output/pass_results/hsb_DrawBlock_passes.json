{
  "filename": "hsb_DrawBlock.mcr",
  "status": "completed",
  "total_tokens": 16956,
  "processing_time": 141.8044843673706,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "10.02.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2656,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No 'sd_' or 'Multipage' prefix found. No '_Viewport' usage. No '#Type E' with '_Entity[]'. Script uses getPoint for insertion and draws a Block object directly in the display."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 1095,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "Pick a Point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sBlockName",
            "type": "PropString",
            "displayName": "Block Name",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null,
            "readOnly": true
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1752,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Inserts a specific AutoCAD block definition as a graphical symbol at a user-selected point in the model.",
          "category": "Annotation / Symbol",
          "typicalUseCase": "Placing static graphical elements such as company logos, standard details, or 2D markers that are defined as blocks in the CAD environment."
        },
        "parameters": [
          {
            "name": "sBlockName",
            "technicalDefault": "",
            "businessMeaning": "The unique identifier name of the AutoCAD Block (DWG definition) to be inserted and displayed at the picked location.",
            "validRange": "Any string corresponding to an existing Block definition in the drawing's block table (e.g., 'LOGO_HSB', 'DETAIL_A').",
            "unit": "String",
            "affectsOutput": "Determines the geometry, scale, and visual appearance of the object. Since the property is read-only, the block name must be pre-configured (e.g., via script customization or initial assignment) to ensure the correct symbol is drawn."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "N/A",
            "effect": "N/A",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Block Reference",
            "description": "A graphical instance of an AutoCAD block definition, rendered at the insertion point specified by the user.",
            "appliedTo": "Model Space coordinate system"
          }
        ]
      },
      "tokens_used": 3705,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches the hsb_DrawBlock script.",
          "System checks the _bOnInsert flag to determine execution state.",
          "[If _bOnInsert is true] Command line prompts: 'Pick a Point'.",
          "User selects a coordinate in Model Space.",
          "System stores the coordinate in _Pt0 and suspends script execution (return).",
          "Script recalculation triggers (bOnInsert is now false).",
          "System initializes a Display context for drawing.",
          "System creates a Block object using the name defined in sBlockName.",
          "System renders the Block geometry at the stored _Pt0 coordinates."
        ],
        "conditionalBranches": [
          {
            "condition": "Is the script being inserted for the first time? (_bOnInsert check)",
            "path1": {
              "name": "Initial Insertion",
              "steps": [
                "Prompt user for input location",
                "Capture point to _Pt0",
                "Exit script (return)"
              ]
            },
            "path2": {
              "name": "Regeneration / Recalculation",
              "steps": [
                "Skip input prompts",
                "Execute drawing commands based on stored _Pt0 and properties"
              ]
            }
          },
          {
            "condition": "Validity of sBlockName property",
            "path1": {
              "name": "Valid Block Definition",
              "steps": [
                "Display creates the specified block geometry",
                "Object is visible in Model Space"
              ]
            },
            "path2": {
              "name": "Invalid or Empty Block Name",
              "steps": [
                "Display fails to find block definition",
                "No geometry is rendered (invisible object)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Existence of Block Definition in DWG",
            "errorMessage": "No explicit alert is generated by the script, but the object will appear empty or invisible.",
            "recovery": "Ensure the string in sBlockName matches a valid Block name in the current drawing. Since sBlockName is Read-Only, this must be configured in the script source or via a catalog, not via the Properties Palette."
          },
          {
            "check": "Point Input",
            "errorMessage": "User presses Esc during the 'Pick a Point' prompt.",
            "recovery": "Script insertion is cancelled. User must restart the command to try again."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Relocate the Block",
            "how": "Standard AutoCAD Move command or dragging the Entity grip (if supported by the specific CAD environment configuration for the insertion point).",
            "effect": "Updates the internal _Pt0 and moves the rendered block to the new location."
          },
          {
            "action": "Change Block Appearance",
            "how": "Not possible via OPM (Properties Palette).",
            "effect": "The sBlockName property is set to Read-Only. To change the symbol, the user would need to modify the script default properties or select a different script variation."
          }
        ]
      },
      "tokens_used": 4430,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_DrawBlock.mcr\n\n## Overview\nThis script inserts a predefined AutoCAD block definition as a graphical symbol at a user-selected location in Model Space.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Intended for placement in 3D or 2D model views. |\n| Paper Space | No | Not supported for layout sheets. |\n| Shop Drawing | No | Not intended for manufacturing views. |\n\n## Prerequisites\n- **Required entities**: None\n- **Minimum beam count**: 0\n- **Required settings files**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_DrawBlock.mcr`\n\n### Step 2: Pick Insertion Point\n```\nCommand Line: Pick a Point\nAction: Click anywhere in the Model Space to define where the block should be placed.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Block Name | text | (Empty) | The unique name of the AutoCAD Block definition to draw. Note: This property is Read-Only. |\n\n## Right-Click Menu Options\nNone available.\n\n## Settings Files\nNone used.\n\n## Tips\n- **Invisible Object**: If you insert the script but do not see any geometry, check that the Block Name specified in the script properties matches a block definition that actually exists in your current drawing.\n- **Read-Only Property**: You cannot change the block name via the Properties Palette after insertion. The specific block to be drawn is determined by the script configuration or catalog assignment.\n- **Moving the Symbol**: You can move the placed block using standard AutoCAD commands (e.g., `MOVE`) or by dragging the entity's insertion grip.\n\n## FAQ\n- **Q: Why is the Block Name property greyed out?**\n  A: The property is set to Read-Only to prevent accidental changes. To use a different block, you typically need to use a different script instance or edit the script source code.\n- **Q: The object vanished after I inserted it. How do I fix it?**\n  A: This usually means the script is trying to insert a block that hasn't been defined in the drawing yet. Ensure the required block definition is imported or created in the DWG file."
      },
      "tokens_used": 3318,
      "error": null
    }
  }
}