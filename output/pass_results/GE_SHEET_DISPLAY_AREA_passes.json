{
  "filename": "GE_SHEET_DISPLAY_AREA.mcr",
  "status": "completed",
  "total_tokens": 26652,
  "processing_time": 593.4436340332031,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.2",
            "date": "10.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "- Description added\n\t\t- Thumbnail added"
          },
          {
            "version": "1.1",
            "date": "04-may-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "- Works on xRefs also\n\t\t- Offset props. eliminated, display will be centered on sheet"
          },
          {
            "version": "1.0",
            "date": "22-apr-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4094,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "PrEntity(..., Sheet()) used for input selection. Script calculates geometry from Sheet entities using plEnvelope() and draws text using dp.draw() on the model coordinates. No sd_ prefix, _Viewport, or ShopDrawing specific entities are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing Sheet entities",
          "requiredSettings": []
        }
      },
      "tokens_used": 3088,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"\\\\n\"+T(\"|Select sheeting|\"+\"(s)\")\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"nColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"sDimstyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimstyle\",\n      \"defaultValue\": \"_DimStyles\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"_DimStyles\"\n      ],\n      \"category\": null,\n      \"description\": null\n    }\n  ],\n  \"contextMenu\": [],\n  \"settingsFiles\": []\n}\n```"
      },
      "tokens_used": 5165,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Calculates and displays the surface area (in square feet) of selected sheathing panels as a text label centered on each sheet.",
          "category": "Annotation/Estimation",
          "typicalUseCase": "Calculating material quantities for wall or floor sheathing during the design or detailing phase to generate cut lists or cost estimates."
        },
        "parameters": [
          {
            "name": "nColor",
            "technicalDefault": "1",
            "businessMeaning": "The display color (AutoCAD Color Index) of the area text label.",
            "validRange": "1 to 255 (Standard ACI values), or 0 for ByBlock",
            "unit": "ACI (AutoCAD Color Index)",
            "affectsOutput": "Changes the visibility color of the area text label in the CAD model space."
          },
          {
            "name": "sDimstyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "The specific dimension style that controls the font and text height of the area label.",
            "validRange": "Any valid Dimension Style name currently loaded in the drawing.",
            "unit": "String (Style Name)",
            "affectsOutput": "Determines the size and typeface of the text displayed on the sheet."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Geometry of the selected Sheet entity changes",
            "effect": "The script recalculates the area and updates the text position and value.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Text/Display",
            "description": "A single-line text string displaying the calculated area in 'SQ FT', placed at the geometric center of the sheet.",
            "appliedTo": "Selected 'Sheet' entities (Sheathing/Cladding)"
          }
        ]
      },
      "tokens_used": 3996,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered (Insert or Recalc)",
          "Check if insertion cycle (insertCycleCount > 1): If yes, erase instance and stop",
          "Check if initial insertion (_bOnInsert): If yes, proceed to User Input",
          "Display command line prompt: 'Select sheeting(s)'",
          "User selects Sheet entities and confirms (allowing nested/xRef selection)",
          "Valid entities are appended to the internal Sheet list (_Sheet)",
          "Set internal 'ExecutionMode' map flag to 0 (Calculation Mode)",
          "Verify Sheet list contains valid entities: If empty, erase instance and stop",
          "Initialize Display object with OPM properties (Color, Dimstyle)",
          "Check for Geometry Recalculation trigger (_bOnRecalc): Reset 'ExecutionMode' to 0 if true",
          "Check 'ExecutionMode' == 0 (Calculation Phase):",
          "Loop through all stored Sheets",
          "Calculate geometric envelope (PLine) and determine centroid (Point3d)",
          "Calculate surface area and convert units to Square Feet",
          "Store calculated Area and Centroid Point in internal Maps",
          "Switch 'ExecutionMode' to 1 (Drawing Phase)",
          "Loop through stored Point coordinates",
          "Retrieve corresponding Area value from Map",
          "Format text string: 'Area Value SQ FT'",
          "Draw text at Centroid coordinates using Display object"
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count",
            "path1": {
              "name": "Multi-Insert Detected",
              "steps": [
                "Detect insertCycleCount > 1",
                "Execute eraseInstance()",
                "Terminate script"
              ]
            },
            "path2": {
              "name": "First Insert",
              "steps": [
                "Detect insertCycleCount == 1",
                "Proceed to User Selection Prompt"
              ]
            }
          },
          {
            "condition": "Stored Sheet Validity",
            "path1": {
              "name": "No Sheets Found",
              "steps": [
                "Check _Sheet.length() <= 0",
                "Execute eraseInstance()",
                "Terminate script"
              ]
            },
            "path2": {
              "name": "Sheets Available",
              "steps": [
                "Check _Sheet.length() > 0",
                "Initialize Display context"
              ]
            }
          },
          {
            "condition": "Execution Mode State",
            "path1": {
              "name": "Calculation Mode (0)",
              "steps": [
                "Identify ExecutionMode == 0",
                "Reset stored Points array",
                "Iterate Sheets to find Centroids and Areas",
                "Update internal Maps with new data",
                "Set ExecutionMode to 1"
              ]
            },
            "path2": {
              "name": "Drawing Mode (1)",
              "steps": [
                "Identify ExecutionMode == 1",
                "Skip calculation loop",
                "Iterate stored Points to draw text labels"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insertion cycle count during batch operations",
            "errorMessage": "None (Silent failure)",
            "recovery": "User must run the script command individually or ensure it is not part of a copy-paste array that triggers multiple insert cycles."
          },
          {
            "check": "User selection confirmation (ssE.go())",
            "errorMessage": "Prompt displayed on command line",
            "recovery": "User must select at least one valid 'Sheet' entity and press Enter or Right-click to confirm."
          },
          {
            "check": "Validity of selected entities (sh.bIsValid())",
            "errorMessage": "None (Invalid entities are skipped silently)",
            "recovery": "Ensure the correct 'Sheet' type entities are selected; if all are invalid, the script instance erases itself."
          },
          {
            "check": "Existence of stored sheets after insertion",
            "errorMessage": "None (Instance erased if list is empty)",
            "recovery": "Re-insert the script and select valid entities."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Text Color",
            "how": "OPM (Object Properties Manager) -> Property: 'Color'",
            "effect": "Updates the color index (ACI) of the area text label immediately."
          },
          {
            "action": "Change Text Style/Size",
            "how": "OPM (Object Properties Manager) -> Property: 'Dimstyle'",
            "effect": "Updates the text font and height based on the selected Dimension Style."
          },
          {
            "action": "Update Sheathing Geometry",
            "how": "Grip edit or parameter change of the underlying Sheet entity",
            "effect": "Triggers _bOnRecalc, forcing the script to recalculate the area and center point, updating the text value and position."
          }
        ]
      },
      "tokens_used": 5944,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_SHEET_DISPLAY_AREA.mcr\n\n## Overview\nCalculates the surface area of sheathing or cladding sheets and displays the value in square feet (SQ FT) as a text label centered on each selected sheet.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D model entities (Sheets). |\n| Paper Space | No | Not designed for Layouts. |\n| Shop Drawing | No | Not designed for Shop Drawing generation. |\n\n## Prerequisites\n- **Required entities**: Sheet entities (e.g., wall or floor sheathing).\n- **Minimum beam count**: 0.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_SHEET_DISPLAY_AREA.mcr`\n\n### Step 2: Select Sheeting\n```\nCommand Line: Select sheeting(s)\nAction: Click on one or more Sheet entities in your model. Press Enter or Right-click to confirm selection.\n```\n*Note: The text label will automatically appear centered on each selected sheet.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Color | Number | 1 | Sets the color of the area text label (AutoCAD Color Index 1-255). |\n| Dimstyle | Dropdown | _DimStyles | Selects the Dimension Style used to determine the font and text height of the label. |\n\n## Right-Click Menu Options\nThere are no custom right-click menu options available for this script.\n\n## Settings Files\nNone.\n\n## Tips\n- **Dynamic Updates**: If you modify the geometry of the sheet (e.g., stretch or resize it), the script will automatically update the area value and reposition the text to the new center.\n- **XRef Support**: This script can detect and display areas for sheets contained within external references (XRefs).\n- **Text Size**: To change how large the text appears, change the `Dimstyle` property to a style with different text height settings, or modify the text height in the Dimension Style Manager in AutoCAD.\n\n## FAQ\n- **Q: What unit of measurement is used?**\n  - A: The area is always calculated and displayed in Square Feet (SQ FT).\n- **Q: Why did the text disappear?**\n  - A: If the underlying sheet entity is deleted or becomes invalid, the script instance will erase itself.\n- **Q: Can I use this on roof planes?**\n  - A: Yes, as long as the roof geometry is classified as a \"Sheet\" entity within hsbCAD, the script will calculate its surface area."
      },
      "tokens_used": 4365,
      "error": null
    }
  }
}