{
  "filename": "PC.mcr",
  "status": "partial",
  "total_tokens": 47746,
  "processing_time": 1047.7329728603363,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 4,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl creates a plate connector of of Knapp Walco\nhttps://www.knapp-verbinder.com/produkt/walco-v/",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "21.07.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-12270: add property \"Orientation Drill\" no/yes"
          },
          {
            "version": "1.3",
            "date": "21.07.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-12270: add property offset"
          },
          {
            "version": "1.2",
            "date": "27.06.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-12397: separate TSL instance for the representation of male part"
          },
          {
            "version": "1.1",
            "date": "24.06.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-12397: part can be aligned at a face in X direction"
          },
          {
            "version": "1.0",
            "date": "01.06.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-11913: initial"
          }
        ],
        "settingsFiles": [
          "PC.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 8518,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script creates 'HardWrComp' (Hardware Components) and generates tooling (milling/drilling) on beams, as indicated by properties like 'Tooling for connector beam' and 'Milling for connector beam'. It uses hwc.setLinkedEntity(bm) which associates geometry with 3D entities. There are no 'sd_' function calls, '_Viewport' checks, or '#Type E' entity definitions associated with Paper Space or Shop Drawing generation."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D environment)",
          "requiredSettings": [
            "PC.xml"
          ]
        }
      },
      "tokens_used": 6669,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"|Select insertion point|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": \"|Select connector beam|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": \"|Select male beam|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 4,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": \"|Select alignment beam|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 1,\n      \"variable\": \"sManufacturer\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Manufacturer|\",\n      \"defaultValue\": \"---\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Populated from XML/Map\",\n      \"category\": \"|Component|\",\n      \"description\": \"|Defines the Manufacturer|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sFamily\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Family|\",\n      \"defaultValue\": \"---\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Populated from XML/Map\",\n      \"category\": \"|Component|\",\n      \"description\": \"|Defines the Family|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sProduct\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Product|\",\n      \"defaultValue\": \"---\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Populated from XML/Map\",\n      \"category\": \"|Component|\",\n      \"description\": \"|Defines the Product|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sModeDistribution\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Mode of Distribution|\",\n      \"defaultValue\": \"|Even|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Even|\",\n        \"|Fixed|\"\n      ],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Defines the Mode of Distribution|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dDistanceBottom\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Start Distance|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Defines the Distance at the Start|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dDistanceTop\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|End Distance|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Defines the Distance at the End|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dDistanceBetween\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Max. Distance between / Quantity|\",\n      \"defaultValue\": 500.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Defines the Distance Between the parts. -integer indicates nr of parts|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dDistanceBetweenResult\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Real Distance between|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Shows the calculated distance between the articles|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nNrResult\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Nr.|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Distribution|\",\n      \"description\": \"|Shows the calculated quantity of articles|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Position|\",\n      \"description\": \"|Defines the Offset|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sClipLock\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Clip Lock|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Tooling for connector beam|\",\n      \"description\": \"|Defines whether clip lock will be applied or not|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dMillFemaleWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Width|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Milling for connector beam|\",\n      \"description\": \"|Defines the Mill Width for the connector beam.|\"\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dMillFemaleLength\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Length|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Milling for connector beam|\",\n      \"description\": \"|Defines the Mill Length for the connector beam.|\"\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dMillFemaleDepth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Depth|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Milling for connector beam|\",\n      \"description\": \"|Defines the Mill Depth for the connector beam.|\"\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"dDrillFemaleDiameter\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Diameter|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Drilling for connector beam|\",\n      \"description\": \"|Defines the Drill Diameter for the connector beam.|\"\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"dDrillFemaleXOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|X Offset|\",\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number"
      },
      "tokens_used": 9678,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the design and CNC detailing of Knapp Walco plate connectors, calculating spacing, offsets, and generating the necessary machining data for the timber beams.",
          "category": "Hardware",
          "typicalUseCase": "Used during the detailing phase to connect timber beams (e.g., purlins to rafters) using Walco plate connectors, ensuring correct fit and manufacturing output."
        },
        "parameters": [
          {
            "name": "sManufacturer",
            "technicalDefault": "---",
            "businessMeaning": "Selects the hardware manufacturer (e.g., Knapp) to load specific product catalogs.",
            "validRange": "Available manufacturers in PC.xml",
            "unit": "string",
            "affectsOutput": "Determines the available families and products; loads specific geometric and machining defaults."
          },
          {
            "name": "sFamily",
            "technicalDefault": "---",
            "businessMeaning": "Selects the product family (e.g., Walco V series) to filter specific connector types.",
            "validRange": "Available families for selected manufacturer",
            "unit": "string",
            "affectsOutput": "Filters the product list and updates available dimensions."
          },
          {
            "name": "sProduct",
            "technicalDefault": "---",
            "businessMeaning": "Selects the exact connector model (e.g., Walco V 1000), defining its physical size and fastener layout.",
            "validRange": "Available products for selected family",
            "unit": "string",
            "affectsOutput": "Sets the plate dimensions and default machining parameters (milling width/length/depth)."
          },
          {
            "name": "sModeDistribution",
            "technicalDefault": "|Even|",
            "businessMeaning": "Controls whether connectors are spaced evenly along the beam or placed at fixed intervals.",
            "validRange": "|Even|, |Fixed|",
            "unit": "enum",
            "affectsOutput": "Alters the calculation logic for the number of connectors and their spacing."
          },
          {
            "name": "dDistanceBottom",
            "technicalDefault": "0.0",
            "businessMeaning": "The clearance distance from the start of the beam to the first connector.",
            "validRange": "0mm to Beam Length",
            "unit": "mm",
            "affectsOutput": "Moves the position of the first connector instance."
          },
          {
            "name": "dDistanceTop",
            "technicalDefault": "0.0",
            "businessMeaning": "The clearance distance from the end of the beam to the last connector.",
            "validRange": "0mm to Beam Length",
            "unit": "mm",
            "affectsOutput": "Moves the position of the last connector instance."
          },
          {
            "name": "dDistanceBetween",
            "technicalDefault": "500.0",
            "businessMeaning": "Maximum spacing between connectors (if positive) or the exact quantity of connectors (if negative integer).",
            "validRange": "Positive (mm) or Negative (Integer count)",
            "unit": "mm or count",
            "affectsOutput": "Calculates the quantity of connectors and the gap between them."
          },
          {
            "name": "dOffset",
            "technicalDefault": "0.0",
            "businessMeaning": "Shifts the connector position perpendicular to the beam face or along the X-axis to align with edge conditions.",
            "validRange": "Typically -100mm to 100mm",
            "unit": "mm",
            "affectsOutput": "Offsets the insertion point of the connector/machining relative to the picked point."
          },
          {
            "name": "sClipLock",
            "technicalDefault": "|No|",
            "businessMeaning": "Specifies if a 'Clip Lock' (Sperrklappe) accessory is included in the connection.",
            "validRange": "|No|, |Yes|",
            "unit": "enum",
            "affectsOutput": "If Yes, adds the Clip Lock hardware component to the BOM/list."
          },
          {
            "name": "dMillFemaleWidth",
            "technicalDefault": "0.0",
            "businessMeaning": "The width of the pocket milled into the timber to fit the connector plate.",
            "validRange": "Product specific (e.g., 40-150mm)",
            "unit": "mm",
            "affectsOutput": "Defines the X-axis size of the CNC milling operation."
          },
          {
            "name": "dMillFemaleLength",
            "technicalDefault": "0.0",
            "businessMeaning": "The length of the pocket milled into the timber to fit the connector plate.",
            "validRange": "Product specific (e.g., 50-400mm)",
            "unit": "mm",
            "affectsOutput": "Defines the Y-axis size of the CNC milling operation."
          },
          {
            "name": "dMillFemaleDepth",
            "technicalDefault": "0.0",
            "businessMeaning": "How deep the connector plate sits into the timber (usually the plate thickness).",
            "validRange": "Product specific (e.g., 5-15mm)",
            "unit": "mm",
            "affectsOutput": "Defines the Z-axis depth of the CNC milling operation."
          },
          {
            "name": "dDrillFemaleDiameter",
            "technicalDefault": "0.0",
            "businessMeaning": "Diameter of holes drilled in the timber for the connector fasteners (nails/screws).",
            "validRange": "Product specific (e.g., 4-12mm)",
            "unit": "mm",
            "affectsOutput": "Determines the size of drill holes generated on the beam."
          },
          {
            "name": "dDrillFemaleXOffset",
            "technicalDefault": "0.0",
            "businessMeaning": "Shifts the drill hole centers along the beam's longitudinal axis.",
            "validRange": "mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the precise location of fastener holes relative to the plate center."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sManufacturer changes",
            "effect": "Filters the list of available families.",
            "cascade": [
              "sFamily",
              "sProduct"
            ]
          },
          {
            "trigger": "sFamily changes",
            "effect": "Filters the list of available products.",
            "cascade": [
              "sProduct"
            ]
          },
          {
            "trigger": "sProduct changes",
            "effect": "Auto-populates tooling dimensions (Width, Length, Depth) from the XML database.",
            "cascade": [
              "dMillFemaleWidth",
              "dMillFemaleLength",
              "dMillFemaleDepth",
              "dDrillFemaleDiameter"
            ]
          },
          {
            "trigger": "dDistanceBetween set to negative integer",
            "effect": "Forces the connector count to that number, overriding max distance calculation.",
            "cascade": [
              "nNrResult",
              "dDistanceBetweenResult"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Hardware Component",
            "description": "The connector plate object (and optional Clip Lock) listed in BOMs and reports.",
            "appliedTo": "Connector Beam"
          },
          {
            "type": "Milling/Pocket",
            "description": "Rectangular cutout in the timber to recess the connector plate flush with or below the surface.",
            "appliedTo": "Connector Beam"
          },
          {
            "type": "Drilling",
            "description": "Through or blind holes for fasteners (nails/screws) to attach the plate.",
            "appliedTo": "Connector Beam"
          }
        ]
      },
      "tokens_used": 10454,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization: Load settings file (PC.xml) and read Manufacturer data.",
          "2. Data Validation: Check if Manufacturer list is populated.",
          "3. User Input - Insertion Point: Prompt user to select a location in the model.",
          "4. User Input - Connector Beam: Prompt user to select the primary beam to machine.",
          "5. User Input - Male Beam: Prompt user to optionally select a connecting beam (secondary beam).",
          "6. User Input - Alignment Beam: Prompt user to optionally select a beam for geometric alignment.",
          "7. Property Configuration: User adjusts properties (Manufacturer, Family, Product, Distribution) via Properties Palette.",
          "8. Calculation: Script calculates connector quantity and spacing based on 'Mode of Distribution' and 'Distance' properties.",
          "9. Geometry Generation: Generate Milling (Pocket) and Drilling operations on the Connector Beam.",
          "10. Hardware Creation: Generate the Plate Connector hardware component.",
          "11. Conditional Logic: Evaluate 'Clip Lock' property to determine if additional hardware is added.",
          "12. Finalization: Link hardware to beam and display results."
        ],
        "conditionalBranches": [
          {
            "condition": "Manufacturer Data Availability",
            "path1": {
              "name": "Data Valid",
              "steps": [
                "Proceed to user input prompts.",
                "Populate Manufacturer property dropdown."
              ]
            },
            "path2": {
              "name": "Data Missing/Empty",
              "steps": [
                "Display error message: 'Could not find manufacturer data. Tool will be deleted.'",
                "Execute eraseInstance() to stop script execution."
              ]
            }
          },
          {
            "condition": "Distance Between Input (dDistanceBetween)",
            "path1": {
              "name": "Positive Value",
              "steps": [
                "Interpret value as maximum spacing in millimeters.",
                "Calculate number of parts required to fit within the beam length minus start/end distances."
              ]
            },
            "path2": {
              "name": "Negative Value",
              "steps": [
                "Interpret absolute value as the exact quantity of connectors.",
                "Calculate even spacing to distribute that exact number."
              ]
            }
          },
          {
            "condition": "Clip Lock Property (sClipLock)",
            "path1": {
              "name": "Enabled (Yes)",
              "steps": [
                "Read 'ClipLock' data from Product Map.",
                "Create additional 'HardWrComp' entry for the Clip Lock.",
                "Append to hardware list."
              ]
            },
            "path2": {
              "name": "Disabled (No)",
              "steps": [
                "Skip Clip Lock hardware generation.",
                "Process only main connector hardware."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Manufacturer Map Loading",
            "errorMessage": "PC.mcr: Could not find manufacturer data. Tool will be deleted.",
            "recovery": "Ensure PC.xml exists in the Company or Installation 'Settings' folder and contains valid manufacturer data."
          },
          {
            "check": "Connector Beam Selection",
            "errorMessage": "Prompt interrupted or no beam selected.",
            "recovery": "User must select a valid GenBeam during the insertion command sequence."
          },
          {
            "check": "Product Selection",
            "errorMessage": "Dimensions remain zero/default.",
            "recovery": "User must select a specific Product from the dropdown after selecting Manufacturer and Family to auto-populate milling/drilling dimensions."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Product Selection",
            "how": "Properties Palette (OPM) - Dropdowns",
            "effect": "Cascading update of Families/Products and auto-population of Milling (Width/Length/Depth) and Drilling (Diameter/Offset) dimensions based on XML data."
          },
          {
            "action": "Adjust Distribution",
            "how": "Properties Palette (OPM) - Numeric Inputs",
            "effect": "Updates 'Nr.' (Result) and 'Real Distance between' (Result) read-only properties and re-generates hardware instances along the beam."
          },
          {
            "action": "Toggle Clip Lock",
            "how": "Properties Palette (OPM) - Dropdown",
            "effect": "Adds or removes the Clip Lock component from the BOM/Hardware list."
          },
          {
            "action": "Delete Linked Beam",
            "how": "Model Space Interaction",
            "effect": "The TSL instance and associated hardware components are deleted or marked invalid as they depend on the beam entity."
          }
        ]
      },
      "tokens_used": 12427,
      "error": null
    },
    "6": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    }
  }
}