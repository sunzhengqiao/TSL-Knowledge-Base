{
  "filename": "Pitzl Pfostenträger.mcr",
  "status": "completed",
  "total_tokens": 43709,
  "processing_time": 733.4501366615295,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.6",
            "date": "29.11.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-16561: Fix bug at direction vectors"
          },
          {
            "version": "1.5",
            "date": "08.11.2022",
            "author": "Marsel Nakuci",
            "changes": "HSB-16561: Introduce xml structure; add 10920.1390 and 10920.1490"
          },
          {
            "version": "1.4",
            "date": "20oct17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "heavy duty models with squared top plate added (10930.1xxx and 10931.1xxx)"
          },
          {
            "version": "1.3",
            "date": "03feb16",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "oversize for drill diameters added"
          },
          {
            "version": "1.2",
            "date": "25november15",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "additional drill for welding added"
          },
          {
            "version": "1.1",
            "date": "25november15",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "vectors corrected, standard rotation method supported, insertion not possible for horizontal beams"
          },
          {
            "version": "1.0",
            "date": "25november15",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "initial version"
          }
        ],
        "settingsFiles": [
          "Pitzl Pfostenträger.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 9499,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates on `GenBeam` entities using `bm0.addTool()` to apply `Drill`, `Cut`, and `BeamCut` operations, indicating it modifies beam geometry in 3D. It creates 3D `Body` objects for visualization and `HardWrComp` components for hardware lists. There are no references to `_Viewport`, `sd_` prefixes, or shop drawing element lists."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (inserted onto a beam)",
          "requiredSettings": [
            "Pitzl Pfostenträger.xml"
          ]
        }
      },
      "tokens_used": 7561,
      "error": null
    },
    "3": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates and applies Pitzl adjustable post base hardware (types 10930 and 10931) to timber columns, including automatic drilling/cutting for installation and BOM generation.",
          "category": "Hardware / Connection",
          "typicalUseCase": "Anchoring a timber column to a concrete foundation or floor where vertical adjustment is required."
        },
        "parameters": [
          {
            "name": "sFamily",
            "technicalDefault": "First entry found in 'Pitzl Pfostenträger.xml' (e.g., '10930')",
            "businessMeaning": "Selects the hardware model series. 10930 uses a plain pipe, 10931 uses a threaded pipe.",
            "validRange": "10930, 10931 (or any defined in settings)",
            "unit": "String",
            "affectsOutput": "Determines the article number prefix, the central pipe diameter, and the specific BOM model."
          },
          {
            "name": "sArticle",
            "technicalDefault": "",
            "businessMeaning": "Selects the specific article number (e.g., 1000, 1003), which defines the height adjustment range and load capacity of the base.",
            "validRange": "Valid Pitzl article numbers defined in the XML settings (e.g., '1000', '1005', '1082', '1003')",
            "unit": "String",
            "affectsOutput": "Sets the minimum/maximum allowable height (`dHeight`), plate dimensions, and thread diameter."
          },
          {
            "name": "dHeight",
            "technicalDefault": "(dRangeMin + dRangeMax) / 2",
            "businessMeaning": "The installation height of the post base mechanism (distance from bottom plate to top plate).",
            "validRange": "Between dRangeMin and dRangeMax (dependent on Article selected, typically 110mm - 415mm)",
            "unit": "mm",
            "affectsOutput": "Adjusts the length of the threaded rod and the vertical position of the cut at the bottom of the beam."
          },
          {
            "name": "sMill",
            "technicalDefault": "|No|",
            "businessMeaning": "Determines if a pocket/milling should be cut into the wood to recess the top plate of the post base.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "If Yes, adds a cylindrical or square milling operation (`Drill` or `BeamCut`) and a larger diameter drilling for welding access."
          },
          {
            "name": "dMillDepth",
            "technicalDefault": "8 mm",
            "businessMeaning": "Extra depth added to the standard milling operation for the top plate.",
            "validRange": "0 mm - 50 mm",
            "unit": "mm",
            "affectsOutput": "Deepens the pocket cut into the timber if 'Milled' is active."
          },
          {
            "name": "dDrillDiaOversize",
            "technicalDefault": "2 mm",
            "businessMeaning": "Tolerance added to the diameter of the central hole drilled for the post base pipe.",
            "validRange": "0 mm - 10 mm",
            "unit": "mm",
            "affectsOutput": "Increases the diameter of the central vertical drill through the beam."
          },
          {
            "name": "sCoverHull",
            "technicalDefault": "|No|",
            "businessMeaning": "Option to include a protective cover (casing) around the adjustable rod.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Adds a 3D representation of the cover and adds a separate 'Cover hull' item to the hardware list (BOM)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing sFamily or sArticle",
            "effect": "Resets dHeight to the midpoint of the new article's range and updates all geometry dimensions.",
            "cascade": [
              "dHeight",
              "dRangeMin",
              "dRangeMax",
              "dThreadDia",
              "dTopPlateDia"
            ]
          },
          {
            "trigger": "Selecting 'Set to standard height' (Recalc Trigger)",
            "effect": "Resets the current height to the midpoint of the valid range.",
            "cascade": [
              "dHeight"
            ]
          },
          {
            "trigger": "Setting sMill to 'No'",
            "effect": "Disables the geometric effect of dMillDepth (though the property may still exist).",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Cut",
            "description": "Vertical saw cut at the bottom of the beam to set the height of the column.",
            "appliedTo": "Selected GenBeams"
          },
          {
            "type": "Drill",
            "description": "Central vertical hole for the adjustment pipe. Includes oversize tolerance.",
            "appliedTo": "Selected GenBeams"
          },
          {
            "type": "Drill / BeamCut",
            "description": "Pocket for the top plate (if 'Milled' is Yes) and access hole for welding.",
            "appliedTo": "Selected GenBeams"
          },
          {
            "type": "Body",
            "description": "3D visualization of the post base assembly (Top plate, pipe, bottom plate, nuts, optional cover).",
            "appliedTo": "Model Space (Visualization)"
          },
          {
            "type": "HardWrComp",
            "description": "BOM entries for the Post Base, Screws, and optional Cover Hull.",
            "appliedTo": "Script Instance (Lists)"
          }
        ]
      },
      "tokens_used": 9908,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script 'Pitzl Pfostenträger.mcr'.",
          "2. User selects one or multiple beams (GenBeam entities).",
          "3. User specifies insertion point or accepts default (Conditional):",
          "   - A. Press Enter: Script inserts at the bottom point of vertical beams.",
          "   - B. Pick Point: Script projects the selected point onto the beam's X-axis (supports sloped or upside-down insertion).",
          "4. Script validates beam orientation (rejects horizontal beams if specific logic applies per remarks).",
          "5. Properties Palette (OPM) displays configuration options.",
          "6. User selects 'Type' (Family) and 'Article' number.",
          "7. User adjusts 'Height' parameter.",
          "8. Script validates height against Article's allowed range (dRangeMin/dRangeMax).",
          "9. Script calculates geometry based on parameters.",
          "10. Script applies tools to beam (Cut, Drills, Milling).",
          "11. Script generates 3D Body representation.",
          "12. Script updates BOM (HardWrComp) with screws and optional cover hull.",
          "13. Script completes execution."
        ],
        "conditionalBranches": [
          {
            "condition": "User interaction during insertion phase",
            "path1": {
              "name": "Default Insertion",
              "steps": [
                "User presses Enter without selecting a point.",
                "Script identifies the bottom point of the beam.",
                "Post base is placed pointing downwards from the bottom."
              ]
            },
            "path2": {
              "name": "Point-based Insertion",
              "steps": [
                "User selects a point in 3D space.",
                "Script projects point onto the X-axis of the selected beam(s).",
                "Post base bottom is positioned at this projected point.",
                "Allows for sloped beams or upside-down installation."
              ]
            }
          },
          {
            "condition": "Property 'Milled' (sMill) set to 'Yes'",
            "path1": {
              "name": "Milled Execution",
              "steps": [
                "Checks 'Squared Top' status (based on Article).",
                "If Round: Adds Drill tool for top plate pocket.",
                "If Square: Adds BeamCut tool for top plate pocket.",
                "Increases main drill depth.",
                "Adds larger diameter Drill for welding access.",
                "Transforms cut point to account for plate thickness and mill depth."
              ]
            },
            "path2": {
              "name": "Non-Milled Execution",
              "steps": [
                "No pocket operation added.",
                "Standard vertical drill applied.",
                "Shorter welding drill applied (7mm depth).",
                "Cut point remains at reference height."
              ]
            }
          },
          {
            "condition": "Property 'Type' (sFamily) selection",
            "path1": {
              "name": "10930 (Plane pipe)",
              "steps": [
                "Sets drill radius to 42.5mm/2 plus oversize.",
                "Assigns specific Model description."
              ]
            },
            "path2": {
              "name": "10931 (Threaded pipe)",
              "steps": [
                "Sets drill radius to 43.5mm/2 plus oversize.",
                "Assigns specific Model description."
              ]
            }
          },
          {
            "condition": "Recalc Trigger 'Rotate post base' or Double Click",
            "path1": {
              "name": "Rotated State",
              "steps": [
                "Swaps Vector Y and Vector Z coordinates.",
                "Visual representation updates."
              ]
            },
            "path2": {
              "name": "Standard State",
              "steps": [
                "Uses standard beam coordinate vectors."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Height (dHeight) against Article Range",
            "errorMessage": "Height [value] out of range --> value corrected to [Min or Max]",
            "recovery": "Script automatically clamps the value to the nearest valid range boundary. User can trigger 'Set to standard height' to reset to midpoint."
          },
          {
            "check": "Settings File Version",
            "errorMessage": "A different Version of the settings has been found... Current Version [X] Other Version [Y]",
            "recovery": "Notification only. Script loads the version found in the installation path or company path depending on logic."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Adjust Installation Height",
            "how": "OPM (Property Palette) - Change 'Height' value or Drag Grip (Stretch)",
            "effect": "Moves the vertical cut on the beam up or down. Updates geometry and hardware scale."
          },
          {
            "action": "Reset to Standard Height",
            "how": "Right-click Context Menu - Select 'Set to standard height'",
            "effect": "Calculates (Min + Max) / 2 for the current article and sets the height property to this value."
          },
          {
            "action": "Rotate Hardware",
            "how": "Right-click Context Menu - Select 'Rotate post base' or Double Click",
            "effect": "Toggles a 90-degree rotation of the post base geometry around the beam's X-axis."
          },
          {
            "action": "Change Configuration (Family/Article/Milling/Cover)",
            "how": "OPM (Property Palette)",
            "effect": "Dynamically rebuilds the 3D body, modifies the machining operations on the beam, and updates the Bill of Materials (BOM)."
          }
        ]
      },
      "tokens_used": 10593,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Pitzl Pfostenträger.mcr\n\n## Overview\nThis script creates and applies Pitzl adjustable post base hardware (types 10930 and 10931) to timber columns. It automatically generates the necessary saw cuts, drilling, and milling operations on the beam, while providing 3D visualization and BOM entries for the hardware.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be inserted onto a beam in the 3D model. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | Does not generate 2D drawings directly. |\n\n## Prerequisites\n- **Required entities**: `GenBeam` (Timber beams/columns).\n- **Minimum beam count**: 1.\n- **Required settings files**: `Pitzl Pfostenträger.xml` (Must be present in Company or Install path).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `Pitzl Pfostenträger.mcr`\n\n### Step 2: Select Beams\n```\nCommand Line: Select beams:\nAction: Click on one or multiple timber columns (GenBeams) in the model.\n```\n\n### Step 3: Specify Insertion Point\n```\nCommand Line: Select insertion point / [Enter] for bottom point:\nAction: \n- Press Enter: The post base is placed automatically at the bottom of the column.\n- Click a Point: The post base is placed at the projected point on the beam's axis (useful for sloped beams or specific offsets).\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Family | Dropdown | 10930 | Selects the hardware model series. **10930** uses a plain pipe, **10931** uses a threaded pipe. |\n| Article | Dropdown | (First available) | Selects the specific article number (e.g., 1000, 1005). Determines the load capacity and height adjustment range. |\n| Height | Number | (Calculated) | The installation height of the post base mechanism. Must fall within the Min/Max range defined by the selected Article. |\n| Milled | Yes/No | No | If **Yes**, a pocket is milled into the wood to recess the top plate for a flush finish. |\n| Mill Depth | Number | 8 mm | Additional depth for the milling operation (only active if Milled is Yes). |\n| Drill Dia Oversize | Number | 2 mm | Tolerance added to the central hole diameter for the adjustment pipe. |\n| Cover Hull | Yes/No | No | If **Yes**, includes a protective cover (casing) around the rod in the visualization and BOM. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Rotate post base | Rotates the post base geometry 90 degrees around the beam's X-axis. Useful for aligning hardware on rectangular columns. |\n| Set to standard height | Resets the **Height** parameter to the midpoint of the allowed range for the currently selected Article. |\n\n## Settings Files\n- **Filename**: `Pitzl Pfostenträger.xml`\n- **Location**: Company or Install path\n- **Purpose**: Defines the catalog of available hardware models, including dimensions (diameters, plate sizes), valid height ranges, and article numbers for Pitzl series 10930 and 10931.\n\n## Tips\n- **Height Validation**: If you manually enter a height that is too high or too low for the selected Article, the script will automatically correct it to the nearest valid limit.\n- **Milling**: Use the **Milled** option when you want the top plate of the hardware to sit inside the timber rather than on top of it.\n- **Sloped Beams**: When working on non-vertical columns, use the \"Pick Point\" option during insertion to precisely position the base along the beam's axis.\n\n## FAQ\n- **Q: Can I use this on horizontal beams?**\n- **A**: This script is optimized for vertical columns. Insertion on horizontal beams is restricted or may not produce the expected results.\n- **Q: Why did my height change automatically?**\n- **A**: The height is constrained by the mechanical limits of the selected Article. If you change the Article to one with a smaller range, the script adjusts the height to fit.\n- **Q: How do I adjust the height after insertion?**\n- **A**: Select the script instance in the model and change the **Height** value in the Properties Palette, or use the grip point to stretch the connection."
      },
      "tokens_used": 6148,
      "error": null
    }
  }
}