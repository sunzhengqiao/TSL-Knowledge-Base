{
  "filename": "hsbCLT-X-Fix-L.mcr",
  "status": "completed",
  "total_tokens": 52750,
  "processing_time": 602.5354528427124,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.6",
            "date": "05.12.2024",
            "author": "Marsel Nakuci",
            "changes": "HSB-23003: save graphics in file for render in hsbView and make"
          },
          {
            "version": "1.5",
            "date": "18.01.2022",
            "author": "Thorsten Huck",
            "changes": "HSB-14406 description text corrected for block or rule set consumption"
          },
          {
            "version": "1.4",
            "date": "17.01.2022",
            "author": "Thorsten Huck",
            "changes": "HSB-14406 pline display in shopdrawings when tool not shown"
          },
          {
            "version": "1.3",
            "date": "22.12.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-14233 faro export unified"
          },
          {
            "version": "1.2",
            "date": "22.12.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-14233 supports tool description format, Faro-, Share-, Make-Exports, Dove or Freeprofile tool via tool index, new method to define shapes"
          },
          {
            "version": "1.1",
            "date": "14.04.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-11513 drawing of additional graphics supported, context command added for setup"
          },
          {
            "version": "1.0",
            "date": "13.04.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-11513 new tool to create X-Fix-L connections"
          }
        ],
        "settingsFiles": [
          "hsbCLT-X-Fix-L.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 9081,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script performs geometric calculations on GenBeam objects (bdA, bdB) referenced as 'panels', creates Hardware Components (HardWrComp), and manipulates 3D PlaneProfiles. While it generates 'DimRequest' maps to control visual representation in shop drawings (e.g., line types, colors, hidden lines), it does not contain 'sd_' functions, '_Viewport' usage, or '#Type E' entity definitions typical of Paper Space scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Element"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "hsbCLT-X-Fix-L.xml"
          ]
        }
      },
      "tokens_used": 7425,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 10328,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the creation and detailing of 'X-Fix-L' timber connections (specific dovetail or spline-like joints) between two CLT panels, including geometric cutouts, hardware assignment, and shop drawing annotations.",
          "category": "Connection/Hardware",
          "typicalUseCase": "A user selects two adjacent CLT panels (parallel, mitred, or T-connected) to generate the specific joint geometry and attach the corresponding hardware data (Greenethic X-Fix) for production and drawings."
        },
        "parameters": [
          {
            "name": "Type",
            "technicalDefault": "\"<_Default>|\"",
            "businessMeaning": "Selects the predefined configuration preset (e.g., specific size or profile variant) for the X-Fix connection from the XML settings.",
            "validRange": "List of strings defined in hsbCLT-X-Fix-L.xml (e.g., 'X-Fix-100', 'X-Fix-150')",
            "unit": "String",
            "affectsOutput": "Updates the geometric profile (Shape), dimensions (Width/Depth), and hardware index to match the chosen preset."
          },
          {
            "name": "Shape",
            "technicalDefault": "\"Current Shape\"",
            "businessMeaning": "Defines the exact 2D cross-sectional geometry of the cutout/tool. Can be a custom shape loaded via dialog or the shape associated with the selected Type.",
            "validRange": "PlaneProfile object",
            "unit": "Geometry",
            "affectsOutput": "Determines the physical shape of the material removed from the panels and the shape of the hardware representation."
          },
          {
            "name": "MaxLength",
            "technicalDefault": "from settings",
            "businessMeaning": "The maximum allowed length of the connection along the panel edge. If the gap/overlap is larger, the connection may be scaled or limited.",
            "validRange": "100mm - 2000mm",
            "unit": "mm",
            "affectsOutput": "Restricts the longitudinal extent of the generated PlaneProfile."
          },
          {
            "name": "XWidth",
            "technicalDefault": "from settings",
            "businessMeaning": "The width of the connection profile measured perpendicular to the joint direction (across the face of the panel).",
            "validRange": "50mm - 300mm (dependent on panel thickness)",
            "unit": "mm",
            "affectsOutput": "Scales the profile in the X-direction of the local coordinate system."
          },
          {
            "name": "ZDepth",
            "technicalDefault": "from settings",
            "businessMeaning": "The depth of the cut into the timber panel (penetration depth).",
            "validRange": "10mm - Panel Thickness",
            "unit": "mm",
            "affectsOutput": "Scales the profile in the Z-direction (depth), determining how deep the tool cuts."
          },
          {
            "name": "ToolIndex",
            "technicalDefault": "from settings",
            "businessMeaning": "Reference to a specific tool catalog entry (e.g., for CNC machining) or hardware variant index.",
            "validRange": "Integer Index",
            "unit": "Index",
            "affectsOutput": "Updates the Hardware Component properties (Model/Article Number)."
          },
          {
            "name": "TextHeight",
            "technicalDefault": "U(60)",
            "businessMeaning": "Height of the dimension/label text in shop drawings.",
            "validRange": "10mm - 200mm",
            "unit": "mm",
            "affectsOutput": "Scales the text size for the connection labels in generated drawings."
          },
          {
            "name": "YOffsetText",
            "technicalDefault": "dTextHeight",
            "businessMeaning": "Vertical offset distance from the center of the connection to the text label in shop drawings.",
            "validRange": "0mm - 500mm",
            "unit": "mm",
            "affectsOutput": "Moves the label position vertically relative to the joint center."
          },
          {
            "name": "ColorText",
            "technicalDefault": "nc",
            "businessMeaning": "Display color of the text label.",
            "validRange": "0 - 255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Visual appearance of the label text."
          },
          {
            "name": "HiddenLine",
            "technicalDefault": "from settings",
            "businessMeaning": "Configuration for hidden lines (edges behind the panel) in specific views.",
            "validRange": "Boolean/Map",
            "unit": "Setting",
            "affectsOutput": "Controls visibility of projected lines in top/side views (e.g., showing the cut through the panel)."
          },
          {
            "name": "ColorHidden",
            "technicalDefault": "from settings",
            "businessMeaning": "Color assigned to hidden projection lines.",
            "validRange": "0 - 255",
            "unit": "Index",
            "affectsOutput": "Visual style of hidden geometry in drawings."
          },
          {
            "name": "LineType",
            "technicalDefault": "from settings",
            "businessMeaning": "Linetype (e.g., Dashed, Hidden) used for projection lines.",
            "validRange": "String (Loaded Linetypes)",
            "unit": "String",
            "affectsOutput": "Line style of hidden geometry in drawings."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Selection of 'Type' changes",
            "effect": "The script loads the corresponding Map for that Type, updating Shape, MaxLength, XWidth, ZDepth, and ToolIndex to match the preset.",
            "cascade": [
              "Shape",
              "MaxLength",
              "XWidth",
              "ZDepth",
              "ToolIndex"
            ]
          },
          {
            "trigger": "Panels move/rotate (Recalculation)",
            "effect": "The script recalculates the local coordinate system (vecYC, vecZC) and transforms the Shape and DimRequests to align with the new panel positions.",
            "cascade": [
              "Shape",
              "Text Location",
              "Hidden Geometry"
            ]
          },
          {
            "trigger": "ShowTooling property (implied by bShowTooling logic)",
            "effect": "If tooling is hidden, the script generates DimRequests with polylines (shadows) instead of displaying 3D bodies, utilizing LineType and ColorHidden.",
            "cascade": [
              "DimRequest",
              "LineType",
              "ColorHidden"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "PlaneProfile (Subtractive)",
            "description": "Geometric cutout applied to GenBeam A and GenBeam B to create the physical joint.",
            "appliedTo": "Selected GenBeam entities (CLT Panels)"
          },
          {
            "type": "HardWrComp (Hardware Component)",
            "description": "Component data added to the BOM/Cam list (Manufacturer: Greenethic), representing the X-Fix connector.",
            "appliedTo": "The script instance (linking to the Element/Group)"
          },
          {
            "type": "DimRequest (Shop Drawing)",
            "description": "Graphical representations for 2D drawings, including connection outlines, dimension lines, text labels (Type, Length), and hidden line projections.",
            "appliedTo": "Views associated with the processed GenBeams"
          }
        ]
      },
      "tokens_used": 8897,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script: User runs command (likely via icon or command line).",
          "2. Load Settings: Script reads configuration from 'hsbCLT-X-Fix-L.xml' (Company or Install path).",
          "3. Select Entities: User selects the second CLT panel (GenBeam) to connect (implied, as 2 panels are required).",
          "4. Dynamic Jigging: User moves cursor along the joint intersection; script dynamically updates the preview (red/yellow profiles) showing cutouts relative to the cursor position (`ptJig`).",
          "5. Placement: User clicks to confirm the position of the connection along the panel edge.",
          "6. Configuration (OPM): Properties Palette opens, allowing user to select 'Type' (preset) and parameters.",
          "7. Generation: Script calculates local coordinate system, transforms profiles, and generates cutouts.",
          "8. BOM Update: Script creates a 'Greenethic' Hardware Component linked to the panels.",
          "9. Annotation: Script generates 'DimRequests' for shop drawings (text, dimensions, and hidden lines if tooling is hidden)."
        ],
        "conditionalBranches": [
          {
            "condition": "DialogMode State (Script Execution Phase)",
            "path1": {
              "name": "Insert Mode",
              "steps": [
                "User inputs location via Jig",
                "Geometry is calculated",
                "Hardware Component is created",
                "Instance is saved to database"
              ]
            },
            "path2": {
              "name": "Edit/Setup Mode (DialogMode > 0)",
              "steps": [
                "Script detects property change or context menu trigger",
                "Updates OPM fields (e.g., Type selection list)",
                "Recalculates geometry based on new values without full re-insertion"
              ]
            }
          },
          {
            "condition": "Visualization Setting (bShowTooling)",
            "path1": {
              "name": "Tooling Visible (True)",
              "steps": [
                "Generates 3D PlaneProfiles for the tool body",
                "Displays solid geometry in 3D model"
              ]
            },
            "path2": {
              "name": "Tooling Hidden (False)",
              "steps": [
                "Suppresses 3D tool body",
                "Generates 'DimRequest' polylines in Top/Side views to represent cutout location",
                "Uses specific LineType and ColorHidden for projection lines"
              ]
            }
          },
          {
            "condition": "Shape Selection",
            "path1": {
              "name": "Current Shape",
              "steps": [
                "Uses the PlaneProfile currently stored in the script Map",
                "Keeps existing geometry"
              ]
            },
            "path2": {
              "name": "Select Shape",
              "steps": [
                "Prompts user (via TslUtilities or file dialog) to select a new profile",
                "Updates the internal Shape Map entry",
                "Recalculates the joint geometry"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Settings File Availability",
            "errorMessage": "Notice reported if XML version in Company folder differs from Install folder, or if file is missing.",
            "recovery": "Script attempts to load from default installation path if Company path fails."
          },
          {
            "check": "Entity Selection",
            "errorMessage": "Script expects 2 GenBeams (CLT Panels). Logic for bdA and bdB implies specific intersection handling.",
            "recovery": "User must ensure 2 valid panels are selected before running or during selection prompt."
          },
          {
            "check": "Hardware Group Assignment",
            "errorMessage": "Hardware Group (sHWGroupName) cannot be determined.",
            "recovery": "Script defaults to the script instance's Group if parent Element group is invalid."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Move Connection",
            "how": "Grip Edit (Point3d _PtJig)",
            "effect": "Triggers `_bOnJig` event, allowing user to slide the connection along the panel edge. Updates `ppShape` and `ppTool` positions dynamically."
          },
          {
            "action": "Change Type/Preset",
            "how": "OPM Properties Palette",
            "effect": "Updates internal Map variables (MaxLength, XWidth, ZDepth, ToolIndex) from the selected XML preset and regenerates geometry."
          },
          {
            "action": "Toggle Tooling Visibility",
            "how": "OPM Properties Palette",
            "effect": "Switches between displaying 3D bodies and generating shop drawing shadow lines (DimRequests)."
          },
          {
            "action": "Edit Shape",
            "how": "OPM Properties Palette (Select Shape option)",
            "effect": "Allows replacing the current cutout profile with a custom profile loaded from disk."
          }
        ]
      },
      "tokens_used": 10433,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-X-Fix-L.mcr\n\n## Overview\nAutomates the creation and detailing of 'X-Fix-L' timber connections (specific dovetail or spline-like joints) between two CLT panels, including geometric cutouts, hardware assignment, and shop drawing annotations.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Primary environment for creating geometry and assigning hardware. |\n| Paper Space | No | Not a layout script. |\n| Shop Drawing | No | Generates DimRequests for shop drawings but runs in Model Space. |\n\n## Prerequisites\n- **Required Entities**: Two GenBeams (CLT Panels) or an Element containing them.\n- **Minimum Beam Count**: 2\n- **Required Settings**: `hsbCLT-X-Fix-L.xml` (Loaded from Company or Install path).\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command**: `TSLINSERT` (or specific icon) â†’ Select `hsbCLT-X-Fix-L.mcr`\n\n### Step 2: Select Panels\n```\nCommand Line: Select element/beam:\nAction: Select the first CLT panel if not pre-selected, then select the second adjacent panel to connect.\n```\n\n### Step 3: Position Connection\n```\nCommand Line: Specify location:\nAction: Move your cursor along the joint intersection. A dynamic preview (red/yellow profiles) will show the cutout position. Click to place the connection.\n```\n\n### Step 4: Configure Properties\n```\nAction: After placement, the Properties Palette (OPM) opens automatically. Select the desired 'Type' preset or adjust dimensions (Width, Depth) as needed.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | String | `<_Default>|` | Selects the predefined configuration preset (e.g., specific size or profile variant) from the XML settings. |\n| Shape | Geometry | Current Shape | Defines the 2D cross-sectional geometry of the cutout. Select \"Select Shape\" to load a custom profile. |\n| MaxLength | Number | from settings | The maximum allowed length of the connection along the panel edge. |\n| XWidth | Number | from settings | The width of the connection profile measured perpendicular to the joint direction. |\n| ZDepth | Number | from settings | The depth of the cut into the timber panel (penetration depth). |\n| ToolIndex | Number | from settings | Reference to a specific tool catalog entry or hardware variant index. |\n| TextHeight | Number | U(60) | Height of the dimension/label text in shop drawings. |\n| YOffsetText | Number | dTextHeight | Vertical offset distance from the center of the connection to the text label in shop drawings. |\n| ColorText | Number | nc | Display color of the text label (AutoCAD Color Index). |\n| HiddenLine | Boolean | from settings | Toggles visibility of projected lines (edges behind the panel) in specific views. |\n| ColorHidden | Number | from settings | Color assigned to hidden projection lines. |\n| LineType | String | from settings | Linetype (e.g., Dashed, Hidden) used for projection lines. |\n| ShowTooling | Boolean | True | If True, displays 3D tool bodies. If False, generates 2D polylines (shadows) for drawings. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Setup | Opens the configuration dialog to modify script settings or presets. |\n| Update | Recalculates the connection geometry based on current panel positions. |\n| Erase | Removes the script instance and associated geometry. |\n\n## Settings Files\n- **Filename**: `hsbCLT-X-Fix-L.xml`\n- **Location**: Company or Install path\n- **Purpose**: Contains presets for different connection types, defining default dimensions (MaxLength, XWidth, ZDepth), tool indices, and shape profiles.\n\n## Tips\n- **Moving the Connection**: Select the script instance in the model and use the square grip point to slide the connection along the panel edge without deleting and re-inserting.\n- **Shop Drawings**: If the 3D tool body interferes with your view, set `ShowTooling` to False. The script will generate clean 2D polylines in the shop drawing views instead.\n- **Custom Profiles**: Use the `Shape` property to browse for a custom `.pf` (PlaneProfile) file if the standard presets do not meet your design requirements.\n\n## FAQ\n- **Q: Why are my cutouts not appearing?**\n  - A: Check if the `ShowTooling` property is set to False. If set to False, the 3D geometry is hidden, but lines will appear in generated shop drawings.\n- **Q: Can I connect panels that are not perfectly aligned?**\n  - A: The script supports parallel, mitred, or T-connected panels. Ensure you select the correct two panels during the insertion phase.\n- **Q: How do I change the hardware description?**\n  - A: Modify the `Type` property to load a different preset, or manually adjust the `ToolIndex` if you know the specific catalog number required."
      },
      "tokens_used": 6586,
      "error": null
    }
  }
}