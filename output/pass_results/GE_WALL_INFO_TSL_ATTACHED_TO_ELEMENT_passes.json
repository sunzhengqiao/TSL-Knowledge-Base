{
  "filename": "GE_WALL_INFO_TSL_ATTACHED_TO_ELEMENT.mcr",
  "status": "completed",
  "total_tokens": 15875,
  "processing_time": 268.8089199066162,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2530,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script targets _Element[] entities and retrieves TSL instances via tslInstAttached(). It lacks sd_* prefixes, _Viewport checks, or #Type E definitions typical of Paper Space or ShopDrawing scripts. It is a utility script that reports data for Elements selected in the 3D model."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires an Element to be selected in Model Space. The script auto-erases itself if no element is found.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1327,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select element",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "reportNotice",
            "trigger": "Script execution if TSLs are attached to the selected element",
            "title": null,
            "dataSource": "Attached TSL instances from _Element[0].tslInstAttached()",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1927,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A diagnostic utility script that lists all other scripts (TSLs) currently attached to a selected element, then deletes itself.",
          "category": "Diagnostics / Information",
          "typicalUseCase": "When a user needs to troubleshoot a wall or element to see which manufacturing or connection scripts are currently active and assigned to it."
        },
        "parameters": [
          {
            "name": "_Element",
            "technicalDefault": "None (Selected at runtime)",
            "businessMeaning": "The specific wall or structural element to be audited for attached TSL instances.",
            "validRange": "Any valid Element entity present in the drawing.",
            "unit": "Entity",
            "affectsOutput": "Determines the scope of the search; the script retrieves the list of TSL instances specifically from this element to generate the text report."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": []
      },
      "tokens_used": 3265,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution starts.",
          "2. Check if the script is in 'Insert' mode (_bOnInsert).",
          "3. [Insert Mode] Prompt user 'Select element' via getElement().",
          "4. [Insert Mode] Append selected entity to _Element list and return (wait for next cycle).",
          "5. [Execution Mode] Verify that the _Element list contains an entity.",
          "6. [No Element] Call eraseInstance() to delete the script and stop execution.",
          "7. [Element Exists] Retrieve array of attached TSL instances from _Element[0] using tslInstAttached().",
          "8. Evaluate the count of attached TSLs (tsl.length()).",
          "9. [Count <= 1] Display reportNotice stating 'No TSL's is attached to element: [Code]-[Number]'.",
          "10. [Count > 1] Initialize string variable with element header.",
          "11. [Count > 1] Loop through attached TSL array; if the TSL is not the current script, append its name to the string.",
          "12. [Count > 1] Display reportNotice with the formatted list of attached TSL names.",
          "13. Call eraseInstance() to delete the script instance from the drawing."
        ],
        "conditionalBranches": [
          {
            "condition": "Is the script running for the first time? (_bOnInsert)",
            "path1": {
              "name": "Insertion",
              "steps": [
                "Prompt user to select element.",
                "Assign selection to _Element.",
                "Exit function (return)."
              ]
            },
            "path2": {
              "name": "Post-Selection",
              "steps": [
                "Validate selection.",
                "Process TSL data.",
                "Clean up and exit."
              ]
            }
          },
          {
            "condition": "Does the user have an Element selected? (_Element.length() == 0)",
            "path1": {
              "name": "Invalid Selection",
              "steps": [
                "Erase script instance immediately."
              ]
            },
            "path2": {
              "name": "Valid Selection",
              "steps": [
                "Proceed to analyze element attachments."
              ]
            }
          },
          {
            "condition": "Number of attached TSLs (excluding current script)",
            "path1": {
              "name": "Single or None (<= 1)",
              "steps": [
                "Report that no TSLs are attached."
              ]
            },
            "path2": {
              "name": "Multiple (> 1)",
              "steps": [
                "Iterate and list all attached TSL names."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element array population",
            "errorMessage": "No explicit error message shown.",
            "recovery": "Script erases itself; user must re-insert and select a valid element."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 2811,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_INFO_TSL_ATTACHED_TO_ELEMENT\n\n## Overview\nThis is a diagnostic utility script that identifies which manufacturing or connection TSL scripts are currently attached to a specific wall or element. After displaying the information in a pop-up notice, the script automatically deletes itself from the drawing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script must be run in the 3D model to select an element. |\n| Paper Space | No | This script does not function in layout views. |\n| Shop Drawing | No | This script is not intended for shop drawings or detailing views. |\n\n## Prerequisites\n- **Required entities**: An existing Element (e.g., a Wall) in the drawing.\n- **Minimum beam count**: 0 (Operates on Elements, not individual beams).\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse to and select `GE_WALL_INFO_TSL_ATTACHED_TO_ELEMENT.mcr`\n\n### Step 2: Select Element\n```\nCommand Line: Select element\nAction: Click on the wall or element in the model you wish to audit.\n```\n*Note: The script will wait for you to select an object. Once selected, it will process the information on the next cycle.*\n\n### Step 3: View Results\nThe script will display a `reportNotice` (pop-up dialog) listing all TSLs attached to the selected element (excluding this info script itself).\n- **Result**: If no other scripts are found, it will state \"No TSL's is attached to element.\"\n- **Result**: If scripts are found, it lists their names.\n\n### Step 4: Automatic Cleanup\nThe script automatically executes an `eraseInstance` command immediately after showing the report. It will not remain visible in the model.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script has no editable properties in the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script exposes no custom context menu options. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Self-Deleting**: Do not be alarmed if the script \"disappears\" immediately after you run it. This is intended behavior to keep the drawing clean.\n- **Troubleshooting**: Use this script when a wall is behaving unexpectedly (e.g., missing holes or notches) to verify if the correct processing TSLs are actually attached.\n- **Selection**: Ensure you click directly on the main Element entity. If you click on empty space, the script will simply erase itself without producing a report.\n\n## FAQ\n- **Q: Why did the script vanish immediately after I selected the element?**\n  A: The script is designed to display the report and then automatically delete its own instance from the drawing (`eraseInstance`).\n- **Q: The report says \"No TSL's is attached,\" but I expected there to be scripts.**\n  A: This indicates the element is raw and has no manufacturing or connection scripts assigned to it. You may need to manually attach the relevant TSLs to the element.\n- **Q: What happens if I don't select an element?**\n  A: If no element is detected during the execution cycle, the script will erase itself without showing a dialog."
      },
      "tokens_used": 4015,
      "error": null
    }
  }
}