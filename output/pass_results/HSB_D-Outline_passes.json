{
  "filename": "HSB_D-Outline.mcr",
  "status": "completed",
  "total_tokens": 58765,
  "processing_time": 292.88328313827515,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9153,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": false,
          "detectionEvidence": "Viewport vp = getViewport(T(\"|Select a viewport|\")); _Viewport.append(vp); CoordSys ms2ps = vp.coordSys(); CoordSys ps2ms = ms2ps; ps2ms.invert(); dim.transformBy(ms2ps); dp.draw(dim);"
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Must be inserted in a Paper Space layout with an active Viewport connected to a Model Space Element.",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 5534,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialogOnce\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert\",\n        \"required\": false\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"|Select a viewport|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"|Select a position|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 15,\n      \"variable\": \"genBeamFilterDefinition\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter definition for GenBeams|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"Dynamic (from HSB_G-FilterGenBeams catalog)\",\n      \"category\": \"|Filter|\",\n      \"description\": \"|Filter definition for GenBeams.| (|Will be combined with custom filters|)|Use| HSB_G-FilterGenBeams |to define the filters|.\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"sFilterBC\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter beams with beamcode|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Filter|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sFilterLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter beams and sheets with label|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Filter|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sFilterMaterial\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter beams and sheets with material|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Filter|\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sFilterHsbID\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Filter beams and sheets with hsbID|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Filter|\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nZone\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Zone|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"1\",\n        \"2\",\n        \"3\",\n        \"4\",\n        \"5\",\n        \"6\",\n        \"7\",\n        \"8\",\n        \"9\",\n        \"10\"\n      ],\n      \"category\": \"|Dimension object|\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sDrawOutline\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Draw outline|\",\n      \"defaultValue\": \"|Yes|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Dimension object|\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sPosition\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Position|\",\n      \"defaultValue\": \"|Angled aligned|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Angled aligned|\",\n        \"|Angled Perpendicular|\",\n        \"|Straight|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sUsePSUnits\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Offset in paperspace units|\",\n      \"defaultValue\": \"|Yes|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dDimOff\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset dimension line|\",\n      \"defaultValue\": \"100.0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Positioning|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nColorDimension\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Color dimension|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Dimension style|\",\n      \"defaultValue\": \"System Default\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"System Dimension Styles\",\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"nColorOutline\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Color outline|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"sLineTypeOutline\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Linetype outline|\",\n      \"defaultValue\": \"System Default\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"System Line Types\",\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"sPrefix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Prefix|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"sSuffix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Suffix|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Style|\",\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"sReferenceSide\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Reference side frame|\",\n      \"defaultValue\": \"|Inside|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Inside|\",\n        \"|Outside|\"\n      ],\n      \"category\": \"|Reference|\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"nColorName\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Default name color|\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Name and description|\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"nColorActiveFilter\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Filter other element color|\",\n      \"defaultValue\": \"30\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Name and description|\",\n      \"description\": null"
      },
      "tokens_used": 9865,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically generates dimension lines and 2D outlines for timber frame walls or floors in Paper Space shop drawings, based on the 3D Model Space geometry.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"Used during production drawing creation to annotate outer dimensions, wall thickness, and plate positions of an element shown in a viewport, particularly for angled or complex walls.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"genBeamFilterDefinition\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Selects a predefined rule set to determine which specific beams (e.g., top plates, studs) are included or excluded from the outline and dimension calculation.\",\n      \"validRange\": \"Entries from HSB_G-FilterGenBeams catalog\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Changes which structural members contribute to the calculated outer boundary and dimensions.\"\n    },\n    {\n      \"name\": \"sFilterBC\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Filters beams based on their Beam Code (functional type), allowing users to include/exclude specific structural roles (e.g., exclude posts).\",\n      \"validRange\": \"String of beam codes separated by semicolons\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Alters the subset of beams used to generate the outline.\"\n    },\n    {\n      \"name\": \"sFilterLabel\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Filters elements based on their assigned label name.\",\n      \"validRange\": \"String of labels\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Restricts dimensioning to elements matching specific labels.\"\n    },\n    {\n      \"name\": \"sFilterMaterial\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Filters elements based on their material grade or type.\",\n      \"validRange\": \"String of material names\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Allows dimensioning only specific material groups within the element.\"\n    },\n    {\n      \"name\": \"sFilterHsbID\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Filters elements based on their unique hsbCAD entity ID.\",\n      \"validRange\": \"String of IDs\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Targets specific unique elements for dimensioning.\"\n    },\n    {\n      \"name\": \"nZone\",\n      \"technicalDefault\": \"0\",\n      \"businessMeaning\": \"Defines the specific layer or zone of the element to dimension. Used in multi-layer walls to target inner or outer leaves.\",\n      \"validRange\": \"0 to 10 (0 typically means all/overall)\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Determines the depth or height at which the outline is calculated relative to the element coordinate system.\"\n    },\n    {\n      \"name\": \"sDrawOutline\",\n      \"technicalDefault\": \"|Yes|\",\n      \"businessMeaning\": \"Toggles the visibility of the physical 2D polyline representing the element's boundary.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"If No, only dimensions are drawn; the guiding outline geometry is hidden.\"\n    },\n    {\n      \"name\": \"sPosition\",\n      \"technicalDefault\": \"|Angled aligned|\",\n      \"businessMeaning\": \"Controls the orientation strategy of the dimension lines relative to the wall geometry.\",\n      \"validRange\": \"Angled aligned, Angled Perpendicular, Straight\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Angled aligned: Dims follow the wall slope. Angled Perpendicular: Dims project perpendicularly from edges. Straight: Horizontal/Vertical dims only.\"\n    },\n    {\n      \"name\": \"sUsePSUnits\",\n      \"technicalDefault\": \"|Yes|\",\n      \"businessMeaning\": \"Determines if the offset distance is interpreted in Paper Space (print scale) units or Model Space (real world) units.\",\n      \"validRange\": \"Yes/No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Affects the visual gap between the element and the dimension line on the printed drawing.\"\n    },\n    {\n      \"name\": \"dDimOff\",\n      \"technicalDefault\": \"100.0\",\n      \"businessMeaning\": \"The distance between the element outline and the dimension line.\",\n      \"validRange\": \"10.0 to 200.0 mm (Model Space) or equivalent Paper Space\",\n      \"unit\": \"Length\",\n      \"affectsOutput\": \"Moves the dimension text and line closer to or further from the object.\"\n    },\n    {\n      \"name\": \"nColorDimension\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Sets the color of the generated dimension entities.\",\n      \"validRange\": \"0-255 (AutoCAD Index), -1 for ByBlock\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Visual appearance of dimensions on the drawing.\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"System Default\",\n      \"businessMeaning\": \"Selects the CAD dimension style (text size, arrow style, precision) to use for the generated dimensions.\",\n      \"validRange\": \"Available Dimension Styles in drawing\",\n      \"unit\": \"Style Name\",\n      \"affectsOutput\": \"Text height, arrowheads, and units of the dimensions.\"\n    },\n    {\n      \"name\": \"nColorOutline\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Sets the color of the generated outline polyline.\",\n      \"validRange\": \"0-255 (AutoCAD Index), -1 for ByBlock\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Visual appearance of the outline.\"\n    },\n    {\n      \"name\": \"sLineTypeOutline\",\n      \"technicalDefault\": \"System Default\",\n      \"businessMeaning\": \"Selects the line type (e.g., Continuous, Dashed, Hidden) for the outline.\",\n      \"validRange\": \"Available Line Types in drawing\",\n      \"unit\": \"Style Name\",\n      \"affectsOutput\": \"Visual pattern of the outline line.\"\n    },\n    {\n      \"name\": \"sPrefix\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Adds a custom text string immediately before the dimension value.\",\n      \"validRange\": \"Short text\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Modifies dimension text (e.g., changes '2000' to 'W: 2000').\"\n    },\n    {\n      \"name\": \"sSuffix\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"Adds a custom text string immediately after the dimension value.\",\n      \"validRange\": \"Short text\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Modifies dimension text (e.g., changes '2000' to '2000 mm').\"\n    },\n    {\n      \"name\": \"sReferenceSide\",\n      \"technicalDefault\": \"|Inside|\",\n      \"businessMeaning\": \"Defines whether the reference point for the outline calculation is on the interior or exterior face of the frame.\",\n      \"validRange\": \"Inside, Outside\",\n      \"unit\": \"Selection\",\n      \"affectsOutput\": \"Shifts the calculated outline to the inside or outside skin of the element.\"\n    },\n    {\n      \"name\": \"nColorName\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Color of the script name/instance label displayed next to the insertion point.\",\n      \"validRange\": \"0-255\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Visibility of the script identifier in the drawing.\"\n    },\n    {\n      \"name\": \"nColorActiveFilter\",\n      \"technicalDefault\": \"30\",\n      \"businessMeaning\": \"Color used to visually indicate that a filter is active on *other* elements, highlighting that this script instance might not be processing them.\",\n      \"validRange\": \"0-255\",\n      \"unit\": \"Color Index\",\n      \"affectsOutput\": \"Visual feedback for filter status.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sUsePSUnits is set to Yes\",\n      \"effect\": \"The dDimOff value is multiplied by the viewport scale factor to ensure the offset looks consistent on the printed page regardless of zoom level.\",\n      \"cascade\": [\n        \"dDimOff\"\n      ]\n    },\n    {\n      \"trigger\": \"sPosition is set to Angled Perpendicular or Straight\",\n      \"effect\": \"The dimension generation logic changes from following the wall geometry to aligning with the projection plane or coordinate axes, potentially skipping angled dimensions.\",\n      \"cascade\": [\n        \"dDimOff\"\n      ]\n    },\n    {\n      \"trigger\": \"Any Filter parameter (sFilterBC, genBeamFilterDefinition, etc.) is set\",\n      \"effect\": \"The script iterates through beams in the element and excludes those not matching the criteria, resulting in a smaller outline.\",\n      \"cascade\": [\n        \"sDrawOutline\",\n        \"nZone\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Dimension\",\n      \"description\": \"Linear dimension lines indicating the width/length/height of the wall element or specific members.\",\n"
      },
      "tokens_used": 11507,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Insertion Triggered (_bOnInsert = true)",
          "2. Show Property Dialog (showDialogOnce)",
          "3. User selects a Viewport (getViewport)",
          "4. User selects an insertion point for the script label (getPoint)",
          "5. Script exits insertion mode and waits for recalculation",
          "6. [Recalculation] Retrieve stored Viewport and associated Element",
          "7. Calculate Model Space to Paper Space transformation matrices",
          "8. Check 'Disable the tsl' property -> [Branch: Stop if Disabled]",
          "9. Check Global Map for Active Filters -> [Branch: Stop if this Element is filtered]",
          "10. Validate Element exists and is valid (el.bIsValid)",
          "11. Parse string filters (BeamCode, Label, Material, hsbID) into arrays",
          "12. Retrieve GenBeams from Element",
          "13. Filter GenBeams based on parsed properties and 'HSB_G-FilterGenBeams' catalog",
          "14. Project GenBeam geometry onto calculation plane based on 'Zone' setting",
          "15. Sort projected points to construct the outer boundary profile (ppFrame)",
          "16. Determine dimension logic based on 'Position' setting -> [Branch: Angled vs Perpendicular/Straight]",
          "17. Generate Dimensions and Outline Geometry",
          "18. Transform entities to Paper Space and Draw"
        ],
        "conditionalBranches": [
          {
            "condition": "Check 'Disable the tsl' (sDisableTsl == Yes)",
            "path1": {
              "name": "Disabled",
              "steps": [
                "Set script name color to 'Filter this element color'",
                "Draw 'Disabled' text next to name",
                "Exit script immediately"
              ]
            },
            "path2": {
              "name": "Enabled",
              "steps": [
                "Continue to execution flow"
              ]
            }
          },
          {
            "condition": "Context Menu Action / Global Map Check",
            "path1": {
              "name": "Element is Filtered (Map contains Element Handle)",
              "steps": [
                "Set script name color to 'Filter this element color'",
                "Draw 'Active filter' text",
                "Exit script immediately (No geometry generated)"
              ]
            },
            "path2": {
              "name": "Element is Not Filtered (Map empty or Handle not present)",
              "steps": [
                "If Map is not empty (filter exists for other elements): Change name color to 'Filter other element color'",
                "Draw 'Active filter' text (Visual warning only)",
                "Continue execution and generate dimensions"
              ]
            }
          },
          {
            "condition": "Dimension Position Property (sPosition)",
            "path1": {
              "name": "Angled aligned (0)",
              "steps": [
                "Clean up zone vertices (remove colinear/duplicate points)",
                "Iterate edges of the profile",
                "Calculate normal vector for offset",
                "Generate dimensions parallel to the wall edge/slope"
              ]
            },
            "path2": {
              "name": "Angled Perpendicular (1) or Straight (2)",
              "steps": [
                "Iterate rings of the frame outline",
                "Determine edge orientation (Angled vs Orthogonal)",
                "If Position is Straight (2): Skip Angled edges",
                "If Position is Perpendicular (1): Skip Orthogonal edges",
                "Project dimension points to the zone outline",
                "Generate dimensions perpendicular to the frame edge"
              ]
            }
          },
          {
            "condition": "Offset Unit Property (sUsePSUnits)",
            "path1": {
              "name": "Paper Space Units (Yes)",
              "steps": [
                "Multiply dDimOff by Viewport Scale Factor (dVpScale)"
              ]
            },
            "path2": {
              "name": "Model Space Units (No)",
              "steps": [
                "Use dDimOff as raw Model Space value"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport selection during insertion",
            "errorMessage": "Script requires a viewport selection.",
            "recovery": "User must select a valid viewport in Paper Space during the getViewport prompt."
          },
          {
            "check": "Element validity in Viewport",
            "errorMessage": "Element is invalid or missing.",
            "recovery": "Ensure the selected viewport is looking at a valid hsbCAD Element (Wall/Floor). If element is deleted, script erases instance."
          },
          {
            "check": "Zone calculation (nZone > 5)",
            "errorMessage": "None (Silent correction)",
            "recovery": "Script automatically adjusts Zone value using formula: nZn = 5 - nZone."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Properties",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Updating filters (sFilterBC, etc.), changing offsets (dDimOff), or toggling styles (sDimStyle) triggers an immediate recalc of the outline and dimensions."
          },
          {
            "action": "Move Script Label",
            "how": "Grip Edit (Drag the insertion point _Pt0)",
            "effect": "Relocates the Script Name and Description text; does not affect the dimension geometry location which is tied to the viewport/element."
          },
          {
            "action": "Filter Element Context Menu",
            "how": "Right-click Script Instance -> Select 'Filter this element'",
            "effect": "Adds the element handle to the global _Map. The script stops generating geometry for this specific element and displays 'Active filter'."
          },
          {
            "action": "Remove Filter Context Menu",
            "how": "Right-click Script Instance -> Select 'Remove filter for this element' or 'Remove filter for all elements'",
            "effect": "Updates the global _Map. If the current element is unblocked, the script resumes generating geometry."
          }
        ]
      },
      "tokens_used": 13333,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_D-Outline.mcr\n\n## Overview\nThis script automatically generates dimension lines and 2D outlines for timber frame walls or floors in Paper Space shop drawings. It calculates the dimensions based on the 3D geometry visible in a selected viewport.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script must be inserted in Paper Space. |\n| Paper Space | Yes | The script operates within the layout to dimension views of Model Space elements. |\n| Shop Drawing | Yes | This is specifically designed for creating production drawings. |\n\n## Prerequisites\n- **Required Entities**: A Viewport in Paper Space that is currently viewing a valid hsbCAD Element (Wall or Floor).\n- **Minimum Beam Count**: 0 (Dimensions are based on the Element's bounding box or specific filtered beams).\n- **Required Settings**: The catalog `HSB_G-FilterGenBeams` must be present in the project to use advanced filtering options.\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT`\n**Action:** Browse and select `HSB_D-Outline.mcr`.\n\n### Step 2: Select a Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the border or inside the viewport that displays the element you want to dimension.\n```\n\n### Step 3: Select Position\n```\nCommand Line: Select a position\nAction: Click in the Paper Space layout to place the script instance label (this marks where the script is located but does not determine the dimension location).\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Filter** | | | |\n| Filter definition for GenBeams | dropdown | | Select a predefined filter from the `HSB_G-FilterGenBeams` catalog to determine which beams are included. |\n| Filter beams with beamcode | text | | Enter beam codes (e.g., \"WAL;PLT\") to filter elements by their structural role. |\n| Filter beams and sheets with label | text | | Enter labels to include only elements matching specific label names. |\n| Filter beams and sheets with material | text | | Enter material names to filter elements by specific material grades. |\n| Filter beams and sheets with hsbID | text | | Enter specific hsbCAD IDs to target unique elements. |\n| **Dimension object** | | | |\n| Zone | dropdown | 0 | Sets the construction layer (0-10) to calculate dimensions from. Useful for multi-layer walls. |\n| Draw outline | dropdown | Yes | Toggles the visibility of the 2D outline polyline. Choose \"No\" to show dimensions only. |\n| **Positioning** | | | |\n| Position | dropdown | Angled aligned | Sets dimension orientation: \"Angled aligned\" follows wall slope, \"Angled Perpendicular\" projects perpendicularly, \"Straight\" creates horizontal/vertical dimensions. |\n| Offset in paperspace units | dropdown | Yes | If \"Yes\", the offset distance is scaled by the viewport zoom (consistent print size). If \"No\", it uses real-world Model Space units. |\n| Offset dimension line | number | 100.0 | The distance between the element outline and the dimension line. |\n| **Style** | | | |\n| Color dimension | number | -1 | Sets the color index for the dimension lines (-1 = ByBlock). |\n| Dimension style | dropdown | System Default | Selects the CAD dimension style (text size, arrows) to apply. |\n| Color outline | number | -1 | Sets the color index for the outline polyline (-1 = ByBlock). |\n| Linetype outline | dropdown | System Default | Selects the line type (e.g., Continuous, Hidden) for the outline. |\n| Prefix | text | | Text added before the dimension value (e.g., \"L: \"). |\n| Suffix | text | | Text added after the dimension value (e.g., \" mm\"). |\n| **Reference** | | | |\n| Reference side frame | dropdown | Inside | Determines if the outline reference is the Inside or Outside face of the element. |\n| **Name and description** | | | |\n| Default name color | number | -1 | Color of the script label text in the drawing. |\n| Filter other element color | number | 30 | Color used to indicate that a filter is active for other elements in the drawing. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Filter this element** | Adds the current element to a global exclusion list. The script will stop generating geometry for this specific element. |\n| **Remove filter for this element** | Removes the current element from the exclusion list, allowing the script to generate geometry again. |\n| **Remove filter for all elements** | Clears the entire exclusion list for this script type. |\n| **Disable the tsl** | Turns off the script instance entirely. It will remain in the drawing but will not calculate or draw anything until re-enabled. |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: Project Catalog or hsbCAD Company/Install path\n- **Purpose**: Defines the logic for the \"Filter definition for GenBeams\" dropdown, allowing complex pre-configured selection of beams (e.g., \"Only Top Plates\").\n\n## Tips\n- **Consistent Drawings**: Enable \"Offset in paperspace units\" to ensure dimension lines look the same distance away from the wall on all drawings, regardless of the viewport scale.\n- **Complex Walls**: If dimensioning a wall with different inner/outer layers, adjust the **Zone** parameter. For example, setting Zone to 1 might target the inner leaf, while 0 targets the overall bounding box.\n- **Clean Dimensions**: If you only want overall dimensions and not every stud, use the **Filter definition** or **Filter beams with beamcode** to exclude internal members.\n\n## FAQ\n- **Q: Why do my dimensions disappear when I zoom in/out?**\n  - **A:** Check the **Offset in paperspace units** property. If set to \"No\", the offset is in Model Space units and may appear to move drastically relative to the viewport frame. Usually, this should be \"Yes\" for shop drawings.\n- **Q: The outline is not where I expect it to be.**\n  - **A:** Check the **Reference side frame** property. It defaults to \"Inside\". If you are looking at the exterior of the building, switch this to \"Outside\".\n- **Q: Can I dimension only the longest walls?**\n  - **A:** Not directly by length in this script, but you can use the **Filter beams with label** property to only dimension elements tagged with a specific label (e.g., \"Ext-Wall\")."
      },
      "tokens_used": 9373,
      "error": null
    }
  }
}