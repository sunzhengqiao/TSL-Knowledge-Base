{
  "filename": "GE_WDET_LADDER_FLAT.mcr",
  "status": "completed",
  "total_tokens": 35570,
  "processing_time": 344.7814543247223,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v0.4",
            "date": "21.jul.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added - Thumbnail added - Copyright added"
          },
          {
            "version": "V0.3_RL",
            "date": "Jan 5 2011",
            "author": "",
            "changes": "Adjusted for materials coming from _MAP"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5159,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `getElement()`, `getPoint()`, and works directly with `ElementWallSF` and `Wall` objects. It creates physical construction entities using `dbCreate()` (Blocking beams) and performs geometric calculations (projection, filtering beams) in 3D space. No ShopDrawing API calls (sd_*) or viewport handling logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF",
            "Wall"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space with an existing Stud Frame Wall element containing vertical studs.",
          "requiredSettings": []
        }
      },
      "tokens_used": 4494,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select an element",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select an insertion point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "During script insertion",
            "title": "Properties",
            "dataSource": "Internal script properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strEmpty0",
            "type": "PropString",
            "displayName": "PLACEMENT PROPERTIES",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "readonly",
            "options": [],
            "category": null,
            "description": "Header"
          },
          {
            "index": 1,
            "variable": "dStartOffset",
            "type": "PropDouble",
            "displayName": "  Start Offset",
            "defaultValue": "600",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 2,
            "variable": "dEndOffset",
            "type": "PropDouble",
            "displayName": "  End Offset",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 3,
            "variable": "dSpacing",
            "type": "PropDouble",
            "displayName": "  Spacing",
            "defaultValue": "600",
            "inputType": "number",
            "options": [],
            "category": "PLACEMENT PROPERTIES",
            "description": null
          },
          {
            "index": 4,
            "variable": "strEmpty1",
            "type": "PropString",
            "displayName": "MATERIAL PROPERTIES",
            "defaultValue": "- - - - - - - - - - - - - - - -",
            "inputType": "readonly",
            "options": [],
            "category": null,
            "description": "Header"
          },
          {
            "index": 5,
            "variable": "strMat",
            "type": "PropString",
            "displayName": "  Material",
            "defaultValue": "SPF",
            "inputType": "text",
            "options": [],
            "category": "MATERIAL PROPERTIES",
            "description": null
          },
          {
            "index": 6,
            "variable": "strGrade",
            "type": "PropString",
            "displayName": "  Grade",
            "defaultValue": "#2",
            "inputType": "text",
            "options": [],
            "category": "MATERIAL PROPERTIES",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5040,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates 'ladder' framing (horizontal blocking) between two specific wall studs to replace existing blocking in a cavity with a new, evenly spaced pattern.",
          "category": "Framing / Detailing",
          "typicalUseCase": "Used when a specific bay in a stud wall requires fire blocking, mid-height bracing, or a nailing surface for finishes, and the user wants to define the start height, spacing, and end offset precisely."
        },
        "parameters": [
          {
            "name": "strEmpty0",
            "technicalDefault": "- - - - - - - - - - - - - - - -",
            "businessMeaning": "Visual separator (Group Header) for the Properties Palette.",
            "validRange": "N/A",
            "unit": "N/A",
            "affectsOutput": "None (UI organization only)."
          },
          {
            "name": "dStartOffset",
            "technicalDefault": "600 (24 inches)",
            "businessMeaning": "The vertical distance from the bottom of the wall cavity (bottom plate) to the center of the first horizontal blocking piece.",
            "validRange": "0 mm to Wall Height",
            "unit": "Length (mm/in)",
            "affectsOutput": "Determines the vertical position of the lowest blocking piece. If set to 0, the script automatically adjusts to place the block relative to the bottom plate thickness."
          },
          {
            "name": "dEndOffset",
            "technicalDefault": "0",
            "businessMeaning": "The distance from the top of the wall cavity (top plate) downwards. Controls the placement of the highest blocking piece.",
            "validRange": "0 mm to Wall Height",
            "unit": "Length (mm/in)",
            "affectsOutput": "Determines the vertical stop position for the blocking pattern. A value of 0 places blocking up to the top plate. Values greater than 0 push the top blocking down from the top by this amount."
          },
          {
            "name": "dSpacing",
            "technicalDefault": "600 (24 inches)",
            "businessMeaning": "The vertical distance between the centers of consecutive horizontal blocking pieces.",
            "validRange": "100 mm to 2000 mm (Typically 300mm-600mm)",
            "unit": "Length (mm/in)",
            "affectsOutput": "Controls the density/quantity of blocking generated. Smaller values result in more blocking pieces between the start and end offsets."
          },
          {
            "name": "strEmpty1",
            "technicalDefault": "- - - - - - - - - - - - - - - -",
            "businessMeaning": "Visual separator (Group Header) for the Properties Palette.",
            "validRange": "N/A",
            "unit": "N/A",
            "affectsOutput": "None (UI organization only)."
          },
          {
            "name": "strMat",
            "technicalDefault": "SPF",
            "businessMeaning": "The wood species code assigned to the generated blocking beams.",
            "validRange": "Standard lumber species codes (e.g., SPF, SYP, DF)",
            "unit": "String",
            "affectsOutput": "Updates the material property of the generated beams for costing and BOM reports."
          },
          {
            "name": "strGrade",
            "technicalDefault": "#2",
            "businessMeaning": "The structural grade of the lumber assigned to the generated blocking beams.",
            "validRange": "Standard lumber grades (e.g., #2, #1, Stud)",
            "unit": "String",
            "affectsOutput": "Updates the grade property of the generated beams for structural calculations and BOM reports."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing dStartOffset to 0",
            "effect": "The script overrides the literal 0 value to calculate a position based on the bottom plate thickness plus half the blocking height.",
            "cascade": []
          },
          {
            "trigger": "Increasing dSpacing",
            "effect": "Reduces the number of blocking pieces generated between the Start and End offsets.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Beam (Blocking)",
            "description": "Solid timber elements (blocking) created horizontally between the two studs closest to the insertion point. Existing blocking in this area is erased and replaced.",
            "appliedTo": "Between the specific left and right studs identified by the user's insertion point within the selected Wall Element."
          }
        ]
      },
      "tokens_used": 7347,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script executed via TSL command or Catalog.",
          "2. User prompted to 'Select an element' (Wall/ElementWallSF).",
          "3. User prompted to 'Select an insertion point' (Identifying the bay).",
          "4. 'Properties' dialog appears automatically (ShowDynamicDialog) for parameter adjustment.",
          "5. Script validates if selected element is a valid Wall.",
          "6. Script identifies the two vertical studs (Left and Right) nearest to the insertion point.",
          "7. Script creates a temporary collision volume around the insertion point.",
          "8. Script erases any existing blocking within that volume between the identified studs.",
          "9. Script calculates vertical positions for new blocking based on Start Offset, Spacing, and End Offset.",
          "10. Script generates new blocking beams, stretching them between the Left and Right studs.",
          "11. Script assigns Material, Grade, and Module name to new blocking.",
          "12. Script updates the color and Module name of the bounding studs.",
          "13. Script executes 'eraseInstance()', removing itself from the drawing and leaving only the physical beams."
        ],
        "conditionalBranches": [
          {
            "condition": "Check for valid Studs",
            "path1": {
              "name": "Studs Found",
              "steps": [
                "Identify bmLeft and bmRight based on insertion point.",
                "Proceed to cleanup and generation."
              ]
            },
            "path2": {
              "name": "Studs Not Found",
              "steps": [
                "Report message: 'cannot find a connecting stud'.",
                "Execute eraseInstance().",
                "Exit script."
              ]
            }
          },
          {
            "condition": "Start Offset (dStartOffset) Calculation",
            "path1": {
              "name": "Value is 0",
              "steps": [
                "Calculate position: (Half Blocking Size) + (Bottom Plate Thickness).",
                "Ensures block sits on top of bottom plate."
              ]
            },
            "path2": {
              "name": "Value is > 0",
              "steps": [
                "Use input value directly as vertical distance from origin."
              ]
            }
          },
          {
            "condition": "End Offset (dEndOffset) Calculation",
            "path1": {
              "name": "Value is 0",
              "steps": [
                "Reduce Max Height by Half Blocking Size.",
                "Blocking fills cavity up to top plate."
              ]
            },
            "path2": {
              "name": "Value <= (Half Block + 76mm)",
              "steps": [
                "Reduce Max Height by 1.5x Block Size.",
                "Force a specific downward offset (dOffsetDown)."
              ]
            },
            "path3": {
              "name": "Value > Threshold",
              "steps": [
                "Reduce Max Height by (User Offset + 1 Block Size).",
                "Force top blocking at calculated distance down."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "Implicit (Script Erases Self).",
            "recovery": "User must select a valid element and restart the script."
          },
          {
            "check": "Element Type (ElementWallSF/Wall)",
            "errorMessage": "None (Silent Erase).",
            "recovery": "Select a valid Stud Frame Wall element."
          },
          {
            "check": "Surrounding Studs",
            "errorMessage": "TSL[ScriptName] cannot find a connecting stud on element [ElementNumber].",
            "recovery": "Select insertion point inside a valid bay (between two studs) rather than outside the wall or at an opening."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Generated Blocking",
            "how": "Standard CAD Grips / Properties Palette (Beam properties)",
            "effect": "Since the script calls 'eraseInstance()' at completion, the TSL instance no longer exists. Users must manually edit the resulting beams (stretch, move, change material) or Delete/Undo and re-run the script to change the layout parameters (spacing/offsets)."
          }
        ]
      },
      "tokens_used": 7846,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WDET_LADDER_FLAT.mcr\n\n## Overview\nThis script generates horizontal \"ladder\" blocking (fire blocks or bracing) between two specific wall studs. It identifies the bay selected by the user, removes any existing blocking in that area, and inserts a new pattern of blocking based on defined spacing and offsets.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in Model Space on an existing 3D wall element. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not intended for generating 2D detail views directly. |\n\n## Prerequisites\n- **Required Entities**: An existing `ElementWallSF` or `Wall` (Stud Frame) with vertical studs.\n- **Minimum Beam Count**: The wall must contain at least two vertical studs to define the bay width.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WDET_LADDER_FLAT.mcr` from the catalog or file dialog.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Select an element\nAction: Click on the wall element (Wall or ElementWallSF) where you want to add the blocking.\n```\n\n### Step 3: Identify Bay Location\n```\nCommand Line: Select an insertion point\nAction: Click inside the specific \"bay\" (the space between two studs) where you want the ladder blocking to be generated.\n```\n*Note: The script uses this point to find the nearest left and right studs to act as boundaries.*\n\n### Step 4: Configure Parameters\nA \"Properties\" dialog will appear automatically.\n1. Adjust the **Start Offset**, **End Offset**, and **Spacing** as needed.\n2. Verify the **Material** and **Grade**.\n3. Click **OK** to generate the blocking.\n\n### Step 5: Generation\nThe script will erase existing blocking in that bay, create the new blocking beams, and then delete itself from the drawing (leaving only the physical beams).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **PLACEMENT PROPERTIES** | - | - | - |\n| Start Offset | Number | 600 | The vertical distance from the bottom of the cavity to the center of the first blocking piece. If set to 0, it automatically positions on top of the bottom plate. |\n| End Offset | Number | 0 | The distance from the top of the cavity downwards. A value of 0 fills the cavity up to the top plate. |\n| Spacing | Number | 600 | The vertical distance between the centers of consecutive blocking pieces. |\n| **MATERIAL PROPERTIES** | - | - | - |\n| Material | Text | SPF | The wood species code for the new blocking beams (e.g., SPF, SYP). |\n| Grade | Text | #2 | The structural grade of the lumber for the new blocking beams. |\n\n## Right-Click Menu Options\nThis script does not add persistent context menu options because it erases itself immediately after generating the geometry.\n\n## Settings Files\nNo external settings files (XML/INI) are required for this script. All configuration is handled via the Properties Palette during insertion.\n\n## Tips\n- **Script Self-Deletion**: This script runs once and then removes itself from the drawing (`eraseInstance`). You cannot double-click the result later to change settings. To modify the layout, use **Undo** (Ctrl+Z) and run the script again with new parameters.\n- **Start Offset 0**: If you set the Start Offset to 0, the script intelligently calculates the position to sit directly on top of the bottom plate, accounting for the plate thickness.\n- **Clean Up**: The script automatically detects and deletes any existing blocking within the selected bay before generating the new pattern. You do not need to manually delete old blocking first.\n- **Validation**: Ensure you click strictly between two studs. If you click too close to a plate or outside the wall bounds, the script may report \"cannot find a connecting stud\" and abort.\n\n## FAQ\n- **Q: I generated the blocking, but now I want to change the spacing. How do I do that?**\n  - A: Since the script instance is deleted after running, you cannot simply edit the properties. You must use the **Undo** command to remove the generated blocking and re-run the script with the correct spacing value.\n- **Q: What happens if there is already blocking in that wall bay?**\n  - A: The script creates a temporary volume around the insertion point and erases any existing blocking beams found within that volume between the two bounding studs before inserting the new ones.\n- **Q: The script gave an error \"cannot find a connecting stud\". What went wrong?**\n  - A: Your insertion point was likely not inside a valid bay defined by two vertical studs. Ensure you click clearly between two studs and not on an opening (door/window) trimmer or the wall plates."
      },
      "tokens_used": 5684,
      "error": null
    }
  }
}