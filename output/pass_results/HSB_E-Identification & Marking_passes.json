{
  "filename": "HSB_E-Identification & Marking.mcr",
  "status": "completed",
  "total_tokens": 50443,
  "processing_time": 538.3116805553436,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 8848,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses Element el = Element() and iterates el.genBeams(). It manipulates 3D entities via Beam.addTool() and Body operations. No usage of _Viewport, _kPaperSpace, sd_ prefixes, or Sheet entities. Visualisation uses Display objects in 3D context."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "HSB_G-FilterGenBeams (optional, referenced for filtering)"
          ]
        }
      },
      "tokens_used": 6257,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "tslIdentifier",
            "type": "PropString",
            "displayName": "Identifier",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Only one tsl instance, per identifier, can be attached to an element."
          },
          {
            "index": 1,
            "variable": "preferredFaceProp",
            "type": "PropString",
            "displayName": "Preferred beam face",
            "defaultValue": "|Outside|",
            "inputType": "dropdown",
            "options": [
              "|Outside|",
              "|Inside|"
            ],
            "category": null,
            "description": "Sets the prefered marking face.The face which is most aligned with the inside, or outside, of the element is used."
          },
          {
            "index": 11,
            "variable": "femaleFilterDefinition",
            "type": "PropString",
            "displayName": "Filter definition female beams",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "",
              "<list of catalog names from HSB_G-FilterGenBeams>"
            ],
            "category": "|Filters|",
            "description": "Filter definition for female beams.Use HSB_G-FilterGenBeams to define the filters."
          },
          {
            "index": 2,
            "variable": "femaleBeamCodesToFilter",
            "type": "PropString",
            "displayName": "Female beam codes to filter",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Filters|",
            "description": "Filter female beams with these beam codes.NOTE: These beam codes are only filtered if the filter definition for female beams is left blank!"
          },
          {
            "index": 12,
            "variable": "maleFilterDefinition",
            "type": "PropString",
            "displayName": "Filter definition male beams",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [
              "",
              "<list of catalog names from HSB_G-FilterGenBeams>"
            ],
            "category": "|Filters|",
            "description": "Filter definition for male beams.Use HSB_G-FilterGenBeams to define the filters."
          },
          {
            "index": 3,
            "variable": "maleBeamCodesToFilter",
            "type": "PropString",
            "displayName": "Male beam codes to filter",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Filters|",
            "description": "Filter male beams with these beam codes.NOTE: These beam codes are only filtered if the filter definition for male beams is left blank!"
          },
          {
            "index": 4,
            "variable": "addBeamIdentificationProp",
            "type": "PropString",
            "displayName": "Add beam identification",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|Yes|",
              "|No|"
            ],
            "category": "|Identification|",
            "description": "Specifies whether beam identification should be added."
          },
          {
            "index": 0,
            "variable": "dMinLengthBeamId",
            "type": "PropDouble",
            "displayName": "Add beam ID for beams longer than",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Identification|",
            "description": "Sets the required beam length for the ID to be printed on the beam."
          },
          {
            "index": 1,
            "variable": "dMinLengthElNumber",
            "type": "PropDouble",
            "displayName": "Add element number for beams longer than",
            "defaultValue": "250",
            "inputType": "number",
            "options": [],
            "category": "|Identification|",
            "description": "Sets the required beam length for the element number to be printed on the beam."
          },
          {
            "index": 2,
            "variable": "dMinLengthProjectNumber",
            "type": "PropDouble",
            "displayName": "Add project number for beams longer than",
            "defaultValue": "500",
            "inputType": "number",
            "options": [],
            "category": "|Identification|",
            "description": "Sets the required beam length for the project number to be printed on the beam."
          },
          {
            "index": 5,
            "variable": "overrideBeamIdentification",
            "type": "PropString",
            "displayName": "Override beam identification",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Identification|",
            "description": "Sets the override for the identification."
          },
          {
            "index": 14,
            "variable": "positionIdentification",
            "type": "PropString",
            "displayName": "Position Text",
            "defaultValue": "|Center|",
            "inputType": "dropdown",
            "options": [
              "|Center|",
              "|Start|",
              "|End|"
            ],
            "category": "|Identification|",
            "description": "Specify the position for the text."
          },
          {
            "index": 4,
            "variable": "dOffset",
            "type": "PropDouble",
            "displayName": "Offset Text",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Identification|",
            "description": "Specify the offset for the text."
          },
          {
            "index": 15,
            "variable": "sUcs",
            "type": "PropString",
            "displayName": "UCS used for position",
            "defaultValue": "|Use beam ucs|",
            "inputType": "dropdown",
            "options": [
              "|Use beam ucs|",
              "|Use element ucs|"
            ],
            "category": "|Identification|",
            "description": "Specify which ucs is used for positioning the text."
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "HSB_G-FilterGenBeams",
            "searchPaths": [
              "_kPathHsbCompany",
              "_kPathHsbInstall"
            ],
            "purpose": "Provides list of filter definitions available for male and female beam filtering.",
            "required": false
          }
        ]
      },
      "tokens_used": 8332,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automatically labels timber beams within an element with production marks (Position, Element, Project numbers) and sets machining reference faces for assembly and manufacturing.\",\n    \"category\": \"Identification & Marking\",\n    \"typicalUseCase\": \"Applying layout and assembly labels to wall panels or roof segments during the design-to-production phase to ensure correct component placement on site.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"tslIdentifier\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A unique tag for this specific script instance. Allows multiple versions of the script (e.g., for different marking phases) to exist on the same element without conflict.\",\n      \"validRange\": \"Any alphanumeric string\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Script instance uniqueness and management.\"\n    },\n    {\n      \"name\": \"preferredFaceProp\",\n      \"technicalDefault\": \"|Outside|\",\n      \"businessMeaning\": \"Determines the side of the construction (weather-side vs interior-side) where the marking text should be applied.\",\n      \"validRange\": \"|Outside|, |Inside|\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"The physical location (face) of the mark on the beam.\"\n    },\n    {\n      \"name\": \"femaleFilterDefinition\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning \"Selects a predefined"
      },
      "tokens_used": 10567,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 10892,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-Identification & Marking\n\n## Overview\nAutomatically labels timber beams within an element with production marks (Position, Element, and Project numbers) and sets machining reference faces for assembly and manufacturing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D Elements and GenBeams. |\n| Paper Space | No | Not designed for 2D drawings or layouts. |\n| Shop Drawing | No | Does not generate shop drawing views directly. |\n\n## Prerequisites\n- **Required Entities**: An existing Element (e.g., Wall, Roof, Floor) containing GenBeams.\n- **Minimum Beam Count**: 1.\n- **Required Settings Files**: `HSB_G-FilterGenBeams` (Optional, used for advanced beam filtering).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Select `HSB_E-Identification & Marking.mcr` from the file dialog.\n\n### Step 2: Select Element\n```\nCommand Line: Select Element:\nAction: Click on the desired Element (Wall/Panel) in the Model Space.\n```\nNote: Once selected, the script attaches to the element. No further command line input is required; all configuration is done via the Properties Palette.\n\n### Step 3: Configure Properties\nAction: Select the newly attached script instance in the model (or select the Element and find the script in the Properties Palette under \"Data\") to adjust marking settings.\n\n## Properties Panel Parameters\n\n### General Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Identifier | Text | \"\" | Unique tag for this script instance. Only one instance per identifier can be attached to an element. Use this to run multiple marking configurations on the same element. |\n| Preferred beam face | Dropdown | |Outside| | Sets the preferred marking face (Outside or Inside) based on the element orientation. |\n\n### Filters\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Filter definition female beams | Dropdown | \"\" | Select a predefined filter for female beams (referencing HSB_G-FilterGenBeams). |\n| Female beam codes to filter | Text | \"\" | Filter female beams by specific beam codes. **Note:** Only applies if the Filter Definition above is blank. |\n| Filter definition male beams | Dropdown | \"\" | Select a predefined filter for male beams. |\n| Male beam codes to filter | Text | \"\" | Filter male beams by specific beam codes. **Note:** Only applies if the Filter Definition above is blank. |\n\n### Identification\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Add beam identification | Dropdown | |Yes| | Enable or disable beam identification marking. |\n| Add beam ID for beams longer than | Number | 0 | Minimum beam length required to print the Beam ID. |\n| Add element number for beams longer than | Number | 250 | Minimum beam length required to print the Element Number. |\n| Add project number for beams longer than | Number | 500 | Minimum beam length required to print the Project Number. |\n| Override beam identification | Text | \"\" | Custom text to override the standard identification. |\n| Position Text | Dropdown | |Center| | Sets the text position along the beam (Start, Center, or End). |\n| Offset Text | Number | 0 | Specifies the offset distance for the text. |\n| UCS used for position | Dropdown | |Use beam ucs| | Coordinate system used for positioning the text (Beam UCS or Element UCS). |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu items are defined for this script. |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: Company or Install path (`_kPathHsbCompany` or `_kPathHsbInstall`)\n- **Purpose**: Provides a list of named filter definitions to be used in the \"Filter definition\" properties.\n\n## Tips\n- **Multiple Instances**: You can attach this script multiple times to the same element (e.g., one for the top plate, one for the bottom plate) by using different **Identifier** values.\n- **Face Selection**: Ensure your elements have correct inside/outside orientation defined, as the script relies on this to place the marks.\n- **Length Control**: Use the length minimum parameters to prevent cluttering small offcuts or blocking hardware with text.\n- **Filtering Hierarchy**: The script checks the \"Filter definition\" first. If that is empty, it falls back to the \"Beam codes to filter\" field.\n\n## FAQ\n- **Q: Why are some beams not getting marked even though \"Add beam identification\" is Yes?**\n  - A: Check the **Minimum length** settings; if a beam is shorter than the defined value, the mark will be skipped. Also, verify that your **Filters** are not excluding the specific beam codes.\n- **Q: Can I mark both the Inside and Outside faces of the element?**\n  - A: Yes. Insert the script twice. Set one instance **Identifier** to \"MarkOut\" (Preferred face: Outside) and the second to \"MarkIn\" (Preferred face: Inside).\n- **Q: What is the difference between Beam UCS and Element UCS for positioning?**\n  - A: **Beam UCS** positions text relative to the individual beam's length and orientation. **Element UCS** positions text relative to the entire wall/panel's coordinate system."
      },
      "tokens_used": 5547,
      "error": null
    }
  }
}