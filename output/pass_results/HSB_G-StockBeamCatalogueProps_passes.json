{
  "filename": "HSB_G-StockBeamCatalogueProps.mcr",
  "status": "completed",
  "total_tokens": 23636,
  "processing_time": 695.5236406326294,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.00",
            "date": "01.12.2015",
            "author": "AS",
            "changes": "Pilot version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3115,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_* prefix, no #Type E, no _Viewport usage. Script focuses on data management (Map/Properties) rather than graphical entities in a specific space. The 'insert' block suggests a standard insertion workflow."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "N/A (Non-graphical properties tool)",
          "requiredSettings": [
            "Company directory structure: 'Abbund'",
            "Data file: 'HSB-StockBeamCatalogue.dxx' in the Company directory"
          ]
        }
      },
      "tokens_used": 1336,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "eraseInstance",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "width",
            "type": "PropDouble",
            "displayName": "Width",
            "defaultValue": "U(38)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "height",
            "type": "PropDouble",
            "displayName": "Height",
            "defaultValue": "U(89)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "lengths",
            "type": "PropString",
            "displayName": "Lengths",
            "defaultValue": "5380; 8380",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sEntryName",
            "type": "PropString",
            "displayName": "Section",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "Dynamic (from HSB-StockBeamCatalogue.dxx)"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sEntryName",
            "type": "PropString",
            "displayName": "Section",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Read-Only"
          },
          {
            "index": 1,
            "variable": "lengths",
            "type": "PropString",
            "displayName": "Lengths",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "HSB-StockBeamCatalogue.dxx",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Stores catalogue entries for stock beam sections",
            "required": true
          }
        ]
      },
      "tokens_used": 5415,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A management tool for creating, selecting, and editing stock beam entries in a shared company catalog, ensuring standardized material dimensions and available lengths are recorded.",
          "category": "DataManagement",
          "typicalUseCase": "Used by a BIM manager or estimator to define available timber stock sizes (e.g., 38x89) and their specific cut lengths in the 'Abbund' catalog for use in other scripts or optimization tools."
        },
        "parameters": [
          {
            "name": "width",
            "technicalDefault": "U(38)",
            "businessMeaning": "The thickness or smaller cross-sectional dimension of the timber beam.",
            "validRange": "36 - 225",
            "unit": "mm",
            "affectsOutput": "Sets the Width property for a new catalog entry, defining the physical size of the stock material."
          },
          {
            "name": "height",
            "technicalDefault": "U(89)",
            "businessMeaning": "The depth or larger cross-sectional dimension of the timber beam.",
            "validRange": "45 - 600",
            "unit": "mm",
            "affectsOutput": "Sets the Height property for a new catalog entry, defining the physical size of the stock material."
          },
          {
            "name": "lengths",
            "technicalDefault": "\"5380; 8380\"",
            "businessMeaning": "A delimited list of standard lengths available for this specific section profile (e.g., raw lengths kept in inventory).",
            "validRange": "Any list of positive real numbers",
            "unit": "mm",
            "affectsOutput": "Defines the valid stock lengths associated with the profile in the catalog."
          },
          {
            "name": "sEntryName",
            "technicalDefault": "Dynamic (from DXX)",
            "businessMeaning": "The unique name or code of the beam section profile selected from the catalog.",
            "validRange": "Strings contained in 'HSB-StockBeamCatalogue.dxx'",
            "unit": "Text",
            "affectsOutput": "Serves as the key to identify the profile; in 'Edit' mode, it locks the profile identity to allow modification of associated lengths only."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Mode == 1 (Add)",
            "effect": "Enables manual entry of Width, Height, and Lengths to create a new catalog record.",
            "cascade": [
              "width",
              "height",
              "lengths"
            ]
          },
          {
            "trigger": "Mode == 2 (Select)",
            "effect": "Populates sEntryName with options from the DXX file for selection.",
            "cascade": [
              "sEntryName"
            ]
          },
          {
            "trigger": "Mode == 3 (Edit)",
            "effect": "Locks sEntryName (Read-Only) and exposes Lengths for modification of the existing record.",
            "cascade": [
              "sEntryName",
              "lengths"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MapData (Catalog)",
            "description": "Reads from or writes to the 'HSB-StockBeamCatalogue.dxx' file to maintain the inventory database.",
            "appliedTo": "Company Directory (Abbund)"
          }
        ]
      },
      "tokens_used": 3157,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launch or instance edit trigger.",
          "Check insertion flag: If _bOnInsert is true, eraseInstance() is called and the script terminates immediately.",
          "Construct file path for 'HSB-StockBeamCatalogue.dxx' located in the 'Abbund' subfolder of the Company directory.",
          "Retrieve 'Mode' integer from the instance Map (defaults to 0 if not found).",
          "[Conditional Branch] Evaluate 'Mode' variable to determine the property set to display.",
          "If Mode 1 (Add): Expose Width, Height, and Lengths properties.",
          "If Mode 2 (Select): Read DXX file, parse keys, expose Section dropdown.",
          "If Mode 3 (Edit): Expose read-only Section and editable Lengths.",
          "User modifies properties via the Object Properties Palette (OPM).",
          "Script execution completes (implied write-back to DXX via event handling not shown in snippet)."
        ],
        "conditionalBranches": [
          {
            "condition": "Mode variable value",
            "path1": {
              "name": "Add Mode (1)",
              "steps": [
                "Initialize PropDouble width (Default: 38mm).",
                "Initialize PropDouble height (Default: 89mm).",
                "Initialize PropString lengths (Default: '5380; 8380')."
              ]
            },
            "path2": {
              "name": "Select Mode (2)",
              "steps": [
                "Execute _Map.readFromDxxFile(sFullPath).",
                "Iterate through Map to collect all keys (Section names).",
                "Initialize PropString sEntryName with the collected array.",
                "Display as Dropdown in OPM."
              ]
            },
            "path3": {
              "name": "Edit Mode (3)",
              "steps": [
                "Initialize PropString sEntryName (Default: empty).",
                "Set sEntryName.setReadOnly(true).",
                "Initialize PropString lengths (Default: empty)."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "DXX File Availability",
            "errorMessage": "File not found (Implicit failure in Mode 2).",
            "recovery": "Ensure 'HSB-StockBeamCatalogue.dxx' exists in _kPathHsbCompany\\Abbund."
          },
          {
            "check": "Map Mode Integrity",
            "errorMessage": "Mode property missing or unexpected.",
            "recovery": "Mode defaults to 0; user or calling script must ensure Mode is set to 1, 2, or 3 for functionality."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Dimensions (Add Mode)",
            "how": "OPM",
            "effect": "Allows changing the Width and Height for the catalog entry."
          },
          {
            "action": "Edit Lengths (Add/Edit Mode)",
            "how": "OPM",
            "effect": "Modifies the semicolon-separated list of stock lengths."
          },
          {
            "action": "Select Profile (Select Mode)",
            "how": "OPM Dropdown",
            "effect": "Chooses a specific existing profile from the catalog."
          }
        ]
      },
      "tokens_used": 3958,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-StockBeamCatalogueProps.mcr\n\n## Overview\nThis script serves as a management tool for the timber stock beam catalog. It allows users to create, select, and edit standard beam profiles and their available stock lengths, which are stored in a central company data file.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script operates as a properties-based tool in the model environment. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: None.\n- **Minimum Beam Count**: 0.\n- **Required Settings Files**: \n  - The data file `HSB-StockBeamCatalogue.dxx` must exist in the `Abbund` subfolder of your hsbCAD Company directory (e.g., `...\\hsbCompany\\Abbund\\`).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-StockBeamCatalogueProps.mcr` from the list.\n\n### Step 2: Configure Properties\n```\nAction: Immediately after insertion, open the Properties Palette (Ctrl+1).\nNote: The script behaves differently based on its internal \"Mode\" (Add, Select, or Edit), which determines which fields are visible or editable.\n```\n\n### Step 3: Update Catalog\n```\nAction: Modify the visible parameters (Width, Height, Lengths, or Section) as required.\nEffect: The script reads from or writes to the 'HSB-StockBeamCatalogue.dxx' file to update the inventory database.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | Number | 38 | The thickness of the timber section (mm). Used when adding a new entry. |\n| Height | Number | 89 | The depth of the timber section (mm). Used when adding a new entry. |\n| Lengths | Text | 5380; 8380 | A list of standard stock lengths available for this section. Separate multiple lengths with a semicolon (`;`). |\n| Section | Text/Dropdown | Dynamic | The name identifier for the beam profile. \n- **Dropdown**: In Select mode, choose an existing profile from the catalog.\n- **Text**: In Add/Edit mode, view or lock the profile name. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | No custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: `HSB-StockBeamCatalogue.dxx`\n- **Location**: `<hsbCompanyPath>\\Abbund\\`\n- **Purpose**: Stores the dictionary of stock beam sections and their associated valid lengths.\n\n## Tips\n- **Data Persistence**: Ensure the `Abbund` folder path is correctly mapped in your hsbCAD configuration; otherwise, the script cannot find the catalog file.\n- **Formatting**: When entering lengths, always use a semicolon with a space to separate values (e.g., `2400; 3000; 4500`) to ensure they are parsed correctly.\n- **Editing**: If the Section name is read-only, the script is likely in \"Edit\" mode, allowing you to update lengths without changing the profile dimensions.\n\n## FAQ\n- Q: Why can't I change the Width or Height?\n- A: The script may be in \"Select\" or \"Edit\" mode. These modes lock the cross-sectional dimensions to ensure existing catalog data integrity. Use \"Add\" mode (if available via instance configuration) to create new sizes.\n\n- Q: Where is my stock data saved?\n- A: Data is saved in the `HSB-StockBeamCatalogue.dxx` file located in your Company directory's `Abbund` folder, not in the drawing file itself."
      },
      "tokens_used": 6655,
      "error": null
    }
  }
}