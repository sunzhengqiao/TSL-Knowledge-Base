{
  "filename": "hsb_ColumnBaseWithGluedRods.mcr",
  "status": "completed",
  "total_tokens": 44201,
  "processing_time": 226.61622977256775,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3787,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script generates 3D geometry using Body and Beam classes (e.g., bTopPlate.dbCreate, bStub.dbCreate). Modifies the host beam (_Beam0) using addTool() and stretchDynamicTo(). No 'sd_' functions or Viewport handling found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space context required to insert 3D steel plates and stub elements onto a structural beam.",
          "requiredSettings": []
        }
      },
      "tokens_used": 4166,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getBeam\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"On Insert (after catalog load)\",\n      \"title\": \"Properties\",\n      \"dataSource\": \"Script Internal Properties\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sGrade\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Steel Grade\",\n      \"defaultValue\": \"S275\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sColor1\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Color\",\n      \"defaultValue\": \"-1\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"General\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dFootH\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Overall Foot Height\",\n      \"defaultValue\": \"300\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sProfile\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Extrusion profile name\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sFlipStub\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Flip Direction\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Stub\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sBaseName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Name\",\n      \"defaultValue\": \"Base Plate\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dBasePlateT\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Thickness\",\n      \"defaultValue\": \"20\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dBasePlateL\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Length\",\n      \"defaultValue\": \"400\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dBasePlateW\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Base Plate Width\",\n      \"defaultValue\": \"300\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"nBaseRows\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Rows\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"nBaseCols\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Columns\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"dRowDistBase\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Row Centers\",\n      \"defaultValue\": \"100\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"dColDistBase\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Col Centers\",\n      \"defaultValue\": \"100\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"dBasePlateDrill\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Diametre\",\n      \"defaultValue\": \"20\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"dBasePlateDrillTol\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Drill Tolerance\",\n      \"defaultValue\": \"2\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"dBasePlateOffset1\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Offset Side 1\",\n      \"defaultValue\": \"50\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"dBasePlateOffset2\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Offset Side 2\",\n      \"defaultValue\": \"60\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Base Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"sTopName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Name\",\n      \"defaultValue\": \"Top Plate\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 18,\n      \"variable\": \"dTopPlateT\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Top Plate Thickness\",\n      \"defaultValue\": \"20\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 19,\n      \"variable\": \"dTopPlateL\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Top Plate Length\",\n      \"defaultValue\": \"200\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 20,\n      \"variable\": \"dTopPlateW\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Top Plate Width\",\n      \"defaultValue\": \"300\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 21,\n      \"variable\": \"nTopRows\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Rows\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 22,\n      \"variable\": \"nTopCols\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Quantity of Drill Columns\",\n      \"defaultValue\": \"3\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Top Plate\",\n      \"description\": null\n    },\n    {\n      \"index\": 23,\n      \"variable"
      },
      "tokens_used": 7303,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates a steel-to-timber column base connection featuring a top plate (bearing plate), a bottom plate (anchor plate), and an intermediate timber stub. It creates machining for glued-in rods or bolts in both the timber beam and the steel plates.\",\n    \"category\": \"Connection / Hardware\",\n    \"typicalUseCase\": \"Used when anchoring a timber column to a concrete foundation or connecting two timber sections with a specific gap, using a stub section and glued rods for reinforcement.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sGrade\",\n      \"technicalDefault\": \"S275\",\n      \"businessMeaning\": \"Specifies the material grade of the steel plates and stub (e.g., S275, S355).\",\n      \"validRange\": \"Standard Steel Grades (S235, S275, S355)\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Material property assignment in BOM and drawings.\"\n    },\n    {\n      \"name\": \"sColor1\",\n      \"technicalDefault\": \"-1\",\n      \"businessMeaning\": \"Sets the display color of the generated steel plates and stub in the CAD model.\",\n      \"validRange\": \"AutoCAD Color Index (0-255) or ByLayer\",\n      \"unit\": \"Index\",\n      \"affectsOutput\": \"Visual representation of the elements.\"\n    },\n    {\n      \"name\": \"dFootH\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"The vertical distance (height) between the Top Plate and the Bottom Plate. Defines the length of the intermediate stub beam.\",\n      \"validRange\": \"50 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the Base Plate vertically; scales the Stub beam length.\"\n    },\n    {\n      \"name\": \"sProfile\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Defines the cross-sectional profile of the intermediate timber stub beam.\",\n      \"validRange\": \"Available hsbCAD Extrusion Profiles\",\n      \"unit\": \"Profile Name\",\n      \"affectsOutput\": \"Geometry and dimensions of the Stub beam.\"\n    },\n    {\n      \"name\": \"sFlipStub\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Rotates the stub beam cross-section by 90 degrees (swapping Width and Depth orientation).\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Orientation of the stub beam profile relative to the plates.\"\n    },\n    {\n      \"name\": \"sBaseName\",\n      \"technicalDefault\": \"Base Plate\",\n      \"businessMeaning\": \"The naming identifier for the bottom steel plate.\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Entity name in lists and BOM.\"\n    },\n    {\n      \"name\": \"dBasePlateT\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Thickness of the bottom steel anchor plate.\",\n      \"validRange\": \"10 - 50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Thickness of the bottom plate geometry.\"\n    },\n    {\n      \"name\": \"dBasePlateL\",\n      \"technicalDefault\": \"400\",\n      \"businessMeaning\": \"Length of the bottom plate (along the beam axis Y).\",\n      \"validRange\": \"150 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Geometry of the bottom plate.\"\n    },\n    {\n      \"name\": \"dBasePlateW\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"Width of the bottom plate (perpendicular to beam axis Z).\",\n      \"validRange\": \"150 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Geometry of the bottom plate.\"\n    },\n    {\n      \"name\": \"nBaseRows\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Number of drill holes in a row along the width of the base plate.\",\n      \"validRange\": \"1 - 10\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Quantity of drill holes in the base plate.\"\n    },\n    {\n      \"name\": \"nBaseCols\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Number of drill holes in a column along the length of the base plate.\",\n      \"validRange\": \"1 - 10\",\n      \"unit\": \"Count\",\n      \"affectsOutput\": \"Quantity of drill holes in the base plate.\"\n    },\n    {\n      \"name\": \"dRowDistBase\",\n      \"technicalDefault\": \"100\",\n      \"businessMeaning\": \"Spacing (center-to-center) between drill hole rows on the base plate.\",\n      \"validRange\": \"50 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positioning of drill holes on the base plate.\"\n    },\n    {\n      \"name\": \"dColDistBase\",\n      \"technicalDefault\": \"100\",\n      \"businessMeaning\": \"Spacing (center-to-center) between drill hole columns on the base plate.\",\n      \"validRange\": \"50 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Positioning of drill holes on the base plate.\"\n    },\n    {\n      \"name\": \"dBasePlateDrill\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Nominal diameter of the drill holes in the base plate.\",\n      \"validRange\": \"12 - 50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Size of the holes in the base plate.\"\n    },\n    {\n      \"name\": \"dBasePlateDrillTol\",\n      \"technicalDefault\": \"2\",\n      \"businessMeaning\": \"Additional tolerance added to the drill diameter (creates oversized holes for alignment).\",\n      \"validRange\": \"0 - 5\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Final diameter of holes in the base plate (Drill + Tolerance).\"\n    },\n    {\n      \"name\": \"dBasePlateOffset1\",\n      \"technicalDefault\": \"50\",\n      \"businessMeaning\": \"Lateral offset of the base plate center relative to the beam axis (Y direction).\",\n      \"validRange\": \"-500 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Position of the base plate perpendicular to beam width.\"\n    },\n    {\n      \"name\": \"dBasePlateOffset2\",\n      \"technicalDefault\": \"60\",\n      \"businessMeaning\": \"Lateral offset of the base plate center relative to the beam axis (Z direction).\",\n      \"validRange\": \"-500 - 500\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Position of the base plate perpendicular to beam height.\"\n    },\n    {\n      \"name\": \"sTopName\",\n      \"technicalDefault\": \"Top Plate\",\n      \"businessMeaning\": \"The naming identifier for the top steel plate.\",\n      \"validRange\": \"Text String\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Entity name in lists and BOM.\"\n    },\n    {\n      \"name\": \"dTopPlateT\",\n      \"technicalDefault\": \"20\",\n      \"businessMeaning\": \"Thickness of the top steel bearing plate.\",\n      \"validRange\": \"10 - 50\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Thickness of the top plate geometry.\"\n    },\n    {\n      \"name\": \"dTopPlateL\",\n      \"technicalDefault\": \"200\",\n      \"businessMeaning\": \"Length of the top plate (along the beam axis Y).\",\n      \"validRange\": \"100 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Geometry of the top plate.\"\n    },\n    {\n      \"name\": \"dTopPlateW\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"Width of the top plate (perpendicular to beam axis Z).\",\n      \"validRange\": \"100 - 1000\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Geometry of the top plate.\"\n    },\n    {\n      \"name\": \"nTopRows\",\n      \"technicalDefault\": \"3\",\n      \"businessMeaning\": \"Number of drill holes in a"
      },
      "tokens_used": 9071,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11100,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ColumnBaseWithGluedRods.mcr\n\n## Overview\nThis script generates a steel-to-timber column base connection consisting of a top steel plate, a bottom steel plate (base plate), and an intermediate timber stub. It creates the necessary 3D geometry and machining for glued-in rods or bolts in both the timber elements and the steel plates.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script generates 3D geometry (Bodies and Beams) and modifies the host beam. |\n| Paper Space | No | Not intended for 2D drawing generation. |\n| Shop Drawing | No | This is a model generation script. |\n\n## Prerequisites\n- **Required Entities**: 1 Structural Beam (GenBeam).\n- **Minimum Beam Count**: 1.\n- **Required Settings**: None (uses internal script properties).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_ColumnBaseWithGluedRods.mcr`\n\n### Step 2: Select Host Beam\n```\nCommand Line: Select beam\nAction: Click on the structural timber beam where the column base should be applied.\n```\n\n### Step 3: Define Insertion Point\n```\nCommand Line: Specify insertion point\nAction: Click in the model space to define the location of the base connection (typically the bottom or end of the column).\n```\n\n### Step 4: Configure Properties\n```\nAction: The \"Properties\" dialog appears automatically. Adjust dimensions, plate sizes, and drill patterns as needed. Click OK to generate the elements.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **General** | | | |\n| Steel Grade (sGrade) | text | S275 | Material grade for steel plates (e.g., S275, S355). |\n| Color (sColor1) | number | -1 | Color index for the steel elements (-1 for ByLayer). |\n| **Stub** | | | |\n| Overall Foot Height (dFootH) | number | 300 | Vertical distance between Top Plate and Bottom Plate (stub length). |\n| Extrusion profile name (sProfile) | dropdown | *From Catalog* | Cross-sectional profile name for the timber stub. |\n| Flip Direction (sFlipStub) | dropdown | Yes | Rotates the stub profile by 90 degrees. |\n| **Base Plate** | | | |\n| Name (sBaseName) | text | Base Plate | Identifier for the bottom plate entity. |\n| Base Plate Thickness (dBasePlateT) | number | 20 | Thickness of the bottom steel plate. |\n| Base Plate Length (dBasePlateL) | number | 400 | Length of the bottom plate (along beam Y-axis). |\n| Base Plate Width (dBasePlateW) | number | 300 | Width of the bottom plate (along beam Z-axis). |\n| Quantity of Drill Rows (nBaseRows) | number | 3 | Number of drill holes rows along the width. |\n| Quantity of Drill Columns (nBaseCols) | number | 3 | Number of drill holes columns along the length. |\n| Drill Row Centers (dRowDistBase) | number | 100 | Spacing between drill hole rows. |\n| Drill Col Centers (dColDistBase) | number | 100 | Spacing between drill hole columns. |\n| Drill Diametre (dBasePlateDrill) | number | 20 | Diameter of drill holes. |\n| Drill Tolerance (dBasePlateDrillTol) | number | 2 | Additional tolerance added to drill diameter. |\n| Offset Side 1 (dBasePlateOffset1) | number | 50 | Lateral offset of plate center relative to beam axis (Y). |\n| Offset Side 2 (dBasePlateOffset2) | number | 60 | Lateral offset of plate center relative to beam axis (Z). |\n| **Top Plate** | | | |\n| Name (sTopName) | text | Top Plate | Identifier for the top plate entity. |\n| Top Plate Thickness (dTopPlateT) | number | 20 | Thickness of the top steel plate. |\n| Top Plate Length (dTopPlateL) | number | 200 | Length of the top plate (along beam Y-axis). |\n| Top Plate Width (dTopPlateW) | number | 300 | Width of the top plate (along beam Z-axis). |\n| Quantity of Drill Rows (nTopRows) | number | 3 | Number of drill holes rows along the width. |\n| Quantity of Drill Columns (nTopCols) | number | 3 | Number of drill holes columns along the length. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *Standard Script Options* | Use the Properties Palette (Ctrl+1) to modify parameters after insertion. |\n\n## Settings Files\n- None specified.\n\n## Tips\n- Ensure the selected **Extrusion profile (sProfile)** exists in your current hsbCAD catalog; otherwise, the stub generation may fail.\n- Use the **Flip Direction** option to orient the timber stub correctly if the width/depth orientation does not match the plates.\n- The **Offsets** (Offset Side 1 & 2) allow you to shift the base plate center relative to the timber beam, useful for eccentric connections.\n\n## FAQ\n- **Q: Why does the stub beam not appear?**\n  A: Check the `sProfile` property. Ensure a valid profile name from your catalog is entered.\n- **Q: How do I change the spacing of the anchor rods?**\n  A: Modify the \"Drill Row Centers\" and \"Drill Col Centers\" properties in the Properties Palette.\n- **Q: Can I use this for a wall base?**\n  A: Yes, as long as the host element is a GenBeam (structural beam), it can be used for columns or walls."
      },
      "tokens_used": 8774,
      "error": null
    }
  }
}