{
  "filename": "HSB_R-Hip T-Solution.mcr",
  "status": "completed",
  "total_tokens": 51644,
  "processing_time": 298.0789518356323,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 5,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl changes the connection between hip and ridge",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "12.06.2013",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "13.06.2013",
            "author": "AS",
            "changes": "Apply cuts for angled beams"
          },
          {
            "version": "1.02",
            "date": "17.06.2013",
            "author": "AS",
            "changes": "TSL can be attached to element definition now."
          },
          {
            "version": "1.03",
            "date": "19.06.2013",
            "author": "AS",
            "changes": "Add support for hip=hip connection"
          },
          {
            "version": "1.04",
            "date": "10.09.2013",
            "author": "AS",
            "changes": "Set sequenceNumber"
          },
          {
            "version": "1.05",
            "date": "11.09.2013",
            "author": "AS",
            "changes": "Correct hip-hip solution for angled hips"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8319,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses _kModelSpace in tsl.dbCreate calls. No references to Viewport, PaperSpace, sd_*, or #Type E. Logic focuses on 3D element/beam manipulation (GenBeam, Element) rather than 2D drawing annotation."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space containing an Element with specific beam codes (Hip and Ridge)",
          "requiredSettings": []
        }
      },
      "tokens_used": 5931,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select one or more elements|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "_bOnInsert (if no Execute Key is found)",
            "title": null,
            "dataSource": "Script Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeperator01",
            "type": "PropString",
            "displayName": "|Hip|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Separator: Hip"
          },
          {
            "index": 1,
            "variable": "sBmCodeHip",
            "type": "PropString",
            "displayName": "|Beamcode hip|",
            "defaultValue": "HK-01",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sSeperator02",
            "type": "PropString",
            "displayName": "|Ridge|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Separator: Ridge"
          },
          {
            "index": 3,
            "variable": "sBmCodeRidge",
            "type": "PropString",
            "displayName": "|Beamcode ridge|",
            "defaultValue": "NK-01",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sSeperator03",
            "type": "PropString",
            "displayName": "|T-Solution|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Separator: T-Solution"
          },
          {
            "index": 0,
            "variable": "dMinimumLengthShortRafter",
            "type": "PropDouble",
            "displayName": "|Minimum length short rafter|",
            "defaultValue": "250",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dPreferedLengthShortRafter",
            "type": "PropDouble",
            "displayName": "|Length short rafter|",
            "defaultValue": "1000",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sBmCodeShortRafter",
            "type": "PropString",
            "displayName": "|Beamcode short rafter|",
            "defaultValue": "HK-R",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sBmCodeTrim",
            "type": "PropString",
            "displayName": "|Beamcode trim|",
            "defaultValue": "HK-T",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sSeperator04",
            "type": "PropString",
            "displayName": "|Hip-hip Solution|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Separator: Hip-hip Solution"
          },
          {
            "index": 2,
            "variable": "dExtendRafter",
            "type": "PropDouble",
            "displayName": "|Extend rafter from hip|",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9708,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the detailing of Ridge-to-Hip roof intersections by generating a structural 'T' connection (short rafter and trimmer) and applying corresponding cuts to the main structural members.",
          "category": "Framing",
          "typicalUseCase": "Used during the structural detailing phase of a roof to ensure proper connection and support where hip rafters meet the ridge beam, or where two hips meet."
        },
        "parameters": [
          {
            "name": "sBmCodeHip",
            "technicalDefault": "HK-01",
            "businessMeaning": "The beam code used to identify which beams in the element are Hip Rafters. The script searches for beams with this code to determine where to apply cuts.",
            "validRange": "Any valid Beam Code string in the project catalog",
            "unit": "String",
            "affectsOutput": "Determines which beams receive the 'T' connection cuts."
          },
          {
            "name": "sBmCodeRidge",
            "technicalDefault": "NK-01",
            "businessMeaning": "The beam code used to identify the Ridge Beam. The generated short rafter is placed perpendicular to this beam.",
            "validRange": "Any valid Beam Code string in the project catalog",
            "unit": "String",
            "affectsOutput": "Determines the main beam that the short rafter connects into perpendicularly."
          },
          {
            "name": "dMinimumLengthShortRafter",
            "technicalDefault": "250",
            "businessMeaning": "The absolute minimum allowed length for the generated connecting rafter (the top of the 'T'). If the geometry requires a beam shorter than this, the script may fail or produce invalid results.",
            "validRange": "150 - 500 mm",
            "unit": "mm",
            "affectsOutput": "Sets the size constraint for the inserted jack rafter/short purlin."
          },
          {
            "name": "dPreferedLengthShortRafter",
            "technicalDefault": "1000",
            "businessMeaning": "The threshold distance that dictates whether a separate Trimmer beam is generated. If the distance from the intersection point to the next existing support is less than this value, the short rafter stretches to that support. If greater, a new trimmer beam is created.",
            "validRange": "600 - 2000 mm",
            "unit": "mm",
            "affectsOutput": "Controls the generation logic of the Trimmer beam (supporting beam) vs. stretching the Short Rafter."
          },
          {
            "name": "sBmCodeShortRafter",
            "technicalDefault": "HK-R",
            "businessMeaning": "The material/processing code assigned to the newly created short rafter that connects the Hip to the Ridge.",
            "validRange": "Any valid Beam Code string in the project catalog",
            "unit": "String",
            "affectsOutput": "Sets the properties (size, grade, machining) of the inserted connecting beam."
          },
          {
            "name": "sBmCodeTrim",
            "technicalDefault": "HK-T",
            "businessMeaning": "The material/processing code assigned to the newly created Trimmer beam (parallel to the ridge) that supports the short rafter.",
            "validRange": "Any valid Beam Code string in the project catalog",
            "unit": "String",
            "affectsOutput": "Sets the properties (size, grade, machining) of the inserted trimmer beam."
          },
          {
            "name": "dExtendRafter",
            "technicalDefault": "100",
            "businessMeaning": "In a Hip-to-Hip connection scenario (where no ridge exists), this value determines how far to extend the vertical support or offset the cut planes to ensure a valid intersection.",
            "validRange": "50 - 300 mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the cut position on angled beams in Hip-Hip configurations."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dMinimumLengthShortRafter",
            "effect": "Must be smaller than dPreferedLengthShortRafter for logical consistency.",
            "cascade": [
              "dPreferedLengthShortRafter"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Short Rafter (Jack Rafter) inserted perpendicular to the Ridge, connecting into the Hip.",
            "appliedTo": "Element (New Beam)"
          },
          {
            "type": "GenBeam",
            "description": "Trimmer beam inserted parallel to the Ridge to support the Short Rafter (if the gap is large enough).",
            "appliedTo": "Element (New Beam)"
          },
          {
            "type": "Cut",
            "description": "Orthogonal cut at the intersection point to accept the Short Rafter.",
            "appliedTo": "Ridge Beam (Identified by sBmCodeRidge)"
          },
          {
            "type": "Cut",
            "description": "Plumb cut at the intersection point to accept the Short Rafter.",
            "appliedTo": "Hip Beam (Identified by sBmCodeHip)"
          },
          {
            "type": "Cut",
            "description": "Adjustive cuts on angled/common rafters intersecting the new T-solution to resolve clashes.",
            "appliedTo": "Angled Beams in the Element"
          }
        ]
      },
      "tokens_used": 10285,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 12034,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_R-Hip T-Solution.mcr\n\n## Overview\nAutomates the detailing of Ridge-to-Hip roof intersections by generating a structural \"T\" connection (short rafter and trimmer) and applying corresponding cuts to the main beams. It also supports solutions for Hip-to-Hip connections.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on 3D elements and beams. |\n| Paper Space | No | Not designed for 2D drawing layouts. |\n| Shop Drawing | No | Not a multipage or annotation script. |\n\n## Prerequisites\n- **Required Entities:** An Element containing structural members.\n- **Minimum Beam Count:** At least 2 beams (typically one Ridge and one Hip).\n- **Required Settings:** Ensure your project catalog contains the beam codes specified in the script properties (defaults: HK-01, NK-01, etc.).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_R-Hip T-Solution.mcr`\n\n### Step 2: Select Element\n```\nCommand Line: Select one or more elements\nAction: Click on the roof element where the Hip and Ridge intersect.\n```\n\n### Step 3: Configure Properties\nAfter selection, the script attaches to the element. Open the **Properties Palette** (Ctrl+1) to adjust beam codes and dimensions to match your specific project requirements.\n\n## Properties Panel Parameters\n\n### Hip Configuration\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beamcode hip | Text | HK-01 | The beam code identifying the Hip rafter in the element. |\n\n### Ridge Configuration\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beamcode ridge | Text | NK-01 | The beam code identifying the Ridge beam in the element. |\n\n### T-Solution Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Minimum length short rafter | Number | 250 | The absolute smallest allowed length for the generated connecting rafter (top of the 'T'). |\n| Length short rafter | Number | 1000 | The threshold distance determining if a separate Trimmer beam is created. If the gap is smaller than this, the short rafter stretches to the support. |\n| Beamcode short rafter | Text | HK-R | The beam code assigned to the newly created short rafter connecting Hip to Ridge. |\n| Beamcode trim | Text | HK-T | The beam code assigned to the newly created Trimmer beam (parallel to the ridge). |\n\n### Hip-Hip Solution Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Extend rafter from hip | Number | 100 | Determines how far to extend the support or offset cuts for Hip-to-Hip connections where no ridge exists. |\n\n## Right-Click Menu Options\nNo custom context menu options are defined for this script. Use standard hsbCAD entity commands for recalculation or updates.\n\n## Settings Files\nNo external settings files are required for this script. All configuration is handled via the Properties Palette.\n\n## Tips\n- **Beam Codes:** If the script does not seem to detect your beams, verify that the `Beamcode hip` and `Beamcode ridge` properties exactly match the codes used in your model.\n- **Trimmer Generation:** If you expect a trimmer beam but don't see one, check the distance between the intersection and the next support. If it is less than the `Length short rafter` (1000mm), the script will extend the jack rafter instead of adding a trimmer.\n- **Hip-Hip Roofs:** For roof shapes without a ridge (e.g., pyramid roofs), ensure the `Extend rafter from hip` value is sufficient to create a valid connection.\n\n## FAQ\n- **Q: Why did the script fail to generate a beam?**\n  **A:** Check the `Minimum length short rafter`. If the calculated intersection requires a beam shorter than 250mm, the geometry may be invalid for this script.\n\n- **Q: Can I use this for vaulted ceilings?**\n  **A:** This script is designed for standard pitched roof intersections (Ridge-to-Hip). Results on complex vaulted geometries may vary.\n\n- **Q: How do I update the connection after changing the roof pitch?**\n  **A:** Use the standard `hsbCAD` update command (usually right-click the element and select **Update** or **Recalculate**) to run the script again with the new geometry."
      },
      "tokens_used": 5367,
      "error": null
    }
  }
}