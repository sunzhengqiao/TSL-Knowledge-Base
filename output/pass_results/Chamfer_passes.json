{
  "filename": "Chamfer.mcr",
  "status": "completed",
  "total_tokens": 30868,
  "processing_time": 294.86710929870605,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "Applies chamfer operation to one or more beam edges",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3708,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script operates on Beam objects retrieved via getBeam() and modifies geometry via bm.addTool(). No sd_ prefixes, Viewport checks, or #Type E entity interactions found."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D Model)",
          "requiredSettings": []
        }
      },
      "tokens_used": 2200,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Select Location|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrPoint",
              "promptOriginal": "|Select Start and End of chamfer|",
              "condition": "_bOnInsert",
              "required": false
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "psChamferType",
            "type": "PropString",
            "displayName": "|Chamfer Type|",
            "defaultValue": "|Round|",
            "inputType": "dropdown",
            "options": [
              "|Round|",
              "|45|",
              "|90|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "pdDepth",
            "type": "PropDouble",
            "displayName": "|Chamfer Depth|",
            "defaultValue": "U(.5, \"inch\")",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "pdLength",
            "type": "PropDouble",
            "displayName": "|Chamfer Length|",
            "defaultValue": "U(6, \"inch\")",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "psNegYPosZ",
            "type": "PropString",
            "displayName": "|Neg Y Pos Z|",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "psNegYNegZ",
            "type": "PropString",
            "displayName": "|Neg Y Neg Z|",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "psPosYPosZ",
            "type": "PropString",
            "displayName": "|Pos Y Pos Z|",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "psPosYNegZ",
            "type": "PropString",
            "displayName": "|Pos Y Neg Z|",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6229,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Applies a decorative or functional easing (chamfer or round) to the edges of a timber beam along a specific length.",
          "category": "Machining/Finish",
          "typicalUseCase": "Used to ease sharp corners on posts for safety or aesthetic reasons, or to create lead-in chamfers on beam ends to facilitate assembly."
        },
        "parameters": [
          {
            "name": "psChamferType",
            "technicalDefault": "|Round|",
            "businessMeaning": "Defines the geometric profile of the cut taken off the edge of the beam.",
            "validRange": "Round (Eased), 45 (Beveled), 90 (Square notch/removal)",
            "unit": "enum",
            "affectsOutput": "Determines if the edge is rounded over, cut at a 45-degree angle, or cut square/vertically."
          },
          {
            "name": "pdDepth",
            "technicalDefault": "U(.5, \"inch\")",
            "businessMeaning": "The distance the chamfer removes from the original corner of the beam (depth of cut).",
            "validRange": "0.1 inch to min(Width, Height) / 2",
            "unit": "length (mm/inch)",
            "affectsOutput": "Controls how aggressive the visual and physical easing is. A larger depth removes more material."
          },
          {
            "name": "pdLength",
            "technicalDefault": "U(6, \"inch\")",
            "businessMeaning": "The distance along the beam's axis (length) that the chamfer operation covers.",
            "validRange": "0.1 inch to Beam Length",
            "unit": "length (mm/inch)",
            "affectsOutput": "Stretching or compressing the chamfered area along the beam."
          },
          {
            "name": "psNegYPosZ",
            "technicalDefault": "No",
            "businessMeaning": "Toggles the chamfer on for the beam corner located at Negative Y, Positive Z (relative to beam local coords).",
            "validRange": "Yes, No",
            "unit": "boolean",
            "affectsOutput": "Adds or removes the machining operation from that specific corner of the beam cross-section."
          },
          {
            "name": "psNegYNegZ",
            "technicalDefault": "No",
            "businessMeaning": "Toggles the chamfer on for the beam corner located at Negative Y, Negative Z.",
            "validRange": "Yes, No",
            "unit": "boolean",
            "affectsOutput": "Adds or removes the machining operation from that specific corner of the beam cross-section."
          },
          {
            "name": "psPosYPosZ",
            "technicalDefault": "No",
            "businessMeaning": "Toggles the chamfer on for the beam corner located at Positive Y, Positive Z.",
            "validRange": "Yes, No",
            "unit": "boolean",
            "affectsOutput": "Adds or removes the machining operation from that specific corner of the beam cross-section."
          },
          {
            "name": "psPosYNegZ",
            "technicalDefault": "No",
            "businessMeaning": "Toggles the chamfer on for the beam corner located at Positive Y, Negative Z.",
            "validRange": "Yes, No",
            "unit": "boolean",
            "affectsOutput": "Adds or removes the machining operation from that specific corner of the beam cross-section."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User moves Chamfer Start/End Grips (_PtG0, _PtG1)",
            "effect": "Recalculates the total Chamfer Length and updates the Location point to the center.",
            "cascade": [
              "pdLength",
              "_Pt0"
            ]
          },
          {
            "trigger": "User changes Chamfer Length (pdLength)",
            "effect": "Updates the position of the Start and End points to be centered around the current Location.",
            "cascade": [
              "ptChamferStart",
              "ptChamferEnd"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Chamfer",
            "description": "A 3D machining operation that removes material from the beam edges based on the specified profile and depth.",
            "appliedTo": "The selected GenBeam"
          }
        ]
      },
      "tokens_used": 5755,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch: User executes script from catalog or command line.",
          "2. Beam Selection: User selects a single GenBeam to apply the chamfer to.",
          "3. Location Selection: User picks a Point3d (_Pt0) on the beam representing the center of the chamfer area.",
          "4. Interactive Definition: Dynamic prompt (PrPoint) appears asking to define Start/End points.",
          "5. Input Resolution:",
          "   - If User picks 2 points: These define the chamfer start and end.",
          "   - If User picks 1 point or cancels: Script calculates start/end symmetrically around the Location or the single point, using the 'Chamfer Length' property.",
          "6. Geometry Projection: Calculated points are projected onto the beam's centerline axis.",
          "7. Parameter Calculation: The 'Chamfer Length' property is updated to match the distance between the defined start and end points.",
          "8. Instance Creation: Script exits insert mode, creating the TSL instance.",
          "9. Machining Application: The Chamfer tool is generated and added to the beam if at least one edge side is selected.",
          "10. Completion: Geometry updates and renders in the model."
        ],
        "conditionalBranches": [
          {
            "condition": "User Input during PrPoint prompt (Step 4)",
            "path1": {
              "name": "Explicit Geometry (2 Points)",
              "steps": [
                "User selects two distinct points on the beam.",
                "Script snaps these points to the beam axis.",
                "Script calculates the distance and sets 'Chamfer Length' property."
              ]
            },
            "path2": {
              "name": "Parametric Geometry (0 or 1 Point)",
              "steps": [
                "User selects one point or cancels the prompt without selecting 2 points.",
                "Script retrieves current 'Chamfer Length' property value.",
                "Script calculates Start/End points centered on the Location point (or the single picked point) using the property value."
              ]
            }
          },
          {
            "condition": "Edge Selection Properties (iSides)",
            "path1": {
              "name": "Machining Applied",
              "steps": [
                "Any of the 4 edge properties (Neg Y Pos Z, etc.) are set to 'Yes'.",
                "Integer iSides is calculated > 0.",
                "Chamfer tool is constructed and added to the beam."
              ]
            },
            "path2": {
              "name": "No Operation",
              "steps": [
                "All 4 edge properties are set to 'No'.",
                "Integer iSides is calculated as 0.",
                "Script executes the geometry logic but skips 'bm.addTool(cm)', resulting in no visual change."
              ]
            }
          },
          {
            "condition": "Point Orientation relative to Beam X-Axis",
            "path1": {
              "name": "Correct Orientation",
              "steps": [
                "Calculated Start point is 'behind' End point relative to beam vector X.",
                "Logic proceeds without swapping."
              ]
            },
            "path2": {
              "name": "Reversed Orientation",
              "steps": [
                "Calculated Start point is 'ahead' of End point (Dot Product < 0).",
                "Script swaps the Start and End point variables to ensure correct direction."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Projection to Beam Axis",
            "errorMessage": "None (Silent correction)",
            "recovery": "Script automatically projects user-selected points onto the beam's centerline using closestPointTo() to ensure the chamfer follows the beam axis."
          },
          {
            "check": "Beam Selection",
            "errorMessage": "Standard hsbCAD cancellation",
            "recovery": "User must select a valid GenBeam object to proceed."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Chamfer Length",
            "how": "OPM Property Palette (pdLength)",
            "effect": "Start and End grip points update symmetrically around the Location point to match the new length."
          },
          {
            "action": "Drag Start/End Grips",
            "how": "Grip Edit (_PtG0, _PtG1)",
            "effect": "The 'Chamfer Length' property updates to the new distance between grips. The Location point updates to the new midpoint."
          },
          {
            "action": "Move Chamfer Location",
            "how": "Grip Edit (_Pt0) or Move Command",
            "effect": "The Start and End points move along with the Location point, maintaining the current Chamfer Length."
          },
          {
            "action": "Change Chamfer Type",
            "how": "OPM Property Palette (psChamferType)",
            "effect": "Updates the tool profile (Round, 45-degree bevel, or 90-degree notch)."
          },
          {
            "action": "Toggle Edges",
            "how": "OPM Property Palette (psNegYPosZ, etc.)",
            "effect": "Adds or removes the chamfer operation from specific corners of the beam cross-section."
          }
        ]
      },
      "tokens_used": 6854,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Chamfer.mcr\n\n## Overview\nApplies a decorative or functional easing (chamfer or round) to the edges of a timber beam along a specific length. It supports Round, 45-degree bevel, or 90-degree notch profiles.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates directly on 3D beam objects. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | Does not generate shop drawing views or dimensions. |\n\n## Prerequisites\n- **Required Entities**: One (1) `GenBeam` (Timber Beam).\n- **Minimum Beam Count**: 1.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Chamfer.mcr` from the catalog.\n\n### Step 2: Select Beam\n```\nCommand Line: Select beam\nAction: Click on the timber beam you wish to modify.\n```\n\n### Step 3: Select Location\n```\nCommand Line: Select Location\nAction: Click a point on the beam where the chamfer should be centered.\n```\n\n### Step 4: Define Start and End\n```\nCommand Line: Select Start and End of chamfer\nAction: You have two options:\n   A. Click two distinct points on the beam to define exactly where the chamfer starts and ends.\n   B. Click only one point or press Enter to use the default \"Chamfer Length\" centered on the Location picked in Step 3.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Chamfer Type** | Dropdown | Round | Select the profile shape: `Round` (eased edge), `45` (beveled), or `90` (square notch). |\n| **Chamfer Depth** | Number | 0.5 inch | The distance the cut removes from the corner of the beam (material thickness removed). |\n| **Chamfer Length** | Number | 6 inch | The distance along the beam axis that the chamfer covers. |\n| **Neg Y Pos Z** | Dropdown | No | Set to `Yes` to apply the chamfer to the corner at Negative Y / Positive Z. |\n| **Neg Y Neg Z** | Dropdown | No | Set to `Yes` to apply the chamfer to the corner at Negative Y / Negative Z. |\n| **Pos Y Pos Z** | Dropdown | No | Set to `Yes` to apply the chamfer to the corner at Positive Y / Positive Z. |\n| **Pos Y Neg Z** | Dropdown | No | Set to `Yes` to apply the chamfer to the corner at Positive Y / Negative Z. |\n\n## Right-Click Menu Options\nThis script uses standard hsbCAD interactions. Modifications are primarily handled via the **Properties Palette** and **Grip Edits**.\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Grip Editing**: After insertion, select the script instance to see grips. Drag the **Start** and **End** grips to visually stretch the chamfer length along the beam.\n- **Center Point**: Drag the central **Location** grip to move the entire chamfer along the beam without changing its length.\n- **Corner Selection**: By default, no corners are selected (set to `No`). You must change the specific corner properties (e.g., `Pos Y Pos Z`) to `Yes` to see the visual result.\n- **Symmetric Chamfering**: If you want to ease all four corners of a beam, set all four \"Neg/Pos Y/Z\" properties to `Yes`.\n\n## FAQ\n- **Q: Why don't I see a chamfer immediately after insertion?**\n  - **A:** By default, the specific corner properties are set to \"No\". Go to the Properties Palette and toggle the relevant corners (e.g., `Pos Y Pos Z`) to \"Yes\" to activate the machining on that edge.\n\n- **Q: Can I change the length after I have placed it?**\n  - **A:** Yes. You can either type a new value in the \"Chamfer Length\" property, or select the object in the model and drag the square Start/End grips to the desired length.\n\n- **Q: What does \"Neg Y Pos Z\" mean?**\n  - **A:** These refer to the beam's local coordinate system. `Y` is usually the width, and `Z` is the height. You may need to toggle the different options to see which corner corresponds to which property, or check the beam's local axis direction if unsure."
      },
      "tokens_used": 6122,
      "error": null
    }
  }
}