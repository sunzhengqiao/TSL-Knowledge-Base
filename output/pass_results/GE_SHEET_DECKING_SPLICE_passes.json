{
  "filename": "GE_SHEET_DECKING_SPLICE.mcr",
  "status": "completed",
  "total_tokens": 35490,
  "processing_time": 397.21199321746826,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "v1.3",
            "date": "30-jul-2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail added"
          },
          {
            "version": "v1.2",
            "date": "30-jan-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Cutting direction changed: now rows are cut starting from bottom of sheeting, that way we have less smaller pieces to cut."
          },
          {
            "version": "v1.1",
            "date": "06-jul-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "v1.0",
            "date": "14-Mar-2011",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5626,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select 'Sheet' entities and performs 3D geometric operations including Vector3d calculations, Plane definitions, and Body envelope analysis. It uses dbSplit() to modify sheet geometry in the database. No sd_ prefixes, Viewport handling, or #Type E declarations are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing sheeting elements",
          "requiredSettings": []
        }
      },
      "tokens_used": 4811,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select sheeting",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select starting point",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dL",
            "type": "PropDouble",
            "displayName": "Sheeting length",
            "defaultValue": "2438.4 mm / 96 in",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dH",
            "type": "PropDouble",
            "displayName": "Sheeting height",
            "defaultValue": "1219.2 mm / 48 in",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4449,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Splits selected large-format sheeting (e.g., OSB or Plywood) into smaller, staggered panels to simulate structural decking or sheathing layout with running bond joints.",
          "category": "Framing",
          "typicalUseCase": "Used when a floor, roof, or wall area has been covered with large sheets, but the manufacturing or construction documentation requires the sheeting to be represented as specific panel sizes with staggered splices for structural integrity."
        },
        "parameters": [
          {
            "name": "dL",
            "technicalDefault": "2438.4 mm / 96 in",
            "businessMeaning": "The target length of the individual sheathing panels along the primary axis (usually parallel to joists/rafters). This determines the spacing of vertical cuts and the offset amount for staggered rows.",
            "validRange": "600 mm - 6100 mm (2' - 20')",
            "unit": "Length (mm/in)",
            "affectsOutput": "Controls where vertical cuts are placed. A smaller value creates more panels. Specifically, odd rows are offset by half this value relative to the starting point to create the staggered effect."
          },
          {
            "name": "dH",
            "technicalDefault": "1219.2 mm / 48 in",
            "businessMeaning": "The target height (or width) of the individual sheathing panels perpendicular to the primary axis. This determines the spacing of horizontal cuts.",
            "validRange": "300 mm - 1250 mm (1' - 4')",
            "unit": "Length (mm/in)",
            "affectsOutput": "Controls where horizontal cuts are made, dividing the original sheets into rows. Changing this changes the number of rows generated."
          },
          {
            "name": "_Pt0",
            "technicalDefault": "User click point",
            "businessMeaning": "The layout origin point that defines where the cutting grid begins. Even rows start their cuts at this point, while odd rows are offset from it.",
            "validRange": "Any point in 3D space on the sheeting plane",
            "unit": "Coordinates (x,y,z)",
            "affectsOutput": "Shifting this point slides the entire grid of cuts along the sheeting. This is used to align panel edges with structural members or minimize waste."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in dL",
            "effect": "Alters the offset distance for odd rows (calculated as dL * 0.5) and the stepping distance for vertical cuts.",
            "cascade": [
              "Odd row cut positions",
              "Number of vertical cuts"
            ]
          },
          {
            "trigger": "Change in dH",
            "effect": "Alters the stepping distance for horizontal cuts (rows).",
            "cascade": [
              "Row count",
              "Number of horizontal cuts"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet",
            "description": "The original selected sheet entities are replaced by multiple smaller Sheet entities representing the cut panels arranged in a staggered pattern.",
            "appliedTo": "The initially selected 'Sheeting' entities."
          }
        ]
      },
      "tokens_used": 6777,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution initiated.",
          "2. [Conditional] Check Insertion Cycle: If cycle count > 1, erase instance and exit immediately.",
          "3. [User Input] Prompt user to select sheeting entities (PrEntity) to act upon.",
          "4. [User Input] Prompt user to select a starting point (getPoint) to define the grid origin.",
          "5. Script state saved and execution restarts (Cycle 2).",
          "6. [Conditional] Validate Data: If no sheets were selected, erase instance and exit.",
          "7. Loop through each selected sheet to establish local coordinate systems (vX, vY, vZ).",
          "8. Perform Horizontal Cuts: Iterate upwards from the bottom edge of sheets in steps of 'Sheeting height' (dH). Use dbSplit() to create rows.",
          "9. Group & Sort: Identify all resulting strips lying in the same plane and sort them based on their distance from the global starting point along the Y-axis.",
          "10. Categorize Rows: Iterate through sorted strips to group them into physical rows. Label rows as 'Even' (0, 2, 4...) or 'Odd' (1, 3, 5...) based on their order.",
          "11. Perform Vertical Cuts (Staggering): Loop through Even and Odd row groups.",
          "12.   [Even Rows] Calculate cut origin at projected starting point.",
          "13.   [Odd Rows] Calculate cut origin at projected starting point plus 50% of 'Sheeting length' (dL).",
          "14.   Snap cut origin to the right of the sheet boundary.",
          "15.   Step backwards by 'Sheeting length' (dL) and split the row (dbSplit) until the cut point passes the left boundary.",
          "16. Erase script instance from the model."
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Check",
            "path1": {
              "name": "Subsequent Cycle (>1)",
              "steps": [
                "Erase script instance",
                "Exit"
              ]
            },
            "path2": {
              "name": "First Cycle (1)",
              "steps": [
                "Prompt for sheeting selection",
                "Prompt for starting point",
                "Store inputs",
                "Return to restart"
              ]
            }
          },
          {
            "condition": "Selection Validation",
            "path1": {
              "name": "No Sheets Selected",
              "steps": [
                "Erase script instance",
                "Exit"
              ]
            },
            "path2": {
              "name": "Sheets Selected",
              "steps": [
                "Proceed to Horizontal Splitting logic"
              ]
            }
          },
          {
            "condition": "Row Parity (Staggering)",
            "path1": {
              "name": "Even Rows",
              "steps": [
                "Calculate Cut Origin = Projected Start Point",
                "Perform vertical cuts"
              ]
            },
            "path2": {
              "name": "Odd Rows",
              "steps": [
                "Calculate Cut Origin = Projected Start Point + (dL * 0.5)",
                "Perform vertical cuts"
              ]
            }
          },
          {
            "condition": "Horizontal Cutting Loop",
            "path1": {
              "name": "Cut point within sheet height",
              "steps": [
                "Execute dbSplit",
                "Increment step counter",
                "Calculate next cut point"
              ]
            },
            "path2": {
              "name": "Cut point exceeds sheet height",
              "steps": [
                "Stop splitting current sheet",
                "Move to next sheet"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Sheets selected",
            "errorMessage": "None",
            "recovery": "The script silently erases itself if the user cancels the PrEntity selection or does not select any sheets. User must re-run the command."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Sheet Dimensions",
            "how": "Re-run script insertion",
            "effect": "The script instance is erased immediately after execution. To change dL or dH, the user must Undo the command or select the original un-splitted sheeting again and run the script with new property values."
          },
          {
            "action": "Adjust Grid Layout",
            "how": "Move starting point",
            "effect": "Changing the selected starting point shifts the entire grid of cuts, allowing alignment with structural members or optimization of sheet placement."
          }
        ]
      },
      "tokens_used": 8241,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_SHEET_DECKING_SPLICE\n\n## Overview\nSplits selected large-format sheeting (such as OSB or Plywood) into smaller, staggered panels. This tool simulates a structural decking or sheathing layout with running bond joints for floor, roof, or wall areas.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for 3D sheeting entities. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required entities**: Existing \"Sheet\" entities (e.g., large uncut panels) already drawn in the model.\n- **Minimum beam count**: 0\n- **Required settings files**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `GE_SHEET_DECKING_SPLICE.mcr`.\n\n### Step 2: Adjust Properties (Optional)\nAction: Before proceeding, you can adjust the **Sheeting length** and **Sheeting height** in the Properties Palette if the default dimensions do not match your desired panel size.\n\n### Step 3: Select Sheeting\n```\nCommand Line: Select sheeting\nAction: Click on the large sheet entities you wish to split. Press Enter to confirm selection.\n```\n\n### Step 4: Define Starting Point\n```\nCommand Line: Select starting point\nAction: Click a point in the drawing area.\n```\n*Note: This point acts as the origin for the cutting grid. It determines where the first row of cuts begins and aligns the staggered pattern.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Sheeting length | number | 2438.4 mm / 96 in | The target length of the individual panels along the primary axis. This determines the spacing of vertical cuts. Odd rows are offset by half this value to create the stagger. |\n| Sheeting height | number | 1219.2 mm / 48 in | The target height (or width) of the individual panels perpendicular to the primary axis. This determines the spacing of horizontal cuts (rows). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | The script instance is removed from the model immediately after execution. There are no post-insertion context menu options. |\n\n## Settings Files\nNone\n\n## Tips\n- **Alignment**: Use the \"Select starting point\" click carefully. Clicking near a structural element (like a joist or rafter) ensures panel edges align where you need them.\n- **Optimization**: The script calculates cuts starting from the bottom of the sheeting upwards. This helps minimize the number of small, unusable cut-off pieces at the top.\n- **Undo**: Since the script replaces the original sheets and deletes itself, use the AutoCAD `UNDO` command if you need to revert the changes or adjust the sizes.\n- **Staggering**: The script automatically offsets every other row by 50% of the *Sheeting length* to ensure joints do not line up vertically.\n\n## FAQ\n- **Q: Why did my original sheet disappear?**\n  - A: The script deletes the original sheet entity and replaces it with the new, smaller individual panels. This is the intended behavior.\n- **Q: How do I change the panel size after I have run the script?**\n  - A: You cannot simply modify the properties and update. You must use the `UNDO` command to revert to the original large sheet, change the *Sheeting length* or *Sheeting height* properties, and run the script again.\n- **Q: What happens if I select sheets of different sizes or orientations?**\n  - A: The script processes each selected sheet individually based on its own geometry and the global starting point provided. Ensure the starting point is relevant to all selected sheets if they are in the same plane."
      },
      "tokens_used": 5586,
      "error": null
    }
  }
}