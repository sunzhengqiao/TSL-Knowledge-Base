{
  "filename": "HSB_T-Neda.mcr",
  "status": "completed",
  "total_tokens": 27262,
  "processing_time": 221.49312591552734,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl creates a neda tool",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "05.03.2013",
            "author": "AS",
            "changes": "Pilot version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3947,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit usage of _kModelSpace in tslNew.dbCreate; usage of BeamCut to modify physical beam geometry; lacks sd_ prefix, _Viewport, or 2D drawing specific logic."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 2962,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select female beam",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "Select a set of male beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeperator01",
            "type": "PropString",
            "displayName": "Neda tool",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dHeightBmMale",
            "type": "PropDouble",
            "displayName": "Height male beam",
            "defaultValue": "U(50)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dVerticalGap",
            "type": "PropDouble",
            "displayName": "Vertical gap",
            "defaultValue": "U(5)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dHorizontalGap",
            "type": "PropDouble",
            "displayName": "Horizontal gap",
            "defaultValue": "U(1)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5461,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the creation of a 'Neda' timber connection, likely a type of lap joint or keyed notch, between a male beam (inserting member) and a female beam (receiving member).",
          "category": "Connection/Carpentry",
          "typicalUseCase": "Used in timber framing to create a flush or near-flush connection where a secondary beam intersects a primary beam, removing material from both to allow them to fit together with specified gaps."
        },
        "parameters": [
          {
            "name": "dHeightBmMale",
            "technicalDefault": "U(50)",
            "businessMeaning": "Defines the depth of the material to be removed from the top of the male beam (or the depth of the tenon/tongue), effectively determining how deep the male beam engages into the female beam.",
            "validRange": "10mm to (Height of Male Beam - 10mm)",
            "unit": "mm",
            "affectsOutput": "Controls the vertical positioning of the cuts on both the male and female beams. A larger value removes more material from the female beam to accommodate a deeper portion of the male beam."
          },
          {
            "name": "dVerticalGap",
            "technicalDefault": "U(5)",
            "businessMeaning": "The vertical clearance space between the bottom of the male beam's cut and the bottom of the female beam's cut (or between the top of the male portion and the female beam).",
            "validRange": "0mm to 20mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the distance between the two cut geometries. Ensures the beams do not touch at the specific interface point, allowing for shrinkage, manufacturing tolerances, or sealant application."
          },
          {
            "name": "dHorizontalGap",
            "technicalDefault": "U(1)",
            "businessMeaning": "The horizontal clearance or tolerance on the width of the cut in the female beam.",
            "validRange": "0mm to 10mm",
            "unit": "mm",
            "affectsOutput": "Widens the slot/cut in the female beam relative to the width of the male beam, preventing tight binding during assembly."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Height male beam (dHeightBmMale) changes",
            "effect": "The position of the cut on the Female beam moves vertically to match.",
            "cascade": []
          },
          {
            "trigger": "Vertical gap (dVerticalGap) changes",
            "effect": "The position of the Female beam cut shifts vertically relative to the Male beam cut.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "BeamCut",
            "description": "A rectangular cut (or notch) on the male beam to remove material above the joint level.",
            "appliedTo": "Male Beam (_Beam0)"
          },
          {
            "type": "BeamCut",
            "description": "A pocket or slot cut on the female beam to receive the male beam, accounting for the vertical and horizontal gaps.",
            "appliedTo": "Female Beam (_Beam1)"
          },
          {
            "type": "PLine (Visualization)",
            "description": "A visual indicator (line) drawn to represent the connection or the 'Neda' interface in 3D space.",
            "appliedTo": "Model Space (Visual only)"
          }
        ]
      },
      "tokens_used": 3595,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script (Insert).",
          "2. System checks if execution is triggered by a catalog key.",
          "3. [Conditional] If no catalog key, display properties dialog for user input (Height, Gaps).",
          "4. Prompt user to select a single Female beam.",
          "5. Prompt user to select a set of Male beams.",
          "6. User confirms selection (or cancels).",
          "7. System iterates through every beam in the Male set.",
          "8. For each Male beam, create a new 'worker' instance of the script linked to the Male and Female beam.",
          "9. Delete the temporary 'parent' instance used for selection.",
          "10. Each 'worker' instance calculates geometry based on beam coordinates and properties.",
          "11. Each 'worker' instance applies BeamCut to the Male beam (creating tenon/shoulder).",
          "12. Each 'worker' instance applies BeamCut to the Female beam (creating slot/pocket).",
          "13. Each 'worker' instance draws a visualization PLine representing the connection level."
        ],
        "conditionalBranches": [
          {
            "condition": "Script State (_bOnInsert flag)",
            "path1": {
              "name": "Insertion Phase",
              "steps": [
                "Check cycle count",
                "Show Dialog (if applicable)",
                "Get Female Beam",
                "Get Male Beam Set",
                "Spawn Worker Instances",
                "Erase Parent Instance"
              ]
            },
            "path2": {
              "name": "Calculation/Update Phase",
              "steps": [
                "Load Catalog Props (if applicable)",
                "Calculate Cut Coordinates",
                "Apply Cuts to Beams",
                "Draw Visuals"
              ]
            }
          },
          {
            "condition": "Insert Cycle Count (insertCycleCount)",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase Instance immediately (Prevent recursive loops)"
              ]
            },
            "path2": {
              "name": "Cycle == 1",
              "steps": [
                "Proceed with standard insertion workflow"
              ]
            }
          },
          {
            "condition": "Catalog Usage (_kExecuteKey)",
            "path1": {
              "name": "Manual Execute",
              "steps": [
                "Show dialog for user input"
              ]
            },
            "path2": {
              "name": "Catalog Execute",
              "steps": [
                "Load properties directly from catalog entry"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Male Beam Selection Confirmation",
            "errorMessage": "None (Script terminates silently if canceled)",
            "recovery": "User must re-launch the script and complete the selection prompts."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Connection Parameters",
            "how": "Properties Palette (OPM)",
            "effect": "Changing 'Height male beam', 'Vertical gap', or 'Horizontal gap' triggers recalculation, updating the size and position of the cuts on both beams."
          },
          {
            "action": "Move or Rotate Beams",
            "how": "Grip Edit / Move / Rotate Commands",
            "effect": "Since the script links to the beams using coordinate systems (_Pt0, _X0, etc.), moving the beams triggers the script to update the cut positions automatically to maintain the relationship."
          },
          {
            "action": "Delete Connection",
            "how": "Erase Command",
            "effect": "Deleting the script instance removes the tool, restoring the beams to their original uncut state (assuming no other tools overlap)."
          }
        ]
      },
      "tokens_used": 5881,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_T-Neda\n\n## Overview\nAutomates the creation of a 'Neda' timber connection (a specific type of lap or keyed notch) between a main female beam and one or more intersecting male beams. It calculates and applies the necessary cuts to both beams to ensure a proper fit with user-defined gaps.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script modifies 3D beam geometry in the model. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | Not applicable for processing views/layouts. |\n\n## Prerequisites\n- **Required Entities**: At least two `GenBeam` entities.\n- **Minimum Beams**: 1 Female beam and at least 1 Male beam.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `HSB_T-Neda.mcr`.\n\n### Step 2: Select Female Beam\n```\nCommand Line: Select female beam\nAction: Click on the main beam that will receive the other beams (the 'female' part of the joint).\n```\n\n### Step 3: Select Male Beams\n```\nCommand Line: Select a set of male beams\nAction: Select one or multiple beams that will intersect the female beam (the 'male' parts). Press Enter to confirm selection.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Neda tool | Separator | - | Visual separator for this tool's settings. |\n| Height male beam | Number | 50 mm | Defines the depth of the cut on the male beam (tenon depth). Controls how deep the male beam engages into the female beam. |\n| Vertical gap | Number | 5 mm | The vertical clearance between the top of the male beam and the bottom of the cut in the female beam. Allows for shrinkage or tolerances. |\n| Horizontal gap | Number | 1 mm | The horizontal clearance (width tolerance) added to the slot in the female beam. Prevents tight binding during assembly. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific custom options to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A.\n- **Purpose**: N/A.\n\n## Tips\n- **Batch Selection**: You can select multiple male beams in a single window selection during the \"Select a set of male beams\" prompt to apply the connection to all intersections at once.\n- **Dynamic Updates**: If you move or rotate the beams after insertion, the script automatically recalculates and updates the cuts to maintain the connection.\n- **Parametric Adjustments**: You can fine-tune the fit by changing the `Vertical gap` or `Horizontal gap` in the Properties Palette after the tool is inserted.\n\n## FAQ\n- **Q: How do I change the depth of the notch?**\n  **A**: Select the tool instance in the drawing, open the Properties Palette (Ctrl+1), and modify the value for `Height male beam`.\n\n- **Q: Can I connect several small beams to one large beam simultaneously?**\n  **A**: Yes. When prompted for the \"set of male beams,\" select all the intersecting beams you wish to connect. The script will create a separate connection instance for each one.\n\n- **Q: Why are my beams not touching?**\n  **A**: Check your `Vertical gap` and `Horizontal gap` settings in the Properties Palette. If these values are too high, there will be visible space between the beams."
      },
      "tokens_used": 5416,
      "error": null
    }
  }
}