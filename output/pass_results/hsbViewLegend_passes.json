{
  "filename": "hsbViewLegend.mcr",
  "status": "completed",
  "total_tokens": 54108,
  "processing_time": 279.8725960254669,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "24.03.2021",
            "author": "Marsel Nakuci",
            "changes": "HSB-11326: fix hatch representation"
          },
          {
            "version": "1.0",
            "date": "07jan21",
            "author": "marsel.nakuci@hsbcad.com",
            "changes": "HSB-10159: initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8926,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "Both",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": false,
          "detectionEvidence": "Script logic explicitly branches based on Viewport().inLayoutTab() and presence of ShopDrawView entities. Uses getShopDrawView() and getViewport() to handle ShopDraw and Layout spaces respectively, while handling Section2d selection in Model Space."
        },
        "prerequisites": {
          "requiredEntities": [
            "Section2d",
            "Viewport",
            "ShopDrawView"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Operates contextually: Model Space (requires Section2d), Paper Space (requires Viewport), or ShopDraw Space (requires ShopDrawView).",
          "requiredSettings": []
        }
      },
      "tokens_used": 5607,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getShopDrawView",
              "promptOriginal": null,
              "condition": "ShopDraw Space (viewEnts.length > 0)",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Pick insertion point|",
              "condition": "ShopDraw Space / Paper Space",
              "required": true
            },
            {
              "step": 1,
              "function": "getViewport",
              "promptOriginal": "|Select a viewport|",
              "condition": "Paper Space (bInLayoutTab)",
              "required": true
            },
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select Section2d|",
              "condition": "Model Space",
              "required": true
            },
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select entities|",
              "condition": "Context Menu: Add Symbol",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "Invoked via right-click context menu triggers (Add/Remove Hatch, Add/Remove Symbol)",
            "title": null,
            "dataSource": "Script internal maps (mapHatchesCustom, mapSymbols)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dTextHeight",
            "type": "PropDouble",
            "displayName": "|Text Height|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|General|",
            "description": "|Defines the TextHeight|"
          },
          {
            "index": 1,
            "variable": "nColumns",
            "type": "PropInt",
            "displayName": "|Columns|",
            "defaultValue": "1",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3"
            ],
            "category": "|General|",
            "description": "|Defines the nr of Columns of the Legend. Must be a positiv number|"
          },
          {
            "index": 2,
            "variable": "sColSizes",
            "type": "PropString",
            "displayName": "|Column Sizes|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Column Sizes. Entries are numbers and can be separated by a semicolon ;|"
          },
          {
            "index": 0,
            "variable": "sMaterial",
            "type": "PropString",
            "displayName": "|Material|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "|Defines the Material|",
            "note": "Condition: DialogMode == 1 (Add Hatch)"
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "|Color|",
            "defaultValue": "1",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3"
            ],
            "category": "|Solid Hatch|",
            "description": "|Defines the Color|",
            "note": "Condition: DialogMode == 1"
          },
          {
            "index": 1,
            "variable": "nTransparency",
            "type": "PropInt",
            "displayName": "|Transparency|",
            "defaultValue": "0",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3"
            ],
            "category": "|Solid Hatch|",
            "description": "|Defines the Transparency|",
            "note": "Condition: DialogMode == 1"
          },
          {
            "index": 1,
            "variable": "sPattern",
            "type": "PropString",
            "displayName": "|Pattern|",
            "defaultValue": "_HatchPatterns",
            "inputType": "dropdown",
            "options": "_HatchPatterns",
            "category": "|Pattern Hatch|",
            "description": "|Defines the Pattern|",
            "note": "Condition: DialogMode == 1"
          },
          {
            "index": 0,
            "variable": "dScale",
            "type": "PropDouble",
            "displayName": "|Scale|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Pattern Hatch|",
            "description": "|Defines the Scale|",
            "note": "Condition: DialogMode == 1"
          },
          {
            "index": 1,
            "variable": "dAngle",
            "type": "PropDouble",
            "displayName": "|Angle|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Pattern Hatch|",
            "description": "|Defines the Angle|",
            "note": "Condition: DialogMode == 1"
          },
          {
            "index": 0,
            "variable": "sMaterial",
            "type": "PropString",
            "displayName": "|Material|",
            "defaultValue": "sMaterials",
            "inputType": "dropdown",
            "options": "Dynamic (from mapHatchesCustom)",
            "category": "|General|",
            "description": "|Defines the Material|",
            "note": "Condition: DialogMode == 2 (Remove Hatch)"
          },
          {
            "index": 0,
            "variable": "sSymbolName",
            "type": "PropString",
            "displayName": "|Symbol Name|",
            "defaultValue": "TXT",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "|Defines the SymbolName|",
            "note": "Condition: DialogMode == 3 (Add Symbol)"
          },
          {
            "index": 0,
            "variable": "nSymbolColor",
            "type": "PropInt",
            "displayName": "|Symbol Color|",
            "defaultValue": "0",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3"
            ],
            "category": "|General|",
            "description": "|Defines the SymbolColor|",
            "note": "Condition: DialogMode == 3"
          },
          {
            "index": 0,
            "variable": "sSymbolName",
            "type": "PropString",
            "displayName": "|Symbol Name|",
            "defaultValue": "sSymbolNames",
            "inputType": "dropdown",
            "options": "Dynamic (from mapSymbols)",
            "category": "|General|",
            "description": "|Defines the Symbol Name|",
            "note": "Condition: DialogMode == 4 (Remove Symbol)"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Add Hatch|",
            "handler": "|Add Hatch|",
            "action": "Opens OPM to define and add a new custom hatch (Material, Color, Transparency, Pattern, Scale, Angle).",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove Hatch|",
            "handler": "|Remove Hatch|",
            "action": "Opens OPM listing custom hatches; removes selected hatch from legend.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Erase All Custom Hatches|",
            "handler": "|Erase All Custom Hatches|",
            "action": "Removes all custom hatch definitions immediately.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Add Symbol|",
            "handler": "|Add Symbol|",
            "action": "Prompts entity selection, then opens OPM to define Symbol Name and Color.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove Symbol|",
            "handler": "|Remove Symbol|",
            "action": "Opens OPM listing custom symbols; removes selected symbol from legend.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove All Symbols|",
            "handler": "|Remove All Symbols|",
            "action": "Removes all symbol definitions immediately.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 9608,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a dynamic legend table displaying hatch patterns and symbols used in a specific view (Model, Layout, or Shop Draw space), allowing custom definitions for construction materials or annotations.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used during drawing production to generate a key for materials (e.g., timber grades, insulation) or machining symbols displayed in section cuts or elevation views."
        },
        "parameters": [
          {
            "name": "dTextHeight",
            "technicalDefault": "0",
            "businessMeaning": "Height of the text labels used to identify materials or symbols in the legend.",
            "validRange": "2.5 - 5.0 mm",
            "unit": "mm",
            "affectsOutput": "Scales the size of the description text in the legend table."
          },
          {
            "name": "nColumns",
            "technicalDefault": "1",
            "businessMeaning": "Number of vertical columns to organize legend items.",
            "validRange": "1 - 3",
            "unit": "count",
            "affectsOutput": "Arranges the list of hatches/symbols into multiple columns to optimize space usage on the drawing sheet."
          },
          {
            "name": "sColSizes",
            "technicalDefault": "",
            "businessMeaning": "Custom width for each column, separated by semicolons.",
            "validRange": "20 - 150 mm (depending on text length)",
            "unit": "mm",
            "affectsOutput": "Overrides default column width to ensure text fits or to align the legend with other drawing elements."
          },
          {
            "name": "sMaterial",
            "technicalDefault": "",
            "businessMeaning": "The name or code of the material/symbol (e.g., 'C24', 'Stud') displayed in the legend.",
            "validRange": "Standard material codes or abbreviations",
            "unit": "string",
            "affectsOutput": "Sets the text label next to the hatch or symbol in the legend."
          },
          {
            "name": "nColor",
            "technicalDefault": "1",
            "businessMeaning": "The display color (AutoCAD Index) for the hatch or symbol.",
            "validRange": "1 - 255",
            "unit": "index",
            "affectsOutput": "Determines the visual color of the solid fill, pattern lines, or symbol geometry."
          },
          {
            "name": "nTransparency",
            "technicalDefault": "0",
            "businessMeaning": "Transparency level of the hatch fill.",
            "validRange": "0 - 90%",
            "unit": "percent",
            "affectsOutput": "Controls how much the hatch obscures or reveals underlying geometry (if applicable)."
          },
          {
            "name": "sPattern",
            "technicalDefault": "_HatchPatterns",
            "businessMeaning": "The specific hatch pattern definition (e.g., SOLID, ANSI31).",
            "validRange": "Loaded .pat files",
            "unit": "string",
            "affectsOutput": "Defines the geometric style of the hatching (lines, dots, solid fill)."
          },
          {
            "name": "dScale",
            "technicalDefault": "0",
            "businessMeaning": "Scale factor for the hatch pattern density.",
            "validRange": "10 - 500",
            "unit": "factor",
            "affectsOutput": "Makes the pattern appear larger (coarser) or smaller (finer)."
          },
          {
            "name": "dAngle",
            "technicalDefault": "0",
            "businessMeaning": "Rotation angle of the hatch pattern.",
            "validRange": "0 - 360",
            "unit": "degrees",
            "affectsOutput": "Rotates the pattern lines relative to the horizontal axis."
          },
          {
            "name": "sSymbolName",
            "technicalDefault": "TXT",
            "businessMeaning": "Label identifying a custom user-added symbol.",
            "validRange": "Short descriptive text",
            "unit": "string",
            "affectsOutput": "Displays the name associated with a specific geometry block in the legend."
          },
          {
            "name": "nSymbolColor",
            "technicalDefault": "0",
            "businessMeaning": "Display color for the custom symbol.",
            "validRange": "1 - 255",
            "unit": "index",
            "affectsOutput": "Sets the color of the custom symbol geometry in the legend."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "DialogMode == 1 (Add Hatch)",
            "effect": "Activates properties to define a new custom hatch entry (Material, Color, Pattern, Scale, etc.).",
            "cascade": [
              "sMaterial",
              "nColor",
              "nTransparency",
              "sPattern",
              "dScale",
              "dAngle"
            ]
          },
          {
            "trigger": "DialogMode == 2 (Remove Hatch)",
            "effect": "Lists existing custom hatches in 'sMaterial' for selection to remove.",
            "cascade": [
              "sMaterial"
            ]
          },
          {
            "trigger": "DialogMode == 3 (Add Symbol)",
            "effect": "Activates properties to define a new custom symbol after selection.",
            "cascade": [
              "sSymbolName",
              "nSymbolColor"
            ]
          },
          {
            "trigger": "DialogMode == 4 (Remove Symbol)",
            "effect": "Lists existing custom symbols in 'sSymbolName' for selection to remove.",
            "cascade": [
              "sSymbolName"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "2D Geometry (PLine/Hatch)",
            "description": "Visual representation of the pattern or symbol in a grid layout.",
            "appliedTo": "Model Space, Paper Space, or Shop Draw Viewport"
          },
          {
            "type": "Text",
            "description": "Material name or symbol code labels.",
            "appliedTo": "Legend Table"
          }
        ]
      },
      "tokens_used": 9935,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization: Check execution context (Insert vs. Recalc/Trigger).",
          "2. [Insert Mode] Check Execute Key for catalog preset or display default dialog.",
          "3. Detect Active Space: Check for ShopDrawView entities or Layout Tab status.",
          "4. [Branch Model Space] Select Section2d entities via PrEntity prompt.",
          "5. [Branch Model Space] Create child TSL instances attached to selected sections.",
          "6. [Branch Model Space] Erase the initial script instance.",
          "7. [Branch ShopDraw] Select ShopDrawView via getShopDrawView prompt.",
          "8. [Branch Layout] Select Viewport via getViewport prompt.",
          "9. [Branch ShopDraw/Layout] Pick insertion point via getPoint.",
          "10. [Recalc/Context Menu Mode] Identify specific Execute Key (Add/Remove Hatch/Symbol).",
          "11. Execute Trigger Logic: Spawn temporary dialog instance or modify internal Maps.",
          "12. Generate Geometry: Draw PLine, Hatches, and Text based on Maps and View context.",
          "13. Script Completion."
        ],
        "conditionalBranches": [
          {
            "condition": "Active Space Context during Insertion",
            "path1": {
              "name": "Model Space",
              "steps": [
                "Prompt for Section2d selection.",
                "Iterate through selected entities.",
                "Create new TSL instance on each Section2d.",
                "Erase original instance."
              ]
            },
            "path2": {
              "name": "ShopDraw Space",
              "steps": [
                "Detect ShopDrawView entities in current block.",
                "Prompt user to select a ShopDrawView.",
                "Prompt for insertion point."
              ]
            },
            "path3": {
              "name": "Paper Space (Layout)",
              "steps": [
                "Detect Layout Tab status.",
                "Prompt user to select a Viewport.",
                "Prompt for insertion point."
              ]
            }
          },
          {
            "condition": "DialogMode (Execution Context)",
            "path1": {
              "name": "Standard Mode (0)",
              "steps": [
                "Expose layout properties: Text Height, Columns, Column Sizes.",
                "Generate legend drawing."
              ]
            },
            "path2": {
              "name": "Add Hatch (1)",
              "steps": [
                "Expose Hatch properties: Material, Color, Transparency, Pattern, Scale, Angle.",
                "Update 'mapHatchesCustom' with new entry."
              ]
            },
            "path3": {
              "name": "Remove Hatch (2)",
              "steps": [
                "Expose list of existing custom hatches.",
                "Remove selected entry from 'mapHatchesCustom'."
              ]
            },
            "path4": {
              "name": "Add Symbol (3)",
              "steps": [
                "Prompt for geometry selection.",
                "Expose Symbol properties: Name, Color.",
                "Update 'mapSymbols' with new entry."
              ]
            },
            "path5": {
              "name": "Remove Symbol (4)",
              "steps": [
                "Expose list of existing custom symbols.",
                "Remove selected entry from 'mapSymbols'."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "N/A (Silent)",
            "recovery": "Script automatically erases itself if insertCycleCount > 1 to prevent duplicates during Model Space processing."
          },
          {
            "check": "Custom Hatch Map Empty (Remove Hatch Trigger)",
            "errorMessage": "\"unexpected, no custom Hatch definition found\"",
            "recovery": "Instance is erased; user cannot open Remove dialog if no hatches exist."
          },
          {
            "check": "Custom Symbol Map Empty (Remove Symbol Trigger)",
            "errorMessage": "\"unexpected, no custom Hatch definition found\" (Note: Code message likely copy-paste error, implies symbol map check)",
            "recovery": "Instance is erased; user cannot open Remove dialog if no symbols exist."
          },
          {
            "check": "Material/Symbol Name Uniqueness",
            "errorMessage": "N/A (Automatic)",
            "recovery": "Script automatically replaces existing entry if a duplicate name (case-insensitive) is added."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Legend Layout",
            "how": "OPM (Object Properties Palette)",
            "effect": "Changing Text Height, Column count, or Column Sizes updates the table geometry."
          },
          {
            "action": "Add Custom Hatch",
            "how": "Context Menu -> Add Hatch",
            "effect": "Opens OPM to define properties. Adds new row to legend showing the custom pattern."
          },
          {
            "action": "Remove Custom Hatch",
            "how": "Context Menu -> Remove Hatch",
            "effect": "Opens OPM listing current hatches. Removing one deletes it from the legend."
          },
          {
            "action": "Erase All Custom Hatches",
            "how": "Context Menu -> Erase All Custom Hatches",
            "effect": "Clears all custom hatch definitions from the legend immediately."
          },
          {
            "action": "Add Custom Symbol",
            "how": "Context Menu -> Add Symbol",
            "effect": "Prompts entity selection, then OPM for name/color. Adds geometry to legend."
          },
          {
            "action": "Remove Custom Symbol",
            "how": "Context Menu -> Remove Symbol",
            "effect": "Opens OPM listing symbols. Removes selected symbol from legend."
          },
          {
            "action": "Remove All Symbols",
            "how": "Context Menu -> Remove All Symbols",
            "effect": "Clears all custom symbols from the legend immediately."
          }
        ]
      },
      "tokens_used": 11864,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbViewLegend.mcr\n\n## Overview\nThis script generates a dynamic legend table that displays hatch patterns and symbols used in a specific view. It is designed to help document materials and annotations within construction drawings, supporting custom definitions and operating in Model Space, Paper Space, or Shop Drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Requires selection of `Section2d` entities. The legend will attach to these sections. |\n| Paper Space | Yes | Requires selection of a Viewport. The legend is placed on the layout sheet. |\n| Shop Drawing | Yes | Requires selection of a Shop Drawing View. The legend is placed within the view. |\n\n## Prerequisites\n- **Required Entities**:\n  - **Model Space**: `Section2d` entities.\n  - **Paper Space**: A viewport (`Viewport`).\n  - **Shop Drawing**: A Shop Drawing View (`ShopDrawView`).\n- **Minimum beam count**: None (0).\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nRun the command `TSLINSERT` (or use the hsbCAD insert menu) and select `hsbViewLegend.mcr`.\n\n### Step 2: Select Context (Dependent on active space)\nThe script behavior changes based on your current location in AutoCAD:\n\n**Option A: In Model Space**\n```\nCommand Line: Select Section2d\nAction: Click on the Section2d entities (section cuts) you wish to associate with the legend.\nNote: The script will automatically attach a legend to each selected section and close the initial insertion command.\n```\n\n**Option B: In Shop Drawing Space**\n```\nCommand Line: Select ShopDrawView\nAction: Click inside the Shop Drawing View where you want the legend to appear.\n```\n\n**Option C: In Paper Space (Layout Tab)**\n```\nCommand Line: Select a viewport\nAction: Click on the viewport border that represents the view you want to document.\n```\n\n### Step 3: Place Legend\n*(For Shop Drawing and Paper Space flows)*\n```\nCommand Line: Pick insertion point\nAction: Click on the drawing sheet to position the top-left corner of the legend table.\n```\n\n### Step 4: Configure Appearance\nSelect the newly created legend and open the **Properties Palette** (Ctrl+1) to adjust text height, column count, or add custom items.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Text Height** | Number | 0 | Sets the height of the text labels in the legend. |\n| **Columns** | Dropdown (1, 2, 3) | 1 | Defines how many vertical columns the legend uses to display items. |\n| **Column Sizes** | String | Empty | Defines the width of columns in millimeters, separated by semicolons (e.g., `50;20`). |\n| **Material** | String | Empty | The name label for a hatch or symbol (e.g., \"C24\", \"Insulation\"). |\n| **Color** | Dropdown | 1 | The AutoCAD color index for the hatch or symbol. |\n| **Transparency** | Dropdown | 0 | The transparency level (0-90) for solid hatches. |\n| **Pattern** | Dropdown | _HatchPatterns | The hatch pattern style (e.g., SOLID, ANSI31). |\n| **Scale** | Number | 0 | The scale factor for the hatch pattern density. |\n| **Angle** | Number | 0 | The rotation angle of the hatch pattern (in degrees). |\n| **Symbol Name** | String | TXT | The label text for a custom symbol entry. |\n| **Symbol Color** | Dropdown | 0 | The display color for a custom symbol. |\n\n## Right-Click Menu Options\n\nSelect the legend and right-click to access the following context menu options:\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Add Hatch** | Opens the Properties Palette to define a new custom hatch pattern (Material, Pattern, Color, etc.) and adds it to the legend. |\n| **Remove Hatch** | Opens the Properties Palette listing all current custom hatches. Select one to remove it from the legend. |\n| **Erase All Custom Hatches** | Immediately deletes all custom hatch definitions from the legend. |\n| **Add Symbol** | Prompts you to select geometry/entities in the drawing, then adds them as a symbol entry in the legend. |\n| **Remove Symbol** | Opens the Properties Palette listing custom symbols. Select one to remove it. |\n| **Remove All Symbols** | Immediately deletes all custom symbol definitions from the legend. |\n\n## Settings Files\n- **Filename**: N/A\n- **Location**: N/A\n- **Purpose**: This script does not rely on external XML settings files.\n\n## Tips\n- **Column Alignment**: Use the `Column Sizes` property to manually define widths if the default automatic sizing doesn't align well with your title block or other notes.\n- **Model Space Workflow**: When used in Model Space, this script acts as a \"batch\" tool. Selecting 5 sections will automatically create 5 separate legend instances, one attached to each section.\n- **Text Height**: If `Text Height` is set to 0, the script may use a default internal value; it is recommended to explicitly set this to your drawing standard (e.g., 2.5mm or 3.0mm) for consistency.\n\n## FAQ\n- **Q: Can I add my own custom hatch patterns that aren't in the default list?**\n  - A: You can select any pattern name loaded in AutoCAD by typing it into the `Pattern` property, or select from the dropdown which lists available patterns.\n- **Q: How do I move the legend after inserting it?**\n  - A: Simply select the legend and use the standard AutoCAD Move command or drag the grip points.\n- **Q: What happens if I select the wrong Viewport?**\n  - A: You can delete the legend instance and run the script again, or if the script allows, check the Properties to see if it can be reassigned (usually re-running is safer)."
      },
      "tokens_used": 8168,
      "error": null
    }
  }
}