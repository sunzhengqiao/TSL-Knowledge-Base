{
  "filename": "NA_BUNDLE.mcr",
  "status": "completed",
  "total_tokens": 55074,
  "processing_time": 220.4448845386505,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6895,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses `_kModel` for entity collection (`Entity ents[] = gr.collectEntities(FALSE,TslInst(),_kModel);`) and `getPoint` for insertion, indicating Model Space interaction. It creates and manages `Group` objects and `TslInst` directly in the model environment. There are no Shop Drawing specific API calls (like `sd_` functions) or references to viewports/paper space entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "TslInst",
            "Element",
            "Beam",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing TslInst entities (often generated by other scripts) that have map entries 'mpStackChildPanel'.",
          "requiredSettings": [
            "moProfInv.map",
            "mpNameList",
            "mpSheathing"
          ]
        }
      },
      "tokens_used": 5978,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": \"No prompt (immediate dialog)\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select an insertion point\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDynamicDialog\",\n      \"trigger\": \"On Script Insert (_bOnInsert)\",\n      \"title\": \"Properties\",\n      \"dataSource\": \"OPM Properties (PropDouble/PropInt/PropString)\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"iSetNumber\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Set Number\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Shippement\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"iTruckNumber\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Truck Number\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Shippement\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"strJustificationSide\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Wall Justification\",\n      \"defaultValue\": \"Left\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Left\",\n        \"Center\",\n        \"Right\"\n      ],\n      \"category\": \"Trailor Properties\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dStackWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Max Width\",\n      \"defaultValue\": 6000.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Trailor Properties\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dStackHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Max Height\",\n      \"defaultValue\": 1500.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Trailor Properties\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"strAutoBehavior\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Automatic Behavior\",\n      \"defaultValue\": \"Apply Justification\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"None\",\n        \"Apply Justification\",\n        \"Fully Automatic\"\n      ],\n      \"category\": \"Trailor Properties\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"strShowDim\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Show Dimension\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Dimensions\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"strDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"DimStyle\",\n      \"defaultValue\": \"System Default\",\n      \"inputType\": \"dropdown\",\n      \"options\": \"System DimStyles\",\n      \"category\": \"Dimensions\",\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dDimOff\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Dim Offset\",\n      \"defaultValue\": 600.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Dimensions\",\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"strShowStkPrfix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Show Bundle Prefix\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Display Properies\",\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"strStkPrefix\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Bundle Prefix\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Display Properies\",\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"strCustomText\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Cutom Text\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Display Properies\",\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"stTopLeft\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Info Top Left\",\n      \"defaultValue\": \"Project Name\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \" \",\n        \"Project Name\",\n        \"Project Number\",\n        \"Project Name - Number\",\n        \"Bundle Number\",\n        \"Custom Text\",\n        \"Bundle/Quantity\",\n        \"Bundle Depth\",\n        \"Weight\",\n        \"Wall LnFt\",\n        \"Wall LnFt by Sheathing\",\n        \"Wall BdFt\",\n        \"Truck Number\",\n        \"Set Number\",\n        \"Panel/Quantity\"\n      ],\n      \"category\": \"Display Proper"
      },
      "tokens_used": 10244,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"This script creates a visual representation of a shipping bundle (truck load) of wall panels, calculating totals and generating labels for logistics.\",\n    \"category\": \"Logistics / Shipping\",\n    \"typicalUseCase\": \"Used by a pre-cut manager or estimator to organize prefabricated wall panels into trailer bundles, ensuring they fit within truck dimensions and providing weight/counts for shipping manifests.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"iSetNumber\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Identifies the specific shipment set if the total project requires multiple trucks or deliveries.\",\n      \"validRange\": \"1 to 99\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Included in the bundle label data if the display property is set to 'Set Number'.\"\n    },\n    {\n      \"name\": \"iTruckNumber\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Identifies the specific truck or trailer ID for the logistics team.\",\n      \"validRange\": \"1 to 999\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Included in the bundle label data if the display property is set to 'Truck Number'.\"\n    },\n    {\n      \"name\": \"strJustificationSide\",\n      \"technicalDefault\": \"Left\",\n      \"businessMeaning\": \"Controls how panels are aligned horizontally within the bundle width (Left, Center, or Right).\",\n      \"validRange\": \"Left, Center, Right\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Modifies the X-coordinates of the panels within the generated stack to match the chosen alignment.\"\n    },\n    {\n      \"name\": \"dStackWidth\",\n      \"technicalDefault\": \"6000.0\",\n      \"businessMeaning\": \"The maximum available width of the truck bed or storage crib for this bundle.\",\n      \"validRange\": \"96.0 to 120.0 (inches)\",\n      \"unit\": \"inches/mm\",\n      \"affectsOutput\": \"Defines the horizontal boundary of the stack. Used to determine if the bundle is full and to limit panel placement.\"\n    },\n    {\n      \"name\": \"dStackHeight\",\n      \"technicalDefault\": \"1500.0\",\n      \"businessMeaning\": \"The maximum allowable height of the bundle stack.\",\n      \"validRange\": \"48.0 to 144.0 (inches)\",\n      \"unit\": \"inches/mm\",\n      \"affectsOutput\": \"Defines the vertical boundary of the stack. Used to limit how many rows of panels are stacked.\"\n    },\n    {\n      \"name\": \"strAutoBehavior\",\n      \"technicalDefault\": \"Apply Justification\",\n      \"businessMeaning\": \"Determines how aggressively the script organizes the panels. 'None' only calculates stats. 'Apply Justification' aligns panels. 'Fully Automatic' attempts to pack the trailer space.\",\n      \"validRange\": \"None, Apply Justification, Fully Automatic\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Controls the execution of the stacking/nesting logic that moves panels into the bundle area.\"\n    },\n    {\n      \"name\": \"strShowDim\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the visibility of the overall bundle dimension lines.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Shows or hides CAD dimension lines indicating the width and height of the bundle.\"\n    },\n    {\n      \"name\": \"strDimStyle\",\n      \"technicalDefault\": \"System Default\",\n      \"businessMeaning\": \"Selects the CAD dimension style to use for bundle dimensions.\",\n      \"validRange\": \"System DimStyles\",\n      \"unit\": \"style\",\n      \"affectsOutput\": \"Changes the arrow style, text size, and format of the drawn dimensions.\"\n    },\n    {\n      \"name\": \"dDimOff\",\n      \"technicalDefault\": \"600.0\",\n      \"businessMeaning\": \"The distance the dimension lines are offset from the physical bundle.\",\n      \"validRange\": \"12.0 to 48.0 (inches)\",\n      \"unit\": \"inches/mm\",\n      \"affectsOutput\": \"Moves the dimension text and lines closer to or further from the stack.\"\n    },\n    {\n      \"name\": \"strShowStkPrfix\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the use of the user-defined Bundle ID prefix.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Enables or disables the prefix text in the bundle label display.\"\n    },\n    {\n      \"name\": \"strStkPrefix\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A text prefix for the Bundle ID (e.g., 'TRLR' for Trailer).\",\n      \"validRange\": \"Text string (short)\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Prepends text to the calculated bundle number in the display labels.\"\n    },\n    {\n      \"name\": \"strCustomText\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"User-defined free text to be displayed in the labels (e.g., 'Site A' or 'Urgent').\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Displays the entered text in any label slot configured to show 'Custom Text'.\"\n    },\n    {\n      \"name\": \"stTopLeft / stTopRight / etc.\",\n      \"technicalDefault\": \"Project Name / Bundle Number\",\n      \"businessMeaning\": \"Selects which data attribute (Weight, Project Name, Quantity, etc.) to display in a specific label location.\",\n      \"validRange\": \"List of Data Attributes (Project Name, Weight, LnFt, etc.)\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Updates the text content of the drawn label at the specified position.\"\n    },\n    {\n      \"name\": \"stTopLeftPF / etc.\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"A text label or unit indicator that precedes the data value (e.g., 'Wt: ' or 'Qty: ').\",\n      \"validRange\": \"Text string\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Adds a prefix to the dynamic data displayed on the bundle tag.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"dStackWidth\",\n      \"effect\": \"Constrains the horizontal space available for panel placement.\",\n      \"cascade\": [\n        \"strAutoBehavior\"\n      ]\n    },\n    {\n      \"trigger\": \"strAutoBehavior\",\n      \"effect\": \"Determines if the strJustificationSide logic is ignored (None) or applied.\",\n      \"cascade\": [\n        \"strJustificationSide\"\n      ]\n    },\n    {\n      \"trigger\": \"stTopLeft (and similar display props)\",\n      \"effect\": \"Requires that the corresponding data type has been calculated (e.g., Weight requires Beams/Sheets in the bundle).\",\n      \"cascade\": [\n        \"dTotalWeight\",\n        \"dWallLnFtSheathed\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Group\",\n      \"description\": \"Creates a container group named 'X - STACKER' marked as a deliverable, representing the physical bundle.\",\n      \"appliedTo\": \"Selected TslInst (Panels)\"\n    },\n    {\n      \"type\": \"PLine\",\n      \"description\": \"Draws a rectangular outline representing the Max Width and Max Height of the bundle area.\",\n      \"appliedTo\": \"Model Space at insertion point\"\n    },\n    {\n      \"type\": \"Text\",\n      \"description\": \"Draws shipping labels at Top, Bottom, and Side positions containing Project info, Weight, Counts, etc.\",\n      \"appliedTo\": \"Model Space relative to the stack rectangle\"\n    },\n    {\n      \"type\": \"Dim\",\n      \"description\": \"Draws dimension lines"
      },
      "tokens_used": 11336,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 13295,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# NA_BUNDLE.mcr\n\n## Overview\nThis script creates a visual representation and logistics report for shipping bundles (truck loads) of wall panels. It organizes panels, calculates total weights and dimensions, and generates shipping labels with customizable data fields.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script collects wall panel entities (TslInst) and draws the bundle layout in the 3D model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: Wall panels (TslInst) that have been previously generated and contain map entries for 'mpStackChildPanel'.\n- **Minimum Beam Count**: 0 (Operates on Panel instances).\n- **Required Settings**:\n    - `moProfInv.map`: Profile inventory mapping.\n    - `mpNameList`: Naming conventions.\n    - `mpSheathing`: Sheathing material data.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `NA_BUNDLE.mcr`\n\n### Step 2: Configure Bundle Properties\n```\nInterface: Properties Palette (OPM)\nAction: Set the Set Number, Truck Number, and dimensions (Width/Height) to match your shipping constraints.\n```\n\n### Step 3: Insert Bundle\n```\nCommand Line: Select an insertion point\nAction: Click in the Model Space where you want the bundle visualization and label to appear.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Shipment** | | | |\n| Set Number | Number | 1 | Identifier for the specific shipment set (if multiple deliveries are required). |\n| Truck Number | Number | 1 | Identifier for the specific truck or trailer ID. |\n| **Trailer Properties** | | | |\n| Wall Justification | Dropdown | Left | Aligns panels to the Left, Center, or Right within the truck width. |\n| Max Width | Number | 6000.0 | Maximum available width of the truck bed (usually in mm). |\n| Max Height | Number | 1500.0 | Maximum allowable stack height (usually in mm). |\n| Automatic Behavior | Dropdown | Apply Justification | Controls how panels are organized: 'None' (calc only), 'Apply Justification', or 'Fully Automatic' (pack trailer). |\n| **Dimensions** | | | |\n| Show Dimension | Dropdown | Yes | Toggles visibility of the bundle width and height dimensions. |\n| DimStyle | Dropdown | System Default | Selects the CAD dimension style for the drawn dimensions. |\n| Dim Offset | Number | 600.0 | Distance from the bundle geometry to the dimension lines. |\n| **Display Properties** | | | |\n| Show Bundle Prefix | Dropdown | Yes | Toggles the visibility of the user-defined prefix. |\n| Bundle Prefix | Text | | Prefix text for the Bundle ID (e.g., \"TRLR-\"). |\n| Custom Text | Text | | Free text for labels (e.g., \"Site A\" or \"Urgent\"). |\n| Info Top Left | Dropdown | Project Name | Selects data to display in the top-left label (e.g., Weight, Qty, Project Name). |\n| Info Top Right | Dropdown | Bundle Number | Selects data to display in the top-right label. |\n| Info Btm Left | Dropdown | | Selects data to display in the bottom-left label. |\n| Info Btm Right | Dropdown | | Selects data to display in the bottom-right label. |\n| Info Side Left | Dropdown | | Selects data to display on the left side label. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the bundle visualization if underlying panels have been modified or properties changed. |\n\n## Settings Files\n- **Filenames**: `moProfInv.map`, `mpNameList`, `mpSheathing`\n- **Location**: Company or Install path (defined in hsbCAD configuration).\n- **Purpose**: These files provide the necessary material lists, profile mappings, and naming logic required to calculate weights and dimensions correctly.\n\n## Tips\n- Ensure your wall panels are created and visible in the Model Space before inserting the bundle.\n- If panels are not moving as expected, check the **Automatic Behavior** property. If it is set to \"None\", the script will only calculate statistics without moving the panels.\n- Use the **Fully Automatic** mode to let the script attempt to pack panels efficiently within the defined Max Width and Height.\n\n## FAQ\n- Q: What units are used for Width and Height?\n  A: The script typically uses millimeters (internal standard), so a width of 6000 represents 6 meters.\n- Q: Can I label the bundle with specific project information?\n  A: Yes. Use the \"Display Properties\" (e.g., Info Top Left) dropdowns to select \"Project Name\", \"Project Number\", \"Weight\", or other data fields to display on the bundle tag.\n- Q: Why are my panels not aligning?\n  A: Ensure that the **Wall Justification** is set to the desired side (Left/Center/Right) and that **Automatic Behavior** is not set to \"None\"."
      },
      "tokens_used": 7326,
      "error": null
    }
  }
}