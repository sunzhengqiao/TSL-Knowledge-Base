{
  "filename": "HSB_R-RafterBlocking.mcr",
  "status": "completed",
  "total_tokens": 56662,
  "processing_time": 312.1848304271698,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": \"\",\n    \"numBeamsReq\": null,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \"minorVersion\": 7,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"This TSL creates blocking next to rafters.\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.00\",\n      \"date\": \"20.04.2017\",\n      \"author\": \"YB\",\n      \"changes\": \"Pilot version\"\n    },\n    {\n      \"version\": \"1.01\",\n      \"date\": \"20.04.2017\",\n      \"author\": \"YB\",\n      \"changes\": \"Added a beamcut\"\n    },\n    {\n      \"version\": \"1.02\",\n      \"date\": \"01.06.2017\",\n      \"author\": \"YB\",\n      \"changes\": \"Changed the way how rafters are selected, now uses Beam Type instead of HsbID. Removed HsbId property. Rotated length and width of blocking. Set standard blocking length to rafter height. Added bottom offset from reference point. Changed the beamcut positioning. Added a display option.\"\n    },\n    {\n      \"version\": \"1.03\",\n      \"date\": \"01.06.2017\",\n      \"author\": \"YB\",\n      \"changes\": \"Added an option to offset from top instead of bottom. Changed the way the blockings are positioned in Y axis.\"\n    },\n    {\n      \"version\": \"1.04\",\n      \"date\": \"01.06.2017\",\n      \"author\": \"AS\",\n      \"changes\": \"Assign tsl to the element. Position grippoint at the center of the milling.\"\n    },\n    {\n      \"version\": \"1.05\",\n      \"date\": \"06.07.2017\",\n      \"author\": \"YB\",\n      \"changes\": \"Changed point where intersections get found\"\n    },\n    {\n     "
      },
      "tokens_used": 8743,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script generates 3D geometry (Blocking Beams) using 'Beam.dbCreate()'. Explicitly uses '_kModelSpace' during instance creation in the insert block. No usage of '_Viewport', 'sdOpen', or other Paper/ShopDrawing specific APIs. The script acts as a generator for physical timber elements based on a selected element."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": []
        }
      },
      "tokens_used": 6955,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select a set of elements.|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"propBlockingLength\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Blocking length|\",\n      \"defaultValue\": \"U(100)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Blocking information|\",\n      \"description\": \"|Specifies the blocking length.|If value is 0, default rafter height is used.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"propBlockingHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Blocking height|\",\n      \"defaultValue\": \"U(20)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Blocking information|\",\n      \"description\": \"|Specifies the blocking height.|If value is 0, default rafter height is used.|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"propBlockingWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Blocking width|\",\n      \"defaultValue\": \"U(20)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Blocking information|\",\n      \"description\": \"|Specifies the blocking width.|If value is 0, default rafter width is used.|\"\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"sBlockingReference\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Blocking reference|\",\n      \"defaultValue\": \"|Top|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Top|\",\n        \"|Bottom|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": \"|Specifies the blocking reference|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dVerticalOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Blocking vertical offset|\",\n      \"defaultValue\": \"U(500)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Positioning|\",\n      \"description\": \"|Specifies the bottom offset for the blocking.|\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sBlockingOptions\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Blocking position|\",\n      \"defaultValue\": \"|Left side only|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Left side only|\",\n        \"|Left and right side|\",\n        \"|Right side|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": \"|Specifies the positions of the blockings.|If blocking position is left side only, first rafter will be skipped automatically.|If blocking position is right side only, last rafter will be skipped automatically.|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sAlternateBlocking\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Alternate blocking|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": \"|Specifies if the blocking should alternate.|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sSkipFirstBlocking\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Skip first rafter|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Positioning|\",\n      \"description\": \"|Specifies if the first rafter should be skipped.|\"\n    },\n   "
      },
      "tokens_used": 9935,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Generates blocking (noggins) between rafters or between rafters and a supporting element to prevent rotation and distribute loads.\",\n    \"category\": \"Framing\",\n    \"typicalUseCase\": \"Adding structural blocking between roof rafters or attaching rafters to a top plate/ridge beam to ensure stability.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"propBlockingLength\",\n      \"technicalDefault\": \"U(100)\",\n      \"businessMeaning\": \"The length of the blocking piece along the axis of the rafter.\",\n      \"validRange\": \"0 to 3000 mm (0 defaults to rafter height)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Changes the longitudinal dimension of the generated blocking beams.\"\n    },\n    {\n      \"name\": \"propBlockingHeight\",\n      \"technicalDefault\": \"U(20)\",\n      \"businessMeaning\": \"The thickness/height of the blocking in the vertical direction relative to the blocking orientation.\",\n      \"validRange\": \"0 to 300 mm (0 defaults to rafter width)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Changes the cross-sectional height of the blocking.\"\n    },\n    {\n      \"name\": \"propBlockingWidth\",\n      \"technicalDefault\": \"U(20)\",\n      \"businessMeaning\": \"The width of the blocking perpendicular to both the rafter and the blocking height.\",\n      \"validRange\": \"0 to 300 mm (0 defaults to rafter height)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Changes the cross-sectional width of the blocking.\"\n    },\n    {\n      \"name\": \"sBlockingReference\",\n      \"technicalDefault\": \"|Top|\",\n      \"businessMeaning\": \"Determines whether the vertical offset is calculated from the Top edge or the Bottom edge of the selected element/rafter.\",\n      \"validRange\": \"Top, Bottom\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Flips the calculation logic for the blocking's vertical placement.\"\n    },\n    {\n      \"name\": \"dVerticalOffset\",\n      \"technicalDefault\": \"U(500)\",\n      \"businessMeaning\": \"The distance from the Reference (Top/Bottom) to the center of the blocking row.\",\n      \"validRange\": \"0 to 2000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Moves the row of blockings up or down along the rafter depth.\"\n    },\n    {\n      \"name\": \"sBlockingOptions\",\n      \"technicalDefault\": \"|Left side only|\",\n      \"businessMeaning\": \"Specifies on which side of the reference point/line the blockings are generated.\",\n      \"validRange\": \"Left, Right, Both\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Determines the quantity and position of blocking elements relative to the reference line.\"\n    },\n    {\n      \"name\": \"sAlternateBlocking\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"If enabled, creates a staggered pattern of blockings (e.g., one left, one right) instead of a continuous row.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Changes the spacing and position logic, creating a zigzag pattern.\"\n    },\n    {\n      \"name\": \"sSkipFirstBlocking\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Optionally skips creating a blocking at the start of the run.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Removes the first blocking in the sequence.\"\n    },\n    {\n      \"name\": \"sBlockingFilter\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"HSB ID used to identify and remove existing blocking elements generated by this script (cleanup filter).\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Controls which existing beams are erased when regenerating.\"\n    },\n    {\n      \"name\": \"filterBeamCodes\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"List of beam codes to exclude from the rafter selection process.\",\n      \"validRange\": \"String list\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Filters which beams are considered valid targets for blocking.\"\n    },\n    {\n      \"name\": \"bmColor\",\n      \"technicalDefault\": \"52\",\n      \"businessMeaning\": \"The CAD color of the generated blocking beams.\",\n      \"validRange\": \"0-255\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Visual appearance of the beams.\"\n    },\n    {\n      \"name\": \"bmName\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The Name attribute assigned to the blocking beams for BIM/data purposes.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Entity properties.\"\n    },\n    {\n      \"name\": \"bmMaterial\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The Material specification (e.g., C24) of the blocking beams.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Entity properties and potentially reports/costs.\"\n    },\n    {\n      \"name\": \"bmGrade\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The Grade of the timber used for blocking.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Entity properties.\"\n    },\n    {\n      \"name\": \"bmInformation\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Additional information text stored on the blocking beams.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Entity properties.\"\n    },\n    {\n      \"name\": \"bmLabel\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The primary label/emark for the blocking.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Labels on drawings and reports.\"\n    },\n    {\n      \"name\": \"bmSubLabel\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Secondary label for the blocking.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Labels on drawings and reports.\"\n    },\n    {\n      \"name\": \"bmSubLabel2\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Tertiary label for the blocking.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Labels on drawings and reports.\"\n    },\n    {\n      \"name\": \"bmBeamcode\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The Beamcode assigned to the blocking for classification.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Classification and reporting.\"\n    },\n    {\n      \"name\": \"bmHSBID\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"The HSB ID (internal identifier) assigned to the blocking.\",\n      \"validRange\": \"String\",\n      \"unit\": \"text\",\n      \"affectsOutput\": \"Script interaction and filtering.\"\n    },\n    {\n      \"name\": \"sToolType\",\n      \"technicalDefault\": \"|No tool|\",\n      \"businessMeaning\": \"Defines if a tooling operation (Beamcut) is added to the blocking.\",\n      \"validRange\": \"No tool, Beamcut\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Adds a subtraction (milling) to the blocking geometry.\"\n    },\n    {\n      \"name\": \"sToolDepth\",\n      \"technicalDefault\": \"U(5)\",\n      \"businessMeaning\": \"The depth of the beamcut/milling into the blocking.\",\n      \"validRange\": \"0 to 100 mm\",\n      \"unit\": \""
      },
      "tokens_used": 10570,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via command or catalog.",
          "Initialization: Catalog names retrieved. If execute key exists in catalog, properties are set from catalog.",
          "Insertion Phase Start: Check if _bOnInsert is true.",
          "Cycle Check: If insertCycleCount > 1, erase instance and exit (prevents duplicate runs).",
          "Dialog Phase: If no execute key or key not found in catalog, show Dialog (TslUtilities).",
          "Catalog Update: Set current property values as '_LastInserted' catalog.",
          "User Input: Prompt user to 'Select a set of elements' (PrEntity).",
          "Input Validation: If user cancels prompt or selects nothing, erase instance and exit.",
          "Element Iteration: Loop through selected elements.",
          "Instance Creation: For each valid element, create a new TSL instance attached to that element in ModelSpace using dbCreate.",
          "Cleanup: Erase the temporary insert instance.",
          "Execution Phase Start: _bOnInsert is false. Running on specific element instances.",
          "Element Validation: Verify exactly 1 Element is linked. If not, report warning and erase instance.",
          "Map Initialization: Load map properties (created beams, etc.).",
          "Property Mapping: Read user properties (Blocking length/height/width, reference, offset, options, tooling, etc.).",
          "Beam Extraction: Extract all beams from the linked Element.",
          "Beam Filtering: Filter beams based on 'Rafters - Beam codes' property (exclude specified codes).",
          "Geometry Calculation: Determine Element coordinate system (Org, X, Y, Z). Calculate standard rafter length and total profile of rafters.",
          "Blocking Dimensions: Set blocking dimensions. If 0, use rafter dimensions.",
          "Offset Calculation: Calculate vertical offset based on 'Blocking reference' (Top/Bottom).",
          "Profile Processing: Create a total profile from all rafter envelopes. Shrink profile slightly.",
          "Intersection Logic: Create a long line segment at the calculated offset. Split the total profile with this line to determine valid blocking positions (segments).",
          "Loop Through Segments: Iterate through calculated line segments where blocking could occur.",
          "Skipping Logic: Apply 'Skip first rafter' and 'Alternate blocking' logic to determine step size.",
          "Blocking Generation: For each valid position, determine Left/Right placement based on 'Blocking position' property.",
          "Create Beam: Use Beam.dbCreate to generate the blocking solid with dimensions and calculated position.",
          "Assign Attributes: Set Color, Name, Material, Grade, etc., to the new blocking beam. Assign to Element group.",
          "Tooling Logic: If 'Tool type' is 'Beamcut', create a BeamCut operation on the blocking beam.",
          "Map Update: Add new blocking beam to the script Map.",
          "Visualization: Draw 3D and Plan view symbols representing the blocking position and script name.",
          "End: Script completes."
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Count",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Erase instance",
                "Return"
              ]
            },
            "path2": {
              "name": "Cycle = 1",
              "steps": [
                "Proceed to Dialog/Catalog logic"
              ]
            }
          },
          {
            "condition": "Catalog Execute Key",
            "path1": {
              "name": "Key Exists",
              "steps": [
                "Load properties from Catalog",
                "Skip Dialog"
              ]
            },
            "path2": {
              "name": "Key Missing",
              "steps": [
                "Show Dialog",
                "User inputs settings"
              ]
            }
          },
          {
            "condition": "Element Selection (Insertion)",
            "path1": {
              "name": "Valid Selection",
              "steps": [
                "Create instances for each element",
                "Erase temporary instance"
              ]
            },
            "path2": {
              "name": "Selection Cancelled/Empty",
              "steps": [
                "Erase instance",
                "Exit"
              ]
            }
          },
          {
            "condition": "Linked Element Count (Execution)",
            "path1": {
              "name": "Count != 1",
              "steps": [
                "Report Warning: 'No element selected!'",
                "Erase instance",
                "Exit"
              ]
            },
            "path2": {
              "name": "Count == 1",
              "steps": [
                "Proceed to beam extraction"
              ]
            }
          },
          {
            "condition": "Blocking Position Options",
            "path1": {
              "name": "Left side only",
              "steps": [
                "Generate blocking on Left side of segments",
                "Skip segment at index 0"
              ]
            },
            "path2": {
              "name": "Left and right side",
              "steps": [
                "Generate blocking on Both sides of segments",
                "Skip index 0 Left, Skip Last index Right"
              ]
            },
            "path3": {
              "name": "Right side",
              "steps": [
                "Generate blocking on Right side of segments",
                "Skip segment at Last Index"
              ]
            }
          },
          {
            "condition": "Tool Type",
            "path1": {
              "name": "No Tool",
              "steps": [
                "Create Blocking Beam",
                "Exit Loop"
              ]
            },
            "path2": {
              "name": "Beamcut",
              "steps": [
                "Create Blocking Beam",
                "Calculate Drill Position based on Offset",
                "Add BeamCut to Beam"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Linked Element Count",
            "errorMessage": "|No element selected!|",
            "recovery": "User must select the script instance and link it to a valid Element/Construct using properties or re-insert correctly."
          },
          {
            "check": "Rafter Availability",
            "errorMessage": "Implicit (No blocking generated)",
            "recovery": "Ensure the selected Element contains valid beams that are not filtered out by 'Rafters - Beam codes'."
          },
          {
            "check": "Filter Beam Codes",
            "errorMessage": "Implicit (Beams excluded)",
            "recovery": "Check 'Rafters - Beam codes' property to ensure desired beams are not being excluded by mistake."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Dimensions",
            "how": "OPM Properties (Blocking information category)",
            "effect": "Updates Blocking Length, Height, and Width. Regenerates geometry."
          },
          {
            "action": "Adjust Position",
            "how": "OPM Properties (Positioning category)",
            "effect": "Updates Vertical Offset, Reference (Top/Bottom), and Side options. Regenerates blocking positions."
          },
          {
            "action": "Change Pattern",
            "how": "OPM Properties (Positioning category)",
            "effect": "Toggles Alternate blocking or Skip first rafter. Changes arrangement of blockings."
          },
          {
            "action": "Update Attributes",
            "how": "OPM Properties (Beam properties category)",
            "effect": "Updates Material, Grade, Label, Color, etc., of the generated blocking beams."
          },
          {
            "action": "Toggle Tooling",
            "how": "OPM Properties (Tooling category)",
            "effect": "Adds or removes Beamcut operations from the blocking beams."
          }
        ]
      },
      "tokens_used": 11586,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_R-RafterBlocking\n\n## Overview\nThis script automatically generates blocking (noggins) between rafters or between rafters and a supporting element. It is used to prevent rotation of rafters and distribute loads by creating physical timber beams based on a selected roof element.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script generates 3D geometry in the model. |\n| Paper Space | No | Not applicable for 2D drawings. |\n| Shop Drawing | No | Not applicable for shop drawings. |\n\n## Prerequisites\n- **Required Entities**: An Element (e.g., a roof plane or construct) containing rafter beams.\n- **Minimum Beam Count**: 1 or more beams within the selected element.\n- **Required Settings**: None (uses default internal settings or catalog presets if available).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `HSB_R-RafterBlocking.mcr`.\n\n### Step 2: Select Configuration\nDialog: If a default catalog entry is not configured, a dialog may appear to set initial parameters.\nAction: Configure Blocking dimensions, Positioning, and Tooling as needed, then click OK.\n\n### Step 3: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the roof Element or Construct containing the rafters where blocking should be applied. Press Enter to confirm.\n```\n\n### Step 4: Adjust Parameters (Optional)\nAction: Select the generated script instance (represented by a grip point) and modify parameters in the Properties Palette (OPM) to fine-tune the blocking layout.\n\n## Properties Panel Parameters\n\n### Blocking Information\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Blocking length | Number | 100 mm | Length of the blocking along the rafter. Set to 0 to use the rafter height automatically. |\n| Blocking height | Number | 20 mm | Thickness of the blocking (vertical direction). Set to 0 to use the rafter width automatically. |\n| Blocking width | Number | 20 mm | Width of the blocking. Set to 0 to use the rafter height automatically. |\n\n### Positioning\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Blocking position | Dropdown | Left side only | Options: Left side only, Left and right side, Right side. Determines where blocks are placed relative to rafters. |\n| Blocking reference | Dropdown | Top | Options: Top, Bottom. Calculates the vertical offset from either the top or bottom edge of the rafter. |\n| Blocking vertical offset | Number | 500 mm | Distance from the reference edge (Top/Bottom) to the center of the blocking. |\n| Alternate blocking | Dropdown | No | Options: Yes, No. If Yes, creates a staggered zigzag pattern. |\n| Skip first rafter | Dropdown | No | Options: Yes, No. If Yes, omits the blocking at the very start of the run. |\n\n### Tooling\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Tool type | Dropdown | No tool | Options: No tool, Beamcut. If set to Beamcut, adds a milling operation to the blocking. |\n| Tool depth | Number | 5 mm | Depth of the beamcut/milling. |\n| Tool offset | Number | 0 mm | Offset position of the tool. |\n| Tool diameter | Number | 0 mm | Diameter of the tool used for the cut. |\n\n### Beam Properties\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Color | Number | 52 | AutoCAD color index for the blocking beams. |\n| Name | String | Empty | BIM Name attribute. |\n| Material | String | Empty | Material specification (e.g., C24). |\n| Grade | String | Empty | Timber grade. |\n| Label | String | Empty | Primary label for drawings/reports. |\n| Beamcode | String | Empty | Classification code for reporting. |\n\n### Filtering\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Rafters - Beam codes | String | Empty | List of beam codes to EXCLUDE from blocking generation. Use this to ignore top plates or trimmers. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the blocking geometry based on current property changes. |\n| Show Catalog | Allows selection of a predefined catalog configuration. |\n| Erase | Removes the script instance and all generated blocking. |\n\n## Settings Files\n- **Filename**: `HSB_R-RafterBlocking.xml` (or similar catalog name)\n- **Location**: Company or Install path (Catalog folder)\n- **Purpose**: Stores saved configurations (Execute Keys) so users can quickly reload specific blocking settings without re-entering values.\n\n## Tips\n- **Automatic Dimensions**: Set Blocking Length, Height, or Width to `0` to automatically match the corresponding dimension of the rafter (e.g., setting Length to 0 makes the block as long as the rafter is deep).\n- **Filtering Plates**: If the script is creating blocking on your top plates or ridge beams, add those beam codes to the \"Rafters - Beam codes\" filter property to exclude them.\n- **Staggered Pattern**: Use \"Alternate blocking\" set to \"Yes\" with \"Blocking position\" set to \"Left and right side\" to create a structural zigzag pattern common in framing.\n- **Visualizing**: If blocking is not appearing, check the \"Blocking vertical offset\" to ensure it is actually intersecting the rafters and not floating above or below them.\n\n## FAQ\n- **Q: Why are no blocks showing up?**\n  A: Check the \"Rafters - Beam codes\" filter. You may be excluding all beams. Also, ensure the \"Blocking vertical offset\" places the blocks within the rafter's geometry.\n- **Q: How do I make the blocks fit perfectly between rafters?**\n  A: This script generates blocks *next to* rafters (blocking), not necessarily between them. However, ensuring the \"Blocking width\" matches the space available is key. Use 0 or specific dimensions to control this.\n- **Q: Can I use this for floor joists?**\n  A: Yes, while named \"RafterBlocking,\" it works on any Element containing beams, such as floor joists or wall studs. Just select the appropriate element."
      },
      "tokens_used": 8873,
      "error": null
    }
  }
}