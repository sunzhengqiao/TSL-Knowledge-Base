{
  "filename": "hsb_PocketPointLoad.mcr",
  "status": "completed",
  "total_tokens": 63923,
  "processing_time": 535.6159255504608,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": 0,\n    \"keywords\": [],\n    \"majorVersion\": 0,\n    \"minorVersion\": 0,\n    \"dxaOut\": 0,\n    \"implInsert\": 0\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"2.21\",\n      \"date\": \"09.09.2022\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"Investigate the bottom beam from the body intersection\"\n    },\n    {\n      \"version\": \"2.20\",\n      \"date\": \"07.09.2022\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"fix when investigating splitted bottom plate\"\n    },\n    {\n      \"version\": \"2.19\",\n      \"date\": \"11.11.2021\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"property to cut top/bottom plate active also for point load, not only for pocket load\"\n    },\n    {\n      \"version\": \"2.17\",\n      \"date\": \"02.07.2021\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"use GA-T and insert Cullen, LAB, 180 at the outside beams\"\n    },\n    {\n      \"version\": \"2.16\",\n      \"date\": \"05.02.2021\",\n      \"author\": \"Alberto Jena\",\n      \"changes\": \"If the user uses the option to set a module then even if there is only one beam created it will have module information.\"\n    },\n    {\n      \"version\": \"2.15\",\n      \"date\": \"18.09.2019\",\n      \"author\": \"Alberto Jena\",\n      \"changes"
      },
      "tokens_used": 9304,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script prompts for ElementWall selection and creates/manipulates GenBeam objects using methods like dbErase(), dbSplit(), and addToolStatic(). It performs 3D geometric calculations using Body, PlaneProfile, and CoordSys derived from elements. It lacks ShopDrawing specific prefixes (sd_) or viewport manipulation logic."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall",
            "Beam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": [
            "Materials.xml file located at _kPathHsbCompany\\Abbund\\",
            "hsbCNC Script (referenced for catalogue properties)"
          ]
        }
      },
      "tokens_used": 7834,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Please select Elements\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Select a beam, enter to pick a point\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"Unknown (showDialogOnce)\",\n      \"trigger\": \"_bOnInsert\",\n      \"title\": null,\n      \"dataSource\": \"Internal\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 3,\n      \"variable\": \"nBmQty\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Number of beams\",\n      \"defaultValue\": 0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dBmWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Timber width, 0=auto\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sAlign\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Alignment\",\n      \"defaultValue\": \"Left\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Left\",\n        \"Center\",\n        \"Right\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dPocketBaseHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Pocket Base Height\",\n      \"defaultValue\": \"1500\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dPocketWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Pocket Width, 0=none\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dPocketHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Pocket Height\",\n      \"defaultValue\": \"250\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dSillWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Pocket Sill Width, 0=none\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dTransomWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Pocket Transom Width, 0=none\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dTransomGap\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Transom Top Gap\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Pocket Options\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sTransferLoad\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Transfer Load with Cripples\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sSplitTopPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Split Top Plate\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sSplitBottomPlate\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Split Bottom Plate\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sCreateModule\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Create Beams as Modules\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"No\",\n        \"Yes\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 18,\n      \"variable\": \"sCncCatalogue\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Apply cnc tool|\",\n      \"defaultValue\": \"None\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"None\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Select Dim Style\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sNameStud\",\n      \"type\": \"PropString\",\n      \"displayName\": \""
      },
      "tokens_used": 10488,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Inserts structural reinforcement (studs, sills, transoms) into a timber wall to support point loads or create structural openings (pockets), with options to modify wall plates and add connection hardware.\",\n    \"category\": \"Framing/Engineering\",\n    \"typicalUseCase\": \"Reinforcing a wall section under a heavy point load (e.g., a floor bearer) or creating a framed rough opening where specific timber sizes and plate cuts are required.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"nBmQty\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Number of studs to insert to carry the load.\",\n      \"validRange\": \"1 - 10\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Determines the count of vertical beams generated. If 0, the script might calculate based on pocket width or fail, depending on context.\"\n    },\n    {\n      \"name\": \"dBmWidth\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Width (thickness) of the timber members to be created. '0' typically means the script attempts to inherit the width from the existing wall structure.\",\n      \"validRange\": \"0 or standard timber widths (e.g., 45, 70, 90, 140)\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Geometry of generated studs/sills/transoms.\"\n    },\n    {\n      \"name\": \"sAlign\",\n      \"technicalDefault\": \"Left\",\n      \"businessMeaning\": \"The alignment of the stud group relative to the insertion point picked on the wall.\",\n      \"validRange\": \"Left, Center, Right\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Positioning of the entire stud group along the wall's X-axis.\"\n    },\n    {\n      \"name\": \"dPocketBaseHeight\",\n      \"technicalDefault\": 1500,\n      \"businessMeaning\": \"The vertical height from the bottom of the wall to the bottom of the pocket (or the load bearing area).\",\n      \"validRange\": \"0 to Wall Height\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Vertical position of the pocket/stud group.\"\n    },\n    {\n      \"name\": \"dPocketWidth\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"The width of the structural pocket. If 0, the script functions as a point load insert (studs only) rather than a pocket (opening with horizontal members).\",\n      \"validRange\": \"0 or positive value\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Activates pocket logic (Sills/Transoms) if > 0. Determines spacing of outer studs.\"\n    },\n    {\n      \"name\": \"dPocketHeight\",\n      \"technicalDefault\": 250,\n      \"businessMeaning\": \"The vertical height of the pocket opening.\",\n      \"validRange\": \"0 to Wall Height - BaseHeight\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Defines the height of the opening; affects the length of cripple studs if load transfer is active.\"\n    },\n    {\n      \"name\": \"dSillWidth\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Width of the timber used for the bottom horizontal member (Sill) of the pocket.\",\n      \"validRange\": \"0 (none) or standard timber width\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Creates a horizontal beam at the bottom of the pocket if > 0.\"\n    },\n    {\n      \"name\": \"dTransomWidth\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Width of the timber used for the intermediate horizontal member (Transom/Mullion) within the pocket.\",\n      \"validRange\": \"0 (none) or standard timber width\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Creates a horizontal beam inside the pocket if > 0.\"\n    },\n    {\n      \"name\": \"dTransomGap\",\n      \"technicalDefault\": 0,\n      \"businessMeaning\": \"Vertical clearance gap between the top of the transom (or pocket) and the top plate/header above.\",\n      \"validRange\": \"0 to 100\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Adjusts the vertical position of the transom or the height of cripple studs.\"\n    },\n    {\n      \"name\": \"sTransferLoad\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Specifies whether to generate 'cripple' or 'jack' studs above/below the pocket to transfer the load to the top/bottom plates.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Generates additional vertical members filling the gap between the pocket and wall plates.\"\n    },\n    {\n      \"name\": \"sSplitTopPlate\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Controls whether to cut (split) the existing wall top plate to allow the pocket/studs to run through or sit flush.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Performs boolean subtraction or splitting operations on existing top plate beams.\"\n    },\n    {\n      \"name\": \"sSplitBottomPlate\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Controls whether to cut (split) the existing wall bottom plate.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Performs boolean subtraction or splitting operations on existing bottom plate beams.\"\n    },\n    {\n      \"name\": \"sCreateModule\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Groups the generated beams into a specific production module for logistics/cam.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Assigns module names and colors to the generated entities.\"\n    },\n    {\n      \"name\": \"sCncCatalogue\",\n      \"technicalDefault\": \"None\",\n      \"businessMeaning\": \"Selects a predefined CNC machining profile to apply to the new beams (e.g., for specific drilling or routing).\",\n      \"validRange\": \"List of available catalog names\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Adds machining operations (drills/cuts) to the generated beams.\"\n    },\n    {\n      \"name\": \"sNameStud\",\n      \"technicalDefault\": \"STUD\",\n      \"businessMeaning\": \"The entity name/usage code assigned to the vertical studs created.\",\n      \"validRange\": \"String (e.g., STUD, KING, TRIMMER)\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Naming and classification of vertical beams.\"\n    },\n    {\n      \"name\": \"sMaterialStud\",\n      \"technicalDefault\": \"(From Materials.xml)\",\n      \"businessMeaning\": \"The material grade/species for the studs.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Material property of vertical beams.\"\n    },\n    {\n      \"name\": \"sGradeStud\",\n      \"technicalDefault\": \"C16\",\n      \"businessMeaning\": \"The structural strength grade of the timber.\",\n      \"validRange\": \"String (e.g., C14, C16, C24)\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Grade property of vertical beams.\"\n    },\n    {\n      \"name\": \"sCodeStud\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Additional classification code for reports/lists.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"User data property.\"\n    },\n    {\n      \"name\": \"sNameSill\",\n      \"technicalDefault\": \"SILL\",\n      \"businessMeaning\": \"Entity name for the bottom horizontal member.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Naming of bottom horizontal beam.\"\n    },\n    {\n      \"name\": \"sMaterialSill\",\n      \"technicalDefault\": \"(From Materials.xml)\",\n      \"businessMeaning\": \"Material for the sill.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Material property of sill.\"\n    },\n    {\n      \"name\": \"sGradeSill\",\n      \"technicalDefault\": \"C16\",\n      \"businessMeaning\": \"Structural grade for the sill.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Grade property of sill.\"\n    },\n    {\n      \"name\": \"sCodeSill\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Classification code for the sill.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"User data property.\"\n    },\n    {\n      \"name\": \"sNameTransom\",\n      \"technicalDefault\": \"TRANSOM\",\n      \"businessMeaning\": \"Entity name for the intermediate horizontal member.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Naming of transom beam.\"\n    },\n    {\n      \"name\": \"sMaterialTransom\",\n      \"technicalDefault\": \"(From Materials.xml)\",\n      \"businessMeaning\": \"Material for the transom.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Material property of transom.\"\n    },\n    {\n      \"name\": \"sGradeTransom\",\n      \"technicalDefault\": \"C16\",\n      \"businessMeaning\": \"Structural grade for the transom.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"Grade property of transom.\"\n    },\n    {\n      \"name\": \"sCodeTransom\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Classification code for the transom.\",\n      \"validRange\": \"String\",\n      \"unit\": \"string\",\n      \"affectsOutput\": \"User data property.\"\n    },\n    {\n      \"name\": \"nColor\",\n      \"technicalDefault\": 3,\n      \"businessMeaning\": \"Display color for the generated beams in the CAD model.\",\n      \"validRange\": \"Integer (AutoCAD Color Index)\",\n      \"unit\": \"index\",\n      \"affectsOutput\": \"Visual representation in model.\"\n    },\n    {\n      \"name\": \"sAngleBrackets\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"Inserts angle bracket hardware to connect the outer studs to the wall.\",\n      \"validRange\": \"No, Bottom, Top, Both\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Generates metal part entities at the specified locations.\"\n    },\n    {\n      \"name\": \"sAngleBracketsLocations\",\n      \"technicalDefault\": \"Both\",\n      \"businessMeaning\": \"Specifies which side(s) of the stud group receive angle brackets.\",\n      \"validRange\": \"Left, Right, Both\",\n      \"unit\": \"enum\",\n      \"affectsOutput\": \"Placement of metal parts.\"\n    },\n    {\n      \"name\": \"sNameOutsideBeams\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Overrides the name for the outermost studs (King studs).\",\n      \"validRange\": \"String\",\n      \"unit\":"
      },
      "tokens_used": 11686,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script Initialization and Unit Check\",\n    \"Check for 'Materials.xml' file existence\",\n    \"Load Material Options from XML\",\n    \"Display Properties Dialog / Load Catalog Values (on Insert)\",\n    \"Prompt User to Select Wall Element(s)\",\n    \"Prompt User to Select Reference Beam or Pick Insertion Point\",\n    \"Analyze Wall Geometry (Height, Plane, Existing Beams)\",\n    \"Determine Logic Mode: Point Load (dPocketWidth=0) or Pocket (dPocketWidth>0)\",\n    \"Generate Vertical Studs based on Qty/Alignment/Width\",\n    \"[Conditional] Generate Horizontal Members (Sill/Transom) if Pocket Width > 0\",\n    \"[Conditional] Generate Cripples for Load Transfer if enabled\",\n    \"[Conditional] Split Top/Bottom Plates if enabled\",\n    \"[Conditional] Process Interferences (Delete blocking, Notch studs for BeamCode H)\",\n    \"Assign to Element Group and Update Nailines\",\n    \"Draw Visualization and Store Beams to Map\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Material File Check\",\n      \"path1\": {\n        \"name\": \"File Found\",\n        \"steps\": [\n          \"Continue to Property Dialog\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"File Missing\",\n        \"steps\": [\n          \"Display Error Notice\",\n          \"Erase Script Instance\",\n          \"Halt Execution\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Input Selection Type\",\n      \"path1\": {\n        \"name\": \"Beam Selected\",\n        \"steps\": [\n          \"Project Beam Center to Wall Plane\",\n          \"Derive Timber Width from selected beam\",\n          \"Use derived Point and Width for generation\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Point Picked (or No Beam)\",\n        \"steps\": [\n          \"Use Picked Point as insertion reference\",\n          \"Use Property-defined Timber Width (or auto-detect from wall)\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Geometry Mode (dPocketWidth)\",\n      \"path1\": {\n        \"name\": \"Point Load (Width = 0)\",\n        \"steps\": [\n          \"Calculate total width based on nBmQty and BeamWidth\",\n          \"Do not create Sill or Transom\",\n          \"Proceed to Splitting/Interference\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Pocket (Width > 0)\",\n        \"steps\": [\n          \"Use dPocketWidth for layout\",\n          \"Create Sill if dSillWidth > 0\",\n          \"Create Transom if dTransomWidth > 0\",\n          \"Proceed to Splitting/Interference\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Existing Blocking Interference\",\n      \"path1\": {\n        \"name\": \"Fully Covered (Intersection Area Large)\",\n        \"steps\": [\n          \"Erase existing Blocking beam\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Partially Covered\",\n        \"steps\": [\n          \"Determine number of resulting Rings (1 or 2)\",\n          \"If 1 Ring: Add Static Cut Tool to blocking\",\n          \"If 2 Rings: Split Blocking beam\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"BeamCode H Detection (Existing Headers)\",\n      \"path1\": {\n        \"name"
      },
      "tokens_used": 14513,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_PocketPointLoad.mcr\n\n## Overview\nInserts structural reinforcement (studs, sills, and transoms) into a timber wall to support point loads or create structural openings (pockets). This script also provides options to split top and bottom plates, transfer loads with cripple studs, and apply specific CNC machining profiles.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary operating environment. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: An existing `ElementWall` in the model.\n- **Minimum Beam Count**: 0 (Script generates new beams).\n- **Required Settings**:\n    - `Materials.xml` file located at `_kPathHsbCompany\\Abbund\\` is required to populate material and grade dropdowns.\n    - Reference to `hsbCNC` script for catalogue properties.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` (or assigned alias) â†’ Select `hsb_PocketPointLoad.mcr`\n\n### Step 2: Select Wall Element\n```\nCommand Line: Please select Elements\nAction: Click on the Wall Element where you want to insert the reinforcement or pocket.\n```\n\n### Step 3: Define Location and Reference\n```\nCommand Line: Select a beam, enter to pick a point\nAction: \n- Option A: Click on an existing beam in the wall to automatically inherit its width and use its location as a reference.\n- Option B: Press Enter and click a point in the model space to manually define the insertion point.\n```\n\n### Step 4: Configure Properties\nAfter insertion, select the generated element and open the **Properties Palette** (Ctrl+1) to adjust dimensions, materials, and structural settings.\n\n## Properties Panel Parameters\n\n### Geometry & Layout\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Number of beams (`nBmQty`) | Int | 0 | The number of vertical studs to insert. |\n| Timber width, 0=auto (`dBmWidth`) | Double | 0 | Thickness of the timber members. Set to 0 to inherit width from the wall or selected beam. |\n| Alignment (`sAlign`) | String | Left | Aligns the stud group relative to the insertion point (Left, Center, Right). |\n| Pocket Base Height (`dPocketBaseHeight`) | Double | 1500 | Vertical height from the bottom of the wall to the bottom of the pocket/reinforcement. |\n\n### Pocket Options (Openings)\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Pocket Width, 0=none (`dPocketWidth`) | Double | 0 | Width of the pocket. Set to 0 to create a point load (studs only); set > 0 to create a structural opening. |\n| Pocket Height (`dPocketHeight`) | Double | 250 | Vertical height of the pocket opening. |\n| Pocket Sill Width, 0=none (`dSillWidth`) | Double | 0 | Width of the bottom horizontal member (Sill). 0 means no sill is created. |\n| Pocket Transom Width, 0=none (`dTransomWidth`) | Double | 0 | Width of the intermediate horizontal member (Transom). 0 means no transom is created. |\n| Transom Top Gap (`dTransomGap`) | Double | 0 | Vertical gap between the top of the transom and the top plate. |\n\n### Structural Logic\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Transfer Load with Cripples (`sTransferLoad`) | String | No | If \"Yes\", generates cripple/jack studs above/below the pocket to transfer load to plates. |\n| Split Top Plate (`sSplitTopPlate`) | String | No | If \"Yes\", cuts the existing wall top plate to accommodate the reinforcement. |\n| Split Bottom Plate (`sSplitBottomPlate`) | String | No | If \"Yes\", cuts the existing wall bottom plate. |\n\n### Naming & Material\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Name/Material/Code Stud (`sNameStud`, `sMaterialStud`, etc.) | String | STUD/C16/... | Defines the entity name, material, grade, and code for vertical studs. |\n| Name/Material/Code Sill (`sNameSill`, etc.) | String | SILL/C16/... | Defines properties for the bottom horizontal member. |\n| Name/Material/Code Transom (`sNameTransom`, etc.) | String | TRANSOM/C16/... | Defines properties for the intermediate horizontal member. |\n| Angle Brackets (`sAngleBrackets`) | String | No | Inserts angle bracket hardware (Options: No, Bottom, Top, Both). |\n| Angle Brackets Locations (`sAngleBracketsLocations`) | String | Both | Specifies which side receives brackets (Left, Right, Both). |\n\n### Production & Output\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Create Beams as Modules (`sCreateModule`) | String | No | Groups generated beams into a production module. |\n| Apply cnc tool (`sCncCatalogue`) | String | None | Selects a CNC machining profile to apply to the new beams. |\n| Select Dim Style (`sDimStyle`) | String | - | Selects the dimension style for annotations. |\n\n## Settings Files\n- **Filename**: `Materials.xml`\n- **Location**: `_kPathHsbCompany\\Abbund\\`\n- **Purpose**: This file is essential for the script to function. It populates the Material and Grade dropdown lists in the properties palette. If this file is missing, the script will display an error and halt execution.\n\n## Tips\n- **Point Load Mode**: To create a simple point load reinforcement (e.g., under a beam bearing) without creating a full opening, ensure `Pocket Width` is set to `0`. This will generate vertical studs only.\n- **Pocket Mode**: Set `Pocket Width` to a value greater than `0` to create a framed opening. This automatically enables logic for Sills and Transoms if their widths are defined.\n- **Interference Handling**: The script automatically detects and handles existing blocking in the wall. It will either erase blocking fully covered by the new insert or split/trim blocking that is partially covered.\n- **Quick Setup**: Clicking an existing beam during insertion (Step 3) is the fastest way to ensure the new studs match the wall's timber width and align perfectly with existing geometry.\n\n## FAQ\n- **Q: Why did the script erase my instance immediately after insertion?**\n  - A: This usually happens if the `Materials.xml` file cannot be found at the specified path (`_kPathHsbCompany\\Abbund\\`). Check your company folder structure.\n- **Q: How do I cut the top plate to allow the new studs to pass through?**\n  - A: Set the property `Split Top Plate` to \"Yes\". This will perform a boolean subtraction or split operation on the existing top plate beams.\n- **Q: What is the difference between \"Point Load\" and \"Pocket\" in this script?**\n  - A: The distinction is controlled by `Pocket Width`. If `0`, it acts as a point load (vertical reinforcement only). If `> 0`, it acts as a pocket (creating an opening with horizontal members like sills/headers)."
      },
      "tokens_used": 10098,
      "error": null
    }
  }
}