{
  "filename": "GE_PLOT_ASSEMBLIES_LIST_LABELS_HATCH.mcr",
  "status": "completed",
  "total_tokens": 39179,
  "processing_time": 1269.0404391288757,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.6",
            "date": "09.ene.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "DimLines can now be refered to headers only or complete assemblies when openings"
          },
          {
            "version": "1.5",
            "date": "11.oct.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added/relocated dim lines - Applied unitFormat to jacks and header dimensioning"
          },
          {
            "version": "1.4",
            "date": "09.oct.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added \"View type\" prop."
          },
          {
            "version": "1.3",
            "date": "06.oct.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added labels for assemblies inside opening (around interior opening) - Changed opening name to use full description (width+height+type+style name)"
          },
          {
            "version": "1.2",
            "date": "04.sep.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Hatch now is full customizable - Added assemblies at wall connections"
          },
          {
            "version": "1.1",
            "date": "31.ago.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Hatch added for assemblies - Labels will align to bottom of wall and then will be placed vertically alternated - If opening, label will be module name - Assembly list enhanced, added start/end location and face alignment (Up/Down)"
          },
          {
            "version": "1.0",
            "date": "29.ago.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7995,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly prompts for a Viewport using 'getViewport' and accesses '_Viewport'. It calculates positions based on 'vp.ptCenPS()' (center in Paper Space) and uses 'vp.dScale()', indicating it operates within the 2D drawing context of a layout, labeling elements projected from a viewport."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Wall"
          ],
          "minimumBeams": 1,
          "requiredSpace": "A Viewport containing a Wall Element must exist in the drawing.",
          "requiredSettings": [
            "_kPathHsbWallDetail\\OpeningSFCat.dat"
          ]
        }
      },
      "tokens_used": 6350,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 10683,
      "error": null
    },
    "4": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Initialization",
          "Check insertCycleCount (erase instance if >1)",
          "Prompt user to select Viewport",
          "Prompt user to select View Type (0=Elevation, 1=Plan)",
          "Branch View Type: If Elevation, prompt for insertion point; If Plan, calculate point automatically from Viewport center",
          "Set default DimStyles ('hsb-vp-inch') and Hatch pattern ('DOTS')",
          "Retrieve Element from Viewport",
          "Validate Element (if invalid, exit)",
          "Configure default properties based on View Type (Labels vs Dims)",
          "Identify Wall T/L connections and Openings",
          "Process Plates and generate Assembly List data",
          "Draw Hatch on assemblies (if enabled)",
          "Draw Labels on assemblies (if enabled)",
          "Calculate Dimension points and filter stacked openings",
          "Draw Cumulative Dimensions (if enabled)",
          "Draw Delta Dimensions (if enabled)",
          "Draw Element Dimension (if enabled, adjusts offset if list is empty)",
          "Draw Assembly List Table (if enabled)"
        ],
        "conditionalBranches": [
          {
            "condition": "View Type Selection (sView)",
            "path1": {
              "name": "Elevation View",
              "steps": [
                "Prompt user for list insertion point (_Pt0)",
                "Enable Display Labels/Display List properties",
                "Disable Display Dimension properties",
                "Draw Labels and List"
              ]
            },
            "path2": {
              "name": "Plan View",
              "steps": [
                "Calculate insertion point based on Viewport Center",
                "Disable Display Labels/Display List properties",
                "Enable Display Dimension properties",
                "Draw Dimensions"
              ]
            }
          },
          {
            "condition": "Assembly List Data Availability (sNamesToList)",
            "path1": {
              "name": "Assemblies Found",
              "steps": [
                "Filter dimension points for non-stacked openings",
                "Draw Element Dimension line at standard offset"
              ]
            },
            "path2": {
              "name": "No Assemblies Found",
              "steps": [
                "Draw Element Dimension line using Delta Offset (closer to element)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport contains valid hsbCAD Element",
            "errorMessage": "None (Script exits silently)",
            "recovery": "Select a viewport pointing to a valid Wall element."
          },
          {
            "check": "Element contains beams",
            "errorMessage": "None (Script exits silently)",
            "recovery": "Ensure the selected element has structural beams."
          },
          {
            "check": "Script Insert Cycle Count",
            "errorMessage": "None",
            "recovery": "Script auto-handles; user does not need to act, but ensures clean insert."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change View Type",
            "how": "Properties Palette (OPM)",
            "effect": "Toggles between Label/List mode and Dimension mode, potentially recalculating insertion point."
          },
          {
            "action": "Toggle visibility of components",
            "how": "Properties Palette (Display Labels, Display Hatch, Display List, Display Dims)",
            "effect": "Shows or hides specific drawing entities."
          },
          {
            "action": "Modify Styling and Positioning",
            "how": "Properties Palette (Offsets, Colors, Dimstyles, Hatch Pattern)",
            "effect": "Updates geometry and appearance of labels, lists, and dimensions immediately."
          },
          {
            "action": "Change Dimension Reference",
            "how": "Properties Palette (Dimension openings to property)",
            "effect": "Changes dimension lines to measure header ends or full assembly ends."
          }
        ]
      },
      "tokens_used": 9530,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_PLOT_ASSEMBLIES_LIST_LABELS_HATCH.mcr\n\n## Overview\nThis script generates automated assembly lists, labels, and hatching for wall elements in Elevation views, while providing specialized dimensioning tools for Plan views. It processes wall connections and openings to create detailed production annotations directly in Paper Space.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script operates exclusively in Paper Space. |\n| Paper Space | Yes | Requires a Viewport displaying a Wall Element. |\n| Shop Drawing | No | This is a general detailing script for layouts. |\n\n## Prerequisites\n- **Required Entities:** A Wall Element (containing structural beams) visible through a viewport.\n- **Minimum Beam Count:** 1\n- **Required Settings Files:**\n  - `_kPathHsbWallDetail\\OpeningSFCat.dat` (Used for opening descriptions and styling)\n\n## Usage Steps\n\n### Step 1: Launch Script\n```\nCommand Line: TSLINSERT\nAction: Browse and select GE_PLOT_ASSEMBLIES_LIST_LABELS_HATCH.mcr\n```\n\n### Step 2: Select Viewport\n```\nCommand Line: Select Viewport:\nAction: Click on a viewport in the layout that displays the wall you wish to annotate.\n```\n\n### Step 3: Select View Type\n```\nCommand Line: Select View Type [0=Elevation, 1=Plan]:\nAction: Type 0 and press Enter for Elevation (Labels/Lists) or Type 1 for Plan (Dimensions).\n```\n\n### Step 4: Define Insertion Point (Elevation Only)\n*If you selected Elevation (0):*\n```\nCommand Line: Specify insertion point:\nAction: Click in the Paper Space to place the Assembly List and Labels.\n```\n*If you selected Plan (1):* The script automatically calculates the insertion point based on the Viewport center.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| View type | Int | 0 | Toggles between Elevation mode (0) and Plan mode (1). |\n| Display Labels | Bool | True | Shows assembly labels on the drawing. |\n| Display List | Bool | True | Generates the assembly list table. |\n| Display Hatch | Bool | True | Hatches the assemblies with the defined pattern. |\n| Display Dims | Bool | False | Enables dimension lines (primarily for Plan views). |\n| Display Cumulative Dims | Bool | False | Shows chain dimensions along the wall. |\n| Display Delta Dims | Bool | False | Shows individual dimension segments. |\n| Dimension openings to | String | Headers | Sets if dimensions measure the Header only or the Full Assembly. |\n| DimStyle | String | hsb-vp-inch | The dimension style to use for drawing dimensions. |\n| Hatch Pattern | String | DOTS | The hatch pattern applied to assemblies (e.g., SOLID, DOTS). |\n| Hatch Scale | Double | 1.0 | Scale factor for the hatch pattern. |\n| Offset List | Double | Variable | Distance offset for the Assembly List table. |\n| Offset Label | Double | Variable | Distance offset for Labels from the wall. |\n\n## Right-Click Menu Options\n*Note: This script primarily relies on the Properties Palette (OPM) for modifications rather than custom context menu entries.*\n\n## Settings Files\n- **Filename**: `OpeningSFCat.dat`\n- **Location**: `hsbWallDetail` folder in your company or installation path.\n- **Purpose**: Defines descriptions and classifications for openings (combining width, height, type, and style).\n\n## Tips\n- **Switching Modes:** You can switch between Plan and Elevation modes instantly via the Properties Palette without re-running the script. The script will adjust visible components (dims vs. labels) automatically.\n- **Stacked Openings:** In Elevation mode, if openings are stacked (e.g., a window above a door), the script handles labeling intelligently. In Plan mode, dimension points filter out stacked openings to prevent overlapping dimensions.\n- **Dimension Reference:** If you find your dimensions are too short or long in Plan view, change the \"Dimension openings to\" property from \"Headers\" to \"Full Assemblies\" to see how it affects the measurement points.\n- **Empty Assemblies:** If a wall has no specific assemblies (like lintels/jacks), the dimension lines in Plan view will automatically pull closer to the main wall element to maintain readability.\n\n## FAQ\n- **Q: I selected a viewport but nothing happened.**\n- **A:** Ensure the viewport contains a valid Wall Element with beams. The script will exit silently if no element is detected.\n- **Q: Why can't I see labels in Plan view?**\n- **A:** By default, the \"Display Labels\" property is disabled when View Type is set to Plan (1). You can manually enable it in the Properties Palette, but Plan view is optimized for Dimensions.\n- **Q: How do I change the hatch style?**\n- **A:** Select the script instance in the drawing and change the \"Hatch Pattern\" property in the Properties Palette to any standard AutoCAD pattern name (e.g., ANSI31, SOLID)."
      },
      "tokens_used": 4621,
      "error": null
    }
  }
}