{
  "filename": "GE_WALL_INFO_CHECK_MATERIALS.mcr",
  "status": "completed",
  "total_tokens": 46114,
  "processing_time": 316.7127070426941,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.2",
            "date": "11.may.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added sheathing control"
          },
          {
            "version": "v1.1",
            "date": "11.may.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Changed key creation of beams to compare with lumber items map - Added table for materials with no weight definition - Description updated"
          },
          {
            "version": "v1.0",
            "date": "13.apr.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7964,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getElement() to select a Wall (Element) and iterates through its internal Beam and Sheet collections (_Beam, _Sheet). It generates visual output using a Display object (dp) drawn at a user-selected 3D point (_Pt0). There are no ShopDrawing (sd_) prefixes, #Type declarations, or Viewport interactions."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D Construction)",
          "requiredSettings": [
            "hsbFramingDefaults.Inventory.dll",
            "Lumber and Sheathing Inventory definitions (via hsbFramingDefaultsEditor)"
          ]
        }
      },
      "tokens_used": 7160,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "|Select a wall|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Select point to create table|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowNotice",
            "trigger": "Script completes finding no issues",
            "title": null,
            "dataSource": "Internal script logic",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nBeamInfoColor",
            "type": "PropInt",
            "displayName": "|Beam info color|",
            "defaultValue": 4,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nSheetInfoColor",
            "type": "PropInt",
            "displayName": "|Sheathing info color|",
            "defaultValue": 3,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sDimstyle",
            "type": "PropString",
            "displayName": "|Dimstyle|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "_DimStyles",
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sShowPointer",
            "type": "PropString",
            "displayName": "|Show pointer|",
            "defaultValue": 1,
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sHighlightBeams",
            "type": "PropString",
            "displayName": "|Highlight beams|",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sHighlightSheets",
            "type": "PropString",
            "displayName": "|Highlight sheets|",
            "defaultValue": 0,
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 8706,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 7488,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via Insert command",
          "Check insert cycle count (remove duplicate instances if count > 1)",
          "Prompt user to select a Wall (Element)",
          "Prompt user to select a point for the table location",
          "Load Lumber and Sheathing data from hsbFramingDefaults.Inventory.dll",
          "Validate selected Element exists and is valid (erase if not)",
          "Iterate through Wall Beams to check Grade validity against Inventory",
          "Iterate through Wall Beams to check Weight definitions against Inventory",
          "Iterate through Wall Sheets to check Material validity against Inventory",
          "Iterate through Wall Sheets to check Weight definitions against Inventory",
          "Determine if any issues were found across all categories",
          "[Conditional] If no issues: Show notice and erase instance",
          "[Conditional] If issues found: Generate Visual Tables and Pointers"
        ],
        "conditionalBranches": [
          {
            "condition": "Issues found in Beams (Grade/Weight) or Sheets (Material/Weight)",
            "path1": {
              "name": "Issues Found",
              "steps": [
                "Create Display object",
                "Draw Table for Beams with Invalid Grade (if any)",
                "Draw Table for Beams with Undefined Weight (if any)",
                "Draw Table for Sheets with Invalid Material (if any)",
                "Draw Table for Sheets with Undefined Weight (if any)",
                "Draw pointers and highlight entities based on OPM settings"
              ]
            },
            "path2": {
              "name": "No Issues Found",
              "steps": [
                "Show report notice '|No issues found|'",
                "Erase script instance",
                "Stop execution"
              ]
            }
          },
          {
            "condition": "Beam Grade Validation",
            "path1": {
              "name": "Grade Invalid/Empty",
              "steps": [
                "Mark beam for Grade Issues list",
                "Skip weight check for this beam"
              ]
            },
            "path2": {
              "name": "Grade Valid",
              "steps": [
                "Check beam dimensions against Lumber Inventory",
                "If dimensions match, check if Weight is defined",
                "Mark beam for Weight Issues list if weight is missing/undefined"
              ]
            }
          },
          {
            "condition": "Sheathing Material Validation",
            "path1": {
              "name": "Material Invalid/Empty",
              "steps": [
                "Mark sheet for Material Issues list",
                "Skip weight check for this sheet"
              ]
            },
            "path2": {
              "name": "Material Valid",
              "steps": [
                "Check sheet thickness against Sheathing Inventory",
                "If thickness matches, check if Weight is defined",
                "Mark sheet for Weight Issues list if weight is missing/undefined"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Grade Mapping",
            "errorMessage": "Implicitly handled: Beam is added to 'BEAMS WITH NOT VALID GRADE' table",
            "recovery": "Update Beam Grade in Wall properties or update Lumber Inventory in Defaults Editor"
          },
          {
            "check": "Beam Weight Definition",
            "errorMessage": "Implicitly handled: Beam is added to 'BEAMS WITH UNDEFINED WEIGHT VALUES' table",
            "recovery": "Ensure the specific size/grade combination has a weight defined in Defaults Editor"
          },
          {
            "check": "Sheathing Material Mapping",
            "errorMessage": "Implicitly handled: Sheet is added to 'SHEATHING WITH NOT VALID MATERIAL' table",
            "recovery": "Update Sheet Material in Wall properties or update Sheathing Inventory"
          },
          {
            "check": "Sheathing Weight Definition",
            "errorMessage": "Implicitly handled: Sheet is added to 'SHEATHING WITH UNDEFINED WEIGHT VALUES' table",
            "recovery": "Ensure the material/thickness combination has a weight defined in Defaults Editor"
          },
          {
            "check": "Element Validity",
            "errorMessage": "None (Silent erase)",
            "recovery": "Ensure the referenced Wall Element is not deleted"
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Visualization Settings",
            "how": "OPM Properties (Beam/Sheet info color, Highlight options, Pointer visibility)",
            "effect": "Redraws the tables and graphical markers immediately with new colors/visibility settings"
          },
          {
            "action": "Modify Wall Geometry or Properties",
            "how": "Edit Wall (Element) grips or properties",
            "effect": "Script recalculates Beams/Sheets against Inventory and updates tables (add/removes lines)"
          },
          {
            "action": "Delete Wall",
            "how": "Erase Wall Entity",
            "effect": "Script detects `_bOnElementDeleted`, erases itself, and stops"
          },
          {
            "action": "Update Inventory",
            "how": "External hsbFramingDefaultsEditor",
            "effect": "Script does not auto-refresh until the Wall is updated or the script instance is modified/forced to recalc"
          }
        ]
      },
      "tokens_used": 9558,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_INFO_CHECK_MATERIALS.mcr\n\n## Overview\nThis script inspects a selected Wall Element to verify that all Beams (studs/plates) and Sheets (sheathing) have valid Grades/Materials and defined Weight values according to your hsbFramingDefaults inventory. If errors are found, it generates an on-screen table identifying the specific components that lack valid inventory data or weight definitions.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script is intended for 3D Model usage only. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities:** An existing Wall (Element) in the drawing.\n- **Minimum Beams:** N/A (Script checks walls, which contain beams).\n- **Required Settings:** `hsbFramingDefaults.Inventory.dll` must be properly configured with Lumber and Sheathing definitions (via hsbFramingDefaultsEditor).\n\n## Usage Steps\n\n### Step 1: Launch Script\n**Command:** `TSLINSERT`\n**Action:** Select `GE_WALL_INFO_CHECK_MATERIALS.mcr` from the file dialog.\n\n### Step 2: Select Wall\n```\nCommand Line: |Select a wall|\nAction: Click on the Wall element you wish to audit.\n```\n\n### Step 3: Position Report\n```\nCommand Line: |Select point to create table|\nAction: Click anywhere in the model space to place the material report table.\n```\n\n**Note:** If no issues are found (all grades and weights are valid), a notice will appear stating \"No issues found\", and the script instance will automatically erase itself. The tables only appear if problems exist.\n\n## Properties Panel Parameters\n\nThese parameters can be adjusted in the AutoCAD Properties Palette (Ctrl+1) after the script is inserted.\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beam info color | Number | 4 | The AutoCAD color index (ACI) used for text and lines regarding Beam issues. |\n| Sheathing info color | Number | 3 | The AutoCAD color index (ACI) used for text and lines regarding Sheathing issues. |\n| Dimstyle | Dropdown | Current | The dimension style used for pointers and leader lines. |\n| Show pointer | Dropdown | Yes | Toggles the visibility of the pointer lines connecting the table to the wall elements. |\n| Highlight beams | Dropdown | No | If set to Yes, beams with invalid data will be highlighted visually. |\n| Highlight sheets | Dropdown | No | If set to Yes, sheets with invalid data will be highlighted visually. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | This script does not add specific custom context menu items. |\n\n## Settings Files\n- **Filename:** `hsbFramingDefaults.Inventory.dll`\n- **Location:** Defined in your hsbCAD configuration (Company or Install path).\n- **Purpose:** Provides the master list of Lumber and Sheathing materials. The script checks the Wall elements against this file to ensure every beam grade and sheet material exists and has a weight defined.\n\n## Tips\n- **Automatic Cleanup:** Don't worry if the script seems to \"fail\" or disappear immediately after insertion; this means your wall passed all checks.\n- **Troubleshooting:** If you see \"UNDEFINED WEIGHT VALUES\" in the table, open your hsbFramingDefaultsEditor and ensure that specific size/grade or material/thickness combination has a weight value assigned.\n- **Visual Feedback:** Enable the \"Highlight beams\" or \"Highlight sheets\" properties in the palette if the wall is complex and you need to quickly locate the specific offending studs or panels.\n- **Updates:** Modifying the Inventory file externally does not automatically update the drawing. You must update the wall geometry or force a recalculation (e.g., by changing a property) to refresh the check.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I selected a point?**\n  - A: The script performs a self-check. If it finds no missing grades, materials, or weights, it displays a success message and erases itself to keep your drawing clean.\n\n- **Q: What does \"BEAMS WITH NOT VALID GRADE\" mean?**\n  - A: It means a specific beam in the wall has a Grade assigned (e.g., \"SPF\") that does not exist in your Lumber Inventory map. You either need to change the beam's grade or add that grade to your Inventory defaults.\n\n- **Q: Can I move the table after creating it?**\n  - A: Yes. Select the script instance (it might be easier to select the text in the table) and use the standard AutoCAD Move command or grips to relocate the report. The pointers will update automatically."
      },
      "tokens_used": 5238,
      "error": null
    }
  }
}