{
  "filename": "hsbMultiLanguage.mcr",
  "status": "completed",
  "total_tokens": 25751,
  "processing_time": 173.42305946350098,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "11Sep2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "languages alphabetically ordered"
          },
          {
            "version": "1.0",
            "date": "18Aug2017",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4814,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No usage of 'sd_' or 'Multipage' prefixes. No '_Viewport' or '_kPaperSpace' API calls. Script uses 'eraseInstance()' immediately after processing properties on insertion, indicating it functions as a setup tool (database utility) rather than a drawing generator."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "None (Script operates as a database utility to set language preferences, does not generate geometry).",
          "requiredSettings": []
        }
      },
      "tokens_used": 2314,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDialog",
            "trigger": "When _bOnInsert is true and _kExecuteKey is empty",
            "title": "Properties",
            "dataSource": "Internal Property List (sLanguage1, sLanguage2)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sLanguage1",
            "type": "PropString",
            "displayName": "Primary Language",
            "defaultValue": "|_Default|",
            "inputType": "dropdown",
            "options": [
              " |Disabled|",
              "|Bulgarian|",
              "|Croatian|",
              "|Czech|",
              "|Danish|",
              "|Dutch|",
              "|English|",
              "|Estonian|",
              "|Finish|",
              "|Frensch|",
              "|German|",
              "|Greek|",
              "|Hungarian|",
              "|Italian|",
              "|Japanese|",
              "|Korean|",
              "|Lithuanian|",
              "|Norwegian|",
              "|Polish|",
              "|Portuguese|",
              "|Romanian|",
              "|Russsian|",
              "|Slovak|",
              "|Slovenian|",
              "|Spanish|",
              "|Swedish|",
              "|Turkish|",
              "|Ukranian|",
              "|Manadarin|"
            ],
            "category": "|Languages|",
            "description": "|Defines the primary Language|"
          },
          {
            "index": 1,
            "variable": "sLanguage2",
            "type": "PropString",
            "displayName": "Secondary Language",
            "defaultValue": "|_Default|",
            "inputType": "dropdown",
            "options": [
              " |Disabled|",
              "|Bulgarian|",
              "|Croatian|",
              "|Czech|",
              "|Danish|",
              "|Dutch|",
              "|English|",
              "|Estonian|",
              "|Finish|",
              "|Frensch|",
              "|German|",
              "|Greek|",
              "|Hungarian|",
              "|Italian|",
              "|Japanese|",
              "|Korean|",
              "|Lithuanian|",
              "|Norwegian|",
              "|Polish|",
              "|Portuguese|",
              "|Romanian|",
              "|Russsian|",
              "|Slovak|",
              "|Slovenian|",
              "|Spanish|",
              "|Swedish|",
              "|Turkish|",
              "|Ukranian|",
              "|Manadarin|"
            ],
            "category": "|Languages|",
            "description": "|Defines the primary Language|"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3902,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A configuration utility used to set primary and secondary languages for the hsbCAD project environment, specifically for generating multilingual shop drawings or output data.",
          "category": "Configuration / Data Management",
          "typicalUseCase": "When starting a project for an international client, or when specific drawings need to be produced in a language different from the default CAD language."
        },
        "parameters": [
          {
            "name": "sLanguage1",
            "technicalDefault": "|_Default|",
            "businessMeaning": "Defines the main language to be used for textual output, such as dimensions, labels, and material lists in generated drawings.",
            "validRange": "Any supported language code from the dropdown (e.g., English, German, French, etc.) or |Disabled|.",
            "unit": "String (Text)",
            "affectsOutput": "Updates the 'Language' entry in the AutoCAD Extension Dictionary ('hsbTSL') under 'Languages'. Does not create geometry, but controls how subsequent scripts or hsbCAD functions display text."
          },
          {
            "name": "sLanguage2",
            "technicalDefault": "|_Default|",
            "businessMeaning": "Defines a secondary language for dual-language output requirements, allowing for bilingual annotations or reports.",
            "validRange": "Any supported language code from the dropdown or |Disabled|.",
            "unit": "String (Text)",
            "affectsOutput": "Appends a second 'Language' entry to the AutoCAD Extension Dictionary. If the Primary Language is empty/disabled, the Secondary Language effectively becomes the Primary one."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sLanguage1 is set to |Disabled| or empty",
            "effect": "The script attempts to use sLanguage2 as the primary language code stored in the database.",
            "cascade": [
              "sLanguage2"
            ]
          },
          {
            "trigger": "Both sLanguage1 and sLanguage2 are set to |Disabled|",
            "effect": "The script removes the language settings from the AutoCAD database entirely, reverting to system defaults.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "MapObject (Database Entry)",
            "description": "Creates or updates a named dictionary entry in the AutoCAD database (Dictionary: hsbTSL, Key: Languages) containing the selected ISO language codes.",
            "appliedTo": "Project Database / Drawing Extension Dictionary"
          }
        ]
      },
      "tokens_used": 3919,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launched (Insert Command)",
          "2. Check Insert Cycle Count (Silent exit if > 1)",
          "3. [Conditional] Determine Input Source (Catalog Key vs. Dialog)",
          "4. Retrieve Language Properties (sLanguage1, sLanguage2)",
          "5. Resolve Language Short Codes from Arrays",
          "6. [Conditional] Check for 'Disabled' or Empty state for both languages",
          "7. [Conditional] Handle Primary Language Emptiness (Fallback to Secondary)",
          "8. Construct MapObject with Language Codes",
          "9. Update AutoCAD Extension Dictionary ('hsbTSL', 'Languages')",
          "10. Erase Script Instance from Drawing",
          "11. Exit"
        ],
        "conditionalBranches": [
          {
            "condition": "Execute Key (_kExecuteKey) is provided",
            "path1": {
              "name": "Catalog Execution",
              "steps": [
                "Check if key matches a catalog entry",
                "If match: Load properties from that catalog",
                "If no match: Load properties from '|_LastInserted|' catalog",
                "Skip visual dialog"
              ]
            },
            "path2": {
              "name": "Interactive Execution",
              "steps": [
                "Launch Properties Dialog",
                "User selects Primary and Secondary Languages manually",
                "Click OK to proceed"
              ]
            }
          },
          {
            "condition": "Both Primary and Secondary Languages are set to 'Disabled' or empty",
            "path1": {
              "name": "Cleanup Mode",
              "steps": [
                "Verify 'hsbTSL' dictionary entry exists",
                "Erase the 'Languages' entry from database",
                "Do not write new values",
                "Erase script instance"
              ]
            },
            "path2": {
              "name": "Configuration Mode",
              "steps": [
                "Resolve ISO short codes (e.g., 'EN', 'DE')",
                "Create or Update MapObject with language codes",
                "Store in Extension Dictionary",
                "Erase script instance"
              ]
            }
          },
          {
            "condition": "Primary Language (sLanguage1) is empty or invalid during map construction",
            "path1": {
              "name": "Fallback Logic",
              "steps": [
                "Assign value of sShortLang2 to sShortLang1",
                "Clear sShortLang2",
                "Proceed to write map (with Secondary becoming Primary)"
              ]
            },
            "path2": {
              "name": "Standard Logic",
              "steps": [
                "Retain sShortLang1 as Primary",
                "Retain sShortLang2 as Secondary (if valid)",
                "Proceed to write map"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Array Length Synchronization",
            "errorMessage": "TN(\"|Language definitions are not valid!|\")",
            "recovery": "The script self-aborts (eraseInstance) to prevent data corruption. This is a code-level error requiring developer correction to ensure 'sLanguages' and 'sLangShorts' arrays have matching lengths."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 6157,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbMultiLanguage.mcr\n\n## Overview\nThis script is a configuration utility used to set the primary and secondary language for the current hsbCAD project. It allows you to define how textual output (such as dimensions, labels, and material lists) appears in generated drawings and reports.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is a setup tool intended to be run in the model space to configure project settings. |\n| Paper Space | No | |\n| Shop Drawing | No | This script does not generate geometry but configures settings used by other scripts. |\n\n## Prerequisites\n- **Required entities**: None\n- **Minimum beam count**: 0\n- **Required settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbMultiLanguage.mcr`\n\n### Step 2: Configure Languages\n```\nInterface: Properties Palette (or ShowDialog)\nAction: \n1. Locate the 'Languages' category in the Properties Palette.\n2. Select the desired language from the 'Primary Language' dropdown.\n3. (Optional) Select a second language from the 'Secondary Language' dropdown for bilingual output.\n4. Close the Properties Palette or click OK to apply changes.\n```\n\n### Step 3: Complete\n```\nAction: The script updates the project database and automatically removes itself from the drawing.\nNote: It is normal for the script instance to disappear immediately after insertion.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Primary Language (sLanguage1) | dropdown | |_Default| | Sets the main language for text output in drawings and reports (e.g., dimensions, labels). |\n| Secondary Language (sLanguage2) | dropdown | |_Default| | Sets a secondary language for dual-language output. If Primary is set to |Disabled|, this language becomes the primary. |\n\n**Supported Languages Include:**\nBulgarian, Croatian, Czech, Danish, Dutch, English, Estonian, Finnish, French, German, Greek, Hungarian, Italian, Japanese, Korean, Lithuanian, Norwegian, Polish, Portuguese, Romanian, Russian, Slovak, Slovenian, Spanish, Swedish, Turkish, Ukrainian, Mandarin.\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script runs once upon insertion and erases itself. Standard edit options do not apply to the instance. |\n\n## Settings Files\n- No external settings files are required for this script.\n\n## Tips\n- **Script Disappears**: Do not be alarmed if the script entity vanishes immediately after you run it. This is intended behavior; it writes the settings to the drawing database and then cleans itself up.\n- **Clearing Settings**: To remove specific language overrides and revert to system defaults, set both the Primary and Secondary Language options to `|Disabled|`.\n- **Fallback Logic**: If you leave the Primary Language empty or disabled, the script will automatically use the Secondary Language as the primary output language.\n\n## FAQ\n- **Q: Can I use this script to change the language of an existing single drawing element?**\n  - A: No, this script sets the global project language configuration stored in the drawing database. It affects how other scripts and hsbCAD functions generate new text.\n- **Q: How do I reset the language back to the CAD system default?**\n  - A: Run the script again and set the Primary Language to `|Disabled|`. The script will clear the custom language entry from the database."
      },
      "tokens_used": 4645,
      "error": null
    }
  }
}