{
  "filename": "GE_HDWR_WALL_ANCHOR_WAH.mcr",
  "status": "completed",
  "total_tokens": 33596,
  "processing_time": 731.1754324436188,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.5",
            "date": "10.jun.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Bug fix: Metalpart was overlapping with beam"
          },
          {
            "version": "1.4",
            "date": "02.jun.2014",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added features to make possible reset TXT source file using GE_HDWR_RESET_CATALOG_ENTRY tsl"
          },
          {
            "version": "1.3",
            "date": "05.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Version control"
          },
          {
            "version": "1.2",
            "date": "05.nov.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Removed floating feature, applied only when beams selected. Relocation upon _Pt0 to beam side/end"
          },
          {
            "version": "1.1",
            "date": "29.nov.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Added reading for anchors from construction directive\nDrawing vectors taken from instance coordsys"
          },
          {
            "version": "1.0",
            "date": "08.nov.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release\nRenamed from GE_HDWR_HANGER_WAH to GE_HDWR_WALL_ANCHOR_WAH"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7581,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script creates 3D geometry (Body, PLine) using vectors derived from Beams. It uses getPoint() for insertion, handles _bOnInsert logic for creating TslInst, and manipulates GenBeam objects. There are no references to sd_ functions, _Viewport, or shopdrawing specific flags like #Type E."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "TSL_HARDWARE_FAMILY_LIST.dxx (Catalog file)",
            "TSL_Read_Metalpart_Family_Props.dll (DotNet assembly)",
            "Specific Anchor TSLs (e.g., GE_HDWR_ANCHOR_J-BOLT.mcr)"
          ]
        }
      },
      "tokens_used": 5933,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select stud(s)",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Select reference point: hangers will be inserted at closest end and closer face of members",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "DotNet Dialog",
            "trigger": "_bOnInsert or 'Change type' context menu",
            "title": null,
            "dataSource": "TSL_Read_Metalpart_Family_Props.dll",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Type|",
            "defaultValue": "WAH16",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dClearWidth",
            "type": "PropDouble",
            "displayName": "|Clear width|",
            "defaultValue": "70 (2.625 inches)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dOverallDepth",
            "type": "PropDouble",
            "displayName": "|Overall depth|",
            "defaultValue": "560 (22 inches)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dOverallHeight",
            "type": "PropDouble",
            "displayName": "|Overall height|",
            "defaultValue": "50 (2 inches)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "Change type",
            "handler": "sChangeType",
            "action": "Triggers selection of a new hardware type via the dotNet catalog reader",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "Help",
            "handler": "sHelp",
            "action": "Displays a reportNotice with usage instructions",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "TSL_HARDWARE_FAMILY_LIST.dxx",
            "searchPaths": [
              "_kPathHsbCompany\\TSL\\Catalog\\"
            ],
            "purpose": "Contains the hardware family definitions (WAH family) used to populate properties",
            "required": true
          }
        ]
      },
      "tokens_used": 6156,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Inserts a Wall Anchor Hanger (WAH) onto timber studs, creating a vertical strap plate, lateral flanges, and a drilled anchor plate to secure the wall to a foundation.",
          "category": "Hardware",
          "typicalUseCase": "Anchoring the bottom or intermediate points of a timber frame wall to a concrete floor or foundation to resist wind uplift and shear forces."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "WAH16",
            "businessMeaning": "The specific model number or SKU of the wall anchor hardware, selected from the manufacturer's catalog.",
            "validRange": "N/A (Catalog dependent)",
            "unit": "String",
            "affectsOutput": "Determines the default dimensions and anchor type used for the entire assembly. Changing this via 'Change type' resets all geometry parameters to the catalog specification."
          },
          {
            "name": "dClearWidth",
            "technicalDefault": "70 (2.625 inches)",
            "businessMeaning": "The horizontal width of the metal bracket, measured parallel to the wall face (perpendicular to the stud).",
            "validRange": "40 - 150 mm",
            "unit": "mm",
            "affectsOutput": "Controls the width of the base plate, the lateral supports, and the drilled connection plate. Widens the entire assembly along the wall axis."
          },
          {
            "name": "dOverallDepth",
            "technicalDefault": "560 (22 inches)",
            "businessMeaning": "The vertical height of the main strap plate that runs parallel to the stud (usually along the Z-axis in vertical walls).",
            "validRange": "200 - 1200 mm",
            "unit": "mm",
            "affectsOutput": "Controls the length of the vertical base plate attached to the stud. This determines how much surface area is available for nailing/screwing to the timber."
          },
          {
            "name": "dOverallHeight",
            "technicalDefault": "50 (2 inches)",
            "businessMeaning": "The projection depth of the anchor plate, measuring how far the hardware extends out from the face of the wall/stud towards the concrete.",
            "validRange": "30 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Controls the offset of the drilled plate from the stud face. This determines the standoff distance where the anchor bolt (J-Bolt, etc.) will be located."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User executes 'Change type' context menu",
            "effect": "Reads new dimensions and anchor configuration from the TSL_HARDWARE_FAMILY_LIST.dxx catalog",
            "cascade": [
              "sType",
              "dClearWidth",
              "dOverallDepth",
              "dOverallHeight",
              "Anchor Model/Type"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "MetalPart (Base Plate)",
            "description": "A vertical flat plate that sits against the side of the stud, running vertically for the length defined by 'Overall depth'.",
            "appliedTo": "Selected Stud(s)"
          },
          {
            "type": "MetalPart (Lateral Supports)",
            "description": "Triangular or trapezoidal flanges on the left and right sides connecting the base plate to the front drilled plate.",
            "appliedTo": "Selected Stud(s)"
          },
          {
            "type": "MetalPart (Drilled Plate)",
            "description": "A smaller vertical plate protruding from the wall face, containing a hole for the anchor bolt.",
            "appliedTo": "Selected Stud(s)"
          },
          {
            "type": "Drill (Hole)",
            "description": "A cylindrical hole through the Drilled Plate to accommodate the anchor rod.",
            "appliedTo": "Drilled Plate"
          },
          {
            "type": "Sub-Component (Anchor)",
            "description": "Inserts a separate TSL instance (e.g., J-Bolt, Adhesive Anchor) into the drilled plate, positioned based on the projection defined by 'Overall height'.",
            "appliedTo": "Wall Anchor Assembly"
          }
        ]
      },
      "tokens_used": 8839,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_HDWR_WALL_ANCHOR_WAH.mcr\n\n## Overview\nThis script inserts a Wall Anchor Hanger (WAH) onto timber studs to secure the wall structure to a foundation or floor. It automatically generates a vertical strap plate, lateral support flanges, and a drilled anchor plate with an associated anchor rod (e.g., J-Bolt).\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Used for 3D modeling of connections. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | Not applicable for 2D drawings. |\n\n## Prerequisites\n- **Required entities**: Timber Beams (Studs).\n- **Minimum beam count**: 1.\n- **Required settings files**:\n    - `TSL_HARDWARE_FAMILY_LIST.dxx`: Located in the company TSL Catalog folder.\n    - `GE_HDWR_ANCHOR_J-BOLT.mcr` (or similar): Required for the anchor rod sub-component.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `GE_HDWR_WALL_ANCHOR_WAH.mcr`.\n\n### Step 2: Select Studs\n```\nCommand Line: Select stud(s)\nAction: Click on the timber beam(s) where you want to install the anchor.\n```\n\n### Step 3: Select Reference Point\n```\nCommand Line: Select reference point: hangers will be inserted at closest end and closer face of members\nAction: Click near the top or bottom end of the selected stud. The script will automatically snap the anchor to the nearest end.\n```\n\n### Step 4: Select Hardware Type\nAction: A DotNet dialog will appear. Select the specific Wall Anchor model (e.g., WAH16) from the list. This sets the default dimensions for the connection.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | text | WAH16 | The specific model number or SKU of the wall anchor hardware. |\n| Clear width | number | 70 | The horizontal width of the metal bracket (parallel to the wall face). |\n| Overall depth | number | 560 | The vertical height of the main strap plate (parallel to the stud). |\n| Overall height | number | 50 | The projection depth of the anchor plate (distance the hardware extends out from the wall face). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Change type | Opens the hardware catalog dialog to select a different model, which resets dimensions to the new catalog defaults. |\n| Help | Displays a report with usage instructions and information. |\n\n## Settings Files\n- **Filename**: `TSL_HARDWARE_FAMILY_LIST.dxx`\n- **Location**: `_kPathHsbCompany\\TSL\\Catalog\\`\n- **Purpose**: Contains the database of hardware families (WAH) that define available sizes, dimensions, and anchor types.\n\n## Tips\n- The script is smart enough to detect the closest end of the stud based on where you click. You do not need to zoom in perfectly to the endpoint; just click near the desired end (top or bottom).\n- If you modify the width or depth manually but want to revert to the manufacturer's standard dimensions, simply right-click and select \"Change type,\" then re-select the same model.\n- This script creates a sub-component for the actual anchor rod (like a J-Bolt). Make sure the associated anchor script (e.g., `GE_HDWR_ANCHOR_J-BOLT.mcr`) is accessible in your search path.\n\n## FAQ\n- **Q: Can I use this script for multiple studs at once?**\n  A: Yes, you can select multiple studs during the insertion prompt, and the anchor will be applied to all of them based on the reference point location relative to each stud.\n- **Q: What happens if I change the \"Type\" property?**\n  A: Changing the type updates the hardware configuration and resets the geometric parameters (Width, Depth, Height) to match the new catalog entry.\n- **Q: How do I fix the issue where the metal part overlaps the beam incorrectly?**\n  A: Ensure you are using version 1.5 or higher of the script, as this bug was fixed in that release."
      },
      "tokens_used": 5087,
      "error": null
    }
  }
}