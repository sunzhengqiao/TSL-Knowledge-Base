{
  "filename": "Rothoblaas Titan F-N.mcr",
  "status": "completed",
  "total_tokens": 53436,
  "processing_time": 446.8765504360199,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "Rothoblaas TITAN F/N angle bracket for shear loads in solid stick frame walls or panels.",
        "versionHistory": [
          {
            "version": "1.2",
            "date": "22oct2018",
            "author": "david.rueda@hsbcad.com",
            "changes": "Thumbnail and description updated"
          },
          {
            "version": "1.1",
            "date": "14sept17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "major revision, updated geometry and hardware data"
          },
          {
            "version": "1.0",
            "date": "26oct16",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": "initial version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8605,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates 3D Body objects (bdBottomPlate, bdTopPlate, bdWasher), interacts with Beam and Sip entities via PrEntity selection, uses dp.draw() to render 3D geometry, and defines HardWrComp (hardware components) for BIM output. No ShopDrawing (#Type E), Sheet, View, or Paper Space (_kPaperSpace) specific functions are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam",
            "Sip"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space with existing horizontal structural elements (beams or panels).",
          "requiredSettings": []
        }
      },
      "tokens_used": 7123,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select beam(s) or panel(s)",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Dialog",
            "trigger": "_bOnInsert",
            "title": null,
            "dataSource": "TSL Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sArticleName",
            "type": "PropString",
            "displayName": "A - Type",
            "defaultValue": "Titan N - TCN 200",
            "inputType": "dropdown",
            "options": [
              "Titan N - TCN 200",
              "Titan N - TCN 240",
              "Titan N - TTN 240",
              "Titan F - TCF 200",
              "Titan F - TTF 200"
            ],
            "category": "Type",
            "description": "Defines the anchor model"
          },
          {
            "index": 1,
            "variable": "sWasher",
            "type": "PropString",
            "displayName": "B - Reinforcement Washer",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Type",
            "description": "Add a reinforcement washer to the anchor"
          },
          {
            "index": 2,
            "variable": "sNailType",
            "type": "PropString",
            "displayName": "C - Mounting type",
            "defaultValue": "Anchor Nail LBA 4x60",
            "inputType": "dropdown",
            "options": [
              "Anchor Nail LBA 4x60",
              "Round head screw LBS 5x50"
            ],
            "category": "Mounting",
            "description": "Defines, if the anchor will be fixed with screws or nails"
          },
          {
            "index": 3,
            "variable": "sMainScrew",
            "type": "PropString",
            "displayName": "D - Anchoring to the ground",
            "defaultValue": "Expansion anchor",
            "inputType": "dropdown",
            "options": [
              "Expansion anchor",
              "Screw anchor",
              "Chemical dowel VINYLPRO",
              "Chemical dowel EPOPLUS"
            ],
            "category": "Mounting",
            "description": "Sets how the anchor will be fixed on the ground"
          },
          {
            "index": 4,
            "variable": "dMainScrewDia",
            "type": "PropDouble",
            "displayName": "E - Screw Diameter",
            "defaultValue": 12.0,
            "inputType": "dropdown",
            "options": [
              12.0,
              16.0
            ],
            "category": "Mounting",
            "description": "Sets the diameter of the anchoring screw"
          },
          {
            "index": 5,
            "variable": "dMillDepth",
            "type": "PropDouble",
            "displayName": "F - Mill depth",
            "defaultValue": 0.0,
            "inputType": "number",
            "options": [],
            "category": "Tooling",
            "description": "Defines the depth of the milling, the anchor sits in"
          },
          {
            "index": 6,
            "variable": "dMillOversize",
            "type": "PropDouble",
            "displayName": "G - Oversize milling",
            "defaultValue": 5.0,
            "inputType": "number",
            "options": [],
            "category": "Tooling",
            "description": "Defines the oversize of the milling, the anchor sits in"
          },
          {
            "index": 7,
            "variable": "sNoNail",
            "type": "PropString",
            "displayName": "H - No nail areas",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Tooling",
            "description": "Defines, if no nail areas will be added to StickFrame walls\n(You need hsbCAM module for this)"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 8473,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates 3D models, CNC machining data, and BOM information for Rothoblaas TITAN F/N angle brackets used to anchor timber walls or panels to concrete foundations.",
          "category": "Hardware/Connection",
          "typicalUseCase": "When detailing a timber frame structure where hold-down anchors or shear anchors are required at the base of walls to resist uplift or lateral loads."
        },
        "parameters": [
          {
            "name": "sArticleName",
            "technicalDefault": "Titan N - TCN 200",
            "businessMeaning": "Selects the specific product model from the Rothoblaas catalogue, determining the physical dimensions (height, width, thickness) and pre-drilled hole configurations of the steel bracket.",
            "validRange": "List of supported models (Titan N or F variants with specific dimensions)",
            "unit": "enum",
            "affectsOutput": "Changes the size of the 3D steel body, the position/count of nail holes, and the compatibility with reinforcement washers."
          },
          {
            "name": "sWasher",
            "technicalDefault": "No",
            "businessMeaning": "Toggles the inclusion of an additional steel reinforcement plate (TCW) placed between the bracket and the timber to distribute load and prevent wood crushing.",
            "validRange": "Yes/No (Only available for Titan N - TCN 200/240 models)",
            "unit": "enum",
            "affectsOutput": "If 'Yes', adds a 3D washer body and adds the washer to the hardware BOM list."
          },
          {
            "name": "sNailType",
            "technicalDefault": "Anchor Nail LBA 4x60",
            "businessMeaning": "Specifies the fastener type used to attach the vertical flange of the bracket to the timber member (nails vs. screws).",
            "validRange": "LBA 4x60 (Nail) or LBS 5x50 (Screw)",
            "unit": "enum",
            "affectsOutput": "Updates the diameter (5mm vs 4mm) of the drill holes in the timber and changes the hardware listing in the BOM."
          },
          {
            "name": "sMainScrew",
            "technicalDefault": "Expansion anchor",
            "businessMeaning": "Defines the type of mechanical or chemical anchor used to fix the bottom flange of the bracket to the concrete foundation.",
            "validRange": "Expansion anchor, Screw anchor, Chemical dowel (VINYLPRO/EPOPLUS)",
            "unit": "enum",
            "affectsOutput": "Updates the material and part number in the hardware BOM for the concrete connection."
          },
          {
            "name": "dMainScrewDia",
            "technicalDefault": 12.0,
            "businessMeaning": "The diameter of the anchor bolt (M12 or M16) connecting the bracket to the concrete.",
            "validRange": "12.0, 16.0",
            "unit": "mm",
            "affectsOutput": "Updates the model string (e.g., M12) in the hardware BOM for the bottom connection."
          },
          {
            "name": "dMillDepth",
            "technicalDefault": 0.0,
            "businessMeaning": "The depth of the recess (milling) cut into the timber surface so the bracket sits flush or below the timber face.",
            "validRange": "0.0 to 50.0",
            "unit": "mm",
            "affectsOutput": "Generates a milling pocket (negative body) in the timber element if value > 0."
          },
          {
            "name": "dMillOversize",
            "technicalDefault": 5.0,
            "businessMeaning": "The additional clearance added to the width and length of the milling pocket to ensure easy fit of the bracket.",
            "validRange": "0.0 to 20.0",
            "unit": "mm",
            "affectsOutput": "Expands the dimensions of the milling pocket beyond the nominal bracket size."
          },
          {
            "name": "sNoNail",
            "technicalDefault": "No",
            "businessMeaning": "Activates the generation of 'no-nail zones' (protected areas) around the bracket where automated nailing machines should not place fasteners.",
            "validRange": "Yes/No",
            "unit": "enum",
            "affectsOutput": "Visualizes restricted nail areas and generates data for hsbCAM to prevent nail placement in these zones."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing 'sArticleName' to Titan F models (TCF/TTF)",
            "effect": "The 'sWasher' option becomes invalid as washers are only designed for the Titan N models (TCN 200/240).",
            "cascade": [
              "sWasher"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "3D Body",
            "description": "The steel angle bracket (and optional washer) visualized as a solid body.",
            "appliedTo": "Model Space representation"
          },
          {
            "type": "Drill/Mill",
            "description": "Milling pocket for the bracket seat and drill holes for the timber fasteners (nails/screws).",
            "appliedTo": "Selected Beam or Sip element"
          },
          {
            "type": "Hardware (BOM)",
            "description": "Bill of Materials entries for the bracket, concrete anchors, timber fasteners, and washers.",
            "appliedTo": "Element's BOM list"
          }
        ]
      },
      "tokens_used": 10580,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched via command or catalog.",
          "2. Check for Execute Key (_kExecuteKey) to load preset values from a specific catalog entry; otherwise load '_LastInserted' settings.",
          "3. Display Properties Dialog for user to configure Anchor Type, Washer, Mounting, and Tooling settings.",
          "4. Prompt user to select Beams or Panels (PrEntity).",
          "5. Filter selection: Automatically remove any beams that are not horizontal (not perpendicular to Z-axis).",
          "6. Iterate through each valid selected beam/panel:",
          "   6a. Highlight the current beam.",
          "   6b. Prompt user to select the side of the beam for placement (PrPoint).",
          "   6c. Create a cloned instance of the script attached to that beam at the calculated location.",
          "7. Individual Instance Execution:",
          "   7a. Retrieve geometry parameters based on the selected 'Article Name'.",
          "   7b. Validate beam height: Check if the timber is tall enough for the selected anchor's nail pattern.",
          "   7c. Generate 3D Bodies: Create the main anchor plates and, if enabled/valid, the reinforcement washer.",
          "   7d. Generate Machining: Create drill holes for nails and a milling pocket (if Mill Depth > 0).",
          "   7e. Generate Hardware: Populate the BOM with anchors, screws, and washers."
        ],
        "conditionalBranches": [
          {
            "condition": "Anchor Model Selection (sArticleName) - Washer Availability",
            "path1": {
              "name": "Washer Allowed",
              "steps": [
                "Condition met if 'Titan N - TCN 200' or 'Titan N - TCN 240' is selected.",
                "If 'B - Reinforcement Washer' is set to 'Yes', a 3D Washer body is generated.",
                "Washer hardware is added to BOM."
              ]
            },
            "path2": {
              "name": "Washer Ignored",
              "steps": [
                "Condition met if Titan F models or Titan N TTN 240 are selected.",
                "The 'sWasher' property is ignored, even if set to 'Yes'.",
                "No washer geometry or hardware is generated."
              ]
            }
          },
          {
            "condition": "Beam Height vs. Anchor Type",
            "path1": {
              "name": "Valid Height",
              "steps": [
                "Titan N: Timber height >= 140mm.",
                "Titan F: Timber height >= 60mm (min 2 rows) to 90mm (max 6 rows).",
                "Nail holes are generated according to the available height (dTimberHeightBehind)."
              ]
            },
            "path2": {
              "name": "Invalid Height",
              "steps": [
                "Timber height is below the minimum threshold.",
                "Error message reported: 'Bottom beam's section height is to small for this anchor'.",
                "Instance is erased (deleted)."
              ]
            }
          },
          {
            "condition": "Bottom Hole Diameter (dHoleDiaBottom)",
            "path1": {
              "name": "Standard Anchor (dHole > 5mm)",
              "steps": [
                "Drills two large holes in the bottom plate (for concrete anchors).",
                "Adds 'Anchoring to the ground' hardware to BOM."
              ]
            },
            "path2": {
              "name": "Nail Fixed / Small Holes (dHole == 5mm)",
              "steps": [
                "Generates 6 rows of smaller nail holes in the bottom flange.",
                "No ground anchor hardware is added to BOM."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Orientation",
            "errorMessage": "X not horizontal beams were filtered out",
            "recovery": "User does not need to fix this manually; the script removes invalid entities from the selection set automatically."
          },
          {
            "check": "Beam Section Height (dTimberHeightBehind)",
            "errorMessage": "Bottom beam's section height is to small for this anchor ---> Tool will be deleted",
            "recovery": "Select a beam with a larger height or change the 'Anchor Type' to a smaller model (e.g., Titan F) and re-insert."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Properties",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Changing 'Article Name', 'Washer', 'Mill Depth', etc., triggers a recalculation of the 3D geometry, drill patterns, and BOM list for that specific instance."
          },
          {
            "action": "Move Anchor",
            "how": "Standard CAD Move/Grip Edit",
            "effect": "The TSL instance moves with the beam. If the beam length changes, the anchor position updates relative to the beam's coordinate system."
          }
        ]
      },
      "tokens_used": 11691,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Rothoblaas Titan F-N.mcr\n\n## Overview\nGenerates 3D models, CNC machining data, and BOM information for Rothoblaas TITAN F/N angle brackets used to anchor timber walls or panels to concrete foundations.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Creates 3D steel bodies, machining, and hardware lists. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required entities**: Beams or Sip (Structural Insulated Panel) elements.\n- **Minimum beam count**: 1.\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Rothoblaas Titan F-N.mcr`\n\n### Step 2: Configure Anchor Properties\n```\nDialog: AutoCAD Properties Palette (OPM)\nAction: Configure the anchor settings before selecting geometry.\n- Select the specific Model (Type).\n- Choose Reinforcement Washer (Yes/No) if applicable.\n- Set Mounting type (Nails or Screws) and Anchoring method.\n- Adjust Mill depth/oversize if recessing is required.\n```\n\n### Step 3: Select Beams or Panels\n```\nCommand Line: Select beam(s) or panel(s)\nAction: Click on the horizontal timber elements or panels to receive the anchor.\nNote: The script automatically filters out beams that are not perfectly horizontal.\n```\n\n### Step 4: Define Placement Side\n```\nCommand Line: Select point on beam side\nAction: For each beam selected, click on the specific face (side) where the bracket should be mounted.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| A - Type | dropdown | Titan N - TCN 200 | Selects the specific product model (Titan N or F variants), determining dimensions and hole patterns. |\n| B - Reinforcement Washer | dropdown | No | Adds a steel reinforcement plate (TCW) between the bracket and timber. Only valid for Titan N - TCN 200/240. |\n| C - Mounting type | dropdown | Anchor Nail LBA 4x60 | Selects the fastener for attaching the bracket to the timber (Nails vs. Round head screws). |\n| D - Anchoring to the ground | dropdown | Expansion anchor | Defines the anchor type for the concrete connection (Expansion, Screw, or Chemical dowel). |\n| E - Screw Diameter | dropdown | 12.0 | Diameter of the concrete anchor bolt (M12 or M16). |\n| F - Mill depth | number | 0.0 | Depth of the recess (milling) cut into the timber surface for the bracket. |\n| G - Oversize milling | number | 5.0 | Additional clearance added to the milling pocket dimensions. |\n| H - No nail areas | dropdown | No | Adds protected zones around the bracket for automated nailing machines (requires hsbCAM). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Properties | Opens the Properties Palette to edit parameters (Type, Washer, Tooling, etc.). |\n| Erase | Removes the script instance and associated geometry. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not use external settings files; all configurations are stored in script properties.\n\n## Tips\n- **Horizontal Beams Only**: The script automatically ignores vertical or sloped beams. Ensure your wall bottom plates are horizontal.\n- **Height Constraints**: Ensure your timber height is sufficient. Titan N requires a minimum height of 140mm. Titan F requires at least 60mm.\n- **Washer Compatibility**: The \"Reinforcement Washer\" option is only active for Titan N - TCN 200 and TCN 240 models. It will be ignored if you select a Titan F model.\n- **Recessing**: If you set \"Mill depth\" greater than 0, the bracket will be embedded into the timber. Ensure \"Oversize milling\" allows enough clearance for easy installation.\n\n## FAQ\n- **Q: Why did the script delete itself immediately after I placed it?**\n  **A:** The beam height is likely too small for the selected anchor model. Check the error message on the command line (e.g., \"Bottom beam's section height is to small\") and switch to a smaller anchor type if necessary.\n- **Q: Why were some of my beams ignored when I selected them?**\n  **A:** The script filters the selection to keep only perfectly horizontal beams (perpendicular to the Z-axis). Non-horizontal beams are automatically removed from the selection set.\n- **Q: I selected \"Yes\" for the Reinforcement Washer, but I don't see it in the model.**\n  **A:** Washers are only supported for Titan N - TCN 200 and Titan N - TCN 240. If you selected a Titan F model or Titan N - TTN 240, the washer option is disabled by the script logic."
      },
      "tokens_used": 6964,
      "error": null
    }
  }
}