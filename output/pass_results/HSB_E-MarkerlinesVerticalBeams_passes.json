{
  "filename": "HSB_E-MarkerlinesVerticalBeams.mcr",
  "status": "completed",
  "total_tokens": 37116,
  "processing_time": 299.9100499153137,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 1,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "Tsl to create marker lines at the location of vertical beams on a specific zone.",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "19.03.2013",
            "author": "",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "22.12.2016",
            "author": "",
            "changes": "Update summary."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5473,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly uses _kModelSpace when creating TSL instances (tsl.dbCreate(..., _kModelSpace, ...)). It interacts with Element and Beam entities and adds ElemMarker tools to the element, which is a model-space operation. There are no references to sd_ prefixes, Viewport handling, or _kPaperSpace."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space containing an Element (Wall, Floor, or Roof) with vertical beams.",
          "requiredSettings": []
        }
      },
      "tokens_used": 3024,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSeperator01",
            "type": "PropString",
            "displayName": "Selection",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sApplyToolingToElementType",
            "type": "PropString",
            "displayName": "     Apply tooling to element type(s)",
            "defaultValue": "Roof",
            "inputType": "dropdown",
            "options": [
              "Roof",
              "Roof;Floor",
              "Roof;Floor;Wall",
              "Floor",
              "Floor;Wall",
              "Wall"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sFilterBC",
            "type": "PropString",
            "displayName": "     Only mark beams with beamcode",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sSeperator02",
            "type": "PropString",
            "displayName": "Tooling",
            "defaultValue": "",
            "inputType": "separator",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dMarkSize",
            "type": "PropDouble",
            "displayName": "     Length markerline",
            "defaultValue": "300.0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sApplyToolingTo",
            "type": "PropString",
            "displayName": "     Apply tooling to",
            "defaultValue": "Zone 1",
            "inputType": "dropdown",
            "options": [
              "Zone 1",
              "Zone 2",
              "Zone 3",
              "Zone 4",
              "Zone 5",
              "Zone 6",
              "Zone 7",
              "Zone 8",
              "Zone 9",
              "Zone 10"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nToolingIndex",
            "type": "PropInt",
            "displayName": "     Toolindex",
            "defaultValue": "10",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7288,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates layout marker lines on element surfaces (zones) to indicate the position of vertical beams (studs/posts) intersecting the element.",
          "category": "ShopDrawing / Tooling",
          "typicalUseCase": "Used in floor or roof panels to mark the locations of intersecting wall studs or columns on the top/bottom surface, aiding in installation or manufacturing alignment."
        },
        "parameters": [
          {
            "name": "sApplyToolingToElementType",
            "technicalDefault": "Roof",
            "businessMeaning": "Filters the script to run only on specific construction types (Roof, Floor, or Wall). This prevents the script from executing on elements where the marker logic is not intended (e.g., avoiding floor marks when targeting roof panels).",
            "validRange": "Selection list: [Roof, Floor, Wall] or combinations thereof",
            "unit": "enum",
            "affectsOutput": "Determines if the script processes the selected element at all. If the element type does not match, no markers are generated."
          },
          {
            "name": "sFilterBC",
            "technicalDefault": "",
            "businessMeaning": "Filters which vertical beams should be marked based on their Beam Code (e.g., only mark 'Stud' or 'Column', ignoring 'Rim').",
            "validRange": "Text string (BeamCodes separated by semicolons)",
            "unit": "string",
            "affectsOutput": "Reduces the number of markers generated. Only beams matching the codes in this list will receive marker lines. Empty string implies all vertical beams are marked."
          },
          {
            "name": "dMarkSize",
            "technicalDefault": "300.0",
            "businessMeaning": "The visible length of the marker line drawn along the axis of the vertical beam.",
            "validRange": "50.0 - 1000.0",
            "unit": "mm",
            "affectsOutput": "Controls the visual length of the line on the drawing/production output. Longer lines are easier to see but may overlap if beams are close together."
          },
          {
            "name": "sApplyToolingTo",
            "technicalDefault": "Zone 1",
            "businessMeaning": "Specifies which specific layer or zone of the element (e.g., Top surface, Bottom surface, Sheathing layer) receives the marker lines.",
            "validRange": "Selection list: [Zone 1 through Zone 10]",
            "unit": "enum",
            "affectsOutput": "Determines the vertical position and orientation of the marker lines relative to the element's cross-section."
          },
          {
            "name": "nToolingIndex",
            "technicalDefault": "10",
            "businessMeaning": "The identification number for the tooling/marker in the CAM/CNC database or drawing style.",
            "validRange": "1 - 100",
            "unit": "index",
            "affectsOutput": "Assigns the graphical properties (color, layer, line type) of the marker in CAD views and the machine operation code in production data."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Element detection during execution",
            "effect": "Checks if the Element's geometry matches 'sApplyToolingToElementType'.",
            "cascade": [
              "sApplyToolingToElementType"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "ElemMarker",
            "description": "A 2D line drawn on a specific zone, indicating the path of a vertical beam. Two lines are drawn per beam intersection (offset to the edges of the beam width).",
            "appliedTo": "The parent Element (Wall, Floor, or Roof) specified during insertion."
          }
        ]
      },
      "tokens_used": 6980,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script Initiated: User runs command or inserts instance.\",\n    \"Check Insertion Cycle: If insertCycleCount > 1, erase instance and exit (prevents duplicate execution).\",\n    \"Display Dialog: Show Properties Palette (OPM) for user configuration (Zone, Beam Codes, etc.).\",\n    \"Prompt Selection: Ask user to select a set of Elements (Walls/Floors/Roofs).\",\n    \"Process Selection: Iterate through each selected Element.\",\n    \"Clean Up: Check if the script instance already exists on the Element for the specific Target Zone. If yes, erase the old instance.\",\n    \"Instance Creation: Create a new Satellite TSL instance attached to the Element in ModelSpace.\",\n    \"Master Cleanup: The Master (insert) instance erases itself and stops.\",\n    \"Satellite Execution: The new Satellite instance loads properties passed from the Master.\",\n    \"Parse Filters: Parse the Beam Code filter string into an array of valid codes.\",\n    \"Element Validation: Check if the Satellite is attached to a valid Element. If not, erase and exit.\",\n    \"Determine Element Type: Calculate Element orientation (Floor, Wall, or Roof) based on the Z-axis vector relative to World UCS.\",\n    \"Type Validation: Check if the calculated Element Type matches the 'Apply tooling to element type(s)' property.\",\n    \"[Conditional] Type Mismatch: If no match, report message and erase instance.\",\n    \"Type Match: Proceed to process beams.\",\n    \"Beam Collection: Retrieve all beams associated with the Element.\",\n    \"Beam Filtering Loop: Iterate through all beams to find valid candidates.\",\n    \"Filter Check 1: Ensure beam axis is parallel to the Element's Y-axis.\",\n    \"Filter Check 2: Ensure beam is located on the correct side/position relative to the Target Zone.\",\n    \"Filter Check 3: Ensure beam code matches the user-defined filter (if any).\",\n    \"Marker Generation: For each valid beam, calculate two marker lines offset by the beam's width.\",\n    \"Tooling Application: Add ElemMarker entities to the Element at the calculated locations with the specified Tool Index.\",\n    \"Completion: Script finishes recalculation.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Does the calculated Element Type match the property 'sApplyToolingToElementType'?\",\n      \"path1\": {\n        \"name\": \"Type Match\",\n        \"steps\": [\n          \"Script proceeds to beam collection.\",\n          \"Iterates through beams and applies filters.\",\n          \""
      },
      "tokens_used": 8463,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-MarkerlinesVerticalBeams.mcr\n\n## Overview\nThis script creates marker lines on specific zones of floor or roof elements to indicate the positions of intersecting vertical beams (such as wall studs or columns). It is typically used for manufacturing alignment or to mark drilling points on horizontal panels.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script interacts with 3D Element and Beam entities. |\n| Paper Space | No | This script operates on the model geometry, not 2D views. |\n| Shop Drawing | No | Tooling is applied directly to the element in the model. |\n\n## Prerequisites\n- **Required entities**: An Element (Floor, Roof, or Wall) that intersects with vertical beams.\n- **Minimum beam count**: 0.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse and select `HSB_E-MarkerlinesVerticalBeams.mcr`.\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the Floor or Roof elements in the model where you want to mark the vertical beam locations. Press Enter to confirm selection.\n```\n\n### Step 3: Adjust Properties (Optional)\nIf the results are not as expected, select the Element, find the TSL instance in the Project Manager or Properties Palette, and adjust the parameters (see below). Run **Recalculate** to update.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Selection** | *separator* | | |\n| Apply tooling to element type(s) | dropdown | Roof | Filters which elements are processed. Options include Roof, Floor, Wall, or combinations (e.g., \"Roof;Floor\"). |\n| Only mark beams with beamcode | text | | Filters vertical beams by their Beam Code. Leave empty to mark all vertical beams. Use semicolons to separate multiple codes (e.g., \"Stud;Post\"). |\n| **Tooling** | *separator* | | |\n| Length markerline | number | 300.0 | Sets the visible length of the marker line (in mm). |\n| Apply tooling to | dropdown | Zone 1 | Selects the specific material zone (layer) on which to draw the markers (e.g., Top surface, Bottom surface). |\n| Toolindex | number | 10 | Defines the tooling number used for CAM/CNC export and determines the visual style (color/layer) in CAD. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (None specific) | No custom context menu items are defined. Standard hsbCAD options (Recalculate, Erase) apply when selecting the script instance. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Beam Filtering**: If your roof has many small members (like purlins) intersecting, use the \"Only mark beams with beamcode\" property to target only major structural members (like walls or columns).\n- **Visual Overlap**: If beams are very close together, reduce the \"Length markerline\" value to prevent the lines from overlapping and becoming unreadable.\n- **Element Type**: Ensure \"Apply tooling to element type(s)\" matches the elements you selected. If you select a Floor but the property is set only to \"Roof\", no markers will appear.\n\n## FAQ\n- **Q: I ran the script, but no lines appeared.**\n  - A: Check the \"Apply tooling to element type(s)\" property. If you selected a Wall but the property is set to \"Roof\", it will not process. Also, ensure the beams intersecting the element are actually vertical relative to that element.\n- **Q: Can I mark beams on the bottom surface of a floor?**\n  - A: Yes. Change the \"Apply tooling to\" property to the Zone number that corresponds to the bottom surface or sheathing layer of your floor element.\n- **Q: How do I change the color of the lines?**\n  - A: You cannot change the color directly in this script. The color is determined by the \"Toolindex\". You must modify the layer or tool style associated with that Tool Index in your hsbCAD or AutoCAD configuration."
      },
      "tokens_used": 5888,
      "error": null
    }
  }
}