{
  "filename": "HSB_W-Post.mcr",
  "status": "completed",
  "total_tokens": 60243,
  "processing_time": 699.8441495895386,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.00",
            "date": "07.05.2014",
            "author": "Alberto Jena",
            "changes": "Release Version"
          },
          {
            "version": "1.0",
            "date": "16.10.2014",
            "author": "Anno Sportel",
            "changes": ""
          },
          {
            "version": "1.02",
            "date": "10.02.2016",
            "author": "Anno Sportel",
            "changes": "Add split types and gap."
          },
          {
            "version": "1.03",
            "date": "17.02.2016",
            "author": "Anno Sportel",
            "changes": "Correct property indexes."
          },
          {
            "version": "1.04",
            "date": "31.01.2017",
            "author": "Anno Sportel",
            "changes": "Set default sizes for post"
          },
          {
            "version": "1.5",
            "date": "27.05.2021",
            "author": "Thorsten Huck",
            "changes": "HSB-12021 bugfix if amount of bottom and top rail are not of same length"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 9074,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for ElementWall selection using PrEntity, operates on 3D geometry via Element.coordSys(), creates new Beam and Sheet entities using dbCreate, and assigns them to ElementGroups. Absence of sd_ prefix, Viewport handling, or ShopDrawing specific classes confirms Model Space usage."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall",
            "TopPlate (Beam type _kSFTopPlate)",
            "BottomPlate (Beam type _kSFBottomPlate)"
          ],
          "minimumBeams": 2,
          "requiredSpace": "3D Model Space",
          "requiredSettings": [
            "Extrusion Profile Catalog (referenced by sProfile)"
          ]
        }
      },
      "tokens_used": 7625,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Please select Element\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Pick a reference point to insert post\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"ShowDialogOnce\",\n      \"trigger\": \"On Insert if _kExecuteKey is empty\",\n      \"title\": null,\n      \"dataSource\": \"Properties Palette\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sProfile\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Extrusion profile name|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"postWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Default post width|\",\n      \"defaultValue\": \"U(70)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": \"|The default post width.||This is only used for rectangular and round extrusion profiles.|\"\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"postHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Default post height|\",\n      \"defaultValue\": \"U(70)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": \"|The default post width.||This is only used for rectangular and round extrusion profiles.|\"\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"sAlign\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Alignment|\",\n      \"defaultValue\": \"|Left|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Left|\",\n        \"|Center|\",\n        \"|Right|\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"dOffsetTop\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset top|\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"dOffsetBottom\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset bottom|\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sPlateTopSeparator\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Top plate|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sPlateTop\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     |Create plate top|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"dPlateTopWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate top width|\",\n      \"defaultValue\": \"U(1500)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"dPlateTopHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate top height|\",\n      \"defaultValue\": \"U(150)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"dPlateTopThickness\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate top thickness|\",\n      \"defaultValue\": \"U(250)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"dPlateTopOffsetX\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate top offset| X\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dPlateTopOffsetY\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate top offset| Y\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sPlateBottomSeparator\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Bottom plate|\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sPlateBottom\",\n      \"type\": \"PropString\",\n      \"displayName\": \"     |Create plate bottom|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dPlateBottomWidth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate bottom width|\",\n      \"defaultValue\": \"U(1500)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dPlateBottomHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate bottom height|\",\n      \"defaultValue\": \"U(150)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"dPlateBottomThickness\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate bottom thickness|\",\n      \"defaultValue\": \"U(250)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"dPlateBottomOffsetX\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate Bottom offset| X\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"dPlateBottomOffsetY\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"     |Plate bottom offset| Y\",\n      \"defaultValue\": \"U(0)\",\n      \"inputType\": \"number\",\n      \"options\": null,\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nZones\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Zone to assign the plates|\",\n      \"defaultValue\": 1,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        1,\n        2,\n        3,\n        4,\n        5,\n        6,\n        7,\n        8,\n        9,\n        10\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 8"
      },
      "tokens_used": 10414,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Inserts a vertical steel post (column) into a timber wall element, with optional top and bottom connection plates. It also manages the cutting and splitting of the existing timber top and bottom plates to accommodate the post.\",\n    \"category\": \"Hardware/Framing\",\n    \"typicalUseCase\": \"Used to add structural steel reinforcement or support columns within a timber framed wall, such as under a ridge beam or at corners, while ensuring proper connection detailing with steel plates.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sProfile\",\n      \"technicalDefault\": \"\\\"\\\"\",\n      \"businessMeaning\": \"The specific catalog cross-section profile for the steel post (e.g., HEA, IPE, SHS). If 'Rectangular' or 'Round' is selected, the script uses the manual Width/Height dimensions.\",\n      \"validRange\": \"Catalog names or '_kExtrProfRectangular'/'_kExtrProfRound'\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Determines the cross-sectional geometry and material of the inserted post.\"\n    },\n    {\n      \"name\": \"postWidth\",\n      \"technicalDefault\": \"U(70)\",\n      \"businessMeaning\": \"The width of the post along the wall's length axis. Only active if sProfile is Rectangular or Round.\",\n      \"validRange\": \"10 - 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the dimension of the post along the wall length and influences the split locations of wall plates.\"\n    },\n    {\n      \"name\": \"postHeight\",\n      \"technicalDefault\": \"U(70)\",\n      \"businessMeaning\": \"The depth of the post perpendicular to the wall face. Only active if sProfile is Rectangular or Round.\",\n      \"validRange\": \"10 - 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Sets the dimension of the post across the wall thickness.\"\n    },\n    {\n      \"name\": \"sAlign\",\n      \"technicalDefault\": \"|Left|\",\n      \"businessMeaning\": \"Aligns the post relative to the user-clicked reference point along the wall's length.\",\n      \"validRange\": \"Left / Center / Right\",\n      \"unit\": \"Enum\",\n      \"affectsOutput\": \"Moves the post horizontally along the wall.\"\n    },\n    {\n      \"name\": \"dOffsetTop\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Vertical adjustment of the post's top end relative to the flush top of the wall.\",\n      \"validRange\": \"-500 to 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Lengthens or shortens the post from the top. Positive moves it up (higher).\"\n    },\n    {\n      \"name\": \"dOffsetBottom\",\n      \"technicalDefault\": \"U(0)\",\n      \"businessMeaning\": \"Vertical adjustment of the post's bottom end relative to the flush bottom of the wall.\",\n      \"validRange\": \"-500 to 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Lengthens or shortens the post from the bottom. Positive moves it down (lower).\"\n    },\n    {\n      \"name\": \"sPlateTop\",\n      \"technicalDefault\": \"|No|\",\n      \"businessMeaning\": \"Enables or disables the creation of a steel connection plate at the top of the post.\",\n      \"validRange\": \"Yes / No\",\n      \"unit\": \"Boolean\",\n      \"affectsOutput\": \"Toggles the generation of the top steel sheet.\"\n    },\n    {\n      \"name\": \"dPlateTopWidth\",\n      \"technicalDefault\": \"U(1500)\",\n      \"businessMeaning\": \"The horizontal length of the top steel plate along the wall.\",\n      \"validRange\": \"100 - 3000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Size of the top plate. Determines split points if 'Split at plate' is selected.\"\n    },\n    {\n      \"name\": \"dPlateTopHeight\",\n      \"technicalDefault\": \"U(150)\",\n      \"businessMeaning\": \"The vertical height of the top steel plate.\",\n      \"validRange\": \"50 - 500 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Visual size of the top plate.\"\n    },\n    {\n      \"name\": \"dPlateTopThickness\",\n      \"technicalDefault\": \"U(250)\",\n      \"businessMeaning\": \"The"
      },
      "tokens_used": 12225,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 13312,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_W-Post.mcr\n\n## Overview\nThis script inserts a vertical steel post (column) into a timber wall element to provide structural reinforcement. It supports optional top and bottom steel connection plates and automatically handles the cutting and splitting of existing timber top and bottom plates to accommodate the new post.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on 3D wall elements and geometry. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Not intended for manufacturing views. |\n\n## Prerequisites\n- **Required Entities**: An `ElementWall` with valid Top Plate (Beam type `_kSFTopPlate`) and Bottom Plate (Beam type `_kSFBottomPlate`) already existing in the model.\n- **Minimum Beam Count**: 2 (The top and bottom plates of the wall).\n- **Required Settings**: Access to an Extrusion Profile Catalog to select steel sections.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_W-Post.mcr` from the list.\n\n### Step 2: Select Wall Element\n```\nCommand Line: Please select Element\nAction: Click on the target timber wall in the drawing that requires the post.\n```\n\n### Step 3: Pick Insertion Point\n```\nCommand Line: Pick a reference point to insert post\nAction: Click near the location along the wall where you want the post to be placed.\n```\n\n### Step 4: Configure Properties\nAfter placement, select the inserted script instance and adjust the dimensions, profile, and plate settings in the Properties Palette to fit your design requirements.\n\n## Properties Panel Parameters\n\n### General Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Extrusion profile name | dropdown | *Empty* | Select the steel profile catalog name (e.g., HEA, IPE). Leave empty to use manual dimensions. |\n| Default post width | number | 70 mm | Width of the post (along wall length). Used if profile is Rectangular or Round. |\n| Default post height | number | 70 mm | Depth of the post (perpendicular to wall). Used if profile is Rectangular or Round. |\n| Alignment | dropdown | Left | Aligns the post relative to the clicked point: Left, Center, or Right. |\n| Offset top | number | 0 mm | Vertical adjustment at the top. Positive moves the post up. |\n| Offset bottom | number | 0 mm | Vertical adjustment at the bottom. Positive moves the post down. |\n| Zone to assign the plates | dropdown | 1 | Assigns the generated plates to a specific manufacturing zone. |\n\n### Top Plate Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Create plate top | dropdown | No | Set to \"Yes\" to generate a steel plate at the top of the post. |\n| Plate top width | number | 1500 mm | Horizontal length of the top plate along the wall. |\n| Plate top height | number | 150 mm | Vertical height of the top plate. |\n| Plate top thickness | number | 250 mm | Thickness of the top plate. |\n| Plate top offset X | number | 0 mm | Horizontal shift of the top plate relative to the post. |\n| Plate top offset Y | number | 0 mm | Vertical shift of the top plate relative to the post top. |\n\n### Bottom Plate Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Create plate bottom | dropdown | No | Set to \"Yes\" to generate a steel plate at the bottom of the post. |\n| Plate bottom width | number | 1500 mm | Horizontal length of the bottom plate along the wall. |\n| Plate bottom height | number | 150 mm | Vertical height of the bottom plate. |\n| Plate bottom thickness | number | 250 mm | Thickness of the bottom plate. |\n| Plate bottom offset X | number | 0 mm | Horizontal shift of the bottom plate relative to the post. |\n| Plate bottom offset Y | number | 0 mm | Vertical shift of the bottom plate relative to the post bottom. |\n\n## Right-Click Menu Options\nStandard hsbCAD context menu options apply.\n*   **Recalculate**: Refreshes the script geometry based on current wall properties and script settings.\n*   **Delete**: Removes the script and associated generated steel plates.\n\n## Settings Files\n-   **Extrusion Profile Catalog**: Referenced by the `sProfile` property.\n-   **Location**: Defined in your hsbCAD configuration (Company or Install path).\n-   **Purpose**: Provides the geometric definition for standard steel profiles (e.g., HEA100, IPE200).\n\n## Tips\n-   **Reference Point**: The \"Alignment\" setting (Left/Center/Right) is calculated based on the point you clicked in Step 3. If the post isn't where you expected, try changing the alignment or pick the point again.\n-   **Manual Dimensions**: If you need a custom rectangular steel size not in your catalog, leave the \"Extrusion profile name\" empty and use the \"Default post width\" and \"Default post height\" fields.\n-   **Plate Splitting**: The script automatically cuts the existing timber top and bottom plates around the steel post. The width of the steel post determines the gap in the timber.\n\n## FAQ\n-   **Q: Why didn't a steel plate generate?**\n    -   A: Ensure the \"Create plate top\" or \"Create plate bottom\" property is set to \"Yes\".\n-   **Q: The post is floating or cutting into the floor.**\n    -   A: Check the \"Offset bottom\" property. Adjusting this value will move the bottom of the post up or down relative to the wall's bottom plate.\n-   **Q: Can I use this on a wall without top/bottom plates?**\n    -   A: No, the script requires a valid ElementWall with recognized Top and Bottom plates to calculate the post height and perform splitting."
      },
      "tokens_used": 7593,
      "error": null
    }
  }
}