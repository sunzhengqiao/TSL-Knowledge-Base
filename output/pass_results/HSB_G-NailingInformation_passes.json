{
  "filename": "HSB_G-NailingInformation.mcr",
  "status": "completed",
  "total_tokens": 17310,
  "processing_time": 197.66322207450867,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 1858,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit usage of `_kModelSpace` in `Group().collectEntities(true, Element(), _kModelSpace);`. The script iterates through 3D Element entities to extract nail data and reports via `reportNotice`."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 2544,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3580,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a material take-off report listing the total quantity of nails used in the current drawing, grouped by nail tool index.",
          "category": "Reporting/Analysis",
          "typicalUseCase": "Used during the estimation or preparation phase to calculate total nail requirements for procurement or production scheduling based on existing nail lines in the model."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "ReportNotice",
            "description": "A text report displayed in the command line console containing the Tool Index and the rounded-up total count of nails for that specific tool.",
            "appliedTo": "Global Model Space"
          }
        ]
      },
      "tokens_used": 2892,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched via insertion (command line or catalog)",
          "Collect all Element entities from the current Model Space",
          "Iterate through each collected Element",
          "Scan each Element for Nail Lines across indices -5 to 5",
          "For each Nail Line found, calculate nail quantity (Path Length / Spacing)",
          "Determine if the Nail Line's Tool Index is already recorded",
          "Accumulate nail counts or append new Tool Index entries to arrays",
          "Print summary report of Tool Indices and total nail counts to the command line",
          "Script instance executes eraseInstance() and removes itself from the drawing"
        ],
        "conditionalBranches": [
          {
            "condition": "Comparison of current Nail Line Tool Index against the list of already processed indices",
            "path1": {
              "name": "Index Exists",
              "steps": [
                "Locate the existing index in the 'nailToolIndexes' array",
                "Add the current line's nail quantity to the running total in 'numberOfNails' array"
              ]
            },
            "path2": {
              "name": "New Index",
              "steps": [
                "Append the new Tool Index to the 'nailToolIndexes' array",
                "Append the current line's nail quantity to the 'numberOfNails' array"
              ]
            }
          }
        ],
        "validationRules": [],
        "postInsertionActions": []
      },
      "tokens_used": 3360,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-NailingInformation.mcr\n\n## Overview\nThis script generates a material take-off report for nail quantities used in the current drawing. It calculates the total number of nails required, grouped by the nail tool index, and displays the summary directly in the command line.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script analyzes entities in the 3D model. |\n| Paper Space | No | Not applicable for 2D layouts. |\n| Shop Drawing | No | This script analyzes the model, not drawing views. |\n\n## Prerequisites\n- **Required entities**: Elements (timber components) containing nail information.\n- **Minimum beam count**: 0.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-NailingInformation.mcr`\n\n### Step 2: Automatic Execution\n```\nCommand Line: [Calculates total nails...]\nAction: The script runs immediately upon insertion. No further user input is required.\n```\n\n### Step 3: View Results\n```\nCommand Line: Press F2 to open the Text Window\nAction: Review the generated list of Tool Indices and the total rounded-up quantity of nails for each index.\n```\n*Note: The script instance will automatically remove itself from the drawing after generating the report.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script has no user-editable properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | No context menu options are configured for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Check the Command Line**: The output is displayed in the AutoCAD command line history. If the list is long, press **F2** to open the full Text Window.\n- **Nail Calculation Logic**: The script calculates the quantity based on `(Path Length / Spacing)` and rounds the result up to the nearest whole number for reporting.\n- **Self-Cleaning**: Do not be alarmed if the script entity disappears immediately; this is intentional behavior to keep your drawing clean.\n\n## FAQ\n- **Q: Where is the report saved?**\n  - A: The report is not saved to a file. It is output directly to the AutoCAD command line console.\n- **Q: Why did the block disappear after I inserted it?**\n  - A: The script is designed to calculate data and then delete itself (`eraseInstance`) automatically to prevent cluttering the drawing.\n- **Q: Does it count nails in Shop Drawings?**\n  - A: No, it only scans for nail data within the Model Space Elements."
      },
      "tokens_used": 3076,
      "error": null
    }
  }
}