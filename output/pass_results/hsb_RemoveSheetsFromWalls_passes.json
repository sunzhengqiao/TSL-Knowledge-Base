{
  "filename": "hsb_RemoveSheetsFromWalls.mcr",
  "status": "completed",
  "total_tokens": 33541,
  "processing_time": 243.65288662910461,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "01.03.2012",
            "author": "Chirag Sawjani (csawjani@itw-industry.com)",
            "changes": "Release"
          },
          {
            "version": "1.2",
            "date": "16.04.2012",
            "author": "Chirag Sawjani (csawjani@itw-industry.com)",
            "changes": "Tool palette bugfix"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4956,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script operates on ElementWallSF entities retrieved via PrEntity and _Element. No sd_* prefixes, #Type E declarations, or _Viewport usage detected. It modifies Sheet entities associated with the Walls in the 3D model."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires Walls (ElementWallSF) to be selected in Model Space.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2987,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select one or More Elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialogOnce",
            "trigger": "On Insert",
            "title": null,
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "psWalls1",
            "type": "PropString",
            "displayName": "Wall 1 Codes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the Wall codes to use seperated by ;"
          },
          {
            "index": 1,
            "variable": "psZones1",
            "type": "PropString",
            "displayName": "Zones to Remove for Wall 1",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the number of the zones separate by ; (1-10)"
          },
          {
            "index": 2,
            "variable": "psWalls2",
            "type": "PropString",
            "displayName": "Wall 2 Codes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the Wall codes to use seperated by ;"
          },
          {
            "index": 3,
            "variable": "psZones2",
            "type": "PropString",
            "displayName": "Zones to Remove for  Wall 2",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the number of the zones separate by ; (1-10)"
          },
          {
            "index": 4,
            "variable": "psWalls3",
            "type": "PropString",
            "displayName": "Wall 3 Codes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the Wall codes to use seperated by ;"
          },
          {
            "index": 5,
            "variable": "psZones3",
            "type": "PropString",
            "displayName": "Zones to Remove for  Wall 3",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the number of the zones separate by ; (1-10)"
          },
          {
            "index": 6,
            "variable": "psWalls4",
            "type": "PropString",
            "displayName": "Wall 4 Codes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the Wall codes to use seperated by ;"
          },
          {
            "index": 7,
            "variable": "psZones4",
            "type": "PropString",
            "displayName": "Zones to Remove for  Wall 4",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": "Please type the number of the zones separate by ; (1-10)"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6610,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Removes specific sheathing or sheeting layers (Sheet entities) from selected wall elements based on their wall codes and construction zones.",
          "category": "Model Management / Editing",
          "typicalUseCase": "Used when specific walls need to have cladding or structural sheathing removed in certain zones, such as leaving areas open for windows, mechanical chases, or structural connections."
        },
        "parameters": [
          {
            "name": "psWalls1",
            "technicalDefault": "",
            "businessMeaning": "List of wall identifiers (codes) for the first group of walls to be processed. Only walls with matching codes will have sheets removed.",
            "validRange": "Text strings matching project wall codes (e.g., 'W_EXT_01;W_EXT_02')",
            "unit": "Text",
            "affectsOutput": "Filters which elements are targeted for sheet removal in Group 1."
          },
          {
            "name": "psZones1",
            "technicalDefault": "",
            "businessMeaning": "Identifies the specific construction zones (layers) to remove from the walls defined in 'Wall 1 Codes'. Zones 1-5 typically map to positive indices, and 6-10 typically map to negative indices representing layer sides.",
            "validRange": "Integers 1-10 separated by semicolons",
            "unit": "Index/Count",
            "affectsOutput": "Determines which specific sheet layers are deleted from Group 1 walls."
          },
          {
            "name": "psWalls2",
            "technicalDefault": "",
            "businessMeaning": "List of wall identifiers for the second group of walls.",
            "validRange": "Text strings matching project wall codes",
            "unit": "Text",
            "affectsOutput": "Filters which elements are targeted for sheet removal in Group 2."
          },
          {
            "name": "psZones2",
            "technicalDefault": "",
            "businessMeaning": "Identifies the specific construction zones to remove from the walls defined in 'Wall 2 Codes'.",
            "validRange": "Integers 1-10 separated by semicolons",
            "unit": "Index/Count",
            "affectsOutput": "Determines which specific sheet layers are deleted from Group 2 walls."
          },
          {
            "name": "psWalls3",
            "technicalDefault": "",
            "businessMeaning": "List of wall identifiers for the third group of walls.",
            "validRange": "Text strings matching project wall codes",
            "unit": "Text",
            "affectsOutput": "Filters which elements are targeted for sheet removal in Group 3."
          },
          {
            "name": "psZones3",
            "technicalDefault": "",
            "businessMeaning": "Identifies the specific construction zones to remove from the walls defined in 'Wall 3 Codes'.",
            "validRange": "Integers 1-10 separated by semicolons",
            "unit": "Index/Count",
            "affectsOutput": "Determines which specific sheet layers are deleted from Group 3 walls."
          },
          {
            "name": "psWalls4",
            "technicalDefault": "",
            "businessMeaning": "List of wall identifiers for the fourth group of walls.",
            "validRange": "Text strings matching project wall codes",
            "unit": "Text",
            "affectsOutput": "Filters which elements are targeted for sheet removal in Group 4."
          },
          {
            "name": "psZones4",
            "technicalDefault": "",
            "businessMeaning": "Identifies the specific construction zones to remove from the walls defined in 'Wall 4 Codes'.",
            "validRange": "Integers 1-10 separated by semicolons",
            "unit": "Index/Count",
            "affectsOutput": "Determines which specific sheet layers are deleted from Group 4 walls."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Defining Wall Codes (e.g., psWalls1)",
            "effect": "The corresponding Zones parameter (e.g., psZones1) dictates the action applied to those specific walls.",
            "cascade": [
              "psWalls1",
              "psZones1"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Sheet (Sheathing Material)",
            "description": "The script performs a deletion operation. It identifies Sheet entities associated with the specified zones and erases them from the model.",
            "appliedTo": "ElementWallSF entities selected via PrEntity whose codes match the Wall properties."
          }
        ]
      },
      "tokens_used": 6348,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Start: Define properties and arrays.",
          "On Insert Trigger: Check if execution is a duplicate (insertCycleCount > 1).",
          "[Conditional] Branch: If duplicate, erase instance and exit.",
          "Primary Insertion: Check if _kExecuteKey is empty to show Dialog.",
          "User Input: Prompt for selection of one or more ElementWallSF entities (PrEntity).",
          "Data Storage: Append selected entities to the internal _Element list.",
          "Return: End execution to allow property input.",
          "Recalculation/Execution: Parse property strings (psWalls1-4, psZones1-4) into arrays.",
          "String Processing: Trim whitespace and split strings by ';' delimiter.",
          "Zone Mapping: Convert input zones (1-10) to internal indices (1-5 and -1 to -5).",
          "Element Iteration: Loop through each element in the _Element collection.",
          "Element Validation: Skip invalid elements.",
          "Wall Set Identification: Compare element code against sArWalls1, sArWalls2, sArWalls3, and sArWalls4.",
          "[Conditional] Branch: If no code match, skip to next element.",
          "Zone Assignment: Assign corresponding nZones array to nZonesAux based on match.",
          "Zone Iteration: Loop through valid zone indices in nZonesAux.",
          "Sheet Retrieval: Get all Sheet entities for the current element and specific zone index.",
          "Modification: Execute dbErase() on retrieved sheets.",
          "Completion: Erase script instance and exit."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert Cycle Check (insertCycleCount > 1)",
            "path1": {
              "name": "Duplicate Cycle",
              "steps": [
                "Erase current script instance",
                "Return immediately"
              ]
            },
            "path2": {
              "name": "First Cycle",
              "steps": [
                "Show Dialog (if needed)",
                "Prompt for Element selection",
                "Store Elements"
              ]
            }
          },
          {
            "condition": "Wall Code Match",
            "path1": {
              "name": "Code Found",
              "steps": [
                "Identify Wall Set (1-4)",
                "Load specific Zone list",
                "Process Sheet removal"
              ]
            },
            "path2": {
              "name": "Code Not Found",
              "steps": [
                "Set nWallSet to -1",
                "Continue to next element"
              ]
            }
          },
          {
            "condition": "Zone Validity (1-10)",
            "path1": {
              "name": "Valid Zone",
              "steps": [
                "Find index in nValidZones",
                "Append mapped real zone to nZones array"
              ]
            },
            "path2": {
              "name": "Invalid Zone",
              "steps": [
                "nIndex is -1",
                "Skip value (not added to array)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Selection",
            "errorMessage": "None (Silent failure if no selection)",
            "recovery": "User must select valid ElementWallSF entities when prompted."
          },
          {
            "check": "Zone Input Range",
            "errorMessage": "None (Silent failure)",
            "recovery": "User must input integers between 1 and 10 separated by semicolons. Invalid characters are ignored."
          },
          {
            "check": "Wall Code Syntax",
            "errorMessage": "None (Silent failure)",
            "recovery": "User must ensure wall codes in properties exactly match the element codes in the model."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Run-once script)",
            "how": "N/A",
            "effect": "The script erases itself immediately after processing. It cannot be edited or re-run via properties after the initial execution. To modify parameters, the user must insert the script again."
          }
        ]
      },
      "tokens_used": 6624,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_RemoveSheetsFromWalls.mcr\n\n## Overview\nThis script removes specific sheathing or sheeting layers (Sheet entities) from selected wall elements based on their wall codes and construction zones. It is designed to quickly clear areas for windows, doors, or mechanical chases without manually editing each wall's composition.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment where Walls (ElementWallSF) are located. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | This script modifies the 3D model, not drawing views. |\n\n## Prerequisites\n- **Required Entities**: `ElementWallSF` (Standard Walls).\n- **Minimum Beam Count**: 0 (This script operates on Wall elements, not individual beams).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `hsb_RemoveSheetsFromWalls.mcr`\n\n### Step 2: Select Walls\n```\nCommand Line: Select one or More Elements\nAction: Click on the wall elements in the model you wish to process. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Properties\nAfter selection, the Properties Palette will appear. Enter the Wall Codes and corresponding Zones for up to 4 different groups.\n```\nAction: In the Properties Palette, type the Wall Codes (matching the Element Code in hsbCAD) and the Zone numbers you wish to remove. Press Enter to apply changes.\nNote: Separate multiple entries with a semicolon (;).\n```\n\n### Step 4: Execution\nOnce the properties are entered, the script will automatically process the selected walls and remove the specified sheets. The script instance will then delete itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Wall 1 Codes | Text | | Enter the Element Codes (names) of the first group of walls (e.g., `W_EXT_01;W_EXT_02`). |\n| Zones to Remove for Wall 1 | Text | | Enter the zone numbers (1-10) to remove for Group 1, separated by `;` (e.g., `1;3`). |\n| Wall 2 Codes | Text | | Enter the Element Codes for the second group of walls. |\n| Zones to Remove for Wall 2 | Text | | Enter the zone numbers (1-10) to remove for Group 2, separated by `;`. |\n| Wall 3 Codes | Text | | Enter the Element Codes for the third group of walls. |\n| Zones to Remove for Wall 3 | Text | | Enter the zone numbers (1-10) to remove for Group 3, separated by `;`. |\n| Wall 4 Codes | Text | | Enter the Element Codes for the fourth group of walls. |\n| Zones to Remove for Wall 4 | Text | | Enter the zone numbers (1-10) to remove for Group 4, separated by `;`. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific options to the entity context menu. |\n\n## Settings Files\n- None required.\n\n## Tips\n- **Zone Mapping**: Zones 1-5 typically refer to layer indices on one side of the wall, while 6-10 typically refer to the opposite side (negative indices). Consult your wall construction setup if you are unsure which number corresponds to which sheathing layer.\n- **Exact Spelling**: Ensure the Wall Codes entered in the properties match the **Element Code** exactly as it appears in the wall's properties. The script is case-sensitive.\n- **Semicolon Separator**: Do not use spaces after semicolons if the script does not seem to recognize the codes (e.g., use `A;B` instead of `A; B`).\n- **Run Once**: This script erases itself after running. If you make a mistake, use the AutoCAD `UNDO` command immediately to revert the changes.\n\n## FAQ\n- **Q: What happens if I enter a Zone number that doesn't exist?**\n  - A: The script will simply ignore that number. Only valid zones found on the wall will be processed.\n- **Q: Can I modify the settings after the script has run?**\n  - A: No. The script instance deletes itself automatically after execution. You must insert the script again to perform new operations.\n- **Q: How do I know what my Wall Code is?**\n  - A: Select a wall in your model and look at the **Properties Palette** (or use `LIST` command). The code is usually found under \"Element\" or \"Identification\" fields."
      },
      "tokens_used": 6016,
      "error": null
    }
  }
}