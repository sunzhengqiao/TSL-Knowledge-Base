{
  "filename": "hsb_ShowSheetSize.mcr",
  "status": "completed",
  "total_tokens": 24041,
  "processing_time": 164.24844574928284,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "14.09.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version."
          },
          {
            "version": "1.1",
            "date": "15.01.2013",
            "author": null,
            "changes": "Add property to hide posnum."
          },
          {
            "version": "1.2",
            "date": "15.01.2013",
            "author": null,
            "changes": "Add property to hide dimention."
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4823,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for Viewport selection using getViewport() within _bOnInsert, stores it in the _Viewport array, retrieves the Viewport coordinate system (vp.coordSys()), and transforms points from Model Space to Paper Space (ms2ps) for display."
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "The script must be inserted in a Layout (Paper Space) and interact with a Viewport containing valid hsbCAD Elements with generated Sheets.",
          "requiredSettings": []
        }
      },
      "tokens_used": 3400,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getViewport",
              "promptOriginal": "Select a viewport",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimension Style",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": "_DimStyles",
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": -1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sShowPosnum",
            "type": "PropString",
            "displayName": "Show Posnum",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sShowDimention",
            "type": "PropString",
            "displayName": "Show Dimention",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2935,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Displays formatted labels in Paper Space indicating the Position Number and dimensions of Sheets (panels/walls) selected via a Viewport.",
          "category": "ShopDrawing",
          "typicalUseCase": "Annotating a layout sheet to show the size and identification of timber panels visible in a specific viewport."
        },
        "parameters": [
          {
            "name": "sDimStyle",
            "technicalDefault": "\"\"",
            "businessMeaning": "Selects the specific CAD dimension style (e.g., arrowheads, text size, precision) to be used for the label text.",
            "validRange": "Any Dimension Style defined in the current drawing.",
            "unit": "String (Style Name)",
            "affectsOutput": "Changes the visual appearance (font, height, arrows) of the text label."
          },
          {
            "name": "nColor",
            "technicalDefault": "-1",
            "businessMeaning": "Sets the color of the displayed text label. A value of -1 typically uses the current layer or entity color.",
            "validRange": "0-255 (AutoCAD Color Index) or -1 for ByLayer.",
            "unit": "ACI (AutoCAD Color Index)",
            "affectsOutput": "Changes the color of the sheet label text."
          },
          {
            "name": "sShowPosnum",
            "technicalDefault": "\"No\"",
            "businessMeaning": "Toggles the visibility of the Sheet's Position Number (Production Mark/Element ID) in the label.",
            "validRange": "Yes, No",
            "unit": "Boolean (String)",
            "affectsOutput": "If 'Yes', includes the Sheet's unique identifier (e.g., 'W01') in the label."
          },
          {
            "name": "sShowDimention",
            "technicalDefault": "\"No\"",
            "businessMeaning": "Toggles the visibility of the Sheet's physical dimensions (Length x Width) in the label.",
            "validRange": "Yes, No",
            "unit": "Boolean (String)",
            "affectsOutput": "If 'Yes', appends the dimensions (e.g., '2500x600') to the label."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sShowPosnum and sShowDimention are both enabled.",
            "effect": "The label combines both values into a single string (Posnum + Dimensions). If both are disabled, no text is drawn.",
            "cascade": [
              "sShowPosnum",
              "sShowDimention"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text/Label",
            "description": "A single-line text string placed at the center of the sheet in Paper Space, containing the Position Number and/or Dimensions.",
            "appliedTo": "Sheets (Walls/Panels) within the selected Viewport in the active Layout."
          }
        ]
      },
      "tokens_used": 3400,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Insertion: User executes the script in a Layout (Paper Space).",
          "2. Input: User is prompted to select a Viewport ('Select a viewport').",
          "3. Dialog: The Properties dialog (OPM) is displayed once for initial configuration.",
          "4. Initialization: Script calculates transformation matrices to convert Model Space coordinates to Paper Space (ms2ps) based on the selected Viewport.",
          "5. Validation: Script checks if the selected Viewport contains valid hsbCAD element data.",
          "6. Data Retrieval: Script retrieves all Sheets within the active Zone of the Element.",
          "7. Processing Loop: For each Sheet found, the script calculates its center point and dimensions.",
          "8. Display Logic: The script constructs the label string based on 'Show Posnum' and 'Show Dimention' properties.",
          "9. Rendering: The text label is drawn at the transformed center point in Paper Space."
        ],
        "conditionalBranches": [
          {
            "condition": "View Properties ('Show Posnum' and 'Show Dimention')",
            "path1": {
              "name": "Posnum Only",
              "steps": [
                "Verify 'Show Posnum' is 'Yes' and 'Show Dimention' is 'No'.",
                "Output string contains only the Sheet Position Number (e.g., 'W01')."
              ]
            },
            "path2": {
              "name": "Dimention Only",
              "steps": [
                "Verify 'Show Posnum' is 'No' and 'Show Dimention' is 'Yes'.",
                "Output string contains only dimensions (e.g., '2500x600')."
              ]
            },
            "path3": {
              "name": "Posnum + Dimention",
              "steps": [
                "Verify 'Show Posnum' is 'Yes' and 'Show Dimention' is 'Yes'.",
                "Output string combines both: Position Number followed by dimensions (e.g., 'W01 2500x600')."
              ]
            },
            "path4": {
              "name": "Hidden",
              "steps": [
                "Verify 'Show Posnum' is 'No' and 'Show Dimention' is 'No'.",
                "Output string is empty, nothing is drawn."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Selection",
            "errorMessage": "None (Script silently exits).",
            "recovery": "User must select a valid viewport to execute the script logic; otherwise, the script terminates immediately."
          },
          {
            "check": "hsbCAD Element Validity",
            "errorMessage": "None (Script silently exits).",
            "recovery": "The selected Viewport must contain a valid hsbCAD Element. If it is empty or a standard AutoCAD viewport without hsb data, the script stops."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Label Appearance",
            "how": "Properties Palette (OPM)",
            "effect": "Changing 'Dimension Style' or 'Color' immediately updates the visual style of the text labels."
          },
          {
            "action": "Toggle Label Content",
            "how": "Properties Palette (OPM)",
            "effect": "Toggling 'Show Posnum' or 'Show Dimention' between 'Yes' and 'No' dynamically updates the text content for all displayed sheets."
          },
          {
            "action": "Move Script",
            "how": "Grip Edit / AutoCAD Move",
            "effect": "Moving the script instance generally recalculates or re-renders based on its internal logic (though primarily the script position is defined by the viewport/element connection, TSL instances usually have an insertion point). Note: This script calculates positions relative to the viewport center/origin."
          }
        ]
      },
      "tokens_used": 4399,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ShowSheetSize.mcr\n\n## Overview\nThis script displays labels in your Layout (Paper Space) to indicate the Position Number and/or dimensions of Sheets (panels/walls) visible through a selected Viewport. It is useful for quickly annotating floor plans or layout drawings with size and identification data.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script cannot be inserted in Model Space. |\n| Paper Space | Yes | This is the primary workspace. The script must be inserted on a Layout tab. |\n| Shop Drawing | No | This script annotates layouts; it does not generate shop drawings. |\n\n## Prerequisites\n- **Required Entities**: A Viewport containing hsbCAD Elements (Walls/Panels) with generated Sheets.\n- **Minimum Beam Count**: 0.\n- **Required Settings**: The Viewport must be active and contain valid timber data.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_ShowSheetSize.mcr`\n\n### Step 2: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click on the border or inside the viewport that displays the elements you wish to annotate.\n```\n\n### Step 3: Configure Properties\nAfter insertion, select the script instance (if visible) or simply press `Ctrl+1` to open the Properties Palette while the script is selected to configure the label display options (e.g., toggling Position Numbers or Dimensions).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension Style | dropdown | (Current) | Selects the CAD Dimension Style (text height, font, arrows) to be used for the labels. |\n| Color | number | -1 | Sets the color of the text labels. Enter a specific color index (0-255) or use -1 to use the ByLayer color. |\n| Show Posnum | dropdown | No | Toggles the visibility of the Element Position Number (e.g., \"W01\"). Set to \"Yes\" to display. |\n| Show Dimention | dropdown | No | Toggles the visibility of the Sheet physical dimensions (e.g., \"2500x600\"). Set to \"Yes\" to display. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are available for this script. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: This script operates entirely on internal drawing data and property settings.\n\n## Tips\n- **Combining Data**: You can set both \"Show Posnum\" and \"Show Dimention\" to \"Yes\" to create a comprehensive label (e.g., \"W01 2500x600\").\n- **Dynamic Updates**: If you change the size of the panels in the model, the dimensions in the label will update automatically (usually requires a regeneration or save).\n- **Text Visibility**: If you see the script insertion point but no text, check the Properties Palette to ensure at least one of the \"Show\" options is set to \"Yes\".\n\n## FAQ\n- **Q: Why don't I see any text after inserting the script?**\n  - A: Ensure you have selected a viewport with valid hsbCAD Elements. Additionally, check the Properties Palette and set either \"Show Posnum\" or \"Show Dimention\" to \"Yes\".\n- **Q: Can I change the text size without creating a new Dimension Style?**\n  - A: No, the script uses the standard CAD Dimension Style settings to control text appearance. You must modify the Dimension Style in the AutoCAD Style Manager or select a different style in the script properties.\n- **Q: What does the Color value -1 do?**\n  - A: Setting Color to -1 makes the text take on the color of the Layer on which the script instance resides."
      },
      "tokens_used": 5084,
      "error": null
    }
  }
}