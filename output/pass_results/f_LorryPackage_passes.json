{
  "filename": "f_LorryPackage.mcr",
  "status": "completed",
  "total_tokens": 56258,
  "processing_time": 224.14801406860352,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": \"\",\n    \"numBeamsReq\": 0,\n    \"keywords\": [],\n    \"majorVersion\": 0,\n    \"minorVersion\": 0,\n    \"dxaOut\": 0,\n    \"implInsert\": 0\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"1.6\",\n      \"date\": \"05.03.2021\",\n      \"author\": \"Thorsten Huck\",\n      \"changes\": \"new settings to control badge color and transparency, Import and Export of settings added\"\n    },\n    {\n      \"version\": \"1.5\",\n      \"date\": \"04nov2020\",\n      \"author\": \"thorsten.huck@hsbcad.com\",\n      \"changes\": \"HSB-9505 bugfix package transformation\"\n    },\n    {\n      \"version\": \"1.4\",\n      \"date\": \"30oct2020\",\n      \"author\": \"thorsten.huck@hsbcad.com\",\n      \"changes\": \"HSB-9509 protection area exposed\"\n    },\n    {\n      \"version\": \"1.3\",\n      \"date\": \"19oct2020\",\n      \"author\": \"thorsten.huck@hsbcad.com\",\n      \"changes\": \"HSB-9337 bounding dimensions and bedding locations published for shopdrawings\"\n    },\n    {\n      \"version\": \"1.2\",\n      \"date\": \"19oct2020\",\n      \"author\": \"thorsten.huck@hsbcad.com\",\n      \"changes\": \"HSB-9330 bugfix vertical offset on horizontal stacking\"\n    },\n    {\n      \"version\": \"1.1\",\n      \"date\": \"25sep2020\",\n      \"author\": \"thorsten.huck@hsbcad.com\",\n      \"changes\": \"HSB-8963 renamed from f_TruckPack, new properties to specify wrapping and edge protection, new output variables for bounding dimensions, rotation angle of vertical stacked walls exposed as format variable of"
      },
      "tokens_used": 8872,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly uses `_kModelSpace` during dialog trigger creation (`tslDialog.dbCreate(..., _kModelSpace, ...)`). No Paper Space specific patterns (like `sd_` prefixes or `_Viewport` handling) or Shop Drawing types (`#Type E`) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "TslInst"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "hsbTSL\\f_Stacking.xml (Reads wrapping and display settings from Company or Install path)"
          ]
        }
      },
      "tokens_used": 5753,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"|Select stacked trucks|\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": [\n      {\n        \"prompt\": \"|Are you sure to overwrite existing settings?| [|No|/|Yes|]\",\n        \"options\": [\"|No|\", \"|Yes|\"]\n      }\n    ]\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"PropertyDialog\",\n      \"trigger\": \"Insertion / _bOnInsert (standard mode)\",\n      \"title\": \"f_LorryPackage Properties\",\n      \"dataSource\": \"OPM Properties (Standard)\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    },\n    {\n      \"type\": \"PropertyDialog\",\n      \"trigger\": \"Context Menu -> |Badge Display|\",\n      \"title\": \"Badge Display Settings\",\n      \"dataSource\": \"OPM Properties (DialogMode 1)\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": \"nDoubleIndex\",\n      \"variable\": \"dEdgeProtection1\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Protection Type 1|\",\n      \"defaultValue\": \"0 (mm)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Wrappping|\",\n      \"description\": \"|Defines the thickness of the edge protection| |0 = no edge protection| |Applies for the upmost item of a horizontal stacking and for any wall in vertical stacks where it is not rotated|\"\n    },\n    {\n      \"index\": \"nDoubleIndex\",\n      \"variable\": \"dEdgeProtection2\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Protection Type 2|\",\n      \"defaultValue\": \"0 (mm)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Wrappping|\",\n      \"description\": \"|Defines the thickness of the edge protection| |0 = no edge protection| |Applies for any rotated wall in vertical stacks.|\"\n    },\n    {\n      \"index\": \"nStringIndex\",\n      \"variable\": \"sWrap\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Wrapping|\",\n      \"defaultValue\": \"<|Disabled|>\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"<|Disabled|>\",\n        \"Dynamic list from f_Stacking.xml (Package\\\\Wrap[])\"\n      ],\n      \"category\": \"|Wrappping|\",\n      \"description\": \"|Defines the wrapping of the package.|\"\n    },\n    {\n      \"index\": \"nStringIndex\",\n      \"variable\": \"sResolution\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Resolution|\",\n      \"defaultValue\": \"|Low Detail|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Low Detail|\",\n        \"|Medium Detail|\",\n        \"|High Detail|\"\n      ],\n      \"category\": \"|Display|\",\n      \"description\": \"|Defines the Resolution|\"\n    },\n    {\n      \"index\": \"nStringIndex\",\n      \"variable\": \"sFormat\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Format|\",\n      \"defaultValue\": \"@(Truck)\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"|Display|\",\n      \"description\": \"|Defines the format of the description|\"\n    },\n    {\n      \"index\": \"nStringIndex\",\n      \"variable\": \"sDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|DimStyle|\",\n      \"defaultValue\": \"_DimStyles.sorted()[0]\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"System DimStyles\"\n      ],\n      \"category\": \"|Display|\",\n      \"description\": \"|Defines the DimStyle|\"\n    },\n    {\n      \"index\": \"nDoubleIndex\",\n      \"variable\": \"dTextHeight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Text Height|\",\n      \"defaultValue\": \"0 (mm)\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Display|\",\n      \"description\": \"|Defines the Text Height| |0 = byDimStyle|\"\n    },\n    {\n      \"index\": \"nIntIndex\",\n      \"variable\": \"nColor\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Color|\",\n      \"defaultValue\": \"7\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Text|\",\n      \"description\": \"|Defines the color of the text|\"\n    },\n    {\n      \"index\": \"nIntIndex\",\n      \"variable\": \"nColorBorder\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Color|\",\n      \"defaultValue\": \"7\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Border|\",\n      \"description\": \"|Defines the color of the box around the text|\"\n    },\n    {\n      \"index\": \"nIntIndex\",\n      \"variable\": \"nColorFill\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Color|\",\n      \"defaultValue\": \"7\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Filling|\",\n      \"description\": \"|Defines the color of the filling of the box around the text|\"\n    },\n    {\n      \"index\": \"nIntIndex\",\n      \"variable\": \"nTransparencyFill\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Transparency|\",\n      \"defaultValue\": \"7\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Filling|\",\n      \"description\": \"|Defines the transparency of the filling| |100 = no filling|\"\n    }\n  ],\n  \"contextMenu\": [\n    {\n      \"menuItem\": \"|Badge Display|\",\n      \"handler\": \""
      },
      "tokens_used": 10084,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Visualizes and groups stacked timber elements (walls/floors) into a transport package, calculating dimensions, edge protection, and wrapping for logistics and shop drawings.",
          "category": "Logistics/Packaging",
          "typicalUseCase": "Used during production planning to generate package labels, calculate transport volumes, and represent the final wrapped state of timber packs on delivery trucks."
        },
        "parameters": [
          {
            "name": "dEdgeProtection1",
            "technicalDefault": "0 (mm)",
            "businessMeaning": "Thickness of protective material (corners/foam) applied to standard stacked elements (non-rotated). This adds to the overall package dimensions to ensure accurate transport sizing.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Increases the calculated bounding box dimensions of the package; visually represents protective strips on the top layer of horizontal stacks."
          },
          {
            "name": "dEdgeProtection2",
            "technicalDefault": "0 (mm)",
            "businessMeaning": "Thickness of protective material applied to rotated elements (typically vertical walls placed on their side in corners of the truck).",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Increases the calculated bounding box dimensions specifically for rotated elements; visually represents protection on those specific elements."
          },
          {
            "name": "sWrap",
            "technicalDefault": "<Disabled>",
            "businessMeaning": "Selects the type of packaging material (e.g., Foil, Cardboard) defined in company standards. It acts as a label for the packing type.",
            "validRange": "List from f_Stacking.xml",
            "unit": "String (Enumeration)",
            "affectsOutput": "Sets the textual description of the wrapping used on the package badge/label."
          },
          {
            "name": "sResolution",
            "technicalDefault": "Low Detail",
            "businessMeaning": "Controls the level of geometric detail displayed in the CAD model. Low detail shows a bounding box for performance; High detail shows the actual timber outlines.",
            "validRange": "Low / Medium / High",
            "unit": "Enumeration",
            "affectsOutput": "Low: Bounding box only. Medium/High: Detailed profiles of the contained elements. High detail may impact regeneration time in large models."
          },
          {
            "name": "sFormat",
            "technicalDefault": "@(Truck)",
            "businessMeaning": "The text template for the package label. It typically uses format variables to auto-generate text like 'Truck #1 - Load A'.",
            "validRange": "Any string containing format variables",
            "unit": "String",
            "affectsOutput": "Text displayed on the 3D badge and label in shop drawings."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "First sorted DimStyle",
            "businessMeaning": "Specifies the CAD dimension style (arrow size, text font) used for the dimensions associated with this package.",
            "validRange": "Available DimStyles in the drawing",
            "unit": "String (Enumeration)",
            "affectsOutput": "Visual style of automatic dimensions linked to the package."
          },
          {
            "name": "dTextHeight",
            "technicalDefault": "0",
            "businessMeaning": "Explicitly sets the height of the text on the package label. A value of 0 means the height is inherited from the DimStyle.",
            "validRange": "0 - 500 mm (0 = use DimStyle default)",
            "unit": "mm",
            "affectsOutput": "Size of the label text in Model Space."
          },
          {
            "name": "nColor (Text)",
            "technicalDefault": "7 (White/Black)",
            "businessMeaning": "The display color of the package label text.",
            "validRange": "0 - 255 (AutoCAD Color Index)",
            "unit": "Color Index",
            "affectsOutput": "Visual appearance of the text in 3D and plan views."
          },
          {
            "name": "nColorBorder",
            "technicalDefault": "7",
            "businessMeaning": "The color of the border line around the package label (badge).",
            "validRange": "0 - 255",
            "unit": "Color Index",
            "affectsOutput": "Visual appearance of the badge box."
          },
          {
            "name": "nColorFill",
            "technicalDefault": "7",
            "businessMeaning": "The background fill color of the package label badge.",
            "validRange": "0 - 255",
            "unit": "Color Index",
            "affectsOutput": "Background color of the label to ensure contrast."
          },
          {
            "name": "nTransparencyFill",
            "technicalDefault": "90",
            "businessMeaning": "Opacity of the badge background fill. Allows users to see geometry behind the label.",
            "validRange": "0 (Solid) - 100 (Invisible)",
            "unit": "Percentage (integer)",
            "affectsOutput": "Transparency of the label background."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Badge Display Context Menu",
            "effect": "Opens a sub-dialog to modify display aesthetics without opening the full properties palette.",
            "cascade": [
              "nColor",
              "nColorBorder",
              "nColorFill",
              "nTransparencyFill"
            ]
          },
          {
            "trigger": "dTextHeight set to 0",
            "effect": "Ignores the specific text height value and defaults to the text height defined in sDimStyle.",
            "cascade": [
              "sDimStyle"
            ]
          },
          {
            "trigger": "sResolution set to Low",
            "effect": "Suppresses detailed geometry generation, only drawing a bounding box.",
            "cascade": [
              "Geometric Output"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Visualization (Body/PLine)",
            "description": "A 3D representation of the package volume. In High detail, this matches the element profiles; in Low detail, it is a rectangular bounding box.",
            "appliedTo": "Model Space (grouped TslInst)"
          },
          {
            "type": "Text/Badge",
            "description": "A 2D/3D label displaying the Format string (e.g., Truck name), positioned relative to the package centroid or edge.",
            "appliedTo": "Model Space"
          },
          {
            "type": "DimRequest (Map)",
            "description": "Data published to 'Hsb_DimensionInfo' allowing shop drawings to automatically dimension the overall package (Length, Width, Height) and bedding locations.",
            "appliedTo": "Shop Drawings / Layouts"
          },
          {
            "type": "PlaneProfile (Protection)",
            "description": "Generates geometry representing the edge protection strips (Types 1 and 2) for visual verification and collision detection.",
            "appliedTo": "Model Space"
          }
        ]
      },
      "tokens_used": 10768,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Initialization & Debug Check",
          "2. Check DialogMode (Sub-dialog or Main Mode)",
          "3. Load Settings from Dictionary (hsbTSL/f_Stacking.xml)",
          "4. Define OPM Properties (Wrapping, Display, etc.)",
          "5. [Insert Phase] Check Execution Key (Catalog or Manual)",
          "6. [Insert Phase] Show Properties Dialog (if Manual)",
          "7. [Insert Phase] Prompt User to select stacked trucks (TslInst filter)",
          "8. Calculate Bounding Box and Transformation Matrix from selection",
          "9. Resolve Format Variables for Text Label",
          "10. Generate Geometry based on 'Resolution' setting (Bounding Box vs Detailed Profiles)",
          "11. Draw Text/Badge at calculated position (COG or Edge Snap)",
          "12. Publish Dimension Requests (Hsb_DimensionInfo) to instance",
          "13. Register Context Menu Triggers (Badge Display, Import, Export)"
        ],
        "conditionalBranches": [
          {
            "condition": "DialogMode > 0 (Triggered via Context Menu)",
            "path1": {
              "name": "Badge Display Mode",
              "steps": [
                "Map Display properties to OPM (Text/Border/Fill Color, Transparency)",
                "Show Dialog",
                "Update MapObject with new values",
                "Set Execution Loops to 2 (Refresh)",
                "Return"
              ]
            },
            "path2": {
              "name": "Main Execution Mode",
              "steps": [
                "Proceed to Load Settings",
                "Execute standard insertion or recalculation logic"
              ]
            }
          },
          {
            "condition": "Resolution Setting (sResolution)",
            "path1": {
              "name": "Low Detail",
              "steps": [
                "Skip detailed geometry extraction",
                "Draw only the bounding box (bdPack)"
              ]
            },
            "path2": {
              "name": "Medium/High Detail",
              "steps": [
                "Iterate mapRequests",
                "Draw Pline profiles",
                "Draw PlaneProfiles with transparency/fill logic"
              ]
            }
          },
          {
            "condition": "Badge Position relative to Bounding Box",
            "path1": {
              "name": "Inside Profile",
              "steps": [
                "Draw Text at Centroid (ptCOG)",
                "No leader line drawn"
              ]
            },
            "path2": {
              "name": "Outside Profile",
              "steps": [
                "Find closest point on Profile boundary",
                "Project point to Z-plane of tag",
                "Draw Leader Line (PLine) from Text to boundary"
              ]
            }
          },
          {
            "condition": "Export Settings - File Exists",
            "path1": {
              "name": "File Exists",
              "steps": [
                "Prompt User: |Are you sure to overwrite existing settings?|",
                "If Yes: Write XML and update MapObject",
                "If No: Abort export"
              ]
            },
            "path2": {
              "name": "File Missing",
              "steps": [
                "Create Folder structure if needed",
                "Write XML directly",
                "Update MapObject"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Settings File Path Existence",
            "errorMessage": "None implicit, but path is created if missing on Insert/Debug.",
            "recovery": "Script attempts `makeFolder` if folder not found during initialization."
          },
          {
            "check": "Entity Selection",
            "errorMessage": "None explicit in snippet, but `PrEntity` return status determines if `_Pt0` is calculated.",
            "recovery": "User must select valid `TslInst` entities representing stacked trucks."
          },
          {
            "check": "Import Settings File Existence",
            "errorMessage": "Trigger '|Import Settings|' only appears if `findFile(sFullPath)` is successful.",
            "recovery": "User must ensure the f_Stacking.xml exists in the Company or Install path."
          },
          {
            "check": "Export Settings Overwrite",
            "errorMessage": "|Are you sure to overwrite existing settings?|",
            "recovery": "User selects 'Yes' to proceed or 'No' to cancel."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify General/Wrapping Properties",
            "how": "OPM Properties Palette",
            "effect": "Updates edge protection, wrapping type, format string, and resolution (triggers recalc)."
          },
          {
            "action": "Change Badge Appearance",
            "how": "Context Menu -> |Badge Display|",
            "effect": "Opens simplified dialog to change Text, Border, and Fill colors/transparency. Updates global settings map."
          },
          {
            "action": "Import Configuration",
            "how": "Context Menu -> |Import Settings|",
            "effect": "Reloads `f_Stacking.xml` into the script's MapObject."
          },
          {
            "action": "Export Configuration",
            "how": "Context Menu -> |Export Settings|",
            "effect": "Writes current script settings to `f_Stacking.xml` (Company path)."
          },
          {
            "action": "Move/Resize Package",
            "how": "Grip Edit / AutoCAD Move",
            "effect": "Updates `_Pt0` and transforms the entire package visualization and sub-elements."
          }
        ]
      },
      "tokens_used": 12481,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# f_LorryPackage.mcr\n\n## Overview\nThis script visualizes stacked timber elements (walls/floors) as a complete transport package. It calculates bounding dimensions, applies edge protection and wrapping details, and generates informational labels for logistics planning and shop drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be inserted in Model Space. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Script runs in Model Space, but publishes dimension data for use in shop drawings. |\n\n## Prerequisites\n- **Required Entities**: Pre-existing stacked truck entities (TslInst) generated by a stacking script (e.g., `f_Stacking`).\n- **Minimum Beam Count**: 0 (Script operates on grouped TslInst).\n- **Required Settings**: `hsbTSL\\f_Stacking.xml` (Must exist in the Company or Install path to provide wrapping options and display defaults).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `f_LorryPackage.mcr` from the list.\n\n### Step 2: Select Stacked Trucks\n```\nCommand Line: Select stacked trucks\nAction: Click on the TslInst entities in the model representing the stacks you wish to package.\n```\n*Note: The script calculates the bounding box based on this selection.*\n\n### Step 3: Configure Package Properties\n```\nAction: Press Enter to finish selection. The Properties Palette (Ctrl+1) will display the script parameters.\n```\nAdjust settings such as **Wrapping**, **Edge Protection**, and **Badge Text** as needed. The 3D model updates automatically when properties are changed.\n\n### Step 4: Adjust Visuals (Optional)\n```\nAction: Right-click the package instance -> select \"Badge Display\".\n```\nUse this shortcut to quickly change label colors and transparency without searching through the full properties list.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **Wrapping** | |\n| Wrapping | dropdown | <Disabled> | Selects the type of packaging material (e.g., Foil, Cardboard) defined in `f_Stacking.xml`. |\n| Protection Type 1 | number | 0 mm | Thickness of edge protection for non-rotated elements (e.g., top layer of horizontal stacks). Adds to overall package dimensions. |\n| Protection Type 2 | number | 0 mm | Thickness of edge protection for rotated elements (e.g., vertical walls placed on their side). |\n| **Display** | |\n| Resolution | dropdown | Low Detail | Controls geometric detail. **Low**: Bounding box only (fast). **Medium/High**: Detailed timber profiles (slower). |\n| Format | text | @(Truck) | Text template for the package label. Use format variables to auto-generate text. |\n| DimStyle | dropdown | First Sorted | The CAD dimension style used for label dimensions. |\n| Text Height | number | 0 mm | Height of the label text. Enter **0** to use the height defined in the DimStyle. |\n| **Visual Style (Badge)** | |\n| Color (Text) | number | 7 | Color of the label text (AutoCAD Color Index). |\n| Color (Border) | number | 7 | Color of the box line around the text. |\n| Color (Fill) | number | 7 | Background color of the label box. |\n| Transparency | number | 90 | Opacity of the background fill (**100** = Invisible/No Fill, **0** = Solid). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Badge Display | Opens a simplified dialog to quickly change the Text, Border, and Fill colors/transparency of the package label. |\n| Import Settings | Loads wrapping and display settings from `f_Stacking.xml`. |\n| Export Settings | Saves current wrapping and display settings to `f_Stacking.xml`. (Prompts to overwrite if file exists). |\n\n## Settings Files\n- **Filename**: `hsbTSL\\f_Stacking.xml`\n- **Location**: Company path or Install path.\n- **Purpose**: Defines the list of available wrapping types and stores shared display settings (colors, text styles) for consistency across projects.\n\n## Tips\n- **Performance**: If working with a large model containing many packages, set **Resolution** to \"Low Detail\". This significantly improves regeneration speed by displaying only bounding boxes instead of detailed timber profiles.\n- **Label Visibility**: If the package label obscures important geometry, use the **Badge Display** context menu option to increase the **Transparency** to 100 (invisible fill).\n- **Transport Planning**: The **Protection Type 1** and **Type 2** values add to the package's physical volume. Ensure these match the actual thickness of corner guards or foam you will use during shipping.\n\n## FAQ\n- **Q: Where do I get the options for the Wrapping dropdown?**\n  **A:** These are defined in the `f_Stacking.xml` file. You can add custom wrapping types there.\n- **Q: My label is missing or too small.**\n  **A:** Check the **Text Height** property. If it is set to 0, it uses the DimStyle's text height, which might be too small relative to your model scale.\n- **Q: Can I use this script on individual beams?**\n  **A:** No, this script is designed to work on `TslInst` entities (groups of elements) that have already been processed by a stacking script.\n- **Q: What is the difference between Protection Type 1 and 2?**\n  **A:** Type 1 is for the top-most items in a standard horizontal stack. Type 2 is specifically for elements that are rotated (often vertical walls placed on the truck bed).\n- **Q: How do I save my color settings for future projects?**\n  **A:** Right-click the script instance and choose **Export Settings**. This writes your current configuration to the XML file so other users (or you in new drawings) can use **Import Settings** to load them."
      },
      "tokens_used": 8300,
      "error": null
    }
  }
}