{
  "filename": "HSB_W-AnchorDistribution.mcr",
  "status": "completed",
  "total_tokens": 57036,
  "processing_time": 251.03265571594238,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 7,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "21.04.2016",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "21.04.2016",
            "author": "AS",
            "changes": "Add option to position anchors at top of element. Add subtype for dimension lines created by D-Element"
          },
          {
            "version": "1.02",
            "date": "17.06.2016",
            "author": "AS",
            "changes": "Add manual insert mode."
          },
          {
            "version": "1.03",
            "date": "17.06.2016",
            "author": "AS",
            "changes": "Add option for anchors at left and righthand side"
          },
          {
            "version": "1.04",
            "date": "27.09.2016",
            "author": "AS",
            "changes": "Show anchors in top view."
          },
          {
            "version": "1.05",
            "date": "21.07.2017",
            "author": "AS",
            "changes": "Hide plan display in elevation view."
          },
          {
            "version": "1.06",
            "date": "21.12.2017",
            "author": "AS",
            "changes": "Distribute over envelope outline of element. Make edge anchors optional."
          },
          {
            "version": "1.07",
            "date": "21.12.2017",
            "author": "AS",
            "changes": "Correct quantity"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8873,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses `_Element` and `ElementWallSF` types. It inserts instances into `_kModelSpace` (`tslNew.dbCreate(..., _kModelSpace, mapTsl);`). It manipulates 3D geometry using `ElementWallSF` properties (`plEnvelope`, `coordSys`, `opening`). There are no 'sd_' function calls, `_Viewport` usage, or `Sheet` entities."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires a valid Wall Element (ElementWallSF) to function. If no element is found, the script erases itself.",
          "requiredSettings": []
        }
      },
      "tokens_used": 5977,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"PrEntity\",\n        \"promptOriginal\": \"Select elements [<Enter, for manual mode|>\",\n        \"condition\": \"_bOnInsert && !manualMode\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getElement\",\n        \"promptOriginal\": \"Select an element\",\n        \"condition\": \"_bOnInsert && manualMode\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a position\",\n        \"condition\": \"_bOnInsert && manualMode\",\n        \"required\": true\n      },\n      {\n        \"step\": 4,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select next point\",\n        \"condition\": \"_bOnInsert && manualMode (Loop)\",\n        \"required\": false\n      },\n      {\n        \"step\": 5,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a position\",\n        \"condition\": \"Context Menu 'Add anchor'\",\n        \"required\": true\n      },\n      {\n        \"step\": 6,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select next point\",\n        \"condition\": \"Context Menu 'Add anchor' (Loop)\",\n        \"required\": false\n      },\n      {\n        \"step\": 7,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select a position\",\n        \"condition\": \"Context Menu 'Remove anchor'\",\n        \"required\": true\n      },\n      {\n        \"step\": 8,\n        \"function\": \"PrPoint\",\n        \"promptOriginal\": \"Select next point\",\n        \"condition\": \"Context Menu 'Remove anchor' (Loop)\",\n        \"required\": false\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [\n    {\n      \"type\": \"Property Dialog\",\n      \"trigger\": \"On Insert (if not executed via key)\",\n      \"title\": null,\n      \"dataSource\": \"Prop* variables\",\n      \"features\": {\n        \"searchable\": false,\n        \"multiSelect\": false\n      }\n    }\n  ],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"anchorSymbol\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Symbol\",\n      \"defaultValue\": \"X\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Anchors\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"articleNumber\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Article number\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Anchors\",\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"subType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Subtype\",\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": \"Anchors\",\n      \"description\": \"The subtype is set as dimension information.The dimension tsl can filter on subtype.\"\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"propManualMode\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Select anchor positions manually\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Anchor distribution\",\n      \"description\": \"The anchor positions have to be selected manually. The distribution parameters are not used.\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"propSide\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Side\",\n      \"defaultValue\": \"Top\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Top\",\n        \"Bottom\",\n        \"Right\",\n        \"Left\"\n      ],\n      \"category\": \"Anchor distribution\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"maximumCenterSpacing\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Maximum center spacing\",\n      \"defaultValue\": \"1000\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"Anchor distribution\",\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"prop"
      },
      "tokens_used": 10302,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically calculates, distributes, and visualizes anchor positions (e.g., wind brackets or hold-downs) on wall elements based on spacing rules, or allows manual placement.",
          "category": "Hardware",
          "typicalUseCase": "Used during wall design to define placement of fixings for wind uplift or shear resistance, ensuring correct spacing for structural calculations and production lists."
        },
        "parameters": [
          {
            "name": "anchorSymbol",
            "technicalDefault": "\"X\"",
            "businessMeaning": "The visual text or symbol drawn in the model to represent the anchor location.",
            "validRange": "Any string (e.g., 'X', 'W', 'A')",
            "unit": "String",
            "affectsOutput": "Changes the text label drawn at each anchor point in the 3D model and drawings."
          },
          {
            "name": "articleNumber",
            "technicalDefault": "\"\"",
            "businessMeaning": "The part number or code of the physical anchor hardware used for BOMs and production data.",
            "validRange": "Manufacturer specific codes",
            "unit": "String",
            "affectsOutput": "Populates the Material List (BOM) with the specific hardware identity."
          },
          {
            "name": "subType",
            "technicalDefault": "\"\"",
            "businessMeaning": "A classification tag used to link anchors to specific dimension styles or filters in downstream scripts.",
            "validRange": "User defined (e.g., 'Wind', 'HoldDown')",
            "unit": "String",
            "affectsOutput": "Embeds metadata into the instance used by dimensioning scripts to identify these anchors."
          },
          {
            "name": "propManualMode",
            "technicalDefault": "\"Yes\"",
            "businessMeaning": "Toggles between automatic algorithmic placement and user-defined manual clicking of positions.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "If 'Yes', triggers command line inputs for points. If 'No', executes the distribution algorithm."
          },
          {
            "name": "propSide",
            "technicalDefault": "\"Top\"",
            "businessMeaning": "The face of the wall element where anchors are applied.",
            "validRange": "Top, Bottom, Right, Left",
            "unit": "Enum",
            "affectsOutput": "Rotates the coordinate system for calculation and visualization to the selected wall face."
          },
          {
            "name": "maximumCenterSpacing",
            "technicalDefault": "1000",
            "businessMeaning": "The maximum allowable distance between the centers of two adjacent anchors.",
            "validRange": "300 - 2500",
            "unit": "mm",
            "affectsOutput": "Determines the number of anchors placed in auto-mode; lower values increase anchor quantity."
          },
          {
            "name": "propDistributeEvenly",
            "technicalDefault": "\"No\"",
            "businessMeaning": "If 'Yes', divides the space evenly between start and end points. If 'No', spaces by maximum distance from the start.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "Adjusts the spacing of anchors; 'No' may result in a smaller gap at the end of a segment."
          },
          {
            "name": "minimumDistanceBetweenAnchors",
            "technicalDefault": "300",
            "businessMeaning": "The minimum allowable gap between anchors. If the space is smaller, only one anchor is placed in the center.",
            "validRange": "50 - 600",
            "unit": "mm",
            "affectsOutput": "Prevents overlapping anchors in short wall sections or between tight openings."
          },
          {
            "name": "propAnchorsUnderDoor",
            "technicalDefault": "\"Yes\"",
            "businessMeaning": "Specifies if anchors should be generated in the wall segments located below door openings.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "Suppresses or enables anchor generation in the wall zones beneath doors."
          },
          {
            "name": "distanceToDoor",
            "technicalDefault": "50",
            "businessMeaning": "The offset distance from the door opening edge to the nearest anchor.",
            "validRange": "0 - 200",
            "unit": "mm",
            "affectsOutput": "Moves the calculated anchor positions closer to or further from the door jambs."
          },
          {
            "name": "distanceToEdge",
            "technicalDefault": "150",
            "businessMeaning": "The offset distance from the ends of the wall element to the first and last anchors.",
            "validRange": "0 - 500",
            "unit": "mm",
            "affectsOutput": "Sets the start and end padding for the row of anchors."
          },
          {
            "name": "propApplyEdgeAnchors",
            "technicalDefault": "\"Yes\"",
            "businessMeaning": "Determines whether anchors are actually placed at the calculated start and end edge positions.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "If 'No', removes the first and last anchors in the distribution line."
          },
          {
            "name": "anchorColor",
            "technicalDefault": "1",
            "businessMeaning": "The CAD color used to draw the anchor symbols.",
            "validRange": "0 - 255 (AutoCAD Index)",
            "unit": "Index",
            "affectsOutput": "Visual color of the anchor symbols in the model."
          },
          {
            "name": "textHeight",
            "technicalDefault": "50",
            "businessMeaning": "The text size of the anchor symbol.",
            "validRange": "10 - 100",
            "unit": "mm",
            "affectsOutput": "Visual size of the symbol text."
          },
          {
            "name": "textHeightDimension",
            "technicalDefault": "30",
            "businessMeaning": "The text size for dimension labels.",
            "validRange": "10 - 100",
            "unit": "mm",
            "affectsOutput": "Visual size of dimension text."
          },
          {
            "name": "offsetFromElementY",
            "technicalDefault": "150",
            "businessMeaning": "The distance the anchor symbol is offset from the wall surface (to avoid visual overlap).",
            "validRange": "50 - 500",
            "unit": "mm",
            "affectsOutput": "Visual displacement of the anchor symbol away from the wall geometry."
          },
          {
            "name": "propDimensionMode",
            "technicalDefault": "\"No dimension\"",
            "businessMeaning": "Controls the display of dimensions: none, a generic spacing note, or specific distances for all anchors.",
            "validRange": "No dimension, General spacing, All anchor positions",
            "unit": "Enum",
            "affectsOutput": "Adds or removes text labels indicating spacing or location in the drawing."
          },
          {
            "name": "propShowAnchors",
            "technicalDefault": "\"Yes\"",
            "businessMeaning": "Toggles the visibility of the anchor symbols in the CAD model.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "Hides the symbols without deleting the hardware data."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "propManualMode set to 'Yes'",
            "effect": "Disables automatic calculation logic. User input is required. Spacing and edge parameters are ignored.",
            "cascade": [
              "maximumCenterSpacing",
              "propDistributeEvenly",
              "minimumDistanceBetweenAnchors",
              "distanceToEdge",
              "distanceToDoor",
              "propAnchorsUnderDoor",
              "propApplyEdgeAnchors"
            ]
          },
          {
            "trigger": "propDimensionMode set to 'General spacing'",
            "effect": "Displays a text label showing the 'maximumCenterSpacing' value.",
            "cascade": [
              "maximumCenterSpacing"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Hardware (HardWrComp)",
            "description": "Creates a logical hardware component attached to the wall element for BOM export, with quantity matching the number of points.",
            "appliedTo": "ElementWallSF (Wall Element)"
          },
          {
            "type": "Visual Representation",
            "description": "Draws text symbols and optional dimensions in Model Space to represent anchor locations.",
            "appliedTo": "Model Space"
          }
        ]
      },
      "tokens_used": 10884,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Initialization",
          "Check Insert Cycle (Abort if > 1 to prevent loops)",
          "Load Properties from Catalog (if executed via Key)",
          "Show Property Dialog (if not executed via Key)",
          "Check 'Select anchor positions manually' (propManualMode)",
          "[Branch] Automatic Mode or Manual Mode",
          "Automatic Mode: Prompt user to select Elements (PrEntity)",
          "Automatic Mode: Loop through selected elements and create script instance on each",
          "Automatic Mode: Erase temporary script instance and Exit",
          "Manual Mode: Prompt user to select a single Element (getElement)",
          "Manual Mode: Prompt user to select anchor positions (getPoint loop)",
          "Manual Mode: Store positions in _PtG and Exit",
          "Post-Insertion: Validate associated Element (erase if invalid)",
          "Determine Execution Mode based on triggers (Recalc, Add, Remove)",
          "Recalc Mode: Retrieve Element Envelope and Openings",
          "Recalc Mode: Calculate Wall segments based on Side and Door exclusion rules",
          "Recalc Mode: Apply spacing logic (Max spacing vs Even distribution)",
          "Recalc Mode: Generate anchor points and filter edge anchors if needed",
          "Add Mode: Prompt user to select new points to append to list",
          "Remove Mode: Prompt user to select points to remove from list",
          "Visualization: Project points to the correct wall face line",
          "Visualization: Draw symbols, text, and dimensions based on display settings",
          "Output: Update Hardware Component (HardWrComp) quantity and properties"
        ],
        "conditionalBranches": [
          {
            "condition": "propManualMode during Insert",
            "path1": {
              "name": "Automatic Distribution",
              "steps": [
                "Display Property Dialog",
                "PrEntity: Select elements",
                "Iterate selection",
                "Create TSL instance on each Element",
                "Erase self"
              ]
            },
            "path2": {
              "name": "Manual Placement",
              "steps": [
                "Display Property Dialog",
                "getElement: Select target element",
                "getPoint: Select first anchor position",
                "Loop: PrPoint for subsequent positions",
                "Store points"
              ]
            }
          },
          {
            "condition": "propSide (Top/Bottom vs Right/Left)",
            "path1": {
              "name": "Horizontal Sides (Top/Bottom)",
              "steps": [
                "Distribution X vector = Element X",
                "Distribution Y vector = Element Y"
              ]
            },
            "path2": {
              "name": "Vertical Sides (Right/Left)",
              "steps": [
                "Distribution X vector = -Element Y",
                "Distribution Y vector = Element X",
                "Rotates logic to distribute along the wall height/vertical edge"
              ]
            }
          },
          {
            "condition": "propDistributeEvenly (during Recalc)",
            "path1": {
              "name": "Yes (Even)",
              "steps": [
                "Calculate total segment length",
                "Divide length by number of anchors to get equal spacing"
              ]
            },
            "path2": {
              "name": "No (Max Spacing)",
              "steps": [
                "Place anchors at 'Maximum center spacing' intervals starting from the beginning",
                "Remainder distance is left at the end of the segment"
              ]
            }
          },
          {
            "condition": "propAnchorsUnderDoor (during Recalc)",
            "path1": {
              "name": "Yes",
              "steps": [
                "Ignore door opening geometry",
                "Calculate anchors across the full wall width"
              ]
            },
            "path2": {
              "name": "No",
              "steps": [
                "Identify door openings on the selected side",
                "Split distribution segments at door boundaries (minus distanceToDoor)",
                "Prevent anchor generation in the door zone"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent erase)",
            "recovery": "Script automatically erases itself if insertCycleCount() > 1 to prevent infinite loops during 'Select Elements' processing."
          },
          {
            "check": "Element Existence",
            "errorMessage": "invalid or no element selected.",
            "recovery": "Script erases itself. User must run the command again and select a valid Wall Element."
          },
          {
            "check": "Element Type/Validity",
            "errorMessage": "None (Implicit erase)",
            "recovery": "Script checks if the element is a valid ElementWallSF. If not, the instance is erased."
          },
          {
            "check": "Envelope Geometry",
            "errorMessage": "None (Implicit erase)",
            "recovery": "Script projects the envelope to a line. If fewer than 2 points are found, the instance is erased."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Properties",
            "how": "Object Properties Palette (OPM)",
            "effect": "Changing 'Anchor distribution', 'Style', or 'Anchors' properties triggers 'executeMode = 1'. The script recalculates anchor positions or updates visualization immediately."
          },
          {
            "action": "Add Anchors",
            "how": "Right-click Context Menu -> 'Add anchor'",
            "effect": "Sets executeMode = 2. Prompts user to click points on screen. Adds these points to the existing list (_PtG)."
          },
          {
            "action": "Remove Anchors",
            "how": "Right-click Context Menu -> 'Remove anchor'",
            "effect": "Sets executeMode = 3. Prompts user to click points near existing anchors. Removes matching anchors from the list."
          },
          {
            "action": "Recalculate",
            "how": "Right-click Context Menu -> 'Recalculate' or Element Geometry Change",
            "effect": "Sets executeMode = 1. Clears current points (if not in manual mode) and re-runs the automatic distribution algorithm based on current settings and wall geometry."
          }
        ]
      },
      "tokens_used": 12612,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_W-AnchorDistribution.mcr\n\n## Overview\nThis script automates the calculation and distribution of anchor points (such as wind brackets or hold-downs) on wall elements based on spacing rules. It also supports manual placement modes and generates visual symbols and hardware data for production lists.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script operates in 3D model space on Wall Elements. |\n| Paper Space | No | Not supported for layout/drawing generation. |\n| Shop Drawing | No | This is a model-generation script. |\n\n## Prerequisites\n- **Required Entities**: A valid Wall Element (`ElementWallSF`) must exist in the model.\n- **Minimum Beam Count**: 0 (Uses Wall Elements, not beams).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_W-AnchorDistribution.mcr`\n\n### Step 2: Configure Properties\nThe script loads the Properties Palette. Before placing anchors, check the following key setting:\n- **Select anchor positions manually**: \n  - Set to **No** (Default) for automatic calculation.\n  - Set to **Yes** to click specific positions manually.\n\n### Step 3: Select Elements (Automatic Mode)\n*If \"Select anchor positions manually\" is set to No.*\n```\nCommand Line: Select elements [<Enter, for manual mode|>\nAction: Click on the wall elements you want to process. Press Enter to finish.\nResult: The script automatically places anchors on the selected walls based on spacing properties and erases itself from the cursor.\n```\n\n### Step 4: Select Element and Points (Manual Mode)\n*If \"Select anchor positions manually\" is set to Yes.*\n```\nCommand Line: Select an element\nAction: Click on the specific wall element to attach the anchors.\n\nCommand Line: Select a position\nAction: Click on the wall where the first anchor should be located.\n\nCommand Line: Select next point\nAction: Click for additional anchors. Press Enter to finish placement.\n```\n\n## Properties Panel Parameters\n\n### Anchor Distribution\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Select anchor positions manually | dropdown | Yes | If 'Yes', you pick points. If 'No', the script calculates them automatically. |\n| Side | dropdown | Top | Which face of the wall to apply anchors to (Top, Bottom, Right, Left). |\n| Maximum center spacing | number | 1000 | The maximum distance allowed between anchor centers (mm). |\n| Distribute evenly | dropdown | No | If 'Yes', anchors are spaced equally. If 'No', they use max spacing starting from one end. |\n| Minimum distance between anchors | number | 300 | Minimum gap required between two anchors. |\n| Anchors under door | dropdown | Yes | Determines if anchors are placed in the wall section below door openings. |\n| Distance to door | number | 50 | Offset distance from the door opening edge to the nearest anchor (mm). |\n| Distance to edge | number | 150 | Offset distance from the wall ends (start/stop) to the first/last anchor (mm). |\n| Apply edge anchors | dropdown | Yes | If 'No', the anchors at the very start and end edges are removed. |\n\n### Anchors\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Symbol | text | X | The text character displayed in the model for the anchor. |\n| Article number | text | | The hardware code for the BOM/Material List. |\n| Subtype | text | | A classification tag used by dimensioning scripts to filter these anchors. |\n\n### Visualization (Inferred)\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Show anchors | dropdown | Yes | Toggles the visibility of the anchor symbols in the model. |\n| Dimension mode | dropdown | No dimension | Controls display: None, \"General spacing\", or \"All anchor positions\". |\n| Text height | number | 50 | Size of the anchor symbol text. |\n| Text height dimension | number | 30 | Size of the dimension text labels. |\n| Offset from element Y | number | 150 | Distance the symbol is offset from the wall surface. |\n| Anchor color | number | 1 | AutoCAD color index for the symbol (1 = Red). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| **Recalculate** | Clears existing points (in auto mode) and re-runs the distribution algorithm based on current wall geometry and properties. |\n| **Add anchor** | Enters a point-selection mode. Clicks on the model will add new anchor points to the current list. |\n| **Remove anchor** | Enters a point-selection mode. Clicking near existing anchors removes them from the list. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not rely on external XML settings files; it uses the Properties Palette for configuration.\n\n## Tips\n- **Subtype Usage**: Use the \"Subtype\" property to group anchors. Dimension scripts can filter by this subtype to create specific labels for different anchor types (e.g., \"Wind\" vs \"HoldDown\").\n- **Visuals in Drawings**: The script displays anchors in Top View but hides them in Elevation views to keep drawings clean.\n- **Quick Adjustments**: You can change the \"Side\" property (e.g., from Top to Left) to instantly rotate the anchor layout to a different wall face without re-selecting the wall.\n\n## FAQ\n- **Q: Why did my anchors disappear after I changed the wall length?**\n  - A: The script is linked to the wall geometry. Changing the wall length usually triggers a recalculation. If the spacing logic no longer fits, the positions update automatically.\n- **Q: How do I place an anchor exactly in a corner despite the \"Distance to edge\" setting?**\n  - A: Set \"Select anchor positions manually\" to \"Yes\", or switch to Manual Mode and click the specific corner point. Alternatively, set \"Distance to edge\" to 0 and recalculate.\n- **Q: Can I use this for curved walls?**\n  - A: The script uses the element envelope. While it primarily handles linear distribution, it projects onto the element envelope. It is best suited for straight walls."
      },
      "tokens_used": 8388,
      "error": null
    }
  }
}