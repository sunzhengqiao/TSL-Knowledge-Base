{
  "filename": "hsb_SetEntityColor.mcr",
  "status": "completed",
  "total_tokens": 28163,
  "processing_time": 386.5799219608307,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3419,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit use of `_kModelSpace` in `TslInst.dbCreate`. Script operates on `Element` and `GenBeam` entities. No `_Viewport`, `_kPaperSpace`, or layout-specific logic detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 3585,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "|Select elements|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Dialog (showDialog)",
            "trigger": "On Insert (if no execute key found)",
            "title": null,
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "entityHeightFilter",
            "type": "PropString",
            "displayName": "Filter definition for entity height",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": "Dynamic (Catalog names of 'HSB_G-FilterGenBeams' plus empty option)",
            "category": null,
            "description": "Filter definition for beams to nail. Use HSB_G-FilterGenBeams to define the filters."
          },
          {
            "index": 1,
            "variable": "entityWidthFilter",
            "type": "PropString",
            "displayName": "Filter definition for entity width",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": "Dynamic (Catalog names of 'HSB_G-FilterGenBeams' plus empty option)",
            "category": null,
            "description": "Filter definition for beams to nail. Use HSB_G-FilterGenBeams to define the filters."
          },
          {
            "index": 0,
            "variable": "eColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5266,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script to visually distinguish beams within an Element by applying a specific color to those that match defined height and width filter criteria.",
          "category": "Visualization/Utility",
          "typicalUseCase": "Used during design or checking phases to highlight specific timber sizes (e.g., highlighting all rafters deeper than 200mm) directly in the CAD model without generating geometry."
        },
        "parameters": [
          {
            "name": "entityHeightFilter",
            "technicalDefault": "",
            "businessMeaning": "Selects a pre-defined filter rule based on the height (depth) of the beams. This determines which beams are candidates for coloring.",
            "validRange": "String values corresponding to catalog entries in 'HSB_G-FilterGenBeams'. Empty string applies no height filter.",
            "unit": "N/A (String Catalog Selector)",
            "affectsOutput": "Narrows the selection of beams within the Element. Beams not matching the height rule (if one is selected) will not have their color changed."
          },
          {
            "name": "entityWidthFilter",
            "technicalDefault": "",
            "businessMeaning": "Selects a pre-defined filter rule based on the width (thickness) of the beams. This further refines the candidates for coloring.",
            "validRange": "String values corresponding to catalog entries in 'HSB_G-FilterGenBeams'. Empty string applies no width filter.",
            "unit": "N/A (String Catalog Selector)",
            "affectsOutput": "Narrows the selection of beams within the Element. Beams not matching the width rule (if one is selected) will not have their color changed."
          },
          {
            "name": "eColor",
            "technicalDefault": "0",
            "businessMeaning": "The color applied to the beams that match the filter criteria. This uses standard AutoCAD Color Index (ACI) values.",
            "validRange": "0 to 255 (Standard ACI). Common values: 1=Red, 2=Yellow, 3=Green, 4=Cyan, 5=Blue, 6=Magenta, 7=White/Black. 0=ByBlock.",
            "unit": "Color Index",
            "affectsOutput": "Changes the display color of the 3D beam model in the drawing to provide visual contrast or identification."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Availability of 'HSB_G-FilterGenBeams' catalogs",
            "effect": "The options available in the entityHeightFilter and entityWidthFilter dropdowns are populated dynamically. If the external catalog is empty or the TSL is not loaded, no filter options will be available.",
            "cascade": [
              "entityHeightFilter",
              "entityWidthFilter"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Visual Attribute Modification",
            "description": "Modifies the 'Color' property of existing GenBeam entities. No new geometry or machining is generated. The script instance deletes itself after execution.",
            "appliedTo": "GenBeam entities contained within the selected Element that pass the Height and Width filters."
          }
        ]
      },
      "tokens_used": 4592,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 7157,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetEntityColor.mcr\n\n## Overview\nThis utility script allows you to change the display color of specific beams within a selected Element based on height and width criteria. It is useful for visually highlighting specific timber sizes (e.g., all rafters of a certain depth) directly in the 3D model without generating new geometry.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates on Elements and GenBeams in the 3D model. |\n| Paper Space | No | Not designed for layout views or 2D drawings. |\n| Shop Drawing | No | Not intended for manufacturing views. |\n\n## Prerequisites\n- **Required Entities**: An existing `Element` (usually a wall or roof assembly) containing `GenBeam` entities.\n- **Minimum Beam Count**: 0 (The script will handle empty elements gracefully).\n- **Required Settings**: The catalog `HSB_G-FilterGenBeams` must exist and contain entries to populate the filter dropdowns.\n\n## Usage Steps\n\n### Step 1: Launch Script\nExecute the command `TSLINSERT` in the AutoCAD command line and select `hsb_SetEntityColor.mcr` from the file dialog.\n\n### Step 2: Select Element\n```\nCommand Line: Select elements\nAction: Click on the Element (wall, floor, roof) containing the beams you wish to color.\n```\nOnce selected, the script instance is created in the drawing.\n\n### Step 3: Configure Filters and Color\nWith the script instance selected, press `Ctrl+1` to open the **Properties Palette**.\n1. **Filter definition for entity height**: Select a filter rule from the dropdown (e.g., \">=200\"). Leave empty to ignore height.\n2. **Filter definition for entity width**: Select a filter rule from the dropdown. Leave empty to ignore width.\n3. **Color**: Enter the AutoCAD Color Index (ACI) number (e.g., `1` for Red, `5` for Blue).\n\nThe script will automatically apply the color to matching beams and delete its own instance from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Filter definition for entity height | dropdown | \"\" | Select a pre-defined rule from the `HSB_G-FilterGenBeams` catalog to filter beams by their height (depth). |\n| Filter definition for entity width | dropdown | \"\" | Select a pre-defined rule from the `HSB_G-FilterGenBeams` catalog to filter beams by their width (thickness). |\n| Color | number | 0 | The AutoCAD Color Index (ACI) to apply to matching beams. (e.g., 1=Red, 2=Yellow, 3=Green, 5=Blue). 0 = ByBlock. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script runs immediately upon insertion and property modification. No specific context menu options are defined. |\n\n## Settings Files\n- **Catalog**: `HSB_G-FilterGenBeams`\n- **Location**: hsbCAD Company/Install path (Catalogs)\n- **Purpose**: Defines the list of logical operators and values available in the \"Filter definition\" dropdowns (e.g., \">200\", \"<=45\").\n\n## Tips\n- **Combined Filters**: If you set both a Height filter and a Width filter, a beam must meet **both** criteria to be colored.\n- **Filter Availability**: If the dropdown options are empty, check that your `HSB_G-FilterGenBeams` catalog is loaded and contains valid entries.\n- **Re-running**: The script instance deletes itself after running. To change colors again, simply insert the script again and select the element.\n- **Visual Checking**: Use bright colors like Red (1) or Yellow (2) to make specific timber sizes stand out against the rest of the model.\n\n## FAQ\n- **Q: Why didn't any beams change color?**\n  A: Check if the filters you selected actually match the size of the beams in your element. Also, ensure you are not using Color 0 (ByBlock) if your layer settings are overriding it.\n- **Q: Can I use this to filter by material or name?**\n  A: No, this script specifically filters by geometric Height and Width properties only."
      },
      "tokens_used": 4144,
      "error": null
    }
  }
}