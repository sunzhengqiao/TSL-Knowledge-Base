{
  "filename": "HSB_E-ToolPath.mcr",
  "status": "completed",
  "total_tokens": 60122,
  "processing_time": 671.1267399787903,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": null,\n    \"majorVersion\": null,\n    \"minorVersion\": null,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": \"\",\n  \"versionHistory\": [\n    {\n      \"version\": \"2.15\",\n      \"date\": \"05/09/2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"Fix when considering door openings\"\n    },\n    {\n      \"version\": \"2.14\",\n      \"date\": \"05/09/2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"Improve when intersecting PLine with PlaneProfile\"\n    },\n    {\n      \"version\": \"2.13\",\n      \"date\": \"04/09/2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"Add properties for excluding regions at bottom,top,left,right\"\n    },\n    {\n      \"version\": \"2.12\",\n      \"date\": \"04/09/2025\",\n      \"author\": \"Marsel Nakuci\",\n      \"changes\": \"Add properties to exclude opening or/and outter contours for tooling\"\n    },\n    {\n      \"version\": \"2.11\",\n      \"date\": \"14-11-2023\",\n      \"author\": \"Ronald van Wijngaarden\",\n      \"changes\": \"Add zone 0 as tooling zone.\"\n    },\n    {\n      \"version\": \"2.10\",\n      \"date\": \"31/08/2023\",\n      \"author\": \"Robert Pol\",\n      \"changes\": \"Make sure start symbol is in same zone\"\n   "
      },
      "tokens_used": 8860,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script operates directly on the Element object (el) to add CNC manufacturing data (Saw/Mill) using el.addTool(). It manipulates geometry within Element zones and queries Sheet entities. It lacks ShopDrawing identifiers (sd_), Viewport logic, or #Type E definitions required for 2D generation."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB_G-CleanupPolyLine"
          ]
        }
      },
      "tokens_used": 6865,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"sequenceNumber\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Sequence number|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"|The sequence number is used to sort the list of tsl's during generate construction|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"toolType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Tool type|\",\n      \"defaultValue\": \"|Saw|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Saw|\",\n        \"|Mill|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"propZoneIndex\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Zone index|\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"toolingIndex\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"|Tool index|\",\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"propPathDirection\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Path direction|\",\n      \"defaultValue\": \"|Manual|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Manual|\",\n        \"|Clockwise|\",\n        \"|Anticlockwise|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"propToolSide\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Tool side|\",\n      \"defaultValue\": \"|Right|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Left|\",\n        \"|Right|\",\n        \"|Auto|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"propTurningDirection\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Turning direction tool|\",\n      \"defaultValue\": \"|Against course|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Against course|\",\n        \"|With course|\",\n        \"|Auto|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"propOvershoot\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Overshoot|\",\n      \"defaultValue\": \"|Yes|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"additionalSawDepth\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Extra depth|\",\n      \"defaultValue\": \"1 mm\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sawAngle\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Saw angle|\",\n      \"defaultValue\": 0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"spropExcludeOpenings\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Exclude openings|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines whether the openings should be excluded for tooling or not.|\"\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"spropExcludeOutterContours\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|Exclude outter contours|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|No|\",\n        \"|Yes|\"\n      ],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines whether the outter contours should be excluded for tooling or not.|\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dRegionLeft\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Left|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the width of the left region where tooling is excluded|\"\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"dRegionRight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Right|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the width of the right region where tooling is excluded|\"\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"dRegionBottom\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Bottom|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the width of the bottom region where tooling is excluded|\"\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"dRegionTop\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Top|\",\n      \"defaultValue\": \"0\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|Tooling|\",\n      \"description\": \"|Defines the width of the top region where tooling is excluded|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"withNoNailAreaProp\",\n      \"type\": \"PropString\",\n      \"displayName\": \"|With no nail area|\",\n      \"defaultValue\": \"|No|\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"|Yes|\",\n        \"|No|\"\n      ],\n      \"category\": \"|No nail area|\",\n      \"description\": \"|Specifies whether there will be a no nail area applied.|\"\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"offsetNoNailAreaLeft\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset left|\",\n      \"defaultValue\": \"5 mm\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|No nail area|\",\n      \"description\": \"|Sets the offset of the no nail area on the lefthand side of the tool path.|\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"offsetNoNailAreaRight\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset right|\",\n      \"defaultValue\": \"5 mm\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|No nail area|\",\n      \"description\": \"|Sets the offset of the no nail area on the righthand side of the tool path.|\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"offsetNoNailAreaStart\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset start|\",\n      \"defaultValue\": \"5 mm\",\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": \"|No nail area|\",\n      \"description\": \"|Sets the offset of the no nail area on the start of the tool path.|\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"offsetNoNailAreaEnd\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"|Offset end|\",\n      \"defaultValue\": \"5 mm\",\n      \"inputType\": \"number\",\n      \"options"
      },
      "tokens_used": 9999,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Applies CNC machining operations (Saw or Mill) to a specific zone of a timber element based on a defined path geometry.",
          "category": "Machining/CNC",
          "typicalUseCase": "Adding custom cuts, slots, or drill paths to wall or floor panels during the generation of production data, particularly where standard auto-machining rules do not apply."
        },
        "parameters": [
          {
            "name": "sequenceNumber",
            "technicalDefault": 0,
            "businessMeaning": "Defines the execution order of this script relative to other TSLs during the 'Generate Construction' process.",
            "validRange": "0 - 100",
            "unit": "Integer (Priority)",
            "affectsOutput": "Process execution order. Does not change geometry directly."
          },
          {
            "name": "toolType",
            "technicalDefault": "Saw",
            "businessMeaning": "Selects the type of CNC operation to perform (Sawing vs. Milling).",
            "validRange": "Saw, Mill",
            "unit": "Enumeration",
            "affectsOutput": "Determines if an ElemSaw or ElemMill object is created in the CNC data."
          },
          {
            "name": "propZoneIndex",
            "technicalDefault": 1,
            "businessMeaning": "Specifies the material layer (Zone) of the element to be machined. E.g., 0 might be the structural layer, 1 the sheathing.",
            "validRange": "0 - 10 (Element dependent)",
            "unit": "Index",
            "affectsOutput": "Sets the depth at which the tool operates and the plane profile used for collision/path validation."
          },
          {
            "name": "toolingIndex",
            "technicalDefault": 1,
            "businessMeaning": "The catalog number of the specific tool bit or saw blade to be used in the machine.",
            "validRange": "Machine Catalog Specific (e.g., 1-50)",
            "unit": "Integer ID",
            "affectsOutput": "Determines the physical width and capabilities of the cut in the CNC export."
          },
          {
            "name": "propPathDirection",
            "technicalDefault": "Manual",
            "businessMeaning": "Dictates the movement direction of the tool along the path. 'Clockwise' or 'Anticlockwise' overrides the drawn direction.",
            "validRange": "Manual, Clockwise, Anticlockwise",
            "unit": "Enumeration",
            "affectsOutput": "Travel direction of the machine head; influences auto-detection of 'Left' vs 'Right' side."
          },
          {
            "name": "propToolSide",
            "technicalDefault": "Right",
            "businessMeaning": "Determines on which side of the drawn line the tool cuts. 'Auto' calculates side based on the path direction (Right for Clockwise, Left for Anticlockwise).",
            "validRange": "Left, Right, Auto",
            "unit": "Enumeration",
            "affectsOutput": "The lateral offset of the tool relative to the input geometry."
          },
          {
            "name": "propTurningDirection",
            "technicalDefault": "Against course",
            "businessMeaning": "Controls the rotation of the tool relative to travel direction (Upcut vs Downcut). 'Against course' is typically Upcut (cleaner exit).",
            "validRange": "Against course, With course, Auto",
            "unit": "Enumeration",
            "affectsOutput": "Spindle rotation direction in CNC code; affects surface finish."
          },
          {
            "name": "propOvershoot",
            "technicalDefault": "Yes",
            "businessMeaning": "Extends the tool path slightly beyond the start and end points to ensure a complete cut through the material.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Adds lead-in/lead-out moves to the CNC path."
          },
          {
            "name": "additionalSawDepth",
            "technicalDefault": "1 mm",
            "businessMeaning": "Extra cutting depth added to the material thickness to guarantee the tool cuts completely through the element.",
            "validRange": "0 mm - 10 mm",
            "unit": "Length (mm)",
            "affectsOutput": "Increases the Z-depth of the cut."
          },
          {
            "name": "sawAngle",
            "technicalDefault": 0,
            "businessMeaning": "The bevel angle of the saw blade relative to the vertical Z-axis.",
            "validRange": "-90 deg - 90 deg",
            "unit": "Angle (Degrees)",
            "affectsOutput": "Creates angled cuts (e.g., for scarf joints or weather seals)."
          },
          {
            "name": "spropExcludeOpenings",
            "technicalDefault": "No",
            "businessMeaning": "If set to Yes, the tool path will not be generated over window/door openings within the zone.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Suppresses machining over openings."
          },
          {
            "name": "spropExcludeOutterContours",
            "technicalDefault": "No",
            "businessMeaning": "If set to Yes, the tool path will not be generated over the outer boundary edges of the element.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Suppresses machining near the outer edges of the wall/floor."
          },
          {
            "name": "dRegionLeft/Right/Bottom/Top",
            "technicalDefault": "0",
            "businessMeaning": "Defines 'keep-out' margins from the edges of the element sheets. No machining will occur within these specified widths from the respective edge.",
            "validRange": "0 mm - 500 mm",
            "unit": "Length (mm)",
            "affectsOutput": "Clips the tool path geometry to stay inside these boundaries."
          },
          {
            "name": "withNoNailAreaProp",
            "technicalDefault": "No",
            "businessMeaning": "Enables the creation of a 'No Nail Area' along the tool path, prohibiting fasteners (nails/screws) near the cut to prevent tool damage.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Generates 'ElemNoNail' entities in the production data."
          },
          {
            "name": "offsetNoNailAreaLeft/Right/Start/End",
            "technicalDefault": "5 mm",
            "businessMeaning": "Dimensions of the 'No Nail' safe zone relative to the tool path centerline.",
            "validRange": "0 mm - 100 mm",
            "unit": "Length (mm)",
            "affectsOutput": "Size of the restricted fastener area."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "propToolSide is set to 'Auto'",
            "effect": "The script calculates the physical tool side (Left/Right) based on the 'propPathDirection' (Clockwise=Right, Anticlockwise=Left).",
            "cascade": [
              "propPathDirection"
            ]
          },
          {
            "trigger": "toolType is set to 'Mill'",
            "effect": "The 'sawAngle' parameter is ignored or effectively unused, as milling tools handle angles differently than fixed saws.",
            "cascade": [
              "sawAngle"
            ]
          },
          {
            "trigger": "withNoNailAreaProp is set to 'No'",
            "effect": "The offset parameters (Offset left/right/start/end) are ignored.",
            "cascade": [
              "offsetNoNailAreaLeft",
              "offsetNoNailAreaRight",
              "offsetNoNailAreaStart",
              "offsetNoNailAreaEnd"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "ElemSaw",
            "description": "A linear cutting operation defined by a start point, end point, depth, and saw angle.",
            "appliedTo": "Selected Element"
          },
          {
            "type": "ElemMill",
            "description": "A pathed cutting operation allowing for complex geometry and contouring.",
            "appliedTo": "Selected Element"
          },
          {
            "type": "ElemNoNail",
            "description": "A restricted area forbidding the placement of nails or screws.",
            "appliedTo": "Selected Element Zone"
          }
        ]
      },
      "tokens_used": 11682,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script",
          "2. Check _kExecuteKey for '|Delete|' or '|Dummy|' commands",
          "3. [Conditional] Execute command or Proceed to Property Definition",
          "4. Declare Properties (Tooling, No Nail Area categories)",
          "5. [Insert Mode] Select Element",
          "6. [Insert Mode] Select Tool Path Entities (Polylines, Circles, or GenBeams)",
          "7. Calculate Element Coordinate System and Zone Index",
          "8. Convert Input Geometry to PLine (ToolPath)",
          "9. [Insert Mode] Insert TSL instance into database",
          "10. Retrieve stored ToolPath from _Map",
          "11. [Validation] Verify ToolPath exists and length > Minimum Allowed",
          "12. [Conditional] Restore Original Path or Erase Instance if Invalid",
          "13. Determine Zone Thickness (from Zone or Sheets)",
          "14. Construct Zone Profile (Union of Sheet shapes within zone)",
          "15. Apply Filters to Sheets (requires HSB_G-CleanupPolyLine)",
          "16. Analyze Path Position (Detect if on Opening Ring)",
          "17. Calculate Path Direction (Clockwise/Anticlockwise)",
          "18. [Conditional] Reverse Path if Property Direction conflicts with calculation",
          "19. [Conditional] Calculate Tool Side (Auto/Left/Right)",
          "20. Create Tool (ElemSaw or ElemMill) based on Properties",
          "21. Add Tool to Element",
          "22. [Conditional] Create ElemNoNail entities if 'With no nail area' is Yes",
          "23. Visualization: Draw 'S' text at Start Point"
        ],
        "conditionalBranches": [
          {
            "condition": "_kExecuteKey equals '|Delete|'",
            "path1": {
              "name": "Execute Delete",
              "steps": [
                "Erase the TSL instance",
                "Return (Exit script)"
              ]
            },
            "path2": {
              "name": "Ignore Command",
              "steps": [
                "Continue processing"
              ]
            }
          },
          {
            "condition": "Filter Definition TSL fails (e.g., missing script)",
            "path1": {
              "name": "Filter Error",
              "steps": [
                "Report Notice: 'Beams could not be filtered!'",
                "Erase Instance",
                "Return (Exit script)"
              ]
            },
            "path2": {
              "name": "Filter Success",
              "steps": [
                "Proceed with filtered Sheet entities"
              ]
            }
          },
          {
            "condition": "Calculated Tool Path length is less than Minimum Allowed",
            "path1": {
              "name": "Path Invalid",
              "steps": [
                "Report Error: 'Invalid toolpath found'",
                "Erase Instance",
                "Return (Exit script)"
              ]
            },
            "path2": {
              "name": "Path Valid",
              "steps": [
                "Continue processing"
              ]
            }
          },
          {
            "condition": "Property 'Path direction' (Manual/Clockwise/Anticlockwise) vs Calculated Geometry",
            "path1": {
              "name": "Direction Mismatch",
              "steps": [
                "Reverse the ToolPath PLine geometry",
                "Invert the Normal vector",
                "Update pathIsClockwise flag"
              ]
            },
            "path2": {
              "name": "Direction Match or Manual",
              "steps": [
                "Use ToolPath as is"
              ]
            }
          },
          {
            "condition": "Property 'Tool side' is set to '|Auto|'",
            "path1": {
              "name": "Auto Calculation",
              "steps": [
                "Check pathIsClockwise flag",
                "If Clockwise: Set Tool Side to Left",
                "If Anticlockwise: Set Tool Side to Right"
              ]
            },
            "path2": {
              "name": "Explicit Side",
              "steps": [
                "Use Left or Right as defined in Property"
              ]
            }
          },
          {
            "condition": "Property 'Tool type'",
            "path1": {
              "name": "Saw",
              "steps": [
                "Instantiate ElemSaw",
                "Apply SawAngle if not 0",
                "Add to Element"
              ]
            },
            "path2": {
              "name": "Mill",
              "steps": [
                "Instantiate ElemMill",
                "Add to Element (SawAngle ignored)"
              ]
            }
          },
          {
            "condition": "Property 'With no nail area' is '|Yes|'",
            "path1": {
              "name": "Create No Nail Zones",
              "steps": [
                "Iterate through ToolPath segments",
                "Create Rectangles based on Offset Left/Right/Start/End",
                "Instantiate ElemNoNail for each segment",
                "Add to Element"
              ]
            },
            "path2": {
              "name": "No No Nail Zones",
              "steps": [
                "Skip No Nail creation"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Availability of HSB_G-CleanupPolyLine TSL",
            "errorMessage": "Make sure that the tsl HSB_G-CleanupPolyLine is loaded in the drawing",
            "recovery": "Load the specified script into the CAD environment."
          },
          {
            "check": "Tool Path Geometry Validity",
            "errorMessage": "Invalid toolpath found.",
            "recovery": "Ensure selected geometry is valid and sufficiently long; script self-erases on failure."
          },
          {
            "check": "Zone Index Existence",
            "errorMessage": "Zone thickness 0 (Implicit failure if no sheets found)",
            "recovery": "Select a valid Element with material in the specified Zone Index."
          },
          {
            "check": "Sheet Alignment",
            "errorMessage": "None explicit in output, but script ignores sheets where Z-vector is not aligned with Element Z-vector.",
            "recovery": "Ensure Element and internal Sheets are geometrically aligned."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Edit Properties",
            "how": "OPM (Object Properties Palette)",
            "effect": "Updates Tool Type, Depth, Side, No Nail Area offsets, and Exclusion Regions."
          },
          {
            "action": "Geometry Modification",
            "how": "Grip Edit on the TSL visualization",
            "effect": "Updates the underlying ToolPath PLine stored in _Map, triggering recalculation of the tool path."
          },
          {
            "action": "Delete",
            "how": "Context Menu -> '|Delete|'",
            "effect": "Removes the TSL instance and associated tooling from the Element."
          },
          {
            "action": "Recalculate",
            "how": "Context Menu -> Recalculate",
            "effect": "Re-executes the script logic to update tooling based on property changes or Element modifications."
          }
        ]
      },
      "tokens_used": 12500,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-ToolPath.mcr\n\n## Overview\nThis script applies CNC machining operations (Sawing or Milling) to a specific material zone of a timber element based on user-defined geometry (Polylines, Circles, or Beams). It is used to create custom cuts, slots, or drill paths while offering options to exclude openings and define \"No Nail\" areas to prevent fastener conflicts.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates directly on 3D Elements in the model. |\n| Paper Space | No | Not applicable for 2D drawings. |\n| Shop Drawing | No | This generates production data (CNC), not drawing views. |\n\n## Prerequisites\n- **Required Entities**: An `Element` (e.g., Wall or Floor) containing `Sheet` entities.\n- **Minimum Beam Count**: 0.\n- **Required Settings/Scripts**: The script `HSB_G-CleanupPolyLine.mcr` must be loaded in the drawing to handle geometry filtering.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse and select `HSB_E-ToolPath.mcr`.\n\n### Step 2: Select Target Element\n```\nCommand Line: Select Element:\nAction: Click on the timber element (wall or floor) you wish to machine.\n```\n\n### Step 3: Define Tool Path\n```\nCommand Line: Select entities for tool path [Polylines/Circles/GenBeams]:\nAction: Select the geometry in the drawing that represents the desired cut path.\nNote: You can select Polylines, Circles, or existing Beams to define the shape.\n```\n\n### Step 4: Configuration\nAfter insertion, the script processes the geometry. You can now adjust the machining parameters via the Properties Palette (Ctrl+1) while the script instance is selected.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| **General** | | | |\n| Sequence number | Integer | 0 | Determines the execution order relative to other TSLs during \"Generate Construction\". |\n| **Tooling** | | | |\n| Tool type | Dropdown | Saw | Choose between `Saw` (linear cutting) or `Mill` (pathed/contouring). |\n| Zone index | Integer | 1 | The material layer to machine (e.g., 0 = structural layer, 1 = sheathing). |\n| Tool index | Integer | 1 | The specific tool/bit number from the machine catalog to use. |\n| Path direction | Dropdown | Manual | Sets the cutting direction: `Manual`, `Clockwise`, or `Anticlockwise`. |\n| Tool side | Dropdown | Right | Determines which side of the line the tool cuts. `Auto` calculates this based on path direction. |\n| Turning direction tool | Dropdown | Against course | Spindle rotation direction relative to travel (Upcut/Downcut). |\n| Overshoot | Dropdown | Yes | Extends the cut slightly beyond the start/end points to ensure a clean cut. |\n| Extra depth | Double | 1 mm | Additional depth added to the cut to ensure penetration through the material. |\n| Saw angle | Double | 0 deg | The bevel angle of the saw blade relative to vertical. |\n| Exclude openings | Dropdown | No | If `Yes`, tooling will not occur over window or door openings. |\n| Exclude outter contours | Dropdown | No | If `Yes`, tooling will be suppressed near the outer edges of the element. |\n| Left | Double | 0 mm | Defines a \"keep-out\" margin on the left side of the element (no tooling). |\n| Right | Double | 0 mm | Defines a \"keep-out\" margin on the right side of the element. |\n| Bottom | Double | 0 mm | Defines a \"keep-out\" margin on the bottom side of the element. |\n| Top | Double | 0 mm | Defines a \"keep-out\" margin on the top side of the element. |\n| **No nail area** | | | |\n| With no nail area | Dropdown | No | If `Yes`, creates a zone where nails/screws are prohibited along the tool path. |\n| Offset left | Double | 5 mm | Width of the no-nail zone to the left of the path. |\n| Offset right | Double | 5 mm | Width of the no-nail zone to the right of the path. |\n| Offset start | Double | 5 mm | Length of the no-nail zone before the cut start. |\n| Offset end | Double | 5 mm | Length of the no-nail zone after the cut end. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Delete | Removes the script instance and the associated CNC tooling from the element. |\n| Recalculate | Re-runs the script to update tooling based on property changes or element modifications. |\n\n## Settings Files\n- **Filename**: None specific (XML).\n- **Dependency**: Requires `HSB_G-CleanupPolyLine.mcr`.\n- **Purpose**: The dependency script is used to filter and clean up the geometry defining the tool path.\n\n## Tips\n- **Closed Loops**: When using a closed polyline (e.g., a rectangle), set **Path direction** to `Clockwise` or `Anticlockwise` and set **Tool side** to `Auto`. This ensures the tool stays on the correct side of the material (inside or outside).\n- **Through Cuts**: Always add a small **Extra depth** (e.g., 1-5 mm) to guarantee the saw cuts completely through the material thickness, accounting for swelling or calibration errors.\n- **Avoiding Fasteners**: Enable **With no nail area** `Yes` when cutting near edges where nails might be located. This prevents the CNC machine from hitting a nail and damaging the tool.\n- **Modifying Paths**: You can grip-edit the visualization (the 'S' symbol and path) in the model to adjust the cut location without re-inserting the script.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I selected the geometry?**\n  **A:** The tool path was likely too short or invalid, or the required Zone Index had no thickness (no sheets found). Check your element structure and ensure the `HSB_G-CleanupPolyLine` script is loaded.\n- **Q: What does \"Zone index\" mean?**\n  **A:** This refers to the material layers in your element. Index `0` is usually the main structural timber, while `1`, `2`, etc., refer to cladding or sheathing layers added in the element composition.\n- **Q: Can I use this to cut a window opening?**\n  **A:** While technically possible, this script is designed for custom paths. For standard window openings, use the dedicated Opening tools. However, you can use this to trim sheathing around an opening by using the **Exclude openings** property smartly."
      },
      "tokens_used": 10216,
      "error": null
    }
  }
}