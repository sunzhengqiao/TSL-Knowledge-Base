{
  "filename": "HSB_G-SetToElement.mcr",
  "status": "completed",
  "total_tokens": 27594,
  "processing_time": 327.15624237060547,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 3,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "01.12.2016",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "18.04.2017",
            "author": "AS",
            "changes": "Rename tsl from HSB_G-SetPanHand into HSB_G-SetToElement."
          },
          {
            "version": "1.02",
            "date": "07.06.2017",
            "author": "DR",
            "changes": "Added option to assign genBeams to element with zone number, exclusive and character option"
          },
          {
            "version": "1.03",
            "date": "08.06.2017",
            "author": "AS",
            "changes": "Create a boolean for the assignToElement"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3915,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select GenBeam objects and getElement to select an Element. It modifies model data using setPanhand() and assignToElementGroup(). It lacks sd_ prefix, Multipage prefix, _Viewport checks, or #Type E declarations. The script calls eraseInstance() at the end, indicating it is a transient utility script operating on the 3D model."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 3434,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select a set of beams, sheets or sips|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getElement",
              "promptOriginal": "|Select element to set the panhand for the selected entities to.|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "Shown during insertion via showDialog() if not executed via catalog key",
            "title": null,
            "dataSource": "Script Properties (sSelectedZone, sZoneCharacter, sExclusive)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSelectedZone",
            "type": "PropString",
            "displayName": "|Assign to element zone|",
            "defaultValue": "|Don't assign|",
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10",
              "|Don't assign|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sZoneCharacter",
            "type": "PropString",
            "displayName": "Zone character",
            "defaultValue": "'Z' for general items",
            "inputType": "dropdown",
            "options": [
              "'E' for element tools",
              "'Z' for general items",
              "'T' for beam tools",
              "'I' for information",
              "'C' for construction",
              "'D' for dimension"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sExclusive",
            "type": "PropString",
            "displayName": "Add exclusive",
            "defaultValue": "|Yes|",
            "inputType": "dropdown",
            "options": [
              "|No|",
              "|Yes|"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3408,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script to associate selected structural members (beams, sheets, SIPs) with a target construction element, assigning them specific zone attributes and classification for project organization.",
          "category": "Data Management / Organization",
          "typicalUseCase": "Used during the detailing or cleanup phase to re-categorize loose modeling elements into specific element zones (e.g., assigning loose studs or plates to a specific wall element) to ensure correct reporting and listing."
        },
        "parameters": [
          {
            "name": "sSelectedZone",
            "technicalDefault": "|Don't assign|",
            "businessMeaning": "Selects the specific 'Zone Number' (sub-group) within the target element to which the items belong. Used for detailed breakdown of elements in lists or production.",
            "validRange": "0 to 10, or |Don't assign|",
            "unit": "Index",
            "affectsOutput": "If a number is selected, it triggers the zone assignment logic. If 'Don't assign' is selected, the items are only linked to the element generally (Panhand set), but specific zone attributes are ignored."
          },
          {
            "name": "sZoneCharacter",
            "technicalDefault": "'Z' for general items",
            "businessMeaning": "Defines the functional category or type of the item within the zone context (e.g., 'Z' for general, 'E' for element tools, 'T' for beam tools).",
            "validRange": "E, Z, T, I, C, D",
            "unit": "Character",
            "affectsOutput": "Sets the classification character attribute, which can be used for filtering in CAM or export processes."
          },
          {
            "name": "sExclusive",
            "technicalDefault": "|Yes|",
            "businessMeaning": "Determines if the selected items are exclusive to the target element. If 'Yes', items are removed from any other element groups they might belong to.",
            "validRange": "|Yes|, |No|",
            "unit": "Boolean",
            "affectsOutput": "Controls whether the script removes the item's association with other elements in the model."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sSelectedZone is set to |Don't assign|",
            "effect": "Disables the zone assignment logic. The script will only set the Panhand (parent link) and skip the assignToElementGroup function, effectively ignoring sZoneCharacter and sExclusive.",
            "cascade": [
              "sZoneCharacter",
              "sExclusive"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Data Update",
            "description": "Updates the Element relationship and Zone properties of existing GenBeams/Sheets.",
            "appliedTo": "Selected GenBeams, Sheets, or SIPs"
          }
        ]
      },
      "tokens_used": 5405,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution initiated",
          "Check for Execute Key (_kExecuteKey)",
          "[Branch] If Execute Key is missing, Show Dynamic Dialog to configure Zone/Character/Exclusive options",
          "Save current Property settings to Catalog '_LastInserted'",
          "Prompt user to select source entities (Beams, Sheets, or SIPs) via PrEntity",
          "Filter selected entities to valid GenBeams and store in _GenBeam array",
          "Prompt user to select target Element via getElement",
          "Store target Element in _Element array and end insertion cycle (return)",
          "Script recalculation triggers (Execution phase)",
          "Retrieve Property settings from '_LastInserted'",
          "Calculate derived values: Zone Index, Zone Character, Exclusive Boolean, and 'assignToElement' Boolean",
          "Validate that Target Element exists (check _Element.length)",
          "Iterate through each stored GenBeam in _GenBeam array",
          "Set GenBeam Panhand to the Target Element",
          "[Conditional] If 'assignToElement' is TRUE: Assign GenBeam to Element Group with specific Zone/Char/Exclusive settings",
          "Delete script instance (eraseInstance)"
        ],
        "conditionalBranches": [
          {
            "condition": "Presence of an Execute Key",
            "path1": {
              "name": "Execute Key Found",
              "steps": [
                "Load properties directly from catalog key",
                "Skip Dynamic Dialog",
                "Proceed to entity selection"
              ]
            },
            "path2": {
              "name": "No Execute Key",
              "steps": [
                "Display Dynamic Dialog",
                "User manually configures Zone, Character, and Exclusive options",
                "Proceed to entity selection"
              ]
            }
          },
          {
            "condition": "Zone Assignment Selection ('assignToElement' Boolean)",
            "path1": {
              "name": "Zone Number Selected (0-10)",
              "steps": [
                "Set Panhand to Element",
                "Execute assignToElementGroup() with calculated Zone Index, Character, and Exclusive flag"
              ]
            },
            "path2": {
              "name": "'Don't assign' Selected",
              "steps": [
                "Set Panhand to Element",
                "Skip assignToElementGroup() call (Zone and Character settings ignored)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Target Element existence",
            "errorMessage": "None (Silent failure)",
            "recovery": "Script instance erases itself if _Element array is empty during execution. User must re-run script and ensure an element is selected."
          },
          {
            "check": "Entity Selection",
            "errorMessage": "None (Handled by PrEntity)",
            "recovery": "If PrEntity selection fails or returns no valid GenBeams, the script proceeds with an empty list (no changes made to beams)."
          },
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None",
            "recovery": "If insertCycleCount() > 1, script erases itself to prevent infinite loops during re-calculation."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None",
            "how": "N/A",
            "effect": "The script calls eraseInstance() immediately after processing, removing itself from the drawing. No subsequent modifications via Properties Palette or Grips are possible."
          }
        ]
      },
      "tokens_used": 6277,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-SetToElement.mcr\n\n## Overview\nThis utility script allows you to link selected structural items (beams, sheets, or SIPs) to a specific construction Element. It provides options to assign specific \"Zone\" numbers and classification characters to the items, ensuring they are correctly organized within the project hierarchy for listings and production.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model. |\n| Paper Space | No | Not applicable for layout views. |\n| Shop Drawing | No | This is a model organization tool, not a drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: At least one GenBeam (beam, sheet, or SIP) and one Element must exist in the model.\n- **Minimum Beam Count**: 1\n- **Required Settings**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_G-SetToElement.mcr`\n\n### Step 2: Configure Assignment Settings\nA dialog will appear automatically upon launch (unless a specific catalog execute key is used).\n**Action**: Choose how you want to classify the items you are about to select.\n- **Assign to element zone**: Select a number (0-10) to put items in a specific zone, or select \"Don't assign\" to only link them to the element parent.\n- **Zone character**: Select a code (e.g., 'Z' for general, 'E' for element tools) to categorize the item type.\n- **Add exclusive**: Select \"Yes\" to remove the items from any other elements they might currently belong to, or \"No\" to keep existing associations.\n\n### Step 3: Select Source Entities\n```\nCommand Line: Select a set of beams, sheets or sips\nAction: Click on the beams, sheets, or SIPs you wish to modify. Press Enter to confirm selection.\n```\n\n### Step 4: Select Target Element\n```\nCommand Line: Select element to set the panhand for the selected entities to.\nAction: Click on the main Element (e.g., a Wall or Floor) that you want the selected items to belong to.\n```\n\n**Result**: The script updates the data links and then automatically deletes itself from the drawing.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Assign to element zone | Dropdown | Don't assign | Selects the specific Zone Number (0-10) within the target element. If \"Don't assign\" is selected, only the parent link (Panhand) is updated. |\n| Zone character | Dropdown | 'Z' for general items | Defines the functional category of the item (e.g., 'Z' for general, 'T' for beam tools, 'E' for element tools). |\n| Add exclusive | Dropdown | Yes | If \"Yes\", the items are removed from any other element groups they previously belonged to. If \"No\", they are added to this element while keeping previous associations. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script erases itself immediately after execution. No right-click menu options are available after the script runs. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script does not use external settings files.\n\n## Tips\n- **Auto-Delete**: The script instance is removed from the drawing immediately after processing. You cannot change settings afterwards via the Properties Palette; you must run the script again if you need to make changes.\n- **Zone Assignment**: If you only want to \"parent\" the items to an element without setting specific zone data, ensure \"Assign to element zone\" is set to \"Don't assign\".\n- **Multiple Selection**: You can select multiple beams, sheets, or SIPs in Step 3 using standard AutoCAD selection windows (Crossing or Window).\n\n## FAQ\n- **Q: Where did the script go after I used it?**\n  **A:** This is a \"transient\" utility script. It automatically deletes itself from the model once it has finished updating the element data.\n- **Q: What is the difference between \"Assign to element zone\" and just linking?**\n  **A:** Linking (Panhand) groups the item under the element structurally. Assigning a \"Zone\" adds a specific attribute (index 0-10) often used for detailed filtering in production lists or reports.\n- **Q: What does \"Exclusive\" mean?**\n  **A:** If set to \"Yes\", the script will ensure the selected items belong *only* to the newly selected element, severing ties to any other elements they were previously assigned to."
      },
      "tokens_used": 5155,
      "error": null
    }
  }
}