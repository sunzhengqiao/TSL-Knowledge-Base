{
  "filename": "Rothoblaas Typ X.mcr",
  "status": "completed",
  "total_tokens": 49496,
  "processing_time": 408.5750832557678,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9605,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script constructs 3D geometry using Body objects and adds Drill tools to a GenBeam (bm0.addTool). It manages HardWrComp (hardware) in 3D. There are no calls to sd_ functions, _Viewport, or Sheet management typical of Paper Space or Shop Drawing scripts."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space (3D environment)",
          "requiredSettings": []
        }
      },
      "tokens_used": 6993,
      "error": null
    },
    "3": {
      "success": true,
      "data": {},
      "tokens_used": 10292,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Inserts and configures Rothoblaas Typ X post bases, creating the 3D steel representation, drilling holes in the timber post, and assigning BOM hardware.",
          "category": "Hardware",
          "typicalUseCase": "Used during detailing to anchor vertical posts (columns) to concrete foundations using specific Rothoblaas hardware kits."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "\"S1-SBD\"",
            "businessMeaning": "Selects the specific Rothoblaas configuration type (e.g., S1, S2, R1), determining the base geometry, drill pattern, and required fasteners for the timber connection.",
            "validRange": "S1-SBD, S1-STA, S2-SBD, S2-STA, R1, R2",
            "unit": "Enum",
            "affectsOutput": "Changes dimensions of the steel base, the number and position of drill holes in the timber, and the BOM fasteners."
          },
          {
            "name": "sAnchoring",
            "technicalDefault": "\"Expansion anchor\"",
            "businessMeaning": "Specifies the method used to anchor the bottom plate of the post base to the ground/concrete.",
            "validRange": "Expansion anchor, Screw anchor, Chemical dowel",
            "unit": "Enum",
            "affectsOutput": "Updates the hardware list (BOM) with the specific anchor type and size (e.g., AB1, SKR, VINYLPRO)."
          },
          {
            "name": "dSlotWidth",
            "technicalDefault": "10.0",
            "businessMeaning": "Defines the width of slots required in the timber when using Epoxy resin (R1/R2) types to allow adhesive flow.",
            "validRange": "10mm, 12mm",
            "unit": "mm",
            "affectsOutput": "Modifies the width of drill holes/slots in the timber for types R1 and R2. Does not apply to self-drilling or peg types."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sType selection changes (e.g., to R1 or R2)",
            "effect": "Activates 'dSlotWidth' requirement and changes drill pattern in timber to slots.",
            "cascade": [
              "dSlotWidth"
            ]
          },
          {
            "trigger": "sType selection changes (e.g., between S1, S2, S3, S4)",
            "effect": "Updates drill pattern coordinates (dDrillVert arrays) and fastener quantities/dimensions.",
            "cascade": [
              "Peg Articles",
              "Peg Dimensions"
            ]
          },
          {
            "trigger": "sAnchoring selection changes",
            "effect": "Updates the bottom fastener article in the BOM.",
            "cascade": [
              "sScrewArticleBottom",
              "dScrewDiaBottom"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Body (Visual)",
            "description": "The 3D representation of the Rothoblaas steel post base (bottom plate and vertical knife plate).",
            "appliedTo": "Model Space (inserted at beam coordinate system origin)"
          },
          {
            "type": "Drill",
            "description": "Holes or slots drilled into the timber post to accommodate pegs or epoxy resin, based on the selected pattern (S1-S4 or R1-R2).",
            "appliedTo": "Selected GenBeam (Post)"
          },
          {
            "type": "HardWrComp",
            "description": "Bill of Materials entries including the main bracket, top fasteners (pegs/resin), and bottom anchors.",
            "appliedTo": "Script Instance"
          }
        ]
      },
      "tokens_used": 7456,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script Launch: User starts script from catalog or key-in.",
          "2. Cycle Check: Script verifies insertCycleCount() is 1 to prevent duplicate instances.",
          "3. Input Determination: Checks if _kExecuteKey is present.",
          "   - If Yes: Attempts to load properties from the specified catalog name.",
          "   - If No: Opens Properties Dialog (ShowDialog) for user to select Type, Anchoring, and Slot Width.",
          "4. Entity Selection: User selects one or multiple beams (GenBeam).",
          "5. Point Selection (Optional):",
          "   - User presses Enter: Script defaults to bottom point of vertical beams (Pointing Down).",
          "   - User selects a Point: Point is projected to beam X-axis. Defines base location and allows sloped beams or upside-down insertion.",
          "6. Geometry Generation:",
          "   - Constructs 3D Body for Post Base (Bottom plate + Knife plate) based on 'sType'.",
          "   - Calculates Drill Pattern based on 'sType' (S1-S4 or R1-R2) and 'dSlotWidth'.",
          "   - Adds Drill tools to the selected Beam(s).",
          "7. BOM Generation:",
          "   - Removes old TSL hardware components.",
          "   - Adds Main Component (Post Base).",
          "   - Adds Top Fasteners (Pegs or Epoxy).",
          "   - Adds Bottom Anchors (Expansion, Screw, or Chemical).",
          "8. Visualization: Draws 3D representation and sets Hyperlink.",
          "9. Completion: Instance is saved to database."
        ],
        "conditionalBranches": [
          {
            "condition": "Point Selection during Insertion",
            "path1": {
              "name": "No Point (Press Enter)",
              "steps": [
                "Script targets only vertical beams.",
                "Insertion point is fixed to the bottom of the beam.",
                "Orientation is fixed pointing downwards."
              ]
            },
            "path2": {
              "name": "Point Selected",
              "steps": [
                "Script projects selected point onto the Beam's X-axis.",
                "Supports sloped beams (excluding horizontal).",
                "Allows insertion upside down on top of posts.",
                "Projected point becomes the bottom of the post base."
              ]
            }
          },
          {
            "condition": "Mounting Type (sType) Selection",
            "path1": {
              "name": "S1-S4 (Pegs)",
              "steps": [
                "Selects specific drill pattern array (dDrillVertS1, S2, S3, or S4).",
                "Generates cylindrical drill holes.",
                "Adds specific quantity of Peg fasteners to BOM.",
                "No 'Slot Width' dependency."
              ]
            },
            "path2": {
              "name": "R1-R2 (Epoxy)",
              "steps": [
                "Activates 'dSlotWidth' property usage.",
                "Generates slot drills for adhesive flow.",
                "Adds Epoxy adhesive (XEPOX) to BOM.",
                "Triggers warning about Hundegger BVN machine compatibility."
              ]
            }
          },
          {
            "condition": "Specific Pattern Geometry (S3)",
            "path1": {
              "name": "Standard Pattern (S1, S2, S4)",
              "steps": [
                "Calculates drill positions based on standard offset arrays.",
                "No additional offsets applied."
              ]
            },
            "path2": {
              "name": "S3 Pattern (Self drilling pegs - Pattern 3)",
              "steps": [
                "Applies specific logic (nType == 2).",
                "Alternates offsets for every other drill line to create a staggered pattern."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Machine Compatibility for Epoxy Types",
            "errorMessage": "!!! Attention !!!\nThe required head slots for this type can't be executed on Hundegger BVN machines!",
            "recovery": "User acknowledges warning via ReportNotice. Production must account for this limitation (manual machining or different machine)."
          },
          {
            "check": "Beam Orientation with Point Selection",
            "errorMessage": "Not explicitly coded as an error, but stated in remarks: Horizontal beams are not supported when using point selection.",
            "recovery": "User must select a vertical or sloped beam, or use the 'No Point' insertion method which strictly enforces vertical beams."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Mounting Method",
            "how": "Object Properties Palette (OPM) - Change 'sType' (Property A).",
            "effect": "Updates steel base dimensions, changes drill pattern geometry, updates BOM quantities/articles, and triggers recalculation."
          },
          {
            "action": "Modify Anchoring",
            "how": "Object Properties Palette (OPM) - Change 'sAnchoring' (Property B).",
            "effect": "Updates the Bottom Anchor hardware article in the BOM (e.g., from AB1 to VINYLPRO)."
          },
          {
            "action": "Modify Slot Width",
            "how": "Object Properties Palette (OPM) - Change 'dSlotWidth' (Property C).",
            "effect": "Updates the width of the slot holes drilled in the timber (Only active/visible for R1/R2 types)."
          },
          {
            "action": "Dynamic Recalculation",
            "how": "Changing any property or moving the associated beam.",
            "effect": "Script detects _kNameLastChangedProp or geometry change and regenerates the 3D body, drills, and hardware list."
          }
        ]
      },
      "tokens_used": 10128,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Rothoblaas Typ X\n\n## Overview\nInserts and configures Rothoblaas Typ X post bases. It automatically generates the 3D steel geometry, drills connection holes or slots into the timber post, and assigns the correct hardware and anchors to the BOM.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for 3D geometry and machining. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: At least one GenBeam (Post/Column).\n- **Minimum Beam Count**: 1.\n- **Required Settings**: None (uses internal catalogs or property defaults).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `Rothoblaas Typ X.mcr` from the catalog.\n\n### Step 2: Configuration\n```\nDialog: Properties\nAction: Select the Post Base Type (e.g., S1-SBD, S2-STA, R1) and Anchoring method (e.g., Expansion anchor, Screw anchor).\nNote: For Epoxy types (R1/R2), adjust the Slot Width if necessary.\n```\n\n### Step 3: Select Beams\n```\nCommand Line: Select beams\nAction: Click on the timber post(s) you wish to anchor.\n```\n\n### Step 4: Select Insertion Point\n```\nCommand Line: Select point / <Enter> for bottom\nAction:\n- Press Enter: The script defaults to the bottom point of vertical beams (standard installation).\n- Click a Point: Select a specific location to define the base height or to install upside-down.\n```\n\n### Step 5: Confirmation\nThe script generates the steel base, drills the timber, and populates the BOM.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| sType | Dropdown | S1-SBD | Selects the Rothoblaas configuration type (S1-S4 for pegs, R1-R2 for epoxy). This changes the steel geometry, drill patterns, and fasteners. |\n| sAnchoring | Dropdown | Expansion anchor | Defines how the base plate anchors to concrete. Options include Expansion anchor, Screw anchor, and Chemical dowel. Updates the bottom fastener article. |\n| dSlotWidth | Number | 10.0 | Defines the width of slots in mm for Epoxy types (R1/R2) to allow adhesive flow. Only applies if R1 or R2 is selected. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Properties | Opens the properties palette to modify Type, Anchoring, or Slot Width. |\n| Recalculate | Regenerates the 3D geometry, holes, and BOM if the beam is moved or properties change. |\n\n## Settings Files\n- **Catalog**: Internal or Custom Catalog\n- **Purpose**: Stores default dimensions and article numbers based on the selected `sType` and `sAnchoring`.\n\n## Tips\n- **Sloped Beams**: To anchor a post base on a sloped beam (or upside-down), you must pick a point during insertion rather than pressing Enter.\n- **Epoxy Types**: If using R1 or R2, ensure your CNC machine supports the required slot width.\n- **Machine Warning**: Be aware that the slots required for Epoxy types (R1/R2) cannot be executed on Hundegger BVN machines automatically.\n\n## FAQ\n- **Q: Can I use this script on horizontal beams?**\n  A: No, this script is designed for vertical or sloped posts/columns only. Horizontal beams are not supported.\n\n- **Q: What is the difference between S-Type and R-Type?**\n  A: S-Types (S1-S4) use self-drilling pegs and require cylindrical drill holes. R-Types (R1-R2) use epoxy resin and require wider slots to allow the glue to flow.\n\n- **Q: How do I change the anchor type after inserting the base?**\n  A: Select the script instance, open the Properties palette, and change the `sAnchoring` dropdown. The BOM will update automatically."
      },
      "tokens_used": 5022,
      "error": null
    }
  }
}