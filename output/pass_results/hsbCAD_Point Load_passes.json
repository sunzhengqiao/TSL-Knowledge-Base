{
  "filename": "hsbCAD_Point Load.mcr",
  "status": "completed",
  "total_tokens": 43911,
  "processing_time": 301.63787865638733,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "04.09.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.3",
            "date": "03.03.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.4",
            "date": "24.08.2009",
            "author": null,
            "changes": "Add the option to specify an extrusion profile for the PointLoad Beams"
          },
          {
            "version": "1.5",
            "date": "09.10.2009",
            "author": null,
            "changes": "Fix the module code"
          },
          {
            "version": "1.6",
            "date": "02.11.2009",
            "author": null,
            "changes": "Set the beam type to Stud"
          },
          {
            "version": "1.6",
            "date": "03.11.2009",
            "author": null,
            "changes": "Fix the issue when the poinload is insert in a wall with 2 bottom plates like the SuperFrame Fix the issue of duplicated child TSLs when the drawing is open. Set the beam type to Stud Change the Display a bit"
          },
          {
            "version": "1.7",
            "date": "06.04.2010",
            "author": null,
            "changes": "Fix the Orientation of the extrusion profile beams"
          },
          {
            "version": "1.8",
            "date": "22.09.2010",
            "author": null,
            "changes": "Fix issue when the poinload is insert in the edge of the element and can not find intersection with the top and bottom plate"
          },
          {
            "version": "1.9",
            "date": "02.02.2011",
            "author": null,
            "changes": "Added ability to notch around Beams with Beamcode Token Position 0 = \"H\""
          },
          {
            "version": "1.10",
            "date": "23.02.2011",
            "author": null,
            "changes": "Add the label N to the beams that are notch"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7419,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script creates 3D geometry using Body and Beam.dbCreate(). It interacts with structural Element objects and uses assignToElementGroup(). No 'sd_' prefix, '_Viewport' usage, or '#Type E' entities characteristic of Paper Space or Shop Drawing scripts are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Extrusion profiles",
            "DimStyles"
          ]
        }
      },
      "tokens_used": 5733,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": "Select an element",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nNrOfBms",
            "type": "PropInt",
            "displayName": "Number of beams",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sExtrusionProfile",
            "type": "PropString",
            "displayName": "Extrusion profile name",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "System Extrusion Profiles (via ExtrProfile().getAllEntryNames())"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Text style",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "System Dimension Styles (via _DimStyles)"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7223,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automates the insertion of a reinforced stud pack (Point Load) into a timber wall element to support concentrated vertical loads, automatically replacing standard studs in the designated location.\",\n    \"category\": \"Structural Framing\",\n    \"typicalUseCase\": \"Used when a structural load (e.g., from a floor joist, header, or roof beam) transfers a point load onto a wall that requires more strength than a single standard stud provides.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"nNrOfBms\",\n      \"technicalDefault\": \"1\",\n      \"businessMeaning\": \"Specifies the number of studs to group together to form the point load reinforcement.\",\n      \"validRange\": \"1 to 10 (Typically 2, 3, or 4 studs in construction)\",\n      \"unit\": \"count\",\n      \"affectsOutput\": \"Determines the quantity of studs generated. Increases the overall width of the reinforcement pack, which may result in more existing standard studs being deleted to make space.\"\n    },\n    {\n      \"name\": \"sExtrusionProfile\",\n      \"technicalDefault\": \"Rectangular (System Default)\",\n      \"businessMeaning\": \"Defines the cross-sectional shape and size (profile) of the studs used for the reinforcement.\",\n      \"validRange\": \"List of available Extrusion Profiles (e.g., 45x145, 140x240 Glulam) from the catalog\",\n      \"unit\": \"profile\",\n      \"affectsOutput\": \"Controls the physical geometry (width/height) of the new studs. If 'Rectangular' is used, the stud width defaults to the wall's element height (thickness).\"\n    },\n    {\n      \"name\": \"sDimStyle\",\n      \"technicalDefault\": \"First available System DimStyle\",\n      \"businessMeaning\": \"Specifies the text style used for the visual annotation of the point load in the model.\",\n      \"validRange\": \"List of defined Dimension Styles in the project\",\n      \"unit\": \"style\",\n      \"affectsOutput\": \"Controls the font and size properties of the label/markers drawn in the 3D view to indicate the presence of the point load.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"Change in nNrOfBms\",\n      \"effect\": \"Modifies the calculated width of the search body used to intersect with existing structure.\",\n      \"cascade\":"
      },
      "tokens_used": 8826,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Launch Script: User executes the TSL script.\",\n    \"2. Element Selection: Prompted to select an Element (Wall).\",\n    \"3. Insertion Point Calculation: Calculate the exact insertion point based on user click and Element geometry.\",\n    \"4. Top/Bottom Plate Search: Identify the closest Top and Bottom plates within the search zone based on the calculated width of the point load.\",\n    \"5. Property Inheritance: Search element for a standard Stud (HSB ID 114) to copy Name, Grade, and Material.\",\n    \"6. Map Cleanup: Remove any existing beams from previous script calculations stored in the script map.\",\n    \"7. Point Load Generation: Loop to create 'nNrOfBms' new studs.\",\n    \"8. Dynamic Stretching: Stretch new studs vertically to the identified Top and Bottom plates.\",\n    \"9. Interference Cleanup: Delete any standard studs (HSB ID 114) that geometrically overlap with the new Point Load beams.\",\n    \"10. Notching Logic: Check for beams with Beamcode 'H' and notch the new Point Load beams around them if found.\",\n    \"11. Visual Output: Draw 3D representation (Box with 'X') and store in Map.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Check Extrusion Profile Type\",\n      \"path1\": {\n        \"name\": \"Custom Profile Selected\",\n        \"steps\": [\n          \"Load profile definition\",\n          \"Calculate beam width based on profile dimensions\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Rectangular (Default) Profile\",\n        \"steps\": [\n          \"Set beam width equal to Element height (Wall thickness)\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Check for Beams to Notch (Beamcode 'H')\",\n      \"path1\": {\n        \"name\": \"'H' Beams Found\",\n        \"steps\": [\n          \"Create cutting tool using 'H' beam geometry\",\n          \"Apply tool to new Point Load beams\",\n          \"Set Label of Point Load"
      },
      "tokens_used": 9380,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCAD_Point Load.mcr\n\n## Overview\nThis script automates the insertion of a reinforced stud pack (Point Load) into a timber wall element to support concentrated vertical loads. It replaces standard studs at the specified location with a user-defined number of reinforcement studs.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script must be run in the 3D model environment. |\n| Paper Space | No | Not designed for 2D layouts or drawings. |\n| Shop Drawing | No | Not a shop drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: A Wall Element must already exist in the model.\n- **Minimum Beam Count**: 0 (it generates new beams).\n- **Required Settings**: \n  - System Extrusion Profiles (catalog of available timber sizes).\n  - System Dimension/Text Styles (for labeling).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCAD_Point Load.mcr` from the file dialog.\n\n### Step 2: Select Element\n```\nCommand Line: Select an element\nAction: Click on the Wall Element where the point load needs to be applied.\n```\nThe script will calculate the insertion point based on where you clicked the wall and automatically insert the reinforcement studs.\n\n## Properties Panel Parameters\n\nOnce the script is inserted and the element is selected, you can modify the following properties in the AutoCAD Properties Palette (Ctrl+1):\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Number of beams | Integer | 1 | The quantity of studs to generate as a pack. Increasing this widens the reinforcement area. |\n| Extrusion profile name | Dropdown | System Default | Selects the cross-sectional profile (size and shape) of the reinforcement studs from the system catalog. |\n| Text style | Dropdown | System Default | Selects the font style used for the visual label/annotation of the point load in the model. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu items are assigned to this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script relies on global system catalogs (Extrusion Profiles and DimStyles) rather than external XML settings files.\n\n## Tips\n- **Automatic Cleanup**: The script automatically deletes standard studs (HSB ID 114) that overlap with the new point load studs to avoid geometry conflicts.\n- **SuperFrame Compatibility**: The script correctly handles walls with double bottom plates (such as SuperFrame walls).\n- **Notching**: If the script encounters beams with Beamcode \"H\" (typically horizontal beams), it will automatically notch the point load studs around them.\n- **Visual Marker**: A 3D box with an \"X\" is drawn to visually indicate the location and extent of the point load in the model.\n\n## FAQ\n- **Q: What happens if I change the \"Number of beams\" property?**\n- **A:** The script will recalculate the width of the point load. If the new pack is wider, it may delete additional standard studs to make room.\n  \n- **Q: Can I use a specific timber size for the point load?**\n- **A:** Yes. Use the \"Extrusion profile name\" property in the Properties Palette to select any profile available in your hsbCAD catalogs.\n\n- **Q: The script didn't fit between my top and bottom plates.**\n- **A:** Ensure the insertion click is within the wall bounds. The script attempts to find the nearest top and bottom plates; if the click is too close to the edge, it may fail to intersect properly."
      },
      "tokens_used": 5330,
      "error": null
    }
  }
}