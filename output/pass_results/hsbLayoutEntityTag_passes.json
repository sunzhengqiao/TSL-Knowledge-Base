{
  "filename": "hsbLayoutEntityTag.mcr",
  "status": "completed",
  "total_tokens": 56614,
  "processing_time": 535.0055892467499,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl creates posnum tags in paperspace. A clash detection resolves overlapping tags. Types and formats can be typed in the appropriate properties, but the context menu supports adding and removing of sub entries Various styles of the tag design are available. Format instructions are written as @(<PROPERTY>), i.e. @(Length). If no format instruction is given the posnum will be displayed. Properties of real numbers support rounding instructions, i.e. @(Length:0) will round the length to zero decimals",
        "versionHistory": [
          {
            "version": "1.9",
            "date": "20oct2020",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSB-9338 internal naming bugfix"
          },
          {
            "version": "1.8",
            "date": "13mar2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "merged"
          },
          {
            "version": "1.7",
            "date": "12mar2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "performance improved"
          },
          {
            "version": "1.6",
            "date": "11mar2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "Default no tag area added as context command"
          },
          {
            "version": "1.4",
            "date": "04mar2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HSBCAD-537 new context commands to set format and type variables, functionality extended"
          },
          {
            "version": "1.3",
            "date": "18feb2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "new object 'opening supported'"
          },
          {
            "version": "1.2",
            "date": "13mar2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "new property to automatically assign posnums and/or set dependencies"
          },
          {
            "version": "1.1",
            "date": "26jan2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "clash detection enhanced"
          },
          {
            "version": "1.0",
            "date": "25jan2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 7851,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script summary explicitly states it 'creates posnum tags in paperspace'. The code uses getViewport() to prompt the user to select a viewport and stores it in the _Viewport array. The insert logic specifically handles viewports, and the functionality describes placing tags on a layout."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Beam",
            "Sheet",
            "Panel",
            "WallElement",
            "Opening",
            "TSL"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Paper Space (Layout) with at least one viewport defined.",
          "requiredSettings": []
        }
      },
      "tokens_used": 7882,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getViewport",
              "promptOriginal": "|Select a viewport|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "|Pick a point outside of paperspace|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "getViewport",
              "promptOriginal": "|Select a viewport|",
              "condition": "_bOnRecalc && (_kExecuteKey==|Add Viewport| || _kExecuteKey==TslDoubleClick)",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "On insert when no execution key (_kExecuteKey) is present",
            "title": null,
            "dataSource": "Internal Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Type|",
            "defaultValue": "|byZone|",
            "inputType": "dropdown",
            "options": [
              "|byZone|",
              "|Beam|",
              "|Sheet|",
              "|Panel|",
              "|GenBeam|",
              "|TSL|",
              "|Opening|",
              "|Door|",
              "|Window|",
              "|Window Assembly|"
            ],
            "category": "|Content|",
            "description": "|Defines the type of entity which will be collected.| |Empty = by current zone, else specify types.| |Use context commands to select.|"
          },
          {
            "index": 7,
            "variable": "sTSLScript",
            "type": "PropString",
            "displayName": "|TSL Names|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Content|",
            "description": "|Specifies a list of tsl names to be displayed.| |Multiple entries to be separated by a semicolon.|"
          },
          {
            "index": 1,
            "variable": "sAttribute",
            "type": "PropString",
            "displayName": "|Format|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Content|",
            "description": "|Defines the text and/or attributes.|  |Multiple lines are separated by a backslash| '  |Attributes can also be added or removed by context commands.|"
          },
          {
            "index": 2,
            "variable": "sZone",
            "type": "PropString",
            "displayName": "|Zone|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|Content|",
            "description": "|Defines the zone which will be collected.| |Empty = by current zone, else specify zones.|"
          },
          {
            "index": 3,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "|Dimstyle|",
            "defaultValue": "",
            "inputType": "dropdown",
            "options": [],
            "category": "|Display|",
            "description": "|Defines the Dimstyle|"
          },
          {
            "index": 0,
            "variable": "dTextHeight",
            "type": "PropDouble",
            "displayName": "|Text Height|",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": "|Display|",
            "description": "|Defines the Text Height|  |0 = byDimstyle|"
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "|Color|",
            "defaultValue": "-2",
            "inputType": "number",
            "options": [],
            "category": "|Display|",
            "description": "|Defines the color.| |-2 = byEntity, -1 = byLayer, 0 = byBlock, >0 = color index|"
          },
          {
            "index": 4,
            "variable": "sOrientation",
            "type": "PropString",
            "displayName": "|Orientation|",
            "defaultValue": "|byEntity|",
            "inputType": "dropdown",
            "options": [
              "|byEntity|",
              "|Horizontal|",
              "|Vertical|"
            ],
            "category": "|Display|",
            "description": "|Defines the Orientation|"
          },
          {
            "index": 5,
            "variable": "sStyle",
            "type": "PropString",
            "displayName": "|Style|",
            "defaultValue": "|Text only|",
            "inputType": "dropdown",
            "options": [
              "|Text only|",
              "|Text + Leader|",
              "|Border|",
              "|Border+Leader|",
              "|Filled Frame|",
              "|Filled Frame+Leader|"
            ],
            "category": "|Display|",
            "description": "|Defines the Style|"
          },
          {
            "index": 6,
            "variable": "sBehaviour",
            "type": "PropString",
            "displayName": "|Behaviour|",
            "defaultValue": "|Automatic|",
            "inputType": "dropdown",
            "options": [
              "|Automatic|",
              "|Automatic PosNum|",
              "|Set Dependencies|",
              "|Disabled|"
            ],
            "category": "|General|",
            "description": "|Defines the behaviour of the tool.| |Automatic will generate missing posnums and set a dependency to every beam.|"
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Add Viewport|",
            "handler": "|Add Viewport|",
            "action": "Prompts user to select a viewport and appends it to the internal _Viewport list",
            "alsoTriggeredBy": "Double Click"
          },
          {
            "menuItem": "|Add/Remove TSL|",
            "handler": "|Add/Remove TSL|",
            "action": "Logic implied by header, allows modifying TSL list (handler not found in truncated code)",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Set Leader Offset|",
            "handler": "|Set Leader Offset|",
            "action": "Logic implied by header, adjusts leader settings (handler not found in truncated code)",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Add/Remove Format|",
            "handler": "|Add/Remove Format|",
            "action": "Logic implied by header, modifies text format properties (handler not found in truncated code)",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Add No-Tag Area|",
            "handler": "|Add No-Tag Area|",
            "action": "Logic implied by header, defines exclusion zones (handler not found in truncated code)",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove No-Tag Area|",
            "handler": "|Remove No-Tag Area|",
            "action": "Logic implied by header, removes exclusion zones (handler not found in truncated code)",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": []
      },
      "tokens_used": 9539,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the creation and placement of labeling tags (posnums, dimensions, attributes) for structural elements in Paper Space layouts, including automatic clash detection to prevent text overlap.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used during the creation of production drawings or layout plans to annotate beams, panels, or other timber components with position numbers, dimensions, or custom text directly on the drawing sheet."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "byZone",
            "businessMeaning": "Filters which type of model elements (Beams, Sheets, Panels, etc.) will be labeled. 'byZone' defaults to elements within the current logical zone.",
            "validRange": "byZone, Beam, Sheet, Panel, GenBeam, TSL, Opening, Door, Window, Window Assembly",
            "unit": "enum",
            "affectsOutput": "Determines the set of entities selected for tagging. If incorrect, no tags will appear for the intended elements."
          },
          {
            "name": "sTSLScript",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on specific TSL script names assigned to them, allowing tagging of specific custom components (e.g., special joints or connections).",
            "validRange": "Any valid TSL script name found in the catalog (semicolon-separated list).",
            "unit": "string",
            "affectsOutput": "Restricts tagging to only those elements that match the specified script names, overriding general type selection if used in conjunction with 'TSL' type."
          },
          {
            "name": "sAttribute",
            "technicalDefault": "",
            "businessMeaning": "Defines the content of the tag text. Supports hardcoded text or dynamic placeholders for entity properties (e.g., @(Length), @(Posnum)).",
            "validRange": "Text string with optional @(Property) formatting tokens and backslashes for newlines.",
            "unit": "string",
            "affectsOutput": "Directly changes the textual information displayed in the tag (e.g., showing 'L=6000' vs just 'Posnum 12')."
          },
          {
            "name": "sZone",
            "technicalDefault": "",
            "businessMeaning": "Filters entities based on their assigned model zone (e.g., Floor 1, Roof).",
            "validRange": "Any valid zone name defined in the project.",
            "unit": "string",
            "affectsOutput": "Limits tagging to elements belonging to the specified zone, preventing clutter from other floors or sections."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "",
            "businessMeaning": "Selects the CAD dimension style to control text font, arrow style, and general appearance standards.",
            "validRange": "Any dimension style defined in the current CAD drawing.",
            "unit": "enum",
            "affectsOutput": "Alters the visual font, arrowheads, and precision settings of the tag text."
          },
          {
            "name": "dTextHeight",
            "technicalDefault": "0",
            "businessMeaning": "Sets the height of the text within the tag.",
            "validRange": "Typically 2.0mm to 5.0mm for standard A1/A0 plots (0 uses DimStyle default).",
            "unit": "mm",
            "affectsOutput": "Scales the tag text size up or down. Affects the tag's bounding box and clash detection."
          },
          {
            "name": "nColor",
            "technicalDefault": "-2",
            "businessMeaning": "Sets the display color of the tag.",
            "validRange": "-2 (ByEntity), -1 (ByLayer), 0 (ByBlock), 1-255 (ACI Color Index).",
            "unit": "index",
            "affectsOutput": "Changes the visual color of the tag geometry in the layout."
          },
          {
            "name": "sOrientation",
            "technicalDefault": "byEntity",
            "businessMeaning": "Controls the rotation angle of the tag relative to the entity or the world coordinate system.",
            "validRange": "byEntity, Horizontal, Vertical",
            "unit": "enum",
            "affectsOutput": "Rotates the tag text. 'byEntity' aligns with the beam's direction; 'Horizontal' keeps it readable for the viewer."
          },
          {
            "name": "sStyle",
            "technicalDefault": "Text only",
            "businessMeaning": "Determines the graphical style of the tag (presence of borders, frames, and leader lines pointing to the element).",
            "validRange": "Text only, Text + Leader, Border, Border+Leader, Filled Frame, Filled Frame+Leader",
            "unit": "enum",
            "affectsOutput": "Adds graphical elements like bounding boxes, filled backgrounds, or leader lines connecting the tag to the element."
          },
          {
            "name": "sBehaviour",
            "technicalDefault": "Automatic",
            "businessMeaning": "Defines how the script interacts with model numbering. 'Automatic' generates missing PosNums and links the tag to the element.",
            "validRange": "Automatic, Automatic PosNum, Set Dependencies, Disabled",
            "unit": "enum",
            "affectsOutput": "Controls whether position numbers are auto-assigned and if the tag updates automatically when the model changes."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dTextHeight is set to 0",
            "effect": "Text height is inherited from the selected DimStyle.",
            "cascade": [
              "sDimStyle"
            ]
          },
          {
            "trigger": "sType is set to 'TSL'",
            "effect": "sTSLScript becomes the primary filter for entity selection.",
            "cascade": [
              "sTSLScript"
            ]
          },
          {
            "trigger": "sType is set to 'byZone'",
            "effect": "sZone is used to filter elements; if sZone is empty, the current viewport's zone is used.",
            "cascade": [
              "sZone"
            ]
          },
          {
            "trigger": "sStyle includes 'Leader'",
            "effect": "Internal logic calculates leader line geometry based on tag position relative to the entity.",
            "cascade": [
              "sOrientation"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text/String",
            "description": "Annotated text labels containing posnums or property data.",
            "appliedTo": "Paper Space Layout"
          },
          {
            "type": "PLine/Polyline",
            "description": "Graphical borders, frames, and leader lines associated with the text tags.",
            "appliedTo": "Paper Space Layout"
          }
        ]
      },
      "tokens_used": 10447,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script launched via command (TSLCONTENT) or palette.",
          "2. [Insert Check] Verify if _bOnInsert is true.",
          "3. [Cycle Check] If insertCycleCount > 1, erase instance and exit immediately.",
          "4. [Catalog/Dialog Selection] Check if _kExecuteKey is provided.",
          "   - If Yes: Attempt to load properties from catalog name matching the key. Fallback to '_LastInserted' if not found.",
          "   - If No: Execute showDialog() to let user select properties.",
          "5. [User Input 1] Prompt user to Select a viewport using getViewport().",
          "6. [User Input 2] Prompt user to Pick a point outside of paperspace using getPoint().",
          "7. Store selected viewport in the _Viewport array and point in _Pt0.",
          "8. End Insertion cycle.",
          "9. [Recalculation Loop] Script runs on recalc or update.",
          "10. [Viewport Validation] Check if _Viewport array is empty.",
          "   - If Empty: Display error message 'please add a viewport' at _Pt0. Add context menu trigger 'Add Viewport'.",
          "11. [Entity Collection] Iterate through viewports in _Viewport list.",
          "12. Filter entities in the viewport based on sType (Type), sZone (Zone), and sTSLScript.",
          "13. For each collected entity, calculate initial tag position based on geometry.",
          "14. [Clash Detection Loop] Check intersection of tag boundary with ppProtect (Protected Area).",
          "   - If No Intersection: Accept location, update ppProtect, proceed to draw.",
          "   - If Intersection: Enter repositioning logic (shrink profile, scan along generated polylines).",
          "15. [Numbering/Dependency] Check sBehaviour property.",
          "   - If 'Automatic' or 'Automatic PosNum': Assign position numbers if missing.",
          "   - If 'Set Dependencies': Link tag to the entity.",
          "16. [Visual Construction] Determine Style and Orientation.",
          "17. Draw Text, Border/Frame, and optional Leader Line in Paper Space.",
          "18. Set execution sequence number for priority control."
        ],
        "conditionalBranches": [
          {
            "condition": "Insert Cycle Count",
            "path1": {
              "name": "First Cycle",
              "steps": [
                "Proceed with Catalog/Dialog selection.",
                "Request Viewport and Point input."
              ]
            },
            "path2": {
              "name": "Subsequent Cycle (>1)",
              "steps": [
                "Erase Instance.",
                "Exit Script."
              ]
            }
          },
          {
            "condition": "Viewport Availability on Recalc",
            "path1": {
              "name": "Viewports Defined",
              "steps": [
                "Iterate through stored viewports.",
                "Collect entities and generate tags."
              ]
            },
            "path2": {
              "name": "No Viewports",
              "steps": [
                "Display warning text.",
                "Enable 'Add Viewport' context trigger.",
                "Wait for user interaction (Right-click or Double-click)."
              ]
            }
          },
          {
            "condition": "Tag Intersection (Clash Detection)",
            "path1": {
              "name": "Clear Space Found",
              "steps": [
                "Lock in current tag position.",
                "Update global protected area (ppProtect) to include this tag.",
                "Draw geometry."
              ]
            },
            "path2": {
              "name": "Overlap Detected",
              "steps": [
                "Initiate while loop (max 100 iterations).",
                "Generate search lines based on entity type (Beams use 4 internal lines; others use outer contour).",
                "Test points along lines for free space.",
                "Move tag to first valid point found.",
                "If loop finishes without success, tag remains overlapping."
              ]
            }
          },
          {
            "condition": "Tag Style (sStyle)",
            "path1": {
              "name": "Leader Included (Text + Leader, Border+Leader, etc.)",
              "steps": [
                "Calculate anchor point on tag frame.",
                "Project point to entity axis.",
                "Draw leader line and connecting circle."
              ]
            },
            "path2": {
              "name": "No Leader (Text only, Border, Filled Frame)",
              "steps": [
                "Skip leader geometry calculation.",
                "Draw only text and border/fill."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Assignment",
            "errorMessage": "hsbLayoutEntityTag: please add a viewport",
            "recovery": "User must select 'Add Viewport' from the right-click context menu or double-click the script instance to initiate viewport selection."
          },
          {
            "check": "Entity Collection",
            "errorMessage": "No tags generated in layout.",
            "recovery": "Verify 'Type' and 'Zone' properties in OPM match entities in the selected viewport's model view. Ensure the viewport is not clipping the desired entities."
          },
          {
            "check": "Clash Resolution Limits",
            "errorMessage": "Tags remain overlapping if space is insufficient or iterations exceeded.",
            "recovery": "Reduce 'Text Height', reduce the number of entities in the viewport, or ensure the tag area is not constrained by 'No-Tag Areas'."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Add Viewport",
            "how": "Right-click Context Menu -> 'Add Viewport' or Double Click",
            "effect": "Prompts user to select an additional viewport. Adds it to the internal list and regenerates tags for the new view."
          },
          {
            "action": "Modify Tag Format",
            "how": "Right-click Context Menu -> 'Add/Remove Format'",
            "effect": "Opens a list of available attributes (Length, Width, etc.) to add or remove from the tag content string."
          },
          {
            "action": "Filter TSL Names",
            "how": "Right-click Context Menu -> 'Add/Remove TSL'",
            "effect": "Allows filtering tags based on specific TSL script names attached to elements."
          },
          {
            "action": "Adjust Leader",
            "how": "Right-click Context Menu -> 'Set Leader Offset'",
            "effect": "Modifies the leader line landing offset parameter."
          },
          {
            "action": "Define Exclusion Zones",
            "how": "Right-click Context Menu -> 'Add No-Tag Area'",
            "effect": "Prompts user to draw a rectangular area where tags will be automatically excluded or moved."
          },
          {
            "action": "Clear Exclusion Zones",
            "how": "Right-click Context Menu -> 'Remove No-Tag Area'",
            "effect": "Removes previously defined no-tag areas."
          },
          {
            "action": "Property Updates",
            "how": "AutoCAD Properties Palette (OPM)",
            "effect": "Changing properties like 'Text Height', 'Style', 'Type', or 'Zone' immediately triggers a recalculation and updates the layout tags."
          }
        ]
      },
      "tokens_used": 12171,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbLayoutEntityTag.mcr\n\n## Overview\nAutomates the creation of labeling tags (position numbers, dimensions, and attributes) for structural elements in Paper Space layouts. The script includes automatic clash detection to resolve overlapping tags and supports various graphical styles and content formats.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | Script operates on layout views. |\n| Paper Space | Yes | Tags are generated directly on the layout sheet. |\n| Shop Drawing | Yes | Designed for annotating production drawings and plans. |\n\n## Prerequisites\n- **Required Entities**: GenBeams, Sheets, Panels, WallElements, Openings, or TSL components must exist in the model.\n- **Minimum Beam Count**: 0.\n- **Required Settings**: A Paper Space Layout with at least one viewport defined is required.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbLayoutEntityTag.mcr` from the catalog list.\n\n### Step 2: Configure Settings (Optional)\nIf the script does not automatically launch into input mode, a dialog may appear. Otherwise, proceed to the command line prompts. Initial properties can be adjusted in the Properties Palette (Ctrl+1) after insertion.\n\n### Step 3: Select Viewport\n```\nCommand Line: Select a viewport\nAction: Click inside a viewport on the layout that displays the elements you wish to tag.\n```\n\n### Step 4: Place Script Reference\n```\nCommand Line: Pick a point outside of paperspace\nAction: Click a point in the layout (typically in blank space) to define the location of the script instance reference. The tags themselves will position automatically based on the entities in the viewport.\n```\n\n### Step 5: Customize Tags\nSelect the inserted script instance and open the **Properties Palette (Ctrl+1)**.\n- Set **Type** (e.g., Beam, Panel) to filter elements.\n- Set **Format** (e.g., `@(Length)`, `@(Posnum)`) to define tag content.\n- Set **Style** to define the visual appearance (e.g., Border, Leader).\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Type | dropdown | byZone | Defines the type of entity to collect (e.g., Beam, Panel, Opening, GenBeam). |\n| TSL Names | text | | Specifies a list of TSL script names to filter specific components (separated by semicolons). |\n| Format | text | | Defines the text content. Use `@(PropertyName)` for dynamic data (e.g., `@(Length:0)`). Separate multiple lines with a backslash `\\`. |\n| Zone | text | | Defines the zone to collect. If empty, it defaults to the current viewport's zone. |\n| Dimstyle | dropdown | | Sets the dimension style for text font and arrow appearance. |\n| Text Height | number | 0 | Defines the text height. **0** uses the Dimstyle default. |\n| Color | number | -2 | Defines the color. **-2** = ByEntity, **-1** = ByLayer, **0** = ByBlock. |\n| Orientation | dropdown | byEntity | Sets text rotation. Options: byEntity, Horizontal, Vertical. |\n| Style | dropdown | Text only | Sets the graphical style (e.g., Text + Leader, Border, Filled Frame). |\n| Behaviour | dropdown | Automatic | Controls numbering and dependencies. \"Automatic\" assigns missing posnums. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Add Viewport | Prompts to select an additional viewport to add tags from. (Also triggered by Double Click). |\n| Add/Remove Format | Opens a list to easily add or remove attributes (like Length or Width) to the tag format. |\n| Add/Remove TSL | Manages the list of TSL script names used for filtering. |\n| Set Leader Offset | Adjusts the offset settings for leader lines. |\n| Add No-Tag Area | Draws a rectangular area where tags are forbidden or moved away from. |\n| Remove No-Tag Area | Removes previously defined exclusion zones. |\n\n## Settings Files\n- **Filename**: None defined.\n- **Location**: N/A\n- **Purpose**: Script relies on standard hsbCAD properties and internal logic.\n\n## Tips\n- **Clash Detection**: If tags are overlapping, try reducing the **Text Height** or increase the spacing of elements in the model. The script attempts to move tags automatically, but space is limited.\n- **Formatting**: Use rounding in the format string for cleaner numbers. Example: `@(Length:0)` rounds to the nearest whole number.\n- **Multi-Line Tags**: Use a backslash `\\` in the **Format** property to stack text (e.g., `Posnum: @(Posnum)\\nLen: @(Length)`).\n- **ByZone vs Specific Type**: If **Type** is set to `byZone`, the script respects the **Zone** property. If a specific type (e.g., \"Beam\") is selected, the **Zone** property acts as a secondary filter.\n\n## FAQ\n- **Q: Why are no tags appearing in my layout?**\n  **A:** Check the **Type** property to ensure it matches the entities in your model (e.g., if you have walls, ensure Type is set to \"WallElement\" or \"Panel\"). Also verify the selected viewport actually contains visible elements.\n- **Q: How do I display dimensions like Length or Height?**\n  **A:** In the **Format** property, type the attribute name inside parentheses prefixed with `@`. For example: `@(Length)` or `@(Height:1)`.\n- **Q: Can I tag elements from multiple viewports on one sheet?**\n  **A:** Yes. Use the right-click context menu and select **Add Viewport** to append additional views to the script instance."
      },
      "tokens_used": 8724,
      "error": null
    }
  }
}