{
  "filename": "HSB_G-ColorBeamsCatalogue.mcr",
  "status": "completed",
  "total_tokens": 32214,
  "processing_time": 385.9210090637207,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 1,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "03.03.2014",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "28.03.2014",
            "author": "AS",
            "changes": "Add name"
          }
        ],
        "settingsFiles": [
          "HSB-ColorBeamsCatalogue.xml"
        ],
        "dependencies": [
          "HSB_G-ColorBeamsCatalogueProps"
        ]
      },
      "tokens_used": 5000,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses getPoint for insertion, draws Display text primitives (dpHeader/dpContent) at the insertion point, and explicitly creates sub-instances using _kModelSpace. No PaperSpace (_Viewport), ShopDrawing (sd_), or Multipage constructs are present."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (User selects a position)",
          "requiredSettings": [
            "HSB-ColorBeamsCatalogue.xml",
            "HSB_G-ColorBeamsCatalogueProps"
          ]
        }
      },
      "tokens_used": 3923,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a  position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Property Dialog",
            "trigger": "Insertion (if _kExecuteKey is empty)",
            "title": null,
            "dataSource": "HSB_G-ColorBeamsCatalogue",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "Property Dialog",
            "trigger": "Context Menu: Add an entry",
            "title": null,
            "dataSource": "HSB_G-ColorBeamsCatalogueProps (Sub-instance)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "Property Dialog",
            "trigger": "Context Menu: Edit an entry / Remove an entry (Selection)",
            "title": null,
            "dataSource": "HSB_G-ColorBeamsCatalogueProps (Sub-instance)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "Property Dialog",
            "trigger": "Context Menu: Edit an entry (Editing)",
            "title": null,
            "dataSource": "HSB_G-ColorBeamsCatalogueProps (Sub-instance)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dTxtHeight",
            "type": "PropDouble",
            "displayName": "|Text size|",
            "defaultValue": "U(50)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "|Dimension style|",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Add an entry|",
            "handler": "sAddEntry",
            "action": "Opens a dialog to input a new entry (Name, Zone, Color) and saves it to the XML catalogue.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Edit an entry|",
            "handler": "sEditEntry",
            "action": "Opens a dialog to select an existing entry, then opens another dialog to modify its Zone and Color values.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove an entry|",
            "handler": "sRemoveEntry",
            "action": "Opens a dialog to select an existing entry and removes it from the XML catalogue.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "HSB-ColorBeamsCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Stores the catalogue entries mapping Beam Codes to Zones and Colors.",
            "required": true
          }
        ]
      },
      "tokens_used": 5966,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script acts as a visual manager and catalogue for assigning production zones and colors to specific beam codes, used primarily for configuration or export purposes (e.g., for 'Abbund' machinery).",
          "category": "Utility / Configuration Management",
          "typicalUseCase": "A project manager inserts this script into the model to view or modify the mapping of Beam Codes to specific Manufacturing Zones and Colors, ensuring the data is correctly saved to the shared XML configuration file."
        },
        "parameters": [
          {
            "name": "dTxtHeight",
            "technicalDefault": "U(50)",
            "businessMeaning": "Controls the scale of the visual catalogue text and the layout of the table rows and columns.",
            "validRange": "10 - 200",
            "unit": "mm",
            "affectsOutput": "Adjusts the height of the text characters and proportionally scales the width of the columns and height of the rows in the generated table."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Defines the graphical appearance (font, line type, arrow style) of the text in the catalogue table.",
            "validRange": "Any existing Dimension Style in the drawing",
            "unit": "String",
            "affectsOutput": "Changes the font and style attributes used to render the 'COLOR BEAMS', 'BEAMCODE', 'ZONE', and 'COLOR' text."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Modification of 'dTxtHeight'",
            "effect": "The geometry of the table layout recalculates based on the new text height.",
            "cascade": [
              "dColumnWidth",
              "dRowHeight",
              "Display primitives (dpHeader, dpContent)"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Visual Display (Text Primitives)",
            "description": "A table generated in Model Space containing headers ('BEAMCODE', 'ZONE', 'COLOR') and rows of data listing the catalogue entries from the XML file.",
            "appliedTo": "Model Space (at the user selected insertion point _Pt0)"
          }
        ]
      },
      "tokens_used": 6148,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches script from catalog or command line.",
          "System checks if instance is being created (_bOnInsert).",
          "System verifies execution cycle (insertCycleCount > 1 triggers eraseInstance and return).",
          "User selects insertion point via command line (getPoint).",
          "System attempts to read XML catalogue from configured path.",
          "System checks _kExecuteKey to determine insertion mode.",
          "[Branch A - New Insert] If _kExecuteKey is empty, system opens Properties Dialog to allow initial configuration.",
          "[Branch B - Catalog Load] If _kExecuteKey is not empty, system loads property values from catalog entry.",
          "System calculates table geometry based on dTxtHeight and generates display primitives (Headers and Rows).",
          "Script completes, visualizing the catalogue in Model Space."
        ],
        "conditionalBranches": [
          {
            "condition": "User triggers Context Menu action vs. Initial Insertion",
            "path1": {
              "name": "Initial Insertion",
              "steps": [
                "Select Point",
                "Read XML Catalogue",
                "Show Properties Dialog (if no Execute Key)",
                "Draw Table"
              ]
            },
            "path2": {
              "name": "Add Entry",
              "steps": [
                "Read XML Catalogue",
                "Create temporary Sub-instance (Mode 1)",
                "Show Dialog for New Entry (Name, Zone, Color)",
                "Validate: Check if Entry Name already exists (Warning if true)",
                "Update XML Map with new values",
                "Write XML File",
                "Delete temporary Sub-instance",
                "Refresh Display"
              ]
            },
            "path3": {
              "name": "Edit Entry",
              "steps": [
                "Read XML Catalogue",
                "Create temporary Sub-instance (Mode 2 - Selection)",
                "Show Dialog to select Entry",
                "Retrieve Entry Data",
                "Delete Selection Sub-instance",
                "Create temporary Sub-instance (Mode 3 - Edit)",
                "Show Dialog with current values",
                "Get modified Zone/Color",
                "Update XML Map",
                "Write XML File",
                "Delete Edit Sub-instance",
                "Refresh Display"
              ]
            },
            "path4": {
              "name": "Remove Entry",
              "steps": [
                "Read XML Catalogue",
                "Create temporary Sub-instance (Mode 2 - Selection)",
                "Show Dialog to select Entry",
                "Delete Entry from Map",
                "Write XML File",
                "Delete temporary Sub-instance",
                "Refresh Display"
              ]
            }
          },
          {
            "condition": "Zone Index Calculation Logic",
            "path1": {
              "name": "Standard Zone (<= 5)",
              "steps": [
                "Zone Index = User Input Value"
              ]
            },
            "path2": {
              "name": "Inverted Zone (> 5)",
              "steps": [
                "Zone Index = 5 - User Input Value"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Duplicate Entry Name",
            "errorMessage": "The catalogue already contains an entry with this key. Use the edit option to adjust this entry.",
            "recovery": "User must cancel the Add action and use the 'Edit an entry' context menu option instead."
          },
          {
            "check": "XML File Availability",
            "errorMessage": "None (Script assumes read/write success, though _Map.readFromXmlFile returns a status boolean which is currently assigned but not checked for failure logic in the provided snippet).",
            "recovery": "Ensure HSB-ColorBeamsCatalogue.xml exists in the configured folder (_kPathHsbCompany\\Abbund)."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Visual Layout",
            "how": "OPM (Object Properties Manager)",
            "effect": "Changing 'dTxtHeight' redraws the table with new row/column dimensions. Changing 'sDimStyle' updates the text appearance."
          },
          {
            "action": "Manage Catalogue Data",
            "how": "Right-click Context Menu (Add, Edit, Remove)",
            "effect": "Updates the external XML file (HSB-ColorBeamsCatalogue.xml) and immediately refreshes the visual table in Model Space to reflect changes."
          }
        ]
      },
      "tokens_used": 5692,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_G-ColorBeamsCatalogue\n\n## Overview\nThis script acts as a visual manager for a catalogue that maps beam codes to production zones and colors. It is typically used to configure data for manufacturing exports (e.g., for Abbund machinery) and displays the current catalogue as a table in the model.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script inserts a visual table at a selected point. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities:** None (Stand-alone script).\n- **Minimum Beam Count:** 0.\n- **Required Settings:**\n    - `HSB-ColorBeamsCatalogue.xml` (The data file storing the beam mappings).\n    - `HSB_G-ColorBeamsCatalogueProps` (Internal property handler).\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the command line.\n2. Browse and select `HSB_G-ColorBeamsCatalogue.mcr`.\n\n### Step 2: Select Insertion Point\n```\nCommand Line: Select a position\nAction: Click anywhere in the Model Space to place the catalogue table.\n```\n*Note: Upon insertion, the Properties Palette will open, allowing you to adjust text size or dimension style before finalizing.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Text size | Number | 50 (mm) | Controls the height of the text in the table. Increasing this value scales up the entire table layout. |\n| Dimension style | Dropdown | _DimStyles | Selects the graphical style (font, arrows, etc.) used for the text in the table headers and content. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Add an entry | Opens a dialog to input a new Beam Code, Zone, and Color. This adds a new row to the catalogue. |\n| Edit an entry | Prompts you to select an existing entry from a list, then allows you to modify its Zone and Color values. |\n| Remove an entry | Prompts you to select an existing entry from a list and permanently deletes it from the catalogue. |\n\n## Settings Files\n- **Filename**: `HSB-ColorBeamsCatalogue.xml`\n- **Location**: `_kPathHsbCompany\\Abbund` (Typically located in your company's hsbCAD installation folder).\n- **Purpose**: This XML file acts as the database. It stores the link between Beam Codes, Zones, and Colors. Changes made via the Right-Click menu are written directly to this file.\n\n## Tips\n- **Dynamic Resizing:** You can change the `Text size` property in the Properties Palette at any time. The table geometry will automatically recalculate and redraw to fit the new text size.\n- **Immediate Updates:** Any changes you make (Add/Edit/Remove) via the right-click menu are instantly saved to the XML file and the visual table is updated immediately.\n- **Duplicate Names:** The script prevents you from adding a Beam Code that already exists. If you need to change an existing code, use the \"Edit an entry\" option instead.\n\n## FAQ\n- **Q: I tried to add a new entry, but it told me the key already exists. What do I do?**\n  **A:** This means the Beam Code you are trying to add is already in the catalogue. Cancel the current action and use the \"Edit an entry\" option to modify the existing entry.\n- **Q: Where is my data saved?**\n  **A:** Data is saved in the `HSB-ColorBeamsCatalogue.xml` file located in your company's Abbund folder. This ensures the catalogue is consistent across your project team.\n- **Q: Can I change the font of the table?**\n  **A:** Yes. Select the script instance, open the Properties Palette, and change the `Dimension style` to a style that uses your preferred font."
      },
      "tokens_used": 5485,
      "error": null
    }
  }
}