{
  "filename": "HSB_G-ColorBeamsCatalogue.mcr",
  "status": "partial",
  "total_tokens": 29200,
  "processing_time": 980.2120234966278,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "03.03.2014",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "28.03.2014",
            "author": "AS",
            "changes": "Add name"
          }
        ],
        "settingsFiles": [
          "HSB-ColorBeamsCatalogue.xml"
        ],
        "dependencies": [
          "HSB_G-ColorBeamsCatalogueProps.mcr"
        ]
      },
      "tokens_used": 5432,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses getPoint() for placement and Display objects to draw text at a user-defined location (_Pt0) relative to World Coordinates (_XW, _YW, _ZW). No ShopDrawing (sd_) or PaperSpace (_Viewport) specific logic is present. dbCreate calls use _kModelSpace."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (User selects an insertion point)",
          "requiredSettings": [
            "HSB-ColorBeamsCatalogue.xml",
            "HSB_G-ColorBeamsCatalogueProps.mcr"
          ]
        }
      },
      "tokens_used": 3826,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "|Select a  position|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Dialog",
            "trigger": "During Insertion (_bOnInsert) if no execute key is present",
            "title": null,
            "dataSource": "Internal OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "External Script Dialog",
            "trigger": "Context Menu: 'Add an entry'",
            "title": "HSB_G-ColorBeamsCatalogueProps",
            "dataSource": "TslInst of 'HSB_G-ColorBeamsCatalogueProps' (Mode 1)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "External Script Dialog",
            "trigger": "Context Menu: 'Edit an entry' or 'Remove an entry'",
            "title": "HSB_G-ColorBeamsCatalogueProps",
            "dataSource": "TslInst of 'HSB_G-ColorBeamsCatalogueProps' (Mode 2)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          },
          {
            "type": "External Script Dialog",
            "trigger": "Edit Mode Logic",
            "title": "HSB_G-ColorBeamsCatalogueProps",
            "dataSource": "TslInst of 'HSB_G-ColorBeamsCatalogueProps' (Mode 3)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dTxtHeight",
            "type": "PropDouble",
            "displayName": "|Text size|",
            "defaultValue": "U(50)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "|Dimension style|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "_DimStyles",
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [
          {
            "menuItem": "|Add an entry|",
            "handler": "sAddEntry",
            "action": "Opens a dialog to add a new beam color entry to the catalogue XML.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Edit an entry|",
            "handler": "sEditEntry",
            "action": "Opens a dialog to select and edit an existing beam color entry.",
            "alsoTriggeredBy": null
          },
          {
            "menuItem": "|Remove an entry|",
            "handler": "sRemoveEntry",
            "action": "Opens a dialog to select and remove an existing beam color entry.",
            "alsoTriggeredBy": null
          }
        ],
        "settingsFiles": [
          {
            "filename": "HSB-ColorBeamsCatalogue.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Stores the catalogue of beam codes, zones, and color indices.",
            "required": true
          }
        ]
      },
      "tokens_used": 6780,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates a visual legend or table in the drawing that lists beam codes, their assigned zones, and color indices based on an external XML catalog.",
          "category": "Documentation/Reference",
          "typicalUseCase": "Used during the design or detailing phase to visualize or document the color-coding strategy used for beam identification, sorting, or production grouping."
        },
        "parameters": [
          {
            "name": "dTxtHeight",
            "technicalDefault": "U(50)",
            "businessMeaning": "Defines the scale and readability of the entire catalog table. It sets the height of the characters and is used to calculate the grid layout (row height and column width).",
            "validRange": "10mm to 200mm (depending on drawing scale and required visibility)",
            "unit": "mm",
            "affectsOutput": "Increasing this value enlarges the text and expands the table size proportionally; decreasing it makes the table more compact."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Selects the visual presentation style (font, text type) for the catalog, ensuring it matches the project's drafting standards.",
            "validRange": "Any Dimension Style defined in the current drawing",
            "unit": "String (Name of Style)",
            "affectsOutput": "Changes the font face and text attributes (e.g., from standard Arial to an architectural font) without changing the table geometry."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in dTxtHeight",
            "effect": "Recalculates the internal layout dimensions for the table grid.",
            "cascade": [
              "dRowHeight (Internal)",
              "dColumnWidth (Internal)"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Text/Annotation (Display Object)",
            "description": "A table drawn in Model Space displaying columns for Beam Code, Zone, and Color. The header is drawn in color index 7 (White/Black) and content in color index 1 (Red).",
            "appliedTo": "Model Space at the user-selected insertion point."
          }
        ]
      },
      "tokens_used": 5701,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution initiated.",
          "2. System checks insertion cycle count.",
          "3. User prompted for insertion point (Select a position).",
          "4. System reads XML catalogue data (HSB-ColorBeamsCatalogue.xml) into internal Map.",
          "5. [Conditional] System checks for Execute Key.",
          "6. System initializes Display objects (Header and Content styles).",
          "7. System calculates layout dimensions based on text height (Row Height = 2 * Height, Column Width = 10 * Height).",
          "8. System draws table headers (COLOR BEAMS, BEAMCODE, ZONE, COLOR).",
          "9. System iterates through Map entries to draw rows for each beam code.",
          "10. Script enters idle state."
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Cycle Check",
            "path1": {
              "name": "Cycle > 1",
              "steps": [
                "Script executes 'eraseInstance'",
                "Terminates execution immediately"
              ]
            },
            "path2": {
              "name": "Cycle = 1",
              "steps": [
                "Proceeds to prompt user for point"
              ]
            }
          },
          {
            "condition": "Execute Key on Insert",
            "path1": {
              "name": "Execute Key is Present",
              "steps": [
                "Properties are set from catalog",
                "Properties Dialog is skipped"
              ]
            },
            "path2": {
              "name": "Execute Key is Empty",
              "steps": [
                "System calls 'showDialog()'",
                "User configures properties before drawing"
              ]
            }
          },
          {
            "condition": "Add Entry - Duplicate Key",
            "path1": {
              "name": "Key Already Exists",
              "steps": [
                "Report Warning: 'The catalogue already contains an entry with this key.'",
                "Entry is NOT saved",
                "User must edit existing entry or use new name"
              ]
            },
            "path2": {
              "name": "Key is Unique",
              "steps": [
                "Entry is added to Map",
                "XML file is updated",
                "Drawing refreshes"
              ]
            }
          },
          {
            "condition": "Context Menu Selection",
            "path1": {
              "name": "Remove Entry",
              "steps": [
                "Open selection dialog (Mode 2)",
                "Select entry",
                "Remove entry from Map",
                "Write XML"
              ]
            },
            "path2": {
              "name": "Edit Entry",
              "steps": [
                "Open selection dialog (Mode 2)",
                "Select entry",
                "Open edit dialog (Mode 3) with pre-filled values",
                "Update values",
                "Save to Map",
                "Write XML"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Duplicate Catalogue Entry",
            "errorMessage": "|The calalogue already contains an entry with this key. Use the edit option to adjust this entry.|",
            "recovery": "User must use the 'Edit an entry' context menu option to modify the existing record, or choose a different name."
          },
          {
            "check": "Zone Index Calculation",
            "errorMessage": "None (Silent Logic Correction)",
            "recovery": "If user enters a Zone Index (nZn) > 5, the script automatically recalculates it as `nZn = 5 - nZn`."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Table Scale",
            "how": "OPM Property (dTxtHeight)",
            "effect": "Updates text size, recalculates row height and column width, and redraws the table."
          },
          {
            "action": "Change Visual Style",
            "how": "OPM Property (sDimStyle)",
            "effect": "Updates the font and dimension style attributes of the text."
          },
          {
            "action": "Manage Catalogue Data",
            "how": "Right-click Context Menu ('Add an entry', 'Edit an entry', 'Remove an entry')",
            "effect": "Launches external dialogs to modify the underlying XML data, which immediately updates the table display upon completion."
          },
          {
            "action": "Relocate Table",
            "how": "Grip Edit (Move)",
            "effect": "Moves the entire table origin (_Pt0) to a new location in Model Space."
          }
        ]
      },
      "tokens_used": 7461,
      "error": null
    },
    "6": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "Request timeout after retries"
    }
  }
}