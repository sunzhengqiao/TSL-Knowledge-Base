{
  "filename": "HSB_F-Lifting.mcr",
  "status": "completed",
  "total_tokens": 60636,
  "processing_time": 849.9728493690491,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "E",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 1,
          "minorVersion": 10,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "This tsl adds a grid of lifting positions to a floor element. The grid can be adjusted with grip points.",
        "versionHistory": [
          {
            "version": "1.00",
            "date": "21.04.2015",
            "author": "AS",
            "changes": "Pilot version"
          },
          {
            "version": "1.01",
            "date": "22.04.2015",
            "author": "AS",
            "changes": "Add elemDrill as tool"
          },
          {
            "version": "1.02",
            "date": "05.11.2015",
            "author": "AS",
            "changes": "Add drill to other beams at the same location as the column beam. Column beam might be split."
          },
          {
            "version": "1.03",
            "date": "06.11.2015",
            "author": "AS",
            "changes": "Support 4 rows"
          },
          {
            "version": "1.04",
            "date": "24.11.2015",
            "author": "AS",
            "changes": "Add property for minimum distance to the element edges, avoid vertical beams, drill toching rafters too."
          },
          {
            "version": "1.05",
            "date": "04.02.2016",
            "author": "AS",
            "changes": "Hide origin point"
          },
          {
            "version": "1.06",
            "date": "10.03.2016",
            "author": "AS",
            "changes": "Only add touching beams if they are intersecting with the actual tool position."
          },
          {
            "version": "1.07",
            "date": "10.03.2016",
            "author": "AS",
            "changes": "Change warning into notification."
          },
          {
            "version": "1.08",
            "date": "04.01.2019",
            "author": "RVW",
            "changes": "Change vyEl / vxEl depending on the user liftingside choice."
          },
          {
            "version": "1.09",
            "date": "07.02.2019",
            "author": "RVW",
            "changes": "Add option to filter beams from the lifting drill."
          },
          {
            "version": "1.10",
            "date": "15.02.2019",
            "author": "RVW",
            "changes": "Add check that the tsl cant be executed twice with the same identifier in one element."
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "HSB_G-FilterGenBeams"
        ]
      },
      "tokens_used": 6772,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Explicit usage of _kModelSpace in dbCreate(). Script targets Element objects in model space, accessing el.beam(), el.sheet(), and adding Drill/ElemDrill tools directly to the construction elements."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HSB_G-FilterGenBeams"
          ]
        }
      },
      "tokens_used": 7835,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "Element Selection",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Dialog",
            "trigger": "On Insert (if no catalog key is used)",
            "title": "Properties",
            "dataSource": "OPM Properties (PropDouble, PropInt, PropString)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 4,
            "variable": "tslIdentifier",
            "type": "PropString",
            "displayName": "Pos 1",
            "defaultValue": " ",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Only one tsl instance, per identifier, can be attached to an element."
          },
          {
            "index": 2,
            "variable": "liftingSide",
            "type": "PropString",
            "displayName": "Lifting side",
            "defaultValue": "Allign with joist",
            "inputType": "dropdown",
            "options": [
              "Allign with joist",
              "Perpendiculair with joist"
            ],
            "category": "Lifting grid",
            "description": null
          },
          {
            "index": 0,
            "variable": "nNrOfRows",
            "type": "PropInt",
            "displayName": "Number of lifting rows",
            "defaultValue": "2",
            "inputType": "dropdown",
            "options": [
              "2",
              "3",
              "4"
            ],
            "category": "Lifting grid",
            "description": null
          },
          {
            "index": 1,
            "variable": "nNrOfColumns",
            "type": "PropInt",
            "displayName": "Number of lifting columns",
            "defaultValue": "2",
            "inputType": "number",
            "options": [],
            "category": "Lifting grid",
            "description": null
          },
          {
            "index": 8,
            "variable": "minimumDistanceFromElementEdge",
            "type": "PropDouble",
            "displayName": "Minimum distance from the edge of the element",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "Lifting grid",
            "description": null
          },
          {
            "index": 3,
            "variable": "fFilterBeamCodes",
            "type": "PropString",
            "displayName": "Filter beamcodes",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Drill in beam",
            "description": null
          },
          {
            "index": 4,
            "variable": "dDrillDiameterBeam",
            "type": "PropDouble",
            "displayName": "Drill diameter beam",
            "defaultValue": "30",
            "inputType": "number",
            "options": [],
            "category": "Drill in beam",
            "description": null
          },
          {
            "index": 5,
            "variable": "nZoneIndexToDrill",
            "type": "PropInt",
            "displayName": "Drill sheeting in zone",
            "defaultValue": "1",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10"
            ],
            "category": "Drill in sheeting",
            "description": null
          },
          {
            "index": 6,
            "variable": "dOffsetSheetDrill",
            "type": "PropDouble",
            "displayName": "Offset drill sheeting",
            "defaultValue": "30",
            "inputType": "number",
            "options": [],
            "category": "Drill in sheeting",
            "description": null
          },
          {
            "index": 5,
            "variable": "dDrillDiameterSheet",
            "type": "PropDouble",
            "displayName": "Drill diameter sheeting",
            "defaultValue": "30",
            "inputType": "number",
            "options": [],
            "category": "Drill in sheeting",
            "description": null
          },
          {
            "index": 7,
            "variable": "dExtraDepthDrillSheet",
            "type": "PropDouble",
            "displayName": "Extra depth drill sheeting",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": "Drill in sheeting",
            "description": null
          },
          {
            "index": 4,
            "variable": "nToolIndexDrillSheet",
            "type": "PropInt",
            "displayName": "Tool index drill sheeting",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": "Drill in sheeting",
            "description": null
          },
          {
            "index": 2,
            "variable": "nZoneIndex",
            "type": "PropInt",
            "displayName": "Assign to zone",
            "defaultValue": "0",
            "inputType": "dropdown",
            "options": [
              "0",
              "1",
              "2",
              "3",
              "4",
              "5",
              "6",
              "7",
              "8",
              "9",
              "10"
            ],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 0,
            "variable": "dWSymbol",
            "type": "PropDouble",
            "displayName": "Symbol width",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 1,
            "variable": "dHSymbol",
            "type": "PropDouble",
            "displayName": "Symbol height",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 3,
            "variable": "nColorSymbol",
            "type": "PropInt",
            "displayName": "Symbol color",
            "defaultValue": "2",
            "inputType": "number",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 0,
            "variable": "sHatchPattern",
            "type": "PropString",
            "displayName": "Hatch pattern",
            "defaultValue": "<First Hatch Pattern>",
            "inputType": "dropdown",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 2,
            "variable": "dHatchScale",
            "type": "PropDouble",
            "displayName": "Hatch scale",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 1,
            "variable": "sDescription",
            "type": "PropString",
            "displayName": "Description",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          },
          {
            "index": 3,
            "variable": "dTextSize",
            "type": "PropDouble",
            "displayName": "Text size",
            "defaultValue": "100",
            "inputType": "number",
            "options": [],
            "category": "Lifting symbol",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 10388,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates a grid of lifting points on timber floor/roof elements, including drilling holes in beams and sheeting and adding visual handling symbols.",
          "category": "Hardware",
          "typicalUseCase": "When preparing timber floor cassettes or roof panels for crane lifting on construction sites, ensuring symmetrical and structurally safe pick-up points."
        },
        "parameters": [
          {
            "name": "tslIdentifier",
            "technicalDefault": " ",
            "businessMeaning": "A unique ID to prevent multiple instances of this script with the same configuration from running on the same element.",
            "validRange": "Alphanumeric String",
            "unit": "text",
            "affectsOutput": "Script logic (prevents duplication)."
          },
          {
            "name": "liftingSide",
            "technicalDefault": "Allign with joist",
            "businessMeaning": "Defines the orientation of the lifting grid relative to the structural joists. Aligns the grid parallel or perpendicular to the joists.",
            "validRange": "Align with joist, Perpendicular with joist",
            "unit": "Option",
            "affectsOutput": "Rotates the grid coordinate system and detects rafters along the corresponding axis."
          },
          {
            "name": "nNrOfRows",
            "technicalDefault": "2",
            "businessMeaning": "The number of lifting rows running perpendicular to the main lifting columns.",
            "validRange": "2, 3, 4",
            "unit": "count",
            "affectsOutput": "Number of lifting symbols and drill sets generated along the secondary axis."
          },
          {
            "name": "nNrOfColumns",
            "technicalDefault": "2",
            "businessMeaning": "The number of lifting columns running parallel to the main joist direction.",
            "validRange": "2 (Fixed by script logic)",
            "unit": "count",
            "affectsOutput": "Defines the two main anchor points for the grid."
          },
          {
            "name": "minimumDistanceFromElementEdge",
            "technicalDefault": "100",
            "businessMeaning": "Safety margin ensuring lifting points are not placed too close to the edge of the timber element.",
            "validRange": "50 - 500",
            "unit": "mm",
            "affectsOutput": "Offsets the grid points inward from the element perimeter."
          },
          {
            "name": "fFilterBeamCodes",
            "technicalDefault": "",
            "businessMeaning": "List of beam codes to exclude from drilling (e.g., blocking or trimmers), ensuring only structural members are modified.",
            "validRange": "Comma-separated beam codes",
            "unit": "text",
            "affectsOutput": "Filters which beams receive the drill tool."
          },
          {
            "name": "dDrillDiameterBeam",
            "technicalDefault": "30",
            "businessMeaning": "Diameter of the hole drilled into the timber beams/rafters for lifting hardware.",
            "validRange": "20 - 60",
            "unit": "mm",
            "affectsOutput": "Size of the Drill entity added to beams."
          },
          {
            "name": "nZoneIndexToDrill",
            "technicalDefault": "1",
            "businessMeaning": "The specific material zone (e.g., top sheeting layer) that needs to be drilled for the lifting hook to pass through.",
            "validRange": "1 - 10",
            "unit": "index",
            "affectsOutput": "Target height and depth calculation for the sheeting drill."
          },
          {
            "name": "dOffsetSheetDrill",
            "technicalDefault": "30",
            "businessMeaning": "Offset distance from the beam center to the sheeting drill center, used to clear the structural timber.",
            "validRange": "0 - 100",
            "unit": "mm",
            "affectsOutput": "Lateral position of the hole in the sheeting."
          },
          {
            "name": "dDrillDiameterSheet",
            "technicalDefault": "30",
            "businessMeaning": "Diameter of the hole drilled through the floor/roof sheeting.",
            "validRange": "30 - 100",
            "unit": "mm",
            "affectsOutput": "Size of the Drill/ElemDrill entity added to sheets."
          },
          {
            "name": "dExtraDepthDrillSheet",
            "technicalDefault": "1",
            "businessMeaning": "Additional depth added to the sheeting drill to ensure clean penetration.",
            "validRange": "0 - 10",
            "unit": "mm",
            "affectsOutput": "Total length of the drilling operation."
          },
          {
            "name": "nToolIndexDrillSheet",
            "technicalDefault": "1",
            "businessMeaning": "The CNC machine tool number assigned to the sheeting drilling operation.",
            "validRange": "1 - 99",
            "unit": "index",
            "affectsOutput": "Production data (machine instruction)."
          },
          {
            "name": "nZoneIndex",
            "technicalDefault": "0",
            "businessMeaning": "The visual zone (layer height) where the lifting symbol is drawn.",
            "validRange": "0 - 10",
            "unit": "index",
            "affectsOutput": "Z-height of the symbol and text in the model."
          },
          {
            "name": "dWSymbol",
            "technicalDefault": "100",
            "businessMeaning": "Width of the visual lifting symbol.",
            "validRange": "50 - 500",
            "unit": "mm",
            "affectsOutput": "Geometry of the visual PLine rectangle."
          },
          {
            "name": "dHSymbol",
            "technicalDefault": "100",
            "businessMeaning": "Height of the visual lifting symbol.",
            "validRange": "50 - 500",
            "unit": "mm",
            "affectsOutput": "Geometry of the visual PLine rectangle."
          },
          {
            "name": "nColorSymbol",
            "technicalDefault": "2",
            "businessMeaning": "Color index used to draw the lifting symbol.",
            "validRange": "1 - 255",
            "unit": "color",
            "affectsOutput": "Visual color of the symbol."
          },
          {
            "name": "sHatchPattern",
            "technicalDefault": "<First Hatch Pattern>",
            "businessMeaning": "Pattern used to hatch the lifting symbol area.",
            "validRange": "Standard Hatches",
            "unit": "pattern",
            "affectsOutput": "Visual fill of the symbol."
          },
          {
            "name": "dHatchScale",
            "technicalDefault": "1",
            "businessMeaning": "Scale factor for the hatch pattern.",
            "validRange": "0.1 - 10",
            "unit": "factor",
            "affectsOutput": "Density of the hatch pattern."
          },
          {
            "name": "sDescription",
            "technicalDefault": "",
            "businessMeaning": "Custom text label displayed next to the lifting symbol.",
            "validRange": "Short String",
            "unit": "text",
            "affectsOutput": "Text entity content."
          },
          {
            "name": "dTextSize",
            "technicalDefault": "100",
            "businessMeaning": "Height of the description text.",
            "validRange": "50 - 200",
            "unit": "mm",
            "affectsOutput": "Size of the text entity."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "liftingSide",
            "effect": "Switches the Element's local X and Y vectors used to calculate the grid and locate rafters.",
            "cascade": [
              "Grid Orientation",
              "Rafter Detection Logic"
            ]
          },
          {
            "trigger": "nNrOfRows",
            "effect": "Resets the internal grip point array and recalculates the position of row lines.",
            "cascade": [
              "Grip Points",
              "Number of Drills"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Drill",
            "description": "Horizontal hole through the structural beams (rafters/joists) for lifting.",
            "appliedTo": "GenBeams (filtered by code)."
          },
          {
            "type": "ElemDrill",
            "description": "Vertical hole through the sheeting material.",
            "appliedTo": "Element (Sheeting Zone)."
          },
          {
            "type": "PLine / Hatch",
            "description": "Visual representation of the lifting position.",
            "appliedTo": "Model Space (Visual only)."
          },
          {
            "type": "Text",
            "description": "Annotation label.",
            "appliedTo": "Model Space (Visual only)."
          }
        ]
      },
      "tokens_used": 12175,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. User launches script 'HSB_F-Lifting'.",
          "2. System initializes properties (loads from catalog if _kExecuteKey exists, otherwise uses defaults).",
          "3. [Insert Phase] Check if _bOnInsert is true.",
          "4. Check insertCycleCount(); if > 1, erase instance and exit (prevent multi-duplication).",
          "5. [Conditional] Check if valid Catalog Key exists.",
          "6. If no/invalid Catalog Key, show Properties Dialog (showDialog).",
          "7. If valid Catalog Key, load properties from catalog.",
          "8. Prompt user to select a set of Elements (PrEntity selection).",
          "9. Iterate through selected Elements.",
          "10. For each Element, scan existing TSL instances.",
          "11. [Conditional] If an instance of this script exists with the same 'tslIdentifier', erase the old instance.",
          "12. Create new TSL instance attached to the Element (dbCreate) with 'MasterToSatellite' map.",
          "13. Erase the temporary Master instance and exit Insert phase.",
          "14. [Execution Phase] Satellite Instance initializes.",
          "15. Load properties from 'MasterToSatellite' map.",
          "16. Validate Element exists and is valid; if not, report Notice and exit.",
          "17. Lock 'tslIdentifier' property (setReadOnly).",
          "18. Scan for duplicate instances again (safety check) and erase if found.",
          "19. Calculate Coordinate System (swap vxEl/vyEl if 'liftingSide' is 'Perpendicular').",
          "20. Calculate Element Envelope (ptBL, ptTR) and bounding box.",
          "21. Retrieve Beams and Sheets from Element.",
          "22. Filter Beams: Apply 'HSB_G-FilterGenBeams' if 'fFilterBeamCodes' is set.",
          "23. Separate Beams into Rafters and Blocking based on orientation (Vertical vs Horizontal).",
          "24. Initialize Grip Points (_PtG) based on 'nNrOfColumns' and 'nNrOfRows'.",
          "25. Set Column Grips (default: Bottom-Left, Top-Right of bounding box).",
          "26. Snap Column Grips to the center of the closest Rafter.",
          "27. [Validation] If no closest beam found, report Notice and exit.",
          "28. Set Row Grips based on 'nNrOfRows' (2, 3, or 4 points distributed along span).",
          "29. Snap Row Grips to avoid Blocking beams (using ppBlocking profile).",
          "30. Loop through Column Grips to create lifting columns.",
          "31. Loop through Row Grips to create intersections.",
          "32. Calculate Tool Position (Intersection of Column line and Row plane).",
          "33. Identify Touching Rafters at this specific tool location (CapsuleIntersect).",
          "34. Calculate Drill Extremes (Start/End) covering Column Beam and Touching Rafters.",
          "35. Add Drill tool to Column Beam and Touching Rafters.",
          "36. Find other Rafters aligned with the column (<5mm distance) and add Drill to them.",
          "37. Calculate Sheet Drill positions (offset from beam extremes).",
          "38. Add Drill to Sheets and ElemDrill to Element (specific Zone).",
          "39. Draw Visuals (PLine, Hatch, Text) at the calculated position.",
          "40. End loops and finish execution."
        ],
        "conditionalBranches": [
          {
            "condition": "Insertion Trigger",
            "path1": {
              "name": "Manual Insert",
              "steps": [
                "Properties Dialog appears",
                "User confirms settings",
                "Element selection starts"
              ]
            },
            "path2": {
              "name": "Catalog/Execute Key",
              "steps": [
                "Settings loaded from catalog",
                "Dialog skipped",
                "Element selection starts immediately"
              ]
            }
          },
          {
            "condition": "Duplicate Instance Detected",
            "path1": {
              "name": "Clean Element",
              "steps": [
                "No duplicates found",
                "New instance is created"
              ]
            },
            "path2": {
              "name": "Replace Mode",
              "steps": [
                "Duplicate found with same identifier",
                "Old instance erased (dbErase)",
                "New instance created with same ID"
              ]
            }
          },
          {
            "condition": "Lifting Side Property",
            "path1": {
              "name": "Align with Joist",
              "steps": [
                "Standard Element Coordinate System",
                "vxEl = Element VecX, vyEl = Element VecY"
              ]
            },
            "path2": {
              "name": "Perpendicular with Joist",
              "steps": [
                "Swapped Coordinate System",
                "vxEl = Element VecY, vyEl = Element VecX"
              ]
            }
          },
          {
            "condition": "Number of Rows (nNrOfRows)",
            "path1": {
              "name": "2 Rows",
              "steps": [
                "Grips at 1/3 and 2/3 of the span"
              ]
            },
            "path2": {
              "name": "3 Rows",
              "steps": [
                "Grips at 1/3, Center, and 2/3 of the span"
              ]
            },
            "path3": {
              "name": "4 Rows",
              "steps": [
                "Grips at 20%, 40%, 60%, and 80% of the span"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Existence",
            "errorMessage": "No element selected!",
            "recovery": "Script exits. User must run again and select a valid element."
          },
          {
            "check": "Element Validity",
            "errorMessage": "Invalid element found!",
            "recovery": "Script exits. User must ensure a valid hsbCAD Element is selected."
          },
          {
            "check": "Rafter Availability",
            "errorMessage": "No closest beam found!",
            "recovery": "Script exits without generating geometry. User must ensure structural beams (rafters) exist in the element for the script to snap to."
          },
          {
            "check": "Filter Dependency",
            "errorMessage": "Beams could not be filtered (Notice)",
            "recovery": "Script continues assuming all beams are valid. Check if 'HSB_G-FilterGenBeams' is available in the project."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Grid Geometry",
            "how": "Drag Grip Points in Model",
            "effect": "Moving column or row grip points recalculates the layout of lifting symbols and drill locations instantly."
          },
          {
            "action": "Change Orientation",
            "how": "OPM Properties > Lifting side",
            "effect": "Swaps the grid X/Y axis logic, realigning the grid to be parallel or perpendicular to the joists. Resets grip points."
          },
          {
            "action": "Adjust Row Count",
            "how": "OPM Properties > Number of lifting rows",
            "effect": "Updates the internal logic to distribute 2, 3, or 4 rows of lifting points. Resets row grip points."
          },
          {
            "action": "Update Drill Sizes",
            "how": "OPM Properties > Drill diameter beam/sheeting",
            "effect": "Updates the diameter parameter of the generated Drill and ElemDrill tools."
          },
          {
            "action": "Filter Beams",
            "how": "OPM Properties > Filter beamcodes",
            "effect": "Excludes specific beam codes from receiving drill tools."
          }
        ]
      },
      "tokens_used": 13680,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_F-Lifting\n\n## Overview\nThis script automatically generates a grid of lifting positions on floor or roof elements. It creates drill holes in both structural beams and sheeting, and adds visual lifting symbols that can be adjusted using grip points.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script runs on Element objects in 3D. |\n| Paper Space | No | Not applicable. |\n| Shop Drawing | No | Generates CNC tools (Drills) directly on the model. |\n\n## Prerequisites\n- **Required Entities**: An Element containing beams (joists/rafters) and sheeting.\n- **Minimum Beam Count**: At least 1 structural beam (rafter) is required to snap the lifting column.\n- **Required Settings**: `HSB_G-FilterGenBeams` (optional, used if beam filtering is active).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HSB_F-Lifting.mcr`\n\n### Step 2: Configure Properties\n- If running the script manually (without a preset Catalog Key), the Properties Dialog will appear.\n- Adjust settings such as **Lifting side**, **Number of lifting rows**, and **Drill diameters**.\n- Click **OK** to confirm.\n\n### Step 3: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the floor or roof elements to add lifting points to.\n```\n- The script will verify that the element is valid.\n- It will automatically check for existing instances of this script with the same **Pos 1 (Identifier)** and remove them to prevent duplicates.\n\n### Step 4: Adjust Grid (Post-Insertion)\n- After insertion, the script calculates an initial grid based on the element bounding box.\n- **Grip Points** appear in the model representing the columns (main lifting lines) and rows.\n- **Action**: Click and drag the square grip points to reposition the lifting lines.\n  - **Column Grips**: Snap to the center of the nearest rafter/joist.\n  - **Row Grips**: Distribute along the span.\n- Moving these grips will automatically update the drill positions and symbols.\n\n## Properties Panel Parameters\n\n### General\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Pos 1 | text | (space) | Unique identifier. Only one script with this ID can exist per element. |\n\n### Lifting Grid\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Lifting side | dropdown | Allign with joist | Orientation of the grid relative to joists (Align or Perpendicular). |\n| Number of lifting rows | dropdown | 2 | Number of rows across the element span (2, 3, or 4). |\n| Number of lifting columns | number | 2 | Number of columns (fixed at 2). |\n| Minimum distance from the edge of the element | number | 100 | Safety margin from element edges (mm). |\n\n### Drill in Beam\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Filter beamcodes | text | (empty) | Beam codes to exclude from drilling (comma-separated). |\n| Drill diameter beam | number | 30 | Diameter of the hole in structural beams (mm). |\n\n### Drill in Sheeting\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Drill sheeting in zone | dropdown | 1 | Material zone index of the sheeting layer to drill. |\n| Offset drill sheeting | number | 30 | Offset from beam center to sheeting drill center (mm). |\n| Drill diameter sheeting | number | 30 | Diameter of the hole through the sheeting (mm). |\n| Extra depth drill sheeting | number | 1 | Additional depth added to the drill operation (mm). |\n| Tool index drill sheeting | number | 1 | CNC machine tool number for sheeting. |\n\n### Lifting Symbol\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Assign to zone | dropdown | 0 | Visual layer height for the symbol. |\n| Symbol width | number | 100 | Width of the visual symbol (mm). |\n| Symbol height | number | 100 | Height of the visual symbol (mm). |\n| Symbol color | number | 2 | Color index of the symbol. |\n| Hatch pattern | dropdown | <First...> | Pattern used to fill the symbol. |\n| Hatch scale | number | 1 | Scale of the hatch pattern. |\n| Description | text | (empty) | Text label displayed next to the symbol. |\n| Text size | number | 100 | Height of the description text (mm). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (Standard Script Options) | Standard options like *Recalculate* or *Erase* are available via the right-click context menu. No custom specific triggers are defined. |\n\n## Settings Files\n- **Filename**: `HSB_G-FilterGenBeams`\n- **Location**: Project/TSL folder\n- **Purpose**: Allows the script to filter specific beam codes (e.g., blocking or trimmers) so they are not drilled.\n\n## Tips\n- **Grip Editing**: Use the grips to fine-tune the position of lifting holes to avoid blocking or hardware conflicts.\n- **Orientation**: Use the **Lifting side** property to switch the grid axis if the default orientation does not match your joist direction.\n- **Filtering**: Use **Filter beamcodes** to prevent the script from drilling into short trimmer or blocking beams that are not meant to carry lifting loads.\n- **Duplication**: The script automatically removes old instances if you insert it again on the same element with the same **Pos 1** identifier.\n\n## FAQ\n- **Q: The script exits saying \"No closest beam found!\"**\n  - A: Ensure the element has structural beams (rafters/joists) running in the direction defined by the **Lifting side** property. The script needs beams to snap to.\n- **Q: My lifting points are too close to the edge.**\n  - A: Increase the **Minimum distance from the edge of the element** value in the properties.\n- **Q: It drilled through a blocking beam I wanted to keep solid.**\n  - A: Enter the beam code of that blocking piece into the **Filter beamcodes** property and recalculate the script."
      },
      "tokens_used": 9786,
      "error": null
    }
  }
}