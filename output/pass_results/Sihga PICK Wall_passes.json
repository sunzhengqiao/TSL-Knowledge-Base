{
  "filename": "Sihga PICK Wall.mcr",
  "status": "completed",
  "total_tokens": 40679,
  "processing_time": 1308.0733189582825,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "this TSL creates SIHGA PICK lifting devices in Stickframe Walls, referring to it's center of gravity.",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "07nov17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": " situation 4 points with hanger chains added"
          },
          {
            "version": "1.3",
            "date": "28sep17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": " lifting angle calculation at 4 points without traverse fixed"
          },
          {
            "version": "1.2",
            "date": "08sep17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": " situation 4 points without traverse added, Belt lengths now displayed"
          },
          {
            "version": "1.1",
            "date": "30aug17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": " bugfix distribution when wall length < distribution length "
          },
          {
            "version": "1.0",
            "date": "30aug17",
            "author": "florian.wuermseer@hsbcad.com",
            "changes": " initial version "
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 9344,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses dbCreate(..., _kModelSpace, ...) within the _bOnInsert block. It validates the input element using bIsKindOf(ElementWallSF) and uses assignToElementGroup() which operates on model entities. It adds tools (Drill, ElemNoNail) directly to the wall element properties."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWallSF"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 7557,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select wall(s)",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Property Grid (showDialog)",
            "trigger": "On insert (unless catalog entry exists)",
            "title": null,
            "dataSource": "Local TSL Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sQuant",
            "type": "PropString",
            "displayName": "(A) - Quantity",
            "defaultValue": "1",
            "inputType": "dropdown",
            "options": [
              "1",
              "2",
              "4",
              "4 + Traverse",
              "4 + Hanger Chains"
            ],
            "category": "Distribution",
            "description": null
          },
          {
            "index": 1,
            "variable": "dBeltLength",
            "type": "PropDouble",
            "displayName": "(B) - Lifting Belt Length",
            "defaultValue": 2000,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": null
          },
          {
            "index": 2,
            "variable": "dInterdistance",
            "type": "PropDouble",
            "displayName": "(C) - Interdistance of Lifting Points",
            "defaultValue": 1000,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": null
          },
          {
            "index": 3,
            "variable": "dChainTravLength",
            "type": "PropDouble",
            "displayName": "(D) - Chain / Traverse Length",
            "defaultValue": 2000,
            "inputType": "number",
            "options": [],
            "category": "Distribution",
            "description": null
          },
          {
            "index": 4,
            "variable": "sWeinmannTools",
            "type": "PropString",
            "displayName": "(E) - Apply Weinmann Tools",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Tooling",
            "description": null
          },
          {
            "index": 5,
            "variable": "sWeight",
            "type": "PropString",
            "displayName": "Element weight",
            "defaultValue": "0",
            "inputType": "text",
            "options": [],
            "category": "Information",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 8036,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automates the insertion, positioning, and validation of SIHGA PICK lifting hardware into Stickframe walls based on the element's center of gravity and weight.",
          "category": "Hardware / Manufacturing",
          "typicalUseCase": "Used during the design of wall panels to determine the optimal number and placement of lifting points, ensuring they comply with the SIHGA PICK system's load and angle capacities."
        },
        "parameters": [
          {
            "name": "sQuant",
            "technicalDefault": "1",
            "businessMeaning": "The lifting configuration strategy. Defines how many lifting points are used and the rigging setup (direct lift, with a traverse/spreader bar, or with hanger chains).",
            "validRange": "1, 2, 4, 4 + Traverse, 4 + Hanger Chains",
            "unit": "Count/Configuration",
            "affectsOutput": "Determines the number of holes drilled, the geometric calculation of belt angles, and which load capacity tables are used for validation."
          },
          {
            "name": "dBeltLength",
            "technicalDefault": "2000",
            "businessMeaning": "The physical length of the lifting belts (slings) used on the construction site.",
            "validRange": "1000 - 6000 mm",
            "unit": "mm",
            "affectsOutput": "Calculates the maximum allowable distance between lifting points to ensure the lifting angle does not exceed safety limits (min 45°). Visually represents the belt length in 3D."
          },
          {
            "name": "dInterdistance",
            "technicalDefault": "1000",
            "businessMeaning": "The target spacing between the lifting points on the wall element.",
            "validRange": "Dependent on wall width and belt length (auto-corrected if too wide for the belt).",
            "unit": "mm",
            "affectsOutput": "Positions the drill holes for the lifting hardware. If this distance is too wide for the defined 'Belt Length', the script automatically reduces it to maintain a safe lifting angle."
          },
          {
            "name": "dChainTravLength",
            "technicalDefault": "2000",
            "businessMeaning": "The vertical length of additional rigging components—the height of the traverse (spreader bar) or the length of hanger chains—used in 4-point lifts.",
            "validRange": "1000 - 5000 mm",
            "unit": "mm",
            "affectsOutput": "Adjusts the virtual position of the crane hook in the calculation, altering the belt angles and load distribution for 4-point configurations."
          },
          {
            "name": "sWeinmannTools",
            "technicalDefault": "No",
            "businessMeaning": "Toggle to generate CNC machining data (specifically 'No Nail' zones) for Weinmann manufacturing machines.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "If 'Yes', adds rectangular 'No Nail' zones around the lifting points to the wall element's CNC data, preventing the machine from shooting nails through the lifting hardware."
          },
          {
            "name": "sWeight",
            "technicalDefault": "0",
            "businessMeaning": "The total weight of the wall element used for safety validation against the SIHGA PICK load tables.",
            "validRange": "0 - 10000 kg (System dependent)",
            "unit": "kg",
            "affectsOutput": "Does not change geometry, but triggers visual error warnings in the drawing if the weight exceeds the capacity of the current lifting angle/point configuration."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in 'Belt Length' (dBeltLength)",
            "effect": "Recalculates the maximum allowable 'Interdistance of Lifting Points'.",
            "cascade": [
              "dInterdistance"
            ]
          },
          {
            "trigger": "Change in 'Quantity' (sQuant) to 4-point variants",
            "effect": "Activates the 'Chain / Traverse Length' logic.",
            "cascade": [
              "dChainTravLength"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Drill",
            "description": "50mm diameter holes for the SIHGA PICK inserts, drilled through the top plate (or bottom plate depending on rigging).",
            "appliedTo": "Wall Top Plates"
          },
          {
            "type": "ElemNoNail",
            "description": "Exclusion zones preventing nailing within the lifting hardware area (Only if 'Apply Weinmann Tools' is Yes).",
            "appliedTo": "Wall Element (Zones)"
          },
          {
            "type": "Body/ModelRepresentation",
            "description": "3D geometric representation of the SIHGA PICK metal plate, lifting belts, traverse bars, and chains.",
            "appliedTo": "Visual Model / Layout"
          },
          {
            "type": "Text/Annotation",
            "description": "Dimensions of belts/chains and Safety Warnings (if weight is too high or angles too shallow).",
            "appliedTo": "Model and Paper Space"
          }
        ]
      },
      "tokens_used": 10438,
      "error": null
    },
    "5": {
      "success": false,
      "data": {},
      "tokens_used": 0,
      "error": "API error 429: {\"error\":{\"code\":\"1302\",\"message\":\"您的账户已达到速率限制，请您控制请求频率\"}}"
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# Sihga PICK Wall.mcr\n\n## Overview\nThis script automates the insertion and configuration of SIHGA PICK lifting hardware into Stickframe walls. It calculates placement based on the element's center of gravity, validates lifting angles against safety limits, and generates necessary CNC data for manufacturing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for inserting the script and selecting wall elements. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: Stickframe Wall (`ElementWallSF`).\n- **Minimum beam count**: N/A (Script operates on wall elements).\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `Sihga PICK Wall.mcr`\n\n### Step 2: Select Wall\n```\nCommand Line: Select wall(s)\nAction: Click on the Stickframe wall element in the drawing you wish to add lifting hardware to.\n```\n*Note: After selecting the wall, the Properties Panel will automatically open to allow you to configure the lifting settings.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| (A) - Quantity | dropdown | 1 | Select the lifting configuration: 1 point, 2 points, 4 points, 4 points with a traverse, or 4 points with hanger chains. |\n| (B) - Lifting Belt Length | number | 2000 | Enter the length of the lifting belts (slings) in mm. This determines the maximum allowable distance between points to maintain a safe angle. |\n| (C) - Interdistance of Lifting Points | number | 1000 | Enter the desired spacing between lifting points in mm. The script may automatically reduce this value if the belt length is too short to maintain a 45° lifting angle. |\n| (D) - Chain / Traverse Length | number | 2000 | Enter the vertical length of the traverse (spreader bar) or hanger chains in mm. Used for calculating angles in 4-point lifts. |\n| (E) - Apply Weinmann Tools | dropdown | No | Select \"Yes\" to generate \"No Nail\" zones around the lifting points for Weinmann CNC machines. |\n| Element weight | text | 0 | Enter the total weight of the wall element in kg. This is used to validate if the current configuration can safely lift the wall. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None available | |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Automatic Distance Adjustment**: If you set the Interdistance too wide for the specified Belt Length, the script will automatically reduce the distance to ensure the lifting angle does not fall below 45°.\n- **Safety Validation**: Always populate the \"Element weight\" field. The script will visually warn you if the wall weight exceeds the capacity of the selected SIHGA PICK configuration.\n- **CNC Preparation**: Enable \"Apply Weinmann Tools\" only if you are using a Weinmann manufacturing machine. This prevents the machine from nailing through the lifting hardware zones.\n\n## FAQ\n- **Q: Why did the script change my \"Interdistance of Lifting Points\" value?**\n  **A:** To ensure safety. The script recalculates the geometry to maintain a minimum lifting angle of 45°. If your entered distance would result in a shallower (unsafe) angle, it automatically corrects it.\n- **Q: What is the difference between \"4 + Traverse\" and \"4 + Hanger Chains\"?**\n  **A:** Both use 4 lifting points, but they calculate the crane hook position differently. \"4 + Traverse\" simulates a spreader bar, while \"4 + Hanger Chains\" simulates chains hanging from a single point, affecting how the load is distributed."
      },
      "tokens_used": 5304,
      "error": null
    }
  }
}