{
  "filename": "GE_BEAM_INFO_GET_DETAILS.mcr",
  "status": "completed",
  "total_tokens": 19982,
  "processing_time": 182.86088871955872,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.4",
            "date": "18-jul-2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Thumbnail updated"
          },
          {
            "version": "v1.3",
            "date": "19.mar.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Renamed from GE_INFO_GET_BEAM_DETAILS to GE_BEAM_INFO_GET_DETAILS"
          },
          {
            "version": "v1.2",
            "date": "21.jul.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added\nThumbnail added\nCopyright added"
          },
          {
            "version": "v1.1",
            "date": "15-Mar-2007",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          },
          {
            "version": "v1.0",
            "date": "09-Feb-2007",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": ""
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5004,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No sd_* or Multipage* prefixes found. No #Type E declarations. No _Viewport usage. Script uses getBeam() directly without specific shopdrawing context, and erases itself upon completion (eraseEntity), typical of a temporary query script running in Model Space."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing valid GenBeams",
          "requiredSettings": []
        }
      },
      "tokens_used": 2098,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "Select beam",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowNotice",
            "trigger": "After processing beam data",
            "title": null,
            "dataSource": "Beam properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2705,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script is a diagnostic tool that queries a selected structural timber beam and displays a comprehensive list of its properties (dimensions, volume, material, codes, and flags) in a notification window.",
          "category": "Inspection/Query",
          "typicalUseCase": "A user needs to verify specific data attributes of a beam in the model, such as its exact volume, position number, material grade, or internal system ID, without manually checking the properties palette."
        },
        "parameters": [
          {
            "name": "_Beam",
            "technicalDefault": "Empty array (null)",
            "businessMeaning": "The specific structural timber element (GenBeam) selected by the user for inspection.",
            "validRange": "Any valid GenBeam existing in the Model Space",
            "unit": "N/A (Entity Reference)",
            "affectsOutput": "The selected beam determines the specific values shown for volume, length, grade, profile, and all other metadata in the report dialog."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Notice Dialog (reportNotice)",
            "description": "A temporary text window displaying formatted technical details about the beam, including volume, length, grade, profile names, codes, and logical states (e.g., IsDummy, IsCutStraight).",
            "appliedTo": "Screen (UI only)"
          }
        ]
      },
      "tokens_used": 2768,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched",
          "Check if state is _bOnInsert (Initial Execution)",
          "[Insert Mode] Prompt user 'Select beam' via command line",
          "[Insert Mode] Store selected beam into _Beam array",
          "[Insert Mode] Execute Return (Script terminates to process selected input)",
          "[Calculation Mode] Check if _Beam array is empty",
          "[Calculation Mode] Set internal unit to millimeters (mm)",
          "[Calculation Mode] Validate if the beam entity (_Beam[0]) is valid (bIsValid)",
          "[Calculation Mode] Extract technical properties (volume, length, grade, profile, etc.)",
          "[Calculation Mode] Format extracted data into a structured string",
          "[Calculation Mode] Display formatted information in a reportNotice dialog",
          "Execute eraseEntity (Script removes itself from the drawing)",
          "Script terminates"
        ],
        "conditionalBranches": [
          {
            "condition": "Is this the initial insertion event? (_bOnInsert)",
            "path1": {
              "name": "Insertion Phase",
              "steps": [
                "Prompt user to select a beam",
                "Append beam to internal array",
                "Return to hsbCAD engine to trigger next phase"
              ]
            },
            "path2": {
              "name": "Execution Phase",
              "steps": [
                "Check for valid beam data",
                "Process and display beam properties",
                "Clean up and exit"
              ]
            }
          },
          {
            "condition": "Was a beam successfully selected? (_Beam.length() == 0)",
            "path1": {
              "name": "Selection Success",
              "steps": [
                "Verify beam validity",
                "Calculate dimensions and attributes",
                "Show reportNotice"
              ]
            },
            "path2": {
              "name": "Selection Failed/Cancelled",
              "steps": [
                "Display reportMessage 'No beam selected'",
                "Skip processing",
                "Erase entity and exit"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Check if internal beam array contains data (_Beam.length())",
            "errorMessage": "No beam selected",
            "recovery": "User must restart the script and ensure they click a valid beam when prompted."
          },
          {
            "check": "Check if the beam entity handle is valid (_Beam[i].bIsValid())",
            "errorMessage": "None (Implicitly fails silently if invalid, though array check covers most cases)",
            "recovery": "Ensure the selected object is a valid GenBeam entity in the model."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 3547,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_INFO_GET_DETAILS.mcr\n\n## Overview\nThis script is a diagnostic tool that allows you to select a structural timber beam and instantly view a detailed report of its properties, including dimensions, volume, material codes, and logical states, in a pop-up window.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the only environment where the script functions. |\n| Paper Space | No | The script will not work in layout views. |\n| Shop Drawing | No | Not designed for shop drawing contexts. |\n\n## Prerequisites\n- **Required Entities**: At least one valid `GenBeam` (Timber Beam) must exist in the model.\n- **Minimum Beam Count**: 1 (Must be selected by the user).\n- **Required Settings Files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse to the location of `GE_BEAM_INFO_GET_DETAILS.mcr`, select it, and click **Open**.\n\n### Step 2: Select Beam\n```\nCommand Line: Select beam\nAction: Click on the specific timber beam in the Model Space that you wish to inspect.\n```\n\n### Step 3: View Information\nAction: A \"Notice\" window will appear on screen displaying the beam's technical details.\n-   Review the data (e.g., Length, Height, Width, Volume, Material Grade, Position Number).\n-   Click **OK** or close the window to finish.\n\n## Properties Panel Parameters\nThis script does not expose parameters to the Properties Panel (OPM). It functions solely via command-line input and output dialogs.\n\n## Right-Click Menu Options\nThis script does not add custom options to the entity Right-Click menu.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Self-Cleaning**: The script entity automatically deletes itself from the drawing after displaying the information. You do not need to manually erase it.\n- **Verification**: Use this script to quickly verify volume calculations for billing or to check internal system codes (e.g., `IsDummy`, `IsCutStraight`) that are not always visible in the standard properties palette.\n- **Unit Independence**: The script handles internal units automatically, ensuring dimensions are displayed correctly regardless of your drawing's global unit settings.\n\n## FAQ\n- **Q: Why can't I find the script object in my drawing after I use it?**\n  - **A**: This is a \"query\" script designed to run once and disappear. It executes the command, shows the report, and then uses `eraseEntity` to remove itself to keep your drawing clean.\n- **Q: I get a message saying \"No beam selected\".**\n  - **A**: Ensure you have clicked directly on a valid timber beam (GenBeam) during the selection prompt. If you press Esc or click in empty space, the script will cancel."
      },
      "tokens_used": 3860,
      "error": null
    }
  }
}