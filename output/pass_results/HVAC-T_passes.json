{
  "filename": "HVAC-T.mcr",
  "status": "completed",
  "total_tokens": 51603,
  "processing_time": 387.0700249671936,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.6",
            "date": "20Nov2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix moving beyond female midpoint, display representation supported, system assignment female beams improved"
          },
          {
            "version": "1.5",
            "date": "09aug2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HVAC creation assigned to missing branch corrected, hardware output added"
          },
          {
            "version": "1.4",
            "date": "19jul2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "HVAC-System will be created for new branch"
          },
          {
            "version": "1.3",
            "date": "18jul2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "renamed"
          },
          {
            "version": "1.2",
            "date": "18jul2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "insertion with 2 or 3 beams supported, alignment validation and helper lines added"
          },
          {
            "version": "1.1",
            "date": "18jul2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "Layer assignment fixed, main solid diameter taken from female beams"
          },
          {
            "version": "1.0",
            "date": "20jun2018",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [
          "HVAC.xml"
        ],
        "dependencies": [
          "HVAC"
        ]
      },
      "tokens_used": 9325,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script performs 3D geometric operations such as Beam.dbSplit() and Body construction. It explicitly uses _kModelSpace in the tslNew.dbCreate() call. It draws using dpModel and dpPlan contexts. There is no usage of _Viewport, _kPaperSpace, or ShopDrawing specific prefixes (sd_)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "HVAC.xml"
          ]
        }
      },
      "tokens_used": 7872,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getBeam",
              "promptOriginal": "|Select male ductwork|",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "|Select female ductwork(s)|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "HVAC.xml",
            "searchPaths": [
              "<company>\\TSL\\Settings"
            ],
            "purpose": "Provides script configuration settings, specifically the Display Representation name (DispRepName).",
            "required": true
          }
        ]
      },
      "tokens_used": 7247,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates a T-connection fitting piece between intersecting HVAC ductwork beams, including cutting the ducts to length and creating the manufacturing bill of materials.",
          "category": "HVAC / Mechanical",
          "typicalUseCase": "Used when connecting a branch duct into a main supply or return duct, ensuring a geometrically fitting connector piece is inserted and the duct ends are cut correctly."
        },
        "parameters": [
          {
            "name": "Male Beam (bm0)",
            "technicalDefault": "User Selection",
            "businessMeaning": "The main duct that runs continuously through the intersection.",
            "validRange": "Any valid HVAC GenBeam",
            "unit": "Entity",
            "affectsOutput": "Defines the primary alignment (X0) and the size of the main opening in the T-connector."
          },
          {
            "name": "Female Beam(s) (bm1, bm2)",
            "technicalDefault": "User Selection",
            "businessMeaning": "The branch duct(s) connecting into the main duct. If only one is selected, the script automatically splits it to create the T-shape.",
            "validRange": "1 or 2 valid HVAC GenBeams perpendicular to male",
            "unit": "Entity",
            "affectsOutput": "Defines the branch alignment (X1) and the size of the branch opening. Determines if the script runs in 'Split' or 'Connect' mode."
          },
          {
            "name": "T-Length",
            "technicalDefault": "50 mm",
            "businessMeaning": "The length the connector fitting extends along the ducts from the intersection center point. Effectively the 'flange length' or engagement depth of the T-piece.",
            "validRange": "10 mm to 200 mm (Typically 20-100 mm)",
            "unit": "mm",
            "affectsOutput": "Controls the volume of the generated connector body and the distance from the center where the Cut operations are applied to the beams."
          },
          {
            "name": "DispRepName",
            "technicalDefault": "Empty (Script Default)",
            "businessMeaning": "The Display Representation (visual style) assigned to the generated connector body (e.g., 'Schematic', 'Detail', 'Hidden').",
            "validRange": "Any valid Display Representation name in the drawing",
            "unit": "String",
            "affectsOutput": "Determines the layer, color, and visibility properties of the generated 3D body in different CAD views."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Selecting 2 Beams (1 Male, 1 Female)",
            "effect": "Script calculates 'Split' mode (nMode=1).",
            "cascade": [
              "bm2 is generated via dbSplit of bm1",
              "Parent HVAC system instance is searched/created"
            ]
          },
          {
            "trigger": "Selecting 3 Beams (1 Male, 2 Female)",
            "effect": "Script calculates 'Connect' mode (nMode=0).",
            "cascade": [
              "Assumes females are already separate beams",
              "Connector body bridges the gap between all three"
            ]
          },
          {
            "trigger": "Beam Dimensions (Diameter/Width)",
            "effect": "Determines connector geometry.",
            "cascade": [
              "Article Number generation (e.g., T-200-150-150)",
              "Hardware Component Dimensions (DScaleX/Y/Z)"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Body (Solid)",
            "description": "A 3D solid representing the T-connector fitting (Cone for round ducts, Box for rectangular).",
            "appliedTo": "Model Space (inserted at intersection ptRef)"
          },
          {
            "type": "Cut",
            "description": "End cuts applied to the selected ducts to accommodate the length of the T-connector.",
            "appliedTo": "All selected Beams (Male and Female)"
          },
          {
            "type": "HardWrComp",
            "description": "A hardware/BOM entry for the T-connector part, auto-sized based on the duct dimensions.",
            "appliedTo": "Script Instance"
          }
        ]
      },
      "tokens_used": 10254,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Launch HVAC-T script via command or catalog.\",\n    \"2. Select 'Male' ductwork (the main continuous run).\",\n    \"3. Select 'Female' ductwork (the branch run).\",\n    \"4. Script validates selections (skips parallel beams, checks alignment).\",\n    \"5. Script determines Operation Mode based on beam count (2 beams = Split, 3 beams = Connect).\",\n    \"6. If Mode is Split: Script splits the single female beam at the intersection point to create two female beams.\",\n    \"7. Script checks for or assigns HVAC Parent System to the female beams.\",\n    \"8. Script reads T-Length configuration from beam submaps (or defaults to width/50mm).\",\n    \"9. Script calculates intersection point and connector geometry (Cone for round, Box for rect).\",\n    \"10. Script applies Cut tools to the Male and Female beams.\",\n    \"11. Script generates the 3D Connector Body.\",\n    \"12. Script creates/updates Hardware/BOM entry with article number (e.g., T-200-150-150).\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Number of beams selected during insertion\",\n      \"path1\": {\n        \"name\": \"Split Mode (2 Beams)\",\n        \"steps\": [\n          \"User selects 1 Male and 1 Female beam.\",\n          \"Script executes bm1.dbSplit() at intersection point _Pt0.\",\n          \"Resulting beam 2 (bm2) is automatically added to the script instance.\",\n          \"Connector geometry is calculated bridging Male and the split Females.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Connect Mode (3 Beams)\",\n        \"steps\": [\n          \"User selects 1 Male and 2 Female beams.\",\n          \"Script validates that both females are collinear and perpendicular to male.\",\n          \"Connector geometry is calculated bridging Male and the existing Females.\",\n          \"If alignment is invalid, error text 'Not possible' is drawn.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Duct Profile Shape (Round vs Rectangular)\",\n      \"path1\": {\n       "
      },
      "tokens_used": 11610,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HVAC-T.mcr\n\n## Overview\nAutomatically generates a T-connection fitting between intersecting HVAC ductwork beams. It cuts the ducts to the correct length and creates the 3D connector solid along with the manufacturing bill of materials entry.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required for 3D operations and beam modification. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required Entities**: HVAC GenBeams (Ducts).\n- **Minimum Beam Count**: 2 beams (Split Mode) or 3 beams (Connect Mode).\n- **Required Settings**: `HVAC.xml` (Must exist in the TSL Settings path).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `HVAC-T.mcr` from the catalog or file dialog.\n\n### Step 2: Select Main Duct\n```\nCommand Line: Select male ductwork\nAction: Click on the main duct that runs continuously through the intersection.\n```\n\n### Step 3: Select Branch Duct(s)\n```\nCommand Line: Select female ductwork(s)\nAction: Click on the branch duct(s) connecting into the main duct.\n- You can select a single beam (the script will split it).\n- You can select two beams if they are already separate.\n```\n\n## Properties Panel Parameters\nThere are no user-editable properties in the Properties Palette for this script. Configuration is determined automatically based on the dimensions of the selected beams and the HVAC settings file.\n\n## Right-Click Menu Options\nThere are no custom context menu options for this script instance.\n\n## Settings Files\n- **Filename**: `HVAC.xml`\n- **Location**: `<company>\\\\TSL\\\\Settings`\n- **Purpose**: Provides configuration settings, specifically defining the Display Representation name (visual style) used for the generated connector body.\n\n## Tips\n- **Split Mode (2 Beams):** If you select only one branch duct, the script automatically splits it into two at the intersection point to create a perfect T-shape.\n- **Connect Mode (3 Beams):** If you select two separate branch ducts, ensure they are perfectly collinear (aligned in a straight line) and perpendicular to the main duct. The script will draw \"Not possible\" if the alignment is invalid.\n- **System Assignment:** The script automatically assigns the correct HVAC system to the new or split beams if it is missing.\n- **Sizing:** The T-connector size is automatically derived from the dimensions (diameter or width/height) of the selected beams.\n\n## FAQ\n- **Q: How is the length of the T-connector determined?**\n  **A:** The script calculates the engagement length automatically. It typically defaults to 50mm or uses width-based logic found in the beam submaps.\n- **Q: Why did the script draw text saying \"Not possible\"?**\n  **A:** This usually happens in Connect Mode (3 beams) if the two female beams are not perfectly aligned or if they are not perpendicular to the male beam.\n- **Q: Can I edit the connector size after insertion?**\n  **A:** You cannot edit the connector parameters directly via the Properties Palette. To change the size, modify the dimensions of the connected duct beams and update/reload the script."
      },
      "tokens_used": 5295,
      "error": null
    }
  }
}