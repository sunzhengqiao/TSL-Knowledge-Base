{
  "filename": "hsbOpeningReinforcement.mcr",
  "status": "completed",
  "total_tokens": 46723,
  "processing_time": 309.1957802772522,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": \"\",\n    \"numBeamsReq\": 0,\n    \"keywords\": [],\n    \"majorVersion\": 1,\n    \""
      },
      "tokens_used": 8392,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly uses `_kModelSpace` in `tslNew.dbCreate` calls. It generates 3D `Beam` entities using `bmNew.dbCreate` and assigns them to element groups. There is no usage of `sd_` functions, `_Viewport`, `_kPaperSpace`, or `#Type E`, indicating it is a 3D model generation script rather than a detailing/drawing script."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Opening"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 5987,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "Select elements or/and openings",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "showDialog",
            "trigger": "On Insert (if _kExecuteKey is empty)",
            "title": "hsbOpeningReinforcement",
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dWidth",
            "type": "PropDouble",
            "displayName": "Width",
            "defaultValue": "U(44)",
            "inputType": "number",
            "options": [],
            "category": "Beam",
            "description": "Defines the Width of the reinforcing beam"
          },
          {
            "index": 1,
            "variable": "dHeight",
            "type": "PropDouble",
            "displayName": "Height",
            "defaultValue": "U(44)",
            "inputType": "number",
            "options": [],
            "category": "Beam",
            "description": "Defines the Height of the reinforcing beam"
          },
          {
            "index": 2,
            "variable": "sBeamCode",
            "type": "PropString",
            "displayName": "BeamCode",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Beam",
            "description": "Defines the BeamCode for the reinforcing beam"
          },
          {
            "index": 3,
            "variable": "sBeamInformation",
            "type": "PropString",
            "displayName": "Information",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Beam",
            "description": "Defines the Beam Information"
          },
          {
            "index": 4,
            "variable": "sBeamMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Beam",
            "description": "Defines the Beam Material"
          },
          {
            "index": 5,
            "variable": "sBeamLabel",
            "type": "PropString",
            "displayName": "Label",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "Beam",
            "description": "Defines the Beam Label"
          },
          {
            "index": 6,
            "variable": "dWidthOpeningMax",
            "type": "PropDouble",
            "displayName": "Width",
            "defaultValue": "U(2500)",
            "inputType": "number",
            "options": [],
            "category": "Opening",
            "description": "Defines the max. opening width for which no vertical beam is needed"
          },
          {
            "index": 7,
            "variable": "dHeightOpeningMax",
            "type": "PropDouble",
            "displayName": "Height",
            "defaultValue": "U(2500)",
            "inputType": "number",
            "options": [],
            "category": "Opening",
            "description": "Defines the max opening height for which no horizontal beam is needed"
          },
          {
            "index": 8,
            "variable": "dLeft",
            "type": "PropDouble",
            "displayName": "Left",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "Tolerances",
            "description": "Defines the Left tolerance"
          },
          {
            "index": 9,
            "variable": "dRight",
            "type": "PropDouble",
            "displayName": "Right",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "Tolerances",
            "description": "Defines the Right tolerance"
          },
          {
            "index": 10,
            "variable": "dTop",
            "type": "PropDouble",
            "displayName": "Top",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "Tolerances",
            "description": "Defines the Top tolerance"
          },
          {
            "index": 11,
            "variable": "dBottom",
            "type": "PropDouble",
            "displayName": "Bottom",
            "defaultValue": "U(0)",
            "inputType": "number",
            "options": [],
            "category": "Tolerances",
            "description": "Defines the Bottom tolerance"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 7269,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Creates temporary reinforcement beams inside wall openings to stabilize the structure during transportation, placing vertical studs for wide openings and horizontal beams for tall openings.",
          "category": "Framing",
          "typicalUseCase": "Used during the design of wall panels with large door or window openings where the wall structure is too weak to be safely lifted or transported without additional internal bracing."
        },
        "parameters": [
          {
            "name": "dWidth",
            "technicalDefault": "U(44)",
            "businessMeaning": "The width (thickness) of the temporary reinforcement timber/stud to be placed inside the opening.",
            "validRange": "30 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Changes the cross-sectional width of the generated reinforcement beam."
          },
          {
            "name": "dHeight",
            "technicalDefault": "U(44)",
            "businessMeaning": "The height (depth) of the temporary reinforcement timber/stud to be placed inside the opening.",
            "validRange": "30 - 150 mm",
            "unit": "mm",
            "affectsOutput": "Changes the cross-sectional height of the generated reinforcement beam."
          },
          {
            "name": "sBeamCode",
            "technicalDefault": "\"\"",
            "businessMeaning": "The structural code or designation assigned to the reinforcement beam for calculations and reporting.",
            "validRange": "Text string (e.g., 'TEMP_BRACE')",
            "unit": "string",
            "affectsOutput": "Updates the BeamCode property of the generated entity."
          },
          {
            "name": "sBeamInformation",
            "technicalDefault": "\"\"",
            "businessMeaning": "Additional descriptive text or comments regarding the specific reinforcement piece (e.g., 'Remove on site').",
            "validRange": "Text string",
            "unit": "string",
            "affectsOutput": "Updates the Information field of the generated entity."
          },
          {
            "name": "sBeamMaterial",
            "technicalDefault": "\"\"",
            "businessMeaning": "The material grade or type of wood to be used for the reinforcement beam.",
            "validRange": "Text string (e.g., 'C24')",
            "unit": "string",
            "affectsOutput": "Updates the Material property of the generated entity."
          },
          {
            "name": "sBeamLabel",
            "technicalDefault": "\"\"",
            "businessMeaning": "The label or tag used to identify the beam in labels or lists.",
            "validRange": "Text string",
            "unit": "string",
            "affectsOutput": "Updates the Label property of the generated entity."
          },
          {
            "name": "dWidthOpeningMax",
            "technicalDefault": "U(2500)",
            "businessMeaning": "The maximum opening width allowed before a vertical reinforcement beam is automatically inserted.",
            "validRange": "1000 - 5000 mm",
            "unit": "mm",
            "affectsOutput": "Controls the generation of a vertical stud: if the opening width exceeds this value, a vertical beam is created."
          },
          {
            "name": "dHeightOpeningMax",
            "technicalDefault": "U(2500)",
            "businessMeaning": "The maximum opening height allowed before a horizontal reinforcement beam is automatically inserted.",
            "validRange": "1000 - 5000 mm",
            "unit": "mm",
            "affectsOutput": "Controls the generation of a horizontal beam: if the opening height exceeds this value, a horizontal beam is created."
          },
          {
            "name": "dLeft",
            "technicalDefault": "U(0)",
            "businessMeaning": "Tolerance offset from the left edge of the opening to the start of the reinforcement beam.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Shifts the start point of the beam inward from the left boundary of the opening."
          },
          {
            "name": "dRight",
            "technicalDefault": "U(0)",
            "businessMeaning": "Tolerance offset from the right edge of the opening to the end of the reinforcement beam.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Shifts the end point of the beam inward from the right boundary of the opening."
          },
          {
            "name": "dTop",
            "technicalDefault": "U(0)",
            "businessMeaning": "Tolerance offset from the top edge of the opening to the top of the reinforcement beam.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Shifts the top of the beam downward from the top boundary of the opening."
          },
          {
            "name": "dBottom",
            "technicalDefault": "U(0)",
            "businessMeaning": "Tolerance offset from the bottom edge of the opening to the bottom of the reinforcement beam.",
            "validRange": "0 - 100 mm",
            "unit": "mm",
            "affectsOutput": "Shifts the bottom of the beam upward from the bottom boundary of the opening."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dWidthOpeningMax is decreased",
            "effect": "More vertical reinforcement beams will be generated for smaller openings.",
            "cascade": []
          },
          {
            "trigger": "dHeightOpeningMax is decreased",
            "effect": "More horizontal reinforcement beams will be generated for smaller openings.",
            "cascade": []
          },
          {
            "trigger": "Tolerance values (dLeft, dRight, dTop, dBottom) are increased",
            "effect": "The reinforcement beams will become shorter as the clear span within the opening is reduced.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Beam",
            "description": "Standard timber beams used as temporary transportation bracing. These are created vertically for wide openings and horizontally for tall openings.",
            "appliedTo": "Inside the opening void of the selected Wall Element."
          }
        ]
      },
      "tokens_used": 8401,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 11123,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbOpeningReinforcement.mcr\n\n## Overview\nThis script creates temporary reinforcement beams inside wall openings to stabilize the structure during transportation. It automatically places vertical studs for wide openings and horizontal beams for tall openings based on your defined limits.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script generates 3D beams in the model. |\n| Paper Space | No | Not applicable for detailing views. |\n| Shop Drawing | No | Does not generate 2D drawings directly. |\n\n## Prerequisites\n- **Required entities:** An existing Wall Element or Opening object in the model.\n- **Minimum beam count:** None.\n- **Required settings:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbOpeningReinforcement.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Select elements or/and openings\nAction: Click on the wall elements or specific openings in the drawing that require reinforcement. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Properties (Optional)\n```\nAction: With the script selected, open the Properties Palette (Ctrl+1) to adjust beam sizes, material, and opening limits before the calculation runs.\n```\n\n## Properties Panel Parameters\n\n### Beam Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | number | 44 | Defines the Width (thickness) of the reinforcing beam. |\n| Height | number | 44 | Defines the Height (depth) of the reinforcing beam. |\n| BeamCode | text | [empty] | Defines the BeamCode for the reinforcing beam (e.g., for scheduling). |\n| Information | text | [empty] | Defines the Beam Information (e.g., \"Remove on site\"). |\n| Material | text | [empty] | Defines the Beam Material grade. |\n| Label | text | [empty] | Defines the Label for identification in lists. |\n\n### Opening Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width | number | 2500 | Defines the max. opening width. If the opening is wider than this, a vertical beam is added. |\n| Height | number | 2500 | Defines the max. opening height. If the opening is taller than this, a horizontal beam is added. |\n\n### Tolerances\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Left | number | 0 | Defines the Left tolerance (offset from the left edge). |\n| Right | number | 0 | Defines the Right tolerance (offset from the right edge). |\n| Top | number | 0 | Defines the Top tolerance (offset from the top edge). |\n| Bottom | number | 0 | Defines the Bottom tolerance (offset from the bottom edge). |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| *None* | No specific custom context menu items are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Transport Logic:** Use this script when wall panels are too large or weak to be lifted safely. The reinforcement prevents the wall from collapsing during transport.\n- **Sizing Limits:** If you see reinforcement beams appearing in small windows where you don't want them, increase the `Width` and `Height` limits in the Opening settings.\n- **Clearance:** If you need the reinforcement to be slightly shorter than the exact opening size (e.g., to avoid clashing with plasterboard), enter small values in the Tolerances fields (Left, Right, Top, Bottom).\n- **Identification:** Always fill in the `BeamCode` or `Label` field (e.g., \"TEMP_BRACE\") so you can easily filter and delete these temporary beams before or after installation on site.\n\n## FAQ\n- **Q: Why didn't the script generate a beam for my large window?**\n  - A: Check the `Width` and `Height` settings in the Properties panel. The opening dimensions must exceed these values to trigger the creation of a reinforcement beam.\n- **Q: Are these beams permanent structural members?**\n  - A: Typically, no. They are intended for transportation stability. You should mark them (via the Label or Information property) for removal on-site.\n- **Q: Can I use different sizes for horizontal vs vertical reinforcement?**\n  - A: This script uses a single Width and Height setting for all generated beams. If different sizes are needed, you may need to run the script separately with different settings or adjust the beams manually afterwards."
      },
      "tokens_used": 5551,
      "error": null
    }
  }
}