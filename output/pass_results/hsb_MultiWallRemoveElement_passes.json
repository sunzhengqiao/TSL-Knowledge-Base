{
  "filename": "hsb_MultiWallRemoveElement.mcr",
  "status": "completed",
  "total_tokens": 13456,
  "processing_time": 113.20727324485779,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "22.08.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "First version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2581,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script utilizes PrEntity with ElementWallSF(), indicating it targets model space walls. No references to Viewport, Paper Space, or Shop Drawing types (sd_*, #Type E) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing Wall elements",
          "requiredSettings": []
        }
      },
      "tokens_used": 1184,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select one or More Elements",
              "condition": "_bOnInsert && insertCycleCount() <= 1",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1717,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A utility script to strip the 'hsb_Multiwall' sub-map (metadata) from selected wall elements, effectively removing specific configuration or associativity previously assigned by a Multi-Wall generator.",
          "category": "Data Management / Utility",
          "typicalUseCase": "Used when a user wants to disconnect a wall element from a Multi-Wall grouping or reset its specific Multi-Wall properties without deleting the geometry itself."
        },
        "parameters": [
          {
            "name": "_Element",
            "technicalDefault": "Empty Set",
            "businessMeaning": "The specific wall elements selected in the model from which the Multi-Wall association will be removed.",
            "validRange": "1 or more valid Wall Elements (ElementWallSF)",
            "unit": "Count",
            "affectsOutput": "Determines which elements have their 'hsb_Multiwall' data map deleted. No geometric changes occur; only internal data attributes are modified."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Data Modification",
            "description": "Removal of the 'hsb_Multiwall' sub-map from the Element's property map.",
            "appliedTo": "Selected Wall Elements"
          }
        ]
      },
      "tokens_used": 1749,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script launched",
          "[Conditional] Check if script is in Insertion Mode (_bOnInsert)",
          "[Conditional] Check insertCycleCount() in Insertion Mode",
          "Prompt user: Select one or more Elements (ElementWallSF)",
          "Store selected elements in internal _Element array",
          "Script returns (pauses execution)",
          "[Post-Insertion] Script executes (Recalculation)",
          "Iterate through elements stored in _Element",
          "[Conditional] Validate Element (el.bIsValid)",
          "[Conditional] Check for existence of 'hsb_Multiwall' sub-map",
          "Remove 'hsb_Multiwall' sub-map from Element",
          "Erase script instance from drawing",
          "Script exits"
        ],
        "conditionalBranches": [
          {
            "condition": "Is the script in Insertion Mode? (_bOnInsert)",
            "path1": {
              "name": "Insertion Phase",
              "steps": [
                "Check if insertCycleCount() > 1",
                "If true: Erase instance and exit (Prevent infinite loops)",
                "If false: Execute PrEntity command to select Elements",
                "Store selection in _Element",
                "Return immediately"
              ]
            },
            "path2": {
              "name": "Execution Phase",
              "steps": [
                "Loop through _Element array",
                "Process logic to remove sub-maps",
                "Erase instance",
                "Exit"
              ]
            }
          },
          {
            "condition": "Element Loop Validation",
            "path1": {
              "name": "Valid Element",
              "steps": [
                "Retrieve 'hsb_Multiwall' sub-map",
                "Check if map length is greater than 0",
                "If true: Call removeSubMapX('hsb_Multiwall')"
              ]
            },
            "path2": {
              "name": "Invalid Element",
              "steps": [
                "Continue to next iteration (Skip current element)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Insert Cycle Count",
            "errorMessage": "None (Silent)",
            "recovery": "Script automatically erases itself if insertCycleCount() > 1 to prevent recursion."
          },
          {
            "check": "Entity Selection",
            "errorMessage": "None explicit in code",
            "recovery": "User must provide valid selection. If PrEntity fails or returns empty, script returns with an empty set."
          },
          {
            "check": "Element Validity (el.bIsValid)",
            "errorMessage": "None (Silent)",
            "recovery": "Loop skips the element if it is no longer valid or deleted."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Script Self-Destruction",
            "how": "Automatic execution of eraseInstance()",
            "effect": "The TSL instance is removed from the drawing immediately after updating the Element data. No further user interaction is possible with the script instance."
          }
        ]
      },
      "tokens_used": 2741,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_MultiWallRemoveElement.mcr\n\n## Overview\nThis utility script removes the 'hsb_Multiwall' sub-map and associated metadata from selected wall elements. It effectively disconnects the selected walls from a Multi-Wall grouping configuration without deleting the actual wall geometry.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the Model Space where Wall Elements are located. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not applicable for shop drawings. |\n\n## Prerequisites\n- **Required Entities:** Wall Elements (ElementWallSF).\n- **Minimum Beam Count:** 1 (You can select multiple walls at once).\n- **Required Settings:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_MultiWallRemoveElement.mcr` from the file dialog.\n\n### Step 2: Select Elements\n```\nCommand Line: Select one or More Elements\nAction: Click on the wall elements in your model that you wish to remove the Multi-Wall data from. Press Enter to confirm selection.\n```\n\n### Step 3: Automatic Execution\nOnce the selection is confirmed, the script will automatically run, remove the specific internal data maps, and then delete itself from the drawing. No further input is required.\n\n## Properties Panel Parameters\nThere are no user-editable parameters in the Properties Palette for this script.\n\n## Right-Click Menu Options\nThere are no custom context menu options available for this script.\n\n## Settings Files\nNo external settings files (XML) are required or used by this script.\n\n## Tips\n- **Batch Processing:** You can select multiple walls in a single selection window to remove Multi-Wall associations from several elements at once.\n- **Self-Cleaning:** The script instance automatically erases itself from the drawing immediately after processing. Do not be alarmed if it disappears from the model space; this is intended behavior.\n- **Geometry Preservation:** This script only modifies internal data attributes. The physical geometry of the wall remains unchanged.\n\n## FAQ\n- **Q: Did this script delete my wall?**\n  **A:** No. The script only removes the internal \"hsb_Multiwall\" data link. The physical wall element should still be visible in the model.\n- **Q: Why did the script icon disappear after I used it?**\n  **A:** The script is designed to perform its task once and then erase itself to keep the drawing clean. It does not need to remain in the model after the data is removed.\n- **Q: How do I undo this?**\n  **A:** You can use the standard AutoCAD `UNDO` command to revert the changes if you ran the script by mistake."
      },
      "tokens_used": 3484,
      "error": null
    }
  }
}