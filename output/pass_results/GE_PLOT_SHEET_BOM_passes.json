{
  "filename": "GE_PLOT_SHEET_BOM.mcr",
  "status": "completed",
  "total_tokens": 52487,
  "processing_time": 576.9027452468872,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.4",
            "date": "01.ago.2012",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Description added\nCopyright added"
          },
          {
            "version": "Version 1.3",
            "date": null,
            "author": null,
            "changes": "Can now remove a lines on the table"
          },
          {
            "version": "Version 1.2",
            "date": null,
            "author": null,
            "changes": "Can now set Table Headers in OPM"
          },
          {
            "version": "Version 1.1",
            "date": null,
            "author": null,
            "changes": "Change frame color (ED Demtec)"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8023,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses getViewport() to select a viewport, stores selection in _Viewport array, includes comment 'dimstyle was adjusted for display in paper space', and creates a BOM table intended for plotting sheets."
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element",
            "Sheet"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Must be inserted in a Layout (Paper Space) to select a Viewport and place the table.",
          "requiredSettings": []
        }
      },
      "tokens_used": 7157,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"showDialog\",\n        \"promptOriginal\": null,\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": \"Select upper left point of rectangle\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 3,\n        \"function\": \"getViewport\",\n        \"promptOriginal\": \"Select the viewport from which the element is taken\",\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 0,\n      \"variable\": \"strDimStyle\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dim style\",\n      \"defaultValue\": null,\n      \"inputType\": \"dropdown\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"strEmpty\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Headers\",\n      \"defaultValue\": \" \",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": \"Read-only separator\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"propHeader\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Table header\",\n      \"defaultValue\": \"Sheeting List\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"propMat\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Material header\",\n      \"defaultValue\": \"Mat.\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"propQty\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Qty header\",\n      \"defaultValue\": \"Qty\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"propW\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Width header\",\n      \"defaultValue\": \"Width\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"propH\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Height header\",\n      \"defaultValue\": \"Height\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"propNum\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Number header\",\n      \"defaultValue\": \"Num.\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"propZone\",\n      \"type\": \"PropString\",\n      \"displayName\": \"  Zone header\",\n      \"defaultValue\": \"Zone\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"strJustify\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Justification\",\n      \"defaultValue\": \"Top\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Top\",\n        \"Bottom\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"nColorIndex\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Header color\",\n      \"defaultValue\": 7,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"strAllZones\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Zones to use\",\n      \"defaultValue\": \"Use zone index\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Use zone index\",\n        \"All\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 1,\n      \"variable\": \"nZone\",\n      \"type\": \"PropInt\",\n      \"displayName\": \"Zone index\",\n      \"defaultValue\": 5,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        -5,\n        -4,\n        -3,\n        -2,\n        -1,\n        1,\n        2,\n        3,\n        4,\n        5,\n        10\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"strMultiply\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Multiply output by 25.4\",\n      \"defaultValue\": \"No\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"strFilter\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter Material\",\n      \"defaultValue\": \"GYP\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": null,\n      \"description\": null\n    },\n    {\n      \"index\": 0,\n      \"variable\": \"d1\",\n      \"type\": \"PropDouble\",\n      \"displayName\": \"Width Material Col.\",\n      \"defaultValue\":"
      },
      "tokens_used": 9389,
      "error": null
    },
    "4": {
      "success": true,
      "data": {},
      "tokens_used": 10549,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script launched (Insert or Recalculation)\",\n    \"If On Insert: Check insert cycle count (erase if >1)\",\n    \"If On Insert: Open Property Dialog for initial settings\",\n    \"If On Insert: Prompt user to select upper left point of rectangle\",\n    \"If On Insert: Prompt user to select a viewport linked to an element\",\n    \"Initialize Display settings (Dimension style, Text height)\",\n    \"Retrieve Element and Coordinate System from the selected Viewport\",\n    \"Determine Zone collection strategy (Specific Zone vs All Zones)\",\n    \"Collect Sheets based on Zone and Material Filter settings\",\n    \"Iterate through collected Sheets to identify unique items\",\n    \"Aggregate quantities for identical items (Width, Height, Material, PosNum, Zone)\",\n    \"Sort the list of items by Position Number\",\n    \"Calculate table layout (Column widths based on OPM settings)\",\n    \"Draw table border, header text, and header line\",\n    \"Iterate rows to draw vertical lines (conditional), horizontal lines, and text content\",\n    \"Finish script execution\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Zone Selection Strategy ('Zones to use' OPM property)\",\n      \"path1\": {\n        \"name\": \"Use Zone Index\",\n        \"steps\": [\n          \"Checks if Zone Index is not 0\",\n          \"Retrieves sheets specifically from el.sheet(nZone)\",\n          \"Skips the loop through -5 to 5 zones\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"All Zones (or Index 0)\",\n        \"steps\": [\n          \"Loops through zone indices -5 to 5\",\n          \"Checks 'Filter Material' string\",\n          \"If filter is set, only appends sheets with matching material\",\n          \"If filter is empty, appends all sheets\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Sheet Item Comparison\",\n      \"path1\": {\n        \"name\": \"Match Found\",\n        \"steps\": [\n          \"Checks if Width, Height, PosNum, Material, and Zone match an existing row\",\n          \"Increments the 'Qty' (arCount) for that row\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"New Item\",\n        \"steps\": [\n          \"Initializes a new row with Quantity 1\",\n          \"Adds Width, Height, PosNum, Material, and Zone to the arrays\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Table Justification ('Justification' OPM property)\",\n      \"path1\": {\n        \"name\": \"Top\",\n        \"steps\": [\n          \"Sets the insertion point (_Pt0) as the Top-Left corner of the table\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Bottom\",\n        \"steps\": [\n          \"Calculates the table height\",\n          \"Offsets the insertion point downwards so _Pt0 acts as Bottom-Left\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Column Visibility (Column Width properties d2-d6)\",\n      \"path1\": {\n        \"name\": \"Width > 0\",\n        \"steps\": [\n          \"Draws the vertical separator line for the column\",\n          \"Draws the text content for that column\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Width == 0\",\n        \"steps\": [\n          \"Skips drawing the vertical line\",\n          \"Skips drawing text (effectively hiding the column)\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Viewport Element Validity\",\n      \"errorMessage\": \"(Implicit Exit) Script stops drawing if no valid element found in viewport.\",\n      \"recovery\": \"Select a viewport that contains a valid hsbCAD element with sheeting data.\"\n    },\n    {\n      \"check\": \"Viewport Array\",\n      \"errorMessage\": \"(Implicit Exit) Script stops if _Viewport array is empty.\",\n      \"recovery\": \"Ensure a viewport is selected during the insertion command.\"\n    }\n  ],\n  \"postInsertionActions\": [\n    {\n      \"action\": \"Resize or Remove Columns\",\n      \"how\": \"OPM (Properties Palette) - Adjust 'Width Material/Qty/Width/Height/Num/Zone Col.'\",\n      \"effect\": \"Changing"
      },
      "tokens_used": 10521,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_PLOT_SHEET_BOM.mcr\n\n## Overview\nThis script generates a customizable Bill of Materials (BOM) table for sheeting elements directly on a layout (Paper Space). It aggregates data from a selected viewport's element, allowing you to list materials, dimensions, quantities, and zones in a formatted table suitable for plotting.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed for layouts. |\n| Paper Space | Yes | Must be inserted in a Layout containing a Viewport. |\n| Shop Drawing | No | This creates a schedule table, not production CAM data. |\n\n## Prerequisites\n- **Required Entities:** A Layout (Paper Space) with at least one Viewport linked to an hsbCAD Element containing sheeting data.\n- **Minimum beam count:** 0.\n- **Required settings files:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_PLOT_SHEET_BOM.mcr`\n\n### Step 2: Configure Initial Settings\n```\nAction: A Property Dialog will appear automatically upon insertion.\nWhat to do: Adjust the Table Header, Column Headers, and filtering options if necessary, then click OK.\n```\n\n### Step 3: Select Insertion Point\n```\nCommand Line: Select upper left point of rectangle\nAction: Click in the Paper Space where you want the top-left corner of the table to be located.\n```\n\n### Step 4: Select Source Viewport\n```\nCommand Line: Select the viewport from which the element is taken\nAction: Click on the viewport border that displays the 3D model containing the sheeting elements you wish to list.\n```\n\n## Properties Panel Parameters\nAfter insertion, select the table to modify these parameters in the Properties Palette.\n\n### General Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Table header | text | Sheeting List | The main title displayed at the top of the table. |\n| Dim style | dropdown | *Current* | The dimension style to use for text within the table. |\n| Justification | dropdown | Top | Anchor point of the table. \"Top\" grows downward; \"Bottom\" grows upward from the picked point. |\n| Header color | number | 7 | The AutoCAD color index for the header text. |\n| Multiply output by 25.4 | dropdown | No | If \"Yes\", multiplies dimensions by 25.4 (e.g., converting mm to inches). |\n\n### Column Headers\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Material header | text | Mat. | Label for the material column. |\n| Qty header | text | Qty | Label for the quantity column. |\n| Width header | text | Width | Label for the width column. |\n| Height header | text | Height | Label for the height column. |\n| Number header | text | Num. | Label for the position number column. |\n| Zone header | text | Zone | Label for the zone column. |\n\n### Column Visibility & Layout\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Width Material Col. | number | *Value* | Width of the Material column. Set to **0** to hide this column. |\n| Width Qty Col. | number | *Value* | Width of the Quantity column. Set to **0** to hide this column. |\n| Width Width Col. | number | *Value* | Width of the Width dimension column. Set to **0** to hide this column. |\n| Width Height Col. | number | *Value* | Width of the Height dimension column. Set to **0** to hide this column. |\n| Width Num Col. | number | *Value* | Width of the Number column. Set to **0** to hide this column. |\n| Width Zone Col. | number | *Value* | Width of the Zone column. Set to **0** to hide this column. |\n\n### Filtering Options\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Zones to use | dropdown | Use zone index | Determines how zones are filtered. Options: \"Use zone index\" or \"All\". |\n| Zone index | dropdown | 5 | The specific zone number to analyze if \"Use zone index\" is selected. |\n| Filter Material | text | GYP | Filters the list to only include sheets containing this text (e.g., \"GYP\" for Gypsum). Leave empty to include all. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| Recalculate | Updates the table data if the source element has changed or if properties were modified via the command line. |\n\n## Settings Files\nNo external settings files are used.\n\n## Tips\n- **Hide Columns:** To remove specific information from the table (like the Zone), simply set that column's width property to `0`.\n- **Specific Materials:** Use the **Filter Material** property to create a schedule for only floor sheathing or only wall sheathing by typing the material name used in your catalogs.\n- **Unit Conversion:** If working in imperial but the model is metric, set \"Multiply output by 25.4\" to **Yes** to convert displayed dimensions.\n\n## FAQ\n- Q: Why is my table empty?\n  A: Ensure the Viewport you selected actually contains an element with sheeting data (sheets) assigned to it, and that your \"Filter Material\" setting matches the material names in the model.\n- Q: How do I change the text size?\n  A: The script uses the selected \"Dim style\" settings. Change the text height in the AutoCAD Dimension Style Manager (DDIM) for the style selected in the script properties.\n- Q: Can I list multiple specific zones at once?\n  A: No, you can either list a single specific zone index or set \"Zones to use\" to \"All\" to show every zone."
      },
      "tokens_used": 6848,
      "error": null
    }
  }
}