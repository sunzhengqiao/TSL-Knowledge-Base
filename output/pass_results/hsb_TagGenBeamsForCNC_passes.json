{
  "filename": "hsb_TagGenBeamsForCNC.mcr",
  "status": "completed",
  "total_tokens": 37519,
  "processing_time": 218.9245584011078,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "16.06.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5297,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses PrEntity to select GenBeam and Sheet elements and operates directly on _GenBeam[] with setBeamCode and setSubMapX. It does not use sd_ prefixes, Viewport logic, or #Type E Entity arrays. It calls eraseInstance() immediately after processing, typical of a model utility."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam",
            "Sheet"
          ],
          "minimumBeams": 1,
          "requiredSpace": "The script requires interaction in Model Space to select beams/sheets during the insert cycle.",
          "requiredSettings": []
        }
      },
      "tokens_used": 3466,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Please select beams/sheets",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sOperationCNC",
            "type": "PropString",
            "displayName": "CNC Operation",
            "defaultValue": "Exclude",
            "inputType": "dropdown",
            "options": [
              "Exclude",
              "Include"
            ],
            "category": "Beam CNC Operation",
            "description": null
          },
          {
            "index": 3,
            "variable": "sExclusionType",
            "type": "PropString",
            "displayName": "Exclusion Type",
            "defaultValue": "Code",
            "inputType": "dropdown",
            "options": [
              "Code",
              "Tag",
              "Both"
            ],
            "category": "Beam CNC Operation",
            "description": null
          },
          {
            "index": 1,
            "variable": "sNailing",
            "type": "PropString",
            "displayName": "Allow Nailing",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Beam CNC Operation",
            "description": null
          },
          {
            "index": 4,
            "variable": "sGluing",
            "type": "PropString",
            "displayName": "Allow Gluing",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "Beam CNC Operation",
            "description": null
          },
          {
            "index": 5,
            "variable": "sInformation",
            "type": "PropString",
            "displayName": "Information",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sOperationMEP",
            "type": "PropString",
            "displayName": "MEP Operation",
            "defaultValue": "Exclude",
            "inputType": "dropdown",
            "options": [
              "Exclude",
              "Include"
            ],
            "category": "Tag beams for MEP",
            "description": null
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6986,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A batch processing utility to modify beam manufacturing attributes, specifically controlling CNC exclusion, nailing/gluing permissions, and MEP processing, while simultaneously regenerating the standardized Beam Code string.",
          "category": "Manufacturing/CNC",
          "typicalUseCase": "Used when preparing a model for production to mark specific beams as 'manual' or 'purchased' (exclude from CNC), or to ensure specific beams are not processed by nailing or gluing machines."
        },
        "parameters": [
          {
            "name": "sOperationCNC",
            "technicalDefault": "Exclude",
            "businessMeaning": "Determines if the selected elements should be processed by CNC machinery or excluded from it.",
            "validRange": "Exclude, Include",
            "unit": "Enum",
            "affectsOutput": "If 'Exclude', it prefixes the beam code with 'EXC', sets the 'Use on Table' flag to NO (depending on Exclusion Type), and adds a 'NoMount' tag to prevent machining."
          },
          {
            "name": "sExclusionType",
            "technicalDefault": "Code",
            "businessMeaning": "Defines the method used to exclude the beam from productionâ€”either by modifying the visible naming code, adding hidden data tags, or both.",
            "validRange": "Code, Tag, Both",
            "unit": "Enum",
            "affectsOutput": "Controls whether the 'EXC' prefix is added to the Beam Code (Code), whether a 'NoMount' SubMapX tag is added (Tag), or if both actions are performed (Both). It also influences the 'Use on Table' flag in the Beam Code."
          },
          {
            "name": "sNailing",
            "technicalDefault": "No",
            "businessMeaning": "Specifies whether the beam is permitted to have automated nailing operations (e.g., nail plates) applied to it.",
            "validRange": "No, Yes",
            "unit": "Enum",
            "affectsOutput": "Updates the 'Allow Nailing' field (Token 8) within the generated Beam Code string."
          },
          {
            "name": "sGluing",
            "technicalDefault": "No",
            "businessMeaning": "Specifies whether the beam is permitted to be processed by gluing machines (e.g., presses for finger joints or lamellar assembly).",
            "validRange": "No, Yes",
            "unit": "Enum",
            "affectsOutput": "Adds or removes the 'NoGluing' tag from the element's SubMapX data."
          },
          {
            "name": "sInformation",
            "technicalDefault": "",
            "businessMeaning": "User-defined text description for the element, often used for comments, lot numbers, or additional manufacturing notes.",
            "validRange": "String (Text)",
            "unit": "Text",
            "affectsOutput": "Updates the 'Information' property of the beam and writes this value into the 'Information' field (Token 10) of the Beam Code string."
          },
          {
            "name": "sOperationMEP",
            "technicalDefault": "Exclude",
            "businessMeaning": "Controls whether the beam is included in MEP (Mechanical, Electrical, Plumbing) processing, such as automated drilling for pipe runs.",
            "validRange": "Exclude, Include",
            "unit": "Enum",
            "affectsOutput": "If 'Exclude', adds an 'MEPExclude' tag to the SubMapX data. If 'Include', it attempts to remove this tag."
          },
          {
            "name": "nColor",
            "technicalDefault": "1",
            "businessMeaning": "Visual color index for the selected beams in the CAD model to indicate status changes visually.",
            "validRange": "0-255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Changes the display color of the selected entities in the model workspace."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sOperationCNC is set to 'Exclude'",
            "effect": "The effect on the Beam Code's 'Use on Table' field depends on sExclusionType.",
            "cascade": [
              "sExclusionType"
            ]
          },
          {
            "trigger": "sExclusionType is set to 'Tag' (only)",
            "effect": "The 'Use on Table' field in the Beam Code remains YES (default), whereas 'Code' or 'Both' sets it to NO.",
            "cascade": [
              "sOperationCNC"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam Attributes",
            "description": "Modified BeamCode string, SubMapX Tags (Hsb_Tag), and OPM Properties (Information, Color).",
            "appliedTo": "User-selected GenBeams and Sheets."
          }
        ]
      },
      "tokens_used": 7437,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 9079,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_TagGenBeamsForCNC.mcr\n\n## Overview\nThis utility script allows you to batch update manufacturing attributes for selected beams and sheets. It is primarily used to exclude elements from CNC machining, control nailing/gluing permissions, and manage MEP processing, while automatically regenerating the Beam Code string to reflect these changes.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary environment for running this script. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required entities**: GenBeam or Sheet elements must exist in the model.\n- **Minimum beam count**: 1 (can process multiple selections in one go).\n- **Required settings**: None specific to this script.\n\n## Usage Steps\n\n### Step 1: Launch Script\n```\nCommand: TSLINSERT\nAction: Browse and select hsb_TagGenBeamsForCNC.mcr\n```\n\n### Step 2: Select Beams/Sheets\n```\nCommand Line: Please select beams/sheets\nAction: Click on the beams or sheets you wish to modify. Press Enter to confirm selection.\n```\n*Note: Once confirmed, the script will apply the properties set in the Properties Palette and then remove itself from the drawing.*\n\n## Properties Panel Parameters\n\n### Beam CNC Operation\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| CNC Operation | dropdown | Exclude | Determines if the element is processed by CNC machinery. \"Exclude\" marks the beam to be skipped. |\n| Exclusion Type | dropdown | Code | Defines *how* the beam is excluded.<br>**Code**: Adds 'EXC' prefix to the name and sets \"Use on Table\" to NO.<br>**Tag**: Adds hidden 'NoMount' data only (keeps \"Use on Table\" YES).<br>**Both**: Applies both Code and Tag logic. |\n| Allow Nailing | dropdown | No | Sets whether the beam is allowed to have automated nailing operations applied. Updates Token 8 of the Beam Code. |\n| Allow Gluing | dropdown | No | Sets whether the beam is allowed to be processed by gluing machines. |\n\n### Tag beams for MEP\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| MEP Operation | dropdown | Exclude | Controls inclusion in MEP (Mechanical, Electrical, Plumbing) processing. \"Exclude\" adds a tag to prevent automated drilling. |\n\n### General\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Information | text | (Empty) | User-defined text description or notes. This is written to Token 10 of the Beam Code. |\n| Color | number | 1 | The AutoCAD color index used to visually change the color of the selected entities in the model. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific right-click context menu items. It runs once upon insertion and deletes itself. |\n\n## Settings Files\nNone\n\n## Tips\n- **Bulk Processing**: You can select multiple beams and sheets in a single selection window to apply standard settings to a whole group (e.g., all purchased beams).\n- **Visual Feedback**: Use the **Color** property to change the appearance of excluded beams (e.g., change to Red) so draftsmen can easily identify them visually in the model.\n- **Beam Code Regeneration**: This script automatically regenerates the Beam Code string. Ensure you understand your company's naming convention before using the \"Code\" exclusion type, as it changes the visible text label.\n\n## FAQ\n- **Q: What is the difference between Exclusion Type \"Code\" and \"Tag\"?**\n  - **A**: \"Code\" modifies the visible Beam Name (adding 'EXC') and sets the production flag \"Use on Table\" to NO. \"Tag\" leaves the name visible but adds hidden data ('NoMount') that tells the machine to skip it, while keeping \"Use on Table\" as YES. Use \"Tag\" if you want the label to stay clean but still prevent machining.\n- **Q: Why did the script disappear after I ran it?**\n  - **A**: This is a utility script designed to run once. Once it processes your selection, it automatically erases itself to keep your drawing clean.\n- **Q: How do I allow nailing on a beam I previously excluded?**\n  - **A**: Run the script again, select the beam, set \"CNC Operation\" to \"Include\" (or appropriate settings), and ensure \"Allow Nailing\" is set to \"Yes\"."
      },
      "tokens_used": 5254,
      "error": null
    }
  }
}