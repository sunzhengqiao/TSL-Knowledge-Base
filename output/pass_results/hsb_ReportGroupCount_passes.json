{
  "filename": "hsb_ReportGroupCount.mcr",
  "status": "completed",
  "total_tokens": 15975,
  "processing_time": 175.3952136039734,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "31.08.2011",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2636,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses general Group API (gpFloor.subGroups) to retrieve drawing structure data. No ShopDrawing (sd_*) API calls, Viewport handling, or layout-specific logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Group structure"
          ],
          "minimumBeams": 0,
          "requiredSpace": "hsbCAD Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 1895,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3897,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script reports the total number of sub-groups (typically representing floors) within the main project Group structure to the command line.",
          "category": "Reporting/Analysis",
          "typicalUseCase": "Used to quickly verify the drawing structure and count how many distinct floor levels or sections have been defined in the current project."
        },
        "parameters": [],
        "parameterDependencies": [],
        "outputEntities": []
      },
      "tokens_used": 1271,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User launches script insertion command.",
          "Script checks the insertCycleCount() to handle multi-run insertion scenarios.",
          "Script sets the insertion point (_Pt0) based on cursor position.",
          "Script retrieves the main group structure (gpFloor) and extracts all sub-groups.",
          "Script counts the total number of sub-groups found.",
          "Script reports the total count to the command line using reportNotice.",
          "Script immediately erases its own instance from the drawing."
        ],
        "conditionalBranches": [
          {
            "condition": "Check insertCycleCount() during _bOnInsert phase",
            "path1": {
              "name": "Duplicate Cycle",
              "steps": [
                "If insertCycleCount > 1",
                "Erase the script instance",
                "Exit script execution immediately"
              ]
            },
            "path2": {
              "name": "Initial Cycle",
              "steps": [
                "If insertCycleCount == 1",
                "Set insertion point _Pt0",
                "Return to proceed with main logic"
              ]
            }
          }
        ],
        "validationRules": [],
        "postInsertionActions": []
      },
      "tokens_used": 3160,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ReportGroupCount.mcr\n\n## Overview\nThis script counts the total number of sub-groups (typically representing floors) within the main project Group structure and displays the result in the AutoCAD command line. It serves as a quick verification tool to check how many distinct floor levels or sections have been defined in the current project.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script is designed to analyze the main project structure in Model Space. |\n| Paper Space | No | Not applicable for paper space layouts. |\n| Shop Drawing | No | Does not interact with shop drawing views or detailing. |\n\n## Prerequisites\n- **Required entities**: A valid hsbCAD Group structure (main group with sub-groups) must exist in the drawing.\n- **Minimum beam count**: None.\n- **Required settings files**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` (or insert via the hsbCAD Scripts menu)\n```\nAction: Select 'hsb_ReportGroupCount.mcr' from the file dialog list.\n```\n\n### Step 2: Place and Execute\n```\nCommand Line: Specify insertion point:\nAction: Click anywhere in the drawing area to place the script instance.\n```\n\n### Step 3: View Results\n```\nCommand Line: [Output displays automatically]\nAction: Observe the command line for the reported group count.\nNote: The script instance will automatically erase itself after reporting.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script has no configurable properties. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add specific context menu options. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Check History**: If you miss the count on the command line, press **F2** to open the AutoCAD Text Window and view the command history.\n- **Clean Up**: You do not need to manually delete the script object; it is programmed to remove itself automatically after running.\n- **Project Verification**: Use this script after importing or generating a new project to ensure all floors were processed correctly.\n\n## FAQ\n- **Q: Why didn't a dialog box appear?**\n  **A:** This is a command-line reporter tool. It outputs the text directly to the AutoCAD command line interface (CLI).\n- **Q: The script reported 0 groups. What does that mean?**\n  **A:** This means the script could not find any sub-groups within the main project Group. Ensure your drawing is structured with a main Group containing the floor elements.\n- **Q: Did the script work? I don't see anything new in the drawing.**\n  **A:** Yes, if you see text in the command line (e.g., \"Total groups found: X\"). The script is designed to be invisible and self-deleting."
      },
      "tokens_used": 3116,
      "error": null
    }
  }
}