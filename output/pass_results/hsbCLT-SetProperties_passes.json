{
  "filename": "hsbCLT-SetProperties.mcr",
  "status": "completed",
  "total_tokens": 32720,
  "processing_time": 258.5998010635376,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "This tsl sets properties (material, grade, information, label and sublabel) of all panels of the selection set or being referenced by one of the selected master panels, child panels or any freight object A blank property will keep the existing value.",
        "versionHistory": [
          {
            "version": "1.4",
            "date": "22may17",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "bugfix label"
          },
          {
            "version": "1.2",
            "date": "15jul16",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "'---' resets the property to blank"
          },
          {
            "version": "1.1",
            "date": "12jul16",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "sublabel2 added"
          },
          {
            "version": "1.0",
            "date": "11jul16",
            "author": "thorsten.huck@hsbcad.com",
            "changes": "initial"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6186,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script targets MasterPanel, ChildPanel, Sip entities and TslInst freight items. It uses PrEntity for selection and executes logic within `_bOnInsert` block without any `sd_` prefixes, `_Viewport` checks, or `#Type E` declarations."
        },
        "prerequisites": {
          "requiredEntities": [
            "MasterPanel",
            "ChildPanel",
            "Sip",
            "TslInst"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing panels (Sip/MasterPanel/ChildPanel) or associated freight objects.",
          "requiredSettings": []
        }
      },
      "tokens_used": 3282,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity.go",
              "promptOriginal": "Select panels(s) or any referenced entity (child or master panels, freight item(s), packages or trucks)",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "When _kExecuteKey is empty during _bOnInsert",
            "title": null,
            "dataSource": "OPM Properties",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Material. Empty = unchanged '---' = no value"
          },
          {
            "index": 1,
            "variable": "sGrade",
            "type": "PropString",
            "displayName": "Grade",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Grade Empty = unchanged '---' = no value"
          },
          {
            "index": 2,
            "variable": "sInformation",
            "type": "PropString",
            "displayName": "Information",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Information. Empty = unchanged '---' = no value"
          },
          {
            "index": 3,
            "variable": "sLabel",
            "type": "PropString",
            "displayName": "Label",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Label. Empty = unchanged '---' = no value"
          },
          {
            "index": 4,
            "variable": "sSublabel",
            "type": "PropString",
            "displayName": "Sublabel",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Sublabel. Empty = unchanged '---' = no value"
          },
          {
            "index": 5,
            "variable": "sSublabel2",
            "type": "PropString",
            "displayName": "Sublabel2",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "General",
            "description": "Defines the Sublabel2. Empty = unchanged '---' = no value"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 4944,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Batch updates metadata attributes (Material, Grade, Information, Labels) for CLT panels, either selected directly or indirectly via freight objects/packages.",
          "category": "DataManagement",
          "typicalUseCase": "Updating the structural grade or clearing information fields for all panels contained within a specific truck or package without selecting individual panels."
        },
        "parameters": [
          {
            "name": "sMaterial",
            "technicalDefault": "",
            "businessMeaning": "Specifies the raw material type or code for the panels (e.g., 'CLT C24', 'GL24h'). If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Alphanumeric string matching project material codes",
            "unit": "Text",
            "affectsOutput": "Updates the Material field on the Sip entity, influencing material reports, weights, and data exports."
          },
          {
            "name": "sGrade",
            "technicalDefault": "",
            "businessMeaning": "Defines the structural strength grade or quality class of the timber. If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Alphanumeric string (e.g., C24, GL28h)",
            "unit": "Text",
            "affectsOutput": "Updates the Grade field on the Sip entity, used for structural analysis and labeling."
          },
          {
            "name": "sInformation",
            "technicalDefault": "",
            "businessMeaning": "Stores general user-defined notes or production instructions specific to the panel (e.g., 'Fire protected', 'Untreated'). If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Text string (free form)",
            "unit": "Text",
            "affectsOutput": "Updates the Information field on the Sip entity, visible in lists and production drawings."
          },
          {
            "name": "sLabel",
            "technicalDefault": "",
            "businessMeaning": "Assigns a primary categorization label or sorting code to the panel. If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Alphanumeric string",
            "unit": "Text",
            "affectsOutput": "Updates the Label field on the Sip entity, used for filtering, sorting, and CAM organization."
          },
          {
            "name": "sSublabel",
            "technicalDefault": "",
            "businessMeaning": "Assigns a secondary categorization label to the panel. If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Alphanumeric string",
            "unit": "Text",
            "affectsOutput": "Updates the Sublabel field on the Sip entity, allowing for granular classification."
          },
          {
            "name": "sSublabel2",
            "technicalDefault": "",
            "businessMeaning": "Assigns a tertiary categorization label to the panel for extended organization. If left blank, existing values are preserved. If set to '---', the property is cleared.",
            "validRange": "Alphanumeric string",
            "unit": "Text",
            "affectsOutput": "Updates the Sublabel2 field on the Sip entity."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "PropertyModification",
            "description": "Updates string properties (Material, Grade, Info, Labels) on existing Sip entities. No geometry is created or modified.",
            "appliedTo": "Sip entities found in the selection set, referenced by Master/Child panels, or contained within selected Trucks/Packages."
          }
        ]
      },
      "tokens_used": 6295,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution starts via command or catalog insert.",
          "Check if execution mode is Insert (_bOnInsert).",
          "[Conditional] Check insertCycleCount(). If > 1, erase instance and exit immediately.",
          "[Conditional] Check _kExecuteKey. If not empty, load properties from catalog; otherwise, display dialog (ShowDynamicDialog) to input property values.",
          "Prompt user to select entities: MasterPanel, ChildPanel, Sip, or TslInst (Freight/Package/Truck) using PrEntity.go().",
          "[Conditional] If user selection is valid (PrEntity.go() returns true), proceed to process entities; otherwise, script ends implicitly.",
          "Filter selection set into arrays: Sips[], Childs[], Masters[], and TslInst arrays for Trucks, Packages, and Freight Items.",
          "Expand hierarchy: Iterate through selected Trucks to find nested Packages.",
          "Expand hierarchy: Iterate through all found Packages (selected + from Trucks) to find nested Freight Items.",
          "Expand hierarchy: Iterate through all found Freight Items (selected + from Packages) to find associated Sip panels.",
          "Expand hierarchy: Iterate through selected MasterPanels to find nested ChildPanels.",
          "Expand hierarchy: Iterate through all found ChildPanels (selected + from Masters) to find associated Sip panels.",
          "Update Properties: Iterate through the final collection of Sip panels.",
          "Apply changes: For each panel, if a property (Material, Grade, etc.) was input (length > 0): if value is '---', clear property; otherwise, set property to new value.",
          "Erase the script instance and exit."
        ],
        "conditionalBranches": [
          {
            "condition": "Check insertCycleCount()",
            "path1": {
              "name": "Cycle Count > 1",
              "steps": [
                "Erase instance immediately.",
                "Return (Exit script)."
              ]
            },
            "path2": {
              "name": "Cycle Count <= 1 (First Run)",
              "steps": [
                "Proceed to input method check."
              ]
            }
          },
          {
            "condition": "Check _kExecuteKey (Catalog execution)",
            "path1": {
              "name": "Catalog Key Present",
              "steps": [
                "Call setPropValuesFromCatalog(_kExecuteKey).",
                "Skip interactive dialog."
              ]
            },
            "path2": {
              "name": "Standard/Interactive Execution",
              "steps": [
                "Call showDialog().",
                "User inputs values in Dynamic Dialog/OPM."
              ]
            }
          },
          {
            "condition": "User Selection (PrEntity.go())",
            "path1": {
              "name": "Selection Made",
              "steps": [
                "Populate entsSet array.",
                "Process entities and update properties."
              ]
            },
            "path2": {
              "name": "Selection Cancelled/Empty",
              "steps": [
                "Script proceeds with empty arrays.",
                "Property update loop runs on zero elements.",
                "Instance erased."
              ]
            }
          },
          {
            "condition": "Property Value Input Check",
            "path1": {
              "name": "Value is '---'",
              "steps": [
                "Clear the property (set to empty string \"\")."
              ]
            },
            "path2": {
              "name": "Value is non-empty string",
              "steps": [
                "Set property to the specified string."
              ]
            },
            "path3": {
              "name": "Value is empty/blank string",
              "steps": [
                "Leave property unchanged (Skip)."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Entity Validity (bIsValid)",
            "errorMessage": "None (Internal Filter)",
            "recovery": "Script silently skips invalid entities found in selection sets during hierarchy expansion loops."
          },
          {
            "check": "Sip Assignment in Freight Items",
            "errorMessage": "None (Internal Filter)",
            "recovery": "Script only processes Freight Items containing exactly one GenBeam which is a Sip; others are ignored."
          }
        ],
        "postInsertionActions": []
      },
      "tokens_used": 6390,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-SetProperties.mcr\n\n## Overview\nThis script allows you to batch update metadata properties (Material, Grade, Information, and Labels) for CLT panels. You can apply updates to panels selected directly or indirectly by selecting their parent entities, such as master panels, trucks, or packages.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script operates on panels and freight items in the 3D model. |\n| Paper Space | No | Not designed for layout views. |\n| Shop Drawing | No | Not a drawing generation script. |\n\n## Prerequisites\n- **Required Entities**: MasterPanels, ChildPanels, Sip entities, or TslInst freight items (Trucks, Packages).\n- **Minimum Count**: At least one relevant entity must be selected to perform an update.\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsbCLT-SetProperties.mcr`\n\n### Step 2: Configure Properties\n**Action**: A dialog (Dynamic Dialog) or the Properties Palette will appear automatically.\n1. Enter the values you wish to apply to the panels.\n2. **Important**:\n   - Leave a field **Blank** to keep the existing value on the panels.\n   - Type `---` (three dashes) to clear the existing value on the panels.\n3. Press **Enter** or click **OK** to confirm the settings.\n\n### Step 3: Select Entities\n```\nCommand Line: Select panels(s) or any referenced entity (child or master panels, freight item(s), packages or trucks)\nAction: Click on the desired objects in the model.\n```\n- You can select individual panels, or click on a **Truck/Package** to update all panels inside it.\n- You can click on a **Master Panel** to update its children.\n- Press **Enter** to finalize the selection and apply the changes.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Material | Text | \"\" | Sets the material code (e.g., \"CLT C24\"). Leave blank to keep current; enter \"---\" to clear. |\n| Grade | Text | \"\" | Sets the structural grade (e.g., \"C24\"). Leave blank to keep current; enter \"---\" to clear. |\n| Information | Text | \"\" | Sets general information or notes. Leave blank to keep current; enter \"---\" to clear. |\n| Label | Text | \"\" | Sets the primary label/sorting code. Leave blank to keep current; enter \"---\" to clear. |\n| Sublabel | Text | \"\" | Sets the secondary sublabel. Leave blank to keep current; enter \"---\" to clear. |\n| Sublabel2 | Text | \"\" | Sets the tertiary sublabel. Leave blank to keep current; enter \"---\" to clear. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script runs immediately upon insertion and erases itself; it does not persist as an object with context menus. |\n\n## Settings Files\n- **Filename**: None required.\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Smart Selection**: To save time, select a \"Truck\" or \"Package\" entity. The script will automatically find and update all panels contained within it.\n- **Resetting Values**: If you need to erase data from a specific property field (e.g., remove the Grade), use the special code `---` in the input field.\n- **Partial Updates**: You do not need to fill in every field. Only the fields containing text will be updated on the selected panels.\n\n## FAQ\n- **Q: How do I clear a property so it is empty?**\n  A: Enter exactly `---` (three hyphens/dashes) into the property field before selecting the panels.\n- **Q: What happens if I leave a field blank?**\n  A: The script will ignore that field and leave the existing value on the panels unchanged.\n- **Q: Can I use this on standard beams?**\n  A: No, this script is designed specifically for CLT panels (Sip entities) and related freight objects."
      },
      "tokens_used": 5623,
      "error": null
    }
  }
}