{
  "filename": "sdUK_ShowSIPList.mcr",
  "status": "completed",
  "total_tokens": 31824,
  "processing_time": 408.24958848953247,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "13.07.2012",
            "author": "Chirag Sawjani (csawjani@itw-industry.com)",
            "changes": "Release"
          },
          {
            "version": "1.1",
            "date": "11.06.2015",
            "author": "Chirag Sawjani",
            "changes": "Removed unnecessary code"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4841,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "Both",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": true,
          "detectionEvidence": "Script defines sSpace property allowing selection between 'Model' and 'shopdraw multipage'. Uses getShopDrawView() and ViewData().convertFromSubMap() specifically for the Shopdraw branch. Filename starts with 'sd' prefix."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sip",
            "ShopDrawView"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Determined by 'sSpace' property (Model or Shopdraw multipage)",
          "requiredSettings": []
        }
      },
      "tokens_used": 3459,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": false
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "Pick a point for edge details",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 3,
              "function": "PrEntity",
              "promptOriginal": "Please select Elements",
              "condition": "_bOnInsert && sSpace == sModel",
              "required": true
            },
            {
              "step": 3,
              "function": "getShopDrawView",
              "promptOriginal": "|Select the view entity from which the module is taken|",
              "condition": "_bOnInsert && sSpace == sShopdrawSpace",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sSpace",
            "type": "PropString",
            "displayName": "|Drawing space|",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": [
              "|Model|",
              "|shopdraw multipage|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sDimLayout",
            "type": "PropString",
            "displayName": "Dim Style",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "_DimStyles (System Variable)",
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nDimColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "1",
            "inputType": "number",
            "options": null,
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sListHeading",
            "type": "PropString",
            "displayName": "Panel list heading:",
            "defaultValue": "Panel List:",
            "inputType": "text",
            "options": null,
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5715,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a sorted list of Structural Insulated Panel (SIP) labels based on a selection of panels or a specific shop drawing view.",
          "category": "ShopDrawing/Annotation",
          "typicalUseCase": "Creating a schedule or label list on a fabrication drawing to show exactly which SIP panels are included in a specific assembly or view."
        },
        "parameters": [
          {
            "name": "sSpace",
            "technicalDefault": null,
            "businessMeaning": "Defines the operating environment and source of the panel data. Determines whether the user manually selects panels in the 3D model or extracts them automatically from a specific 2D shop drawing view.",
            "validRange": "\"|Model|\" or \"|shopdraw multipage|\"",
            "unit": "Selection Mode",
            "affectsOutput": "Alters the input method (Entity Selection vs View Selection) and determines which specific panels are aggregated into the final list."
          },
          {
            "name": "sDimLayout",
            "technicalDefault": null,
            "businessMeaning": "Selects the dimension style (font, text size, arrow style, etc.) to be used for the generated text list.",
            "validRange": "Any dimension style name currently loaded in the hsbCAD/AutoCAD drawing",
            "unit": "Style Name",
            "affectsOutput": "Controls the height, font, and visual appearance of the panel label text."
          },
          {
            "name": "nDimColor",
            "technicalDefault": "1",
            "businessMeaning": "Sets the color of the generated text list.",
            "validRange": "1-255 (AutoCAD Color Index)",
            "unit": "ACI",
            "affectsOutput": "Changes the display color of the panel list text."
          },
          {
            "name": "sListHeading",
            "technicalDefault": "Panel List:",
            "businessMeaning": "The custom title text displayed at the top of the generated list.",
            "validRange": "Any alphanumeric string",
            "unit": "Text",
            "affectsOutput": "Updates the first line of text generated at the insertion point."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sSpace is set to \"|Model|\"",
            "effect": "Enables direct selection of Sip entities via command line. The script ignores ShopDrawView data.",
            "cascade": [
              "PrEntity"
            ]
          },
          {
            "trigger": "sSpace is set to \"|shopdraw multipage|\"",
            "effect": "Prompts the user to select a ShopDrawView entity. The script filters Sips based on the data contained within that specific view.",
            "cascade": [
              "getShopDrawView",
              "ViewData().convertFromSubMap"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Annotation (Text)",
            "description": "A vertical list of text strings comprising a title and sorted SIP labels (Label + SubLabel).",
            "appliedTo": "Model Space or Paper Space (depending on sSpace setting), inserted at user-picked point _Pt0."
          }
        ]
      },
      "tokens_used": 5240,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script is launched; Properties dialog or OPM palette displays available settings.\",\n    \"User sets 'Drawing space' property to either Model or shopdraw multipage.\",\n    \"User configures visual properties (Dim Style, Color, Panel list heading) and confirms.\",\n    \"Command line prompts user to pick an insertion point for the list.\",\n    \"User picks point.\",\n    \"Branch logic executes based on 'Drawing space' property.\",\n    \"[Model Path] Command line prompts user to select Sip elements.\",\n    \"[Model Path] User selects one or more Sip entities.\",\n    \"[Shopdraw Path] Command line prompts user to select a ShopDrawView entity.\",\n    \"[Shopdraw Path] User selects a View entity.\",\n    \"Script halts insertion phase and saves data to internal _Entity array.\",\n    \"Script enters calculation/generation phase (triggered by recalc/insert).\",\n    \"Script identifies the 'Reference Sip' based on the active branch.\",\n    \"[Model Logic] The first Sip selected in the selection set becomes the Reference Sip.\",\n    \"[Shopdraw Logic] Script extracts entities from the View; the last Sip found in the array becomes the Reference Sip.\",\n    \"Script queries the model for all entities sharing the Reference Sip's Position Number (PosNum).\",\n    \"Branch logic executes based on the number of entities found in the PosNum collection.\",\n    \"[Single Entity] Script composes a single string (Label + SubLabel) and draws it.\",\n    \"[Collection] Script iterates through collection, composes strings (Label + SubLabel), and stores them.\",\n    \"[Collection] Script sorts the array of strings alphabetically using a bubble sort.\",\n    \"[Collection] Script draws the Heading, then iterates through the sorted array to draw the list lines.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Property 'sSpace' (Drawing Space) value\",\n      \"path1\": {\n        \"name\": \"Model Mode\",\n        \"steps\": [\n          \"Execute PrEntity prompt for Sip selection.\",\n          \"Store selected Sips in _Entity array.\",\n          \"Use _Entity[0] (first selected) as the reference for filtering the PosNum group.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Shopdraw Multipage Mode\",\n        \"steps\": [\n          \"Execute getShop"
      },
      "tokens_used": 7407,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# sdUK_ShowSIPList.mcr\n\n## Overview\nThis script generates a sorted schedule of Structural Insulated Panel (SIP) labels. It allows you to create a list of panels either by manually selecting them in the model or by automatically extracting them from a specific shop drawing view.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Select panels directly using the \"Model\" mode. |\n| Paper Space | Indirectly | Use \"shopdraw multipage\" mode to select a view frame. |\n| Shop Drawing | Yes | Specifically supports \"shopdraw multipage\" environments. |\n\n## Prerequisites\n- **Required Entities**: Structural Insulated Panels (SIPs) must exist in the drawing. If using Shop Draw mode, a valid Shop Drawing View must be present.\n- **Minimum Selection**: At least one SIP (Model mode) or one View (Shop Draw mode).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `sdUK_ShowSIPList.mcr` from the list.\n\n### Step 2: Configure Properties\nBefore insertion, the Properties Palette (OPM) will display.\n1.  Set the **Drawing space** property to `|Model|` (for 3D model selection) or `|shopdraw multipage|` (for drawing views).\n2.  Adjust the **Dim Style**, **Color**, and **Panel list heading** as desired.\n\n### Step 3: Insertion Point\n```\nCommand Line: Pick a point for edge details\nAction: Click in the drawing where you want the top-left corner of the list to appear.\n```\n\n### Step 4: Select Source (Mode Dependent)\nThe next prompt depends on the **Drawing space** property selected in Step 2.\n\n**If \"|Model|\" is selected:**\n```\nCommand Line: Please select Elements\nAction: Click on one or more SIP panels in the model and press Enter.\n```\n*Note: The script will use the first selected panel to find all other panels in the model with the same Position Number.*\n\n**If \"|shopdraw multipage|\" is selected:**\n```\nCommand Line: Select the view entity from which the module is taken\nAction: Click on the border/frame of the Shop Drawing View containing the panels.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Drawing space | dropdown | *None* | Determines the selection method. Choose `|Model|` to pick panels directly, or `|shopdraw multipage|` to select a view frame. |\n| Dim Style | dropdown | *Current* | Selects the dimension style (font, text height) to apply to the generated list text. |\n| Color | number | 1 | Sets the AutoCAD color index (1-255) for the text. (1 = Red). |\n| Panel list heading | text | Panel List: | The title text displayed at the very top of the generated list. |\n\n## Right-Click Menu Options\nNo specific custom context menu options are defined for this script.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Smart Grouping**: You do not need to select every single individual panel if they belong to the same assembly. The script detects the Position Number of your selection and automatically includes all panels in the model that share that number.\n- **Sorting**: The list is automatically sorted alphabetically to ensure consistency in your drawings.\n- **Text Appearance**: Ensure your chosen **Dim Style** is sized appropriately for the scale of your drawing so the list is legible.\n\n## FAQ\n- **Q: Why are there more panels in my list than I selected?**\n  **A**: The script is designed to group panels by their Position Number. If you select one panel from a group, the script finds and lists every panel in the current model that shares that Position Number.\n\n- **Q: Can I use this in a layout (Paper Space) directly?**\n  **A**: You should use the \"shopdraw multipage\" mode. This allows you to select a view frame, and the script will extract the relevant panel data from that view to generate the list.\n\n- **Q: The text is too small to read.**\n  **A**: Change the **Dim Style** property to a style that uses a larger text height, or modify the text height in your AutoCAD dim style settings."
      },
      "tokens_used": 5162,
      "error": null
    }
  }
}