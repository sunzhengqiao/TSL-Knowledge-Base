{
  "filename": "hsb_RemoveBeamsAndSheetsUnderDoors.mcr",
  "status": "completed",
  "total_tokens": 24553,
  "processing_time": 754.3706269264221,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "03.03.2010",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.1",
            "date": "18.05.2010",
            "author": null,
            "changes": "Fix with Sequence and erase Instance"
          },
          {
            "version": "1.2",
            "date": "16.03.2012",
            "author": null,
            "changes": "Add A bigger door size"
          },
          {
            "version": "1.3",
            "date": "21.03.2012",
            "author": null,
            "changes": "Added bIsValid before running plEnvelope"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4435,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script collects Elements using PrEntity and iterates through el.beam() and el.sheet(). It interacts directly with the 3D model entities (Beam.dbErase(), Sheet.dbErase()) without any sd_ prefixes, Viewport checks, or #Type E declarations."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Requires selection of Elements within the AutoCAD Model Space containing Openings of type Door.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2181,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Please select Elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2659,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically cleans up wall panels by removing specific structural framing members (braces, jack studs, sills) and sheathing sheets that obstruct door openings.",
          "category": "Framing/Automation",
          "typicalUseCase": "Used during the design or detailing phase to clear the aperture area of door openings in wall elements that have been generated with default full-height framing or sheathing."
        },
        "parameters": [
          {
            "name": "ents",
            "technicalDefault": "null",
            "businessMeaning": "The set of wall elements (panels) selected by the user to be processed for door openings.",
            "validRange": "1 or more Elements containing Opening entities of type '_kDoor'",
            "unit": "Entity",
            "affectsOutput": "Defines the scope of the script. Only beams and sheets belonging to the selected elements will be evaluated for removal."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Selection contains Elements without Door openings",
            "effect": "The script skips those elements and performs no erasures.",
            "cascade": []
          },
          {
            "trigger": "Beam types other than _kBrace, _kSFJackUnderOpening, or _kSill",
            "effect": "Those beams are ignored and will not be deleted even if they intersect the door.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Erasure",
            "description": "Deletion of specific beams (Braces, Jack Studs, Sills) located within the door's envelope (extended 500mm into the wall) if they overlap by more than 95%.",
            "appliedTo": "Beams of types _kBrace, _kSFJackUnderOpening, _kSill within the selected Elements."
          },
          {
            "type": "Erasure",
            "description": "Deletion of sheathing sheets located at the bottom of the door opening if they overlap with the door profile by more than 95%.",
            "appliedTo": "Sheets within the selected Elements."
          }
        ]
      },
      "tokens_used": 5313,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 6666,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_RemoveBeamsAndSheetsUnderDoors.mcr\n\n## Overview\nThis script automatically cleans up wall panels by removing specific framing members (braces, jack studs, sills) and sheathing sheets that obstruct door openings. It is designed to prepare wall elements for door installation by clearing the aperture area.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates directly on 3D Elements in the model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: Wall Elements (containing Openings of type \"Door\").\n- **Minimum Beam Count**: 0 (Script processes existing entities).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_RemoveBeamsAndSheetsUnderDoors.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Please select Elements\nAction: Select the wall elements (panels) in the Model Space that contain the door openings you wish to clear. Press Enter to confirm selection.\n```\nThe script will automatically process the selected elements, identify door openings, and remove overlapping braces, jack studs, sills, and sheets.\n\n## Properties Panel Parameters\nThis script does not expose any user-editable parameters in the Properties Palette (OPM).\n\n## Right-Click Menu Options\nThis script does not add any custom options to the right-click context menu.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Scope of Deletion**: The script specifically targets beams classified as Braces (`_kBrace`), Jack Studs under openings (`_kSFJackUnderOpening`), and Sills (`_kSill`). It will not delete main structural studs.\n- **Overlap Logic**: A member is only deleted if it overlaps with the door's envelope (extended 500mm into the wall) by more than 95%.\n- **Selection**: You can select multiple elements at once to process several doors in a single run.\n- **Validation**: Ensure your elements have valid Door type openings defined; elements without valid doors will be skipped by the script.\n\n## FAQ\n- **Q: Why were the main studs under my door not deleted?**\n  **A:** The script is programmed to remove only bracing, jack studs, and sills to maintain structural integrity. It does not remove primary wall studs.\n- **Q: Can I undo the changes?**\n  **A:** Yes, you can use the standard AutoCAD `UNDO` command immediately after running the script if the results are not as expected.\n- **Q: What happens if I select an element that has no doors?**\n  **A:** The script will detect that there are no valid door openings and skip that element without making any changes."
      },
      "tokens_used": 3299,
      "error": null
    }
  }
}