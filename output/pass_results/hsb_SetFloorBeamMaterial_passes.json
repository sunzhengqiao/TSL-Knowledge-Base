{
  "filename": "hsb_SetFloorBeamMaterial.mcr",
  "status": "completed",
  "total_tokens": 32261,
  "processing_time": 196.71046590805054,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.1",
            "date": "30.04.2012",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "First version"
          },
          {
            "version": "1.2",
            "date": "31.05.2012",
            "author": null,
            "changes": "Add Name and grade as a property"
          },
          {
            "version": "1.4",
            "date": "03.08.2012",
            "author": null,
            "changes": "Add beam type _kSupportingCrossBeam"
          },
          {
            "version": "1.5",
            "date": "10.10.2012",
            "author": null,
            "changes": "Removed check for grade to see if it is empty.  If property is empty it will overwrite the grade to empty"
          },
          {
            "version": "1.6",
            "date": "10.09.2015",
            "author": null,
            "changes": "Fixed tsl to work from tool palettes"
          },
          {
            "version": "1.7",
            "date": "10.09.2015",
            "author": null,
            "changes": "Added furrings to the list of types"
          }
        ],
        "settingsFiles": [
          "Materials.xml"
        ],
        "dependencies": []
      },
      "tokens_used": 4704,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for `Beam()` entities using `PrEntity` and modifies 3D beam attributes (Type, Material, Grade, Name, Color, BeamCode). It lacks ShopDrawing specific patterns (sd_*, Multipage*, _Viewport, #Type E)."
        },
        "prerequisites": {
          "requiredEntities": [
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Materials.xml (located in hsbCompany\\Abbund folder)"
          ]
        }
      },
      "tokens_used": 3778,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\nSelect one or more beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowDynamicDialog",
            "trigger": "_bOnInsert && _kExecuteKey == \"\"",
            "title": null,
            "dataSource": "Properties (sBeamUse, sBeamName, sBeamMaterial, sBeamGrade, sNailing, nColor)",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sBeamUse",
            "type": "PropString",
            "displayName": "Beam Use",
            "defaultValue": "Rim Board",
            "inputType": "dropdown",
            "options": [
              "Rim Board",
              "Joist",
              "Trimmer",
              "Rim Joist",
              "Blocking",
              "Packers",
              "Strongbacks",
              "Beam",
              "Furring"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sBeamName",
            "type": "PropString",
            "displayName": "Beam Name",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sBeamMaterial",
            "type": "PropString",
            "displayName": "Material",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "Dynamically loaded from Materials.xml",
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sBeamGrade",
            "type": "PropString",
            "displayName": "Grade",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sNailing",
            "type": "PropString",
            "displayName": "Allow Nailing",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "Yes",
              "No"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": 32,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "Materials.xml",
            "searchPaths": [
              "_kPathHsbCompany\\Abbund"
            ],
            "purpose": "Provides list of materials for the Material property",
            "required": true
          }
        ]
      },
      "tokens_used": 4399,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A batch editor tool used to standardize and apply material properties, structural grades, naming conventions, and beam codes to selected floor framing elements.",
          "category": "Framing / Properties",
          "typicalUseCase": "Assigning specific timber grades (e.g., C24), materials (e.g., Solid Timber), and usage types (e.g., Joist, Rim Board) to floor beams after layout to ensure correct calculations and labeling for manufacturing."
        },
        "parameters": [
          {
            "name": "sBeamUse",
            "technicalDefault": "Rim Board",
            "businessMeaning": "Defines the structural function or classification of the beam within the floor system (e.g., Joist, Trimmer, Blocking).",
            "validRange": "Predefined list: Rim Board, Joist, Trimmer, Rim Joist, Blocking, Packers, Strongbacks, Beam, Furring",
            "unit": "Enum",
            "affectsOutput": "Sets the internal Beam Type (_kJoist, _kRimBeam, etc.) and defaults the Beam Name if the specific Name property is left empty."
          },
          {
            "name": "sBeamName",
            "technicalDefault": "",
            "businessMeaning": "A user-defined label for the beam, often used for sorting or identification in lists and labels.",
            "validRange": "Any alphanumeric string (often corresponds to the Use if left blank).",
            "unit": "String",
            "affectsOutput": "Updates the 'Name' attribute of the beam and updates Token 11 of the BeamCode."
          },
          {
            "name": "sBeamMaterial",
            "technicalDefault": "null",
            "businessMeaning": "The specific wood species or product brand (e.g., SPF, GL24h) assigned to the beam.",
            "validRange": "Dynamically populated list from Materials.xml (e.g., C24, C16, LVL).",
            "unit": "String",
            "affectsOutput": "Sets the Material attribute and updates Token 1 of the BeamCode."
          },
          {
            "name": "sBeamGrade",
            "technicalDefault": "",
            "businessMeaning": "The structural strength grade or quality rating of the timber (e.g., C24, TR26).",
            "validRange": "Standard timber grade codes (e.g., C14, C24, GL28h).",
            "unit": "String",
            "affectsOutput": "Sets the Grade attribute and updates Token 9 of the BeamCode."
          },
          {
            "name": "sNailing",
            "technicalDefault": "Yes",
            "businessMeaning": "Flag indicating whether automated nailing/machining is allowed on this beam.",
            "validRange": "Yes, No",
            "unit": "Enum",
            "affectsOutput": "Updates Token 8 of the BeamCode ('YES' or 'NO'), which downstream machining processes read to determine if nail patterns should be applied."
          },
          {
            "name": "nColor",
            "technicalDefault": "32",
            "businessMeaning": "The visual color index used to display the beam in the CAD model, often used to distinguish material types or processed states.",
            "validRange": "0 to 255 (AutoCAD Color Index)",
            "unit": "ACI",
            "affectsOutput": "Changes the graphical display color of the beam entity."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sBeamName is empty",
            "effect": "The Beam Name is automatically populated based on the value selected in sBeamUse.",
            "cascade": [
              "sBeamName"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Beam (Modification)",
            "description": "Updates attributes (Type, Material, Grade, Name, Color) and regenerates the BeamCode string to reflect the new property values.",
            "appliedTo": "User-selected Beam entities in Model Space."
          }
        ]
      },
      "tokens_used": 5939,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script starts and locates Materials.xml in the hsbCompany\\Abbund directory.",
          "Validates that Materials.xml exists and contains material entries.",
          "Initializes properties, populating the 'Material' dropdown list from the XML file.",
          "[On Insertion] If executed manually (no ExecuteKey), the Dynamic Dialog is displayed.",
          "User is prompted to select one or more Beams from the model.",
          "Selected Beams are linked to the script instance.",
          "[Calculation Phase] Script loops through each selected Beam.",
          "Script updates Beam attributes: Type (based on Beam Use), Material, Grade, and Color.",
          "Script determines the final Name (User-specified or Default based on Beam Use).",
          "Script reconstructs the BeamCode string with updated tokens for Material, Nailing, Grade, and Name.",
          "Script applies the new BeamCode to the Beam.",
          "Script erases its own instance from the drawing."
        ],
        "conditionalBranches": [
          {
            "condition": "Materials.xml file found and readable",
            "path1": {
              "name": "Success",
              "steps": [
                "Parse XML for material list",
                "Populate Material property dropdown",
                "Proceed to Insertion"
              ]
            },
            "path2": {
              "name": "Failure",
              "steps": [
                "Display report notice: 'Materials not been set, please run hsbMaterial Utility...'",
                "Execute eraseInstance()",
                "Halt script"
              ]
            }
          },
          {
            "condition": "Material list parsed from XML contains entries",
            "path1": {
              "name": "List Populated",
              "steps": [
                "Continue script execution"
              ]
            },
            "path2": {
              "name": "List Empty",
              "steps": [
                "Display report notice",
                "Execute eraseInstance()",
                "Halt script"
              ]
            }
          },
          {
            "condition": "Beam Name property is empty",
            "path1": {
              "name": "Default Naming",
              "steps": [
                "Set Beam Name to match the 'Beam Use' selection (e.g., 'Joist')"
              ]
            },
            "path2": {
              "name": "Custom Naming",
              "steps": [
                "Set Beam Name to the specific text entered in the 'Beam Name' property"
              ]
            }
          },
          {
            "condition": "Beam Use selection matches internal list",
            "path1": {
              "name": "Valid Match",
              "steps": [
                "Update internal Beam Type",
                "Apply properties",
                "Update BeamCode"
              ]
            },
            "path2": {
              "name": "No Match",
              "steps": [
                "Skip updating that specific beam"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Existence of Materials.xml at _kPathHsbCompany\\Abbund\\Materials.xml",
            "errorMessage": "Materials not been set, please run hsbMaterial Utility or contact SupportDesk",
            "recovery": "Run the hsbMaterial Utility or ensure the XML file exists in the correct directory."
          },
          {
            "check": "Materials.xml contains non-DEFAULT material entries",
            "errorMessage": "Materials not been set, please run hsbMaterial Utility or contact SupportDesk",
            "recovery": "Configure the Materials.xml file to include valid material definitions."
          },
          {
            "check": "User selected at least one Beam",
            "errorMessage": "None (Script silently deletes itself if _Beam.length() == 0)",
            "recovery": "Re-run the script and ensure Beams are selected during the PrEntity prompt."
          },
          {
            "check": "Selected 'Beam Use' exists in the predefined script list",
            "errorMessage": "None",
            "recovery": "Ensure the Beam Use property is set to a valid option from the dropdown."
          }
        ],
        "postInsertionActions": [
          {
            "action": "No post-insertion interaction",
            "how": "N/A",
            "effect": "The script executes once, updates the selected beams, and calls eraseInstance() to remove itself from the drawing. Modifications must be made by re-running the tool or editing the beams directly."
          }
        ]
      },
      "tokens_used": 7114,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetFloorBeamMaterial.mcr\n\n## Overview\nThis script is a batch editing tool that standardizes material properties, structural grades, naming conventions, and beam codes for selected floor framing elements. It is typically used to apply specific timber grades and material types to floor beams (such as Joists or Rim Boards) after the initial layout is complete.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This is the primary operating space. |\n| Paper Space | No | Not supported in layout views. |\n| Shop Drawing | No | Not intended for shop drawing generation. |\n\n## Prerequisites\n- **Required Entities**: Beams (GenBeams) must exist in the model.\n- **Minimum Beam Count**: 1 (though multiple can be selected in one operation).\n- **Required Settings**: `Materials.xml` must be present in the `hsbCompany\\Abbund` folder. If this file is missing or empty, the script will display an error and exit.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Type `TSLINSERT` in the AutoCAD command line.\n2. Select `hsb_SetFloorBeamMaterial.mcr` from the file dialog.\n\n### Step 2: Configure Properties\n1. Upon insertion, the script properties will appear (either in a Dynamic Dialog or the Properties Palette).\n2. Set the desired **Material**, **Grade**, **Beam Use**, and other attributes for the batch operation.\n\n### Step 3: Select Beams\n```\nCommand Line: Select one or more beams\nAction: Click on the beams in the model you wish to update. You can select multiple beams. Press Enter to confirm selection.\n```\n\n### Step 4: Execution\n1. The script will automatically apply the configured properties to the selected beams.\n2. It will update the Beam Name, Beam Code, and Color.\n3. The script instance will erase itself from the drawing automatically once complete.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Beam Use | dropdown | Rim Board | Defines the structural function of the beam (e.g., Joist, Trimmer, Blocking). This also sets the internal beam type. |\n| Beam Name | text | (Empty) | A user-defined label for the beam. If left empty, it will automatically copy the value from \"Beam Use\". |\n| Material | dropdown | (From XML) | The wood species or material type (e.g., C24, GL24h). List is populated from Materials.xml. |\n| Grade | text | (Empty) | The structural strength grade of the timber (e.g., C24, TR26). |\n| Allow Nailing | dropdown | Yes | Determines if automated nailing/machining is allowed on the beam (Updates Token 8 of BeamCode). |\n| Color | number | 32 | Sets the AutoCAD Color Index (ACI) for the beam's graphical display. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | This script does not add specific right-click menu options. It runs once and deletes itself. |\n\n## Settings Files\n- **Filename**: `Materials.xml`\n- **Location**: `hsbCompany\\Abbund` (located in your hsbCAD company folder structure)\n- **Purpose**: This XML file provides the list of available materials (e.g., C24, LVL) that appear in the \"Material\" dropdown list.\n\n## Tips\n- **Auto-Naming**: If you want the beam names to match their usage (e.g., all \"Joist\" beams named \"Joist\"), leave the **Beam Name** property empty.\n- **Batch Processing**: You can window select multiple beams during the prompt phase to apply the material settings to an entire floor section at once.\n- **Visual Verification**: The script changes the beam color (default index 32). Use this to visually confirm which beams have been processed by the script.\n- **Error Handling**: If you receive an error regarding \"Materials not been set,\" verify that `Materials.xml` exists in your company folder and is not empty.\n\n## FAQ\n- **Q: Why did the script disappear after I selected the beams?**\n  - A: This is normal behavior. The script is a \"run-once\" utility that erases itself from the drawing after applying the changes to prevent clutter.\n- **Q: Can I use this to change the size of the beams?**\n  - A: No, this script only updates properties (Material, Grade, Type, Name, and Color). It does not modify the geometric dimensions (width/height).\n- **Q: The Material dropdown is empty. What do I do?**\n  - A: Ensure your `Materials.xml` file in the `hsbCompany\\Abbund` folder contains valid material entries. You may need to run the `hsbMaterial Utility` to generate or update this file."
      },
      "tokens_used": 6327,
      "error": null
    }
  }
}