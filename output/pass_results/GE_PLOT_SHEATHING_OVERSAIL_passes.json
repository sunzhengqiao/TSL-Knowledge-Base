{
  "filename": "GE_PLOT_SHEATHING_OVERSAIL.mcr",
  "status": "completed",
  "total_tokens": 34032,
  "processing_time": 589.1011831760406,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "19.mar.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "- Copied from Layout_DIM_Sheathing_Oversail, to keep US content folder naming standards\n- Thumbnail added"
          },
          {
            "version": "1.7",
            "date": "15.mar.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "- Version control from 1.0 to 1.7, to keep updated with Layout_DIM_Sheathing_Oversail"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 5229,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script explicitly retrieves a Viewport using getViewport(), manipulates the _Viewport array, and performs coordinate transformations between Model Space (ms2ps) and Paper Space (ps2ms). Dimensions are defined in Model Space, transformed to Paper Space, and drawn."
        },
        "prerequisites": {
          "requiredEntities": [
            "Viewport",
            "Element",
            "Sheet",
            "Beam"
          ],
          "minimumBeams": 0,
          "requiredSpace": "The script must be inserted into an AutoCAD Layout containing a Viewport that links to an hsb Element.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2886,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "getViewport",
              "promptOriginal": "Select a viewport, you can add others later on with the HSB_LINKTOOLS command.",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "strDir",
            "type": "PropString",
            "displayName": "Direction",
            "defaultValue": "Horizontal",
            "inputType": "dropdown",
            "options": [
              "Horizontal",
              "Vertical"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nZone",
            "type": "PropInt",
            "displayName": "Zone index",
            "defaultValue": "5",
            "inputType": "dropdown",
            "options": [
              -5,
              -4,
              -3,
              -2,
              -1,
              1,
              2,
              3,
              4,
              5
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimension Style",
            "defaultValue": null,
            "inputType": "dropdown",
            "options": "_DimStyles",
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sDeltaOnTop",
            "type": "PropString",
            "displayName": "Side of delta dimensioning",
            "defaultValue": "Above",
            "inputType": "dropdown",
            "options": [
              "Above",
              "Below"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dOffsetFromEl",
            "type": "PropDouble",
            "displayName": "Offset From Element",
            "defaultValue": "150",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "strTextDirD",
            "type": "PropString",
            "displayName": "Delta text direction",
            "defaultValue": "None",
            "inputType": "dropdown",
            "options": [
              "None",
              "Parallel",
              "Perpendicular"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nDimColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 6089,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically dimensions the overhang (oversail) distance of sheathing sheets relative to the timber frame on 2D layout drawings.",
          "category": "ShopDrawing",
          "typicalUseCase": "Used when detailing wall or floor panels where sheathing extends beyond the timber frame (e.g., for aesthetic overhangs or sealing details) to document the exact offset for manufacturing."
        },
        "parameters": [
          {
            "name": "strDir",
            "technicalDefault": "Horizontal",
            "businessMeaning": "Specifies the orientation along which to measure the sheathing overhang. Determines if the script measures oversail relative to the element's X-axis (Horizontal) or Y-axis (Vertical).",
            "validRange": "Horizontal, Vertical",
            "unit": "Enum",
            "affectsOutput": "Swaps the measurement axis and the perpendicular offset direction for the dimension line location."
          },
          {
            "name": "nZone",
            "technicalDefault": "5",
            "businessMeaning": "Identifies the specific layer or zone of the sheathing material to measure. In hsbCAD, different zones represent different material layers (e.g., exterior sheathing vs interior sheathing).",
            "validRange": "-5 to 5",
            "unit": "Index",
            "affectsOutput": "Changes which physical sheeting entity is calculated. If the selected zone is empty or does not extend past the frame, no dimension will appear."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "Selects the AutoCAD Dimension Style to be used for the annotation. This controls arrowheads, text fonts, and scale relative to the Paper Space viewport.",
            "validRange": "Any valid AutoCAD Dimension Style in the drawing",
            "unit": "String",
            "affectsOutput": "Alters the visual appearance (font size, arrow type, line thickness) of the dimension text and lines."
          },
          {
            "name": "sDeltaOnTop",
            "technicalDefault": "Above",
            "businessMeaning": "Controls the vertical position of the dimension text relative to the dimension line. 'Above' places the text outside the extension lines upward, 'Below' places it downward.",
            "validRange": "Above, Below",
            "unit": "Enum",
            "affectsOutput": "Moves the dimension text to the opposite side of the dimension line for clarity or to avoid other drawing entities."
          },
          {
            "name": "dOffsetFromEl",
            "technicalDefault": "150",
            "businessMeaning": "Sets the distance between the Element's origin (0,0) and the dimension line in Paper Space. This effectively determines how far 'off the building' the dimension line is drawn.",
            "validRange": "0 - 5000",
            "unit": "mm",
            "affectsOutput": "Moves the dimension line closer to or further away from the model geometry in the layout view."
          },
          {
            "name": "strTextDirD",
            "technicalDefault": "None",
            "businessMeaning": "Defines the rotation angle of the dimension text. 'None' keeps it horizontal; 'Parallel' aligns it with the dimension line; 'Perpendicular' rotates it 90 degrees.",
            "validRange": "None, Parallel, Perpendicular",
            "unit": "Enum",
            "affectsOutput": "Rotates the text inside the dimension entity."
          },
          {
            "name": "nDimColor",
            "technicalDefault": "1",
            "businessMeaning": "Assigns the AutoCAD color index to the dimension entities.",
            "validRange": "1 - 255",
            "unit": "Color Index",
            "affectsOutput": "Changes the color of the dimension lines and text (e.g., to red for highlighting or specific layer colors)."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change of strDir",
            "effect": "Modifies the orientation of the measurement vector and the offset vector applied to dOffsetFromEl.",
            "cascade": [
              "dOffsetFromEl"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Dimension",
            "description": "Paper Space dimension entities indicating the distance the sheathing sheet extends past the outermost timber beam in the specified direction.",
            "appliedTo": "Layout Viewport (Paper Space)"
          }
        ]
      },
      "tokens_used": 6009,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "User inserts script and runs showDialogOnce()",
          "User clicks a point in Paper Space (getPoint)",
          "User selects a Viewport (getViewport)",
          "Script initializes coordinate transformation (Model Space <-> Paper Space)",
          "Script retrieves Element from Viewport",
          "User/Script determines Dimension Direction (Horizontal/Vertical)",
          "Script calculates Dimension Line position in Paper Space based on Offset From Element",
          "Script transforms Dimension Line to Model Space",
          "Script filters and sorts Beams in Element to find outermost boundaries (perpendicular to dimension line)",
          "Script retrieves Sheets from specified Zone",
          "Script projects Sheet boundaries onto measurement line",
          "Script compares Sheet boundaries to Beam boundaries to detect oversail",
          "[Conditional] If Oversail detected at Start: Create Dimension entity",
          "[Conditional] If Oversail detected at End: Create Dimension entity",
          "Dimensions are drawn in Display context with specified Color, Style, and Text settings"
        ],
        "conditionalBranches": [
          {
            "condition": "_bOnInsert == true",
            "path1": {
              "name": "Initialization Path",
              "steps": [
                "Show Dialog",
                "Prompt for Point",
                "Prompt for Viewport",
                "Append Viewport to list",
                "Exit Script (return)"
              ]
            },
            "path2": {
              "name": "Execution/Update Path",
              "steps": [
                "Check Viewport validity",
                "Process Geometry",
                "Draw Dimensions"
              ]
            }
          },
          {
            "condition": "Viewport Element Validity",
            "path1": {
              "name": "Valid Viewport",
              "steps": [
                "Extract Element",
                "Calculate Dimensions"
              ]
            },
            "path2": {
              "name": "Invalid Viewport",
              "steps": [
                "Exit Script (return)"
              ]
            }
          },
          {
            "condition": "Selected Direction (strDir)",
            "path1": {
              "name": "Horizontal",
              "steps": [
                "Calculate Dimension Line along X-axis",
                "Offset Line in -Y direction"
              ]
            },
            "path2": {
              "name": "Vertical",
              "steps": [
                "Calculate Dimension Line along Y-axis",
                "Offset Line in -X direction"
              ]
            }
          },
          {
            "condition": "Beam Points Found",
            "path1": {
              "name": "Beams Exist",
              "steps": [
                "Determine Start/End points of frame",
                "Proceed to Sheet check"
              ]
            },
            "path2": {
              "name": "No Beams",
              "steps": [
                "Exit Script (return)"
              ]
            }
          },
          {
            "condition": "Sheet Points Found",
            "path1": {
              "name": "Sheets Exist in Zone",
              "steps": [
                "Determine Start/End points of sheathing",
                "Compare with Frame points"
              ]
            },
            "path2": {
              "name": "No Sheets in Zone",
              "steps": [
                "Exit Script (return)"
              ]
            }
          },
          {
            "condition": "Oversail at Start (vecStartBS.length > tolerance)",
            "path1": {
              "name": "Oversail Detected",
              "steps": [
                "Create Dimension between Beam Start and Sheet Start",
                "Draw Dimension"
              ]
            },
            "path2": {
              "name": "No Oversail",
              "steps": [
                "Skip Dimension creation at Start"
              ]
            }
          },
          {
            "condition": "Oversail at End (vecEndBS.length > tolerance)",
            "path1": {
              "name": "Oversail Detected",
              "steps": [
                "Create Dimension between Beam End and Sheet End",
                "Draw Dimension"
              ]
            },
            "path2": {
              "name": "No Oversail",
              "steps": [
                "Skip Dimension creation at End"
              ]
            }
          },
          {
            "condition": "Color Index Validity (nDimColor 0-255)",
            "path1": {
              "name": "Valid",
              "steps": [
                "Use specified color"
              ]
            },
            "path2": {
              "name": "Invalid",
              "steps": [
                "Reset color to 0 (ByBlock)"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Array is not empty (_Viewport.length() > 0)",
            "errorMessage": "None (Silent Exit)",
            "recovery": "Ensure script is inserted in a valid context or viewport selection was not cleared."
          },
          {
            "check": "Viewport contains a valid hsb Element (vp.element().bIsValid())",
            "errorMessage": "None (Silent Exit)",
            "recovery": "Select a Viewport that displays an hsbCAD Element."
          },
          {
            "check": "Beams found in Element (pnts.length() > 0)",
            "errorMessage": "None (Silent Exit)",
            "recovery": "Ensure the Element has visible structural beams."
          },
          {
            "check": "Sheets found in specified Zone (pntsS.length() > 0)",
            "errorMessage": "None (Silent Exit)",
            "recovery": "Change 'Zone index' property to a layer that contains sheathing sheets."
          },
          {
            "check": "Sheathing extends beyond frame (Oversail > Tolerance)",
            "errorMessage": "None (No Dimension Drawn)",
            "recovery": "Check model geometry. Ensure sheathing actually overlaps the frame edge for dimensioning to appear."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Dimension Direction",
            "how": "OPM Property 'Direction'",
            "effect": "Recalculates dimension line orientation (Horizontal vs Vertical) and updates dimensions."
          },
          {
            "action": "Change Sheathing Zone",
            "how": "OPM Property 'Zone index'",
            "effect": "Targets a different material layer. Updates dimensions if the new zone has different oversail geometry."
          },
          {
            "action": "Adjust Dimension Offset",
            "how": "OPM Property 'Offset From Element'",
            "effect": "Moves the dimension line closer to or further from the element origin in Paper Space."
          },
          {
            "action": "Modify Appearance",
            "how": "OPM Properties 'Dimension Style', 'Color', 'Side of delta dimensioning', 'Delta text direction'",
            "effect": "Redraws dimensions with new visual styles, colors, text placement, or rotation."
          }
        ]
      },
      "tokens_used": 7266,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_PLOT_SHEATHING_OVERSAIL\n\n## Overview\nAutomatically dimensions the overhang (oversail) distance of sheathing sheets relative to the timber frame on 2D layout drawings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed specifically for Layout generation. |\n| Paper Space | Yes | The script must be inserted into an AutoCAD Layout containing a Viewport. |\n| Shop Drawing | Yes | Used for detailing panel manufacturing dimensions. |\n\n## Prerequisites\n- **Required Entities**: An AutoCAD Layout with a Viewport linked to an hsb Element.\n- **Element Content**: The Element must contain structural Beams and Sheathing Sheets.\n- **Minimum Beams**: 0 (Script exits silently if no beams or sheets are found).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_PLOT_SHEATHING_OVERSAIL.mcr`\n\n### Step 2: Set Insertion Point\n```\nCommand Line: (No specific prompt)\nAction: Click anywhere in the Paper Space layout to define the script's anchor point.\n```\n\n### Step 3: Select Viewport\n```\nCommand Line: Select a viewport, you can add others later on with the HSB_LINKTOOLS command.\nAction: Click on the viewport border that displays the wall/floor element you want to dimension.\n```\n\n### Step 4: Adjust Properties\nAfter insertion, select the script anchor (invisible or represented by a point) and open the **Properties Palette** (Ctrl+1) to configure the dimension settings (Direction, Zone, Offset, etc.). The script will automatically update the dimensions in the viewport.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Direction | dropdown | Horizontal | Sets the orientation of the measurement line relative to the element (Horizontal or Vertical). |\n| Zone index | dropdown | 5 | Selects the material layer (zone) to measure. Commonly 5 for exterior sheathing. |\n| Dimension Style | dropdown | _DimStyles | Selects the AutoCAD Dimension Style to use for the annotation. |\n| Side of delta dimensioning | dropdown | Above | Determines if the dimension text is placed Above or Below the dimension line. |\n| Offset From Element | number | 150 | Distance in mm from the Element's origin (0,0) to the dimension line location. |\n| Delta text direction | dropdown | None | Controls text rotation: None (Horizontal), Parallel, or Perpendicular to the line. |\n| Color | number | 1 | Sets the AutoCAD Color Index (1-255) for the dimension lines and text. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are defined for this script. |\n\n## Settings Files\n- None.\n\n## Tips\n- **Missing Dimensions?** If no dimensions appear, check if the selected **Zone index** actually contains sheathing sheets that extend past the timber frame. If the sheathing is flush with or inside the frame, no oversail dimension will be drawn.\n- **Multiple Viewports:** You can link additional viewports to this script after insertion using the `HSB_LINKTOOLS` command if your workflow supports it.\n- **Visual Clarity:** Use the **Offset From Element** property to move the dimension line away from the model geometry if the drawing is too crowded.\n- **Standardization:** Set the **Dimension Style** to your company standard style immediately after insertion to ensure annotations match your drawing standards.\n\n## FAQ\n- **Q: Why don't I see any dimensions after running the script?**\n- **A:** This usually happens for three reasons: 1) The selected Zone has no sheets. 2) The sheets do not actually extend past the frame (oversail is 0). 3) The Viewport is not linked to a valid hsb Element.\n\n- **Q: Can I dimension both horizontal and vertical oversails with one script?**\n- **A:** No, you must insert the script once for Horizontal and once for Vertical (changing the \"Direction\" property for each instance) if you need dimensions on both sides.\n\n- **Q: How do I change the color of the dimensions?**\n- **A:** Select the script in Paper Space, open the Properties Palette, and change the \"Color\" property to the desired AutoCAD Color Index (e.g., 1 for Red, 2 for Yellow, etc.)."
      },
      "tokens_used": 6553,
      "error": null
    }
  }
}