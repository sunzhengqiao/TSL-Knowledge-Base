{
  "filename": "hsb_SolePlate TableEntry.mcr",
  "status": "completed",
  "total_tokens": 32731,
  "processing_time": 223.00244784355164,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "25.05.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          },
          {
            "version": "1.1",
            "date": "00.06.2009",
            "author": "",
            "changes": "Assign the TSL to the group that now is taking from the Material Table"
          },
          {
            "version": "1.2",
            "date": "10.05.2010",
            "author": "",
            "changes": "Change the Table and some small fixes on export"
          },
          {
            "version": "1.3",
            "date": "11.02.2011",
            "author": "",
            "changes": "Add group for the new data base"
          },
          {
            "version": "1.4",
            "date": "23.02.2012",
            "author": "",
            "changes": "Made TSL go into Z type layer instead of T"
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "hsb_SolePlate Material Table"
        ]
      },
      "tokens_used": 4931,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "No '_Viewport' checks or 'sd_' function usage found. The script retrieves its geometry (origin point) and data from a '_Map' passed by a parent script ('hsb_SolePlate Material Table'). It uses standard Display methods ('dp.draw') relative to '_Pt0', '_XW', and '_YW', which is consistent with Model Space operations for generating visual tables or BOM entries. The lack of specific view manipulation logic confirms Model Space usage."
        },
        "prerequisites": {
          "requiredEntities": [
            "Entity (referenced as _Entity[0] for grouping)"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Parent Script: hsb_SolePlate Material Table",
            "Map Keys: 'ptOrg' (Point3d), 'mapTableObject' (Map containing 'sMaterial', 'sDescription', etc.)"
          ]
        }
      },
      "tokens_used": 5110,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dRowHeight",
            "type": "PropDouble",
            "displayName": "Row height",
            "defaultValue": "U(100)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dColumnWidth",
            "type": "PropDouble",
            "displayName": "Column width",
            "defaultValue": "U(1000)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "sDimStyle",
            "type": "PropString",
            "displayName": "Dimension style",
            "defaultValue": "_DimStyles",
            "inputType": "dropdown",
            "options": [
              "_DimStyles"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nContentColor",
            "type": "PropInt",
            "displayName": "Content color",
            "defaultValue": "-1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 5076,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Generates a visual table entry row displaying material properties (Description, Width, Height, Quantity, Unit) for a specific Sole Plate item, acting as a child component to a main material table.",
          "category": "ShopDrawing / Documentation",
          "typicalUseCase": "Automatically populating a material list or BOM table on a drawing when a parent script (hsb_SolePlate Material Table) aggregates data from Sole Plate elements."
        },
        "parameters": [
          {
            "name": "dRowHeight",
            "technicalDefault": "U(100)",
            "businessMeaning": "The vertical height allocated for this specific table row, controlling how tall the text block appears in the drawing.",
            "validRange": "30.0 - 200.0",
            "unit": "mm",
            "affectsOutput": "Scales the vertical positioning and background size of the text display. If too small, text may clip or overlap with adjacent rows."
          },
          {
            "name": "dColumnWidth",
            "technicalDefault": "U(1000)",
            "businessMeaning": "The default width of a single column in the table if dynamic column widths are not strictly provided by the parent map. (Note: The code primarily uses 'mapColumnWidth' array for specific widths, but this property serves as a fallback or general reference).",
            "validRange": "500.0 - 3000.0",
            "unit": "mm",
            "affectsOutput": "Determines the horizontal spacing between text elements. Affects readability and the total width of the table entry."
          },
          {
            "name": "sDimStyle",
            "technicalDefault": "_DimStyles",
            "businessMeaning": "The CAD dimension style used to define the font, text size, and arrow style for the text displayed in the table.",
            "validRange": "N/A (String: name of an existing DimStyle in the drawing)",
            "unit": "N/A",
            "affectsOutput": "Controls the visual appearance (font type, height) of the material descriptions and numeric values."
          },
          {
            "name": "nContentColor",
            "technicalDefault": "-1",
            "businessMeaning": "The color index used to draw the text and lines for this table row. -1 usually represents the layer's default color (ByLayer).",
            "validRange": "-1 - 255 (AutoCAD Color Index)",
            "unit": "Color Index",
            "affectsOutput": "Changes the visual color of the table text. Useful for highlighting specific material types or adhering to layer standards."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Change in 'mapColumnWidth' (Parent Map)",
            "effect": "Overrides the visual spacing of columns; the 'dColumnWidth' property may become irrelevant if specific widths are passed from the parent.",
            "cascade": [
              "dColumnWidth"
            ]
          },
          {
            "trigger": "Insertion without 'ptOrg' or 'mapTableObject' in Map",
            "effect": "The script self-destructs (erases instance) as it lacks required coordinates or data to display.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Text / Geometry",
            "description": "Draws 5 text strings (Description, Width, Height, Quantity, Unit) at specific coordinates relative to the origin point, formatted according to the specified dimension style and color.",
            "appliedTo": "Model Space (as a visual representation linked to the parent Element group)"
          },
          {
            "type": "Data Export (DXI)",
            "description": "Exports specific properties (Group, Model Name, Quantity) to an external data exchange interface (DXI) for BOM processing.",
            "appliedTo": "External BOM / Production systems"
          }
        ]
      },
      "tokens_used": 4386,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"Script instantiation (triggered by parent script)\",\n    \"Initialize properties: dRowHeight, dColumnWidth, sDimStyle, nContentColor (set to Read-Only)\",\n    \"Validate nContentColor (ensure between -1 and 255, default to 171 if invalid)\",\n    \"[Conditional] Check Map for Origin Point key 'ptOrg'\",\n    \"[Conditional] Check if an Entity is linked to the script (_Entity[0])\",\n    \"Assign script instance to the Group of the linked Entity and set dependency\",\n    \"[Conditional] Check Map for Table Object Map 'mapTableObject'\",\n    \"[Conditional] Verify that Table Object Map contains data (length > 0)\",\n    \"Extract Column Width array and Material Data strings (Description, Width, Height, Qty, Unit)\",\n    \"Initialize Display object with Content Color and Dimension Style\",\n    \"Calculate text insertion point based on Row Height\",\n    \"Draw text for 5 columns (Description, Width, Height, Quantity, Unit) at calculated offsets\",\n    \"Set Comparison Key for numbering logic\",\n    \"Export data to DXI interface and update '_Map' with TSLBOM details\",\n    \"Script execution complete\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Map contains 'ptOrg' (Origin Point)\",\n      \"path1\": {\n        \"name\": \"Origin Found\",\n        \"steps\": [\n          \"Set _Pt0 to map point\",\n          \"Continue to Entity validation\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Origin Missing\",\n        \"steps\": [\n          \"Execute eraseInstance()\",\n          \"Terminate script\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Linked Entity array length >= 1\",\n      \"path1\": {\n        \"name\": \"Entity Assigned\",\n        \"steps\": [\n          \"Add instance to Entity group\",\n          \"Set dependency on Entity\",\n          \"Continue to Data Map validation\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"No Entity\",\n        \"steps\": [\n          \"Execute eraseInstance()\",\n          \"Terminate script\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Map contains 'mapTableObject'\",\n      \"path1\": {\n        \"name\": \"Data Map Found\",\n        \"steps\": [\n          \"Retrieve mapTableObject\",\n          \"Continue to content check\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"Data Map Missing\",\n        \"steps\": [\n          \"Execute eraseInstance()\",\n          \""
      },
      "tokens_used": 7604,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SolePlate TableEntry.mcr\n\n## Overview\nThis script is a sub-component used to automatically generate a single row in a material table for Sole Plates. It reads data passed from a parent script to display material properties (Description, Width, Height, Quantity, Unit) and exports data for production lists.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | The script draws text and geometry relative to an origin point in Model Space. |\n| Paper Space | No | Not designed for Paper Space layout. |\n| Shop Drawing | No | This is a documentation/model space script, not a shop drawing generator. |\n\n## Prerequisites\n- **Parent Script**: `hsb_SolePlate Material Table` (This script is usually called automatically by this parent).\n- **Required Map Data**: The script requires a `_Map` passed during insertion containing:\n    - `ptOrg`: The insertion point (Point3d).\n    - `mapTableObject`: A map containing material data (Description, Width, Height, Qty, Unit).\n- **Linked Entity**: At least one entity must be linked (`_Entity[0]`) for the script to group itself correctly.\n\n## Usage Steps\n\n### Step 1: Automatic Execution (Typical)\nThis script is generally **not** launched manually by the user. It is instantiated automatically by the `hsb_SolePlate Material Table` script when generating a full material list.\n\n### Step 2: Manual Launch (For Testing Only)\nIf testing this script manually without the parent caller:\n```\nCommand Line: TSLINSERT\nAction: Select hsb_SolePlate TableEntry.mcr from the list\n```\n*Note: If run manually without the required Map data (`ptOrg` and `mapTableObject`), the script will detect missing data and immediately erase itself from the drawing.*\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Row height | Double | 100 mm | Sets the vertical height of the table row. Adjust if text overlaps or spacing is too large. |\n| Column width | Double | 1000 mm | Sets the width of the columns. Used if specific widths are not provided by the parent map. |\n| Dimension style | String | _DimStyles | Specifies the Dimension Style to use for text appearance (font, size). |\n| Content color | Integer | -1 | Sets the color of the table text and lines. -1 indicates \"ByLayer\" color. |\n\n## Right-Click Menu Options\nNo custom context menu items are added by this script.\n\n## Settings Files\nNo external settings files (XML) are used by this script. It relies on the `_Map` provided by the parent `hsb_SolePlate Material Table` script.\n\n## Tips\n- **Formatting**: If the table text looks cramped, increase the **Row height** or **Column width** in the properties palette.\n- **Layer Control**: The script assigns itself to the group of the linked Sole Plate entity. If you delete the Sole Plate, this table entry should also be removed.\n- **Data Export**: This script automatically exports data to the DXI interface for BOM generation. Ensure your export settings are configured correctly in the main hsbCAD setup.\n\n## FAQ\n- **Q: Why did the script disappear immediately after I inserted it?**\n  **A:** This script requires specific coordinate and material data (`ptOrg`, `mapTableObject`) to be passed to it via a Map. If run manually without the parent script supplying this data, it will self-delete to prevent errors. Use the `hsb_SolePlate Material Table` script to generate these rows.\n\n- **Q: Can I change the text font?**\n  **A:** Yes. Select the table entry, open the Properties palette, and change the **Dimension style** property to a style that uses your preferred font.\n\n- **Q: The text is the wrong color. How do I fix it?**\n  **A:** Select the entry and change the **Content color** property. Set it to `-1` to use the color of the layer the script is placed on, or enter a specific color index (e.g., 1 for Red, 2 for Yellow, etc.)."
      },
      "tokens_used": 5624,
      "error": null
    }
  }
}