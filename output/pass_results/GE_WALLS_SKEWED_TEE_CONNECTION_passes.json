{
  "filename": "GE_WALLS_SKEWED_TEE_CONNECTION.mcr",
  "status": "completed",
  "total_tokens": 58354,
  "processing_time": 631.5946860313416,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"header\": {\n    \"type\": null,\n    \"numBeamsReq\": null,\n    \"keywords\": null,\n    \"majorVersion\": 1,\n    \"minorVersion\": 12,\n    \"dxaOut\": null,\n    \"implInsert\": null\n  },\n  \"description\": null,\n  \"versionHistory\": [\n    {\n      \"version\": \"1.12\",\n      \"date\": \"21.jul.2012\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Description updated\\n\\t\\t- Thumbnail updated\"\n    },\n    {\n      \"version\": \"1.11\",\n      \"date\": \"04-may-2011\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Changed default value for props.\"\n    },\n    {\n      \"version\": \"1.10\",\n      \"date\": \"28-Feb-2011\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Added chance to cut or not sheetong on female wall\"\n    },\n    {\n      \"version\": \"1.9\",\n      \"date\": \"14-Dic-2010\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Work with blocking added\"\n    },\n    {\n      \"version\": \"1.8\",\n      \"date\": \"08-Dic-2010\",\n      \"author\": \"David Rueda (dr@hsb-cad.com)\",\n      \"changes\": \"- Tsl inserts GE_WDET_AUTOLADDER for ladder type\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t- Display upgrated\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t- Prop. indexes updated\"\n   "
      },
      "tokens_used": 9393,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for entity selection using PrEntity, operates on ElementWall objects, manipulates 3D geometry using plOutlineWall and intersectPLine, and modifies structural components like Sheets using addToolStatic and dbErase. No SD- or Multipage-specific prefixes or drawing generation functions are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "ElementWall"
          ],
          "minimumBeams": 2,
          "requiredSpace": "Model Space containing two intersecting, non-parallel, non-perpendicular walls",
          "requiredSettings": []
        }
      },
      "tokens_used": 7640,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "\n|Select 2 angled elements|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Properties Dialog",
            "trigger": "showDialogOnce() during insert",
            "title": null,
            "dataSource": "OPM Properties defined in script",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Connection type|",
            "defaultValue": "|Simple|",
            "inputType": "dropdown",
            "options": [
              "|Simple|",
              "|Simple L|",
              "|Ladder|",
              "3 |studs|"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "dSheetingLimits",
            "type": "PropDouble",
            "displayName": "|Sheeting limits|",
            "defaultValue": "3.175 mm (0.125 in)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nBmColor",
            "type": "PropInt",
            "displayName": "|Beam color|",
            "defaultValue": 3,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "sLapVTP",
            "type": "PropString",
            "displayName": "|Lap| VTP's",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dEndGapVTP",
            "type": "PropDouble",
            "displayName": "|End gap| (VTP)",
            "defaultValue": "3.175 mm (0.125 in)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "dSideGapVTP",
            "type": "PropDouble",
            "displayName": "|Side gap| (VTP)",
            "defaultValue": "3.175 mm (0.125 in)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "sDummy1",
            "type": "PropString",
            "displayName": "",
            "defaultValue": "  ",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "dEndGapBtmTopPlt",
            "type": "PropDouble",
            "displayName": "|End gap| (BtmP, TP)",
            "defaultValue": "0",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "sDummy2",
            "type": "PropString",
            "displayName": "|All new beams info|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "sNewBeamsName",
            "type": "PropString",
            "displayName": "|Name|",
            "defaultValue": "SYP #2 2x4",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "sNewBeamsMaterial",
            "type": "PropString",
            "displayName": "|Material|",
            "defaultValue": "SYP",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "sNewBeamsGrade",
            "type": "PropString",
            "displayName": "|Grade|",
            "defaultValue": "#2",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "sDummy0",
            "type": "PropString",
            "displayName": "",
            "defaultValue": " ",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "sCutSh",
            "type": "PropString",
            "displayName": "|Cut sheeting on female wall|",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9963,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates structural reinforcement (blocking, studs, or ladders) and necessary sheathing cuts for a skewed (non-90, non-180) T-connection between two timber walls.",
          "category": "Framing",
          "typicalUseCase": "When a wall intersects the side of another wall at an acute or obtuse angle (e.g., 45 degrees), requiring custom blocking or specific sheeting treatments rather than standard perpendicular connections."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "|Simple|",
            "businessMeaning": "Selects the structural configuration used to reinforce the skewed junction.",
            "validRange": "|Simple|, |Simple L|, |Ladder|, 3 |studs|",
            "unit": "Selection",
            "affectsOutput": "Determines if simple blocking, L-shaped blocking, a sub-script ladder assembly, or three vertical studs are generated to tie the walls together."
          },
          {
            "name": "dSheetingLimits",
            "technicalDefault": "3.175 mm",
            "businessMeaning": "The offset distance from the structural intersection where the wall sheathing is cut or stopped.",
            "validRange": "0 mm to 25 mm",
            "unit": "mm (Length)",
            "affectsOutput": "Adjusts the clearance gap around the connection in the sheathing to accommodate fastener heads or structural movement."
          },
          {
            "name": "nBmColor",
            "technicalDefault": "3",
            "businessMeaning": "The display color index for the new structural elements generated by the script.",
            "validRange": "1 - 255 (AutoCAD Color Index)",
            "unit": "Index",
            "affectsOutput": "Visual representation of the new beams in the 3D model."
          },
          {
            "name": "sLapVTP",
            "technicalDefault": "No",
            "businessMeaning": "Specifies whether Vertical Timber/Plate members at the connection overlap or butt against each other.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Modifies the length and positioning of vertical members to create either a lap joint or a butt joint."
          },
          {
            "name": "dEndGapVTP",
            "technicalDefault": "3.175 mm",
            "businessMeaning": "Clearance distance at the ends of Vertical Timber/Plate members.",
            "validRange": "0 mm to 20 mm",
            "unit": "mm (Length)",
            "affectsOutput": "Shortens the vertical member geometry to prevent tight contact or allow for tolerances."
          },
          {
            "name": "dSideGapVTP",
            "technicalDefault": "3.175 mm",
            "businessMeaning": "Clearance distance along the sides of Vertical Timber/Plate members.",
            "validRange": "0 mm to 20 mm",
            "unit": "mm (Length)",
            "affectsOutput": "Reduces the effective width or creates spacing around vertical members."
          },
          {
            "name": "sDummy1",
            "technicalDefault": "  ",
            "businessMeaning": "Formatting separator in the properties palette (no functional effect).",
            "validRange": "N/A",
            "unit": "String",
            "affectsOutput": "None"
          },
          {
            "name": "dEndGapBtmTopPlt",
            "technicalDefault": "0",
            "businessMeaning": "Clearance distance at the ends of Bottom and Top plates.",
            "validRange": "0 mm to 20 mm",
            "unit": "mm (Length)",
            "affectsOutput": "Adjusts the length of plate elements generated at the connection."
          },
          {
            "name": "sDummy2",
            "technicalDefault": "",
            "businessMeaning": "Section header in the properties palette.",
            "validRange": "N/A",
            "unit": "String",
            "affectsOutput": "None"
          },
          {
            "name": "sNewBeamsName",
            "technicalDefault": "SYP #2 2x4",
            "businessMeaning": "The commercial name or size of the lumber stock used for the new connection elements.",
            "validRange": "Any valid catalog name (e.g., 2x4, 2x6, 45x145)",
            "unit": "String",
            "affectsOutput": "Determines the cross-section dimensions of the generated blocking/studs."
          },
          {
            "name": "sNewBeamsMaterial",
            "technicalDefault": "SYP",
            "businessMeaning": "The material species designation for the new beams.",
            "validRange": "Any valid species code (e.g., SPF, SYP, DF)",
            "unit": "String",
            "affectsOutput": "Assigns material properties for reporting and BIM data."
          },
          {
            "name": "sNewBeamsGrade",
            "technicalDefault": "#2",
            "businessMeaning": "The structural grade of the lumber used for the new beams.",
            "validRange": "Any valid grade code (e.g., #2, #1, SS)",
            "unit": "String",
            "affectsOutput": "Assigns grade properties for engineering calculations or reports."
          },
          {
            "name": "sDummy0",
            "technicalDefault": " ",
            "businessMeaning": "Formatting separator in the properties palette.",
            "validRange": "N/A",
            "unit": "String",
            "affectsOutput": "None"
          },
          {
            "name": "sCutSh",
            "technicalDefault": "Yes",
            "businessMeaning": "Toggles whether the script automatically cuts the sheathing on the female wall (the wall being intersected).",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "If 'Yes', creates machining operations on the sheeting to fit around the skewed connection. If 'No', leaves sheeting intact."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sType is set to '|Ladder|'",
            "effect": "The script generates a sub-instance of GE_WDET_AUTOLADDER instead of creating blocking geometry directly.",
            "cascade": []
          },
          {
            "trigger": "sCutSh is set to 'No'",
            "effect": "Suppresses the calculation and execution of sheathing cuts on the female wall.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "Structural blocking, studs, or ladder assemblies filling the skewed intersection void.",
            "appliedTo": "Intersection of Male and Female Walls"
          },
          {
            "type": "Cut (Machining)",
            "description": "Geometric cuts applied to wall sheathing to accommodate the skewed connection geometry.",
            "appliedTo": "Sheets on the Female Wall (and Male Wall depending on configuration)"
          }
        ]
      },
      "tokens_used": 10515,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script Initialization triggered (Insert or Recalculate).\",\n    \"2. If Inserting: Show Properties Dialog (showDialogOnce).\",\n    \"3. If Inserting: Prompt user to select 2 angled elements (PrEntity).\",\n    \"4. Validate Selection: Ensure exactly 2 valid ElementWall entities are selected.\",\n    \"5. Duplicate Check: Search attached TSLs on Wall 1 to ensure this specific connection pair doesn't already have this script applied.\",\n    \"6. Topology Check 1: Verify walls are physically connected (getConnectedElements).\",\n    \"7. Topology Check 2: Verify walls are not parallel or perpendicular.\",\n    \"8. Topology Check 3: Calculate intersection of wall outlines. Must result in exactly 2 points.\",\n    \"9. Topology Check 4: Determine Male (has 2 coincident vertices) and Female (has 0 coincident vertices) walls. Erase if topology is invalid (e.g., corner or end-to-end).\",\n    \"10. Calculate geometric data: Coordinates, Lengths, Widths, Contact Points, and Projection Points.\",\n    \"11. Branch execution based on 'Connection type' (sType) property (Simple, Simple L, Ladder, 3 studs).\",\n    \"12. Execute Sheathing Logic: If 'Cut sheeting on female wall' (sCutSh) is Yes, calculate and apply cuts/debris removal to sheets.\",\n    \"13. Finalize: Set ExecutionMode to 1, save connection code to Map, and generate display graphics.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Connection Type (sType) selection\",\n      \"path1\": {\n        \"name\": \"|Simple| or |Simple L|\",\n        \"steps\": [\n          \"Calculate blocking geometry along the skewed angle.\",\n          \"Loop to generate Vertical Timbers/Plates (VTPs).\",\n          \"Apply 'Lap VTP's' logic (overlap vs butt joint).\",\n          \"Insert GenBeams for the created blocking and studs.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"|Ladder|\",\n        \"steps\": [\n          \"Calculate position and rotation for the ladder.\",\n          \"Insert a sub-instance of 'GE_WDET_AUTOLADDER' TSL.\",\n          \"Pass current properties (material, name, gaps) to the sub-instance.\"\n        ]\n      },\n      \"path3\": {\n        \"name\": \"3 |studs|\",\n        \"steps\": [\n          \"Calculate geometry for a specific 3-stud reinforcement pattern.\",\n          \"Insert GenBeams for the studs.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Lap VTP's (sLapVTP) property\",\n      \"path1\": {\n        \"name\": \"Yes\",\n        \"steps\": [\n          \"Calculate VTP lengths to overlap at the connection.\",\n          \"Adjust geometry for lapped joints.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"No\",\n        \"steps\": [\n          \"Calculate VTP lengths to butt against each other.\",\n          \"Apply 'End gap' (dEndGapVTP) to shorten members.\"\n        ]\n      }\n    },\n    {\n      \"condition\": \"Cut sheeting on female wall (sCutSh) property\",\n      \"path1\": {\n        \"name\": \"Yes\",\n        \"steps\": [\n          \"Identify and erase useless sheeting debris on the female wall using a bounding body.\",\n          \"Calculate cut lines based on 'Sheeting limits' (dSheetingLimits).\",\n          \"Apply Cut tools to Female Wall sheets at contact and projected points.\",\n          \"Apply Cut tools to Male Wall sheets at contact and projected points.\"\n        ]\n      },\n      \"path2\": {\n        \"name\": \"No\",\n        \"steps\": [\n          \"Skip sheeting debris removal.\",\n          \"Skip sheathing cut operations (preserves existing sheeting).\"\n        ]\n      }\n    }\n  ],\n  \"validationRules\": [\n    {\n      \"check\": \"Entity Count and Type\",\n      \"errorMessage\": \"Script erases silently if count != 2 or cast to ElementWall fails.\",\n      \"recovery\": \"Select exactly 2 ElementWall entities.\"\n    },\n    {\n      \"check\": \"Duplicate Connection\",\n      \"errorMessage\": \"Script erases silently if existing TSL found with same connection code.\",\n      \"recovery\": \"Delete the existing connection instance before inserting a new one.\"\n    },\n    {\n      \"check\": \"Physical Connection\",\n      \"errorMessage\": \"ERROR: Selected walls are not in contact\",\n      \"recovery\": \"Ensure the walls touch or overlap in the model.\"\n    },\n    {\n      \"check\": \"Wall Angle\",\n      \"errorMessage\": \"ERROR: Walls cannot be perpendicular or parallel\",\n      \"recovery\": \"Use this script only for skewed (angled) non-90 degree connections.\"\n    },\n    {\n      \"check\": \"Skewed T-Joint Topology\",\n      \"errorMessage\": \"ERROR: This is not a skewed connection or the connection is not cleaned up, cannot apply this tsl on this type of connection\",\n      \"recovery\": \"Ensure walls form a clean T-junction (one wall ending into the side of the other) and wall outlines intersect at exactly 2 points.\"\n    }\n  ],\n  \"postInsertionActions\": [\n    {\n      \"action\": \"Edit Connection Properties\",\n      \"how\": \"Properties Palette (OPM)\",\n      \"effect\": \"Modifying 'Connection type', 'Sheeting limits', 'Lap VTP's', or 'End gap' triggers an immediate recalculation (ExecutionMode 1), updating the geometry, blocking type, and cuts.\"\n    },\n    {\n      \"action\": \"Modify Source Walls\",\n      \"how\": \"Grip edits or Move commands on the ElementWalls\",\n      \"effect\": \"Since the TSL is assigned to the element groups, moving walls updates the connection geometry automatically on recalculation.\"\n    },\n    {\n      \"action"
      },
      "tokens_used": 12920,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALLS_SKEWED_TEE_CONNECTION.mcr\n\n## Overview\nThis script automates the creation of structural reinforcement (such as blocking, studs, or ladders) and sheathing cuts for skewed (angled) T-connections between two timber walls. It handles non-90-degree intersections by generating custom geometry tailored to the specific angle of the walls.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be inserted in the 3D model where the walls exist. |\n| Paper Space | No | Not intended for 2D drawings. |\n| Shop Drawing | No | Does not generate 2D views directly. |\n\n## Prerequisites\n- **Required Entities**: Two `ElementWall` entities.\n- **Configuration**: The two walls must physically touch or overlap.\n- **Geometry**: The walls must form a skewed intersection (neither parallel nor perpendicular/90°).\n- **Context**: Walls must be in Model Space.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT`\nAction: Browse to and select `GE_WALLS_SKEWED_TEE_CONNECTION.mcr`.\n\n### Step 2: Configure Initial Properties\n**Dialog**: Properties Palette (OPM)\nAction: Upon insertion, a dialog will appear (only once). You can set the connection type, material, and gaps here or modify them later in the Properties Palette.\n\n### Step 3: Select Walls\n```\nCommand Line: Select 2 angled elements\nAction: Click on the two walls that form the skewed T-junction.\n```\n\n### Step 4: Validation\nAction: The script checks if the walls are connected and if the angle is valid.\n- **Note**: If the walls are perpendicular (90°), parallel, or not touching, the script will erase itself or display an error on the command line.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Connection type | dropdown | Simple | Determines the reinforcement style: **Simple** (blocking), **Simple L**, **Ladder** (inserts sub-assembly), or **3 studs**. |\n| Sheeting limits | number | 3.175 mm | The distance from the structural intersection where the wall sheathing is cut or stopped. |\n| Beam color | number | 3 | The color index used to display the new structural elements in the model. |\n| Lap VTP's | dropdown | No | If **Yes**, vertical timber/plate members overlap at the connection. If **No**, they butt against each other. |\n| End gap (VTP) | number | 3.175 mm | Clearance distance at the ends of Vertical Timber/Plate members. |\n| Side gap (VTP) | number | 3.175 mm | Clearance distance along the sides of Vertical Timber/Plate members. |\n| End gap (BtmP, TP) | number | 0 | Clearance distance at the ends of Bottom and Top plates generated at the connection. |\n| **All new beams info** | **Header** | | *Section for new beam attributes* |\n| Name | text | SYP #2 2x4 | The commercial name or size (e.g., 2x4) of the lumber stock used for new elements. |\n| Material | text | SYP | The material species designation (e.g., SPF, SYP). |\n| Grade | text | #2 | The structural grade of the lumber (e.g., #2, SS). |\n| Cut sheeting on female wall | dropdown | Yes | If **Yes**, automatically cuts the sheathing on the wall being intersected (female wall) to fit the connection. |\n\n## Right-Click Menu Options\nNo custom context menu options are defined for this script. Use the standard AutoCAD Properties Palette to modify parameters.\n\n## Settings Files\nNo external settings files are required for this script.\n\n## Tips\n- **Skewed Only**: This script is specifically designed for angles other than 90 degrees. Do not use it for standard orthogonal corners.\n- **Ladder Option**: If you select **Ladder** as the connection type, the script automatically inserts a sub-instance of `GE_WDET_AUTOLADDER` to handle the detailing.\n- **Visual Feedback**: If the script disappears immediately after selection, check the command line for errors. This usually means the walls were perpendicular or not physically touching.\n- **Dynamic Updates**: After insertion, you can change the `Connection type` in the Properties Palette to instantly switch between blocking styles without re-inserting.\n\n## FAQ\n- **Q: Why did the script delete itself after I selected the walls?**\n  **A**: The script performs strict validation. It likely detected that the walls were perpendicular (90°), parallel, or not forming a valid T-junction. Ensure the walls intersect at a skewed angle and are touching.\n- **Q: Can I use this to connect walls that meet at a 45-degree angle?**\n  **A**: Yes, this is the intended use case. It calculates geometry based on the exact skew angle.\n- **Q: How do I prevent the script from cutting my sheathing?**\n  **A**: Set the `Cut sheeting on female wall` property to **No** in the Properties Palette."
      },
      "tokens_used": 7923,
      "error": null
    }
  }
}