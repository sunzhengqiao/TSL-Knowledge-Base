{
  "filename": "HSB_E-InstallationPoint.mcr",
  "status": "completed",
  "total_tokens": 60092,
  "processing_time": 615.2632591724396,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9360,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script performs insertion logic (`_bOnInsert` flag), constructs 3D geometry (`Body`), and applies tooling directly to an `Element` instance using methods like `el.addOperation`, `el.addDrill`, and `el.addFreeProfile`. It writes data to `_Map` (e.g., 'DimInfo', 'hsb_DxfOutput') for downstream consumption, which is characteristic of model-space generation scripts. No references to `_Viewport`, `#Type`, or `sd_` prefixes were found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 1,
          "requiredSpace": "3D Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 6812,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [\n      {\n        \"step\": 1,\n        \"function\": \"getGenBeam\",\n        \"promptOriginal\": T(\"Select element\"),\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      },\n      {\n        \"step\": 2,\n        \"function\": \"getPoint\",\n        \"promptOriginal\": T(\"Select a point on the element\"),\n        \"condition\": \"_bOnInsert\",\n        \"required\": true\n      }\n    ],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 1,\n      \"variable\": \"sObject\",\n      \"type\": \"PropString\",\n      \"displayName\": T(\"|Object|\"),\n      \"defaultValue\": T(\"|Outlet|\"),\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|Outlet|\"),\n        T(\"|Double outlet|\"),\n        T(\"|Switch|\"),\n        T(\"|Double switch|\"),\n        T(\"|Double-pole switch|\"),\n        T(\"|Pull switch|\"),\n        T(\"|Double-pole pull switch|\"),\n        T(\"|Light connection|\"),\n        T(\"|Water|\"),\n        T(\"|Ground|\"),\n        T(\"|Additional open|\"),\n        T(\"|Additional closed|\"),\n        T(\"|Custom|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sDescription\",\n      \"type\": \"PropString\",\n      \"displayName\": T(\"|Description|\"),\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"nSide\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Side|\"),\n      \"defaultValue\": 1,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|Front|\"),\n        T(\"|Back|\"),\n        T(\"|Front and Back|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"nOrientation\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Orientation|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|Horizontal|\"),\n        T(\"|Vertical|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"nArrowFlipped\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Flip|\"),\n      \"defaultValue\": 1,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"dBoxSize\",\n      \"type\": \"PropDouble\",\n      \"displayName\": T(\"|Box size|\"),\n      \"defaultValue\": 86.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"nNrOfBoxes\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Number of boxes|\"),\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 8,\n      \"variable\": \"nNrOfSymbols\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Number of symbols|\"),\n      \"defaultValue\": 1,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"bApplyAllZones\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Apply all zones|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"bAutoInsertTubes\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Auto insert tubes|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|Tubes|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"nExtendTubes\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Extend tubes|\"),\n      \"defaultValue\": 1,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|Tubes|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 12,\n      \"variable\": \"sOverruleDescription\",\n      \"type\": \"PropString\",\n      \"displayName\": T(\"|Overrule description|\"),\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"bReverseToolpath\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Reverse toolpath|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|Tooling|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"bUseCustomBlock\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Use custom block|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"sCustomBlockName\",\n      \"type\": \"PropString\",\n      \"displayName\": T(\"|Custom block name|\"),\n      \"defaultValue\": \"\",\n      \"inputType\": \"text\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"nBeamcutBehind\",\n      \"type\": \"PropInt\",\n      \"displayName\": T(\"|Beamcut behind|\"),\n      \"defaultValue\": 0,\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        T(\"|No|\"),\n        T(\"|Yes|\")\n      ],\n      \"category\": T(\"|Tooling|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"dOffset\",\n      \"type\": \"PropDouble\",\n      \"displayName\": T(\"|Offset|\"),\n      \"defaultValue\": 0.0,\n      \"inputType\": \"number\",\n      \"options\": [],\n      \"category\": T(\"|General|\"),\n      \"description\": null\n    },\n    {\n      \"index\": 18,\n      \"variable\": \""
      },
      "tokens_used": 10091,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Inserts electrical or installation objects (outlets, switches, water connections) into timber wall elements, managing visual symbols, sheeting cutouts, and structural beam drilling.",
          "category": "Installation/Hardware",
          "typicalUseCase": "Placing electrical sockets or light switches in prefabricated wall panels, ensuring proper cutouts in the plasterboard/sheeting and drilling in the structural timber for cables."
        },
        "parameters": [
          {
            "name": "sObject",
            "technicalDefault": "|Outlet|",
            "businessMeaning": "The type of electrical or plumbing fixture being installed. Determines the symbol drawn and default properties.",
            "validRange": "Predefined list (Outlet, Switch, Water, etc.)",
            "unit": "Enum",
            "affectsOutput": "Sets the default number of boxes (`nNrOfBoxes`), the description code (A, B, C...), and the specific graphical symbol displayed in drawings."
          },
          {
            "name": "sDescription",
            "technicalDefault": "",
            "businessMeaning": "User-defined text label (e.g., 'Living Room', 'Kitchen') displayed next to the installation point in model views and drawings.",
            "validRange": "String text",
            "unit": "Text",
            "affectsOutput": "Updates the text label associated with the symbol in 2D drawings and DXF output."
          },
          {
            "name": "nSide",
            "technicalDefault": "1",
            "businessMeaning": "Specifies which face of the wall the installation is on. 'Front' is usually the outside or visible side, 'Back' is the interior or opposite side.",
            "validRange": "Front, Back, Front and Back",
            "unit": "Enum",
            "affectsOutput": "Determines which side of the element receives the symbol visualization and the tooling (cutouts/drills)."
          },
          {
            "name": "nOrientation",
            "technicalDefault": "0",
            "businessMeaning": "Rotates the installation symbol and cutout geometry.",
            "validRange": "Horizontal, Vertical",
            "unit": "Enum",
            "affectsOutput": "Rotates the symbol representation and the orientation of the rectangular cutout in the sheeting."
          },
          {
            "name": "nArrowFlipped",
            "technicalDefault": "1",
            "businessMeaning": "Mirrors the directional arrow of the symbol.",
            "validRange": "No, Yes",
            "unit": "Enum",
            "affectsOutput": "Flips the visual indicator of the symbol (e.g., making an outlet switch point left instead of right)."
          },
          {
            "name": "dBoxSize",
            "technicalDefault": "86.0",
            "businessMeaning": "The physical width of the installation box or back-box. Standard size is often 86mm (EU standard).",
            "validRange": "50.0 - 200.0",
            "unit": "mm",
            "affectsOutput": "Defines the size of the cutout in the sheeting and the spacing between multiple symbols."
          },
          {
            "name": "nNrOfBoxes",
            "technicalDefault": "1",
            "businessMeaning": "The number of gang units required (e.g., 2 for a double outlet).",
            "validRange": "1 - 5",
            "unit": "Count",
            "affectsOutput": "Widens the cutout geometry and spaces multiple symbols horizontally."
          },
          {
            "name": "nNrOfSymbols",
            "technicalDefault": "1",
            "businessMeaning": "The quantity of symbols to display. Useful if a single physical box contains multiple distinct switches to be labeled.",
            "validRange": "1+",
            "unit": "Count",
            "affectsOutput": "Controls how many graphical icons are drawn for the instance."
          },
          {
            "name": "bApplyAllZones",
            "technicalDefault": "0",
            "businessMeaning": "Forces the tooling (drilling/cutting) to pass through all layers of the wall element, regardless of depth calculations.",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "If Yes, extends the drill/cut operation through every material layer (zone) of the element."
          },
          {
            "name": "bAutoInsertTubes",
            "technicalDefault": "0",
            "businessMeaning": "Automatically generates conduit/tube entities from the installation point for routing cables.",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "If Yes, creates separate 'Tube' entities in the model connected to this point."
          },
          {
            "name": "nExtendTubes",
            "technicalDefault": "1",
            "businessMeaning": "Controls whether the auto-inserted tubes are extended to join with the main floor/ceiling runs.",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "Modifies the length of the generated tubes to reach the next structural connection point."
          },
          {
            "name": "sOverruleDescription",
            "technicalDefault": "",
            "businessMeaning": "An optional description that overrides the main description if populated. Often used for BOM exports or specific naming conventions without changing the on-screen label.",
            "validRange": "String text",
            "unit": "Text",
            "affectsOutput": "Replaces `sDescription` in data exports (BOM/Maps) and on-screen display."
          },
          {
            "name": "bReverseToolpath",
            "technicalDefault": "0",
            "businessMeaning": "Changes the CNC milling direction (Clockwise vs Counter-Clockwise).",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "Alters the machine code path direction for the cutout to optimize cut quality or tool wear."
          },
          {
            "name": "bUseCustomBlock",
            "technicalDefault": "0",
            "businessMeaning": "Enables the use of a specific CAD block definition to define the shape of the cutout instead of a standard rectangle.",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "Switches the geometry generation logic from a parametric box to an imported block profile."
          },
          {
            "name": "sCustomBlockName",
            "technicalDefault": "",
            "businessMeaning": "The name of the AutoCAD block to use for the custom cutout shape.",
            "validRange": "Valid Block Name",
            "unit": "Text",
            "affectsOutput": "Defines the geometry profile used for the cutout when `bUseCustomBlock` is Yes."
          },
          {
            "name": "nBeamcutBehind",
            "technicalDefault": "0",
            "businessMeaning": "Creates a through-cut (slot or hole) in the structural timber beam behind the sheeting.",
            "validRange": "No, Yes",
            "unit": "Boolean",
            "affectsOutput": "Adds a `BeamCut` operation to the structural element to allow cables to pass through the timber."
          },
          {
            "name": "dOffset",
            "technicalDefault": "0.0",
            "businessMeaning": "A linear shift applied to the insertion point or geometry.",
            "validRange": "Any",
            "unit": "mm",
            "affectsOutput": "Moves the position of the symbol and cutout relative to the clicked point."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sObject changed",
            "effect": "Updates nNrOfBoxes and sDescription to match defaults for the selected object type.",
            "cascade": [
              "nNrOfBoxes",
              "sDescription"
            ]
          },
          {
            "trigger": "bUseCustomBlock set to Yes",
            "effect": "Requires sCustomBlockName to define the shape.",
            "cascade": [
              "sCustomBlockName"
            ]
          },
          {
            "trigger": "bAutoInsertTubes set to No",
            "effect": "nExtendTubes becomes irrelevant as no tubes are generated.",
            "cascade": [
              "nExtendTubes"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Symbol",
            "description": "2D representation of the electrical device (switch, outlet, etc.) for drawings and model space.",
            "appliedTo": "Element"
          },
          {
            "type": "Drill",
            "description": "Circular hole through the sheeting and/or timber.",
            "appliedTo": "Element"
          },
          {
            "type": "FreeProfile",
            "description": "Complex shape cutout (usually rectangular for boxes) in the sheeting.",
            "appliedTo": "Element"
          },
          {
            "type": "BeamCut",
            "description": "Through-cut in the structural timber to allow cable passage.",
            "appliedTo": "Element"
          },
          {
            "type": "Tube",
            "description": "Conduit for wiring, generated if auto-insert is enabled.",
            "appliedTo": "Model (New Entity)"
          },
          {
            "type": "MapData",
            "description": "Exports information like height, width, and description for labeling (hsbMake/Layouts) and BOM.",
            "appliedTo": "_Map"
          }
        ]
      },
      "tokens_used": 11444,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Launch Script: User starts HSB_E-InstallationPoint from palette or command line.",
          "2. Select Element: Script prompts 'Select element'. User selects a Wall or Floor element.",
          "3. Select Point: Script prompts 'Select a point on the element'. User picks insertion location.",
          "4. Set Insertion Data: Script calculates local coordinates (Y-height) and stores insertion point (_Pt0).",
          "5. Load Properties: Script reads current OPM values (Object type, Side, Box size, etc.).",
          "6. Determine Sides: Script evaluates 'nSide' property to determine if processing Front only, Back only, or both.",
          "7. Loop Through Sides: For each applicable side, perform the following sub-steps:",
          "   a. Calculate Cutout Geometry: Define width/height based on dBoxSize and nNrOfBoxes.",
          "   b. Check Intersection: Verify if the cutout body intersects with the Element's envelope.",
          "   c. Apply Tooling (If Intersecting):",
          "      - If 'Use custom block' is Yes -> Import block profile.",
          "      - If No -> Create parametric rectangular body.",
          "      - Add Drill or FreeProfile to the element (Sheathing).",
          "      - If 'Beamcut behind' is Yes -> Add Slot/Drill to structural beam.",
          "   d. Draw Symbol: Generate 2D polylines/text for the specific object type (Switch, Outlet, etc.).",
          "   e. Draw Height Info: Display height dimension and description text.",
          "8. Tube Generation: If 'Auto insert tubes' is Yes, create or update tube entities connected to the point.",
          "9. Data Export: Write geometry to DXF output maps and BOM data to DimInfo.",
          "10. Finish: Update instance color and finalize."
        ],
        "conditionalBranches": [
          {
            "condition": "User selection of 'Side' (nSide) property",
            "path1": {
              "name": "Front or Back Only",
              "steps": [
                "Process tooling and symbols only for the selected single side index (0 or 1)."
              ]
            },
            "path2": {
              "name": "Front and Back",
              "steps": [
                "Execute processing loop twice.",
                "Generate tooling/symbols for Side 0 (Front).",
                "Generate tooling/symbols for Side 1 (Back)."
              ]
            }
          },
          {
            "condition": "Intersection Check (el.getEnvelope().intersect(bDrillBody))",
            "path1": {
              "name": "Intersection Found",
              "steps": [
                "Apply Drill or FreeProfile to the element.",
                "Apply BeamCut if enabled."
              ]
            },
            "path2": {
              "name": "No Intersection",
              "steps": [
                "Skip tooling generation for this specific side/zone.",
                "May still draw visual symbols depending on script configuration."
              ]
            }
          },
          {
            "condition": "Custom Block Usage (bUseCustomBlock)",
            "path1": {
              "name": "Yes",
              "steps": [
                "Search for block defined in 'sCustomBlockName'.",
                "Use block geometry to define the cutout profile."
              ]
            },
            "path2": {
              "name": "No",
              "steps": [
                "Calculate standard rectangular box size (dBoxSize * nNrOfBoxes).",
                "Generate parametric cutout."
              ]
            }
          },
          {
            "condition": "Object Type (sObject)",
            "path1": {
              "name": "Standard Electrical (Outlet/Switch)",
              "steps": [
                "Draw specific graphical icons (arcs/lines).",
                "Set default description codes (A, B, C...)."
              ]
            },
            "path2": {
              "name": "Services (Water/Ground)",
              "steps": [
                "Draw specialized symbols (e.g., 'W' or 'A' text).",
                "Update description codes accordingly."
              ]
            },
            "path3": {
              "name": "Custom",
              "steps": [
                "Use generic/default symbol geometry.",
                "Allow free text description."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "User cancels selection or selects non-Element entity.",
            "recovery": "Script exits; user must restart and select a valid hsbCAD Element."
          },
          {
            "check": "Point Selection",
            "errorMessage": "Point selected is not on the Element or outside valid bounds.",
            "recovery": "Script re-prompts for point or exits; user must pick a point on the element's surface."
          },
          {
            "check": "Cutout Intersection",
            "errorMessage": "Calculated box body does not touch the element's physical envelope.",
            "recovery": "Tooling is not applied to the element (no drill/cutout created), but script continues with visualization."
          },
          {
            "check": "Custom Block Existence",
            "errorMessage": "sCustomBlockName is specified but block not found in drawing.",
            "recovery": "Script falls back to standard rectangular cutout or generates error log."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Geometry",
            "how": "Properties Palette (OPM)",
            "effect": "Changing 'Box size', 'Nr of boxes', or 'Orientation' updates the cutout size and tooling immediately."
          },
          {
            "action": "Change Device Type",
            "how": "Properties Palette (OPM) -> 'Object' dropdown",
            "effect": "Updates the 2D symbol icon and resets default description codes."
          },
          {
            "action": "Relocate",
            "how": "Grip Point Drag",
            "effect": "Moving the insertion point grip updates the position of the cutout, symbol, and regenerates associated tubes."
          },
          {
            "action": "Toggle Tooling",
            "how": "Properties Palette (OPM) -> 'Beamcut behind' or 'Apply all zones'",
            "effect": "Adds or removes structural operations/drills from the element."
          },
          {
            "action": "Manage Tubes",
            "how": "Right-click Context Menu -> 'Reset Tube Properties'",
            "effect": "Forces associated tube entities to re-read properties from this Installation Point."
          },
          {
            "action": "Delete",
            "how": "Right-click Context Menu -> 'Delete'",
            "effect": "Removes the installation point, its visual symbols, and all associated tooling/drills from the element."
          }
        ]
      },
      "tokens_used": 13354,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_E-InstallationPoint.mcr\n\n## Overview\nThis script inserts electrical installation points (such as outlets, switches, and water connections) into timber wall elements. It automatically generates the required 2D symbols for drawings, cutouts for sheeting, and drilling operations for structural timber based on your specifications.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in the 3D model on valid wall or floor elements. |\n| Paper Space | No | Not intended for layout views. |\n| Shop Drawing | No | Operations are applied to the model, not drawing views. |\n\n## Prerequisites\n- **Required Entities**: At least one hsbCAD Element (Wall or Floor).\n- **Minimum Beam Count**: 1\n- **Required Settings**: None specific (uses internal catalogs).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Browse and select `HSB_E-InstallationPoint.mcr`.\n\n### Step 2: Select Element\n```\nCommand Line: Select element\nAction: Click on the timber wall or floor element where you want to place the installation.\n```\n\n### Step 3: Select Insertion Point\n```\nCommand Line: Select a point on the element\nAction: Click the specific location on the element face where the outlet/switch should be located.\n```\n\n### Step 4: Configure Properties\nAfter insertion, the script generates the standard symbol and cutout. Select the newly created instance and open the **Properties Palette** (Ctrl+1) to adjust the object type, box dimensions, or side settings.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Object | dropdown | Outlet | Select the type of fixture (e.g., Switch, Water, Light connection). This updates the symbol and default settings. |\n| Description | text | | User-defined label (e.g., \"Kitchen\") displayed next to the symbol. |\n| Side | dropdown | Front | Choose which side of the wall the installation applies to: Front, Back, or Front and Back. |\n| Orientation | dropdown | Horizontal | Rotates the symbol and cutout (Horizontal or Vertical). |\n| Flip | dropdown | Yes | Mirrors the direction of the arrow on the symbol. |\n| Box size | number | 86.0 | The physical width of the installation box in mm (e.g., 86mm for standard European boxes). |\n| Number of boxes | number | 1 | The gang size (e.g., 2 for a double socket). Increases the cutout width. |\n| Number of symbols | number | 1 | The quantity of graphical icons to display. |\n| Apply all zones | dropdown | No | If Yes, forces tooling to pass through all material layers of the element. |\n| Auto insert tubes | dropdown | No | If Yes, automatically generates conduit/tube entities for cable routing. |\n| Extend tubes | dropdown | Yes | If Yes, extends the generated tubes to connect with the main floor/ceiling runs. |\n| Overrule description | text | | An alternative description used for data exports/BOM without changing the on-screen label. |\n| Reverse toolpath | dropdown | No | Changes the CNC milling direction (Clockwise vs Counter-Clockwise). |\n| Use custom block | dropdown | No | Enables the use of a specific CAD block to define the cutout shape instead of a rectangle. |\n| Custom block name | text | | The name of the AutoCAD block to use if 'Use custom block' is Yes. |\n| Beamcut behind | dropdown | No | If Yes, creates a through-cut or slot in the structural timber behind the sheeting. |\n| Offset | number | 0.0 | Shifts the position of the symbol and cutout relative to the clicked point. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Reset Tube Properties | Forces associated tube entities (if auto-generated) to re-read their properties from this installation point. |\n\n## Settings Files\n- **Filename**: None specified.\n- **Location**: N/A\n- **Purpose**: This script relies on internal geometry logic and standard AutoCAD blocks (if custom blocks are used).\n\n## Tips\n- **Double Sockets**: Set **Number of boxes** to `2` to create the correct wide cutout for a double gang box without creating two separate instances.\n- **Cable Routing**: Enable **Auto insert tubes** to quickly visualize conduit paths. Use **Reset Tube Properties** from the right-click menu if you move the point after tubes are created.\n- **Deep Walls**: If your installation is deep within a sandwich element, enable **Apply all zones** to ensure the drill passes through every layer.\n- **CNC Optimization**: If you notice rough edges on milled cutouts, try toggling **Reverse toolpath** to alter the cut direction.\n\n## FAQ\n- **Q: The symbol appeared, but there is no hole in my timber.**\n  - A: Check the **Beamcut behind** property. It defaults to `No`. Set it to `Yes` to cut through the structural beam.\n- **Q: How do I place a switch and an outlet at the exact same spot?**\n  - A: You can either insert two separate Installation Points, or increase the **Number of symbols** and manually edit the Description to represent multiple items, though creating separate instances is usually recommended for clarity.\n- **Q: Can I use a non-rectangular shape for the cutout?**\n  - A: Yes. Set **Use custom block** to `Yes` and enter the name of a block defined in your drawing that matches the desired profile."
      },
      "tokens_used": 9031,
      "error": null
    }
  }
}