{
  "filename": "hsb_ExportLoad.mcr",
  "status": "completed",
  "total_tokens": 25663,
  "processing_time": 440.4182527065277,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3020,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses getPoint() for 3D coordinate input and creates PLine geometry based on spatial points. There is no usage of _Viewport, #Type E, or sd_ prefixes."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D environment)",
          "requiredSettings": []
        }
      },
      "tokens_used": 1819,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "\\nSelect a point",
              "condition": "nType==0 (Point load)",
              "required": true
            },
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "\\nSelect start point",
              "condition": "nType==1 (Line load)",
              "required": true
            },
            {
              "step": 2,
              "function": "getPoint",
              "promptOriginal": "\\nSelect end point",
              "condition": "nType==1 (Line load)",
              "required": true
            },
            {
              "step": 1,
              "function": "getPoint",
              "promptOriginal": "\\nSelect start point",
              "condition": "nType==2 (Area load)",
              "required": true
            },
            {
              "step": 2,
              "function": "PrPoint",
              "promptOriginal": "\\nSelect next point",
              "condition": "nType==2 (Area load loop)",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Unknown/Custom",
            "trigger": "On Insert if _kExecuteKey is empty",
            "title": "null",
            "dataSource": "showDialog()",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sType",
            "type": "PropString",
            "displayName": "|Load Type|",
            "defaultValue": "|Point|",
            "inputType": "dropdown",
            "options": [
              "|Point|",
              "|Line|",
              "|Area|"
            ],
            "category": "null",
            "description": "null"
          },
          {
            "index": 0,
            "variable": "dMagnitude",
            "type": "PropDouble",
            "displayName": "|Load Magnitude|",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": "null",
            "description": "null"
          },
          {
            "index": 1,
            "variable": "sUnits",
            "type": "PropString",
            "displayName": "|Load Units|",
            "defaultValue": "kg/sq m",
            "inputType": "dropdown",
            "options": [
              "kg/sq mm",
              "kg/sq m",
              "Ibs/sq in",
              "Ibs/sq ft"
            ],
            "category": "null",
            "description": "null"
          },
          {
            "index": 0,
            "variable": "nColor",
            "type": "PropInt",
            "displayName": "Color",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": "null",
            "description": "null"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3522,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Graphically defines structural engineering loads (point, line, or area) within the 3D model and packages the data for export to analysis software.",
          "category": "Data Interface/Structural Analysis",
          "typicalUseCase": "An engineer or designer marks specific areas of a timber structure (e.g., a roof surface for snow load or a wall line for wind load) to ensure accurate calculations are generated when exporting to external tools."
        },
        "parameters": [
          {
            "name": "sType",
            "technicalDefault": "|Point|",
            "businessMeaning": "Defines the geometric distribution of the load: whether the force applies to a single precise location, along a linear element (like a beam), or distributed over a surface (like a floor or roof).",
            "validRange": "Point, Line, Area",
            "unit": "N/A",
            "affectsOutput": "Determines the user input workflow (how many points are requested) and the geometry generated (an 'X' cross for points, a line segment for lines, or a closed polyline for areas)."
          },
          {
            "name": "dMagnitude",
            "technicalDefault": "1",
            "businessMeaning": "The numerical value of the force or pressure being applied to the structure.",
            "validRange": "Dependent on Units (e.g., 0.0 to 10000.0)",
            "unit": "Variable (defined by sUnits)",
            "affectsOutput": "Updates the 'Magnitude' field in the export data map. Does not alter the visual geometry size, only the data value."
          },
          {
            "name": "sUnits",
            "technicalDefault": "kg/sq m",
            "businessMeaning": "Specifies the measurement system for the load magnitude, ensuring compatibility with the target structural analysis software.",
            "validRange": "kg/sq mm, kg/sq m, Ibs/sq in, Ibs/sq ft",
            "unit": "N/A",
            "affectsOutput": "Provides the scale context for the dMagnitude value in the export data map."
          },
          {
            "name": "nColor",
            "technicalDefault": "1",
            "businessMeaning": "The visual color used to display the load marker in the CAD model, typically used to distinguish between different load cases (e.g., Red for Dead Load, Blue for Live Load).",
            "validRange": "0 - 255 (AutoCAD Color Index)",
            "unit": "ACI Index",
            "affectsOutput": "Changes the display color of the drawn lines/crosshairs in the model view. Does not affect export data."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Changing sType",
            "effect": "Changes the number of coordinate points required during insertion and the resulting shape of the drawn geometry.",
            "cascade": [
              "_PtG (GripPoints)",
              "ptAll (Geometry Points)"
            ]
          },
          {
            "trigger": "Changing sUnits",
            "effect": "Alters the real-world interpretation of the dMagnitude value.",
            "cascade": [
              "dMagnitude"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Data Map / Visualization Geometry",
            "description": "Creates a visual indicator (Polyline or Crosshair) in the model space and populates a data map containing the Load Type, Magnitude, Units, and Coordinate Points for export.",
            "appliedTo": "Model Space (Visual) and TSL Instance Map (Data)"
          }
        ]
      },
      "tokens_used": 5220,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"workflowDiagram\": [\n    \"1. Script Initialization: Set units to mm and declare properties (sType, dMagnitude, sUnits, nColor).\",\n    \"2. Database Event: If database is created, load property defaults from catalog based on execution key.\",\n    \"3. Insertion Check: Enter insertion block if _bOnInsert is true.\",\n    \"4. Duplicate Prevention: Check insertCycleCount(); if > 1, erase instance and exit.\",\n    \"5. Configuration: If no execution key is present (manual run), show initial dialog (showDialog) to set properties.\",\n    \"6. Type Determination: Parse 'sType' property to determine integer nType (0=Point, 1=Line, 2=Area).\",\n    \"7. Input Collection Branch (Based on nType):\",\n    \"   - [Point] Prompt user for single point location.\",\n    \"   - [Line] Prompt user for Start Point, then End Point.\",\n    \"   - [Area] Prompt user for Start Point, then loop for subsequent points (dynamic feedback) until cancelled.\",\n    \"8. Save Input: Store coordinates in _Pt0 and _PtG array.\",\n    \"9. Exit Insertion: Return from script to finalize placement.\",\n    \"10. Recalculation/Display Phase:\",\n    \"11. Lock Property: Set sType to Read-Only to prevent type changes after insertion.\",\n    \"12. Geometry Generation: Construct visual elements (Crosshair for Point, Line for Line, Closed PLine for Area) using _Pt0 and _PtG.\",\n    \"13. Data Export: Compile Type, Magnitude, Units, and Coordinate Array into the 'Load' Map.\",\n    \"14. Render: Draw geometry with the specified nColor.\"\n  ],\n  \"conditionalBranches\": [\n    {\n      \"condition\": \"Load Type (sType) Selection"
      },
      "tokens_used": 7242,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_ExportLoad.mcr\n\n## Overview\nGraphically defines structural engineering loads (Point, Line, or Area) within the 3D model and packages the data for export to structural analysis software.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script operates in the 3D model environment. |\n| Paper Space | No | Not supported in layout views. |\n| Shop Drawing | No | Not applicable for 2D drawings. |\n\n## Prerequisites\n- **Required entities:** None.\n- **Minimum beam count:** 0.\n- **Required settings files:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_ExportLoad.mcr`\n\n### Step 2: Configure Load\n**Action:** Upon running the script, a dialog will appear.\n- **Load Type:** Select **Point**, **Line**, or **Area**.\n- **Load Magnitude:** Enter the force value.\n- **Load Units:** Select the unit of measurement (e.g., kg/sq m).\n- **Color:** Select a display color (default is Red).\n- Click **OK** to proceed.\n\n### Step 3: Define Geometry\nThe command line prompts will vary based on the Load Type selected in Step 2:\n\n**If Type = Point:**\n```\nCommand Line: Select a point\nAction: Click in the model to place the point load.\n```\n\n**If Type = Line:**\n```\nCommand Line: Select start point\nAction: Click the start location of the load.\nCommand Line: Select end point\nAction: Click the end location of the load.\n```\n\n**If Type = Area:**\n```\nCommand Line: Select start point\nAction: Click the first corner of the area.\nCommand Line: Select next point\nAction: Click subsequent corners to define the perimeter.\nAction: Press Enter or Esc to close the shape and finish.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Load Type | dropdown | Point | Determines the shape of the load (Point, Line, or Area). **Note:** Becomes read-only after insertion. |\n| Load Magnitude | number | 1 | The numerical value of the force or pressure. |\n| Load Units | dropdown | kg/sq m | The unit of measurement for the magnitude (e.g., kg/sq mm, Ibs/sq ft). |\n| Color | number | 1 | The AutoCAD color index (ACI) used to draw the load marker in the model. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu options are available for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Visual Distinction:** Use the **Color** property to differentiate between different load cases (e.g., Red for Dead Load, Blue for Live Load) directly in the model view.\n- **Type Locking:** Once the load is inserted, the **Load Type** cannot be changed (e.g., you cannot change a Point load to a Line load). You must delete the instance and re-insert it to change the type.\n- **Area Closure:** For **Area** loads, ensure your pick points form a logical loop. The script will automatically close the polyline connecting the last point to the first.\n\n## FAQ\n- **Q: Why can't I change the Load Type in the properties palette after inserting?**\n  - A: The script locks the Load Type property upon insertion to maintain data integrity for the export map. To change the type, erase the current instance and insert a new one.\n- **Q: Does this script alter the physical timber geometry?**\n  - A: No. This script creates visual markers (lines/polylines) and data maps for structural analysis calculations; it does not cut or modify beams.\n- **Q: How do I export the data?**\n  - A: This script prepares the data map. You must use the relevant hsbCAD export function or a subsequent script that reads the \"Load\" map to transfer data to your analysis software."
      },
      "tokens_used": 4840,
      "error": null
    }
  }
}