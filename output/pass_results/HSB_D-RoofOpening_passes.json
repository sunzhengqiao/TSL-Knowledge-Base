{
  "filename": "HSB_D-RoofOpening.mcr",
  "status": "completed",
  "total_tokens": 58729,
  "processing_time": 271.8715829849243,
  "passes": {
    "1": {
      "success": true,
      "data": {},
      "tokens_used": 9248,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "PaperSpace",
          "supportsPaperSpace": true,
          "isShopDrawingScript": true,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses CoordSys ms2ps = getCoordSys(Index, _kViewport) to calculate Model to Paper Space transformation. It draws into specific drawing planes (dpFront, dpSide, dpTop) using DrawingPlane API. The history log mentions 'separated displays for every vector view'."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Beam",
            "TslInst"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Must be run within a Shop Drawing (Viewport) context where Model Space to Paper Space transformation is defined.",
          "requiredSettings": []
        }
      },
      "tokens_used": 7509,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"commandLine\": {\n    \"insertionFlow\": [],\n    \"keywordOptions\": []\n  },\n  \"dialogs\": [],\n  \"opmProperties\": [\n    {\n      \"index\": 1,\n      \"variable\": \"sSectionName\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Section tsl name\",\n      \"inputType\": \"dropdown\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 2,\n      \"variable\": \"sFilterBC\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams with beamcode\",\n      \"inputType\": \"text\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 3,\n      \"variable\": \"sFilterLabel\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with label\",\n      \"inputType\": \"text\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 4,\n      \"variable\": \"sFilterMaterial\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with material\",\n      \"inputType\": \"text\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 5,\n      \"variable\": \"sFilterHsbID\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter beams and sheets with hsbID\",\n      \"inputType\": \"text\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 6,\n      \"variable\": \"sFilterZone\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter zones\",\n      \"inputType\": \"text\",\n      \"category\": \"Filter\"\n    },\n    {\n      \"index\": 35,\n      \"variable\": \"openingFilterType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter type\",\n      \"defaultValue\": \"Exclude\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Include\",\n        \"Exclude\"\n      ],\n      \"category\": \"Opening\"\n    },\n    {\n      \"index\": 7,\n      \"variable\": \"sFilterOpening\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Filter openings with description\",\n      \"inputType\": \"text\",\n      \"category\": \"Opening\"\n    },\n    {\n      \"index\": 9,\n      \"variable\": \"sDimensionType\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension type\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Opening size\",\n        \"Cross\"\n      ],\n      \"category\": \"Dimension object\"\n    },\n    {\n      \"index\": 10,\n      \"variable\": \"sShowDescription\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Show description\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Dimension object\"\n    },\n    {\n      \"index\": 34,\n      \"variable\": \"sShowFrame\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Show frame\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Dimension object\"\n    },\n    {\n      \"index\": 11,\n      \"variable\": \"sNewLineChar\",\n      \"type\": \"PropString\",\n      \"displayName\": \"New line character\",\n      \"defaultValue\": \";\",\n      \"inputType\": \"text\",\n      \"description\": \"The description will be split on this character.Each part will be displayed on a new line.\",\n      \"category\": \"Dimension object\"\n    },\n    {\n      \"index\": 13,\n      \"variable\": \"sOrientation\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Orientation dimension line\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Horizontal\",\n        \"Vertical\"\n      ],\n      \"category\": \"Positioning\"\n    },\n    {\n      \"index\": 14,\n      \"variable\": \"sSideDimensionLine\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Side dimension line\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Left\",\n        \"Right\",\n        \"Center\"\n      ],\n      \"category\": \"Positioning\"\n    },\n    {\n      \"index\": 15,\n      \"variable\": \"sDimLinePerOpening\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Dimension line per opening\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Positioning\"\n    },\n    {\n      \"index\": 16,\n      \"variable\": \"sPositionReference\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Position reference\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Opening\",\n        \"Element\"\n      ],\n      \"category\": \"Positioning\"\n    },\n    {\n      \"index\": 17,\n      \"variable\": \"sUsePSUnits\",\n      \"type\": \"PropString\",\n      \"displayName\": \"Offset in paperspace units\",\n      \"defaultValue\": \"Yes\",\n      \"inputType\": \"dropdown\",\n      \"options\": [\n        \"Yes\",\n        \"No\"\n      ],\n      \"category\": \"Position"
      },
      "tokens_used": 9957,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n  \"scriptPurpose\": {\n    \"summary\": \"Automates the detailing and dimensioning of roof openings (skylights, dormers, penetrations) in 2D shop drawings.\",\n    \"category\": \"ShopDrawing\",\n    \"typicalUseCase\": \"Generating production drawings for roof panels or walls that require precise marking of opening sizes, locations relative to rafters, and identification labels across Front, Side, and Top views.\"\n  },\n  \"parameters\": [\n    {\n      \"name\": \"sSectionName\",\n      \"technicalDefault\": \" \",\n      \"businessMeaning\": \"Selects the specific Section View script (or layout) to apply these detailing settings to. Allows different opening styles for different drawing views.\",\n      \"validRange\": \"Any valid TSL script name present in the drawing\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Determines which viewport or drawing context the script processes.\"\n    },\n    {\n      \"name\": \"sFilterBC\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Filters structural elements (beams/sheets) based on their Beam Code. Only openings in elements matching this code are processed.\",\n      \"validRange\": \"Any text string (supports wildcards)\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Limits the scope of the script to specific structural zones or element types.\"\n    },\n    {\n      \"name\": \"openingFilterType\",\n      \"technicalDefault\": \"Exclude\",\n      \"businessMeaning\": \"Determines if the description filter acts as a whitelist (Include) or blacklist (Exclude).\",\n      \"validRange\": \"Include, Exclude\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Controls which specific openings are visible in the drawing.\"\n    },\n    {\n      \"name\": \"sFilterOpening\",\n      \"technicalDefault\": \"\",\n      \"businessMeaning\": \"Text filter to match against the opening's description or name (e.g., 'SKY' for skylights, 'VENT' for vents).\",\n      \"validRange\": \"Any text string\",\n      \"unit\": \"Text\",\n      \"affectsOutput\": \"Selects specific subsets of openings for detailing.\"\n    },\n    {\n      \"name\": \"sDimensionType\",\n      \"technicalDefault\": \"Opening size\",\n      \"businessMeaning\": \"Selects the visual representation method. 'Opening size' draws linear dimensions (width/height). 'Cross' draws an 'X' or cross-lines through the opening to indicate a void without specific dimensions.\",\n      \"validRange\": \"Opening size, Cross\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Switches between drawing Dimension objects (with measurements) and PLine objects (symbolic markers).\"\n    },\n    {\n      \"name\": \"sShowFrame\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"Toggles the drawing of the physical outline (perimeter) of the opening.\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Visibility of the polyline representing the cut-out shape.\"\n    },\n    {\n      \"name\": \"sNewLineChar\",\n      \"technicalDefault\": \";\",\n      \"businessMeaning\": \"Delimiter used to split long descriptions into multiple lines of text.\",\n      \"validRange\": \"Any single character (e.g., ;, /, -)\",\n      \"unit\": \"String\",\n      \"affectsOutput\": \"Formatting of the text label in the drawing.\"\n    },\n    {\n      \"name\": \"sOrientation\",\n      \"technicalDefault\": \"Horizontal\",\n      \"businessMeaning\": \"Aligns the dimension lines either horizontally or vertically relative to the drawing view.\",\n      \"validRange\": \"Horizontal, Vertical\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Rotation of the dimension lines and text.\"\n    },\n    {\n      \"name\": \"sSideDimensionLine\",\n      \"technicalDefault\": \"Left\",\n      \"businessMeaning\": \"Positions the dimension line relative to the opening (Left, Right, or Center).\",\n      \"validRange\": \"Left, Right, Center\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Horizontal placement of the dimensions on the drawing sheet.\"\n    },\n    {\n      \"name\": \"sDimLinePerOpening\",\n      \"technicalDefault\": \"No\",\n      \"businessMeaning\": \"If Yes, every opening gets its own individual dimension line. If No, openings share a continuous dimension line (chain dimensioning).\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Clutter and layout of dimensions. Individual lines are clearer for complex roofs; chain lines save space.\"\n    },\n    {\n      \"name\": \"sPositionReference\",\n      \"technicalDefault\": \"Opening\",\n      \"businessMeaning\": \"Defines the origin point for the dimension offset. 'Opening' offsets from the hole center/edge. 'Element' offsets from the overall wall/roof edge.\",\n      \"validRange\": \"Opening, Element\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Consistency of dimension line spacing in areas with varying opening depths.\"\n    },\n    {\n      \"name\": \"sUsePSUnits\",\n      \"technicalDefault\": \"Yes\",\n      \"businessMeaning\": \"If Yes, offsets are fixed paper-space distances (e.g., 5mm on paper). If No, offsets are model-space distances (scaled with the view).\",\n      \"validRange\": \"Yes, No\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Readability of the drawing. Paper space units ensure text is always legible regardless of drawing scale.\"\n    },\n    {\n      \"name\": \"dDimLineOffset\",\n      \"technicalDefault\": \"300\",\n      \"businessMeaning\": \"The distance between the opening geometry and the dimension line.\",\n      \"validRange\": \"10 - 1000 mm\",\n      \"unit\": \"mm\",\n      \"affectsOutput\": \"Spacing of the annotation layer.\"\n    },\n    {\n      \"name\": \"sReferenceType\",\n      \"technicalDefault\": \"No reference\",\n      \"businessMeaning\": \"Selects the reference entity for dimensioning. Can use the closest rafters, specific beam codes, or zones to locate the opening.\",\n      \"validRange\": \"No reference, Beamcode, Zone, Rafters, Closest rafters\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Calculates the 'zero' point for dimensions, showing distances from structural members rather than absolute coordinates.\"\n    },\n    {\n      \"name\": \"sideClosetsRafterProp\",\n      \"technicalDefault\": \"Center\",\n      \"businessMeaning\": \"Specifies which side of the rafter (Inside, Center, Outside) to dimension to when using rafters as a reference.\",\n      \"validRange\": \"Inside, Center, Outside\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"Precision of the dimension relative to the timber material.\"\n    },\n    {\n      \"name\": \"sDimLayout\",\n      \"technicalDefault\": \"Delta perpendicular\",\n      \"businessMeaning\": \"Defines the dimensioning style (e.g., perpendicular offset, parallel offset, cumulative stacking).\",\n      \"validRange\": \"Delta perpendicular, Delta parallel, Cumulative, etc.\",\n      \"unit\": \"Option\",\n      \"affectsOutput\": \"The geometry and hierarchy of the dimension lines.\"\n    }\n  ],\n  \"parameterDependencies\": [\n    {\n      \"trigger\": \"sDimensionType set to 'Opening size'\",\n      \"effect\": \"Enables dimension-specific styles (sDimStyle, sDimLayout, nDimColor).\",\n      \"cascade\": [\n        \"sDimStyle\",\n        \"nDimColor\",\n        \"sDimLayout\"\n      ]\n    },\n    {\n      \"trigger\": \"sDimensionType set to 'Cross'\",\n      \"effect\": \"Enables line styles for the cross marker. Disables dimension calculations.\",\n      \"cascade\": [\n        \"sLineType\",\n        \"nFrameColor\"\n      ]\n    },\n    {\n      \"trigger\": \"sReferenceType set to 'Closest rafters' or 'Rafters'\",\n      \"effect\": \"Activates rafter search logic and positioning relative to beams.\",\n      \"cascade\": [\n        \"sideClosetsRafterProp\",\n        \"sReferenceSide\",\n        \"sFilterBCReference\"\n      ]\n    },\n    {\n      \"trigger\": \"sUsePSUnits set to 'Yes'\",\n      \"effect\": \"Offsets (dDimLineOffset, dTextOffset) are treated as absolute millimeters on the paper sheet, ignoring the viewport scale.\",\n      \"cascade\": [\n        \"dDimLineOffset\",\n        \"dTextOffset\"\n      ]\n    }\n  ],\n  \"outputEntities\": [\n    {\n      \"type\": \"Dimension\",\n      \"description\": \"Linear dimensions indicating the width/height of the opening and its position relative to reference elements (rafters/beams).\",\n      \"appliedTo\": \"PaperSpace Viewport (Front, Side, Top views).\"\n    },\n    {\n      \"type\": \"PLine\",\n      \"description\": \"Polylines"
      },
      "tokens_used": 10903,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution triggered (Insert or Update).",
          "Determine execution context: Check if running in a valid Shop Drawing viewport to get ModelSpace-to-PaperSpace transformation (ms2ps).",
          "Initialize Properties: Load filters (BeamCode, Label, etc.) and display settings (DimStyle, Colors) from OPM.",
          "Element Selection & Filtering: Collect Elements. Apply BeamCode, Label, Material, hsbID, and Zone filters to identify active elements.",
          "Loop through each valid Element.",
          "Retrieve Openings: Get all Openings and Custom TSL entities associated with the Element (from floor group).",
          "Apply Opening Filters: Check Description against 'sFilterOpening' using 'openingFilterType' (Include/Exclude logic).",
          "Check Floor Level: Verify if opening is on the correct floor level (if applicable).",
          "Loop through each valid Opening.",
          "Calculate Opening Geometry: Determine 3D coordinates of opening corners relative to Element coordinate system.",
          "Project to Views: Transform coordinates to Front, Side, and Top viewports.",
          "Reference Calculation: Identify reference points (Rafters, Zones, or Absolute) based on 'sReferenceType'.",
          "Determine Draw Mode: Check 'sDimensionType' (Opening size vs Cross) and 'sShowFrame'.",
          "Offset Calculation: Calculate vector for text and dimension line placement based on 'sPositionReference', 'sOrientation', and 'sUsePSUnits'.",
          "Draw Geometry:",
          "If 'Opening size': Create Dimension objects (individual or cumulative).",
          "If 'Cross': Draw PLine 'X' markers.",
          "If 'Show Frame': Draw PLine outlines.",
          "If 'Show Description': Draw Text labels (splitting by 'sNewLineChar').",
          "Proceed to next Opening.",
          "After loop: Draw cumulative dimension line if 'sDimLinePerOpening' is No.",
          "Proceed to next Element.",
          "Finish: Clean up temporary entities and save state."
        ],
        "conditionalBranches": [
          {
            "condition": "Opening Filter Logic ('openingFilterType')",
            "path1": {
              "name": "Include",
              "steps": [
                "Evaluate: Does Opening Description contain 'sFilterOpening' string?",
                "If Yes: Process the opening.",
                "If No: Skip opening."
              ]
            },
            "path2": {
              "name": "Exclude",
              "steps": [
                "Evaluate: Does Opening Description contain 'sFilterOpening' string?",
                "If Yes: Skip opening.",
                "If No: Process the opening."
              ]
            }
          },
          {
            "condition": "Dimension Type ('sDimensionType')",
            "path1": {
              "name": "Opening size (0)",
              "steps": [
                "Calculate dimension anchor points (Left, Right, or Center based on 'sDimensionSide').",
                "Branch: Check 'sDimLinePerOpening' (Yes/No).",
                "Generate Dimension geometry and text."
              ]
            },
            "path2": {
              "name": "Cross (1)",
              "steps": [
                "Skip Dimension calculations.",
                "Calculate diagonal geometry (Top-Left to Bottom-Right, Top-Right to Bottom-Left).",
                "Draw Cross PLine in Front, Side, and Top views."
              ]
            }
          },
          {
            "condition": "Dimension Line Distribution ('sDimLinePerOpening')",
            "path1": {
              "name": "Yes (Individual)",
              "steps": [
                "Create a separate dimension line object for the current opening.",
                "Use reference points specific to this opening (e.g., closest rafters).",
                "Draw immediately within the opening loop."
              ]
            },
            "path2": {
              "name": "No (Cumulative)",
              "steps": [
                "Store the current opening's dimension points in a global array ('arPtDim').",
                "Do not draw yet.",
                "After all openings are processed, draw a single dimension line connecting all accumulated points."
              ]
            }
          },
          {
            "condition": "Position Reference Origin ('sPositionReference')",
            "path1": {
              "name": "Opening",
              "steps": [
                "Calculate start point of offset vector from the Opening's centroid or edge.",
                "Dimension line spacing adjusts to the specific depth/size of the opening."
              ]
            },
            "path2": {
              "name": "Element",
              "steps": [
                "Calculate start point of offset vector from the Element's origin (0,0,0).",
                "Dimension line spacing is constant for the whole element (e.g., wall face), independent of opening depth."
              ]
            }
          },
          {
            "condition": "Reference Object Calculation ('sReferenceType')",
            "path1": {
              "name": "Rafters / Closest rafters",
              "steps": [
                "Search for beams intersecting the element.",
                "Filter by 'sFilterBCReference' if set.",
                "Calculate center points of rafters adjusted by 'sideClosetsRafterProp' (Inside/Center/Outside).",
                "Use these points as the 'zero' for dimensions."
              ]
            },
            "path2": {
              "name": "Beamcode / Zone / No reference",
              "steps": [
                "If Zone: Use coordinate derived from Zone index.",
                "If Beamcode: Use beam centroid (less common based on logic).",
                "If No reference: Use Element origin.",
                "Skip rafter search logic."
              ]
            }
          },
          {
            "condition": "Dynamic Reference Calculation (Orientation vs Rafters)",
            "path1": {
              "name": "Static Reference",
              "steps": [
                "Condition: Dimension Orientation matches Rafter Direction (e.g., Horizontal Dim, Horizontal Rafters).",
                "Calculate reference rafters once before the loop.",
                "Reuse these reference points for all openings."
              ]
            },
            "path2": {
              "name": "Dynamic Reference",
              "steps": [
                "Condition: Dimension Orientation opposes Rafter Direction (e.g., Horizontal Dim, Vertical Rafters).",
                "Inside the loop: Calculate 'Closest rafters' specifically for the current opening.",
                "Update reference points for every opening to ensure perpendicular distances are correct."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Viewport Context",
            "errorMessage": "Script returns immediately or outputs nothing if 'ms2ps' (Model to Paper Space transform) is invalid.",
            "recovery": "Ensure the script is executed inside a valid layout viewport (Paper Space) that is active and viewing the model."
          },
          {
            "check": "Opening Geometry Validity",
            "errorMessage": "Openings might be skipped if their projection onto the Element plane fails.",
            "recovery": "Ensure Elements are not corrupt or malformed. Script v2.73 includes checks for steep elements."
          },
          {
            "check": "Custom Entity Geometry",
            "errorMessage": "Custom TSL openings (e.g., Skylights) are ignored if they do not contain valid PLine data.",
            "recovery": "Verify that the custom TSL script generates valid Polylines (PLines) representing the opening shape."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Change Visual Representation",
            "how": "Modify 'sDimensionType' or 'sShowFrame' in OPM.",
            "effect": "Switches between Dimensioned view, Cross view, or simple outlines. Updates immediately on recalculation."
          },
          {
            "action": "Filter Openings",
            "how": "Edit 'sFilterOpening' and 'openingFilterType' in OPM.",
            "effect": "Hides or shows specific openings (e.g., show only 'SKY' skylights) without deleting geometry."
          },
          {
            "action": "Reposition Dimensions",
            "how": "Change 'dDimLineOffset', 'sUsePSUnits', or 'sSideDimensionLine' in OPM.",
            "effect": "Moves the dimension lines and text relative to the openings to resolve clashes or improve readability."
          },
          {
            "action": "Context Menu Triggers",
            "how": "Right-click script instance -> 'Filter this element' / 'Remove filter'.",
            "effect": "Automatically populates the 'Filter beams...' properties with the current element's data, enabling quick isolation of specific elements."
          }
        ]
      },
      "tokens_used": 12333,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# HSB_D-RoofOpening.mcr\n\n## Overview\nThis script automates the detailing and dimensioning of roof openings (such as skylights, dormers, and service penetrations) in 2D shop drawings. It generates precise dimensions, outlines, and labels for openings across Front, Side, and Top views within Paper Space layouts.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | No | This script is designed for drawings/annotations, not 3D modeling. |\n| Paper Space | Yes | Script must be run within a Shop Drawing viewport. |\n| Shop Drawing | Yes | Required to calculate the correct transformation between Model and Paper Space. |\n\n## Prerequisites\n- **Required Entities:** Elements (walls/roofs) containing openings or custom TSL instances (e.g., skylights).\n- **Context:** An active hsbCAD Shop Drawing layout with at least one viewport.\n- **Minimum Requirements:** At least one Element with an opening in the active drawing region.\n\n## Usage Steps\n\n### Step 1: Launch Script\n1. Open your hsbCAD Shop Drawing layout.\n2. Type `TSLINSERT` in the command line and press Enter.\n3. Select `HSB_D-RoofOpening.mcr` from the list and click Open.\n\n### Step 2: Insert Instance\n1. Click inside the viewport where you want the opening details to appear.\n2. The script will process the visible elements and draw the opening details based on default settings.\n\n### Step 3: Configure Properties\n1. Select the newly inserted script instance.\n2. Open the **Properties Palette** (press `Ctrl + 1`).\n3. Adjust the parameters (listed below) to filter which openings to show and how to dimension them.\n4. The drawing will update automatically when properties are changed.\n\n## Properties Panel Parameters\n\n### Filter Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Section tsl name | dropdown | (Empty) | Selects the specific Section View script to apply these settings to. |\n| Filter beams with beamcode | text | (Empty) | Filters structural elements by their Beam Code (supports wildcards like `*`). |\n| Filter beams and sheets with label | text | (Empty) | Filters elements by their assigned label. |\n| Filter beams and sheets with material | text | (Empty) | Filters elements by material name. |\n| Filter beams and sheets with hsbID | text | (Empty) | Filters elements by their unique hsbID. |\n| Filter zones | text | (Empty) | Filters elements by zone name. |\n| Filter type | dropdown | Exclude | Sets the logic for the description filter: *Include* (show matches) or *Exclude* (hide matches). |\n| Filter openings with description | text | (Empty) | Filters openings based on text in their description (e.g., \"SKY\" for skylights). |\n\n### Dimension Object Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Dimension type | dropdown | Opening size | **Opening size:** Draws linear dimensions. **Cross:** Draws an 'X' marker instead of dimensions. |\n| Show description | dropdown | Yes | Toggles the visibility of the opening description text label. |\n| Show frame | dropdown | Yes | Toggles the drawing of the physical perimeter (outline) of the opening. |\n| New line character | text | ; | Character used to split long text descriptions into multiple lines (e.g., \"Floor;Sky\" splits into two lines). |\n\n### Positioning Settings\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Orientation dimension line | dropdown | Horizontal | Aligns dimension lines horizontally or vertically relative to the view. |\n| Side dimension line | dropdown | Left | Places dimensions to the Left, Right, or Center of the opening. |\n| Dimension line per opening | dropdown | No | **Yes:** Individual dimension lines per opening. **No:** Chain dimensions for all openings. |\n| Position reference | dropdown | Opening | **Opening:** Offset from the opening edge. **Element:** Offset from the element edge (consistent spacing). |\n| Offset in paperspace units | dropdown | Yes | **Yes:** Offsets are fixed paper distances (mm). **No:** Offsets scale with the view. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Filter this element | Automatically updates the \"Filter beams...\" properties in the OPM to match the element currently selected in the drawing. |\n| Remove filter | Clears all text from the filter properties in the OPM, displaying all openings. |\n\n## Tips\n- **Multi-line Labels:** If your opening descriptions are long, use the `New line character` property (e.g., set to `/` or `;`) to make the text stack neatly in the drawing.\n- **Filtering Views:** Use the `Section tsl name` property to apply different dimensioning styles to different viewports (e.g., dimensions in Front view, crosses in Top view).\n- **Clean Drawings:** If dimensions become cluttered, set `Dimension line per opening` to \"No\" to create a clean chain dimension line.\n- **Skylights:** Use the `Filter openings with description` to isolate specific items (e.g., type \"SKY\" to hide standard vents and show only skylights).\n\n## FAQ\n- **Q: Why did the script not draw anything?**\n  - **A:** Ensure you are inside a Paper Space viewport (Shop Drawing) and that the viewport is active. The script requires the Model-to-Paper Space transformation to function.\n- **Q: My dimensions are too small or huge.**\n  - **A:** Check the `Offset in paperspace units` property. If set to \"No\", your offsets are scaling with the drawing zoom. Set it to \"Yes\" to keep text and lines at a constant readable size on paper.\n- **Q: Can I show dimensions for skylights but only outlines for vents?**\n  - **A:** You would need to insert the script twice. Configure one instance to filter \"SKY\" with Dimension type \"Opening size\" and the other to filter \"VENT\" with Dimension type \"Cross\"."
      },
      "tokens_used": 8779,
      "error": null
    }
  }
}