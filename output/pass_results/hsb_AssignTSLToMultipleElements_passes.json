{
  "filename": "hsb_AssignTSLToMultipleElements.mcr",
  "status": "completed",
  "total_tokens": 21152,
  "processing_time": 182.1895501613617,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "02.12.2010",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3304,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script prompts for Element entities using PrEntity and interacts with TslInst. It uses elementGroup() and assignToElementGroup() functions to attach scripts to model elements. There are no references to _Viewport, _kPaperSpace, sd_* prefixes, or #Type E headers."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "TslInst"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 2696,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getTslInst",
              "promptOriginal": "Select a TSL",
              "condition": "_bOnInsert",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "\nSelect a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1893,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Assigns an existing TSL script instance (e.g., a specific connector or machining logic) to multiple selected construction elements at once.",
          "category": "Utility / Automation",
          "typicalUseCase": "When a user has a specific connection or manufacturing script configured correctly on one element and needs to apply that same logic to a group of other elements (e.g., applying a specific purlin cleat to every rafter in a roof)."
        },
        "parameters": [
          {
            "name": "Source TSL (via _Entity array)",
            "technicalDefault": "null",
            "businessMeaning": "The specific script instance (template) selected from the model that contains the desired logic, settings, or geometry configuration.",
            "validRange": "Any valid TslInst currently existing in the drawing.",
            "unit": "Object Selection",
            "affectsOutput": "Determines exactly which machining, connection, or labeling logic will be attached to the target elements."
          },
          {
            "name": "Target Elements (via _Element array)",
            "technicalDefault": "Empty Set",
            "businessMeaning": "The structural elements (walls, beams, panels) to which the selected script logic should be attached.",
            "validRange": "1 or more Elements.",
            "unit": "Count",
            "affectsOutput": "Defines the physical scope of the operation; every element in this set will execute the logic of the Source TSL."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "User selects a Source TSL",
            "effect": "The script enables the selection of Target Elements.",
            "cascade": [
              "Target Elements"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "Script Reference / Logical Link",
            "description": "Creates a logical link (assignment) between the Target Elements and the Source TSL, causing the elements to regenerate with the new script logic.",
            "appliedTo": "All elements selected in the 'Target Elements' set."
          }
        ]
      },
      "tokens_used": 3808,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script execution begins via insertion (_bOnInsert).",
          "2. System checks if insertCycleCount > 1 (Re-calculation check).",
          "3. User prompted to select an existing TSL instance (Source TSL).",
          "4. User prompted to select a set of construction elements (Target Elements).",
          "5. User confirms the selection set.",
          "6. Script checks if a Source TSL was successfully captured in the _Entity array.",
          "7. Script validates the validity of the selected Source TSL object.",
          "8. Script iterates through all selected Target Elements.",
          "9. For each target, the Source TSL is assigned to the element's group.",
          "10. The Source TSL instance is added to the element's group.",
          "11. Script execution completes."
        ],
        "conditionalBranches": [
          {
            "condition": "Is the script running a re-insertion cycle (insertCycleCount > 1)?",
            "path1": {
              "name": "Cycle Detected",
              "steps": [
                "Script erases itself immediately.",
                "Execution stops to prevent infinite loops."
              ]
            },
            "path2": {
              "name": "First Run",
              "steps": [
                "Proceed to prompt user for Source TSL."
              ]
            }
          },
          {
            "condition": "Is the selected Source TSL valid (bIsValid)?",
            "path1": {
              "name": "Valid TSL",
              "steps": [
                "Loop through target elements.",
                "Assign TSL to element groups.",
                "Add TSL instance to groups."
              ]
            },
            "path2": {
              "name": "Invalid TSL",
              "steps": [
                "Display report notice: 'TSL Selected Not Valid'.",
                "Assignment logic is skipped or ineffective."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Source TSL Selection",
            "errorMessage": "None explicit (Script erases silently if _Entity array is empty).",
            "recovery": "User must re-run the script and ensure a valid TSL instance is selected in the first prompt."
          },
          {
            "check": "TSL Object Validity",
            "errorMessage": "TSL Selected Not Valid (displayed via reportNotice).",
            "recovery": "User must ensure the selected object is a correctly loaded TSL instance and not a corrupted or deleted reference."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Persist in Model",
            "how": "Script Instance remains (due to commented out eraseInstance).",
            "effect": "The script instance stays in the drawing but typically has no further interaction."
          },
          {
            "action": "Modify Target Elements",
            "how": "Logical assignment via assignToElementGroup.",
            "effect": "The Target Elements now execute the logic of the Source TSL. The user can edit the properties of the Target Elements (or the newly attached scripts) to update the model."
          },
          {
            "action": "Properties Editing",
            "how": "N/A",
            "effect": "This script has no PropDouble/PropInt definitions, so there are no user-editable properties in the OPM for the script instance itself."
          }
        ]
      },
      "tokens_used": 5414,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_AssignTSLToMultipleElements.mcr\n\n## Overview\nThis utility script allows you to take an existing TSL script instance (such as a specific connector or machining configuration) from your model and apply it to a group of selected construction elements at once. It is ideal for bulk-applying connection logic or manufacturing details to multiple beams or panels without having to insert and configure them individually.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in the 3D model. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not intended for 2D drawing generation. |\n\n## Prerequisites\n- **Required Entities**:\n  - At least one existing **TSL Instance** (Source) already inserted in the model to copy logic from.\n  - At least one **Element** (Target) (e.g., beams, walls, panels) to assign the script to.\n- **Minimum Beam Count**: 0\n- **Required Settings Files**: None\n\n## Usage Steps\n\n### Step 1: Launch Script\n1.  Type `TSLINSERT` in the command line.\n2.  Navigate to the script location and select `hsb_AssignTSLToMultipleElements.mcr`.\n\n### Step 2: Select Source TSL\n```\nCommand Line: Select a TSL\nAction: Click on an existing TSL instance in your model that has the desired configuration (e.g., a specific connector or machining point) that you want to copy.\n```\n\n### Step 3: Select Target Elements\n```\nCommand Line: Select a set of elements\nAction: Select one or more construction elements (beams, walls, etc.) that you want to attach the selected script to. Press Enter to confirm the selection set.\n```\n\n### Step 4: Completion\nThe script will automatically assign the logic from the Source TSL to all selected Target Elements. The script instance used to run this command will remain in the model but can be deleted if no longer needed.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not have editable parameters in the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | No specific context menu items are added by this script. |\n\n## Settings Files\nThis script does not use external settings files.\n\n## Tips\n- **Template Usage**: Configure one connector or machining detail exactly how you want it (correct offsets, sizes, etc.), then use this script to apply that \"perfect\" setup to many other elements.\n- **Visibility**: Ensure the layer containing your Source TSL is thawed and unlocked, otherwise you cannot select it in Step 2.\n- **Cleanup**: Since the script instance itself remains in the drawing after running (similar to a standard insert), you can safely delete the `hsb_AssignTSLToMultipleElements` instance from the model once you have finished the assignment to keep your drawing clean.\n\n## FAQ\n- **Q: What happens if I select the wrong TSL as the source?**\n  A: You cannot undo the assignment using the standard AutoCAD Undo command immediately after running if elements have already regenerated. However, you can select the affected elements and use the \"Erase TSL\" or similar commands in hsbCAD to remove the incorrectly assigned scripts, then re-run this tool.\n- **Q: Can I apply this to nested elements?**\n  A: This script applies the TSL to the elements you select in Step 3. If those elements are part of a larger assembly, ensure you are selecting the exact structural elements you wish to modify."
      },
      "tokens_used": 4037,
      "error": null
    }
  }
}