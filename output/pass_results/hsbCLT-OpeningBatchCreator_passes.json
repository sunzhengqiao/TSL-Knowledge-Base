{
  "filename": "hsbCLT-OpeningBatchCreator.mcr",
  "status": "completed",
  "total_tokens": 50965,
  "processing_time": 586.7175159454346,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": 1,
          "minorVersion": 0,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "09.09.2022",
            "author": "Thorsten Huck",
            "changes": "HSB-16458 initial version"
          }
        ],
        "settingsFiles": [],
        "dependencies": [
          "hsbCLT-Opening"
        ]
      },
      "tokens_used": 8605,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script prompts for Sip entities (PrEntity ssE(T(\"|Select panels|\"), Sip())); sets int bForceModelSpace = true; during tslNew.dbCreate(); and processes 3D geometries (PlaneProfile, Body, Vector3d) derived from panels. No Paper Space (_Viewport) or ShopDrawing (sd_*) prefixes or functions detected."
        },
        "prerequisites": {
          "requiredEntities": [
            "Sip"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": [
            "Catalog entries for 'hsbCLT-Opening' (Script requires at least 2 valid catalog entries excluding system defaults like '|_Default|')"
          ]
        }
      },
      "tokens_used": 6958,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "|Select panels|",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "sStrategy1",
            "type": "PropString",
            "displayName": "|Strategy| 1",
            "defaultValue": "<|Disabled|>",
            "inputType": "dropdown",
            "options": [
              "<|Disabled|>",
              "Catalog entries of 'hsbCLT-Opening'"
            ],
            "category": "|Batch Rules|",
            "description": "Defines the first strategy based on a catalog entry to be applied to the opening"
          },
          {
            "index": 1,
            "variable": "sStrategy2",
            "type": "PropString",
            "displayName": "|Strategy| 2",
            "defaultValue": "Catalog entries of 'hsbCLT-Opening'",
            "inputType": "dropdown",
            "options": [
              "<|Disabled|>",
              "Catalog entries of 'hsbCLT-Opening'"
            ],
            "category": "|Batch Rules|",
            "description": "Defines the second strategy based on a catalog entry to be applied to the opening"
          },
          {
            "index": 2,
            "variable": "sStrategy3",
            "type": "PropString",
            "displayName": "|Strategy| 3",
            "defaultValue": "Catalog entries of 'hsbCLT-Opening'",
            "inputType": "dropdown",
            "options": [
              "<|Disabled|>",
              "Catalog entries of 'hsbCLT-Opening'"
            ],
            "category": "|Batch Rules|",
            "description": "Defines the third strategy based on a catalog entry to be applied to the opening"
          },
          {
            "index": 3,
            "variable": "sAreaFilter",
            "type": "PropString",
            "displayName": "|Filter by Area|",
            "defaultValue": "",
            "inputType": "text",
            "options": [],
            "category": "|General|",
            "description": "Shapes matching the filter condition are accepted. Specify area in m² (metric) or drawing units (imperial) with leading logical condition, i.e. <=0.7"
          },
          {
            "index": 4,
            "variable": "sFace",
            "type": "PropString",
            "displayName": "|Face|",
            "defaultValue": "|byCatalog|",
            "inputType": "dropdown",
            "options": [
              "|byCatalog|",
              "|Reference Side|",
              "|Opposite Side|"
            ],
            "category": "|General|",
            "description": "Defines the Face"
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 10056,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Batch processing tool that detects existing openings in CLT panels and applies specific reinforcement or detailing strategies to them based on size filters.",
          "category": "Automation/CLT",
          "typicalUseCase": "Automatically applying timber stiffeners, lintels, or machining operations to all windows/doors in a selection of panels that meet a specific size criteria (e.g., all openings > 1.5m²)."
        },
        "parameters": [
          {
            "name": "sStrategy1",
            "technicalDefault": "<|Disabled|>",
            "businessMeaning": "The first construction rule or reinforcement method to apply, defined by a specific catalog entry from the 'hsbCLT-Opening' script.",
            "validRange": "Any valid catalog entry name from 'hsbCLT-Opening' or '<|Disabled|>'",
            "unit": "String",
            "affectsOutput": "Creates an instance of the hsbCLT-Opening script with the specified catalog configuration around detected openings."
          },
          {
            "name": "sStrategy2",
            "technicalDefault": "Catalog entries of 'hsbCLT-Opening'",
            "businessMeaning": "A secondary construction rule or reinforcement method to apply simultaneously with Strategy 1.",
            "validRange": "Any valid catalog entry name from 'hsbCLT-Opening' or '<|Disabled|>'",
            "unit": "String",
            "affectsOutput": "Creates an additional instance of hsbCLT-Opening with the secondary configuration on the same openings."
          },
          {
            "name": "sStrategy3",
            "technicalDefault": "Catalog entries of 'hsbCLT-Opening'",
            "businessMeaning": "A tertiary construction rule or reinforcement method to apply simultaneously with Strategies 1 and 2.",
            "validRange": "Any valid catalog entry name from 'hsbCLT-Opening' or '<|Disabled|>'",
            "unit": "String",
            "affectsOutput": "Creates an additional instance of hsbCLT-Opening with the tertiary configuration on the same openings."
          },
          {
            "name": "sAreaFilter",
            "technicalDefault": "",
            "businessMeaning": "A logic gate that selects which openings to process based on their area (e.g., ignore small service holes, only reinforce large window openings).",
            "validRange": "String format starting with logical operator [=, <, <=, >, >=] followed by a number (e.g., '<=0.5', '>2.0')",
            "unit": "m² (Metric) or Drawing Units² (Imperial)",
            "affectsOutput": "Determines if a specific detected opening triggers the creation of the Strategy scripts. Openings failing the filter are ignored."
          },
          {
            "name": "sFace",
            "technicalDefault": "|byCatalog|",
            "businessMeaning": "Defines which side of the panel the opening logic refers to (Reference Side vs. Opposite Side), overriding the catalog default.",
            "validRange": "|byCatalog|, |Reference Side|, |Opposite Side|",
            "unit": "Enum",
            "affectsOutput": "Sets the 'Face' property (Property Index 1) of the generated hsbCLT-Opening instances, flipping geometry orientation if necessary."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sAreaFilter",
            "effect": "Acts as a pre-filter for the Strategies. Only openings satisfying this string condition will receive the Strategy scripts.",
            "cascade": [
              "sStrategy1",
              "sStrategy2",
              "sStrategy3"
            ]
          },
          {
            "trigger": "sStrategy1/2/3",
            "effect": "Requires valid catalog entries from the 'hsbCLT-Opening' script. If none exist, the tool aborts.",
            "cascade": []
          },
          {
            "trigger": "sFace",
            "effect": "Overrides Property 1 of the generated 'hsbCLT-Opening' instances only if set to anything other than '|byCatalog|'.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Script Instance (hsbCLT-Opening)",
            "description": "Logic instances that generate machining, cuts, or metal plates. This script does not create geometry directly but spawns the child scripts that do.",
            "appliedTo": "Selected Sip (CLT Panels) - specifically targeting detected voids/cutouts."
          }
        ]
      },
      "tokens_used": 9244,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "raw_content": "```json\n{\n"
      },
      "tokens_used": 11377,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsbCLT-OpeningBatchCreator.mcr\n\n## Overview\nBatch processing tool that detects existing openings in CLT panels and automatically applies specific detailing strategies (such as lintels or stiffeners) based on size filters.\n\n## Usage Environment\n\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Required. Select CLT panels in 3D model. |\n| Paper Space | No | |\n| Shop Drawing | No | |\n\n## Prerequisites\n- **Required Entities**: CLT Panels (Sip entities) with existing voids or cutouts.\n- **Minimum Beams**: 0 (This script operates on panels, not beams).\n- **Required Settings**: Valid catalog entries for the script `hsbCLT-Opening` must exist in your database.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` → Select `hsbCLT-OpeningBatchCreator.mcr`\n\n### Step 2: Select Panels\n```\nCommand Line: Select panels\nAction: Select the CLT panels (Sip entities) containing the openings you wish to process and press Enter.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Strategy 1 | dropdown | `<|Disabled|>` | Select the first construction rule (from the `hsbCLT-Opening` catalog) to apply to detected openings. |\n| Strategy 2 | dropdown | (Catalog entries) | Select a secondary rule to apply simultaneously with Strategy 1. |\n| Strategy 3 | dropdown | (Catalog entries) | Select a tertiary rule to apply simultaneously with Strategies 1 and 2. |\n| Filter by Area | text | (Empty) | Logical condition to filter openings by size (e.g., `<=0.7` or `>1.5`). Uses m² (metric) or drawing units² (imperial). Leave empty to process all openings. |\n| Face | dropdown | `|byCatalog|` | Determines which side of the panel the detailing is applied to. Options: Reference Side, Opposite Side, or by Catalog default. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None available | This script does not add custom context menu items. |\n\n## Settings Files\n- **Catalog Dependency**: `hsbCLT-Opening`\n- **Purpose**: This batch script relies entirely on the catalog configurations defined within the `hsbCLT-Opening` script. Ensure that script has valid, saved catalog entries (excluding system defaults) to populate the Strategy dropdowns.\n\n## Tips\n- **Small Openings**: Use the \"Filter by Area\" parameter (e.g., `<=0.5`) to ignore small service holes or drill holes so you only detail large windows or doors.\n- **Combined Detailing**: You can use Strategy 1, 2, and 3 together to apply multiple different details to a single opening (e.g., Strategy 1 for a timber lintel and Strategy 2 for metal plate reinforcement).\n- **Catalog Check**: If the Strategy dropdowns are empty or the script fails, verify that the `hsbCLT-Opening` script has valid catalog entries in your current project.\n\n## FAQ\n- **Q: What units should I use for the Area Filter?**\n  - A: Use square meters (m²) if working in a metric project. If working in imperial, use your current drawing units squared.\n- **Q: Why didn't the script create any visible geometry?**\n  - A: This script creates *instances* of the `hsbCLT-Opening` script. It does not draw geometry directly. Check if the generated `hsbCLT-Opening` instances are visible and that their specific catalogs are configured to produce visible elements (machining or beams).\n- **Q: Can I run this multiple times on the same panel?**\n  - A: Yes, but be careful not to duplicate detailing. Check your existing `hsbCLT-Opening` instances before running the batch again."
      },
      "tokens_used": 4725,
      "error": null
    }
  }
}