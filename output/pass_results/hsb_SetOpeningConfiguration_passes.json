{
  "filename": "hsb_SetOpeningConfiguration.mcr",
  "status": "completed",
  "total_tokens": 25973,
  "processing_time": 210.78382921218872,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": null,
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.0",
            "date": "27.05.2008",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 4285,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to prompt selection of 'Opening' entities from the drawing. It modifies properties of OpeningSF objects (setNumBeamsSupport, etc.) and triggers a model regeneration command ('-Hsb_GenerateConstruction'). No ShopDrawing specific patterns (sd_ prefix, _Viewport usage, or #Type definitions) are present."
        },
        "prerequisites": {
          "requiredEntities": [
            "Opening"
          ],
          "minimumBeams": null,
          "requiredSpace": "Model Space containing valid Opening entities.",
          "requiredSettings": []
        }
      },
      "tokens_used": 2709,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Please select Openings",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 0,
            "variable": "nSupBmLeft",
            "type": "PropInt",
            "displayName": "Number Support Beams Left",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "nNoSupBmLeft",
            "type": "PropInt",
            "displayName": "Number No Support Beams Left",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "nSupBmRight",
            "type": "PropInt",
            "displayName": "Number Support Beams Right",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "nNoSupBmRight",
            "type": "PropInt",
            "displayName": "Number No Support Beams Right",
            "defaultValue": "1",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2833,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Bulk-configures the vertical framing arrangement (studs/jacks) around selected wall openings, specifically setting the count of load-bearing and non-load-bearing members on both sides.",
          "category": "Framing",
          "typicalUseCase": "When an engineer specifies a specific number of jack studs (to support the header) and king studs (for stability) around a window or door, this script allows the user to select multiple openings and apply these quantities simultaneously."
        },
        "parameters": [
          {
            "name": "nSupBmLeft",
            "technicalDefault": "1",
            "businessMeaning": "Number of load-bearing vertical members on the left side of the opening (typically Jack Studs or Trimmer Studs). These members support the lintel/header above the opening.",
            "validRange": "0 - 4",
            "unit": "count",
            "affectsOutput": "Adds or removes structural studs on the left flank. If set to 0, the header may lose support on that side. Increasing this value adds multiple jacks for heavy loads."
          },
          {
            "name": "nNoSupBmLeft",
            "technicalDefault": "1",
            "businessMeaning": "Number of non-load-bearing vertical members on the left side of the opening (typically King Studs or full-height stiffeners). These transfer loads from the jacks to the plate below or provide stiffness.",
            "validRange": "0 - 4",
            "unit": "count",
            "affectsOutput": "Adds or removes full-height filler/stiffening studs adjacent to the support members on the left."
          },
          {
            "name": "nSupBmRight",
            "technicalDefault": "1",
            "businessMeaning": "Number of load-bearing vertical members on the right side of the opening (typically Jack Studs or Trimmer Studs).",
            "validRange": "0 - 4",
            "unit": "count",
            "affectsOutput": "Adds or removes structural studs on the right flank."
          },
          {
            "name": "nNoSupBmRight",
            "technicalDefault": "1",
            "businessMeaning": "Number of non-load-bearing vertical members on the right side of the opening (typically King Studs or full-height stiffeners).",
            "validRange": "0 - 4",
            "unit": "count",
            "affectsOutput": "Adds or removes full-height filler/stiffening studs adjacent to the support members on the right."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "Modification of nSupBmLeft, nNoSupBmLeft, nSupBmRight, or nNoSupBmRight",
            "effect": "Forces the parent Element (Wall) to regenerate geometry to reflect the new stud counts.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "Opening (Configuration)",
            "description": "Updates the property set of the selected Opening objects to store the new stud counts.",
            "appliedTo": "Selected Opening entities."
          },
          {
            "type": "Wall Framing (GenBeams)",
            "description": "Causes the regeneration of the wall's structural layout. Vertical beams (studs) surrounding the opening are generated or deleted to match the specified counts.",
            "appliedTo": "The parent Element (Wall) containing the modified Openings."
          }
        ]
      },
      "tokens_used": 5389,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 6826,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SetOpeningConfiguration.mcr\n\n## Overview\nThis script allows you to bulk-configure the vertical framing arrangement around wall openings. It sets the specific count of load-bearing (Jack studs) and non-load-bearing (King studs) members on both the left and right sides of selected openings.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the model where opening entities exist. |\n| Paper Space | No | Not supported in layout views. |\n| Shop Drawing | No | This is a configuration tool for the model generation phase. |\n\n## Prerequisites\n- **Required Entities:** `Opening` entities must exist in the drawing.\n- **Minimum beam count:** None.\n- **Required settings files:** None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SetOpeningConfiguration.mcr`\n\n### Step 2: Select Openings\n```\nCommand Line: Please select Openings\nAction: Click on the opening(s) (windows or doors) you wish to modify. You can select multiple openings at once. Press Enter to confirm selection.\n```\n\n### Step 3: Configure Parameters\nAfter selection, the script attaches to the openings. Use the **Properties Palette** (Ctrl+1) to adjust the stud counts. The model will regenerate automatically to reflect the changes.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Number Support Beams Left | number | 1 | Number of load-bearing vertical members (e.g., Jack Studs) on the left side that support the lintel/header. |\n| Number No Support Beams Left | number | 1 | Number of non-load-bearing vertical members (e.g., King Studs) on the left side used for stiffening. |\n| Number Support Beams Right | number | 1 | Number of load-bearing vertical members (e.g., Jack Studs) on the right side that support the lintel/header. |\n| Number No Support Beams Right | number | 1 | Number of non-load-bearing vertical members (e.g., King Studs) on the right side used for stiffening. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No custom context menu items are defined for this script. Use the Properties Palette to make changes. |\n\n## Settings Files\n- **Filename**: N/A\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Bulk Editing:** You can select multiple openings in Step 2 (e.g., all windows on a specific wall) and change the properties once to update them all simultaneously.\n- **Validation:** After changing the numbers, the script automatically triggers a model regeneration. Verify the updated framing in the 3D model or plan view.\n\n## FAQ\n- **Q: What is the difference between \"Support\" and \"No Support\" beams?**\n  - **A:** \"Support Beams\" typically refer to Jack Studs or Trimmer Studs that carry the load of the header above the opening. \"No Support Beams\" typically refer to King Studs or full-height stiffeners that provide stability but do not directly support the header.\n- **Q: I changed the numbers but see no change in the drawing.**\n  - **A:** Ensure the wall containing the openings is not locked or frozen. The script attempts to regenerate the construction automatically; if it fails, try running the `Hsb_GenerateConstruction` command manually."
      },
      "tokens_used": 3931,
      "error": null
    }
  }
}