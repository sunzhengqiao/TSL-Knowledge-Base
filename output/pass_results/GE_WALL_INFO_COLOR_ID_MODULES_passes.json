{
  "filename": "GE_WALL_INFO_COLOR_ID_MODULES.mcr",
  "status": "completed",
  "total_tokens": 18044,
  "processing_time": 244.34041619300842,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.0",
            "date": "10.jul.2013",
            "author": "Kris Riemslagh (kr@hsb-cad.com)",
            "changes": "Release"
          },
          {
            "version": "v1.1",
            "date": "10.jul.2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Renamed from ShowModule to GE_WALL_INFO_COLOR_ID_MODULES\n- Thumbnail added\n- Description added"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3567,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "The script uses _Element[0] and Element.beam() which are model space entities. It employs a Display dp(-1) for visualization. There are no references to sd_*, _Viewport, or #Type E + _Entity[] which indicate ShopDrawing or PaperSpace usage."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Must be inserted on or attached to a valid Element in Model Space.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1588,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "getElement",
              "promptOriginal": null,
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 2065,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "This script visualizes wall modules by displaying their names at the center of beams and applying unique colors to differentiate specific module groups within the 3D model.",
          "category": "Visualization/ModelChecking",
          "typicalUseCase": "Used during the design or detailing phase to visually verify the distribution and organization of different prefabrication modules (e.g., Wall Type A vs. Wall Type B) within a composite wall element."
        },
        "parameters": [
          {
            "name": "dp.textHeight",
            "technicalDefault": "U(20)",
            "businessMeaning": "Sets the height of the text labels used to display module names in the 3D model.",
            "validRange": "10mm - 100mm",
            "unit": "mm",
            "affectsOutput": "Changes the visual size of the module name labels in the CAD view, improving readability depending on zoom level."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Text Label",
            "description": "Text displaying the Module Name is drawn at the centroid of every beam.",
            "appliedTo": "Each Beam found within the selected Element."
          },
          {
            "type": "Colored Overlay",
            "description": "A colored representation of the beam's envelope body is drawn to visually group beams by their Module property.",
            "appliedTo": "Groups of Beams sharing the same Module Name."
          }
        ]
      },
      "tokens_used": 2090,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Launch script execution",
          "Check if in insertion mode (_bOnInsert)",
          "Prompt user to select a single Element (getElement)",
          "Remove any existing instances of this script attached to the selected Element to prevent duplicates",
          "Verify the selected Element exists and is valid",
          "Assign script instance to the Element group and retrieve all Beams contained in the Element",
          "Initialize temporary Display context for visualization",
          "Iterate through each Beam found",
          "Draw the 'Module' property name as text at the centroid of each Beam",
          "Collect unique Module names into a list",
          "Check if the Element contains any Beams",
          "If no Beams found, draw the Script Name at the Element's origin",
          "If Beams found, iterate through the list of unique Module names",
          "Assign a sequential color index to each unique Module",
          "Draw the envelope body of all Beams belonging to the current Module using the assigned color",
          "Finish execution"
        ],
        "conditionalBranches": [
          {
            "condition": "Validity of the selected Element",
            "path1": {
              "name": "Invalid Element",
              "steps": [
                "Detect _Element length is 0 or Element is not valid",
                "Execute eraseInstance()",
                "Terminate script"
              ]
            },
            "path2": {
              "name": "Valid Element",
              "steps": [
                "Store reference to Element",
                "Proceed to Beam extraction"
              ]
            }
          },
          {
            "condition": "Presence of Beams in the Element",
            "path1": {
              "name": "Empty Element",
              "steps": [
                "Detect arBm.length() == 0",
                "Draw script name at element origin coordinates (_Pt0)",
                "Skip module coloring loops"
              ]
            },
            "path2": {
              "name": "Populated Element",
              "steps": [
                "Loop through unique module names found",
                "Filter beams by module name",
                "Apply unique color and draw envelope bodies for each module group"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection and Validity",
            "errorMessage": "None (Silent Failure)",
            "recovery": "The script self-erases. User must re-insert and ensure a valid Element is selected."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Automatic Visual Update",
            "how": "Geometry changes in the host Element (add/remove beams, change module names)",
            "effect": "The script recalculates and updates the text labels and colored overlays automatically to reflect the new state."
          },
          {
            "action": "Deletion",
            "how": "Select the script instance in the model and delete",
            "effect": "Removes all text labels and colored visualizations from the view."
          }
        ]
      },
      "tokens_used": 4628,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_WALL_INFO_COLOR_ID_MODULES.mcr\n\n## Overview\nThis script visualizes the composition of wall modules by displaying their names at the center of each beam. It also applies unique colors to different module groups within a 3D model, making it easy to distinguish between specific prefabrication sections (e.g., different wall types) visually.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be attached to an Element in the Model Space. |\n| Paper Space | No | Not supported in layout views. |\n| Shop Drawing | No | Not intended for 2D shop drawing generation. |\n\n## Prerequisites\n- **Required entities**: An existing Element (e.g., a wall assembly) containing Beams.\n- **Minimum beam count**: 0 (The script handles empty elements by displaying a placeholder at the element origin).\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `GE_WALL_INFO_COLOR_ID_MODULES.mcr` from the list.\n\n### Step 2: Select Element\n```\nCommand Line: Select Element:\nAction: Click on the desired Element (wall assembly) in your 3D model to which you want to attach the visualization.\n```\n\n### Step 3: Automatic Generation\nOnce the Element is selected, the script will automatically:\n1. Attach itself to the Element.\n2. Scan all beams within the Element.\n3. Display the \"Module\" property name as text at the center of each beam.\n4. Assign a specific color to all beams belonging to the same Module group.\n\n## Properties Panel Parameters\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose any user-editable parameters in the Properties Palette. It uses internal logic to determine text size and colors. |\n\n## Right-Click Menu Options\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add custom options to the right-click context menu. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: This script operates independently without requiring external settings files.\n\n## Tips\n- **Automatic Updates**: If you modify the Element (add/remove beams) or change the \"Module\" names of the beams, the visualization (text and colors) will update automatically the next time the view is refreshed.\n- **Troubleshooting**: If you only see the script name appearing in the model but no text or colors on beams, the selected Element may be empty (contains 0 beams).\n- **Clarity**: Use this tool during the design phase to quickly verify if your wall modules are assigned correctly before manufacturing.\n\n## FAQ\n- **Q: How do I remove the colors and text labels?**\n  - A: Select the script instance attached to the Element and delete it.\n- **Q: Can I change the text height of the module labels?**\n  - A: The text height is hardcoded within the script logic and cannot be changed via the properties panel.\n- **Q: Why are beams colored differently?**\n  - A: The script assigns a unique color to every unique \"Module\" name found within the Element. Beams sharing the same Module name will share the same color."
      },
      "tokens_used": 4106,
      "error": null
    }
  }
}