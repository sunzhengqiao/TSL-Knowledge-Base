{
  "filename": "GE_BEAM_INFO_GET_PANHAND.mcr",
  "status": "completed",
  "total_tokens": 18241,
  "processing_time": 183.94742631912231,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": "",
          "numBeamsReq": 0,
          "keywords": [],
          "majorVersion": 0,
          "minorVersion": 0,
          "dxaOut": 0,
          "implInsert": 0
        },
        "description": "",
        "versionHistory": [
          {
            "version": "v1.0",
            "date": "31-oct-2013",
            "author": "David Rueda (dr@hsb-cad.com)",
            "changes": "Release"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 2913,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select 'Beam' entities directly from the model, iterates through them to extract panhand information, and uses reportNotice for output. No usage of sd_* functions, _Viewport, or #Type E entities associated with Paper Space or Shop Drawings."
        },
        "prerequisites": {
          "requiredEntities": [
            "GenBeam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space with existing Beams to analyze.",
          "requiredSettings": []
        }
      },
      "tokens_used": 1329,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "select a set beams",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "ShowNotice",
            "trigger": "Script execution after beam processing",
            "title": "reportNotice",
            "dataSource": "Variable 'strBeam' containing Beam ID, Type, and Panhand information",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 1972,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "A diagnostic tool that inspects selected timber beams to identify and list the entity type acting as their 'panhand' (reference contour or profile guide).",
          "category": "Analysis/Diagnostics",
          "typicalUseCase": "When a user needs to verify why a beam is processing incorrectly (e.g., wrong shape or machining) and suspects the issue lies with the underlying panhand definition or its absence."
        },
        "parameters": [
          {
            "name": "ssE",
            "technicalDefault": "Empty Selection Set",
            "businessMeaning": "The specific group of beams selected by the user to undergo panhand verification.",
            "validRange": "1 to N (where N is the number of beams in the model)",
            "unit": "Entities (Count)",
            "affectsOutput": "Determines the rows of data in the final text report; only beams included in this selection will have their panhand type reported."
          }
        ],
        "parameterDependencies": [],
        "outputEntities": [
          {
            "type": "Report/Notice",
            "description": "A text report displayed in the command line or notice dialog listing the Handle, Type, and Panhand Entity Type (or 'EMPTY' if missing) for each selected beam.",
            "appliedTo": "N/A (Informational output only)"
          }
        ]
      },
      "tokens_used": 3378,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script execution initiated (Insert)",
          "Check if insertCycleCount > 1",
          "If cycle count is high: Erase instance and exit (prevents re-runs)",
          "Prompt user to select a set of beams via PrEntity",
          "User completes or cancels selection",
          "Check if valid beams were selected (_Beam.length > 0)",
          "If no beams selected: Erase instance and exit",
          "If beams selected: Store beams in internal _Beam array and pause (First run completes)",
          "System triggers recalculation (Second run starts automatically)",
          "Verify _Beam array still contains data",
          "Loop through each Beam in _Beam",
          "Check if current Beam is valid (bIsValid)",
          "Retrieve Panhand entity from Beam",
          "Check if Panhand entity exists (bIsValid)",
          "Append beam ID, Type, and Panhand status (EMPTY or TypeName) to report string",
          "Display final report using reportNotice",
          "Erase instance (Script self-destructs after use)"
        ],
        "conditionalBranches": [
          {
            "condition": "Check for duplicate insert cycles (insertCycleCount > 1)",
            "path1": {
              "name": "Duplicate Cycle",
              "steps": [
                "Erase script instance",
                "Return immediately"
              ]
            },
            "path2": {
              "name": "First Cycle",
              "steps": [
                "Proceed to Beam Selection prompt"
              ]
            }
          },
          {
            "condition": "User Selection Result (ssE.go() && _Beam.length() == 0)",
            "path1": {
              "name": "Empty Selection",
              "steps": [
                "Erase script instance",
                "Exit"
              ]
            },
            "path2": {
              "name": "Valid Selection",
              "steps": [
                "Populate _Beam array",
                "Save instance and await recalculation"
              ]
            }
          },
          {
            "condition": "Panhand Entity Existence (entPn.bIsValid())",
            "path1": {
              "name": "No Panhand",
              "steps": [
                "Set string variable to 'EMPTY'"
              ]
            },
            "path2": {
              "name": "Panhand Found",
              "steps": [
                "Retrieve entity type name via typeName()",
                "Store type name in string variable"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Beam Selection Set Count",
            "errorMessage": "(None - implicit exit)",
            "recovery": "Script erases itself silently if no beams are selected. User must re-run the script and ensure at least one beam is picked."
          },
          {
            "check": "Beam Object Validity",
            "errorMessage": "Skipped in report",
            "recovery": "If a beam in the set is invalid (deleted/corrupt), it is skipped in the loop to prevent script crash."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Self-Terminating)",
            "how": "N/A",
            "effect": "The script calls eraseInstance() at the end of execution. It does not remain in the drawing for further editing or context menu interaction."
          }
        ]
      },
      "tokens_used": 4127,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# GE_BEAM_INFO_GET_PANHAND.mcr\n\n## Overview\nThis is a diagnostic tool that inspects selected timber beams to identify the entity type acting as their \"panhand\" (reference contour or profile guide). It is useful for verifying why a beam might be processing incorrectly regarding its shape or machining.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | This script must be run in the Model Space. |\n| Paper Space | No | Not supported. |\n| Shop Drawing | No | Not supported. |\n\n## Prerequisites\n- **Required entities**: Existing `GenBeam` (timber beam) entities in the model.\n- **Minimum beam count**: At least 1 beam must be selected.\n- **Required settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: Type `TSLINSERT` in the command line.\nAction: Select `GE_BEAM_INFO_GET_PANHAND.mcr` from the file list and click **Open**.\n\n### Step 2: Select Beams\n```\nCommand Line: select a set beams\nAction: Click on the beams you wish to analyze in the drawing area. You can select multiple beams. Press Enter or Spacebar to confirm your selection.\n```\n\n### Step 3: View Results\nAction: The script automatically processes the selection and displays a report. The report lists the **Handle**, **Type**, and **Panhand Status** (e.g., the entity type name or \"EMPTY\" if missing) for each selected beam.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| N/A | N/A | N/A | This script does not expose editable properties in the Properties Palette. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| N/A | This script does not add items to the right-click context menu. |\n\n## Settings Files\n- **Filename**: N/A\n- **Location**: N/A\n- **Purpose**: No external settings files are used.\n\n## Tips\n- **Self-Cleaning Script**: This script is designed to run once and automatically erase itself from the drawing after displaying the report. You do not need to delete it manually.\n- **Troubleshooting**: If the report shows \"EMPTY\" for the Panhand status, it means the selected beam does not have a valid reference contour assigned to it.\n\n## FAQ\n- **Q: Why did the script disappear immediately after running?**\n  - **A:** The script is designed as a one-time diagnostic tool. It automatically deletes itself (`eraseInstance`) after generating the report to keep your drawing clean.\n- **Q: What does \"Panhand\" mean in this context?**\n  - **A:** In hsbCAD, the Panhand usually refers to the reference contour or profile guide that defines the beam's cross-section or shape.\n- **Q: Can I save the output?**\n  - **A:** The output is shown in a text dialog. You can manually copy and paste the text from the dialog into a text editor or Excel if needed."
      },
      "tokens_used": 4522,
      "error": null
    }
  }
}