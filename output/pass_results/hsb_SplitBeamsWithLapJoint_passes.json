{
  "filename": "hsb_SplitBeamsWithLapJoint.mcr",
  "status": "completed",
  "total_tokens": 30217,
  "processing_time": 213.72299432754517,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": null,
        "versionHistory": [
          {
            "version": "1.0",
            "date": "10.07.2013",
            "author": "Alberto Jena (aj@hsb-cad.com)",
            "changes": "Release Version"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 6058,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses PrEntity to select Elements and performs 3D operations (Beam.dbSplit, BeamCut, addToolStatic). No sd_ function calls, #Type E constructs, or _Viewport usage found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Beam"
          ],
          "minimumBeams": 1,
          "requiredSpace": "Model Space containing Elements with Beams exceeding the maximum length property",
          "requiredSettings": []
        }
      },
      "tokens_used": 3468,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "PrEntity",
              "promptOriginal": "Select a set of elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "Generic",
            "trigger": "On Insert (if _kExecuteKey is empty)",
            "title": null,
            "dataSource": "showDialogOnce()",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 0,
            "variable": "dMaxLength",
            "type": "PropDouble",
            "displayName": "Maximum length",
            "defaultValue": "U(5200)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 1,
            "variable": "dMinLength",
            "type": "PropDouble",
            "displayName": "Minimum length",
            "defaultValue": "U(500)",
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 3418,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically splits long timber beams into shorter, transportable segments connected by a stepped lap joint.",
          "category": "Fabrication / Framing",
          "typicalUseCase": "Breaking down long structural members (e.g., rafters, purlins, or top plates) that exceed maximum transport or handling lengths into smaller pieces that can be reassembled on site using a mechanical lap connection."
        },
        "parameters": [
          {
            "name": "dMaxLength",
            "technicalDefault": "U(5200)",
            "businessMeaning": "The target maximum length for individual beam segments after splitting. If a beam exceeds this length, the script calculates where to cut it to create segments of approximately this size.",
            "validRange": "2000 - 14000",
            "unit": "mm",
            "affectsOutput": "Determines the frequency of splits along the beam. Larger values result in fewer, longer segments; smaller values result in more, shorter segments."
          },
          {
            "name": "dMinLength",
            "technicalDefault": "U(500)",
            "businessMeaning": "The smallest acceptable length for the final piece of a split beam. Prevents the creation of tiny, unusable offcuts (scrap) at the end of a beam.",
            "validRange": "300 - 2000",
            "unit": "mm",
            "affectsOutput": "Controls the length of the last segment. If the remaining beam length after a split is shorter than this value, the script adjusts the previous cut point to include the remaining material in the prior segment."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "dMinLength",
            "effect": "Must be greater than the total lap depth defined in the code (300mm). If set too low, geometric errors may occur as the split point calculation might conflict with the physical overlap of the joint.",
            "cascade": [
              "dMaxLength"
            ]
          },
          {
            "trigger": "dMaxLength",
            "effect": "Must be significantly larger than dMinLength to allow for a valid split. If dMaxLength is only slightly larger than dMinLength, the script may fail to split the beam effectively.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "BeamSplit",
            "description": "The original beam is divided into multiple GenBeam entities at calculated intervals.",
            "appliedTo": "Selected Beams within chosen Elements."
          },
          {
            "type": "BeamCut (Milling)",
            "description": "A 2-step stepped lap joint (Scarf joint variant) is machined into the ends of the split beams. This joint is hardcoded with a lap depth of 150mm and 2 vertical steps, creating a mechanical interlock for reassembly.",
            "appliedTo": "The split faces of the resulting beam segments."
          }
        ]
      },
      "tokens_used": 5532,
      "error": null
    },
    "5": {
      "success": true,
      "data": {},
      "tokens_used": 7386,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SplitBeamsWithLapJoint.mcr\n\n## Overview\nAutomatically splits long timber beams into shorter, transportable segments connected by a stepped lap joint. This tool is useful for breaking down structural members that exceed maximum transport lengths into pieces that can be reassembled on site.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Script must be run in the 3D model. |\n| Paper Space | No | Not supported for layout views. |\n| Shop Drawing | No | Not applicable to 2D drawings. |\n\n## Prerequisites\n- **Required Entities**: Elements containing Beams.\n- **Minimum Beam Count**: At least 1 beam within the selected elements must exceed the maximum length setting.\n- **Required Settings**: None (uses internal script logic).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SplitBeamsWithLapJoint.mcr`\n\n### Step 2: Select Elements\n```\nCommand Line: Select a set of elements\nAction: Click on the Elements (or groups) in the model that contain the beams you wish to split. Press Enter to confirm selection.\n```\n\n### Step 3: Verify Configuration\nAfter selection, the script will process the beams. If the split logic needs adjustment, select the newly created script instance (or the beams if properties are inherited) and check the Properties Palette (OPM) to ensure `dMaxLength` and `dMinLength` are correct, then recalculate if necessary.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Maximum length | Number | 5200 mm | The target maximum length for individual beam segments. Beams longer than this will be split. |\n| Minimum length | Number | 500 mm | The smallest allowable length for the last segment of a beam. Prevents the creation of tiny scrap pieces. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| None | No specific custom context menu options are defined for this script. |\n\n## Settings Files\n- **Filename**: None\n- **Location**: N/A\n- **Purpose**: N/A\n\n## Tips\n- **Minimum Length**: Ensure the `Minimum length` property is set higher than 300mm. The script creates a 2-step lap joint with a total engagement depth of 300mm; if the remaining piece is shorter than this, the joint cannot be created correctly.\n- **Visual Check**: After running the script, visually inspect the split locations to ensure the lap joints do not interfere with other connections or hardware (like bolts or hinges).\n- **Material Handling**: This script is ideal for preparing elements for transport. Use the `Maximum length` setting to match your truck or container capacity.\n\n## FAQ\n- **Q: Why didn't my beam split?**\n  **A:** Check if the beam length actually exceeds the `Maximum length` setting in the Properties Palette.\n- **Q: Can I customize the shape of the lap joint?**\n  **A:** No, the joint geometry is hardcoded to a 2-step profile with a 150mm step depth.\n- **Q: What happens if my beam is exactly 5250mm long and Max Length is 5200mm?**\n  **A:** The script will attempt to split it. It will calculate a split point that ensures the last piece is longer than the `Minimum length` (e.g., 500mm). The split location will be adjusted to accommodate the lap joint geometry."
      },
      "tokens_used": 4355,
      "error": null
    }
  }
}