{
  "filename": "hsb_CreateMillingAroundOpenings.mcr",
  "status": "completed",
  "total_tokens": 58015,
  "processing_time": 298.8505394458771,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [
          {
            "version": "1.8",
            "date": "08.01.2025",
            "author": "Marsel Nakuci",
            "changes": "HSB-23037: Fix spelling error"
          },
          {
            "version": "1.7",
            "date": "01.09.2023",
            "author": "Marsel Nakuci",
            "changes": "HSB-19784: TSL can be attached at elements and operate on generation"
          },
          {
            "version": "1.6",
            "date": "03.06.2022",
            "author": "Thorsten Huck",
            "changes": "HSB-15372 purging duplicates improved"
          },
          {
            "version": "1.0",
            "date": "16/11/2012",
            "author": "Chirag Sawjani",
            "changes": "Release based on Assign Millings to Openings"
          }
        ],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 8812,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Uses _kModelSpace in collectEntities call. Interacts exclusively with 3D construction entities (Element, ElementWallSF, ElementRoof, Opening, OpeningRoof, Sheet, ElemZone, ElemMill). Adds tools to elements (el.addTool) rather than creating annotations or viewports. No #Type E, sd_ prefixes, or Viewport logic found."
        },
        "prerequisites": {
          "requiredEntities": [
            "Element",
            "Opening"
          ],
          "minimumBeams": 0,
          "requiredSpace": "Model Space",
          "requiredSettings": []
        }
      },
      "tokens_used": 7290,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [
            {
              "step": 1,
              "function": "showDialog",
              "promptOriginal": null,
              "condition": "_bOnInsert && _kExecuteKey==\"\"",
              "required": true
            },
            {
              "step": 2,
              "function": "PrEntity",
              "promptOriginal": "Select one or More Elements",
              "condition": "_bOnInsert",
              "required": true
            }
          ],
          "keywordOptions": []
        },
        "dialogs": [
          {
            "type": "DynamicDialog",
            "trigger": "On Insert (via showDialog) or on MapIO (_bOnMapIO)",
            "title": null,
            "dataSource": "Properties defined in script",
            "features": {
              "searchable": false,
              "multiSelect": false
            }
          }
        ],
        "opmProperties": [
          {
            "index": 5,
            "variable": "sMode",
            "type": "PropString",
            "displayName": "|Milling mode|",
            "defaultValue": "|Opening|",
            "inputType": "dropdown",
            "options": [
              "|Opening|",
              "|Opening where sheets intersect|"
            ],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 4,
            "variable": "sZoneToLookFor",
            "type": "PropString",
            "displayName": "Zone to mill",
            "defaultValue": "Specified zone",
            "inputType": "dropdown",
            "options": [
              "Specified zone",
              "Outermost zone",
              "Innermost zone"
            ],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "nValidZone",
            "type": "PropInt",
            "displayName": "Specified zone",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 0,
            "variable": "millDepth",
            "type": "PropDouble",
            "displayName": "Milling Depth '0=Zone depth'",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 1,
            "variable": "nToolingIndex",
            "type": "PropInt",
            "displayName": "Tooling index",
            "defaultValue": 1,
            "inputType": "number",
            "options": [],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 0,
            "variable": "strSide",
            "type": "PropString",
            "displayName": "Side",
            "defaultValue": "Left",
            "inputType": "dropdown",
            "options": [
              "Left",
              "Right"
            ],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 1,
            "variable": "strTurn",
            "type": "PropString",
            "displayName": "Turning direction",
            "defaultValue": "Against course",
            "inputType": "dropdown",
            "options": [
              "Against course",
              "With course"
            ],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 2,
            "variable": "strOShoot",
            "type": "PropString",
            "displayName": "Overshoot",
            "defaultValue": "No",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 3,
            "variable": "strVacuum",
            "type": "PropString",
            "displayName": "Vacuum",
            "defaultValue": "Yes",
            "inputType": "dropdown",
            "options": [
              "No",
              "Yes"
            ],
            "category": "|Milling|",
            "description": null
          },
          {
            "index": 1,
            "variable": "dOffsetWindowTop",
            "type": "PropDouble",
            "displayName": "Offset milling opening top",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Windows|",
            "description": null
          },
          {
            "index": 2,
            "variable": "dOffsetWindowBottom",
            "type": "PropDouble",
            "displayName": "Offset milling opening bottom",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Windows|",
            "description": null
          },
          {
            "index": 3,
            "variable": "dOffsetWindowLeft",
            "type": "PropDouble",
            "displayName": "Offset milling opening left",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Windows|",
            "description": null
          },
          {
            "index": 4,
            "variable": "dOffsetWindowRight",
            "type": "PropDouble",
            "displayName": "Offset milling opening right",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Windows|",
            "description": null
          },
          {
            "index": 6,
            "variable": "dOffsetDoorTop",
            "type": "PropDouble",
            "displayName": "Offset milling door top",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Doors|",
            "description": null
          },
          {
            "index": 7,
            "variable": "dOffsetDoorBottom",
            "type": "PropDouble",
            "displayName": "Offset milling door bottom",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Doors|",
            "description": null
          },
          {
            "index": 8,
            "variable": "dOffsetDoorLeft",
            "type": "PropDouble",
            "displayName": "Offset milling door left",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Doors|",
            "description": null
          },
          {
            "index": 9,
            "variable": "dOffsetDoorRight",
            "type": "PropDouble",
            "displayName": "Offset milling door right",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - Doors|",
            "description": null
          },
          {
            "index": 5,
            "variable": "dEdgeOffsetFromHole",
            "type": "PropDouble",
            "displayName": "Offset from hole edge",
            "defaultValue": 0,
            "inputType": "number",
            "options": [],
            "category": "|Dimensions - General|",
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": []
      },
      "tokens_used": 9563,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Automatically generates CNC milling operations (recesses or cutouts) around window and door openings in timber wall and roof elements.",
          "category": "Manufacturing/CNC",
          "typicalUseCase": "Creating niches for window frames, cutting back specific material layers (like sheathing) for openings, or creating milling paths aligned with sheet overlaps in prefabricated panels."
        },
        "parameters": [
          {
            "name": "sMode",
            "technicalDefault": "|Opening|",
            "businessMeaning": "Determines the strategy for calculating the milling shape. 'Opening' mills a simple rectangle based on the opening size. 'Opening where sheets intersect' calculates the milling path based on the actual geometry of sheets within that layer, allowing for complex shapes.",
            "validRange": "|Opening|, |Opening where sheets intersect|",
            "unit": "Enum",
            "affectsOutput": "Geometry of the milling path. Mode 1 creates complex shapes following sheet edges; Mode 0 creates a simple rectangle."
          },
          {
            "name": "sZoneToLookFor",
            "technicalDefault": "Specified zone",
            "businessMeaning": "Selects which construction layer (Zone) of the element to apply the milling to.",
            "validRange": "Specified zone, Outermost zone, Innermost zone",
            "unit": "Enum",
            "affectsOutput": "Determines the depth and vertical position of the cut within the element's build-up."
          },
          {
            "name": "nValidZone",
            "technicalDefault": "1",
            "businessMeaning": "The specific index of the material layer to mill, when 'Zone to mill' is set to 'Specified zone'. (e.g., 1 might be exterior sheathing, 2 studs).",
            "validRange": "1 - 10",
            "unit": "Count",
            "affectsOutput": "Selects the target layer for the milling operation."
          },
          {
            "name": "millDepth",
            "technicalDefault": "0",
            "businessMeaning": "The depth of the cut. A value of 0 cuts through the entire depth of the selected zone. A positive value cuts a pocket of that specific depth.",
            "validRange": "0 - 300",
            "unit": "mm",
            "affectsOutput": "Depth of the CNC operation. 0 = Through cut in layer; >0 = Blind pocket."
          },
          {
            "name": "nToolingIndex",
            "technicalDefault": "1",
            "businessMeaning": "References the specific CNC tool (cutter bit) to be used from the machine's database.",
            "validRange": "1 - 50",
            "unit": "Index",
            "affectsOutput": "Machining speed, tool diameter compensation, and tool selection in CAM output."
          },
          {
            "name": "strSide",
            "technicalDefault": "Left",
            "businessMeaning": "Defines the side of the contour the tool should travel on (Tool offset).",
            "validRange": "Left, Right",
            "unit": "Direction",
            "affectsOutput": "Precise positioning of the cut edge relative to the opening geometry."
          },
          {
            "name": "strTurn",
            "technicalDefault": "Against course",
            "businessMeaning": "Direction of tool travel (Climb milling vs Conventional milling). Affects surface quality.",
            "validRange": "Against course, With course",
            "unit": "Direction",
            "affectsOutput": "CNC G-code direction and potentially surface finish."
          },
          {
            "name": "strOShoot",
            "technicalDefault": "No",
            "businessMeaning": "Overshoot. Enables the tool to enter/exit the material past the start/end points to prevent dwell marks on the finished surface.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "Length of the tool path (adds entry/exit tangents)."
          },
          {
            "name": "strVacuum",
            "technicalDefault": "Yes",
            "businessMeaning": "Controls vacuum hold-down on CNC beds. Enabled, it preserves vacuum zones over the milled area.",
            "validRange": "Yes, No",
            "unit": "Boolean",
            "affectsOutput": "CNC vacuum table logic."
          },
          {
            "name": "dOffsetWindowTop/Bottom/Left/Right",
            "technicalDefault": "0",
            "businessMeaning": "Adjusts the milling boundary away from the window frame. Positive values enlarge the hole (more clearance), negative values shrink it (create a reveal).",
            "validRange": "-50 to 50",
            "unit": "mm",
            "affectsOutput": "Dimensions and position of the rectangular milling path."
          },
          {
            "name": "dOffsetDoorTop/Bottom/Left/Right",
            "technicalDefault": "0",
            "businessMeaning": "Adjusts the milling boundary away from the door frame. Same logic as window offsets.",
            "validRange": "-50 to 50",
            "unit": "mm",
            "affectsOutput": "Dimensions and position of the rectangular milling path for doors."
          },
          {
            "name": "dEdgeOffsetFromHole",
            "technicalDefault": "0",
            "businessMeaning": "Additional clearance offset applied specifically when using 'Opening where sheets intersect' mode to account for tooling or reveal requirements around the sheet edges.",
            "validRange": "0 to 50",
            "unit": "mm",
            "affectsOutput": "Expands or shrinks the complex milling profile in Mode 1."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "sZoneToLookFor is set to 'Specified zone'",
            "effect": "The integer value of nValidZone is used to select the target layer. Otherwise, the script ignores nValidZone and calculates the zone programmatically.",
            "cascade": [
              "nValidZone"
            ]
          }
        ],
        "outputEntities": [
          {
            "type": "ElemMill",
            "description": "A CNC milling operation added to the element. Can be a rectangular through-cut or a complex pocket based on sheet intersections.",
            "appliedTo": "Selected ElementWallSF or ElementRoof (within a specific Zone/Layer)"
          }
        ]
      },
      "tokens_used": 11411,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "Script Execution Start",
          "Check MapIO: If (_bOnMapIO) set properties from Map, Show Dialog, return Map",
          "Check Insertion: If (_bOnInsert) check cycle count",
          "[Insert] Show Configuration Dialog if no execute key is provided",
          "[Insert] Prompt user to select ElementWallSF or ElementRoof elements",
          "[Insert] Iterate through selected elements",
          "[Insert] For each element, find all valid Openings (standard wall openings)",
          "[Insert] For each Wall Opening: Create a new TSL instance attached to the Opening, pass current properties via Map",
          "[Insert] Identify unique ElementRoof entities from selection",
          "[Insert] For each Roof Element: Determine associated Group, find relevant OpeningRoof entities via Group and intersection logic",
          "[Insert] For each Roof Opening: Create a new TSL instance attached to the OpeningRoof, pass properties via Map",
          "[Insert] Erase the initial (seed) TSL instance",
          "[Run Attached] Check for Element-attached execution (1 Element, 0 Openings)",
          "[Run Attached] If attached: Iterate element openings, create child TSLs for each, similar to insert flow",
          "[Processing] Initialize TSL Instance: Read execution mode (0=Insert/Run, 1=Edit/Calc)",
          "[Processing] Identify Host Element and Opening (Wall or Roof) from context",
          "[Processing] Calculate Coordinate System and local vectors ( vX, vY, vZ )",
          "[Processing] Determine Target Zone: Based on 'sZoneToLookFor' (Specified/Outermost/Innermost) and 'nValidZone'",
          "[Processing] Calculate Milling Geometry: Based on 'sMode' (Simple Rectangle vs Sheet Intersection)",
          "[Processing] Calculate Milling Depth: Use 'millDepth' if >0, else use Zone depth",
          "[Processing] Generate CNC Attributes: Side, Turn, Overshoot, Vacuum, Tooling Index",
          "[Processing] Create and Add Tooling: Generate 'ElemMill' and add to Host Element",
          "[Processing] Set Dependants: Link relevant Sheets (if Mode 1) to the TSL instance",
          "[Processing] Assign to Element Group: Register TSL in the element's construction data",
          "Script End"
        ],
        "conditionalBranches": [
          {
            "condition": "Triggered via MapIO (Property Palette or Generation)",
            "path1": {
              "name": "MapIO Path",
              "steps": [
                "Load properties from input Map",
                "Display Dialog",
                "Save properties to output Map",
                "Exit Script"
              ]
            }
          },
          {
            "condition": "Triggered by Insert Command (_bOnInsert)",
            "path1": {
              "name": "Insertion Path",
              "steps": [
                "Check for duplicate instance (erase if cycle count > 1)",
                "Show Dialog (if execute key empty)",
                "Select Entities (Wall or Roof)",
                "Loop Wall Openings: Spawn child TSL instances",
                "Loop Roof Openings: Find OpeningRoofs via Group/Intersection, Spawn child TSL instances",
                "Erase Seed Instance"
              ]
            }
          },
          {
            "condition": "Triggered by Calculation/Update (Attached to Element, no Opening context)",
            "path1": {
              "name": "Element Attached Spawn Path",
              "steps": [
                "Retrieve Element",
                "Get all Openings from Element",
                "Spawn child TSL instances for each Opening (same logic as Insert)"
              ]
            }
          },
          {
            "condition": "Milling Mode (sMode)",
            "path1": {
              "name": "Mode 0: Opening (Simple)",
              "steps": [
                "Calculate offsets (Top/Bottom/Left/Right) based on Door/Window type",
                "Construct Rectangular PLine",
                "Create single ElemMill based on Rect"
              ]
            },
            "path2": {
              "name": "Mode 1: Sheets Intersect (Complex)",
              "steps": [
                "Collect all Sheets in the Target Zone",
                "Construct Rectangular Profile around Opening",
                "Intersect Opening Profile with Sheets Profile",
                "Filter resulting rings (exclude openings, keep islands)",
                "Apply Edge Offset to resulting geometry",
                "Create ElemMill for each resulting polygon",
                "Identify and link dependant Sheets"
              ]
            }
          },
          {
            "condition": "Target Zone Selection (sZoneToLookFor)",
            "path1": {
              "name": "Specified Zone",
              "steps": [
                "Use integer value from 'nValidZone' property"
              ]
            },
            "path2": {
              "name": "Outermost Zone",
              "steps": [
                "Calculate zone index based on element build-up logic (outer layer)"
              ]
            },
            "path3": {
              "name": "Innermost Zone",
              "steps": [
                "Calculate zone index based on element build-up logic (inner layer)"
              ]
            }
          },
          {
            "condition": "Host Entity Type",
            "path1": {
              "name": "ElementWallSF / OpeningSF",
              "steps": [
                "Use OpeningSF dimensions and gap properties",
                "Standard Cartesian coordinate logic"
              ]
            },
            "path2": {
              "name": "ElementRoof / OpeningRoof",
              "steps": [
                "Use OpeningRoof dimensions (Width/Height from properties)",
                "Standard Cartesian coordinate logic"
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Element Selection",
            "errorMessage": "None explicit (Cancel returns empty set)",
            "recovery": "User must select valid ElementWallSF or ElementRoof entities at the command prompt."
          },
          {
            "check": "Opening Validity",
            "errorMessage": "Script returns/terminates if op.bIsValid() is false",
            "recovery": "Ensure selected elements have valid, uncorrupted opening sub-entities."
          },
          {
            "check": "Roof Opening Intersection",
            "errorMessage": "Script filters out roof openings if intersection area is near zero (epsilon check)",
            "recovery": "Ensure Roof Openings physically intersect the Roof Element geometry."
          },
          {
            "check": "Zone Index",
            "errorMessage": "Script errors or creates invalid tool if nValidZone is out of bounds for the element",
            "recovery": "Ensure 'Specified zone' index exists within the element's layer build-up."
          }
        ],
        "postInsertionActions": [
          {
            "action": "Modify Parameters (OPM)",
            "how": "Select the Element (or the TSL instance), open Properties Palette",
            "effect": "Changing Milling Mode, Dimensions, Offsets, or Tooling triggers recalculation of the geometry and CNC parameters instantly."
          },
          {
            "action": "Move/Resize Opening",
            "how": "Grip edit the Opening entity in the model",
            "effect": "The TSL detects the change in context and recalculates the milling position/size to follow the opening."
          },
          {
            "action": "Change Element Construction",
            "how": "Edit the element's layers (Zones)",
            "effect": "If 'Zone to mill' is set to Outermost/Innermost or if the specified zone index changes meaning, the milling depth and position update automatically."
          },
          {
            "action": "Delete Opening",
            "how": "Erase the Opening entity",
            "effect": "The associated TSL instance is removed/purged from the element."
          },
          {
            "action": "MapIO Update",
            "how": "Via external scripts or hsbCAD generation processes updating the Instance Map",
            "effect": "Script parameters are updated without manual user interaction (batch processing)."
          }
        ]
      },
      "tokens_used": 12279,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_CreateMillingAroundOpenings.mcr\n\n## Overview\nAutomatically generates CNC milling operations (cutouts or recesses) around window and door openings in timber wall and roof elements. It supports both simple rectangular cutouts and complex shapes based on sheet intersections for precise manufacturing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Use in 3D model to create tooling on elements. |\n| Paper Space | No | Not applicable for layouts. |\n| Shop Drawing | No | This is a manufacturing/modeling script. |\n\n## Prerequisites\n- **Required Entities**: Element (Wall or Roof) and at least one Opening (Window or Door) inside that element.\n- **Minimum Beam Count**: 0 (This script operates on Elements, not individual beams).\n- **Required Settings**: None.\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_CreateMillingAroundOpenings.mcr`\n\n### Step 2: Configure Settings\n```\nDialog Box: Configure Milling Settings\nAction: Set the desired Milling Mode, Target Zone, Offsets, and CNC attributes in the dialog window. Click OK.\n```\n\n### Step 3: Select Elements\n```\nCommand Line: Select one or More Elements\nAction: Click on the Wall or Roof elements that contain the openings you want to mill. Press Enter to confirm selection.\n```\n\n### Step 4: Generation\nThe script will automatically detect all valid openings within the selected elements and attach milling operations to them. The initial script instance is removed, leaving only the tooling attached to the openings.\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| Milling mode | Dropdown | Opening | **Opening**: Creates a simple rectangular milling around the opening.<br>**Opening where sheets intersect**: Creates a complex milling path based on the actual geometry of sheets in the selected layer. |\n| Zone to mill | Dropdown | Specified zone | Determines which construction layer to mill.<br>**Specified zone**: Uses the index defined below.<br>**Outermost zone**: The exterior layer.<br>**Innermost zone**: The interior layer. |\n| Specified zone | Number | 1 | The index number of the layer to mill (when \"Specified zone\" is selected). |\n| Milling Depth '0=Zone depth' | Number | 0 | Depth of the cut. **0** = Cut completely through the selected zone. Any value >0 creates a blind pocket of that depth. |\n| Tooling index | Number | 1 | The CNC tool number to be used for this operation. |\n| Side | Dropdown | Left | Tool offset side relative to the contour path (Left or Right). |\n| Turning direction | Dropdown | Against course | CNC cutting direction (Climb vs. Conventional milling). |\n| Overshoot | Dropdown | No | If **Yes**, the toolpath extends tangentially beyond the start/end points to prevent dwell marks. |\n| Vacuum | Dropdown | Yes | If **Yes**, vacuum zones are preserved over the milled area for the CNC bed. |\n| Offset milling opening top | Number | 0 | Vertical offset from the top of the window frame (positive = larger cut, negative = reveal). |\n| Offset milling opening bottom | Number | 0 | Vertical offset from the bottom of the window frame. |\n| Offset milling opening left | Number | 0 | Horizontal offset from the left side of the window frame. |\n| Offset milling opening right | Number | 0 | Horizontal offset from the right side of the window frame. |\n| Offset milling door top | Number | 0 | Vertical offset from the top of the door frame. |\n| Offset milling door bottom | Number | 0 | Vertical offset from the bottom of the door frame. |\n| Offset milling door left | Number | 0 | Horizontal offset from the left side of the door frame. |\n| Offset milling door right | Number | 0 | Horizontal offset from the right side of the door frame. |\n| Offset from hole edge | Number | 0 | Additional clearance applied specifically when using \"Opening where sheets intersect\" mode. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| Delete | Removes the milling operation from the opening. |\n| Recalculate | Updates the milling geometry if parameters or the opening size have changed. |\n\n## Settings Files\n- None used.\n\n## Tips\n- **Complex Geometry**: Use the **\"Opening where sheets intersect\"** mode when your wall has cladding sheets with overlaps. This ensures the milling only cuts the specific sheet areas rather than a generic rectangle that might cut into air or other layers.\n- **Reveals**: To create a reveal where the finish material overlaps the frame, enter **negative values** for the window/door offsets (e.g., -10 mm).\n- **Editing**: You can modify the milling parameters at any time by selecting the Element (or the Opening instance) and changing values in the Properties Palette. The milling will update automatically.\n- **Through Cuts**: To cut entirely through a layer (like sheathing), ensure **Milling Depth** is set to **0**.\n\n## FAQ\n- **Q: Why did the milling not appear?**\n  A: Ensure the selected Element has a valid Opening sub-entity and that the \"Specified zone\" index actually exists in the element's layer build-up.\n- **Q: Can I use this on curved walls?**\n  A: Yes, the script works on ElementWallSF entities, but the milling result depends on the specific geometry and the selected mode (Sheet intersection mode handles complex geometry better).\n- **Q: How do I change the tool used for the cut?**\n  A: Select the milling instance in the model or via the element structure and change the **Tooling index** property to match your CNC machine's tool database."
      },
      "tokens_used": 8660,
      "error": null
    }
  }
}