{
  "filename": "hsb_SteicoImport.mcr",
  "status": "completed",
  "total_tokens": 26281,
  "processing_time": 166.84553241729736,
  "passes": {
    "1": {
      "success": true,
      "data": {
        "header": {
          "type": null,
          "numBeamsReq": null,
          "keywords": [],
          "majorVersion": null,
          "minorVersion": null,
          "dxaOut": null,
          "implInsert": null
        },
        "description": "",
        "versionHistory": [],
        "settingsFiles": [],
        "dependencies": []
      },
      "tokens_used": 3248,
      "error": null
    },
    "2": {
      "success": true,
      "data": {
        "usageEnvironment": {
          "primarySpace": "ModelSpace",
          "supportsPaperSpace": false,
          "isShopDrawingScript": false,
          "isMultipageScript": false,
          "detectionEvidence": "Script uses `ModelMap` and `dbInterpretMap` to generate 3D structural entities (I-Joists, Beams, Members, etc.). It calls `eraseInstance()` at the end, indicating it functions as a one-time import/generation tool for the 3D model. No ShopDrawing specific APIs (sd_*) or viewport handling logic are present."
        },
        "prerequisites": {
          "requiredEntities": [],
          "minimumBeams": 0,
          "requiredSpace": "Model Space (3D)",
          "requiredSettings": [
            "\\Utilities\\hsbCloudStorage\\hsbSteicoIO.dll"
          ]
        }
      },
      "tokens_used": 2890,
      "error": null
    },
    "3": {
      "success": true,
      "data": {
        "commandLine": {
          "insertionFlow": [],
          "keywordOptions": []
        },
        "dialogs": [],
        "opmProperties": [
          {
            "index": 1,
            "variable": "pIJoistGroupName",
            "type": "PropString",
            "displayName": "IJoist Group Name",
            "defaultValue": "I-Joists\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 2,
            "variable": "pMemberGroupName",
            "type": "PropString",
            "displayName": "Member Group Name",
            "defaultValue": "Member\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 3,
            "variable": "pBeamGroupName",
            "type": "PropString",
            "displayName": "Beam Group Name",
            "defaultValue": "Beams\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 4,
            "variable": "pNogginGroupName",
            "type": "PropString",
            "displayName": "Noggin Group Name",
            "defaultValue": "Noggins\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 5,
            "variable": "pBlockingProupName",
            "type": "PropString",
            "displayName": "Blocking Group Name",
            "defaultValue": "Blocking\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 6,
            "variable": "pSacrJoistGroupName",
            "type": "PropString",
            "displayName": "Sacrificial Joists Group Name",
            "defaultValue": "Sacrificial Joists\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 7,
            "variable": "pEndDeviceGroupName",
            "type": "PropString",
            "displayName": "Device Group Name",
            "defaultValue": "End Device\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          },
          {
            "index": 8,
            "variable": "pRimboardGroupName",
            "type": "PropString",
            "displayName": "Rimboard Group Name",
            "defaultValue": "Rimboard\\Ground_Floor",
            "inputType": "text",
            "options": [],
            "category": null,
            "description": null
          }
        ],
        "contextMenu": [],
        "settingsFiles": [
          {
            "filename": "hsbSteicoIO.dll",
            "searchPaths": [
              "_kPathHsbInstall\\Utilities\\hsbCloudStorage"
            ],
            "purpose": "Provides the ImportCadModel function via callDotNetFunction2 to interpret Steico CAD data.",
            "required": true
          }
        ]
      },
      "tokens_used": 3462,
      "error": null
    },
    "4": {
      "success": true,
      "data": {
        "scriptPurpose": {
          "summary": "Imports structural floor designs from Steico software into hsbCAD, mapping specific timber elements (I-Joists, Beams, Noggins, etc.) into defined catalog groups.",
          "category": "Data Import / Integration",
          "typicalUseCase": "Used when a floor system has been engineered or designed using Steico-specific tools (or a Steico export format) and needs to be brought into the hsbCAD 3D model for detailing and manufacturing."
        },
        "parameters": [
          {
            "name": "pIJoistGroupName",
            "technicalDefault": "I-Joists\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported I-Joists will be stored in the hsbCAD project.",
            "validRange": "Any valid existing or new catalog path string (e.g., 'Structure\\Floor1\\I-Joists').",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of the imported I-Joist elements in the Project Manager/Catalog tree. Does not change geometry."
          },
          {
            "name": "pMemberGroupName",
            "technicalDefault": "Member\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported structural Members (studs or posts) will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Member elements in the Project Manager/Catalog tree."
          },
          {
            "name": "pBeamGroupName",
            "technicalDefault": "Beams\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported primary or secondary Beams (e.g., trimmers, carriers) will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Beam elements in the Project Manager/Catalog tree."
          },
          {
            "name": "pNogginGroupName",
            "technicalDefault": "Noggins\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported Noggins (dwangs/herringbone strutting) will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Noggin elements in the Project Manager/Catalog tree."
          },
          {
            "name": "pBlockingProupName",
            "technicalDefault": "Blocking\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported Blocking panels/timbers will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Blocking elements in the Project Manager/Catalog tree."
          },
          {
            "name": "pSacrJoistGroupName",
            "technicalDefault": "Sacrificial Joists\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported Sacrificial Joists (temporary or trimmer joists) will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Sacrificial Joist elements in the Project Manager/Catalog tree."
          },
          {
            "name": "pEndDeviceGroupName",
            "technicalDefault": "End Device\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported End Devices (hardware, hangers, or connectors) will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported hardware/metalwork in the Project Manager/Catalog tree."
          },
          {
            "name": "pRimboardGroupName",
            "technicalDefault": "Rimboard\\Ground_Floor",
            "businessMeaning": "Specifies the destination catalog folder path where imported Rimboard elements will be stored.",
            "validRange": "Any valid existing or new catalog path string.",
            "unit": "Text (Path)",
            "affectsOutput": "Organization of imported Rimboard elements in the Project Manager/Catalog tree."
          }
        ],
        "parameterDependencies": [
          {
            "trigger": "None",
            "effect": "Parameters are independent strings mapped to external data. Changing one group name does not affect the value or validity of others.",
            "cascade": []
          }
        ],
        "outputEntities": [
          {
            "type": "GenBeam",
            "description": "3D Timber elements representing I-Joists, solid timber beams, noggins, blocking, rimboards, and members.",
            "appliedTo": "Model Space (organized into specific Groups defined by properties)."
          },
          {
            "type": "Element / MetalPart",
            "description": "Connectors or end devices (e.g. joist hangers) imported as part of the floor layout.",
            "appliedTo": "Specific connection points defined in the Steico import data."
          }
        ]
      },
      "tokens_used": 5618,
      "error": null
    },
    "5": {
      "success": true,
      "data": {
        "workflowDiagram": [
          "1. Script initialization and declaration of Properties (Group Names).",
          "2. Synchronize Property values with Catalog using execute key.",
          "3. Evaluate execution context: Is the script being inserted? (_bOnInsert).",
          "4. [Branch] If Insertion is True:",
          "   4a. Check if _kExecuteKey is empty.",
          "   4b. If empty, display configuration dialog once (showDialogOnce).",
          "   4c. Define path to external DLL (hsbSteicoIO.dll).",
          "   4d. Populate Input Map (mapIn) with Property values and format strings.",
          "   4e. Report assembly path to the user.",
          "   4f. Call 'ImportCadModel' function in the external DLL.",
          "   4g. Store the returned data in the local ModelMap (mm).",
          "5. [Branch] If Insertion is False (Recalculation):",
          "   5a. Retrieve data from the internal script map (_Map).",
          "   5b. Populate the local ModelMap (mm) with this data.",
          "6. Configure ModelMap Interpretation Settings (resolve entities/elements).",
          "7. Generate 3D entities via 'dbInterpretMap'.",
          "8. Erase the script instance ('eraseInstance').",
          "9. Terminate script."
        ],
        "conditionalBranches": [
          {
            "condition": "Check _bOnInsert flag (Determines if data needs importing or restoring).",
            "path1": {
              "name": "New Import",
              "steps": [
                "Verify _kExecuteKey.",
                "Show dialog if needed.",
                "Execute external .NET function to fetch Steico data.",
                "Load data into ModelMap."
              ]
            },
            "path2": {
              "name": "Recalculation / Reload",
              "steps": [
                "Bypass external .NET call.",
                "Load data from internal _Map storage into ModelMap."
              ]
            }
          }
        ],
        "validationRules": [
          {
            "check": "Availability of hsbSteicoIO.dll at the constructed path.",
            "errorMessage": "External call failure (implied by script structure if path is invalid).",
            "recovery": "Verify hsbCloudStorage installation in hsbCAD Utilities folder."
          },
          {
            "check": "Valid Group Name paths in properties.",
            "errorMessage": "Invalid catalog structure in imported data.",
            "recovery": "User must edit OPM properties to point to valid existing catalog paths or ensure the script creates them."
          }
        ],
        "postInsertionActions": [
          {
            "action": "None (Script Self-Destructs).",
            "how": "N/A",
            "effect": "The script executes 'eraseInstance()' at the end of the workflow. The resulting beams and elements are native hsbCAD objects. The script instance itself is removed from the drawing immediately after generation."
          }
        ]
      },
      "tokens_used": 4771,
      "error": null
    },
    "6": {
      "success": true,
      "data": {
        "markdown": "# hsb_SteicoImport.mcr\n\n## Overview\nImports structural floor layouts designed in Steico software into the hsbCAD 3D model. It automatically generates timber elements (I-Joists, beams, noggins, etc.) and places them into specified project catalog groups, then removes itself from the drawing.\n\n## Usage Environment\n| Space | Supported | Notes |\n|-------|-----------|-------|\n| Model Space | Yes | Generates 3D structural elements. |\n| Paper Space | No | Not applicable. |\n| Shop Drawing | No | Not applicable. |\n\n## Prerequisites\n- **Required Settings**: `hsbSteicoIO.dll` (usually located in `hsbCAD\\Utilities\\hsbCloudStorage`).\n- **External Data**: Valid Steico CAD data accessible to the import function.\n- **Minimum Entities**: None (this script creates new entities).\n\n## Usage Steps\n\n### Step 1: Launch Script\nCommand: `TSLINSERT` â†’ Select `hsb_SteicoImport.mcr`\n\n### Step 2: Configure Group Names\nUpon insertion, the configuration dialog will appear automatically.\n```\nAction: Review the \"Group Name\" fields in the dialog.\nAction: Modify the default catalog paths (e.g., change \"Ground_Floor\" to \"First_Floor\") to match your current project structure.\nAction: Click OK to start the import process.\n```\n\n### Step 3: Generation and Completion\n```\nAction: The script will communicate with the Steico IO engine to import data.\nResult: 3D entities (I-Joists, Beams, Noggins, etc.) are generated in Model Space and sorted into the specified groups.\nResult: The script instance is automatically deleted from the drawing.\n```\n\n## Properties Panel Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| IJoist Group Name | Text | I-Joists\\Ground_Floor | Destination catalog folder for imported I-Joists. |\n| Member Group Name | Text | Member\\Ground_Floor | Destination catalog folder for imported structural Members. |\n| Beam Group Name | Text | Beams\\Ground_Floor | Destination catalog folder for imported Beams. |\n| Noggin Group Name | Text | Noggins\\Ground_Floor | Destination catalog folder for imported Noggins. |\n| Blocking Group Name | Text | Blocking\\Ground_Floor | Destination catalog folder for imported Blocking. |\n| Sacrificial Joists Group Name | Text | Sacrificial Joists\\Ground_Floor | Destination catalog folder for imported Sacrificial Joists. |\n| End Device Group Name | Text | End Device\\Ground_Floor | Destination catalog folder for imported hardware/devices. |\n| Rimboard Group Name | Text | Rimboard\\Ground_Floor | Destination catalog folder for imported Rimboard elements. |\n\n## Right-Click Menu Options\n\n| Menu Item | Description |\n|-----------|-------------|\n| (None) | The script deletes itself immediately after generating the elements, leaving no instance to right-click. |\n\n## Settings Files\n- **Filename**: `hsbSteicoIO.dll`\n- **Location**: `_kPathHsbInstall\\Utilities\\hsbCloudStorage\\`\n- **Purpose**: Provides the `ImportCadModel` function required to interpret Steico CAD data and generate the 3D geometry within hsbCAD.\n\n## Tips\n- **Folder Setup**: Ensure the target catalog folders (e.g., \"Structure\\First_Floor\") exist or are valid paths within your Project Manager before running the script to ensure elements are organized correctly.\n- **Multiple Floors**: If importing designs for multiple floors, run the script repeatedly for each floor, updating the \"Group Name\" properties (e.g., changing \"Ground_Floor\" to \"First_Floor\") during each insertion.\n- **Script Removal**: Do not be alarmed if the script icon disappears after execution; this is intended behavior. The resulting timber beams and elements will remain in the model.\n\n## FAQ\n- Q: The script disappeared after I ran it. Is that normal?\n- A: Yes. This script functions as a one-time import tool. It generates the 3D model and then deletes itself to keep the drawing clean.\n- Q: How do I import the design for the first floor instead of the ground floor?\n- A: When the configuration dialog opens during insertion, simply edit the text in the Group Name fields (e.g., change \"Ground_Floor\" to \"First_Floor\") before clicking OK."
      },
      "tokens_used": 6292,
      "error": null
    }
  }
}